[
    {
        "phase": "initial access",
        "content": "Since September of 2018, Redaman banking malware has been distributed through malspam. In this campaign, the Russian language malspam is addressed to Russian email recipients, often with email addresses ending in.ru. These emails have file attachments. These file attachments are archived Windows executable files disguised as a PDF document. In September 2018, the attachments were zip archives. In October 2018, the attachments were zip archives, 7-zip archives, and rar archives. In November 2018, the attachments were rar archives. And in December 2018, the attachments changed to gzip archives with file names ending in.gz.\nFigure 1: Flow chart for infections from Redaman banking malware from September through December of 2018.",
        "relationship": "[Relationships]: None."
    },
    {
        "phase": "initial access",
        "content": "Subject lines, message text, and attachment names constantly change for this malspam. But the messages all have a common theme: they refer to a document or file for an alleged financial issue the recipient needs to resolve. These messages are often vague, and they contain few details on the alleged financial issue. Their only goal is to trick the recipient into opening the attached archive and double-clicking the executable contained within.\nAmong dozens of examples seen from September through December of 2018, here is a selection of 10 subject lines from this malspam:\nSubject: Акт сверки сентябрь-октябрь \nSubject: Весь пакет док-ов за прошлый месяц \nSubject: Все док-ты за август-сентябрь \nSubject: Деб.задолженность среда \nSubject: Документы, сверка 02.10 \nSubject: Заявка на возврат за ноябрь \nSubject: Необходимо свериться среда \nSubject: Отправка на за прошлую неделю \nSubject: Пакет документов для оплаты 1е октября \nSubject: Сверка на оплату\nThe following are Google translations for the above subject lines:\nSubject: Act of reconciliation September-October \nSubject: All package of last month's documents \nSubject: All docs for August-September \nSubject: Debt due Wednesday \nSubject: Documents Verification for October 2018 \nSubject: Application for return for November \nSubject: Check the environment \nSubject: Sending on last week \nSubject: The package of documents for payment 1st October \nSubject: Payment Verification\nFigure 2: Example of Redaman malspam from September 2018.\nFigure 3: Example of Redaman malspam from October 2018.\nFigure 4: Example of Redaman malspam from November 2018.\nFigure 5: Example of Redaman malspam from December 2018.",
        "relationship": "1. [Relationships]: <process:threat actor,send,socket:email>. \n2. [Relationships]: <process:recipient,open,file:attached archive>. \n3. [Relationships]: <process:recipient,double-click,file:executable>. "
    },
    {
        "phase": "persistence",
        "content": "We analyzed a sample of Redaman malware from malspam on November 13th, 2018.\nSHA256 hash of rar archive from the malspam:\nf6fb51809caec2be6164863b5773a7ee3ea13a449701a1f678f0655b6e8720df\nSHA256 hash of Redaman executable extracted from the rar archive:\ncd961e81366c8d9756799ec8df14edaac5e3ae4432c3dbf8e3dd390e90c3e22f\nSHA256 hash of Redaman DLL created by the above executable:\n14d33b02a497e46f470d30180a09a1057c6802c1f37b0efbf82cbdc47a8ae7ff\nWhen the Windows executable for Redaman is first run, it checks for the following files or directories on the local host (C:\\ or D:\\ drives):\nC:\\cuckoo \nC:\\fake_drive \nC:\\perl \nC:\\strawberry \nC:\\targets.xls \nC:\\tsl \nC:\\wget.exe \nC:\\*python*\nIf any of the above files or directories exist, the Windows executable throws an exception and exits. This indicates Redaman checks if it is running in a sandbox or similar type of analysis environment.\nIf no exceptions occur, the Windows executable drops a DLL file in the user'sAppData\\Local\\Temp\\directory, creates a randomly-named folder underC:\\ProgramData\\directory and moves the DLL under that folder as a random file name. This Redaman DLL is made persistent through a scheduled Windows task with the following properties:\nName: Windows Update \nDescription: Updating Windows components. \nTriggers: Executed whenever the user logs on \nAction:rundll32.exe \"C:\\ProgramData\\%random value%\\%random value.random 3-character extension%\",DllGetClassObject host\nAfter creating a scheduled task and causing the DLL to load, the initial Redaman executable file deletes itself.\nFigure 7: Example of a Redaman DLL persistent through a scheduled task.\nFigure 8: Process Hacker showing the Redaman DLL active using rundll32.exe.\nRedaman uses an application-defined hook procedure to monitor browser activity, specifically Chrome, Firefox, and Internet Explorer. It then searches the local host for information related to the financial sector. Other capabilities of Redaman include:\nDownloading files to the infected host \nKeylogging activity \nCapture screen shots and record video of the Windows desktop \nCollecting and exfiltrating financial data, specifically targeting Russian banks \nSmart card monitoring \nShutting down the infected host \nAltering DNS configuration through the Windows host file \nRetrieving clipboard data \nTerminating running processes \nAdding certificates to the Windows store",
        "relationship": "1. [Relationships]: <process:Redaman malware,extracts,file:rar archive>. \n2. [Relationships]: <process:Redaman executable,creates,file:Redaman DLL>. \n3. [Relationships]: <process:Redaman executable,drops,file: DLL file>. \n4. [Relationships]: <process:Redaman executable,creates,file:randomly-named folder>. \n5. [Relationships]: <process:Redaman executable,moves,file: DLL file>. \n6. [Relationships]: <process:rundll32.exe,loads,file:Redaman DLL>. \n7. [Relationships]: <process:Redaman,monitors,process:Chrome>. \n8. [Relationships]: <process:Redaman,monitors,process:Firefox>. \n9. [Relationships]: <process:Redaman,monitors,process:Internet Explorer>. \n10. [Relationships]: <process:Redaman,searches,file:local host>. \n11. [Relationships]: <process:Redaman,downloads,file:files>. \n12. [Relationships]: <process:Redaman,keylogs,socket:keyboard>. \n13. [Relationships]: <process:Redaman,captures,socket:screen>. \n14. [Relationships]: <process:Redaman,records,socket:Windows desktop>. \n15. [Relationships]: <process:Redaman,collects,file:financial data>. \n16. [Relationships]: <process:Redaman,exfiltrates,file:financial data>. \n17. [Relationships]: <process:Redaman,monitors,socket:smart card>. \n18. [Relationships]: <process:Redaman,shuts down,process:infected host>. \n19. [Relationships]: <process:Redaman,alters,file:DNS configuration>. \n20. [Relationships]: <process:Redaman,retrieves,socket:clipboard data>. \n21. [Relationships]: <process:Redaman,terminates,process:running processes>. \n22. [Relationships]: <process:Redaman,adds,file:certificates>. "
    },
    {
        "phase": "command and control",
        "content": "We generated the following infection traffic using the executable with SHA256 hash cd961e81366c8d9756799ec8df14edaac5e3ae4432c3dbf8e3dd390e90c3e22f on November 14th, 2018:\n104.28.16[.]33 port 443 -namecha[.]in- GET /name/d/stat-counter-3-1 \n185.141.61[.]246 port 80 -185.141.61[.]246- POST /index.php \n193.37.213[.]28 port 80 -193.37.213[.]28- POST /p/g_3453456jawd346.php\nFigure 9: Redaman infection traffic filtered in Wireshark.\nNetwork activity started with an HTTPS URL tonamecha[.]in, which is an alternative namecoin block explorer.Namecoinis a cryptocurrency system that can be used for decentralized DNS. That proves to be the case here, since the URL returned an IP address used for subsequent post-infection traffic as shown in Figure 10.\nFigure 10: Data returned fromnamecha[.]inused for subsequent infection traffic.\nDuring the infection, callback traffic was periodically sent to a command and control (C2) sever at 185.141.61[.]246. Shortly after the infection, return traffic from the C2 server sent a Pony variant DLL to the infected Windows client.\nFigure 11: Using Wireshark to find 58 kB of encoded data returned from the C2 server at 185.141.61[.]246.\nData for the Pony variant DLL was XOR encoded with multiple XOR keys andRTLcompressed. The SHA256 of this Pony variant DLL is b4701d95219d465e978c4a815fcce89787916da33ae2a49d0e76d4445fd39ada, and it generated traffic to193.37.213[.]28/p/g_3453456jawd346.phpduring the infection.",
        "relationship": "1. [Relationships]: <process:namecha[.]in,GET,socket:104.28.16[.]33 port 443>. \n2. [Relationships]: <process:185.141.61[.]246,POST,socket:185.141.61[.]246 port 80>. \n3. [Relationships]: <process:193.37.213[.]28,POST,socket:193.37.213[.]28 port 80>. \n4. [Relationships]: <process:C2 server,send,socket:185.141.61[.]246>. \n5. [Relationships]: <process:185.141.61[.]246,return,socket:Windows client>. \n6. [Relationships]: <process:Pony variant DLL,generate,socket:193.37.213[.]28/p/g_3453456jawd346.php>. "
    }
]