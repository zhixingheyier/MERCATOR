// Threat Graph
digraph {
	rankdir=LR
	1 [label="spear phishing email process" shape=diamond]
	2 [label=".doc" shape=rectangle]
	3 [label="doc files process" shape=diamond]
	4 [label="CVE2012-0158 and CVE-2013-3906" shape=circle]
	5 [label="Microsoft Word" shape=diamond]
	6 [label="C2 servers process" shape=diamond]
	7 [label="C2 servers" shape=ellipse]
	8 [label="compromised coworkers' accounts" shape=diamond]
	9 [label=".rar" shape=rectangle]
	10 [label="remote code execution vulnerability" shape=diamond]
	11 [label=Carbanak shape=diamond]
	12 [label="drive-by-download attack" shape=diamond]
	13 [label="Null and the RedKit exploits kits" shape=diamond]
	14 [label="%system32%\com\svchost.exe" shape=rectangle]
	15 [label="original file created by the exploit payload" shape=rectangle]
	16 [label="avp.exe or avpui.exe" shape=diamond]
	17 [label="%COMMON_APPDATA%\Mozilla\random.bin" shape=rectangle]
	18 [label="[HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings]" shape=pentagon]
	19 [label="%AppData%\Mozilla\Firefox\<ProfileName" shape=rectangle]
	20 [label="svchost.exe" shape=diamond]
	21 [label="kldconfig.plug" shape=ellipse]
	22 [label=keystrokes shape=rectangle]
	23 [label=screenshots shape=rectangle]
	24 [label="Termservice service" shape=diamond]
	25 [label="termsrv.dll" shape=rectangle]
	26 [label="csrsrv.dll" shape=rectangle]
	27 [label="msgina.dll" shape=rectangle]
	28 [label="winlogon.exe" shape=rectangle]
	29 [label="monitoring data to its C2 server" shape=ellipse]
	30 [label="commands from its C2 server" shape=ellipse]
	31 [label="footprintcrsgn.dll" shape=diamond]
	32 [label="PAExec_Move0.dat" shape=diamond]
	33 [label="PAExec-6980-PB-FS-01.ex_" shape=diamond]
	34 [label="Ammyy Admin remote administration tool" shape=diamond]
	35 [label="190.97.165.126" shape=ellipse]
	36 [label=victim shape=diamond]
	37 [label="operatemesscont.net" shape=ellipse]
	38 [label=attackers shape=diamond]
	39 [label="SSH daemon" shape=diamond]
	40 [label=Metasploit shape=diamond]
	41 [label="Carbanak instances" shape=diamond]
	42 [label="collected monitoring data" shape=ellipse]
	43 [label=commands shape=ellipse]
	44 [label="Windows servers" shape=diamond]
	45 [label="victim systems" shape=diamond]
	46 [label="C2 servers" shape=diamond]
	47 [label="Ammyy files" shape=rectangle]
	48 [label="KLG plugin configuration" shape=rectangle]
	49 [label="VNC server" shape=rectangle]
	50 [label="observed servers" shape=diamond]
	51 [label="Metasploit module" shape=rectangle]
	52 [label="Metasploit module" shape=diamond]
	53 [label=servers shape=diamond]
	54 [label=databases shape=rectangle]
	1 -> 2 [label="0. initial access_Write"]
	1 -> 3 [label="1. initial access_Fork"]
	1 -> 8 [label="6. initial access_Fork"]
	1 -> 9 [label="7. initial access_Write"]
	1 -> 10 [label="8. initial access_Fork"]
	1 -> 12 [label="10. initial access_Fork"]
	3 -> 4 [label="2. initial access_Fork"]
	3 -> 5 [label="3. initial access_Inject"]
	3 -> 6 [label="4. initial access_Fork"]
	6 -> 7 [label="5. initial access_Connect"]
	10 -> 11 [label="9. initial access_Fork"]
	11 -> 14 [label="12. execution_Write"]
	11 -> 15 [label="13. execution_Delete"]
	11 -> 16 [label="14. execution_Fork"]
	11 -> 17 [label="15. execution_Create"]
	11 -> 18 [label="16. execution_Readkey"]
	11 -> 19 [label="17. execution_Read"]
	11 -> 20 [label="18. execution_Inject"]
	11 -> 21 [label="19. execution_Connect"]
	11 -> 22 [label="20. execution_Write"]
	11 -> 23 [label="21. execution_Write"]
	11 -> 24 [label="22. execution_Inject"]
	11 -> 25 [label="23. execution_Write"]
	11 -> 26 [label="24. execution_Write"]
	11 -> 27 [label="25. execution_Write"]
	11 -> 28 [label="26. execution_Write"]
	11 -> 29 [label="27. execution_Send"]
	11 -> 30 [label="28. execution_Receive"]
	11 -> 31 [label="29. execution_Loadlibrary"]
	11 -> 32 [label="30. execution_Fork"]
	11 -> 33 [label="31. execution_Fork"]
	11 -> 34 [label="32. command and control_Fork"]
	11 -> 36 [label="34. command and control_Fork"]
	11 -> 38 [label="36. command and control_Fork"]
	11 -> 41 [label="39. command and control_Fork"]
	11 -> 44 [label="42. command and control_Fork"]
	11 -> 46 [label="44. command and control_Fork"]
	11 -> 50 [label="48. command and control_Fork"]
	11 -> 53 [label="51. command and control_Fork"]
	12 -> 13 [label="11. initial access_Fork"]
	34 -> 35 [label="33. command and control_Send"]
	36 -> 37 [label="35. command and control_Fork"]
	38 -> 39 [label="37. command and control_Inject"]
	38 -> 40 [label="38. command and control_Fork"]
	41 -> 42 [label="40. command and control_Receive"]
	41 -> 43 [label="41. command and control_Receive"]
	44 -> 45 [label="43. command and control_Connect"]
	46 -> 47 [label="45. command and control_Create"]
	46 -> 48 [label="46. command and control_Create"]
	46 -> 49 [label="47. command and control_Inject"]
	50 -> 51 [label="49. command and control_Execute"]
	50 -> 52 [label="50. command and control_Fork"]
	53 -> 54 [label="52. command and control_Write"]
}
