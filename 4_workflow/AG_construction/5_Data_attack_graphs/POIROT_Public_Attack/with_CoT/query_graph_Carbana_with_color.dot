// Threat Graph
digraph {
	rankdir=LR
	1 [label="spear phishing email process" shape=diamond]
	2 [label=".doc" shape=rectangle]
	3 [label="doc files process" shape=diamond]
	4 [label="CVE2012-0158 and CVE-2013-3906" shape=circle]
	5 [label="Microsoft Word" shape=diamond]
	6 [label="C2 servers process" shape=diamond]
	7 [label="C2 servers" shape=ellipse]
	8 [label="compromised coworkers' accounts" shape=diamond]
	9 [label=".rar" shape=rectangle]
	10 [label="remote code execution vulnerability" shape=diamond]
	11 [label=Carbanak shape=diamond]
	12 [label="drive-by-download attack" shape=diamond]
	13 [label="Null and the RedKit exploits kits" shape=diamond]
	14 [label="%system32%\com\svchost.exe" shape=rectangle]
	15 [label="original file created by the exploit payload" shape=rectangle]
	16 [label="avp.exe or avpui.exe" shape=diamond]
	17 [label="%COMMON_APPDATA%\Mozilla\random.bin" shape=rectangle]
	18 [label="[HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings]" shape=pentagon]
	19 [label="%AppData%\Mozilla\Firefox\<ProfileName" shape=rectangle]
	20 [label="svchost.exe" shape=diamond]
	21 [label="kldconfig.plug" shape=ellipse]
	22 [label=keystrokes shape=rectangle]
	23 [label=screenshots shape=rectangle]
	24 [label="Termservice service" shape=diamond]
	25 [label="termsrv.dll" shape=rectangle]
	26 [label="csrsrv.dll" shape=rectangle]
	27 [label="msgina.dll" shape=rectangle]
	28 [label="winlogon.exe" shape=rectangle]
	29 [label="monitoring data to its C2 server" shape=ellipse]
	30 [label="commands from its C2 server" shape=ellipse]
	31 [label="footprintcrsgn.dll" shape=diamond]
	32 [label="PAExec_Move0.dat" shape=diamond]
	33 [label="PAExec-6980-PB-FS-01.ex_" shape=diamond]
	34 [label="Ammyy Admin remote administration tool" shape=diamond]
	35 [label="190.97.165.126" shape=ellipse]
	36 [label=victim shape=diamond]
	37 [label="operatemesscont.net" shape=ellipse]
	38 [label=attackers shape=diamond]
	39 [label="SSH daemon" shape=diamond]
	40 [label=Metasploit shape=diamond]
	41 [label="Carbanak instances" shape=diamond]
	42 [label="collected monitoring data" shape=ellipse]
	43 [label=commands shape=ellipse]
	44 [label="Windows servers" shape=diamond]
	45 [label="victim systems" shape=diamond]
	46 [label="C2 servers" shape=diamond]
	47 [label="Ammyy files" shape=rectangle]
	48 [label="KLG plugin configuration" shape=rectangle]
	49 [label="VNC server" shape=rectangle]
	50 [label="observed servers" shape=diamond]
	51 [label="Metasploit module" shape=rectangle]
	52 [label="Metasploit module" shape=diamond]
	53 [label=servers shape=diamond]
	54 [label=databases shape=rectangle]
	1 -> 2 [label="0_initial access_Write" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	1 -> 3 [label="1_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	1 -> 8 [label="6_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	1 -> 9 [label="7_initial access_Write" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	1 -> 10 [label="8_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	1 -> 12 [label="10_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	3 -> 4 [label="2_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	3 -> 5 [label="3_initial access_Inject" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	3 -> 6 [label="4_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	6 -> 7 [label="5_initial access_Connect" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	10 -> 11 [label="9_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	11 -> 14 [label="12_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 15 [label="13_execution_Delete" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 16 [label="14_execution_Fork" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 17 [label="15_execution_Create" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 18 [label="16_execution_Readkey" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 19 [label="17_execution_Read" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 20 [label="18_execution_Inject" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 21 [label="19_execution_Connect" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 22 [label="20_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 23 [label="21_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 24 [label="22_execution_Inject" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 25 [label="23_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 26 [label="24_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 27 [label="25_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 28 [label="26_execution_Write" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 29 [label="27_execution_Send" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 30 [label="28_execution_Receive" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 31 [label="29_execution_Loadlibrary" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 32 [label="30_execution_Fork" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 33 [label="31_execution_Fork" color="#00FF00" fontcolor="#00FF00" fontsize=10]
	11 -> 34 [label="32_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 36 [label="34_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 38 [label="36_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 41 [label="39_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 44 [label="42_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 46 [label="44_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 50 [label="48_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	11 -> 53 [label="51_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	12 -> 13 [label="11_initial access_Fork" color="#FFFF00" fontcolor="#FFFF00" fontsize=10]
	34 -> 35 [label="33_command and control_Send" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	36 -> 37 [label="35_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	38 -> 39 [label="37_command and control_Inject" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	38 -> 40 [label="38_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	41 -> 42 [label="40_command and control_Receive" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	41 -> 43 [label="41_command and control_Receive" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	44 -> 45 [label="43_command and control_Connect" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	46 -> 47 [label="45_command and control_Create" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	46 -> 48 [label="46_command and control_Create" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	46 -> 49 [label="47_command and control_Inject" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	50 -> 51 [label="49_command and control_Execute" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	50 -> 52 [label="50_command and control_Fork" color="#FF6347" fontcolor="#FF6347" fontsize=10]
	53 -> 54 [label="52_command and control_Write" color="#FF6347" fontcolor="#FF6347" fontsize=10]
}
