// Threat Graph
digraph {
	rankdir=LR
	1 [label="Waterbear plugin" shape=diamond]
	2 [label="chosen process" shape=diamond]
	3 [label="C&C IP address" shape=ellipse]
	4 [label="Waterbear RAT" shape=diamond]
	5 [label="list of drives and files" shape=rectangle]
	6 [label="Waterbear downloader" shape=rectangle]
	7 [label="Earth Hundun" shape=diamond]
	8 [label="C&C string" shape=ellipse]
	9 [label=loader shape=diamond]
	10 [label=downloader shape=rectangle]
	11 [label="execution_*" shape=diamond]
	12 [label="first stage RAT" shape=rectangle]
	13 [label="first stage Deuterbear" shape=diamond]
	14 [label=loader shape=rectangle]
	15 [label="encrypted downloader" shape=rectangle]
	16 [label=registries shape=pentagon]
	17 [label="Deuterbear RAT" shape=diamond]
	18 [label="HTTPS tunnel" shape=ellipse]
	19 [label=traffic shape=ellipse]
	20 [label="C&C server" shape=ellipse]
	21 [label="RAT command 975" shape=ellipse]
	22 [label=Deuterbear shape=diamond]
	23 [label=shellcode shape=ellipse]
	24 [label="PE(DLL)" shape=rectangle]
	25 [label="command and control_*" shape=diamond]
	1 -> 2 [label="0. initial access_Inject"]
	1 -> 3 [label="1. initial access_Connect"]
	1 -> 4 [label="2. initial access_Fork"]
	4 -> 5 [label="3. initial access_Read"]
	4 -> 6 [label="4. initial access_Write"]
	4 -> 7 [label="5. initial access_Fork"]
	4 -> 9 [label="7. execution_Fork"]
	4 -> 11 [label="9. execution_Fork"]
	4 -> 13 [label="11. execution_Fork"]
	7 -> 8 [label="6. initial access_Connect"]
	9 -> 10 [label="8. execution_Read"]
	11 -> 12 [label="10. execution_Write"]
	13 -> 14 [label="12. execution_Create"]
	13 -> 15 [label="13. execution_Create"]
	13 -> 16 [label="14. execution_Writekey"]
	13 -> 17 [label="15. command and control_Fork"]
	17 -> 18 [label="16. command and control_Connect"]
	17 -> 19 [label="17. command and control_Receive"]
	17 -> 19 [label="18. command and control_Send"]
	17 -> 19 [label="19. command and control_Receive"]
	17 -> 19 [label="20. command and control_Send"]
	17 -> 20 [label="21. command and control_Send"]
	17 -> 21 [label="22. command and control_Connect"]
	17 -> 22 [label="23. command and control_Fork"]
	17 -> 25 [label="26. command and control_Fork"]
	22 -> 23 [label="24. command and control_Receive"]
	22 -> 24 [label="25. command and control_Write"]
	25 -> 19 [label="27. command and control_Send"]
}
