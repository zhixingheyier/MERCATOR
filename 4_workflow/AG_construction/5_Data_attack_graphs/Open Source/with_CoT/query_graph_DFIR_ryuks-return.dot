// Threat Graph
digraph {
	rankdir=LR
	1 [label=user shape=diamond]
	2 [label="Document-Preview.exe" shape=rectangle]
	3 [label="Document-Preview.exe" shape=diamond]
	4 [label="5.182.210[.]145" shape=ellipse]
	5 [label=WMI shape=diamond]
	6 [label=dll shape=diamond]
	7 [label="execution_*" shape=diamond]
	8 [label="process injection" shape=diamond]
	9 [label=reg shape=diamond]
	10 [label="Windows Defender" shape=diamond]
	11 [label="adf.bat" shape=diamond]
	12 [label="text files" shape=rectangle]
	13 [label="discovery_*" shape=diamond]
	14 [label="lateral movement_*" shape=diamond]
	15 [label="MS17-010" shape=diamond]
	16 [label="lateral movement" shape=diamond]
	17 [label=SMB shape=diamond]
	18 [label="additional payload" shape=rectangle]
	19 [label="Cobalt Strike beacon executable" shape=rectangle]
	20 [label="domain controller" shape=diamond]
	21 [label="martahzz[.]com â€“88.119.171[.]75:443" shape=ellipse]
	22 [label=Bazar shape=diamond]
	23 [label="5.182.210.145:443" shape=ellipse]
	24 [label="Cobalt strike" shape=diamond]
	25 [label="88.119.171.75:443" shape=ellipse]
	26 [label="107.173.58.183:443" shape=ellipse]
	27 [label=vsftpd shape=diamond]
	28 [label="45.141.84[.]120" shape=ellipse]
	29 [label="Ryuk executables" shape=rectangle]
	30 [label=system shape=diamond]
	31 [label="RDP connections from the first compromised DC" shape=ellipse]
	32 [label=ransomware shape=diamond]
	33 [label="Backup servers" shape=diamond]
	34 [label="impact_*" shape=diamond]
	35 [label="thewbadminmsc console" shape=diamond]
	1 -> 2 [label="0. initial access_Execute"]
	1 -> 3 [label="1. initial access_Fork"]
	1 -> 5 [label="3. execution_Fork"]
	1 -> 7 [label="5. execution_Fork"]
	1 -> 9 [label="7. defense evasion_Fork"]
	1 -> 11 [label="9. discovery_Fork"]
	1 -> 13 [label="11. discovery_Fork"]
	1 -> 14 [label="13. lateral movement_Fork"]
	1 -> 16 [label="15. lateral movement_Fork"]
	3 -> 4 [label="2. initial access_Connect"]
	5 -> 6 [label="4. execution_Fork"]
	7 -> 8 [label="6. execution_Inject"]
	9 -> 10 [label="8. defense evasion_Exit"]
	11 -> 12 [label="10. discovery_Write"]
	13 -> 5 [label="12. discovery_Fork"]
	14 -> 15 [label="14. lateral movement_Fork"]
	14 -> 18 [label="17. lateral movement_Create"]
	14 -> 19 [label="18. lateral movement_Write"]
	14 -> 20 [label="19. lateral movement_Fork"]
	14 -> 22 [label="21. command and control_Fork"]
	14 -> 24 [label="23. command and control_Fork"]
	14 -> 27 [label="27. exfiltration_Fork"]
	14 -> 30 [label="30. impact_Fork"]
	14 -> 32 [label="32. impact_Fork"]
	14 -> 34 [label="34. impact_Fork"]
	16 -> 17 [label="16. lateral movement_Fork"]
	17 -> 29 [label="29. impact_Write"]
	20 -> 21 [label="20. lateral movement_Connect"]
	22 -> 23 [label="22. command and control_Connect"]
	22 -> 26 [label="25. command and control_Connect"]
	24 -> 25 [label="24. command and control_Connect"]
	24 -> 26 [label="26. command and control_Connect"]
	27 -> 28 [label="28. exfiltration_Send"]
	30 -> 31 [label="31. impact_Connect"]
	32 -> 33 [label="33. impact_Fork"]
	34 -> 35 [label="35. impact_Fork"]
}
