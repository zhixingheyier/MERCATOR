// Threat Graph
digraph {
	rankdir=LR
	1 [label="external link" shape=diamond]
	2 [label="defrt.html" shape=rectangle]
	3 [label=payload shape=diamond]
	4 [label="oehrjd.exe" shape=rectangle]
	5 [label="VBA script" shape=diamond]
	6 [label="DD.inf" shape=rectangle]
	7 [label="DD.inf" shape=diamond]
	8 [label="ema.tmp" shape=rectangle]
	9 [label="des.jpg" shape=rectangle]
	10 [label=rundll32 shape=rectangle]
	11 [label="temporary files" shape=rectangle]
	12 [label="INF file" shape=rectangle]
	13 [label="DLL file" shape=rectangle]
	14 [label="DLL file" shape=diamond]
	15 [label="https[:]//vertebromed[.]md/temp/dhssdf[.]exe" shape=ellipse]
	16 [label="dhssdf.exe" shape=rectangle]
	17 [label="IMG_3360_103pdf.exe" shape=diamond]
	18 [label=LokiBot shape=rectangle]
	19 [label="C2 IP" shape=ellipse]
	20 [label=injector shape=diamond]
	21 [label="predetermined strings" shape=rectangle]
	22 [label="API string" shape=rectangle]
	23 [label=payload shape=rectangle]
	24 [label="decrypted data" shape=rectangle]
	25 [label="PEB (Process Environment Block)" shape=diamond]
	26 [label=NtGlobalFlag shape=diamond]
	27 [label="\VMWare and \Oracle\virtualbox guest additions" shape=rectangle]
	28 [label="Sleep()" shape=diamond]
	29 [label=ProcessDebugObjectHandle shape=diamond]
	30 [label=memory shape=rectangle]
	31 [label=LokiBot shape=diamond]
	32 [label="web browsers" shape=diamond]
	33 [label=FTP shape=diamond]
	34 [label=email shape=diamond]
	35 [label="%APPDATA%\Roaming\576094" shape=rectangle]
	36 [label="47DD9F.exe" shape=rectangle]
	37 [label="47DD9F.exe(hidden)" shape=rectangle]
	38 [label=D0BECCE5760947DD9FFD80DB shape=rectangle]
	39 [label="array of targeted software names" shape=rectangle]
	1 -> 2 [label="0. initial access_Write"]
	1 -> 3 [label="1. initial access_Fork"]
	3 -> 4 [label="2. initial access_Write"]
	3 -> 5 [label="3. initial access_Fork"]
	5 -> 6 [label="4. initial access_Execute"]
	5 -> 7 [label="5. initial access_Fork"]
	5 -> 8 [label="6. initial access_Create"]
	5 -> 9 [label="7. initial access_Write"]
	5 -> 10 [label="8. initial access_Loadlibrary"]
	5 -> 11 [label="9. initial access_Delete"]
	5 -> 12 [label="10. execution_Create"]
	5 -> 13 [label="11. execution_Loadlibrary"]
	5 -> 14 [label="12. execution_Fork"]
	5 -> 17 [label="15. execution_Fork"]
	5 -> 20 [label="18. execution_Fork"]
	14 -> 15 [label="13. execution_Connect"]
	14 -> 16 [label="14. execution_Inject"]
	17 -> 18 [label="16. execution_Loadlibrary"]
	17 -> 19 [label="17. execution_Connect"]
	20 -> 21 [label="19. execution_Read"]
	20 -> 22 [label="20. execution_Write"]
	20 -> 22 [label="21. execution_Read"]
	20 -> 23 [label="22. execution_Read"]
	20 -> 23 [label="23. execution_Write"]
	20 -> 24 [label="24. execution_Write"]
	20 -> 25 [label="25. execution_Read"]
	20 -> 26 [label="26. execution_Readkey"]
	20 -> 27 [label="27. execution_Read"]
	20 -> 28 [label="28. execution_Fork"]
	20 -> 29 [label="29. execution_Inject"]
	20 -> 30 [label="30. execution_Read"]
	20 -> 31 [label="31. execution_Inject"]
	31 -> 32 [label="32. collection_Inject"]
	31 -> 33 [label="33. collection_Inject"]
	31 -> 34 [label="34. collection_Inject"]
	31 -> 35 [label="35. collection_Write"]
	31 -> 36 [label="36. collection_Create"]
	31 -> 37 [label="37. collection_Attribute"]
	31 -> 38 [label="38. collection_Read"]
	31 -> 39 [label="39. collection_Write"]
}
