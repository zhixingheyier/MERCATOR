// Threat Graph
digraph {
	rankdir=LR
	1 [label="Microsoft Word document" shape=diamond]
	2 [label="malicious VBA macro" shape=diamond]
	3 [label=PowerShell shape=diamond]
	4 [label="Microsoft Word document Shapes(\"j6h1cf\")" shape=diamond]
	5 [label=C2 shape=ellipse]
	6 [label="AppData directory executable" shape=rectangle]
	7 [label="AppData directory executable" shape=diamond]
	8 [label=Ursnif shape=diamond]
	9 [label="APHohema key" shape=pentagon]
	10 [label=WMIC shape=diamond]
	11 [label="Authicap key" shape=pentagon]
	12 [label="/output:clipboard" shape=rectangle]
	13 [label="hexadecimal-encoded PowerShell command" shape=rectangle]
	14 [label="hexadecimal-encoded PowerShell command" shape=diamond]
	15 [label="decode base64 encoded PowerShell" shape=diamond]
	16 [label="malicious DLL" shape=rectangle]
	17 [label="base64 decode function" shape=diamond]
	18 [label="Invoke-Expression" shape=diamond]
	19 [label="APC Injection" shape=diamond]
	20 [label="kernel32.dll" shape=rectangle]
	21 [label=APIs shape=diamond]
	22 [label=QueueUserAPC shape=diamond]
	23 [label="current thread" shape=diamond]
	24 [label=SleepEx shape=diamond]
	25 [label="%TEMP%\*.bin" shape=rectangle]
	26 [label="data to be exfiltrated" shape=rectangle]
	27 [label="makecab.exe" shape=diamond]
	28 [label="MakeCab directive file in the %TEMP% directory" shape=rectangle]
	1 -> 2 [label="0. initial access_Fork"]
	2 -> 3 [label="1. initial access_Fork"]
	3 -> 4 [label="2. initial access_Read"]
	3 -> 5 [label="3. initial access_Receive"]
	3 -> 6 [label="4. initial access_Execute"]
	3 -> 7 [label="5. initial access_Fork"]
	3 -> 8 [label="6. execution_Fork"]
	3 -> 9 [label="8. execution_Readkey"]
	3 -> 10 [label="9. execution_Fork"]
	3 -> 13 [label="14. execution_Execute"]
	3 -> 14 [label="15. execution_Fork"]
	3 -> 15 [label="16. execution_Fork"]
	3 -> 16 [label="17. execution_Create"]
	3 -> 17 [label="18. execution_Execute"]
	3 -> 18 [label="19. execution_Execute"]
	3 -> 19 [label="20. execution_Fork"]
	3 -> 20 [label="21. execution_Loadlibrary"]
	3 -> 21 [label="22. execution_Loadlibrary"]
	3 -> 22 [label="23. defense evasion_Fork"]
	3 -> 24 [label="25. defense evasion_Fork"]
	3 -> 27 [label="29. exfiltration_Fork"]
	8 -> 9 [label="7. execution_Createkey"]
	8 -> 25 [label="27. exfiltration_Create"]
	8 -> 26 [label="28. exfiltration_Write"]
	10 -> 3 [label="10. execution_Fork"]
	10 -> 11 [label="11. execution_Readkey"]
	10 -> 11 [label="12. execution_Readkey"]
	10 -> 12 [label="13. execution_Write"]
	22 -> 23 [label="24. defense evasion_Fork"]
	24 -> 23 [label="26. defense evasion_Inject"]
	27 -> 28 [label="30. exfiltration_Create"]
}
