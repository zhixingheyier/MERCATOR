// Threat Graph
digraph {
	rankdir=LR
	1 [label="Waterbear RAT (A)" shape=diamond]
	2 [label="Waterbear plugin" shape=diamond]
	3 [label="64-bit process" shape=diamond]
	4 [label="Waterbear downloader" shape=diamond]
	5 [label="new C&C IP address" shape=ellipse]
	6 [label="Waterbear RAT (B)" shape=diamond]
	7 [label="list of drives and files" shape=rectangle]
	8 [label="initial access_*" shape=diamond]
	9 [label="other C&C servers" shape=ellipse]
	10 [label=loader shape=diamond]
	11 [label=downloader shape=rectangle]
	12 [label="execution_*" shape=diamond]
	13 [label="first stage RAT" shape=diamond]
	14 [label="appropriate folder" shape=rectangle]
	15 [label=loader shape=rectangle]
	16 [label="encrypted downloader" shape=rectangle]
	17 [label=registries shape=pentagon]
	18 [label="Deuterbear RAT" shape=diamond]
	19 [label="HTTPS tunnel" shape=ellipse]
	20 [label=traffic shape=ellipse]
	21 [label="desired function" shape=rectangle]
	22 [label="victim information to C&C server" shape=ellipse]
	23 [label=Deuterbear shape=diamond]
	24 [label="" shape=diamond]
	25 [label="" shape=rectangle]
	26 [label="" shape=ellipse]
	27 [label="PE DLL" shape=rectangle]
	28 [label="command and control_*" shape=diamond]
	29 [label="first shellcode" shape=rectangle]
	30 [label="first shellcode" shape=diamond]
	31 [label="second shellcode" shape=rectangle]
	32 [label="second shellcode" shape=diamond]
	33 [label="first export function of PE(DLL)" shape=rectangle]
	34 [label="first export function of PE(DLL)" shape=diamond]
	1 -> 2 [label="0. initial access_Connect"]
	2 -> 3 [label="1. initial access_Inject"]
	2 -> 4 [label="2. initial access_Fork"]
	4 -> 5 [label="3. initial access_Connect"]
	4 -> 6 [label="4. initial access_Fork"]
	6 -> 7 [label="5. initial access_Read"]
	6 -> 8 [label="6. initial access_Fork"]
	8 -> 9 [label="7. initial access_Connect"]
	8 -> 10 [label="8. execution_Fork"]
	10 -> 11 [label="9. execution_Write"]
	10 -> 12 [label="10. execution_Fork"]
	12 -> 13 [label="11. execution_Fork"]
	12 -> 15 [label="13. execution_Create"]
	12 -> 16 [label="14. execution_Write"]
	12 -> 17 [label="15. execution_Writekey"]
	12 -> 18 [label="16. command and control_Fork"]
	13 -> 14 [label="12. execution_Read"]
	18 -> 19 [label="17. command and control_Connect"]
	18 -> 20 [label="18. command and control_Receive"]
	18 -> 20 [label="19. command and control_Connect"]
	18 -> 21 [label="20. command and control_Read"]
	18 -> 21 [label="21. command and control_Write"]
	18 -> 22 [label="22. command and control_Send"]
	18 -> 23 [label="23. command and control_Fork"]
	18 -> 28 [label="28. command and control_Fork"]
	23 -> 24 [label="24. command and control_Fork"]
	23 -> 25 [label="25. command and control_Read"]
	23 -> 26 [label="26. command and control_Connect"]
	23 -> 27 [label="27. command and control_Write"]
	23 -> 29 [label="30. command and control_Execute"]
	23 -> 30 [label="31. command and control_Fork"]
	23 -> 31 [label="32. command and control_Execute"]
	23 -> 32 [label="33. command and control_Fork"]
	23 -> 33 [label="34. command and control_Execute"]
	23 -> 34 [label="35. command and control_Fork"]
	28 -> 23 [label="29. command and control_Send"]
}
