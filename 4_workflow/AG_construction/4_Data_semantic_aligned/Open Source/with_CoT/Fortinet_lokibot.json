[
    {
        "phase": "initial access",
        "content": "During May 2023, we obtained two types of Word documents for analysis. The first type featured an external link embedded within an XML file, \"word/_rels/document.xml.rels,\" while the second type included a VBA script that executed a macro immediately upon opening the document. Notably, both files contained a strikingly similar bait image, depicted in Figure 1.\nThe Word document that targets CVE-2021-40444 contained a file \"document.xml.rels\", shown in Figure 2, with an external link using MHTML (MIME encapsulation of aggregate HTML documents). This web archive file format combines a website's HTML code and companion resources into a single file. This link also uses Cuttly, a URL shortener and link management platform, to redirect users to the cloud file-sharing website, \"GoFile.\" Further analysis revealed that a file named \"defrt.html\" was downloaded upon accessing the link. This file exploits the second vulnerability, CVE-2022-30190. The content of this file and the decoded data is displayed in Figure 3.\nUpon executing the payload, it initiates the download of an injector file named \"oehrjd.exe\" from the following URL: http[:]//pcwizard[.]net/yz/ftp/. Detailed information regarding the execution file can be found in the subsequent section.\nThe second document was discovered towards the end of May. Upon analyzing the VBA script embedded within the Word document, as illustrated in Figure 4, the code is automatically executed due to its use of the \"Auto_Open\" and \"Document_Open\" functions. Various arrays are decoded within the script and saved to a temporary folder under the name \"DD.inf\" (Figure 5). It includes a command to create an \"ema.tmp\" file to store data after line 29 in the \"DD.inf\" file. The data is then encoded using the \"ecodehex\" function and saved as \"des.jpg\". The script then uses rundll32 to load a DLL file with the function \"maintst.\" Finally, it deletes all temporary, JPG, and INF files created throughout this process.",
        "relationship": "1. [CoT]: The text states that the Word document contains an external link in \"word/_rels/document.xml.rels\" using MHTML. [Relationships]: <process:Word,contains,file:word/_rels/document.xml.rels>. \n2. [CoT]: The text mentions that accessing the external link downloads the file \"defrt.html\". [Relationships]: <process:external link,downloads,file:defrt.html>. \n3. [CoT]: The payload initiates the download of \"oehrjd.exe\" from a specified URL. [Relationships]: <process:payload,downloads,file:oehrjd.exe>. \n4. [CoT]: The VBA script automatically executes and decodes arrays to \"DD.inf\". [Relationships]: <process:VBA script,decodes,file:DD.inf>. \n5. [CoT]: The script creates \"ema.tmp\" to store data. [Relationships]: <process:VBA script,creates,file:ema.tmp>. \n6. [CoT]: The script encodes data to \"des.jpg\". [Relationships]: <process:VBA script,encodes,file:des.jpg>. \n7. [CoT]: The script uses rundll32 to load a DLL file with the function \"maintst\". [Relationships]: <process:VBA script,loads,file:rundll32>. \n8. [CoT]: The script deletes temporary, JPG, and INF files. [Relationships]: <process:VBA script,deletes,file:temporary files>. ",
        "semantic_relationship": "[CoT]: The original relationship states that Word contains the file \"document.xml.rels\". In system-level terms, this translates to the \"Contains\" relationship between a process and a file, as the process (Word) is storing or loading the file. [System-level Relationships]: <process:Word,Contains,file:word/_rels/document.xml.rels>. \n[CoT]: The original relationship \"downloads\" implies that the external link process writes the file \"defrt.html\" to disk, which corresponds to the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:external link,Write,file:defrt.html>. \n[CoT]: The original relationship \"downloads\" implies that the payload process is writing the downloaded content to a file named \"oehrjd.exe\". Therefore, the system-level relationship is mapped to \"Write\". [System-level Relationships]: <process:payload,Write,file:oehrjd.exe>. \n[CoT]: The original relationship \"decodes\" implies that the VBA script is executing the contents of the file \"DD.inf\". In system-level terms, this action corresponds to a process executing a file, hence the relationship is mapped to \"Execute\". [System-level Relationships]: <process:VBA script,Execute,file:DD.inf>. \n[CoT]: The original relationship states that the VBA script \"creates\" the file \"ema.tmp\". In system-level terms, this corresponds to a Process-to-File \"Create\" relationship, as the process is generating a new file. [System-level Relationships]: <process:VBA script,Create,file:ema.tmp>. \n[CoT]: The original relationship states that the VBA script \"encodes\" data to des.jpg. In system-level terms, this action involves writing data to the file des.jpg, hence the relationship is converted to \"Write\". [System-level Relationships]: <process:VBA script,Write,file:des.jpg>. \n[CoT]: The original relationship \"loads\" indicates that the VBA script is loading a DLL file, which corresponds to the system-level relationship \"Loadlibrary\" between a process and a file. [System-level Relationships]: <process:VBA script,Loadlibrary,file:rundll32>. \n[CoT]: The original relationship states that the VBA script deletes temporary files. In system-level terms, deleting a file corresponds to the \"Delete\" action between a process and a file, hence the relationship is mapped to \"Delete\". [System-level Relationships]: <process:VBA script,Delete,file:temporary files>. "
    },
    {
        "phase": "execution",
        "content": "As mentioned, the VBA script creates an INF file to load a DLL. The purpose of this DLL file, named \"des.jpg,\" is to download an injector from the URL \"https[:]//vertebromed[.]md/temp/dhssdf[.]exe\" for use in a later stage. It's worth noting that the download link doesn't belong to a typical file-sharing cloud platform or the attacker's command-and-control (C2) server. Instead, it leverages the website \"vertebromed.md,\" which has been active since 2018. The injector file, \"dhssdf.exe,\" was created on May 29, 2023, as shown in Figure 6. Additionally, within the same folder, we discovered another MSIL loader named \"IMG_3360_103pdf.exe,\" created on May 30, 2023. Although this file isn't directly involved in the Word document attack chain, it also loads LokiBot and connects to the same C2 IP.",
        "relationship": "1. [CoT]: The VBA script creates an INF file, indicating a process-to-file relationship where the process 'VBA script' creates the 'INF file'.   [Relationships]: <process:VBA script,creates,file:INF file>. \n2. [CoT]: The VBA script is designed to load a DLL file, showing a process-to-file relationship where the process 'VBA script' loads the 'DLL file'.   [Relationships]: <process:VBA script,loads,file:DLL file>. \n3. [CoT]: The DLL file, named \"des.jpg,\" is intended to download an injector from a specified URL, indicating a process-to-socket relationship where the process 'DLL file' downloads from the 'URL'.   [Relationships]: <process:DLL file,downloads,socket:https[:]//vertebromed[.]md/temp/dhssdf[.]exe>. \n4. [CoT]: The DLL file, named \"des.jpg,\" downloads an injector file named \"dhssdf.exe,\" showing a process-to-file relationship where the process 'DLL file' downloads the 'injector file'.   [Relationships]: <process:DLL file,downloads,file:dhssdf.exe>. \n5. [CoT]: The MSIL loader, \"IMG_3360_103pdf.exe,\" loads LokiBot, indicating a process-to-file relationship where the process 'MSIL loader' loads the 'LokiBot'.   [Relationships]: <process:IMG_3360_103pdf.exe,loads,file:LokiBot>. \n6. [CoT]: The MSIL loader, \"IMG_3360_103pdf.exe,\" connects to a C2 IP, showing a process-to-socket relationship where the process 'MSIL loader' connects to the 'C2 IP'. [Relationships]: <process:IMG_3360_103pdf.exe,connects,socket:C2 IP>. ",
        "semantic_relationship": "[CoT]: The original relationship states that the VBA script creates an INF file. In system-level terms, this corresponds to a Process-to-File 'Create' action, as the process is generating a new file. [System-level Relationships]: <process:VBA script,Create,file:INF file>. \n[CoT]: The original relationship 'loads' indicates that the VBA script is loading a DLL file, which aligns with the system-level relationship 'Loadlibrary' as it involves a process loading a dynamic-link library file. [System-level Relationships]: <process:VBA script,Loadlibrary,file:DLL file>. \n[CoT]: The original relationship describes a process downloading from a URL, which implies establishing a connection to a remote socket. In system-level terms, this is best represented as a 'Connect' relationship between the process and the socket. [System-level Relationships]: <process:DLL file,Connect,socket:https[:]//vertebromed[.]md/temp/dhssdf[.]exe>. \n[CoT]: The original relationship describes the DLL file downloading the dhssdf.exe file, which implies that the DLL file is injecting code into the executable file. In system-level terms, this is best represented as an \"Inject\" relationship from the process to the file. [System-level Relationships]: <process:DLL file,Inject,file:dhssdf.exe>. \n[CoT]: The original relationship describes a process loading a file, which in system-level terms corresponds to the 'Loadlibrary' relationship between a process and a file. This is a common technique used by malware to load external libraries or modules into memory. [System-level Relationships]: <process:IMG_3360_103pdf.exe,Loadlibrary,file:LokiBot>. \n[CoT]: The original relationship describes a process connecting to a socket, which directly maps to the system-level relationship 'Connect' between a process and a socket. This is a clear match for the Process-to-Socket category in the framework. [System-level Relationships]: <process:IMG_3360_103pdf.exe,Connect,socket:C2 IP>. "
    },
    {
        "phase": "execution",
        "content": "In this section, we analyze the injector obtained from Follina (SHA256: 9eaf7231579ab0cb65794043affb10ae8e4ad8f79ec108b5302da2f363b77c93). The injector is written in Visual Basic (VB), and we provide an overview of its basic information in Figure 7.\nInitially, the code extracts individual letters from predetermined strings. These letters are then combined to form an API string, subsequently mapped to the corresponding functions illustrated in Figure 8.\nThe injector utilizes a hardcoded key to decrypt the payload, as shown in Figure 9. The decryption process is outlined in pseudo-code in Figure 10. The decrypted data is decompressed using the \"RtlDecompressBufferEx\" API and the parameter \"COMPRESSION_FORMAT_LZNT1\". The complete procedure through Python code and the partial payload is illustrated in Figure 11.\nThe injector incorporates various evasion techniques, including:\nChecking the \"BeingDebugged\" flag of PEB (Process Environment Block) \nUtilizing the \"NtGlobalFlag\" to determine if the process was created by a debugger \nVerifying the existence of virtual machine paths, such as \"\\VMWare\" and \"\\Oracle\\virtualbox guest additions\" \nEmploying two calls to the \"GetTickCount\" API and using Sleep() to check if the time has been accelerated \nUsing the \"FindWindowW\" function to identify the presence of specific debuggers, such as \"OllyDbg,\" \"x64dbg\", \"x32dbg\", \"WindDbg,\" \"WinDbgFrameClass,\" \"ObsidianGUI,\" \"Soft Ice,\" \"ImmDbg,\" \"Zeta Debugger,\" and \"Rock Debugger\" \nChecking the \"ProcessDebugObjectHandle\" (0x1E)\nAfter obtaining the payload and verifying the overall environment, the injector utilizes the \"VirtualAllocEx\" function to allocate memory for the subsequent execution of LokiBot.",
        "relationship": "1. [CoT]: The text states that the injector extracts individual letters from predetermined strings, indicating a process-to-file relationship where the injector process performs the action of extracting from the predetermined strings (file).   [Relationships]: <process:injector,extracts,file:predetermined strings>. \n2. [CoT]: The text mentions that the letters are combined to form an API string, showing that the injector process combines letters from the file.   [Relationships]: <process:injector,combines,file:API string>. \n3. [CoT]: The injector maps the API string to corresponding functions, indicating a process-to-file relationship where the injector process performs the action of mapping to the API string (file).   [Relationships]: <process:injector,maps,file:API string>. \n4. [CoT]: The injector uses a hardcoded key to decrypt the payload, showing a process-to-file relationship where the injector process performs the action of decrypting the payload (file).   [Relationships]: <process:injector,decrypts,file:payload>. \n5. [CoT]: The decrypted data is decompressed using the \"RtlDecompressBufferEx\" API, indicating a process-to-file relationship where the injector process performs the action of decompressing the decrypted data (file).   [Relationships]: <process:injector,decompresses,file:decrypted data>. \n6. [CoT]: The injector checks the \"BeingDebugged\" flag of PEB (Process Environment Block), showing a process-to-process relationship where the injector process performs the action of checking the PEB (process).   [Relationships]: <process:injector,checks,process:PEB (Process Environment Block)>. \n7. [CoT]: The injector utilizes the \"NtGlobalFlag\" to determine if the process was created by a debugger, indicating a process-to-process relationship where the injector process performs the action of utilizing the NtGlobalFlag (process).   [Relationships]: <process:injector,utilizes,process:NtGlobalFlag>. \n8. [CoT]: The injector verifies the existence of virtual machine paths, such as \"\\VMWare\" and \"\\Oracle\\virtualbox guest additions,\" showing a process-to-file relationship where the injector process performs the action of verifying the existence of these paths (file).   [Relationships]: <process:injector,verifies,file:\\VMWare and \\Oracle\\virtualbox guest additions>. \n9. [CoT]: The injector uses two calls to the \"GetTickCount\" API, indicating a process-to-process relationship where the injector process performs the action of using the GetTickCount API (process).   [Relationships]: <process:injector,uses,process:GetTickCount API>. \n10. [CoT]: The injector uses Sleep() to check if the time has been accelerated, showing a process-to-process relationship where the injector process performs the action of using Sleep() (process).   [Relationships]: <process:injector,uses,process:Sleep()>. \n11. [CoT]: The injector uses the \"FindWindowW\" function to identify the presence of specific debuggers, indicating a process-to-process relationship where the injector process performs the action of using the FindWindowW function (process).   [Relationships]: <process:injector,uses,process:FindWindowW function>. \n12. [CoT]: The injector checks the \"ProcessDebugObjectHandle\" (0x1E), showing a process-to-process relationship where the injector process performs the action of checking the ProcessDebugObjectHandle (process).   [Relationships]: <process:injector,checks,process:ProcessDebugObjectHandle>. \n13. [CoT]: After obtaining the payload, the injector allocates memory using the \"VirtualAllocEx\" function, indicating a process-to-file relationship where the injector process performs the action of allocating memory (file).   [Relationships]: <process:injector,allocates,file:memory>. \n14. [CoT]: The injector allocates memory for the execution of LokiBot, showing a process-to-process relationship where the injector process performs the action of allocating for LokiBot (process). [Relationships]: <process:injector,allocates,process:LokiBot>. ",
        "semantic_relationship": "[CoT]: The action \"extracts\" implies that the injector process is reading data from the file containing the predetermined strings. Therefore, the system-level relationship is \"Read\". [System-level Relationships]: <process:injector,Read,file:predetermined strings>. \n[CoT]: The action \"combines\" implies that the injector process is writing data (the API string) to the file, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:injector,Write,file:API string>. \n[CoT]: The original relationship describes the injector process mapping an API string to corresponding functions, which involves reading the file containing the API string. Therefore, the system-level relationship is 'Read' between the process and the file. [System-level Relationships]: <process:injector,Read,file:API string>. \n[CoT]: The action \"decrypts\" implies that the injector process is accessing and modifying the contents of the payload file, which aligns with the system-level relationship \"Read\" and \"Write\" as it involves altering the file's encrypted data to plain text. [System-level Relationships]: <process:injector,Read,file:payload>, <process:injector,Write,file:payload>. \n[CoT]: The original relationship states that the injector process \"decompresses\" the decrypted data, which implies that the process is performing an operation on the file. In system-level terms, this operation is best represented as \"Write\" because decompression involves modifying the content of the file by expanding it. Therefore, the system-level relationship is <process:injector,Write,file:decrypted data>. [System-level Relationships]: <process:injector,Write,file:decrypted data>. \n[CoT]: The action \"checks the \"BeingDebugged\" flag of PEB\" implies that the injector process is inspecting or reading data from the PEB. In system-level terms, this corresponds to a \"Read\" operation between two processes. [System-level Relationships]: <process:injector,Read,process:PEB (Process Environment Block)>. \n[CoT]: The original relationship states that the injector \"utilizes\" the NtGlobalFlag. In system-level terms, this action translates to the injector reading the NtGlobalFlag to determine if it was created by a debugger. Therefore, the appropriate system-level relationship is \"Readkey\" between the injector process and the NtGlobalFlag. [System-level Relationships]: <process:injector,Readkey,process:NtGlobalFlag>. \n[CoT]: The original relationship states that the injector process \"verifies the existence of\" certain file paths. In system-level terms, verifying the existence of a file corresponds to the \"Read\" action, as the process is checking for the file's presence without modifying it. Therefore, the system-level relationship is <process:injector,Read,file:\\VMWare and \\Oracle\\virtualbox guest additions>. [System-level Relationships]: <process:injector,Read,file:\\VMWare and \\Oracle\\virtualbox guest additions>. \n[CoT]: The original relationship indicates that the injector process \"uses\" the GetTickCount API. In system-level terms, this translates to the injector process call (Invoke) the GetTickCount API (function) to perform an action. The GetTickCount API is treated as a function entity since it involves executing code within the context of the process. [System-level Relationships]: <process:injector,Invoke,function:GetTickCount API>. \n[CoT]: The original relationship indicates that the injector process is using the Sleep() function, which implies that the injector is calling or executing the Sleep() function. In system-level terms, this translates to an \"Fork\" relationship between the injector process and the Sleep() process, as the injector is performing an action (using Sleep()) that requires the creation of a new process (Sleep()). [System-level Relationships]: <process:injector,Fork,process:Sleep()>. \n[CoT]: The original relationship states that the injector \"uses\" the FindWindowW function. In system-level terms, this translates to the injector calling the FindWindowW function, hence the \"Call\" relationship is appropriate. [System-level Relationships]: <process:injector,Call,function:FindWindowW function>. \n[CoT]: The action \"checks\" implies that the injector process is inspecting or reading the ProcessDebugObjectHandle, which aligns with the system-level relationship \"Inject\". [System-level Relationships]: <process:injector,Inject,process:ProcessDebugObjectHandle>. \n[CoT]: The original relationship \"allocates\" implies that the injector process is reserving memory from the system, which corresponds to the system-level action of \"Read\" as it involves accessing and reserving file data in memory. [System-level Relationships]: <process:injector,Read,file:memory>. \n[CoT]: The original relationship \"allocates\" indicates that the injector process is reserving memory for the LokiBot process to execute. In system-level terms, this is best represented as \"Inject\" because it involves one process writing data (code) into another process's memory space. This is a common technique used in code injection attacks. [System-level Relationships]: <process:injector,Inject,process:LokiBot>. "
    },
    {
        "phase": "collection",
        "content": "LokiBot is specifically designed to gather sensitive information from various sources, including web browsers, FTP, email, and numerous software tools installed on the compromised system. Analyzing the C2 traffic to \"95[.]164[.]23[.]2/swe/h/pin[.]php\" in Figure 13, we determined that the version is 0x0012 and the notable Binary ID is \"ckav[.]ru\". As this version of LokiBot has remained unchanged since March, we will only highlight its major components and features.\nFirst, the MD5 hash derived from the MachineGuid is in the end pcap, \"D0BECCE5760947DD9FFD80DB\". This hash serves as a mutex to ensure that multiple instances of LokiBot are not running simultaneously. It employs the \"MoveFileExW\" API to create a folder named \"%APPDATA%\\Roaming\\576094\" and a file named \"47DD9F.exe\" using a substring of the MD5 from MachineGuid. The file is marked as hidden by the \"SetFileAttributes\" function and setting the attribute to FILE_ATTRIBUTE_HIDDEN (0x2). The corresponding registry settings associated with LokiBot are depicted in Figure 14.\nThe list of targeted software names is stored in an array, and a partial list is provided in Figure 15.",
        "relationship": "1. [CoT]: The text mentions that LokiBot is designed to gather information from web browsers, indicating a process-to-process relationship where LokiBot gathers information from web browsers. [Relationships]: <process:LokiBot,gather,process:web browsers>. \n2. [CoT]: The text states that LokiBot gathers information from FTP, showing another process-to-process relationship where LokiBot gathers information from FTP. [Relationships]: <process:LokiBot,gather,process:FTP>. \n3. [CoT]: LokiBot targets email, which is stored in a process-to-process relationship. [Relationships]: <process:LokiBot,target,process:email>. \n4. [CoT]: LokiBot uses the \"MoveFileExW\" API to create a folder, indicating a process-to-file relationship where LokiBot creates a folder. [Relationships]: <process:LokiBot,create,file:%APPDATA%\\Roaming\\576094>. \n5. [CoT]: Similarly, LokiBot uses \"MoveFileExW\" to create a file, establishing another process-to-file relationship. [Relationships]: <process:LokiBot,create,file:47DD9F.exe>. \n6. [CoT]: The file 47DD9F.exe is marked as hidden using the \"SetFileAttributes\" function, showing a process-to-file relationship where LokiBot marks the file hidden. [Relationships]: <process:LokiBot,mark,file:47DD9F.exe(hidden)>. \n7. [CoT]: The MD5 hash \"D0BECCE5760947DD9FFD80DB\" is derived from the MachineGuid and used as a mutex by LokiBot, indicating a process-to-file relationship where LokiBot uses the MD5 hash as a mutex. [Relationships]: <process:LokiBot,use,file:D0BECCE5760947DD9FFD80DB>. \n8. [CoT]: The targeted software names are stored in an array by LokiBot, showing a process-to-file relationship where LokiBot stores data in an array. [Relationships]: <process:LokiBot,store,file:array of targeted software names>. ",
        "semantic_relationship": "[CoT]: The term \"gather information\" implies that LokiBot is reading data from the web browsers, which aligns with the system-level relationship \"Inject\". Therefore, the original relationship is converted to \"Inject\". [System-level Relationships]: <process:LokiBot,Inject,process:web browsers>. \n[CoT]: The term \"gather\" in the original relationship implies that LokiBot is extracting data from FTP, which aligns with the system-level \"Inject\" relationship where one process injects data into another process memory. This represents the action of reading sensitive information from FTP by LokiBot. [System-level Relationships]: <process:LokiBot,Inject,process:FTP>. \n[CoT]: The original relationship targets email, which is stored in a process-to-process context. In system-level terms, this action corresponds to injecting data (email) into the process memory of LokiBot, hence the 'Inject' relationship. [System-level Relationships]: <process:LokiBot,Inject,process:email>. \n[CoT]: The original relationship states that LokiBot \"creates\" a folder, which implies that the process is writing a new file (the folder) to disk. In system-level terms, this corresponds to a \"Write\" operation from a process to a file. [System-level Relationships]: <process:LokiBot,Write,file:%APPDATA%\\Roaming\\576094>. \n[CoT]: The original relationship states that LokiBot creates a file named \"47DD9F.exe\". In system-level terms, creating a file is represented as \"Create\" between a process and a file. Therefore, the system-level relationship is <process:LokiBot,Create,file:47DD9F.exe>. [System-level Relationships]: <process:LokiBot,Create,file:47DD9F.exe>. \n[CoT]: The original relationship states that LokiBot \"marks\" the file 47DD9F.exe as hidden using the \"SetFileAttributes\" function. This action involves modifying the attributes of the file, which falls under the \"Modify_Attribute\" relationship in the system-level framework for process-to-file interactions. [System-level Relationships]: <process:LokiBot,Modify_Attribute,file:47DD9F.exe(hidden)>. \n[CoT]: The original relationship \"use\" implies that the process LokiBot is utilizing the file with the MD5 hash D0BECCE5760947DD9FFD80DB as a mutex. In system-level terms, this translates to the process reading the file (mutex) to establish a lock, hence the relationship \"Read\". [System-level Relationships]: <process:LokiBot,Read,file:D0BECCE5760947DD9FFD80DB>. \n[CoT]: The original relationship \"store\" implies that LokiBot is writing data (targeted software names) to a file (array of targeted software names). In system-level terms, this corresponds to a \"Write\" action from a process to a file. [System-level Relationships]: <process:LokiBot,Write,file:array of targeted software names>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "initial access",
                "relationship": "[Description]: The text states that the Word document contains an external link in \"word/_rels/document.xml.rels\" using MHTML. [Original Relationships]: <process:Word,contains,file:word/_rels/document.xml.rels>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Word contains the file \"document.xml.rels\". In system-level terms, this translates to the \"Contains\" relationship between a process and a file, as the process (Word) is storing or loading the file. [System-level Relationships]: <process:Word,Contains,file:word/_rels/document.xml.rels>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text mentions that accessing the external link downloads the file \"defrt.html\". [Original Relationships]: <process:external link,downloads,file:defrt.html>. ",
                "semantic_relationship": "[CoT]: The original relationship \"downloads\" implies that the external link process writes the file \"defrt.html\" to disk, which corresponds to the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:external link,Write,file:defrt.html>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The payload initiates the download of \"oehrjd.exe\" from a specified URL. [Original Relationships]: <process:payload,downloads,file:oehrjd.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"downloads\" implies that the payload process is writing the downloaded content to a file named \"oehrjd.exe\". Therefore, the system-level relationship is mapped to \"Write\". [System-level Relationships]: <process:payload,Write,file:oehrjd.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The VBA script automatically executes and decodes arrays to \"DD.inf\". [Original Relationships]: <process:VBA script,decodes,file:DD.inf>. ",
                "semantic_relationship": "[CoT]: The original relationship \"decodes\" implies that the VBA script is executing the contents of the file \"DD.inf\". In system-level terms, this action corresponds to a process executing a file, hence the relationship is mapped to \"Execute\". [System-level Relationships]: <process:VBA script,Execute,file:DD.inf>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script creates \"ema.tmp\" to store data. [Original Relationships]: <process:VBA script,creates,file:ema.tmp>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the VBA script \"creates\" the file \"ema.tmp\". In system-level terms, this corresponds to a Process-to-File \"Create\" relationship, as the process is generating a new file. [System-level Relationships]: <process:VBA script,Create,file:ema.tmp>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script encodes data to \"des.jpg\". [Original Relationships]: <process:VBA script,encodes,file:des.jpg>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the VBA script \"encodes\" data to des.jpg. In system-level terms, this action involves writing data to the file des.jpg, hence the relationship is converted to \"Write\". [System-level Relationships]: <process:VBA script,Write,file:des.jpg>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script uses rundll32 to load a DLL file with the function \"maintst\". [Original Relationships]: <process:VBA script,loads,file:rundll32>. ",
                "semantic_relationship": "[CoT]: The original relationship \"loads\" indicates that the VBA script is loading a DLL file, which corresponds to the system-level relationship \"Loadlibrary\" between a process and a file. [System-level Relationships]: <process:VBA script,Loadlibrary,file:rundll32>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script deletes temporary, JPG, and INF files. [Original Relationships]: <process:VBA script,deletes,file:temporary files>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the VBA script deletes temporary files. In system-level terms, deleting a file corresponds to the \"Delete\" action between a process and a file, hence the relationship is mapped to \"Delete\". [System-level Relationships]: <process:VBA script,Delete,file:temporary files>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The VBA script creates an INF file, indicating a process-to-file relationship where the process 'VBA script' creates the 'INF file'.   [Original Relationships]: <process:VBA script,creates,file:INF file>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the VBA script creates an INF file. In system-level terms, this corresponds to a Process-to-File 'Create' action, as the process is generating a new file. [System-level Relationships]: <process:VBA script,Create,file:INF file>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The VBA script is designed to load a DLL file, showing a process-to-file relationship where the process 'VBA script' loads the 'DLL file'.   [Original Relationships]: <process:VBA script,loads,file:DLL file>. ",
                "semantic_relationship": "[CoT]: The original relationship 'loads' indicates that the VBA script is loading a DLL file, which aligns with the system-level relationship 'Loadlibrary' as it involves a process loading a dynamic-link library file. [System-level Relationships]: <process:VBA script,Loadlibrary,file:DLL file>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The DLL file, named \"des.jpg,\" is intended to download an injector from a specified URL, indicating a process-to-socket relationship where the process 'DLL file' downloads from the 'URL'.   [Original Relationships]: <process:DLL file,downloads,socket:https[:]//vertebromed[.]md/temp/dhssdf[.]exe>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process downloading from a URL, which implies establishing a connection to a remote socket. In system-level terms, this is best represented as a 'Connect' relationship between the process and the socket. [System-level Relationships]: <process:DLL file,Connect,socket:https[:]//vertebromed[.]md/temp/dhssdf[.]exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The DLL file, named \"des.jpg,\" downloads an injector file named \"dhssdf.exe,\" showing a process-to-file relationship where the process 'DLL file' downloads the 'injector file'.   [Original Relationships]: <process:DLL file,downloads,file:dhssdf.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the DLL file downloading the dhssdf.exe file, which implies that the DLL file is injecting code into the executable file. In system-level terms, this is best represented as an \"Inject\" relationship from the process to the file. [System-level Relationships]: <process:DLL file,Inject,file:dhssdf.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The MSIL loader, \"IMG_3360_103pdf.exe,\" loads LokiBot, indicating a process-to-file relationship where the process 'MSIL loader' loads the 'LokiBot'.   [Original Relationships]: <process:IMG_3360_103pdf.exe,loads,file:LokiBot>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process loading a file, which in system-level terms corresponds to the 'Loadlibrary' relationship between a process and a file. This is a common technique used by malware to load external libraries or modules into memory. [System-level Relationships]: <process:IMG_3360_103pdf.exe,Loadlibrary,file:LokiBot>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The MSIL loader, \"IMG_3360_103pdf.exe,\" connects to a C2 IP, showing a process-to-socket relationship where the process 'MSIL loader' connects to the 'C2 IP'. [Original Relationships]: <process:IMG_3360_103pdf.exe,connects,socket:C2 IP>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process connecting to a socket, which directly maps to the system-level relationship 'Connect' between a process and a socket. This is a clear match for the Process-to-Socket category in the framework. [System-level Relationships]: <process:IMG_3360_103pdf.exe,Connect,socket:C2 IP>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that the injector extracts individual letters from predetermined strings, indicating a process-to-file relationship where the injector process performs the action of extracting from the predetermined strings (file).   [Original Relationships]: <process:injector,extracts,file:predetermined strings>. ",
                "semantic_relationship": "[CoT]: The action \"extracts\" implies that the injector process is reading data from the file containing the predetermined strings. Therefore, the system-level relationship is \"Read\". [System-level Relationships]: <process:injector,Read,file:predetermined strings>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that the letters are combined to form an API string, showing that the injector process combines letters from the file.   [Original Relationships]: <process:injector,combines,file:API string>. ",
                "semantic_relationship": "[CoT]: The action \"combines\" implies that the injector process is writing data (the API string) to the file, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:injector,Write,file:API string>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector maps the API string to corresponding functions, indicating a process-to-file relationship where the injector process performs the action of mapping to the API string (file).   [Original Relationships]: <process:injector,maps,file:API string>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the injector process mapping an API string to corresponding functions, which involves reading the file containing the API string. Therefore, the system-level relationship is 'Read' between the process and the file. [System-level Relationships]: <process:injector,Read,file:API string>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector uses a hardcoded key to decrypt the payload, showing a process-to-file relationship where the injector process performs the action of decrypting the payload (file).   [Original Relationships]: <process:injector,decrypts,file:payload>. ",
                "semantic_relationship": "[CoT]: The action \"decrypts\" implies that the injector process is accessing and modifying the contents of the payload file, which aligns with the system-level relationship \"Read\" and \"Write\" as it involves altering the file's encrypted data to plain text. [System-level Relationships]: <process:injector,Read,file:payload>, <process:injector,Write,file:payload>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The decrypted data is decompressed using the \"RtlDecompressBufferEx\" API, indicating a process-to-file relationship where the injector process performs the action of decompressing the decrypted data (file).   [Original Relationships]: <process:injector,decompresses,file:decrypted data>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the injector process \"decompresses\" the decrypted data, which implies that the process is performing an operation on the file. In system-level terms, this operation is best represented as \"Write\" because decompression involves modifying the content of the file by expanding it. Therefore, the system-level relationship is <process:injector,Write,file:decrypted data>. [System-level Relationships]: <process:injector,Write,file:decrypted data>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector checks the \"BeingDebugged\" flag of PEB (Process Environment Block), showing a process-to-process relationship where the injector process performs the action of checking the PEB (process).   [Original Relationships]: <process:injector,checks,process:PEB (Process Environment Block)>. ",
                "semantic_relationship": "[CoT]: The action \"checks the \"BeingDebugged\" flag of PEB\" implies that the injector process is inspecting or reading data from the PEB. In system-level terms, this corresponds to a \"Read\" operation between two processes. [System-level Relationships]: <process:injector,Read,process:PEB (Process Environment Block)>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector utilizes the \"NtGlobalFlag\" to determine if the process was created by a debugger, indicating a process-to-process relationship where the injector process performs the action of utilizing the NtGlobalFlag (process).   [Original Relationships]: <process:injector,utilizes,process:NtGlobalFlag>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the injector \"utilizes\" the NtGlobalFlag. In system-level terms, this action translates to the injector reading the NtGlobalFlag to determine if it was created by a debugger. Therefore, the appropriate system-level relationship is \"Readkey\" between the injector process and the NtGlobalFlag. [System-level Relationships]: <process:injector,Readkey,process:NtGlobalFlag>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector verifies the existence of virtual machine paths, such as \"\\VMWare\" and \"\\Oracle\\virtualbox guest additions,\" showing a process-to-file relationship where the injector process performs the action of verifying the existence of these paths (file).   [Original Relationships]: <process:injector,verifies,file:\\VMWare and \\Oracle\\virtualbox guest additions>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the injector process \"verifies the existence of\" certain file paths. In system-level terms, verifying the existence of a file corresponds to the \"Read\" action, as the process is checking for the file's presence without modifying it. Therefore, the system-level relationship is <process:injector,Read,file:\\VMWare and \\Oracle\\virtualbox guest additions>. [System-level Relationships]: <process:injector,Read,file:\\VMWare and \\Oracle\\virtualbox guest additions>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector uses two calls to the \"GetTickCount\" API, indicating a process-to-process relationship where the injector process performs the action of using the GetTickCount API (process).   [Original Relationships]: <process:injector,uses,process:GetTickCount API>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the injector process \"uses\" the GetTickCount API. In system-level terms, this translates to the injector process call (Invoke) the GetTickCount API (function) to perform an action. The GetTickCount API is treated as a function entity since it involves executing code within the context of the process. [System-level Relationships]: <process:injector,Invoke,process:GetTickCount API>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector uses Sleep() to check if the time has been accelerated, showing a process-to-process relationship where the injector process performs the action of using Sleep() (process).   [Original Relationships]: <process:injector,uses,process:Sleep()>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the injector process is using the Sleep() function, which implies that the injector is calling or executing the Sleep() function. In system-level terms, this translates to an \"Fork\" relationship between the injector process and the Sleep() process, as the injector is performing an action (using Sleep()) that requires the creation of a new process (Sleep()). [System-level Relationships]: <process:injector,Fork,process:Sleep()>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector uses the \"FindWindowW\" function to identify the presence of specific debuggers, indicating a process-to-process relationship where the injector process performs the action of using the FindWindowW function (process).   [Original Relationships]: <process:injector,uses,process:FindWindowW function>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the injector \"uses\" the FindWindowW function. In system-level terms, this translates to the injector calling the FindWindowW function, hence the \"Call\" relationship is appropriate. [System-level Relationships]: <process:injector,Call,process:FindWindowW function>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector checks the \"ProcessDebugObjectHandle\" (0x1E), showing a process-to-process relationship where the injector process performs the action of checking the ProcessDebugObjectHandle (process).   [Original Relationships]: <process:injector,checks,process:ProcessDebugObjectHandle>. ",
                "semantic_relationship": "[CoT]: The action \"checks\" implies that the injector process is inspecting or reading the ProcessDebugObjectHandle, which aligns with the system-level relationship \"Inject\". [System-level Relationships]: <process:injector,Inject,process:ProcessDebugObjectHandle>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: After obtaining the payload, the injector allocates memory using the \"VirtualAllocEx\" function, indicating a process-to-file relationship where the injector process performs the action of allocating memory (file).   [Original Relationships]: <process:injector,allocates,file:memory>. ",
                "semantic_relationship": "[CoT]: The original relationship \"allocates\" implies that the injector process is reserving memory from the system, which corresponds to the system-level action of \"Read\" as it involves accessing and reserving file data in memory. [System-level Relationships]: <process:injector,Read,file:memory>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The injector allocates memory for the execution of LokiBot, showing a process-to-process relationship where the injector process performs the action of allocating for LokiBot (process). [Original Relationships]: <process:injector,allocates,process:LokiBot>. ",
                "semantic_relationship": "[CoT]: The original relationship \"allocates\" indicates that the injector process is reserving memory for the LokiBot process to execute. In system-level terms, this is best represented as \"Inject\" because it involves one process writing data (code) into another process's memory space. This is a common technique used in code injection attacks. [System-level Relationships]: <process:injector,Inject,process:LokiBot>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: The text mentions that LokiBot is designed to gather information from web browsers, indicating a process-to-process relationship where LokiBot gathers information from web browsers. [Original Relationships]: <process:LokiBot,gather,process:web browsers>. ",
                "semantic_relationship": "[CoT]: The term \"gather information\" implies that LokiBot is reading data from the web browsers, which aligns with the system-level relationship \"Inject\". Therefore, the original relationship is converted to \"Inject\". [System-level Relationships]: <process:LokiBot,Inject,process:web browsers>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: The text states that LokiBot gathers information from FTP, showing another process-to-process relationship where LokiBot gathers information from FTP. [Original Relationships]: <process:LokiBot,gather,process:FTP>. ",
                "semantic_relationship": "[CoT]: The term \"gather\" in the original relationship implies that LokiBot is extracting data from FTP, which aligns with the system-level \"Inject\" relationship where one process injects data into another process memory. This represents the action of reading sensitive information from FTP by LokiBot. [System-level Relationships]: <process:LokiBot,Inject,process:FTP>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: LokiBot targets email, which is stored in a process-to-process relationship. [Original Relationships]: <process:LokiBot,target,process:email>. ",
                "semantic_relationship": "[CoT]: The original relationship targets email, which is stored in a process-to-process context. In system-level terms, this action corresponds to injecting data (email) into the process memory of LokiBot, hence the 'Inject' relationship. [System-level Relationships]: <process:LokiBot,Inject,process:email>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: LokiBot uses the \"MoveFileExW\" API to create a folder, indicating a process-to-file relationship where LokiBot creates a folder. [Original Relationships]: <process:LokiBot,create,file:%APPDATA%\\Roaming\\576094>. ",
                "semantic_relationship": "[CoT]: The original relationship states that LokiBot \"creates\" a folder, which implies that the process is writing a new file (the folder) to disk. In system-level terms, this corresponds to a \"Write\" operation from a process to a file. [System-level Relationships]: <process:LokiBot,Write,file:%APPDATA%\\Roaming\\576094>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: Similarly, LokiBot uses \"MoveFileExW\" to create a file, establishing another process-to-file relationship. [Original Relationships]: <process:LokiBot,create,file:47DD9F.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that LokiBot creates a file named \"47DD9F.exe\". In system-level terms, creating a file is represented as \"Create\" between a process and a file. Therefore, the system-level relationship is <process:LokiBot,Create,file:47DD9F.exe>. [System-level Relationships]: <process:LokiBot,Create,file:47DD9F.exe>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: The file 47DD9F.exe is marked as hidden using the \"SetFileAttributes\" function, showing a process-to-file relationship where LokiBot marks the file hidden. [Original Relationships]: <process:LokiBot,mark,file:47DD9F.exe(hidden)>. ",
                "semantic_relationship": "[CoT]: The original relationship states that LokiBot \"marks\" the file 47DD9F.exe as hidden using the \"SetFileAttributes\" function. This action involves modifying the attributes of the file, which falls under the \"Modify_Attribute\" relationship in the system-level framework for process-to-file interactions. [System-level Relationships]: <process:LokiBot,Modify_Attribute,file:47DD9F.exe(hidden)>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: The MD5 hash \"D0BECCE5760947DD9FFD80DB\" is derived from the MachineGuid and used as a mutex by LokiBot, indicating a process-to-file relationship where LokiBot uses the MD5 hash as a mutex. [Original Relationships]: <process:LokiBot,use,file:D0BECCE5760947DD9FFD80DB>. ",
                "semantic_relationship": "[CoT]: The original relationship \"use\" implies that the process LokiBot is utilizing the file with the MD5 hash D0BECCE5760947DD9FFD80DB as a mutex. In system-level terms, this translates to the process reading the file (mutex) to establish a lock, hence the relationship \"Read\". [System-level Relationships]: <process:LokiBot,Read,file:D0BECCE5760947DD9FFD80DB>. "
            },
            {
                "phase": "collection",
                "relationship": "[Description]: The targeted software names are stored in an array by LokiBot, showing a process-to-file relationship where LokiBot stores data in an array. [Original Relationships]: <process:LokiBot,store,file:array of targeted software names>. ",
                "semantic_relationship": "[CoT]: The original relationship \"store\" implies that LokiBot is writing data (targeted software names) to a file (array of targeted software names). In system-level terms, this corresponds to a \"Write\" action from a process to a file. [System-level Relationships]: <process:LokiBot,Write,file:array of targeted software names>. "
            }
        ]
    }
]