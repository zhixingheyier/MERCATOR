[
    {
        "phase": "execution",
        "content": "QBot PowerShell analysis\nWhen run for the first time, the script creates a new registry key entry in the same path, saving the date of execution. It then verifies upon execution if the creation date key of this registry key is older than 4 hours.\nBased on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it.\nOR (2) Fetch the QBot payload remotely using one of the active C2 IPs using theInvoke-WebRequestPowerShell module:\nThe PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files.\nThe encoded QBot DLL that was stored in the registry, was dropped in the directory%APPDATA%\\Roaming\\Microsoft\\Fdopitcu. The unsigned DLL, with descriptorCancel Autoplay 2was executed usingregsvr32.exe\nUpon execution of this second-stage DLL, various registry keys were created inHKCU\\Software\\Microsoft\\Yerqbqokc.In addition, a new instance of explorer.exe (32-bit) was started and injected into.\nThe registry keys contain eight-character long hex strings for which we believe is part of the malware's encryptedconfig.",
        "relationship": "1. [CoT]: The text states that the script creates a new registry key entry in the same path, indicating a process-to-registry relationship where the process 'script' creates the registry key. [Relationships]: <process:script,creates,registry:Same path>. \n2. [CoT]: The text mentions that the script verifies if the creation date key of the registry key is older than 4 hours, showing a process-to-registry relationship where the process 'script' verifies the registry key. [Relationships]: <process:script,verifies,registry:creation date key>. \n3. [CoT]: The script retrieves the base64-encoded Qbot payload from the Windows Registry, indicating a process-to-registry relationship where the process 'script' retrieves data from the registry. [Relationships]: <process:script,retrieves,registry:base64-encoded Qbot payload>. \n4. [CoT]: The script decodes the base64-encoded payload and saves it on the file system, showing a process-to-file relationship where the process 'script' saves a file. [Relationships]: <process:script,saves,file:base64-encoded Qbot payload>. \n5. [CoT]: The script executes the decoded payload, indicating a process-to-file relationship where the process 'script' executes a file (payload). [Relationships]: <process:script,executes,file:payload>. \n6. [CoT]: The PS script fetches the QBot payload remotely using an active C2 IP, showing a process-to-socket relationship where the process 'PS script' fetches data from a socket (C2 IP). [Relationships]: <process:PS script,fetches,socket:active C2 IPs>. \n7. [CoT]: The PS script uses the Invoke-WebRequest PowerShell module to fetch the payload, indicating a process-to-process relationship where the process 'PS script' uses another process (module). [Relationships]: <process:PS script,uses,process:Invoke-WebRequest PowerShell module>. \n8. [CoT]: The descriptor describes where the encoded QBot DLL was stored in the registry, showing a process-to-registry relationship where the process 'script' stores the DLL in the registry. [Relationships]: <process:script,stores,registry:encoded QBot DLL>. \n9. [CoT]: The descriptor mentions that the unsigned DLL was dropped in a specific directory, indicating a process-to-file relationship where the process 'script' drops a file (DLL). [Relationships]: <process:script,drops,file:unsigned DLL>. \n10. [CoT]: The script executes regsvr32.exe to execute the unsigned DLL, showing a process-to-process relationship where the process 'script' executes another process (regsvr32.exe). [Relationships]: <process:script,executes,process:regsvr32.exe>. \n11. [CoT]: Upon execution of the second-stage DLL, various registry keys were created, indicating a process-to-registry relationship where the process 'DLL' creates registry keys. [Relationships]: <process:DLL,creates,registry:HKCU\\Software\\Microsoft\\Yerqbqokc>. \n12. [CoT]: A new instance of explorer.exe was started, showing a process-to-process relationship where the process 'DLL' starts another process (explorer.exe). [Relationships]: <process:DLL,starts,process:explorer.exe>. \n13. [CoT]: explorer.exe was injected into by the DLL, indicating a process-to-process relationship where the process 'DLL' injects into process explorer.exe. [Relationships]: <process:DLL,injects into,process:explorer.exe>. ",
        "semantic_relationship": "[CoT]: The original relationship states that the script creates a new registry key entry, which directly maps to the system-level relationship 'Createkey' between a process and a registry key. [System-level Relationships]: <process:script,Createkey,registry:Same path>. \n[CoT]: The original relationship states that the process 'script' verifies the creation date key of the registry key. In system-level terms, this action corresponds to reading the registry key to check its value, hence the relationship is converted to 'Readkey'. [System-level Relationships]: <process:script,Readkey,registry:creation date key>. \n[CoT]: The original relationship states that the process 'script' retrieves data from the registry, which implies that the script is reading data (Readkey) from the registry key where the Qbot payload is stored. [System-level Relationships]: <process:script,Readkey,registry:base64-encoded Qbot payload>. \n[CoT]: The original relationship 'saves' indicates that the process 'script' is writing data to a file, which corresponds to the system-level relationship 'Write' between a process and a file. [System-level Relationships]: <process:script,Write,file:base64-encoded Qbot payload>. \n[CoT]: The original relationship describes a process executing a file, which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:script,Execute,file:payload>. \n[CoT]: The original relationship 'fetches' implies that the PS script receives data from the C2 IP, which aligns with the system-level 'Receive' relationship between a process and a socket. [System-level Relationships]: <process:PS script,Receive,socket:active C2 IPs>. \n[CoT]: The original relationship 'uses' between the PS script and the Invoke-WebRequest PowerShell module implies that the PS script is loading the module into its process space. In system-level terms, this corresponds to the 'Loadlibrary' relationship, as the PS script is loading another library (module) into its process. [System-level Relationships]: <process:PS script,Loadlibrary,process:Invoke-WebRequest PowerShell module>. \n[CoT]: The original relationship 'stores' implies that the process 'script' is writing data (the DLL) to the registry, which corresponds to the system-level relationship 'Writekey' between a process and a registry key. [System-level Relationships]: <process:script,Writekey,registry:encoded QBot DLL>. \n[CoT]: The term \"drops\" in the original relationship implies that the process 'script' is creating a new file (unsigned DLL) in the system, which aligns with the system-level relationship 'Create' between a process and a file. [System-level Relationships]: <process:script,Create,file:unsigned DLL>. \n[CoT]: The original relationship states that the process 'script' executes the process 'regsvr32.exe'. In system-level terms, this corresponds to the 'Fork' relationship between two processes, as the script is directly causing the regsvr32.exe to run. [System-level Relationships]: <process:script,Fork,process:regsvr32.exe>. \n[CoT]: The original relationship states that the process 'DLL' creates registry keys. In system-level terms, this corresponds to the 'Createkey' action between a process and a registry key. The action 'creates' in the original relationship is directly mapped to 'Createkey' in the system-level framework. [System-level Relationships]: <process:DLL,Createkey,registry:HKCU\\Software\\Microsoft\\Yerqbqokc>. \n[CoT]: The original relationship states that the process 'DLL' starts another process (explorer.exe). In system-level terms, this corresponds to a Fork operation where one process creates another. Therefore, the correct system-level relationship is 'Fork'. [System-level Relationships]: <process:DLL,Fork,process:explorer.exe>. \n[CoT]: The original relationship describes a process ('DLL') injecting into another process (explorer.exe). In the system-level relationships framework, this corresponds to the 'Inject' relationship between two processes. [System-level Relationships]: <process:DLL,Inject,process:explorer.exe>. "
    },
    {
        "phase": "privilege escalation",
        "content": "Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon.\nThe executable was named \"cool.exe\" :\nThree milliseconds after theZerologonexploit, an event 4742 \"A computer account was changed.\" was generated on the targeted Domain Controller.\nAs explained in a detailed blog fromCrowdStrike, the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV :\nAs we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller :\nAfter the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully.\nAfter being successfully authenticated, the DC password was set:\nThe PasswordLastSet field is equal to the TimeCreated field, meaning that the password of the domain controller was successfully updated.We can also see that the SubjectUserName is ANONYMOUS LOGON.\nA connection was performed from thebeachheadto the Domain Controller using the DC account.After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.\nThe explorer shell was also restarted by the threat actor:",
        "relationship": "1. [CoT]: The text states that the threat actors ran an executable file named \"cool.exe,\" indicating a process-to-file relationship where the threat actors (process) ran the executable file (file).   [Relationships]: <process:threat actors,ran,file:cool.exe>. \n2. [CoT]: The text mentions that after the Zerologon exploit, an event 4742 was generated on the Domain Controller, indicating a process-to-event relationship where the Zerologon exploit (process) generated the event (event).   [Relationships]: <process:Zerologonexploit,generated,event:event 4742 \"A computer account was changed.\">. \n3. [CoT]: The text describes a brute-force attack performed to spoof the identity of the domain controller, indicating a process-to-socket relationship where the threat actors (process) performed the brute-force attack (socket).   [Relationships]: <process:threat actors,performed,socket:brute-force attack>. \n4. [CoT]: The text states that the exploit successfully authenticated to the DC, indicating a process-to-socket relationship where the exploit (process) performed the authentication action (socket).   [Relationships]: <process:exploit,performed,socket:authenticated>. \n5. [CoT]: The text describes that the threat actors dumped the Domain Admin hash, indicating a process-to-file relationship where the threat actors (process) dumped the Domain Admin hash (file).   [Relationships]: <process:threat actors,dumped,file:Domain Admin hash>. \n6. [CoT]: The text states that the threat actors reset the DC password, indicating a process-to-file relationship where the threat actors (process) reset the DC password (file).   [Relationships]: <process:threat actors,reset,file:DC password>. \n7. [CoT]: The text mentions that the explorer shell was restarted by the threat actor, indicating a process-to-process relationship where the threat actor (process) restarted the explorer shell (process). [Relationships]: <process:threat actor,restarted,process:explorer shell>. ",
        "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the threat actors executed the file \"cool.exe,\" which corresponds to the system-level relationship \"Execute\" between a process and a file. [System-level Relationships]: <process:threat actors,Execute,file:cool.exe>. \n[CoT]: The original relationship states that the Zerologon exploit \"generated\" an event. In system-level terms, this corresponds to a process creating an event (Process-to-Event relationship), hence the \"Create\" action is used. The term \"generated\" in the original description aligns with the system-level \"Create\" action for Process-to-Event relationships. [System-level Relationships]: <process:Zerologonexploit,Create,event:event 4742 \"A computer account was changed.\">. \n[CoT]: The original relationship indicates that the threat actors (process) performed a brute-force attack (socket). In system-level terms, this translates to the process initiating a connection attempt to the socket, hence the 'Connect' relationship. Brute-force attacks typically involve establishing connections to targets to attempt authentication exploits. [System-level Relationships]: <process:threat actors,Connect,socket:brute-force attack>. \n[CoT]: The original relationship indicates that the exploit process performed authentication to a socket (DC). In system-level terms, this translates to a 'Connect' action between the process and the socket, as authentication typically involves establishing a connection to a remote socket for further communication. [System-level Relationships]: <process:exploit,Connect,socket:DC>. \n[CoT]: The term \"dumped\" in the original relationship implies that the threat actors (process) read the Domain Admin hash (file) to extract its contents, which aligns with the system-level relationship \"Read\" between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:Domain Admin hash>. \n[CoT]: The action \"reset\" implies that the threat actors modified the DC password file, which aligns with the system-level relationship \"Write\" as it involves changing the content of a file. [System-level Relationships]: <process:threat actors,Write,file:DC password>. \n[CoT]: The original relationship \"restarted\" implies that the threat actor terminated the explorer shell process and then immediately created a new instance of it. In system-level terms, this is best represented as a \"Exit\" relationship from the threat actor process to the explorer shell process. [System-level Relationships]: <process:threat actor,Exit,process:explorer shell>. "
    },
    {
        "phase": "defense evasion",
        "content": "Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.\nThe injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.\nOver-Pass-the-Hash from Beachhead\nThe threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hashto request a TGT from the domain controller.We have seen the use of over-pass-the-hash several times before. For example, ourCobalt Strike Defender Guidecovers detection of this technique in more detail.\nSoon after, a TGT for the administrator account was requested:",
        "relationship": "1. [CoT]: The text states that QBot uses process hollowing to start a suspended instance of explorer.exe, indicating a process-to-process relationship where QBot is the process initiating the action.   [Relationships]: <process:QBot,uses,process:explorer.exe>. \n2. [CoT]: The text mentions that QBot injects itself into the explorer.exe process, indicating a process-to-process relationship where QBot is the process performing the injection action.   [Relationships]: <process:QBot,injects,process:explorer.exe>. \n3. [CoT]: The text describes that the injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit), indicating a process-to-process relationship where explorer.exe is the process performing the spawn action.   [Relationships]: <process:explorer.exe,spawns,process:explorer.exe>. \n4. [CoT]: The text mentions that the threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit, indicating a process-to-process relationship where the Zerologon exploit is the process performing the action of obtaining the hash.   [Relationships]: <process:Zerologon exploit,obtains,process:NTLM hash value>. \n5. [CoT]: The text states that the threat actor used over-pass-the-hash to request a TGT from the domain controller, indicating a process-to-process relationship where over-pass-the-hash is the process performing the action of requesting the TGT.   [Relationships]: <process:over-pass-the-hash,requests,process:TGT>. \n6. [CoT]: The text describes that a TGT for the administrator account was requested soon after, indicating a process-to-process relationship where an unknown threat actor agent requested the TGT.   [Relationships]: <process:threat actor agent,request,process:TGT>. ",
        "semantic_relationship": "[CoT]: The original relationship states that QBot \"uses\" process hollowing to start a suspended instance of explorer.exe. Process hollowing is a technique where a process creates a new process instance, but then manipulates it to run in a suspended state. This is typically done to evade detection or inject code into the new process. In system-level terms, this action corresponds to a \"Fork\" relationship between the two processes. [System-level Relationships]: <process:QBot,Fork,process:explorer.exe>. \n[CoT]: The original relationship describes QBot injecting into explorer.exe, which directly corresponds to the system-level 'Inject' relationship between processes. No transformation was needed as the original relationship already matches the system-level equivalent. [System-level Relationships]: <process:QBot,Inject,process:explorer.exe>. \n[CoT]: The original relationship \"spawns\" indicates that the parent process (explorer.exe) created a new process (also explorer.exe). In system-level terms, this is best represented as a \"Fork\" relationship between the two processes. Fork is the standard system-level action for process creation. [System-level Relationships]: <process:explorer.exe,Fork,process:explorer.exe>. \n[CoT]: The original relationship states that the Zerologon exploit \"obtains\" the NTLM hash value. In system-level terms, this action corresponds to the exploit reading the hash value from memory or another process, hence the \"Inject\" relationship. [System-level Relationships]: <process:Zerologon exploit,Inject,process:NTLM hash value>. \n[CoT]: The original relationship describes a process (over-pass-the-hash) requesting a TGT from a domain controller. In system-level terms, this action corresponds to a process-to-process Request Package, as the over-pass-the-hash process is initiating a request for another process (TGT). This is a standard interaction between processes in a network environment. [System-level Relationships]: <process:over-pass-the-hash,Request,process:TGT>. \n[CoT]: The original relationship describes a process (threat actor agent) requesting a TGT. In system-level terms, this action corresponds to a process-to-process Fork action, as the threat actor agent is seeking to fork another process (the TGT). [System-level Relationships]: <process:threat actor agent,Fork,process:TGT>. "
    },
    {
        "phase": "discovery",
        "content": "QBot initially starts a number of processes to collect information about the affected system. This is part of the \"SYSTEM INFO\" bot request, as described in a recent article fromSecureList.\nLater, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.\nADFind(renamed in find.exe) used to enumerate computers\nOn the Domain Controller, the threat actors gathered information about the installed security software through WMI:\nPing was used to verify machines were online",
        "relationship": "1. [CoT]: The text states that QBot starts processes as part of its collection activity, indicating a process-to-process relationship where QBot is the source process and \"starts\" is the verb.   [Relationships]: <process:QBot,start,process:process>. \n2. [CoT]: The text mentions that more discovery commands were executed via the Cobalt Strike beacon, showing a process-to-process relationship where the Cobalt Strike beacon is the source process and \"executed\" is the verb.   [Relationships]: <process:Cobalt Strike beacon,execute,process:discovery commands>. \n3. [CoT]: The text describes ADFind (renamed to find.exe) being used to enumerate computers, indicating a process-to-process relationship where ADFind (find.exe) is the source process and \"enumerated\" is the verb.   [Relationships]: <process:ADFind(renamed in find.exe),enumerate,process:computers>. \n4. [CoT]: The text states that threat actors gathered information about installed security software through WMI, showing a process-to-process relationship where WMI is the source process and \"gathered\" is the verb.   [Relationships]: <process:WMI,gathered,process:information about installed security software>. \n5. [CoT]: The text mentions that ping was used to verify machines were online, indicating a process-to-process relationship where ping is the source process and \"verified\" is the verb.   [Relationships]: <process:ping,verify,process:machines were online>. ",
        "semantic_relationship": "[CoT]: The term \"starts\" in the original relationship implies that QBot is creating a new process, which aligns with the system-level relationship \"Fork\" as it denotes the creation of a child process by a parent process. [System-level Relationships]: <process:QBot,Fork,process:process>. \n[CoT]: The original relationship describes the Cobalt Strike beacon executing other processes, which directly maps to the system-level 'Fork' relationship between processes. [System-level Relationships]: <process:Cobalt Strike beacon,Fork,process:discovery commands>. \n[CoT]: The verb \"enumerate\" in the original relationship implies that ADFind (find.exe) is reading data from other processes to gather information about computers, which aligns with the system-level \"Inject\" relationship between processes. This reflects the action of one process reading data from another. [System-level Relationships]: <process:ADFind(renamed in find.exe),Inject,process:computers>. \n[CoT]: The verb \"gathered\" implies that the WMI process read information from another process or system resource, which aligns with the system-level relationship \"Inject\" between processes. This is a common technique for memory injection or data extraction in cyber attacks. [System-level Relationships]: <process:WMI,Inject,process:information about installed security software>. \n[CoT]: The verb \"verify\" in the original relationship implies that the ping process is attempting to establish a connection to the machines, which aligns with the system-level \"Connect\" relationship between processes. [System-level Relationships]: <process:ping,Connect,process:machines were online>. "
    },
    {
        "phase": "lateral movement",
        "content": "On the first Domain Controller, a Cobalt Strike service was installed:\nMultiple services were installed by Cobalt Strike across the environment, here are a few examples:\nCobalt Strikefirst callsOpenSCManagerWto create the service remotely, then starts it withStartServiceAfunction:\nRDP/interactive Logins\nVarious commands were executed to enable the RDP service on various hosts:\nIncrease the max RDP connections allowed, in this case a arbitrarily large number.\nThe threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network.",
        "relationship": "1. [CoT]: The text states \"Cobalt Strike first calls OpenSCManagerW to create the service remotely,\" indicating that the Cobalt Strike process performs the action of calling the OpenSCManagerW process.   [Relationships]: <process:Cobalt Strike, calls, process:OpenSCManagerW>. \n2. [CoT]: The text mentions \"then starts it with StartServiceA function,\" showing that Cobalt Strike processes starts the StartServiceA process as part of the service creation.   [Relationships]: <process:Cobalt Strike, starts, process:StartServiceA>. \n3. [CoT]: The text states \"Various commands were executed to enable the RDP service,\" implying that the Cobalt Strike process executes other commands, which we label as the EnableRDP process.   [Relationships]: <process:Cobalt Strike, executes, process:EnableRDP>. \n4. [CoT]: The text describes \"increase the max RDP connections allowed,\" showing that the EnableRDP process performs the action of increasing connections to the socket:RDP. [Relationships]: <process:EnableRDP, increases, socket:RDP>. \n5. [CoT]: The text mentions \"established interactive administrative RDP sessions,\" indicating that the threat actor (process) established sessions to the socket:RDP. [Relationships]: <process:threat actor, establishes, socket:RDP sessions>. ",
        "semantic_relationship": "[CoT]: The original relationship \"calls\" indicates that the Cobalt Strike process is invoking the OpenSCManagerW process, which aligns with the system-level relationship \"Fork\" as it represents a process executing another process. [System-level Relationships]: <process:Cobalt Strike,Fork,process:OpenSCManagerW>. \n[CoT]: The original relationship \"starts\" indicates that the Cobalt Strike process is initiating the StartServiceA process. In system-level terms, this action corresponds to a \"Fork\" operation where one process creates another. [System-level Relationships]: <process:Cobalt Strike,Fork,process:StartServiceA>. \n[CoT]: The original relationship states that the Cobalt Strike process executes the EnableRDP process, which directly translates to the system-level relationship \"Fork\" between two processes. This indicates that Cobalt Strike spawned or launched another process to enable RDP. [System-level Relationships]: <process:Cobalt Strike,Fork,process:EnableRDP>. \n[CoT]: The original relationship states that the EnableRDP process \"increases\" the max RDP connections allowed. In system-level terms, this action corresponds to writing to the socket:RDP, as it modifies the connection settings for the Remote Desktop Protocol (RDP) socket. The \"Write\" relationship is used here to represent this modifying behavior. [System-level Relationships]: <process:EnableRDP,Write,socket:RDP>. \n[CoT]: The original relationship describes the threat actor (process) establishing sessions to the RDP socket, which aligns with the system-level 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actor,Connect,socket:RDP sessions>. "
    },
    {
        "phase": "command and control",
        "content": "QBot details \u2013 24.229.150.54 // 41.228.22.180\nHere is the initial access DLL (Qbot) information fromTria.ge\nCobalt Strike details \u2013 5.255.98[.]144\nThis Cobalt Strike server was added to ourThreat Feedon 2021-11-16.",
        "relationship": "1. [CoT]: The text states that the IP address 24.229.150.54 belongs to QBot, indicating a process-to-socket relationship. [Relationships]: <process:QBot,access,socket:24.229.150.54>. \n2. [CoT]: The text mentions that QBot uses the IP address 41.228.22.180, indicating another process-to-socket relationship. [Relationships]: <process:QBot,access,socket:41.228.22.180>. \n3. [CoT]: The text refers to a Cobalt Strike server with the IP address 5.255.98[.]144, indicating a process-to-socket relationship with the implicit process Cobalt Strike. [Relationships]: <process:Cobalt Strike,access,socket:5.255.98[.]144>. ",
        "semantic_relationship": "[CoT]: The original relationship \"access\" is too generic. In the context of a process interacting with a socket, the most accurate system-level relationship is \"Connect\" as it describes the action of establishing a connection to a remote IP address. [System-level Relationships]: <process:QBot,Connect,socket:24.229.150.54>. \n[CoT]: The original relationship \"access\" is too generic. In system-level terms, when a process interacts with a socket (IP address), the most accurate relationship is \"Connect\" as it establishes a connection to the remote socket. This aligns with the Process-to-Socket relationship framework where \"Connect\" is the primary action. [System-level Relationships]: <process:QBot,Connect,socket:41.228.22.180>. \n[CoT]: The original relationship \"access\" between the process \"Cobalt Strike\" and the socket \"5.255.98[.]144\" is too generic. In system-level terms, when a process interacts with a socket (especially in the context of Cobalt Strike which is a framework for conducting command and control (C2) operations), the most appropriate relationship is \"Connect\" as it establishes a connection to the remote socket. This aligns with the Process-to-Socket category where \"Connect\" is the primary action. [System-level Relationships]: <process:Cobalt Strike,Connect,socket:5.255.98[.]144>. "
    },
    {
        "phase": "exfiltration",
        "content": "While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165. These alerts tell us that data was indeed exfiltrated from the environment.\nThe threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.\nThe C2 channel was encrypted and multiple connections were established with the internal file server. No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration.\nAt 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.\nAccording to the number of connections to the C2 from the File Server per minute, we can conclude that exfiltration was done between 17:52 UTC and 18:00 UTC.\nSpike in traffic from file share server to Cobalt Strike command and control server.",
        "relationship": "1. [CoT]: The text states that the threat actors opened canary documents from the IP address 91.193.182[.]165, indicating a process-to-socket relationship where the process (threat actors) performed the action 'opened' on the socket (IP address).   [Relationships]: <process:threat actors, opened, socket:91.193.182[.]165>. \n2. [CoT]: The text mentions that the threat actors were most interested in files concerning financial statements, indicating a process-to-file relationship where the process (threat actors) performed the action 'interested in' on the file (financial statements).   [Relationships]: <process:threat actors, interested in, file:financial statements>. \n3. [CoT]: The text states that the threat actors were interested in files concerning ransomware reports, indicating a similar process-to-file relationship as the previous relationship.   [Relationships]: <process:threat actors, interested in, file:ransomware reports>. \n4. [CoT]: The text mentions that the threat actors were interested in files concerning salary data, indicating another process-to-file relationship where the process (threat actors) performed the action 'interested in' on the file (salary data).   [Relationships]: <process:threat actors, interested in, file:salary data>. \n5. [CoT]: The text states that the C2 channel was encrypted and multiple connections were established with the internal file server, indicating a process-to-socket relationship where the process (threat actors) performed the action 'established' on the socket (internal file server).   [Relationships]: <process:threat actors, established, socket:internal file server>. \n6. [CoT]: The text mentions that the Cobalt Strike Beacon was deployed on the File Server at 17:35 UTC, indicating a process-to-process relationship where the process (threat actors) performed the action 'deployed' on the process (Cobalt Strike Beacon).   [Relationships]: <process:threat actors, deployed, process:Cobalt Strike Beacon>. \n7. [CoT]: The text states that there was a spike in traffic from the file share server to the Cobalt Strike command and control server, indicating a process-to-socket relationship where the process (file share server) performed the action 'sent traffic to' on the socket (Cobalt Strike command and control server). [Relationships]: <process:file share server, sent traffic to, socket:Cobalt Strike command and control server>. ",
        "semantic_relationship": "[CoT]: The action 'opened' in the original relationship implies that the threat actors established a connection to the IP address 91.193.182[.]165. In system-level terms, this corresponds to a 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actors,Connect,socket:91.193.182[.]165>. \n[CoT]: The term 'interested in' implies that the threat actors accessed or viewed the financial statements, which corresponds to the system-level relationship 'Read' between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:financial statements>. \n[CoT]: The original relationship \"interested in\" implies that the threat actors were accessing or reading the files on ransomware reports, which aligns with the system-level relationship \"Read\" between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:ransomware reports>. \n[CoT]: The term 'interested in' implies that the threat actors accessed or viewed the salary data file, which corresponds to the system-level relationship 'Read' between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:salary data>. \n[CoT]: The original relationship describes the threat actors establishing a connection to the internal file server, which aligns with the system-level 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actors,Connect,socket:internal file server>. \n[CoT]: The term 'deployed' in the original relationship implies that the threat actors created or spawned the Cobalt Strike Beacon process on the File Server. In system-level terms, this corresponds to a 'Fork' relationship between processes. [System-level Relationships]: <process:threat actors, Fork, process:Cobalt Strike Beacon>. \n[CoT]: The original relationship describes the file share server sending traffic to the Cobalt Strike command and control server, which corresponds to the system-level 'Send' action between a process and a socket. [System-level Relationships]: <process:file share server,Send,socket:Cobalt Strike command and control server>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that the script creates a new registry key entry in the same path, indicating a process-to-registry relationship where the process 'script' creates the registry key. [Original Relationships]: <process:script,creates,registry:Same path>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the script creates a new registry key entry, which directly maps to the system-level relationship 'Createkey' between a process and a registry key. [System-level Relationships]: <process:script,Createkey,reg:Same path>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that the script verifies if the creation date key of the registry key is older than 4 hours, showing a process-to-registry relationship where the process 'script' verifies the registry key. [Original Relationships]: <process:script,verifies,registry:creation date key>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'script' verifies the creation date key of the registry key. In system-level terms, this action corresponds to reading the registry key to check its value, hence the relationship is converted to 'Readkey'. [System-level Relationships]: <process:script,Readkey,reg:creation date key>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The script retrieves the base64-encoded Qbot payload from the Windows Registry, indicating a process-to-registry relationship where the process 'script' retrieves data from the registry. [Original Relationships]: <process:script,retrieves,registry:base64-encoded Qbot payload>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'script' retrieves data from the registry, which implies that the script is reading data (Readkey) from the registry key where the Qbot payload is stored. [System-level Relationships]: <process:script,Readkey,reg:base64-encoded Qbot payload>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The script decodes the base64-encoded payload and saves it on the file system, showing a process-to-file relationship where the process 'script' saves a file. [Original Relationships]: <process:script,saves,file:base64-encoded Qbot payload>. ",
                "semantic_relationship": "[CoT]: The original relationship 'saves' indicates that the process 'script' is writing data to a file, which corresponds to the system-level relationship 'Write' between a process and a file. [System-level Relationships]: <process:script,Write,file:base64-encoded Qbot payload>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The script executes the decoded payload, indicating a process-to-file relationship where the process 'script' executes a file (payload). [Original Relationships]: <process:script,executes,file:payload>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process executing a file, which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:script,Execute,file:payload>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The PS script fetches the QBot payload remotely using an active C2 IP, showing a process-to-socket relationship where the process 'PS script' fetches data from a socket (C2 IP). [Original Relationships]: <process:PS script,fetches,socket:active C2 IPs>. ",
                "semantic_relationship": "[CoT]: The original relationship 'fetches' implies that the PS script receives data from the C2 IP, which aligns with the system-level 'Receive' relationship between a process and a socket. [System-level Relationships]: <process:PS script,Receive,socket:active C2 IPs>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The PS script uses the Invoke-WebRequest PowerShell module to fetch the payload, indicating a process-to-process relationship where the process 'PS script' uses another process (module). [Original Relationships]: <process:PS script,uses,process:Invoke-WebRequest PowerShell module>. ",
                "semantic_relationship": "[CoT]: The original relationship 'uses' between the PS script and the Invoke-WebRequest PowerShell module implies that the PS script is loading the module into its process space. In system-level terms, this corresponds to the 'Loadlibrary' relationship, as the PS script is loading another library (module) into its process. [System-level Relationships]: <process:PS script,Loadlibrary,process:Invoke-WebRequest PowerShell module>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The descriptor describes where the encoded QBot DLL was stored in the registry, showing a process-to-registry relationship where the process 'script' stores the DLL in the registry. [Original Relationships]: <process:script,stores,registry:encoded QBot DLL>. ",
                "semantic_relationship": "[CoT]: The original relationship 'stores' implies that the process 'script' is writing data (the DLL) to the registry, which corresponds to the system-level relationship 'Writekey' between a process and a registry key. [System-level Relationships]: <process:script,Writekey,reg:encoded QBot DLL>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The descriptor mentions that the unsigned DLL was dropped in a specific directory, indicating a process-to-file relationship where the process 'script' drops a file (DLL). [Original Relationships]: <process:script,drops,file:unsigned DLL>. ",
                "semantic_relationship": "[CoT]: The term \"drops\" in the original relationship implies that the process 'script' is creating a new file (unsigned DLL) in the system, which aligns with the system-level relationship 'Create' between a process and a file. [System-level Relationships]: <process:script,Create,file:unsigned DLL>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The script executes regsvr32.exe to execute the unsigned DLL, showing a process-to-process relationship where the process 'script' executes another process (regsvr32.exe). [Original Relationships]: <process:script,executes,process:regsvr32.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'script' executes the process 'regsvr32.exe'. In system-level terms, this corresponds to the 'Fork' relationship between two processes, as the script is directly causing the regsvr32.exe to run. [System-level Relationships]: <process:script,Fork,process:regsvr32.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: Upon execution of the second-stage DLL, various registry keys were created, indicating a process-to-registry relationship where the process 'DLL' creates registry keys. [Original Relationships]: <process:DLL,creates,registry:HKCU\\Software\\Microsoft\\Yerqbqokc>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'DLL' creates registry keys. In system-level terms, this corresponds to the 'Createkey' action between a process and a registry key. The action 'creates' in the original relationship is directly mapped to 'Createkey' in the system-level framework. [System-level Relationships]: <process:DLL,Createkey,reg:HKCU\\Software\\Microsoft\\Yerqbqokc>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: A new instance of explorer.exe was started, showing a process-to-process relationship where the process 'DLL' starts another process (explorer.exe). [Original Relationships]: <process:DLL,starts,process:explorer.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'DLL' starts another process (explorer.exe). In system-level terms, this corresponds to a Fork operation where one process creates another. Therefore, the correct system-level relationship is 'Fork'. [System-level Relationships]: <process:DLL,Fork,process:explorer.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: explorer.exe was injected into by the DLL, indicating a process-to-process relationship where the process 'DLL' injects into process explorer.exe. [Original Relationships]: <process:DLL,injects into,process:explorer.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process ('DLL') injecting into another process (explorer.exe). In the system-level relationships framework, this corresponds to the 'Inject' relationship between two processes. [System-level Relationships]: <process:DLL,Inject,process:explorer.exe>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text states that the threat actors ran an executable file named \"cool.exe,\" indicating a process-to-file relationship where the threat actors (process) ran the executable file (file).   [Original Relationships]: <process:threat actors,ran,file:cool.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the threat actors executed the file \"cool.exe,\" which corresponds to the system-level relationship \"Execute\" between a process and a file. [System-level Relationships]: <process:threat actors,Execute,file:cool.exe>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text mentions that after the Zerologon exploit, an event 4742 was generated on the Domain Controller, indicating a process-to-event relationship where the Zerologon exploit (process) generated the event (event).   [Original Relationships]: <process:Zerologonexploit,generated,event:event 4742 \"A computer account was changed.\">. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Zerologon exploit \"generated\" an event. In system-level terms, this corresponds to a process creating an event (Process-to-Event relationship), hence the \"Create\" action is used. The term \"generated\" in the original description aligns with the system-level \"Create\" action for Process-to-Event relationships. [System-level Relationships]: <process:Zerologonexploit,Create,file:event 4742 \"A computer account was changed.\">. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text describes a brute-force attack performed to spoof the identity of the domain controller, indicating a process-to-socket relationship where the threat actors (process) performed the brute-force attack (socket).   [Original Relationships]: <process:threat actors,performed,socket:brute-force attack>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the threat actors (process) performed a brute-force attack (socket). In system-level terms, this translates to the process initiating a connection attempt to the socket, hence the 'Connect' relationship. Brute-force attacks typically involve establishing connections to targets to attempt authentication exploits. [System-level Relationships]: <process:threat actors,Connect,socket:brute-force attack>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text states that the exploit successfully authenticated to the DC, indicating a process-to-socket relationship where the exploit (process) performed the authentication action (socket).   [Original Relationships]: <process:exploit,performed,socket:authenticated>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the exploit process performed authentication to a socket (DC). In system-level terms, this translates to a 'Connect' action between the process and the socket, as authentication typically involves establishing a connection to a remote socket for further communication. [System-level Relationships]: <process:exploit,Connect,socket:DC>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text describes that the threat actors dumped the Domain Admin hash, indicating a process-to-file relationship where the threat actors (process) dumped the Domain Admin hash (file).   [Original Relationships]: <process:threat actors,dumped,file:Domain Admin hash>. ",
                "semantic_relationship": "[CoT]: The term \"dumped\" in the original relationship implies that the threat actors (process) read the Domain Admin hash (file) to extract its contents, which aligns with the system-level relationship \"Read\" between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:Domain Admin hash>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text states that the threat actors reset the DC password, indicating a process-to-file relationship where the threat actors (process) reset the DC password (file).   [Original Relationships]: <process:threat actors,reset,file:DC password>. ",
                "semantic_relationship": "[CoT]: The action \"reset\" implies that the threat actors modified the DC password file, which aligns with the system-level relationship \"Write\" as it involves changing the content of a file. [System-level Relationships]: <process:threat actors,Write,file:DC password>. "
            },
            {
                "phase": "privilege escalation",
                "relationship": "[Description]: The text mentions that the explorer shell was restarted by the threat actor, indicating a process-to-process relationship where the threat actor (process) restarted the explorer shell (process). [Original Relationships]: <process:threat actor,restarted,process:explorer shell>. ",
                "semantic_relationship": "[CoT]: The original relationship \"restarted\" implies that the threat actor terminated the explorer shell process and then immediately created a new instance of it. In system-level terms, this is best represented as a \"Exit\" relationship from the threat actor process to the explorer shell process. [System-level Relationships]: <process:threat actor,Exit,process:explorer shell>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text states that QBot uses process hollowing to start a suspended instance of explorer.exe, indicating a process-to-process relationship where QBot is the process initiating the action.   [Original Relationships]: <process:QBot,uses,process:explorer.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that QBot \"uses\" process hollowing to start a suspended instance of explorer.exe. Process hollowing is a technique where a process creates a new process instance, but then manipulates it to run in a suspended state. This is typically done to evade detection or inject code into the new process. In system-level terms, this action corresponds to a \"Fork\" relationship between the two processes. [System-level Relationships]: <process:QBot,Fork,process:explorer.exe>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text mentions that QBot injects itself into the explorer.exe process, indicating a process-to-process relationship where QBot is the process performing the injection action.   [Original Relationships]: <process:QBot,injects,process:explorer.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship describes QBot injecting into explorer.exe, which directly corresponds to the system-level 'Inject' relationship between processes. No transformation was needed as the original relationship already matches the system-level equivalent. [System-level Relationships]: <process:QBot,Inject,process:explorer.exe>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text describes that the injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit), indicating a process-to-process relationship where explorer.exe is the process performing the spawn action.   [Original Relationships]: <process:explorer.exe,spawns,process:explorer.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"spawns\" indicates that the parent process (explorer.exe) created a new process (also explorer.exe). In system-level terms, this is best represented as a \"Fork\" relationship between the two processes. Fork is the standard system-level action for process creation. [System-level Relationships]: <process:explorer.exe,Fork,process:explorer.exe>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text mentions that the threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit, indicating a process-to-process relationship where the Zerologon exploit is the process performing the action of obtaining the hash.   [Original Relationships]: <process:Zerologon exploit,obtains,process:NTLM hash value>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Zerologon exploit \"obtains\" the NTLM hash value. In system-level terms, this action corresponds to the exploit reading the hash value from memory or another process, hence the \"Inject\" relationship. [System-level Relationships]: <process:Zerologon exploit,Inject,process:NTLM hash value>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text states that the threat actor used over-pass-the-hash to request a TGT from the domain controller, indicating a process-to-process relationship where over-pass-the-hash is the process performing the action of requesting the TGT.   [Original Relationships]: <process:over-pass-the-hash,requests,process:TGT>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (over-pass-the-hash) requesting a TGT from a domain controller. In system-level terms, this action corresponds to a process-to-process Request Package, as the over-pass-the-hash process is initiating a request for another process (TGT). This is a standard interaction between processes in a network environment. [System-level Relationships]: <process:over-pass-the-hash,Request,process:TGT>. "
            },
            {
                "phase": "defense evasion",
                "relationship": "[Description]: The text describes that a TGT for the administrator account was requested soon after, indicating a process-to-process relationship where an unknown threat actor agent requested the TGT.   [Original Relationships]: <process:threat actor agent,request,process:TGT>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (threat actor agent) requesting a TGT. In system-level terms, this action corresponds to a process-to-process Fork action, as the threat actor agent is seeking to fork another process (the TGT). [System-level Relationships]: <process:threat actor agent,Fork,process:TGT>. "
            },
            {
                "phase": "discovery",
                "relationship": "[Description]: The text states that QBot starts processes as part of its collection activity, indicating a process-to-process relationship where QBot is the source process and \"starts\" is the verb.   [Original Relationships]: <process:QBot,start,process:process>. ",
                "semantic_relationship": "[CoT]: The term \"starts\" in the original relationship implies that QBot is creating a new process, which aligns with the system-level relationship \"Fork\" as it denotes the creation of a child process by a parent process. [System-level Relationships]: <process:QBot,Fork,process:process>. "
            },
            {
                "phase": "discovery",
                "relationship": "[Description]: The text mentions that more discovery commands were executed via the Cobalt Strike beacon, showing a process-to-process relationship where the Cobalt Strike beacon is the source process and \"executed\" is the verb.   [Original Relationships]: <process:Cobalt Strike beacon,execute,process:discovery commands>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the Cobalt Strike beacon executing other processes, which directly maps to the system-level 'Fork' relationship between processes. [System-level Relationships]: <process:Cobalt Strike beacon,Fork,process:discovery commands>. "
            },
            {
                "phase": "discovery",
                "relationship": "[Description]: The text describes ADFind (renamed to find.exe) being used to enumerate computers, indicating a process-to-process relationship where ADFind (find.exe) is the source process and \"enumerated\" is the verb.   [Original Relationships]: <process:ADFind(renamed in find.exe),enumerate,process:computers>. ",
                "semantic_relationship": "[CoT]: The verb \"enumerate\" in the original relationship implies that ADFind (find.exe) is reading data from other processes to gather information about computers, which aligns with the system-level \"Inject\" relationship between processes. This reflects the action of one process reading data from another. [System-level Relationships]: <process:ADFind(renamed in find.exe),Inject,process:computers>. "
            },
            {
                "phase": "discovery",
                "relationship": "[Description]: The text states that threat actors gathered information about installed security software through WMI, showing a process-to-process relationship where WMI is the source process and \"gathered\" is the verb.   [Original Relationships]: <process:WMI,gathered,process:information about installed security software>. ",
                "semantic_relationship": "[CoT]: The verb \"gathered\" implies that the WMI process read information from another process or system resource, which aligns with the system-level relationship \"Inject\" between processes. This is a common technique for memory injection or data extraction in cyber attacks. [System-level Relationships]: <process:WMI,Inject,process:information about installed security software>. "
            },
            {
                "phase": "discovery",
                "relationship": "[Description]: The text mentions that ping was used to verify machines were online, indicating a process-to-process relationship where ping is the source process and \"verified\" is the verb.   [Original Relationships]: <process:ping,verify,process:machines were online>. ",
                "semantic_relationship": "[CoT]: The verb \"verify\" in the original relationship implies that the ping process is attempting to establish a connection to the machines, which aligns with the system-level \"Connect\" relationship between processes. [System-level Relationships]: <process:ping,Connect,process:machines were online>. "
            },
            {
                "phase": "lateral movement",
                "relationship": "[Description]: The text states \"Cobalt Strike first calls OpenSCManagerW to create the service remotely,\" indicating that the Cobalt Strike process performs the action of calling the OpenSCManagerW process.   [Original Relationships]: <process:Cobalt Strike, calls, process:OpenSCManagerW>. ",
                "semantic_relationship": "[CoT]: The original relationship \"calls\" indicates that the Cobalt Strike process is invoking the OpenSCManagerW process, which aligns with the system-level relationship \"Fork\" as it represents a process executing another process. [System-level Relationships]: <process:Cobalt Strike,Fork,process:OpenSCManagerW>. "
            },
            {
                "phase": "lateral movement",
                "relationship": "[Description]: The text mentions \"then starts it with StartServiceA function,\" showing that Cobalt Strike processes starts the StartServiceA process as part of the service creation.   [Original Relationships]: <process:Cobalt Strike, starts, process:StartServiceA>. ",
                "semantic_relationship": "[CoT]: The original relationship \"starts\" indicates that the Cobalt Strike process is initiating the StartServiceA process. In system-level terms, this action corresponds to a \"Fork\" operation where one process creates another. [System-level Relationships]: <process:Cobalt Strike,Fork,process:StartServiceA>. "
            },
            {
                "phase": "lateral movement",
                "relationship": "[Description]: The text states \"Various commands were executed to enable the RDP service,\" implying that the Cobalt Strike process executes other commands, which we label as the EnableRDP process.   [Original Relationships]: <process:Cobalt Strike, executes, process:EnableRDP>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Cobalt Strike process executes the EnableRDP process, which directly translates to the system-level relationship \"Fork\" between two processes. This indicates that Cobalt Strike spawned or launched another process to enable RDP. [System-level Relationships]: <process:Cobalt Strike,Fork,process:EnableRDP>. "
            },
            {
                "phase": "lateral movement",
                "relationship": "[Description]: The text describes \"increase the max RDP connections allowed,\" showing that the EnableRDP process performs the action of increasing connections to the socket:RDP. [Original Relationships]: <process:EnableRDP, increases, socket:RDP>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the EnableRDP process \"increases\" the max RDP connections allowed. In system-level terms, this action corresponds to writing to the socket:RDP, as it modifies the connection settings for the Remote Desktop Protocol (RDP) socket. The \"Write\" relationship is used here to represent this modifying behavior. [System-level Relationships]: <process:EnableRDP,Write,socket:RDP>. "
            },
            {
                "phase": "lateral movement",
                "relationship": "[Description]: The text mentions \"established interactive administrative RDP sessions,\" indicating that the threat actor (process) established sessions to the socket:RDP. [Original Relationships]: <process:threat actor, establishes, socket:RDP sessions>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the threat actor (process) establishing sessions to the RDP socket, which aligns with the system-level 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actor,Connect,socket:RDP sessions>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that the IP address 24.229.150.54 belongs to QBot, indicating a process-to-socket relationship. [Original Relationships]: <process:QBot,access,socket:24.229.150.54>. ",
                "semantic_relationship": "[CoT]: The original relationship \"access\" is too generic. In the context of a process interacting with a socket, the most accurate system-level relationship is \"Connect\" as it describes the action of establishing a connection to a remote IP address. [System-level Relationships]: <process:QBot,Connect,socket:24.229.150.54>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that QBot uses the IP address 41.228.22.180, indicating another process-to-socket relationship. [Original Relationships]: <process:QBot,access,socket:41.228.22.180>. ",
                "semantic_relationship": "[CoT]: The original relationship \"access\" is too generic. In system-level terms, when a process interacts with a socket (IP address), the most accurate relationship is \"Connect\" as it establishes a connection to the remote socket. This aligns with the Process-to-Socket relationship framework where \"Connect\" is the primary action. [System-level Relationships]: <process:QBot,Connect,socket:41.228.22.180>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text refers to a Cobalt Strike server with the IP address 5.255.98[.]144, indicating a process-to-socket relationship with the implicit process Cobalt Strike. [Original Relationships]: <process:Cobalt Strike,access,socket:5.255.98[.]144>. ",
                "semantic_relationship": "[CoT]: The original relationship \"access\" between the process \"Cobalt Strike\" and the socket \"5.255.98[.]144\" is too generic. In system-level terms, when a process interacts with a socket (especially in the context of Cobalt Strike which is a framework for conducting command and control (C2) operations), the most appropriate relationship is \"Connect\" as it establishes a connection to the remote socket. This aligns with the Process-to-Socket category where \"Connect\" is the primary action. [System-level Relationships]: <process:Cobalt Strike,Connect,socket:5.255.98[.]144>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text states that the threat actors opened canary documents from the IP address 91.193.182[.]165, indicating a process-to-socket relationship where the process (threat actors) performed the action 'opened' on the socket (IP address).   [Original Relationships]: <process:threat actors, opened, socket:91.193.182[.]165>. ",
                "semantic_relationship": "[CoT]: The action 'opened' in the original relationship implies that the threat actors established a connection to the IP address 91.193.182[.]165. In system-level terms, this corresponds to a 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actors,Connect,socket:91.193.182[.]165>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text mentions that the threat actors were most interested in files concerning financial statements, indicating a process-to-file relationship where the process (threat actors) performed the action 'interested in' on the file (financial statements).   [Original Relationships]: <process:threat actors, interested in, file:financial statements>. ",
                "semantic_relationship": "[CoT]: The term 'interested in' implies that the threat actors accessed or viewed the financial statements, which corresponds to the system-level relationship 'Read' between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:financial statements>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text states that the threat actors were interested in files concerning ransomware reports, indicating a similar process-to-file relationship as the previous relationship.   [Original Relationships]: <process:threat actors, interested in, file:ransomware reports>. ",
                "semantic_relationship": "[CoT]: The original relationship \"interested in\" implies that the threat actors were accessing or reading the files on ransomware reports, which aligns with the system-level relationship \"Read\" between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:ransomware reports>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text mentions that the threat actors were interested in files concerning salary data, indicating another process-to-file relationship where the process (threat actors) performed the action 'interested in' on the file (salary data).   [Original Relationships]: <process:threat actors, interested in, file:salary data>. ",
                "semantic_relationship": "[CoT]: The term 'interested in' implies that the threat actors accessed or viewed the salary data file, which corresponds to the system-level relationship 'Read' between a process and a file. [System-level Relationships]: <process:threat actors,Read,file:salary data>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text states that the C2 channel was encrypted and multiple connections were established with the internal file server, indicating a process-to-socket relationship where the process (threat actors) performed the action 'established' on the socket (internal file server).   [Original Relationships]: <process:threat actors, established, socket:internal file server>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the threat actors establishing a connection to the internal file server, which aligns with the system-level 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:threat actors,Connect,socket:internal file server>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text mentions that the Cobalt Strike Beacon was deployed on the File Server at 17:35 UTC, indicating a process-to-process relationship where the process (threat actors) performed the action 'deployed' on the process (Cobalt Strike Beacon).   [Original Relationships]: <process:threat actors, deployed, process:Cobalt Strike Beacon>. ",
                "semantic_relationship": "[CoT]: The term 'deployed' in the original relationship implies that the threat actors created or spawned the Cobalt Strike Beacon process on the File Server. In system-level terms, this corresponds to a 'Fork' relationship between processes. [System-level Relationships]: <process:threat actors, Fork, process:Cobalt Strike Beacon>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text states that there was a spike in traffic from the file share server to the Cobalt Strike command and control server, indicating a process-to-socket relationship where the process (file share server) performed the action 'sent traffic to' on the socket (Cobalt Strike command and control server). [Original Relationships]: <process:file share server, sent traffic to, socket:Cobalt Strike command and control server>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the file share server sending traffic to the Cobalt Strike command and control server, which corresponds to the system-level 'Send' action between a process and a socket. [System-level Relationships]: <process:file share server,Send,socket:Cobalt Strike command and control server>. "
            }
        ]
    }
]