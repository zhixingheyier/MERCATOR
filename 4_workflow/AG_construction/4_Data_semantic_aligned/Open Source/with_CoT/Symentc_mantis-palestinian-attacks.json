[
    {
        "phase": "initial access",
        "content": "The initial infection vector for this campaign remains unknown. In one organization targeted, a feature of the compromise was that the attackers deployed three distinct versions of the same toolset (i.e. different variants of the same tools) on three groups of computers. Compartmentalizing the attack in this fashion was likely a precautionary measure. If one toolset was discovered, the attackers would still have a persistent presence on the target's network.\nThe following is a description of how one of those three toolsets was used:\nThe first evidence of malicious activity occurred on December 18, 2022. Three distinct sets of obfuscated PowerShell commands were executed to load a Base64-encoded string, which started embedded shellcode. The shellcode was a 32-bit stager that downloaded another stage using basic TCP-based protocol from a command-and-control (C&C) server: 104.194.222[.]50 port 4444.\nThe attackers returned on December 19 to dump credentials before downloading the Micropsia backdoor and Putty,a publicly available SSH client, using Certutil and BITSAdmin\nMicropsia subsequently executed and initiated contact with a C&C server. On the same day, Micropsia also executed on three other machines in the same organization. In each case, it ran in a folder named after its file name:\ncsidl_common_appdata\\systempropertiesinternationaltime\\systempropertiesinternationaltime.exe\ncsidl_common_appdata\\windowsnetworkmanager\\windowsnetworkmanager.exe\ncsidl_common_appdata\\windowsps\\windowsps.exe\nOn one computer, Micropsia was used to set up a reverse socks tunnel to an external IP address:\nCSIDL_COMMON_APPDATA\\windowsservicemanageav\\windowsservicemanageav.exe -connect 104.194.222[.]50:443 [REDACTED]\nOn December 20, Micropsia was used to run an unknown executable named windowspackages.exe on one of the infected computers.\nThe following day, December 21, RAR was executed to archive files on another infected computer.\nBetween December 22 and January 2, 2023, Micropsia was used to execute the Arid Gopher backdoor on three infected computers. Arid Gopher was in turn used to run a tool called SetRegRunKey.exe that provided persistence by adding Arid Gopher to the registry so that it executed on reboot. It also ran an unknown file named localsecuritypolicy.exe (this file name was used for the Arid Gopher backdoor elsewhere by the attackers).\nOn December 28, Micropsia was used to run windowspackages.exe on three more infected computers.\nOn December 31, Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe on two of the infected computers.\nOn January 2, the attackers retired the version of Arid Gopher they were using and introduced a new variant. Whether this was because the first version was discovered or whether it was standard operating procedure is unclear.\nOn January 4, Micropsia was used to execute two unknown files, both named hostupbroker.exe, on a single computer from the folder: csidl_common_appdata\\hostupbroker\\hostupbroker.exe. This was immediately followed by the exfiltration of a RAR file:\nCSIDL_COMMON_APPDATA\\windowsupserv\\windowsupserv.exe -f CSIDL_COMMON_APPDATA\\windowspackages\\01-04-2023-15-13-39_getf.rar\nOn January 9, Arid Gopher was used to execute two unknown files on a single computer:\ncsidl_common_appdata\\teamviewrremoteservice\\teamviewrremoteservice.exe\ncsidl_common_appdata\\embededmodeservice\\embededmodeservice.exe\nThe last malicious activity occurred from January 12 onwards when Arid Gopher was used to execute the unknown file named localsecuritypolicy.exe every ten hours.",
        "relationship": "1. [CoT]: The text states that three distinct sets of obfuscated PowerShell commands were executed, which implies that the PowerShell process executed the commands. [Relationships]: <process:PowerShell,executed,file:obfuscated PowerShell commands>. \n2. [CoT]: The text mentions that the PowerShell commands loaded a Base64-encoded string, indicating that the PowerShell process loaded the string file. [Relationships]: <process:PowerShell,loaded,file:Base64-encoded string>. \n3. [CoT]: The shellcode downloaded another stage from a C&C server, which is the IP address 104.194.222[.]50 port 4444. This is treated as a socket entity. [Relationships]: <process:shellcode,downloaded,socket:104.194.222[.]50 port 4444>. \n4. [CoT]: The text describes that Micropsia executed and initiated contact with a C&C server, which is again treated as a socket entity. [Relationships]: <process: Micropsia,initiated contact,socket:C&C server>. \n5. [CoT]: Micropsia was used to set up a reverse socks tunnel to an external IP address, which is another socket entity. [Relationships]: <process: Micropsia,set up,socket:external IP address>. \n6. [CoT]: Micropsia was used to run an unknown executable named windowspackages.exe. [Relationships]: <process: Micropsia,ran,file:windowspackages.exe>. \n7. [CoT]: RAR was executed to archive files, implying that the RAR process archived files. [Relationships]: <process:RAR,archived,file:files>. \n8. [CoT]: Micropsia was used to execute the Arid Gopher backdoor. [Relationships]: <process: Micropsia,executed,process:Arid Gopher backdoor>. \n9. [CoT]: Arid Gopher was used to run a tool called SetRegRunKey.exe. [Relationships]: <process:Arid Gopher,ran,file:SetRegRunKey.exe>. \n10. [CoT]: Arid Gopher was used to run an unknown file named localsecuritypolicy.exe. [Relationships]: <process:Arid Gopher,ran,file:localsecuritypolicy.exe>. \n11. [CoT]: Micropsia was used to run windowspackages.exe. [Relationships]: <process: Micropsia,ran,file:windowspackages.exe>. \n12. [CoT]: Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe. [Relationships]: <process:Arid Gopher,executed,file:networkswitcherdatamodell.exe>. \n13. [CoT]: Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe. [Relationships]: <process:Arid Gopher,executed,file:networkuefidiagsbootserver.exe>. \n14. [CoT]: Micropsia was used to execute two unknown files, both named hostupbroker.exe. [Relationships]: <process: Micropsia,executed,file:hostupbroker.exe>. \n15. [CoT]: windowsupserv.exe exfiltrated a RAR file. [Relationships]: <process:windowsupserv.exe,exfiltrated,file:01-04-2023-15-13-39_getf.rar>. \n16. [CoT]: Arid Gopher was used to execute two unknown files on a single computer. [Relationships]: <process:Arid Gopher,executed,file:teamviewrremoteservice.exe>. \n17. [CoT]: Arid Gopher was used to execute two unknown files on a single computer. [Relationships]: <process:Arid Gopher,executed,file:embededmodeservice.exe>. \n18. [CoT]: Arid Gopher was used to execute the unknown file named localsecuritypolicy.exe every ten hours. [Relationships]: <process:Arid Gopher,executed,file:localsecuritypolicy.exe>. ",
        "semantic_relationship": "[CoT]: The original relationship indicates that the PowerShell process executed the obfuscated PowerShell commands, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process:PowerShell,Execute,file:obfuscated PowerShell commands>. \n[CoT]: The original relationship \"loaded\" indicates that the PowerShell process loaded a file (the Base64-encoded string). In system-level terms, this corresponds to the \"Loadlibrary\" relationship between a process and a file. [System-level Relationships]: <process:PowerShell,Loadlibrary,file:Base64-encoded string>. \n[CoT]: The original relationship \"downloaded\" implies that the shellcode received data from the specified socket, which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:shellcode,Receive,socket:104.194.222[.]50 port 4444>. \n[CoT]: The original relationship \"initiated contact\" indicates that Micropsia established a connection to the C&C server, which aligns with the system-level relationship \"Connect\" between a process and a socket. [System-level Relationships]: <process: Micropsia,Connect,socket:C&C server>. \n[CoT]: The original relationship \"set up\" implies that the Micropsia process established a connection to the external IP address socket. In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process: Micropsia,Connect,socket:external IP address>. \n[CoT]: The original relationship \"ran\" indicates that the process Micropsia executed the file windowspackages.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:windowspackages.exe>. \n[CoT]: The original relationship states that the RAR process \"archived\" files, which implies that it compressed them into a RAR file. In system-level terms, this action corresponds to writing the compressed data to a new file, hence the \"Write\" relationship between the process and the file. The input files are the sources being compressed, while the output is the archived RAR file. [System-level Relationships]: <process:RAR,Write,file:archived_file>. <process:RAR,Read,file:input_files>. \n[CoT]: The original relationship \"executed\" indicates that the Micropsia process launched or ran the Arid Gopher backdoor process. In system-level terms, this corresponds to the \"Fork\" relationship between processes. [System-level Relationships]: <process: Micropsia,Fork,process:Arid Gopher backdoor>. \n[CoT]: The original relationship \"ran\" indicates that the process Arid Gopher executed the file SetRegRunKey.exe, which corresponds to the system-level relationship \"Execute\". [System-level Relationships]: <process:Arid Gopher,Execute,file:SetRegRunKey.exe>. \n[CoT]: The original relationship \"ran\" indicates that the process Arid Gopher executed the file localsecuritypolicy.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. \n[CoT]: The original relationship \"ran\" indicates that the process Micropsia executed the file windowspackages.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:windowspackages.exe>. \n[CoT]: The original relationship indicates that the process \"Arid Gopher\" executed the file \"networkswitcherdatamodell.exe\". In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkswitcherdatamodell.exe>. \n[CoT]: The original relationship indicates that the process \"Arid Gopher\" executed the file \"networkuefidiagsbootserver.exe\". In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkuefidiagsbootserver.exe>. \n[CoT]: The original relationship states that Micropsia executed the file hostupbroker.exe, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:hostupbroker.exe>. \n[CoT]: The original relationship \"exfiltrated\" indicates that the process windowsupserv.exe wrote the file 01-04-2023-15-13-39_getf.rar to a remote location, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:windowsupserv.exe,Write,file:01-04-2023-15-13-39_getf.rar>. \n[CoT]: The original relationship states that Arid Gopher executed the file teamviewrremoteservice.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:teamviewrremoteservice.exe>. \n[CoT]: The original relationship states that Arid Gopher executed the file 'embededmodeservice.exe'. In system-level terms, this corresponds to a Process-to-File relationship of type 'Execute', as the process is performing an execution action on the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:embededmodeservice.exe>. \n[CoT]: The original relationship states that Arid Gopher executed the file localsecuritypolicy.exe, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. "
    },
    {
        "phase": "execution",
        "content": "Variants of the Micropsia backdoor used in these attacks appear to be slightly updated versions of those seen by other vendors. In this campaign, Micropsia was deployed using multiple file names and file paths:\ncsidl_common_appdata\\microsoft\\dotnet35\\microsoftdotnet35.exe\ncsidl_common_appdata\\microsoftservicesusermanual\\systempropertiesinternationaltime.exe\ncsidl_common_appdata\\systempropertiesinternationaltime\\systempropertiesinternationaltime.exe\ncsidl_common_appdata\\windowsnetworkmanager\\windowsnetworkmanager.exe\ncsidl_common_appdata\\windowsps\\windowsps.exe\nMicropsia is executed using WMI and its main purpose appears to be running secondary payloads for the attackers. These included:\nArid Gopher (file names: networkvirtualizationstartservice.exe, networkvirtualizationfiaservice.exe, networkvirtualizationseoservice.exe)\nReverse SOCKs Tunneler(aka Revsocks) (file name: windowsservicemanageav.exe)\nData Exfiltration Tool (file name: windowsupserv.exe)\nTwo unknown files, both named hostupbroker.exe\nUnknown file named windowspackages.exe\nIn addition to this, Micropsia has its own functionality, such as taking screenshots, keylogging, and archiving certain file types using WinRAR in preparation for data exfiltration:\n\"%PROGRAMDATA%\\Software Distributions\\WinRAR\\Rar.exe\" a -r -ep1 -v2500k -hp71012f4c6bdeeb73ae2e2196aa00bf59_d01247a1eaf1c24ffbc851e883e67f9b -ta2023-01-14 \"%PROGRAMDATA%\\Software Distributions\\Bdl\\LMth__C_2023-02-13 17-14-41\" \"%USERPROFILE%\\*.xls\" \"%USERPROFILE%\\*.xlsx\" \"%USERPROFILE%\\*.doc\" \"%USERPROFILE%\\*.docx\" \"%USERPROFILE%\\*.csv\" \"%USERPROFILE%\\*.pdf\" \"%USERPROFILE%\\*.ppt\" \"%USERPROFILE%\\*.pptx\" \"%USERPROFILE%\\*.odt\" \"%USERPROFILE%\\*.mdb\" \"%USERPROFILE%\\*.accdb\" \"%USERPROFILE%\\*.accde\" \"%USERPROFILE%\\*.txt\" \"%USERPROFILE%\\*.rtf\" \"%USERPROFILE%\\*.vcf\"",
        "relationship": "1. [CoT]: The text states that Micropsia was deployed using the file path 'csidl_common_appdata\\microsoft\\dotnet35\\microsoftdotnet35.exe', indicating that the Micropsia backdoor process deployed the Microsoftdotnet35.exe file.   [Relationships]: <process:Micropsia,deployed,file:Microsoftdotnet35.exe>. \n2. [CoT]: The text mentions that Micropsia was deployed using multiple file paths, including 'csidl_common_appdata\\systempropertiesinternationaltime\\systempropertiesinternationaltime.exe'. This indicates that the Micropsia backdoor process deployed this file.   [Relationships]: <process:Micropsia,deployed,file:Systempropertiesinternationaltime.exe>. \n3. [CoT]: The text states that Micropsia was deployed using the file path 'csidl_common_appdata\\windowsnetworkmanager\\windowsnetworkmanager.exe', showing that the Micropsia backdoor process deployed this file.   [Relationships]: <process:Micropsia,deployed,file:windowsnetworkmanager.exe>. \n4. [CoT]: The text describes that Micropsia was deployed using the file path 'csidl_common_appdata\\windowsps\\windowsps.exe', indicating that the Micropsia backdoor process deployed this file.   [Relationships]: <process:Micropsia,deployed,file:windowsps.exe>. \n5. [CoT]: The text lists various secondary payloads executed by Micropsia, including the file 'networkvirtualizationstartservice.exe', showing that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:networkvirtualizationstartservice.exe>. \n6. [CoT]: The text mentions another secondary payload 'networkvirtualizationfiaservice.exe' executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:networkvirtualizationfiaservice.exe>. \n7. [CoT]: The text describes a secondary payload 'networkvirtualizationseoservice.exe' executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:networkvirtualizationseoservice.exe>. \n8. [CoT]: The text lists a secondary payload 'windowsservicemanageav.exe' (aka Revsocks) executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:windowsservicemanageav.exe>. \n9. [CoT]: The text mentions a secondary payload 'windowsupserv.exe' (Data Exfiltration Tool) executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:windowsupserv.exe>. \n10. [CoT]: The text describes an unknown file 'hostupbroker.exe' executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:hostupbroker.exe>. \n11. [CoT]: The text lists another unknown file 'windowspackages.exe' executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Relationships]: <process:Micropsia,executed,file:windowspackages.exe>. \n12. [CoT]: The text mentions the use of 'WinRAR' to archive certain file types, where 'WinRAR.exe' is the process name and '%PROGRAMDATA%\\Software Distributions\\WinRAR\\Rar.exe' is the file path mentioned in the text. This indicates that the Micropsia backdoor process used the WinRAR.exe process.   [Relationships]: <process:Micropsia,used,process:WinRAR.exe>. \n13. [CoT]: The text describes the specific file paths and patterns targeted for archiving by WinRAR.exe, which was used by the Micropsia backdoor process.   [Relationships]: <process:Micropsia,archived,file:%PROGRAMDATA%\\Software Distributions\\Bdl\\LMth__C_2023-02-13 17-14-41>. ",
        "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process wrote the Microsoftdotnet35.exe file to the specified location, which aligns with the system-level \"Write\" relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Write,file:Microsoftdotnet35.exe>. \n[CoT]: The original relationship 'deployed' implies that the Micropsia process created the 'Systempropertiesinternationaltime.exe' file on the specified path. In system-level terms, this corresponds to the 'Create' action between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:Systempropertiesinternationaltime.exe>. \n[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process created the file 'windowsnetworkmanager.exe' on the system, which aligns with the system-level relationship \"Create\" between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:windowsnetworkmanager.exe>. \n[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process created the file 'windowsps.exe' on the system, which aligns with the system-level relationship \"Create\" between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:windowsps.exe>. \n[CoT]: The original relationship indicates that the Micropsia process executed the 'networkvirtualizationstartservice.exe' file, which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationstartservice.exe>. \n[CoT]: The original relationship states that the process 'Micropsia' executed the file 'networkvirtualizationfiaservice.exe'. In system-level terms, this directly maps to the 'Execute' relationship between a process and a file, as it describes a process running or launching another executable file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationfiaservice.exe>. \n[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'networkvirtualizationseoservice.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationseoservice.exe>. \n[CoT]: The original relationship states that the process 'Micropsia' executed the file 'windowsservicemanageav.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowsservicemanageav.exe>. \n[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'windowsupserv.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowsupserv.exe>. \n[CoT]: The original relationship states that the process 'Micropsia' executed the file 'hostupbroker.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:hostupbroker.exe>. \n[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'windowspackages.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowspackages.exe>. \n[CoT]: The original relationship states that the Micropsia process \"used\" the WinRAR.exe process. In system-level terms, this could imply that Micropsia executed the WinRAR.exe process to perform its actions, hence the \"Fork\" relationship. [System-level Relationships]: <process:Micropsia,Fork,process:WinRAR.exe>. \n[CoT]: The original relationship describes Micropsia archiving a file, which in system-level terms translates to the 'Write' operation since archiving involves writing data to a new location. The file path is also normalized to remove unnecessary characters like spaces and special symbols. [System-level Relationships]: <process:Micropsia,Write,file:%PROGRAMDATA%\\SoftwareDistributions\\Bdl\\LMth__C_2023-02-13 17-14-41>. "
    },
    {
        "phase": "execution",
        "content": "Unlike Micropsia, which is written in Delphi, Arid Gopher is written in Go. Versions of Arid Gopher used in this campaign contain the following embedded components:\n7za.exe \u2013 A copy of the legitimate 7-Zip executable\nAttestationWmiProvider.exe \u2013 A tool that sets a \"run\" registry value\nServiceHubIdentityHost.exe \u2013 A copy of legitimate Shortcut.exe executable from Optimum X\nSetup.env \u2013 Configuration file\nArid Gopher was also used to launch the following unknown files: networkswitcherdatamodell.exe, localsecuritypolicy.exe, and networkuefidiagsbootserver.exe, in addition to being used to download and execute files obfuscated with PyArmor.\nWhen communicating with a C&C server, Arid Gopher registers a device on one path then connects to another path, likely to receive commands:\nConnects to: http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134) - likely to register device\nFollowed by: http://jumpstartmail[.]com/IURTIER3BNV4ER/AJLUK9BI48/0L6W3CSBMC - likely to receive commands\nConnects to: http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32) - likely to register device\nArid Gopher appears to be regularly updated and rewritten by the attackers, most likely in order to evade detection. One variant of the malware was radically different from previous versions seen with most of the distinctive code updated, so much so that there was not a single subroutine that contained identical distinctive code when compared with the previous version. Mantis appeared to be aggressively mutating the logic between variants, which is a time-intensive operation if done manually.\nThe embedded setup.env file used by one analyzed variant of Arid Gopher to retrieve configuration data contained the following:\nDIR=WindowsPerceptionService\nENDPOINT=http://jumpstartmail[.]com/IURTIER3BNV4ER\nLOGS=logs.txt\nDID=code.txt\nVER=6.1\nEN=2\nST_METHOD=r\nST_MACHINE=false\nST_FLAGS=x\nCOMPRESSOR=7za.exe\nDDIR=ResourcesFiles\nBW_TOO_ID=7463b9da-7606-11ed-a1eb-0242ac120002\nSERVER_TOKEN=PDqMKZ91l2XDmDELOrKB\nSTAPP=AttestationWmiProvider.exe\nSHORT_APP=ServiceHubIdentityHost.exe\nThe setup.env configuration file mentions another file, AttestationWmiProvider.exe, which is also embedded in Arid Gopher. The file is a 32-bit executable that is used as a helper to ensure that another executable will run on reboot. When it executes, it checks for the following command-line arguments:\n\"key\" with string parameter [RUN_VALUE_NAME]\n\"value\" with string parameter [RUN_PATHNAME]\nIt then arranges to receive notification on a signal using func os/signal.Notify(). Once notified, it sets the following registry value:\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"[RUN_VALUE_NAME]\" = \"[RUN_PATHNAME]\"\nOur investigation so far shows this file setting Arid Gopher to run on reboot:\nCSIDL_COMMON_APPDATA\\attestationwmiprovider\\attestationwmiprovider.exe -key=NetworkVirtualizationStartService \"-value=CSIDL_COMMON_APPDATA\\networkvirtualizationstartservice\\networkvirtualizationstartservice.exe -x\"",
        "relationship": "1. [CoT]: The text states that Arid Gopher was used to launch the file 'networkswitcherdatamodell.exe'.   [Relationships]: <process:Arid Gopher,launch,file:networkswitcherdatamodell.exe>. \n2. [CoT]: The text mentions that Arid Gopher was used to launch the file 'localsecuritypolicy.exe'.   [Relationships]: <process:Arid Gopher,launch,file:localsecuritypolicy.exe>. \n3. [CoT]: The text states that Arid Gopher was used to launch the file 'networkuefidiagsbootserver.exe'.   [Relationships]: <process:Arid Gopher,launch,file:networkuefidiagsbootserver.exe>. \n4. [CoT]: The text indicates that Arid Gopher was used to download files obfuscated with PyArmor.   [Relationships]: <process:Arid Gopher,download,file:files obfuscated with PyArmor>. \n5. [CoT]: The text describes Arid Gopher connecting to the URL http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134) to register a device.   [Relationships]: <process:Arid Gopher,connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134)>. \n6. [CoT]: The text states that Arid Gopher connects to another URL likely to receive commands after registering the device.   [Relationships]: <process:Arid Gopher,connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/AJLUK9BI48/0L6W3CSBMC>. \n7. [CoT]: The text mentions Arid Gopher connecting to the URL http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32) to register a device.   [Relationships]: <process:Arid Gopher,connect,socket:http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32)>. \n8. [CoT]: The setup.env configuration file references the file DIR=WindowsPerceptionService, which is a directory path. [Relationships]: <process:Arid Gopher,access,file:DIR=WindowsPerceptionService>. \n9. [CoT]: The setup.env configuration file mentions the ENDPOINT http://jumpstartmail[.]com/IURTIER3BNV4ER, which is a URL. [Relationships]: <process:Arid Gopher,access,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER>. \n10. [CoT]: The setup.env configuration file references the file LOGS=logs.txt. [Relationships]: <process:Arid Gopher,access,file:LOGS=logs.txt>. \n11. [CoT]: The setup.env configuration file mentions the file DID=code.txt. [Relationships]: <process:Arid Gopher,access,file:DID=code.txt>. \n12. [CoT]: The setup.env configuration file is used by Arid Gopher to retrieve configuration data, indicating access to this file. [Relationships]: <process:Arid Gopher,access,file:setup.env>. \n13. [CoT]: The setup.env configuration file references the file COMPRESSOR=7za.exe, which is another embedded component of Arid Gopher. [Relationships]: <process:Arid Gopher,access,file:7za.exe>. \n14. [CoT]: The setup.env configuration file mentions the directory DDIR=ResourcesFiles. [Relationships]: <process:Arid Gopher,access,file:DDIR=ResourcesFiles>. \n15. [CoT]: The setup.env configuration file references the file STAPP=AttestationWmiProvider.exe. [Relationships]: <process:Arid Gopher,access,file:AttestationWmiProvider.exe>. \n16. [CoT]: The setup.env configuration file mentions the file SHORT_APP=ServiceHubIdentityHost.exe. [Relationships]: <process:Arid Gopher,access,file:ServiceHubIdentityHost.exe>. \n17. [CoT]: The text describes AttestationWmiProvider.exe checking for the command-line argument \"key\" with a string parameter [RUN_VALUE_NAME]. [Relationships]: <process:AttestationWmiProvider.exe,",
        "semantic_relationship": "[CoT]: The original relationship describes Arid Gopher launching the file 'networkswitcherdatamodell.exe'. In system-level terms, this corresponds to a Process-to-File 'Execute' relationship, as the process is executing the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkswitcherdatamodell.exe>. \n[CoT]: The original relationship 'launch' indicates that the process 'Arid Gopher' executed the file 'localsecuritypolicy.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. \n[CoT]: The original relationship states that Arid Gopher \"launches\" the file 'networkuefidiagsbootserver.exe'. In system-level terms, this corresponds to a Process-to-File relationship where the action is \"Execute\", as the process is executing the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkuefidiagsbootserver.exe>. \n[CoT]: The original relationship \"download\" implies that Arid Gopher wrote the obfuscated files to disk, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:Arid Gopher,Write,file:files obfuscated with PyArmor>. \n[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL with IP address). In the system-level framework, this corresponds to the 'Connect' relationship between a process and a socket. The URL is treated as a string representation of the socket endpoint for consistency with other network connections. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134)>. \n[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL). In system-level terms, this corresponds to a Process-to-Socket \"Connect\" relationship, as the process is establishing a connection to the remote socket. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/AJLUK9BI48/0L6W3CSBMC>. \n[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL with IP address). In the system-level framework, this corresponds to a Process-to-Socket \"Connect\" relationship, as the process is establishing a connection to the network socket (URL/IP). [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32)>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"DIR=WindowsPerceptionService\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is reading the configuration file that references this directory path. [System-level Relationships]: <process:Arid Gopher,Read,file:DIR=WindowsPerceptionService>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the socket (URL). In system-level terms, accessing a socket typically implies establishing a connection to it, hence the relationship is converted to \"Connect\". This aligns with the Process-to-Socket relationship framework where \"Connect\" is used for establishing connections to sockets. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"LOGS=logs.txt\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is referencing the file in its configuration. [System-level Relationships]: <process:Arid Gopher,Read,file:LOGS=logs.txt>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"code.txt\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is reading the file's contents. Therefore, the system-level relationship is <process:Arid Gopher,Read,file:DID=code.txt>. [System-level Relationships]: <process:Arid Gopher,Read,file:DID=code.txt>. \n[CoT]: The original relationship \"access\" is too generic. Since Arid Gopher uses the setup.env file to retrieve configuration data, this implies reading the file's contents, which aligns with the system-level relationship \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:setup.env>. \n[CoT]: The original relationship states that Arid Gopher \"accesses\" the file 7za.exe. In system-level terms, this could mean reading the file (for execution purposes), hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:7za.exe>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"DDIR=ResourcesFiles\". In system-level terms, accessing a file typically implies reading its contents, hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:DDIR=ResourcesFiles>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"AttestationWmiProvider.exe\". In system-level terms, this could indicate a read operation since the process is referencing the file's contents in the configuration file. Therefore, the relationship is converted to \"Read\" between the process and the file. [System-level Relationships]: <process:Arid Gopher,Read,file:AttestationWmiProvider.exe>. \n[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"ServiceHubIdentityHost.exe\". In system-level terms, accessing a file typically implies reading it, hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:ServiceHubIdentityHost.exe>. \n[CoT]: The original relationship indicates that the process AttestationWmiProvider.exe is checking for a command-line argument \"key\" with a string parameter [RUN_VALUE_NAME]. In system-level terms, this corresponds to the process reading the value of a command-line argument, which is represented as a \"Readarg\" relationship between the process and the argument. [System-level Relationships]: <process:AttestationWmiProvider.exe,Readarg,[RUN_VALUE_NAME]> [Description]: The text describes a process (AttestationWmiProvider.exe) reading the value of a command-line argument ([RUN_VALUE_NAME]). [Original Relationships]: <process:AttestationWmiProvider.exe,Readarg,[RUN_VALUE_NAME]> [System-level Relationships]: <process:AttestationWmiProvider.exe,Readarg,[RUN_VALUE_NAME]>"
    },
    {
        "phase": "exfiltration",
        "content": "The attackers also used a custom tool to exfiltrate data stolen from targeted organizations: a 64-bit PyInstaller executable named WindowsUpServ.exe. When run, the tool checks for the following command-line arguments:\n\"-d\" \"[FILE_DIRECTORY]\"\n\"-f\" \"[FILENAME]\"\nFor each \"-f\" \"[FILENAME]\" command-line argument, the tool uploads the content of [FILENAME]. For each \"-d\" \"[FILE_DIRECTORY]\" command-line argument, the tool obtains a list of files stored in the folder [FILE_DIRECTORY] and uploads the content of each file.\nWhen uploading each file, the tools sends an HTTP POST request to a C&C server with the following parameters:\n\"kjdfnqweb\": [THE_FILE_CONTENT]\n\"qyiwekq\": [HOSTNAME_OF_THE_AFFECTED_COMPUTER]\nWhenever the remote server responds with the status code 200, the malware deletes the uploaded file from the local disk. The malware may also log some of its actions in the following files:\n\"C:\\ProgramData\\WindowsUpServ\\success.txt\"\n\"C:\\ProgramData\\WindowsUpServ\\err.txt\"",
        "relationship": "1. [CoT]: The text states that the custom tool uploads the content of [FILENAME] for each \"-f\" \"[FILENAME]\" command-line argument, indicating a process-to-file relationship where the process uploads the file content. [Relationships]: <process:WindowsUpServ.exe,uploads,file:[FILENAME]>. \n2. [CoT]: The text describes that the tool obtains a list of files stored in the folder [FILE_DIRECTORY] for each \"-d\" \"[FILE_DIRECTORY]\" command-line argument, showing a process-to-file relationship where the process obtains files from a directory. [Relationships]: <process:WindowsUpServ.exe,obtains,file:[FILE_DIRECTORY]>. \n3. [CoT]: The tool sends an HTTP POST request to a C&C server with the specified parameters, indicating a process-to-socket relationship where the process sends data to the server. [Relationships]: <process:WindowsUpServ.exe,sends,socket:HTTP POST request to C&C server>. \n4. [CoT]: The malware deletes the uploaded file from the local disk, showing a process-to-file relationship where the process deletes the file. [Relationships]: <process:WindowsUpServ.exe,deletes,file:uploaded file>. \n5. [CoT]: The malware logs some of its actions in the specified text files, indicating a process-to-file relationship where the process logs data to files. [Relationships]: <process:WindowsUpServ.exe,logs,file:C:\\ProgramData\\WindowsUpServ\\success.txt and C:\\ProgramData\\WindowsUpServ\\err.txt>. ",
        "semantic_relationship": "[CoT]: The original relationship \"uploads\" indicates that the process WindowsUpServ.exe is reading the content of the file [FILENAME] and sending it to another location, which aligns with the system-level relationship \"Read\" as it involves accessing the file's content. [System-level Relationships]: <process:WindowsUpServ.exe,Read,file:[FILENAME]>. \n[CoT]: The original relationship states that the process \"obtains\" files from a directory, which implies that the process is reading the contents of the directory. In system-level terms, this corresponds to a \"Read\" operation between the process and the files in the directory. [System-level Relationships]: <process:WindowsUpServ.exe,Read,file:[FILE_DIRECTORY]>. \n[CoT]: The original relationship \"sends\" indicates that the process WindowsUpServ.exe is transmitting data to a socket (HTTP POST request to C&C server). In system-level terms, this corresponds to the \"Send\" relationship between a process and a socket. [System-level Relationships]: <process:WindowsUpServ.exe,Send,socket:HTTP POST request to C&C server>. \n[CoT]: The original relationship indicates that the process WindowsUpServ.exe deletes a file named \"uploaded file\". In system-level terms, this action corresponds to the \"Delete\" relationship between a process and a file. [System-level Relationships]: <process:WindowsUpServ.exe,Delete,file:uploaded file>. \n[CoT]: The original relationship \"logs\" implies that the process is writing data to the specified files, which aligns with the system-level relationship \"Write\" in the Process-to-File category. [System-level Relationships]: <process:WindowsUpServ.exe,Write,file:C:\\ProgramData\\WindowsUpServ\\success.txt and C:\\ProgramData\\WindowsUpServ\\err.txt>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "initial access",
                "relationship": "[Description]: The text states that three distinct sets of obfuscated PowerShell commands were executed, which implies that the PowerShell process executed the commands. [Original Relationships]: <process:PowerShell,executed,file:obfuscated PowerShell commands>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the PowerShell process executed the obfuscated PowerShell commands, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process:PowerShell,Execute,file:obfuscated PowerShell commands>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text mentions that the PowerShell commands loaded a Base64-encoded string, indicating that the PowerShell process loaded the string file. [Original Relationships]: <process:PowerShell,loaded,file:Base64-encoded string>. ",
                "semantic_relationship": "[CoT]: The original relationship \"loaded\" indicates that the PowerShell process loaded a file (the Base64-encoded string). In system-level terms, this corresponds to the \"Loadlibrary\" relationship between a process and a file. [System-level Relationships]: <process:PowerShell,Loadlibrary,file:Base64-encoded string>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The shellcode downloaded another stage from a C&C server, which is the IP address 104.194.222[.]50 port 4444. This is treated as a socket entity. [Original Relationships]: <process:shellcode,downloaded,socket:104.194.222[.]50 port 4444>. ",
                "semantic_relationship": "[CoT]: The original relationship \"downloaded\" implies that the shellcode received data from the specified socket, which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:shellcode,Receive,socket:104.194.222[.]50 port 4444>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text describes that Micropsia executed and initiated contact with a C&C server, which is again treated as a socket entity. [Original Relationships]: <process: Micropsia,initiated contact,socket:C&C server>. ",
                "semantic_relationship": "[CoT]: The original relationship \"initiated contact\" indicates that Micropsia established a connection to the C&C server, which aligns with the system-level relationship \"Connect\" between a process and a socket. [System-level Relationships]: <process: Micropsia,Connect,socket:C&C server>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Micropsia was used to set up a reverse socks tunnel to an external IP address, which is another socket entity. [Original Relationships]: <process: Micropsia,set up,socket:external IP address>. ",
                "semantic_relationship": "[CoT]: The original relationship \"set up\" implies that the Micropsia process established a connection to the external IP address socket. In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process: Micropsia,Connect,socket:external IP address>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Micropsia was used to run an unknown executable named windowspackages.exe. [Original Relationships]: <process: Micropsia,ran,file:windowspackages.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the process Micropsia executed the file windowspackages.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:windowspackages.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: RAR was executed to archive files, implying that the RAR process archived files. [Original Relationships]: <process:RAR,archived,file:files>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the RAR process \"archived\" files, which implies that it compressed them into a RAR file. In system-level terms, this action corresponds to writing the compressed data to a new file, hence the \"Write\" relationship between the process and the file. The input files are the sources being compressed, while the output is the archived RAR file. [System-level Relationships]: <process:RAR,Write,file:archived_file>. <process:RAR,Read,file:input_files>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Micropsia was used to execute the Arid Gopher backdoor. [Original Relationships]: <process: Micropsia,executed,process:Arid Gopher backdoor>. ",
                "semantic_relationship": "[CoT]: The original relationship \"executed\" indicates that the Micropsia process launched or ran the Arid Gopher backdoor process. In system-level terms, this corresponds to the \"Fork\" relationship between processes. [System-level Relationships]: <process: Micropsia,Fork,process:Arid Gopher backdoor>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher was used to run a tool called SetRegRunKey.exe. [Original Relationships]: <process:Arid Gopher,ran,file:SetRegRunKey.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the process Arid Gopher executed the file SetRegRunKey.exe, which corresponds to the system-level relationship \"Execute\". [System-level Relationships]: <process:Arid Gopher,Execute,file:SetRegRunKey.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher was used to run an unknown file named localsecuritypolicy.exe. [Original Relationships]: <process:Arid Gopher,ran,file:localsecuritypolicy.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the process Arid Gopher executed the file localsecuritypolicy.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Micropsia was used to run windowspackages.exe. [Original Relationships]: <process: Micropsia,ran,file:windowspackages.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship \"ran\" indicates that the process Micropsia executed the file windowspackages.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:windowspackages.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe. [Original Relationships]: <process:Arid Gopher,executed,file:networkswitcherdatamodell.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process \"Arid Gopher\" executed the file \"networkswitcherdatamodell.exe\". In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkswitcherdatamodell.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher executed two unknown files named networkswitcherdatamodell.exe and networkuefidiagsbootserver.exe. [Original Relationships]: <process:Arid Gopher,executed,file:networkuefidiagsbootserver.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process \"Arid Gopher\" executed the file \"networkuefidiagsbootserver.exe\". In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkuefidiagsbootserver.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Micropsia was used to execute two unknown files, both named hostupbroker.exe. [Original Relationships]: <process: Micropsia,executed,file:hostupbroker.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Micropsia executed the file hostupbroker.exe, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process: Micropsia,Execute,file:hostupbroker.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: windowsupserv.exe exfiltrated a RAR file. [Original Relationships]: <process:windowsupserv.exe,exfiltrated,file:01-04-2023-15-13-39_getf.rar>. ",
                "semantic_relationship": "[CoT]: The original relationship \"exfiltrated\" indicates that the process windowsupserv.exe wrote the file 01-04-2023-15-13-39_getf.rar to a remote location, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:windowsupserv.exe,Write,file:01-04-2023-15-13-39_getf.rar>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher was used to execute two unknown files on a single computer. [Original Relationships]: <process:Arid Gopher,executed,file:teamviewrremoteservice.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Arid Gopher executed the file teamviewrremoteservice.exe. In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:teamviewrremoteservice.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher was used to execute two unknown files on a single computer. [Original Relationships]: <process:Arid Gopher,executed,file:embededmodeservice.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Arid Gopher executed the file 'embededmodeservice.exe'. In system-level terms, this corresponds to a Process-to-File relationship of type 'Execute', as the process is performing an execution action on the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:embededmodeservice.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Arid Gopher was used to execute the unknown file named localsecuritypolicy.exe every ten hours. [Original Relationships]: <process:Arid Gopher,executed,file:localsecuritypolicy.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Arid Gopher executed the file localsecuritypolicy.exe, which directly maps to the system-level relationship 'Execute' between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Micropsia was deployed using the file path 'csidl_common_appdata\\microsoft\\dotnet35\\microsoftdotnet35.exe', indicating that the Micropsia backdoor process deployed the Microsoftdotnet35.exe file.   [Original Relationships]: <process:Micropsia,deployed,file:Microsoftdotnet35.exe>. ",
                "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process wrote the Microsoftdotnet35.exe file to the specified location, which aligns with the system-level \"Write\" relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Write,file:Microsoftdotnet35.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that Micropsia was deployed using multiple file paths, including 'csidl_common_appdata\\systempropertiesinternationaltime\\systempropertiesinternationaltime.exe'. This indicates that the Micropsia backdoor process deployed this file.   [Original Relationships]: <process:Micropsia,deployed,file:Systempropertiesinternationaltime.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship 'deployed' implies that the Micropsia process created the 'Systempropertiesinternationaltime.exe' file on the specified path. In system-level terms, this corresponds to the 'Create' action between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:Systempropertiesinternationaltime.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Micropsia was deployed using the file path 'csidl_common_appdata\\windowsnetworkmanager\\windowsnetworkmanager.exe', showing that the Micropsia backdoor process deployed this file.   [Original Relationships]: <process:Micropsia,deployed,file:windowsnetworkmanager.exe>. ",
                "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process created the file 'windowsnetworkmanager.exe' on the system, which aligns with the system-level relationship \"Create\" between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:windowsnetworkmanager.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes that Micropsia was deployed using the file path 'csidl_common_appdata\\windowsps\\windowsps.exe', indicating that the Micropsia backdoor process deployed this file.   [Original Relationships]: <process:Micropsia,deployed,file:windowsps.exe>. ",
                "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that the Micropsia process created the file 'windowsps.exe' on the system, which aligns with the system-level relationship \"Create\" between a process and a file. [System-level Relationships]: <process:Micropsia,Create,file:windowsps.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text lists various secondary payloads executed by Micropsia, including the file 'networkvirtualizationstartservice.exe', showing that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:networkvirtualizationstartservice.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the Micropsia process executed the 'networkvirtualizationstartservice.exe' file, which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationstartservice.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions another secondary payload 'networkvirtualizationfiaservice.exe' executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:networkvirtualizationfiaservice.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'Micropsia' executed the file 'networkvirtualizationfiaservice.exe'. In system-level terms, this directly maps to the 'Execute' relationship between a process and a file, as it describes a process running or launching another executable file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationfiaservice.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes a secondary payload 'networkvirtualizationseoservice.exe' executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:networkvirtualizationseoservice.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'networkvirtualizationseoservice.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:networkvirtualizationseoservice.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text lists a secondary payload 'windowsservicemanageav.exe' (aka Revsocks) executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:windowsservicemanageav.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'Micropsia' executed the file 'windowsservicemanageav.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowsservicemanageav.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions a secondary payload 'windowsupserv.exe' (Data Exfiltration Tool) executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:windowsupserv.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'windowsupserv.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowsupserv.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes an unknown file 'hostupbroker.exe' executed by Micropsia, indicating that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:hostupbroker.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process 'Micropsia' executed the file 'hostupbroker.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:hostupbroker.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text lists another unknown file 'windowspackages.exe' executed by Micropsia, showing that the Micropsia backdoor process executed this file.   [Original Relationships]: <process:Micropsia,executed,file:windowspackages.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process 'Micropsia' executed the file 'windowspackages.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Micropsia,Execute,file:windowspackages.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions the use of 'WinRAR' to archive certain file types, where 'WinRAR.exe' is the process name and '%PROGRAMDATA%\\Software Distributions\\WinRAR\\Rar.exe' is the file path mentioned in the text. This indicates that the Micropsia backdoor process used the WinRAR.exe process.   [Original Relationships]: <process:Micropsia,used,process:WinRAR.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Micropsia process \"used\" the WinRAR.exe process. In system-level terms, this could imply that Micropsia executed the WinRAR.exe process to perform its actions, hence the \"Fork\" relationship. [System-level Relationships]: <process:Micropsia,Fork,process:WinRAR.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes the specific file paths and patterns targeted for archiving by WinRAR.exe, which was used by the Micropsia backdoor process.   [Original Relationships]: <process:Micropsia,archived,file:%PROGRAMDATA%\\Software Distributions\\Bdl\\LMth__C_2023-02-13 17-14-41>. ",
                "semantic_relationship": "[CoT]: The original relationship describes Micropsia archiving a file, which in system-level terms translates to the 'Write' operation since archiving involves writing data to a new location. The file path is also normalized to remove unnecessary characters like spaces and special symbols. [System-level Relationships]: <process:Micropsia,Write,file:%PROGRAMDATA%\\SoftwareDistributions\\Bdl\\LMth__C_2023-02-13 17-14-41>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Arid Gopher was used to launch the file 'networkswitcherdatamodell.exe'.   [Original Relationships]: <process:Arid Gopher,launch,file:networkswitcherdatamodell.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship describes Arid Gopher launching the file 'networkswitcherdatamodell.exe'. In system-level terms, this corresponds to a Process-to-File 'Execute' relationship, as the process is executing the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkswitcherdatamodell.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that Arid Gopher was used to launch the file 'localsecuritypolicy.exe'.   [Original Relationships]: <process:Arid Gopher,launch,file:localsecuritypolicy.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship 'launch' indicates that the process 'Arid Gopher' executed the file 'localsecuritypolicy.exe'. In system-level terms, this corresponds to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Arid Gopher,Execute,file:localsecuritypolicy.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Arid Gopher was used to launch the file 'networkuefidiagsbootserver.exe'.   [Original Relationships]: <process:Arid Gopher,launch,file:networkuefidiagsbootserver.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Arid Gopher \"launches\" the file 'networkuefidiagsbootserver.exe'. In system-level terms, this corresponds to a Process-to-File relationship where the action is \"Execute\", as the process is executing the file. [System-level Relationships]: <process:Arid Gopher,Execute,file:networkuefidiagsbootserver.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text indicates that Arid Gopher was used to download files obfuscated with PyArmor.   [Original Relationships]: <process:Arid Gopher,download,file:files obfuscated with PyArmor>. ",
                "semantic_relationship": "[CoT]: The original relationship \"download\" implies that Arid Gopher wrote the obfuscated files to disk, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:Arid Gopher,Write,file:files obfuscated with PyArmor>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes Arid Gopher connecting to the URL http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134) to register a device.   [Original Relationships]: <process:Arid Gopher,connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134)>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL with IP address). In the system-level framework, this corresponds to the 'Connect' relationship between a process and a socket. The URL is treated as a string representation of the socket endpoint for consistency with other network connections. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 79.133.51[.]134)>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Arid Gopher connects to another URL likely to receive commands after registering the device.   [Original Relationships]: <process:Arid Gopher,connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/AJLUK9BI48/0L6W3CSBMC>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL). In system-level terms, this corresponds to a Process-to-Socket \"Connect\" relationship, as the process is establishing a connection to the remote socket. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER/AJLUK9BI48/0L6W3CSBMC>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions Arid Gopher connecting to the URL http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32) to register a device.   [Original Relationships]: <process:Arid Gopher,connect,socket:http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32)>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (Arid Gopher) connecting to a socket (URL with IP address). In the system-level framework, this corresponds to a Process-to-Socket \"Connect\" relationship, as the process is establishing a connection to the network socket (URL/IP). [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://salimafia[.]net/IURTIER3BNV4ER/DWL1RucGSj/4wwA7S8jQv (IP: 146.19.233[.]32)>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file references the file DIR=WindowsPerceptionService, which is a directory path. [Original Relationships]: <process:Arid Gopher,access,file:DIR=WindowsPerceptionService>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"DIR=WindowsPerceptionService\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is reading the configuration file that references this directory path. [System-level Relationships]: <process:Arid Gopher,Read,file:DIR=WindowsPerceptionService>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file mentions the ENDPOINT http://jumpstartmail[.]com/IURTIER3BNV4ER, which is a URL. [Original Relationships]: <process:Arid Gopher,access,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the socket (URL). In system-level terms, accessing a socket typically implies establishing a connection to it, hence the relationship is converted to \"Connect\". This aligns with the Process-to-Socket relationship framework where \"Connect\" is used for establishing connections to sockets. [System-level Relationships]: <process:Arid Gopher,Connect,socket:http://jumpstartmail[.]com/IURTIER3BNV4ER>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file references the file LOGS=logs.txt. [Original Relationships]: <process:Arid Gopher,access,file:LOGS=logs.txt>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"LOGS=logs.txt\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is referencing the file in its configuration. [System-level Relationships]: <process:Arid Gopher,Read,file:LOGS=logs.txt>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file mentions the file DID=code.txt. [Original Relationships]: <process:Arid Gopher,access,file:DID=code.txt>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"code.txt\". In system-level terms, accessing a file typically translates to a \"Read\" operation, as the process is reading the file's contents. Therefore, the system-level relationship is <process:Arid Gopher,Read,file:DID=code.txt>. [System-level Relationships]: <process:Arid Gopher,Read,file:DID=code.txt>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file is used by Arid Gopher to retrieve configuration data, indicating access to this file. [Original Relationships]: <process:Arid Gopher,access,file:setup.env>. ",
                "semantic_relationship": "[CoT]: The original relationship \"access\" is too generic. Since Arid Gopher uses the setup.env file to retrieve configuration data, this implies reading the file's contents, which aligns with the system-level relationship \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:setup.env>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file references the file COMPRESSOR=7za.exe, which is another embedded component of Arid Gopher. [Original Relationships]: <process:Arid Gopher,access,file:7za.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that Arid Gopher \"accesses\" the file 7za.exe. In system-level terms, this could mean reading the file (for execution purposes), hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:7za.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file mentions the directory DDIR=ResourcesFiles. [Original Relationships]: <process:Arid Gopher,access,file:DDIR=ResourcesFiles>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"DDIR=ResourcesFiles\". In system-level terms, accessing a file typically implies reading its contents, hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:DDIR=ResourcesFiles>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file references the file STAPP=AttestationWmiProvider.exe. [Original Relationships]: <process:Arid Gopher,access,file:AttestationWmiProvider.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"AttestationWmiProvider.exe\". In system-level terms, this could indicate a read operation since the process is referencing the file's contents in the configuration file. Therefore, the relationship is converted to \"Read\" between the process and the file. [System-level Relationships]: <process:Arid Gopher,Read,file:AttestationWmiProvider.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The setup.env configuration file mentions the file SHORT_APP=ServiceHubIdentityHost.exe. [Original Relationships]: <process:Arid Gopher,access,file:ServiceHubIdentityHost.exe>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"Arid Gopher\" accesses the file \"ServiceHubIdentityHost.exe\". In system-level terms, accessing a file typically implies reading it, hence the relationship is converted to \"Read\". [System-level Relationships]: <process:Arid Gopher,Read,file:ServiceHubIdentityHost.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes AttestationWmiProvider.exe checking for the command-line argument \"key\" with a string parameter [RUN_VALUE_NAME]. [Original Relationships]: <process:AttestationWmiProvider.exe,",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process AttestationWmiProvider.exe is checking for a command-line argument \"key\" with a string parameter [RUN_VALUE_NAME]. In system-level terms, this corresponds to the process reading the value of a command-line argument, which is represented as a \"Readarg\" relationship between the process and the argument. [System-level Relationships]: <process:AttestationWmiProvider.exe,Readarg,[RUN_VALUE_NAME]> [Description]: The text describes a process (AttestationWmiProvider.exe) reading the value of a command-line argument ([RUN_VALUE_NAME]). [Original Relationships]: <process:AttestationWmiProvider.exe,Readarg,[RUN_VALUE_NAME]> [System-level Relationships]: <process:AttestationWmiProvider.exe,Readkey,reg:[RUN_VALUE_NAME]>"
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text states that the custom tool uploads the content of [FILENAME] for each \"-f\" \"[FILENAME]\" command-line argument, indicating a process-to-file relationship where the process uploads the file content. [Original Relationships]: <process:WindowsUpServ.exe,uploads,file:[FILENAME]>. ",
                "semantic_relationship": "[CoT]: The original relationship \"uploads\" indicates that the process WindowsUpServ.exe is reading the content of the file [FILENAME] and sending it to another location, which aligns with the system-level relationship \"Read\" as it involves accessing the file's content. [System-level Relationships]: <process:WindowsUpServ.exe,Read,file:[FILENAME]>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The text describes that the tool obtains a list of files stored in the folder [FILE_DIRECTORY] for each \"-d\" \"[FILE_DIRECTORY]\" command-line argument, showing a process-to-file relationship where the process obtains files from a directory. [Original Relationships]: <process:WindowsUpServ.exe,obtains,file:[FILE_DIRECTORY]>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"obtains\" files from a directory, which implies that the process is reading the contents of the directory. In system-level terms, this corresponds to a \"Read\" operation between the process and the files in the directory. [System-level Relationships]: <process:WindowsUpServ.exe,Read,file:[FILE_DIRECTORY]>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The tool sends an HTTP POST request to a C&C server with the specified parameters, indicating a process-to-socket relationship where the process sends data to the server. [Original Relationships]: <process:WindowsUpServ.exe,sends,socket:HTTP POST request to C&C server>. ",
                "semantic_relationship": "[CoT]: The original relationship \"sends\" indicates that the process WindowsUpServ.exe is transmitting data to a socket (HTTP POST request to C&C server). In system-level terms, this corresponds to the \"Send\" relationship between a process and a socket. [System-level Relationships]: <process:WindowsUpServ.exe,Send,socket:HTTP POST request to C&C server>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The malware deletes the uploaded file from the local disk, showing a process-to-file relationship where the process deletes the file. [Original Relationships]: <process:WindowsUpServ.exe,deletes,file:uploaded file>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that the process WindowsUpServ.exe deletes a file named \"uploaded file\". In system-level terms, this action corresponds to the \"Delete\" relationship between a process and a file. [System-level Relationships]: <process:WindowsUpServ.exe,Delete,file:uploaded file>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Description]: The malware logs some of its actions in the specified text files, indicating a process-to-file relationship where the process logs data to files. [Original Relationships]: <process:WindowsUpServ.exe,logs,file:C:\\ProgramData\\WindowsUpServ\\success.txt and C:\\ProgramData\\WindowsUpServ\\err.txt>. ",
                "semantic_relationship": "[CoT]: The original relationship \"logs\" implies that the process is writing data to the specified files, which aligns with the system-level relationship \"Write\" in the Process-to-File category. [System-level Relationships]: <process:WindowsUpServ.exe,Write,file:C:\\ProgramData\\WindowsUpServ\\success.txt and C:\\ProgramData\\WindowsUpServ\\err.txt>. "
            }
        ]
    }
]