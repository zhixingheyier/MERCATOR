[
    {
        "phase": "initial access",
        "content": "The campaign involves a two-step attack. During the first phase, an email without a malicious payload containing content copied from a legitimate Pakistani newspaper's article is sent to the target. The sender address, which is spoofed, impersonates the PR wing of the Pakistani Armed Forces (info@ispr.gov.pk).\nTwo days later, a second email - purportedly a warning from a Pakistani military about the Pegasus spyware - containing a cutt.ly link to a malicious encrypted Word document and the password for decryption will be sent to the target. The sender address impersonates a service similar to that on the first email (alert@ispr.gov.pk).\nIf the target clicks on either the link or on the \"unsubscribe\" link, it will download a Word document from the domain parinari[.]xyz.\nThe emails are sent either from an ExpressVPN exit node in Pakistan, or from a mail server under the attacker's control.",
        "relationship": "[Relationships]: n/a",
        "semantic_relationship": "None"
    },
    {
        "phase": "initial access",
        "content": "After entering the password mentioned in the message, a document containing macros is displayed on screen.\nIf the victim enables macros, the malicious code will be loaded. If the victim enters any phone number and clicks \"SUBMIT,\" the text field will be replaced by the message \"Phone Number Not Found.\"\nBehind the scenes, a .NET DLL file named skfk.txt, which is filled with content found inside the \"Comments\" property of the document, is created in the temporary directory. The file is then loaded in memory via PowerShell.\nStage 1 is a simple download & execute program. It downloads an ASCII file from the same domain and converts it into binary before loading it on to the memory and jump to a dynamic function.\nStage 2 is also .NET DLL file that downloads a third file from parinari[.]xyz, converts it from ASCII to binary, and then creates a scheduled task to load it.\nStage 3 is similar to stage 1, with the only change being the URL to retrieve the next stage.\nStage 4 is the final payload (analyzed in the next section). it is never written in clear text to the file disk.\nIt should be noted that most of the compilation timestamps of these DLL files have been modified by the attacker to a year in the far future (2060, 2099 ...), and the server IP addresses are often hidden behind CloudFlare.",
        "relationship": "1. [Relationships]: <process:document,displays,file:macros>. \n2. [Relationships]: <process:victim,enables,file:macros>. \n3. [Relationships]: <process:PowerShell,loads,file:skfk.txt>. \n4. [Relationships]: <process:program,downloads,file:ASCII file>. \n5. [Relationships]: <process:program,loads,file:ASCII file>. \n6. [Relationships]: <process:.NET DLL,downloads,file:third file>. \n7. [Relationships]: <process:.NET DLL,creates,file:scheduled task>. \n8. [Relationships]: <process:program,retrieves,file:next stage>. ",
        "semantic_relationship": "[System-level Relationships]: <process:document,Execute,file:macros>. \n[System-level Relationships]: <process:victim,Execute,file:macros>. \n[System-level Relationships]: <process:PowerShell,Read,file:skfk.txt>. \n[System-level Relationships]: <process:program,Write,file:ASCII file>. \n[System-level Relationships]: <process:program,Loadlibrary,file:ASCII file>. \n[System-level Relationships]: <process:.NET DLL,Write,file:third file>. \n[System-level Relationships]: <process:.NET DLL,Create,file:scheduled task>. \n[System-level Relationships]: <process:program,Read,file:next stage>. "
    },
    {
        "phase": "collection",
        "content": "The final payload is a .NET DLL file designed to steal documents and images with the following extensions:\nThe \"Documents,\" \"Downloads,\" \"Desktop,\" and \"Pictures\" folders of every user are checked. The DLL file also examines drives other than C:.\nWhen a file matching one of the listed extensions is found, its MD5 hash is calculated and compared to an exclusion list retrieved from the command-and-control (C&C) server pirnaram[.]xyz.\nIf the hash is not listed, the file is sent via the C&C to a directory named after the concatenation of the machine name and the username. The exclusion list is different for every machine name-username string.",
        "relationship": "1. [Relationships]: <process:.NET DLL file,check,file:Documents,Downloads,Desktop,Pictures folders>. \n2. [Relationships]: <process:.NET DLL file,examine,file:drives other than C:.>. \n3. [Relationships]: <process:.NET DLL file,calculate,file:MD5 hash>. \n4. [Relationships]: <process:.NET DLL file,compare,file:exclusion list>. \n5. [Relationships]: <process:.NET DLL file,send,file:file to directory named after machine name-username string>. ",
        "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Read,file:Documents,Downloads,Desktop,Pictures folders>. \n[System-level Relationships]: <process:.NET DLL file,Read,file:drives other than C:.>. \n[System-level Relationships]: <process:.NET DLL file,Compute,file:MD5 hash>. \n[System-level Relationships]: <process:.NET DLL file,Compare,file:exclusion list>. \n[System-level Relationships]: <process:.NET DLL file,Write,file:file to directory named after machine name-username string>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:document,displays,file:macros>. ",
                "semantic_relationship": "[System-level Relationships]: <process:document,Execute,file:macros>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:victim,enables,file:macros>. ",
                "semantic_relationship": "[System-level Relationships]: <process:victim,Execute,file:macros>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:PowerShell,loads,file:skfk.txt>. ",
                "semantic_relationship": "[System-level Relationships]: <process:PowerShell,Read,file:skfk.txt>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:program,downloads,file:ASCII file>. ",
                "semantic_relationship": "[System-level Relationships]: <process:program,Write,file:ASCII file>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:program,loads,file:ASCII file>. ",
                "semantic_relationship": "[System-level Relationships]: <process:program,Loadlibrary,file:ASCII file>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:.NET DLL,downloads,file:third file>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL,Write,file:third file>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:.NET DLL,creates,file:scheduled task>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL,Create,file:scheduled task>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:program,retrieves,file:next stage>. ",
                "semantic_relationship": "[System-level Relationships]: <process:program,Read,file:next stage>. "
            },
            {
                "phase": "collection",
                "relationship": "[Original Relationships]: <process:.NET DLL file,check,file:Documents,Downloads,Desktop,Pictures folders>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Read,file:Documents,Downloads,Desktop,Pictures folders>. "
            },
            {
                "phase": "collection",
                "relationship": "[Original Relationships]: <process:.NET DLL file,examine,file:drives other than C:.>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Read,file:drives other than C:.>. "
            },
            {
                "phase": "collection",
                "relationship": "[Original Relationships]: <process:.NET DLL file,calculate,file:MD5 hash>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Compute,file:MD5 hash>. "
            },
            {
                "phase": "collection",
                "relationship": "[Original Relationships]: <process:.NET DLL file,compare,file:exclusion list>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Compare,file:exclusion list>. "
            },
            {
                "phase": "collection",
                "relationship": "[Original Relationships]: <process:.NET DLL file,send,file:file to directory named after machine name-username string>. ",
                "semantic_relationship": "[System-level Relationships]: <process:.NET DLL file,Write,file:file to directory named after machine name-username string>. "
            }
        ]
    }
]