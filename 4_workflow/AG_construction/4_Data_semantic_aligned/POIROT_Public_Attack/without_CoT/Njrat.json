[
    {
        "phase": "initial access",
        "content": "The \"njRAT\" is a robust remote access trojan that once it reaches and infects the end-point, allows the attacker to have full control over the Victim system. With this access, the attacker can start scanning other systems in the victim network to perform lateral movement. \nWe will start this section by performing analysis on the following \"njRAT\" sample: \nFilename: Authorization.exe MD5: 1d3baedd747f6f9bf92c81eb9f63b34b \nThe \"Authorization.exe\" njRAT malware was embedded and dropped in the victim system by the following file: \"Authorization form may - 2013 - 115444.scr\" (MD5:   \n63781fe1932e612c6c29225d25515111). \nThe next section (Indicators & Mitigation Strategies), will provide information about other variants of the malware obtained. ",
        "relationship": "1. [Relationships]: <process:Authorization form may - 2013 - 115444.scr,embedded and dropped,file:Authorization.exe>. \n2. [Relationships]: <process:Authorization.exe,njRAT malware>. ",
        "semantic_relationship": "[System-level Relationships]: <process:Authorization form may - 2013 - 115444.scr,Execute,file:Authorization.exe>. \n[System-level Relationships]: <process:Authorization.exe,Inject,process:chrome.exe>. "
    },
    {
        "phase": "execution",
        "content": "The \"Authorization.exe\" malware sample was created with version V.0.5 of this RAT. The njRAT application was developed with VB.NET (Visual Basic .NET). The \"Authorization.exe\" malware has keylogger functionality. It stores the logged keystrokes in the following file: \"[CWD]\\.tmp\". When the malware is dropped by the \"Authorization form may - 2013 - 115444.scr\" carrier file, the logged keystrokes are stored in: \"C:\\Extracted\\.tmp\". \nThe IP address used by the Command & Control (C2) node appears to be under an IP range owned by: \"Palestinian Internet Services, P. O. BOX 5111 Gaza City, Palestine\". \nVariants of this malware have been observed by the community since at least 2012. The malware appears to be known by the community as: njRAT, MSIL/Bladabindi, and Backdoor.LV. \nWhen the \"Authorization.exe\" malware is executed it: \nCreates a copy of itself in the following locations:   \n%APPDATA%\\msnco.exe   \nC:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe \nTries to open the following file: [CWD]\\ Authorization.exe.config \nEntrenches in the system for persistence in the following registry locations: \nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Ru n\\b6554e5bcfef391ff7a7ffda58092e10   \nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\R un\\b6554e5bcfef391ff7a7ffda58092e10 \nMakes the following modifications to the registry to bypass the Windows Firewall: \nKey: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAcc ess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplic ations\\List\\[%APPDATA%]\\msnco.exe   \nValue: [%APPDATA%]\\msnco.exe:\\*:Enabled:msnco.exe \nBeacons to the following C2 node over TCP port 1177: \"217.66.231.245\" \nThe attacker tries to make sure the malware will run in the system by making the second copy into the above mentioned directory (C:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe) \nThis causes the malware to execute again when the system is rebooted and re-starts the infection in the system. Once the system is infected again, it will beacon to the C2 node. \nThe attacker tries to trick the user by using different icons for the malware. Various samples were observed with MS Word and PDF icons. The following is a screenshot of how the file will look like to a normal user: \nWhen the system is configured to show file extensions, the EXE extension is now revealed:",
        "relationship": "1. [Relationships]: <process:Authorization.exe,stores,file:[CWD]\\.tmp>. \n2. [Relationships]: <process:Authorization.exe,stores,file:C:\\Extracted\\.tmp>. \n3. [Relationships]: <process:Authorization.exe,beacons,socket:217.66.231.245:1177>. \n4. [Relationships]: <process:Authorization.exe,creates,file:%APPDATA%\\msnco.exe>. \n5. [Relationships]: <process:Authorization.exe,creates,file:C:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe>. \n6. [Relationships]: <process:Authorization.exe,opens,file:[CWD]\\ Authorization.exe.config>. \n7. [Relationships]: <process:Authorization.exe,modifies,reg:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. \n8. [Relationships]: <process:Authorization.exe,modifies,reg:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. \n9. [Relationships]: <process:Authorization.exe,modifies,reg:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\[%APPDATA%]\\msnco.exe>. ",
        "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Write,file:[CWD]\\.tmp>. \n[System-level Relationships]: <process:Authorization.exe,Write,file:C:\\Extracted\\.tmp>. \n[System-level Relationships]: <process:Authorization.exe,Connect,socket:217.66.231.245:1177>. \n[System-level Relationships]: <process:Authorization.exe,Create,file:%APPDATA%\\msnco.exe>. \n[System-level Relationships]: <process:Authorization.exe,Create,file:C:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe>. \n[System-level Relationships]: <process:Authorization.exe,Read,file:[CWD]\\ Authorization.exe.config>. \n[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. \n[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. \n[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\[%APPDATA%]\\msnco.exe>. "
    },
    {
        "phase": "exfiltration",
        "content": "When the malware connects to the C2 node, it will send information about the victim system, malware version, open windows, etc. The following is the network traffic observed: \nThe following table provides information of some of the fields observed in the network traffic: \nInformation sent by the attacker on opened windows in the system could inform him/her of his malware being analyzed and allowed to connect to the C2 node. For example, if Wireshark, Filemon, Regmon, and IDA are opened in the system when the analyst executes the malware, this will quickly let the attacker know that someone is performing reverse engineering of his malicious code.\nThe following WHOIS information was found related to the C2 node (21+7.16860.02.3615.22.4405).",
        "relationship": "1. [Relationships]: <process:malware,connects,socket:C2 node>. \n2. [Relationships]: <process:malware,sends,socket:socket:C2 node>. \n3. [Relationships]: <process:attacker,observes,process:opened windows>. \n4. [Relationships]: <process:attacker,informs,process:malware>. \n5. [Relationships]: <process:analyst,executes,process:malware>. \n6. [Relationships]: <process:attacker,knows,process:analyst>. \n7. [Relationships]: <process:WHOIS,finds,socket:C2 node>. ",
        "semantic_relationship": "[System-level Relationships]: <process:malware,Connect,socket:C2 node>. \n[System-level Relationships]: <process:malware,Send,socket:socket:C2 node>. \n[System-level Relationships]: <process:attacker,Inject,process:opened windows>. \n[System-level Relationships]: <process:attacker,Inject,process:malware>. \n[System-level Relationships]: <process:analyst,Fork,process:malware>. \n[System-level Relationships]: <process:attacker,Inject,process:analyst>. \n[System-level Relationships]: <process:WHOIS,Connect,socket:C2 node>. "
    },
    {
        "phase": "command and control",
        "content": "The  \"Authorization.exe\" variant in this report appears to have been available at some point through the following URL: \"hxxp://bongdacongdong.vn/authorization.exe\". The domain currently resolves to the following IP address: \"112.213.89.144\", but at some point, the domain was associated with the following IP address: \"31.170.165.90\". \nThe following information was found at Virustotal for \"31.170.165.90\": ",
        "relationship": "1. [Relationships]: <process:Authorization.exe,available through,socket:hxxp://bongdacongdong.vn/authorization.exe>. \n2. [Relationships]: <process:Authorization.exe,resolves to,socket:112.213.89.144>. \n3. [Relationships]: <process:Authorization.exe,associated with,socket:31.170.165.90>. ",
        "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Receive,socket:hxxp://bongdacongdong.vn/authorization.exe>. \n[System-level Relationships]: <process:Authorization.exe,Connect,socket:112.213.89.144>. \n[System-level Relationships]: <process:Authorization.exe,Connect,socket:31.170.165.90>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:Authorization form may - 2013 - 115444.scr,embedded and dropped,file:Authorization.exe>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization form may - 2013 - 115444.scr,Execute,file:Authorization.exe>. "
            },
            {
                "phase": "initial access",
                "relationship": "[Original Relationships]: <process:Authorization.exe,njRAT malware>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Inject,process:chrome.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,stores,file:[CWD]\\.tmp>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Write,file:[CWD]\\.tmp>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,stores,file:C:\\Extracted\\.tmp>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Write,file:C:\\Extracted\\.tmp>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,beacons,socket:217.66.231.245:1177>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Connect,socket:217.66.231.245:1177>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,creates,file:%APPDATA%\\msnco.exe>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Create,file:%APPDATA%\\msnco.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,creates,file:C:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Create,file:C:\\Documents and Settings\\%USERNAME%\\Start Menu\\Programs\\Startup\\b6554e5bcfef391ff7a7ffda58092e10.exe>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,opens,file:[CWD]\\ Authorization.exe.config>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Read,file:[CWD]\\ Authorization.exe.config>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,modifies,reg:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,modifies,reg:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\b6554e5bcfef391ff7a7ffda58092e10>. "
            },
            {
                "phase": "execution",
                "relationship": "[Original Relationships]: <process:Authorization.exe,modifies,reg:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\[%APPDATA%]\\msnco.exe>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Writekey,reg:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List\\[%APPDATA%]\\msnco.exe>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:malware,connects,socket:C2 node>. ",
                "semantic_relationship": "[System-level Relationships]: <process:malware,Connect,socket:C2 node>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:malware,sends,socket:socket:C2 node>. ",
                "semantic_relationship": "[System-level Relationships]: <process:malware,Send,socket:socket:C2 node>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:attacker,observes,process:opened windows>. ",
                "semantic_relationship": "[System-level Relationships]: <process:attacker,Inject,process:opened windows>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:attacker,informs,process:malware>. ",
                "semantic_relationship": "[System-level Relationships]: <process:attacker,Inject,process:malware>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:analyst,executes,process:malware>. ",
                "semantic_relationship": "[System-level Relationships]: <process:analyst,Fork,process:malware>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:attacker,knows,process:analyst>. ",
                "semantic_relationship": "[System-level Relationships]: <process:attacker,Inject,process:analyst>. "
            },
            {
                "phase": "exfiltration",
                "relationship": "[Original Relationships]: <process:WHOIS,finds,socket:C2 node>. ",
                "semantic_relationship": "[System-level Relationships]: <process:WHOIS,Connect,socket:C2 node>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Original Relationships]: <process:Authorization.exe,available through,socket:hxxp://bongdacongdong.vn/authorization.exe>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Receive,socket:hxxp://bongdacongdong.vn/authorization.exe>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Original Relationships]: <process:Authorization.exe,resolves to,socket:112.213.89.144>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Connect,socket:112.213.89.144>. "
            },
            {
                "phase": "command and control",
                "relationship": "[Original Relationships]: <process:Authorization.exe,associated with,socket:31.170.165.90>. ",
                "semantic_relationship": "[System-level Relationships]: <process:Authorization.exe,Connect,socket:31.170.165.90>. "
            }
        ]
    }
]