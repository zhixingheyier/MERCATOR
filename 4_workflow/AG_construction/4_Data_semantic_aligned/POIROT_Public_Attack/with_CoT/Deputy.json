[
    {
        "phase": "execution",
        "content": "FireEye announced the discovery of the cyberespionage Operation DeputyDog leveraging the recently announced zero-day CVE-2013-3893. FireEye and Kaspersky are the companies most active in the analysis of large espionage campaign that governments and hackers are conducting against strategic targets. \nAccording the analysis based on FireEye Dynamic Threat Intelligence cluster the Operation DeputyDog began as early as August 19, 2013 targeting Japanese organizations. Security experts found that attackers have used the same command and control infrastructure of the attack on Bit9 firm. \nBit9 experts discovered that hackers penetrated their network infecting machine with two variants of the HiKit rootkit. \n\"One of these Hitkit samples connected to a command and control server at   \ndownloadmp3server[.]servemp3[.]com that resolved to 66.153.86.14. This same IP address also hosted   \nwww[.]yahooeast[.]net, a known malicious domain, between March 6, 2012 and April 22, 2012. The   \ndomain yahooeast[.]net was registered to 654@123.com. This email address was also used to   \nregister blankchair[.]com \u2013 the domain that we see was pointed to the 180.150.228.102 IP, which is the   \ncallback associated with sample 58dc05118ef8b11dcb5f5c596ab772fd, and has been already correlated   \nback to the attack leveraging the CVE-2013-3893 zero-day vulnerability.\" \nJust a couple of days ago, on September 17, 2013 Microsoft announced a new zero-day vulnerability in Internet Explorer products that was being exploited in targeted attacks. \nFireEye investigated on the attacks revealing that they targeted organizations in Japan, according evidences collected behind the Operation DeputyDog there is the same threat actor that compromised Bit9 in February 2013, when during the hack were stolen digital certificates used later in further attacks to sign malware. The payload used in these attacks on August 23th 2013 against entities in Japan was hosted on a server in Hong Kong with IP address equal to 210.176.3.130. Despite the payload is named img20130823.jpg in reality it is  an executable, once run it writes a dll named \"28542CC0.dll\" in the following path: \nC:Documents and SettingsAll UsersApplication Data28542CC0.dll \nTo be able to execute the malware on every machine restarts the malicious agent also adds this registry key: \nHKLMSOFTWAREMicrosoftWindowsCurrentVersionRun28542CC0 rundll32.exe \"C:Documents and SettingsAll UsersApplication Data28542CC0.dll\", Launch \nThe malware connects to a host in South Korea (180.150.228.102), it is curious that callback traffic is not encrypted HTTP over port 443.  The FireEye security experts identified the signature for the attacks that allowed the detection of at least 5 samples that were compiled on 2013-08-19, within 1 second of each other. \nThe malicious domains identified are: \nCampaigns such as the Operation DeputyDog are the demonstration that groups of persistent collectors are very active and use sophisticated techniques for their attacks. The hackers exploited the knowledge of a zero-day during last attacks, circumstance that lets me think of the responsibility of state-sponsored hackers. Governments are primary entities that exploit zero-day flaws during their attack, cybercrime ecosystem in fact is more oriented in the sale of these exploits instead to use it for illegal activities. If you are interested to go deep in the technical analysis of the ATP read the following post published by FireEye. \n(Source: CDM, Pierluigi Paganini, Editor and Chief ) \nStay Informed. Stay Secure. Read the Latest Cyber Defense eMag ",
        "relationship": "1. [CoT]: The text mentions that the payload was hosted on a server with IP address 210.176.3.130, indicating a socket entity.   [Relationships]: <process:FireEye, hosted on, socket:210.176.3.130>. \n2. [CoT]: The text describes the payload naming as 'img20130823.jpg' but states it is an executable that writes a DLL file '28542CC0.dll' in a specific path.   [Relationships]: <process:payload, writes, file:C:Documents and SettingsAll UsersApplication Data28542CC0.dll>. \n3. [CoT]: The text mentions that the malware adds a registry key for persistence.   [Relationships]: <process:malware, adds, reg:HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun28542CC0 rundll32.exe \"C:Documents and SettingsAll UsersApplication Data28542CC0.dll\", Launch>. \n4. [CoT]: The text states that the malware connects to a host with IP address 180.150.228.102.   [Relationships]: <process:malware, connects to, socket:180.150.228.102>. ",
        "semantic_relationship": "[CoT]: The original relationship \"hosted on\" implies that the FireEye process established a connection to the socket (IP address 210.176.3.130). In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:FireEye,Connect,socket:210.176.3.130>. \n[CoT]: The original relationship states that the payload (which is an executable) writes a DLL file to a specific path. In system-level terms, this action corresponds to a Process-to-File \"Write\" relationship, as the process is modifying the contents of a file. [System-level Relationships]: <process:payload,Write,file:C:Documents and SettingsAll UsersApplication Data28542CC0.dll>. \n[CoT]: The original relationship states that the malware \"adds\" a registry key, which corresponds to the system-level action of creating a new registry key (Createkey). This is part of the Registry category of system-level relationships. The action \"adds\" in the original description directly maps to \"Createkey\" in the system-level framework. [System-level Relationships]: <process:malware,Createkey,reg:HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun28542CC0 rundll32.exe \"C:Documents and SettingsAll UsersApplication Data28542CC0.dll\", Launch>. \n[CoT]: The original relationship states that the malware \"connects to\" a socket (IP address). In system-level terms, this corresponds to the \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:malware,Connect,socket:180.150.228.102>. "
    },
    {
        "phase_relationship": [
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that the payload was hosted on a server with IP address 210.176.3.130, indicating a socket entity.   [Original Relationships]: <process:FireEye, hosted on, socket:210.176.3.130>. ",
                "semantic_relationship": "[CoT]: The original relationship \"hosted on\" implies that the FireEye process established a connection to the socket (IP address 210.176.3.130). In system-level terms, this corresponds to a \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:FireEye,Connect,socket:210.176.3.130>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text describes the payload naming as 'img20130823.jpg' but states it is an executable that writes a DLL file '28542CC0.dll' in a specific path.   [Original Relationships]: <process:payload, writes, file:C:Documents and SettingsAll UsersApplication Data28542CC0.dll>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the payload (which is an executable) writes a DLL file to a specific path. In system-level terms, this action corresponds to a Process-to-File \"Write\" relationship, as the process is modifying the contents of a file. [System-level Relationships]: <process:payload,Write,file:C:Documents and SettingsAll UsersApplication Data28542CC0.dll>. "
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text mentions that the malware adds a registry key for persistence.   [Original Relationships]: <process:malware, adds, reg:HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun28542CC0",
                "semantic_relationship": "[CoT]: The original relationship states that the malware \"adds\" a registry key, which corresponds to the system-level action of creating a new registry key (Createkey). This is part of the Registry category of system-level relationships. The action \"adds\" in the original description directly maps to \"Createkey\" in the system-level framework. [System-level Relationships]: <process:malware,Createkey,reg:HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun28542CC0"
            },
            {
                "phase": "execution",
                "relationship": "[Description]: The text states that the malware connects to a host with IP address 180.150.228.102.   [Original Relationships]: <process:malware, connects to, socket:180.150.228.102>. ",
                "semantic_relationship": "[CoT]: The original relationship states that the malware \"connects to\" a socket (IP address). In system-level terms, this corresponds to the \"Connect\" relationship between a process and a socket. [System-level Relationships]: <process:malware,Connect,socket:180.150.228.102>. "
            }
        ]
    }
]