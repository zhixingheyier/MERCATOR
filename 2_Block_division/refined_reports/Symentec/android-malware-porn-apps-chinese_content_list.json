[
    {
        "title": "Android Malware Toolkit Poses as Porn Apps Targeting Chinese-speaking Users",
        "content": "We recently discovered a malicious toolkit (detected asAndroid.Rootnik.B) masquerading as pornographic apps in the thousands, which are primarily targeted at Chinese-speaking users. This toolkit has a broad range of capabilities, including:\nRooting Android devices\nInjecting malicious code into legitimate apps\nSubscribing to premium services and sending premium messages\nSilently downloading/installing risky apps\nThe apps find their way onto devices via app-centric websites, forums, and torrent sites. These can also spread over popular social messaging networks."
    },
    {
        "title": "Infection vector",
        "content": "This malware hides its primary malicious payload in a fake .tiff image in the resources of the application. The payload downloads other malicious components from a set of helper web servers. The malware sets immutable flags (atechnique laid out in a previous blog) to protect the files from being deleted by a savvy user or an antivirus application.\nThe threat also attempts to replacedebuggerd, a key service that enables it to survive cleaning attempts by antivirus applications, or even more aggressive cleaning measures such as a factory reset."
    },
    {
        "title": "Rooting workflow",
        "content": "The malware decrypts and dynamically loads the hidden payload (detected asAndroid.Reputation.1). It decrypts the following command and control (C&C) URLs and queries them to get root-relevant configurations:\nhttp://gr.[REMOVED].pw:[REMOVED]/kitmain.aspx\nhttp://gr.[REMOVED].top:[REMOVED] /kitmain.aspx\nhttp://43.[REMOVED].68.193:[REMOVED]/kitmain.aspx\nhttp://nr.[REMOVED].com:[REMOVED]/kitmain.aspx\nhttp://nr.[REMOVED].com:[REMOVED]/kitmain.aspx\nThe following is a sample response that tells the malware where to download the rootkits, when to start a root attempt, how many retry attempts to make if the attempt fails, and the metadata for the rootkit itself:"
    },
    {
        "title": "Malware injection mechanisms",
        "content": "After gaining root privileges, the malware selects a good candidate process (such as a system process or an app-store process) into which it can inject malicious code.\nThe injected code launches a UNIX domain server socket, and listens for commands to trigger methods. Any malicious client entity (an app on the device) can now command the infected process to carry out malicious activities on its behalf, including sending premium-rate messages."
    },
    {
        "title": "Other capabilities",
        "content": "The malware also silently downloads and installs a known malicious app namedister59.apk(detected asAndroid.Reputation.3) from the following URL:\nhttp://1jope[REMOVED].com/ister59.apk?attname[REMOVED]1508999147941\nIt can download and dynamically load other payloads from the following URLs without the user's consent:\nhttp://vpay.[REMOVED].eerichina.com/[REMOVED]/19c32fb8ebc57b6e.jar\nhttp://120.[REMOVED].154.102:[REMOVED]/plugin_VA5.1.1.jar\nMoreover, it subscribes to premium services and sends premium text messages. It requests ads and pushes other malicious apps."
    },
    {
        "title": "Affected platform versions",
        "content": "All devices with Android API level 8 (2.2) or greater are affected.\nEven if some devices with higher platform versions cannot be rooted, the malware still sends premium-rate messages. In this case, the malware falls back to premium-rate scamming, as it cannot inject or install malware.\nFurthermore, the malware code is highly modularized, which means it can be easily repackaged into any other popular apps. In addition, the malware is protected by a private packer, asoutlined in a previous post. The malicious code is obfuscated and the key strings are encrypted, thwarting base-level forms of static analysis and detection."
    }
]