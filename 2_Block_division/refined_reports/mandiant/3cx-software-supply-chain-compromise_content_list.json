[
    {
        "title": "Overview ",
        "content": "3CX Desktop App is enterprise software that   \nprovides communications for its users including chat, video calls, and voice calls. In late March,   \n2023, a software supply chain compromise spread malware via a trojanized version of 3CX's legitimate software that was available to download from their website. The affected software was 3CX   \nDesktopApp 18.12.416 and earlier, which contained malicious code that ran a downloader,   \nSUDDENICON, which in turn received additional command and control (C2) servers from encrypted icon files hosted on GitHub. The decrypted C2   \nserver was used to download a third stage identified as ICONICSTEALER, a dataminer that steals browser information. Mandiant tracks this activity as   \nUNC4736, a suspected North Korean nexus cluster of activity. "
    },
    {
        "title": "Software Supply Chain Exploitation Explained ",
        "content": "Mandiant Consulting's investigation of the 3CX supply chain compromise has uncovered the initial intrusion vector: a malware-laced software package distributed via an earlier software supply chain compromise that began with a tampered installer for X_TRADER, a software package provided by Trading Technologies (Figure 1). Mandiant determined that a complex loading process led to the deployment of VEILEDSIGNAL, a multi-stage modular backdoor, and its modules. "
    },
    {
        "title": "VEILEDSIGNAL Backdoor Analysis ",
        "content": "Mandiant Consulting identified an installer with the filename X_TRADER_r7.17.90p608.exe  (MD5: ef4ab22e565684424b4142b1294f1f4d) which led to the deployment of a malicious modular backdoor: VEILEDSIGNAL. \nAlthough the X_TRADER platform was reportedly discontinued in 2020, it was still available for download from the legitimate Trading Technologies website in 2022. This file was signed with the subject \"Trading Technologies International, Inc\" and contained the executable file Setup.exe that was also signed with the same digital certificate. The code signing certificate used to digitally sign the malicious software was set to expire in October 2022. \nThe installer contains and executes Setup.exe which drops two trojanized DLLs and a benign executable. Setup.exe uses the benign executable to side-load one of the malicious DLLs. Side-loading relies on legitimate Windows executables to load and execute a malicious file that has been disguised as a legitimate dependency. The loaded malicious DLLs contains and uses SIGFLIP and DAVESHELL to decrypt and load the payload into memory from the other dropped malicious executable. SIGFLIP relies on RC4 stream-cipher to decrypt the payload of choice and uses the byte sequence FEEDFACE to find the shellcode, in this case DAVESHELL, during the decryption stage. \nSIGFLIP and DAVESHELL extract and execute a modular backdoor, VEILEDSIGNAL, and two corresponding modules. VEILEDSIGNAL relies on the two extracted modules for process injection and communications with the C2 server. \nVEILEDSIGNAL and the accompanying two components provide the following functionality: \nThe VEILEDSIGNAL backdoor supports three commands: send implant data, execute shellcode, and terminate itself. \nThe process injection module injects the C2 module in the first found process instance of Chrome, Firefox, or Edge. It also monitors the named pipe and reinjects the communication module if necessary. \nThe C2 module creates a Windows named pipe and listens for incoming communications, which it then sends to the C2 server encrypted with AES-256 in Galois Counter Mode (GCM). \nThe C2 configuration of the identified sample of   \nVEILEDSIGNAL (MD5:   \nc6441c961dcad0fe127514a918eaabd4) relied on the following hard-coded URL:   \nwww.tradingtechnologies[.]com/trading/ordermanagement . "
    },
    {
        "title": "VEILEDSIGNAL Similarities and Code Comparison ",
        "content": "The compromised X_TRADER and 3CXDesktopApp applications both contain, extract, and run a payload in the same way, although the final payload is different. Mandiant analyzed these samples and observed the following similarities: \nUsage of the same RC4 key 3jB(2bsG#@c7  in the SIGFLIP tool configuration to encrypt and decrypt the payload. \nUsage of SIGFLIP, a publicly available project on GitHub leveraging CVE-2013-3900 (MS13-098).   \nReliance on DAVESHELL, a publicly available open-source project that converts PE-COFF files to position-independent code or shellcode and that leverages reflective loading techniques to load the payload in memory.   \nUse of the hardcoded cookie variable tutma in the payloads.   \nBoth payloads encrypt data with AES-256 GCM cipher. "
    },
    {
        "title": "Compromise of the 3CX Build Environment ",
        "content": "The attacker used a compiled version of the publicly available Fast Reverse Proxy project, to move laterally within the 3CX organization during the attack. The file MsMpEng.exe  (MD5: 19dbffec4e359a198daf4ffca1ab9165), was dropped in C:\\Windows\\System32 by the threat actor. \nMandiant was able to reconstruct the attacker's steps throughout the environment as they harvested credentials and moved laterally. Eventually, the attacker was able to compromise both the Windows and macOS build environments. On the Windows build environment, the attacker deployed a TAXHAUL launcher and COLDCAT downloader that persisted by performing DLL search order hijacking through the IKEEXT service and ran with LocalSystem privileges. The macOS build server was compromised with POOLRAT backdoor using Launch Daemons as a persistence mechanism. \nPrevious reporting mentioned the macOS build server was compromised with SIMPLESEA. Mandiant Intelligence completed analysis of the sample and determined it to be the backdoor POOLRAT instead of a new malware family. "
    },
    {
        "title": "Threat Actor Spotlight: UNC4736 ",
        "content": "UNC4736 demonstrates varying degrees of overlap with multiple North Korean operators tracked by Mandiant Intelligence, especially with those involved in financially-motivated cybercrime operations. These clusters have demonstrated a sustained focus on cryptocurrency and fintech-related services over time. \nMandiant assesses with moderate confidence that UNC4736 is related to financially motivated North Korean \"AppleJeus\" activity as reported by CISA. This is further corroborated with findings from Google TAG who reported the compromise of www.tradingtechnologies[.]com  in February 2022, preceding the distribution of compromised X_TRADER updates from the site. \nTAG reported on a cluster of North Korean activity exploiting a remote code execution \nvulnerability in Chrome, CVE-2022-0609, and identified it as overlapping with \"AppleJeus\" targeting cryptocurrency services.   \nThe site www.tradingtechnologies[.]com was compromised and hosting a hidden IFRAME to exploit visitors, just two months before the site was known to deliver a trojanized X_TRADER software package.   \nWithin the 3CX environment, Mandiant identified the POOLRAT backdoor using journalide[.]org  as its configured C2 server.   \nAn older sample of POOLRAT (MD5: 451c23709ecd5a8461ad060f6346930c) was previously reported by CISA as part of the trojanized CoinGoTrade application used in the AppleJeus operation (Figure 2). The older sample's infrastructure also has ties to another trojanized trading application, JMT Trading, also tracked under AppleJeus. \nWeak infrastructure overlap was also identified between UNC4736 and two clusters of suspected APT43 activity, UNC3782 and UNC4469. \nDNS resolutions reveal infrastructure overlap between UNC4736 and activity linked to APT43 with moderate confidence (Tables 1 â€“ 3) APT43 frequently targets cryptocurrency users and related services, highlighting such campaigns are widespread across North Koreanexus cyber operators. "
    }
]