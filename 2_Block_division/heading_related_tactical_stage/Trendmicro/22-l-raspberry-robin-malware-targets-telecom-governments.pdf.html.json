[
    {
        "title": "Privilege escalation",
        "content": "After dropping a copy of itself, it executes the dropped copy as Administrator using a UAC (User Account Control) bypass technique. It implements a variation of the technique ucmDccwCOMMethod in UACMe, thereby abusing the built-in Windows AutoElevate backdoor.\nIt first checks whetheratcuf32.dll, aswhook.dll, andavp.exeare loaded in the system. These files are from security defenders BitDefender, Avast, and Kaspersky, respectively. If one of these is loaded, it does not proceed to the UAC bypass routine. It then drops a shortcut file to <%User Temp%\\{random file name}.lnk> that contains the command line\nrundll32.exe SHELL32,ShellExec_RunDLL \"C:\\Windows\\system32\\ODBCCONF.EXE\" /a {configsysdsn OCNKBENXGMI etba odjcnr} /A {installtranslator fxodi} -a {installdriver qmprmxf} /a {configsdn HHAP} regsvr \"{dropped copy path and file name}.\" /S /e -s\nIt then creates an elevated COM object for CMLuaUtil and uses it to set a custom display calibrator in the registry that points to the dropped LNK file. It sets the custom display calibrator by setting the registry value\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\ICM\\CalibrationDisplayCalibrator = \"%User Temp%\\{random file name}.lnk\"\nIt then creates an elevated COM object for ColorDataProxy and calls its method “LaunchDccw” to load the calibrator, thus executing the malicious LNK. Afterward, it sets the registry value DisplayCalibrator to “%SystemRoot%\\System32\\DCCW.exe” to hide its activity.\nMain routine\nRunning in Session 0, the real payload attempts to connect to the hard-coded Tor addresses, where the connections are made in another process. For the real payload to facilitate the exchange of information and the Tor-connecting process, a shared-named memory map is created with the following format:\nThe Tor address is written to offset 14h of the shared memory, hard-coded but encrypted within the sample itself. The following are some of the .onion (V2) addresses we identified:\nsejnfjrq6szgca7v \nzdfsyv3rubuhpql3 \nihdhoeoovbtgutfm \ntapeucwutvne7l5o \n2qlvvvnhqyda2ahd \nanswerstedhctbek \n5j7saze5byfqccf3 \ncmgvqnxjoiqthvrc \n3bbaaaccczcbdddz \nsgvtcaew4bxjd7ln \nugw3zjsayleoamaz \nynvs3km32u33agwq \nnjalladnspotetti \npsychonaut3z5aoz \nhabaivdfcyamjhkk \ntorwikignoueupfm \nbitmailendavkbec \ncyphdbyhiddenbhs \nclgs64523yi2bkhz \n76qugh5bey5gum7l \nhd37oiauf5uoz7gg \nexpressobutiolem \ngl3n4wtekbfaubye \narchivecaslytosk \nkyk55bof3hzdiwrm \nqqvyib4j3fz66nuc \nbcwpy5wca456u7tz \npornhubthbh7ap3u \nfncuwbiisyh6ak3i\nIn starting its Tor client process, the real payload randomly selects a name among these first:\ndllhost.exe \nregsvr32.exe \nrundll32.exe\nIt then creates a suspended process, injects the code of the Tor client, resumes the process, and waits for data from the Tor client. As far as what the sample does to the received data, we have not seen any use of it in the wild so far since we did find that the buffer containing the data is freed without using it."
    }
]