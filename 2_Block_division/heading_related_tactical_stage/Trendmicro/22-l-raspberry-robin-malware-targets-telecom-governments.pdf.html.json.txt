
【Privilege escalation】
==============================
  After dropping a copy of itself, it executes the dropped copy as Administrator using a UAC (User Account Control) bypass technique. It implements a variation of the technique ucmDccwCOMMethod in UACMe, thereby abusing the built-in Windows AutoElevate backdoor.
  It first checks whetheratcuf32.dll, aswhook.dll, andavp.exeare loaded in the system. These files are from security defenders BitDefender, Avast, and Kaspersky, respectively. If one of these is loaded, it does not proceed to the UAC bypass routine. It then drops a shortcut file to <%User Temp%\{random file name}.lnk> that contains the command line
  rundll32.exe SHELL32,ShellExec_RunDLL "C:\Windows\system32\ODBCCONF.EXE" /a {configsysdsn OCNKBENXGMI etba odjcnr} /A {installtranslator fxodi} -a {installdriver qmprmxf} /a {configsdn HHAP} regsvr "{dropped copy path and file name}." /S /e -s
  It then creates an elevated COM object for CMLuaUtil and uses it to set a custom display calibrator in the registry that points to the dropped LNK file. It sets the custom display calibrator by setting the registry value
  HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ICM\CalibrationDisplayCalibrator = "%User Temp%\{random file name}.lnk"
  It then creates an elevated COM object for ColorDataProxy and calls its method “LaunchDccw” to load the calibrator, thus executing the malicious LNK. Afterward, it sets the registry value DisplayCalibrator to “%SystemRoot%\System32\DCCW.exe” to hide its activity.
  Main routine
  Running in Session 0, the real payload attempts to connect to the hard-coded Tor addresses, where the connections are made in another process. For the real payload to facilitate the exchange of information and the Tor-connecting process, a shared-named memory map is created with the following format:
  The Tor address is written to offset 14h of the shared memory, hard-coded but encrypted within the sample itself. The following are some of the .onion (V2) addresses we identified:
  sejnfjrq6szgca7v 
  zdfsyv3rubuhpql3 
  ihdhoeoovbtgutfm 
  tapeucwutvne7l5o 
  2qlvvvnhqyda2ahd 
  answerstedhctbek 
  5j7saze5byfqccf3 
  cmgvqnxjoiqthvrc 
  3bbaaaccczcbdddz 
  sgvtcaew4bxjd7ln 
  ugw3zjsayleoamaz 
  ynvs3km32u33agwq 
  njalladnspotetti 
  psychonaut3z5aoz 
  habaivdfcyamjhkk 
  torwikignoueupfm 
  bitmailendavkbec 
  cyphdbyhiddenbhs 
  clgs64523yi2bkhz 
  76qugh5bey5gum7l 
  hd37oiauf5uoz7gg 
  expressobutiolem 
  gl3n4wtekbfaubye 
  archivecaslytosk 
  kyk55bof3hzdiwrm 
  qqvyib4j3fz66nuc 
  bcwpy5wca456u7tz 
  pornhubthbh7ap3u 
  fncuwbiisyh6ak3i
  In starting its Tor client process, the real payload randomly selects a name among these first:
  dllhost.exe 
  regsvr32.exe 
  rundll32.exe
  It then creates a suspended process, injects the code of the Tor client, resumes the process, and waits for data from the Tor client. As far as what the sample does to the received data, we have not seen any use of it in the wild so far since we did find that the buffer containing the data is freed without using it.

