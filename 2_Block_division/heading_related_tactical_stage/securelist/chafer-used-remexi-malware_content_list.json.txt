
【Persistence 】
==============================
  Persistence modules are based on scheduled tasks and system registry. Mechanisms vary for different OS versions. In the case of old Windows versions like XP, main module events.exe runs an edited XPTask.vbs Microsoft sample script to create a weekly scheduled task for itself. For newer operating systems, events.exe creates task.xml as follows: 
  <Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">   
  <RegistrationInfo><Author>Microsoft Corporation</Author></RegistrationInfo><Triggers><TimeTrigger><Repetition><Interval>PTiM</Interval><   
  StopAtDurationEnd>false</StopAtDurationEnd></Repetition><StartBoundary>2010-09-02T16:15:00</StartBoundary><Enabled>true</Enabled></   
  TimeTrigger></Triggers><Actions Context="Author"><Exec><Command>   
  "C:\Users\User\AppData\Local\Microsoft\Events Cache\events .exe"   
  </Command></Exec></Actions></Task> 
  Then it creates a Windows scheduled task using the following command: 
  1 schtasks.exe /create /TN \"Events\\CacheTask_" /XML \"t /F" 
  At the system registry level, modules achieve persistence by adding themselves into the key: 
  HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit when it finds possible add values to the Winlogon subkey, and in 
  HKLM\Software\Microsoft\Windows\CurrentVersion\Run\Microsoft Activity Manager. All such indicators of comprometation are mentioned in correspondent appendix below. 

