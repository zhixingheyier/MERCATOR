
【Command and control】
==============================
  Symantec has found an extensive command-and-control (C&C) infrastructure supporting Regin infections. The attackers have devised a complex system for communication with C&C servers, in which traffic is relayed through a network of Regin-infected computers. Compromised computers can act as a proxy for other infected computers and peer-to-peer (P2P) communications are used. The networking protocols used by the malware are extensible and can be configured between each pair of Regin-infected computers, providing the attackers with a granular level of control over C&C communications.
  All C&C communications use strong encryption and follow a two-stage protocol, where the attackers contact the infected computer on one channel and instruct it to open communications on another. A single Regin module (0009h) is responsible for the core handling of communications protocols, while each individual protocol has its own separate module. A total of six transport protocols have been identified: ICMP, UDP, TCP, HTTP Cookies, SSL, and SMB.
  Regin’s P2P communications capability sees each Regin infection assigned a virtual IP address, forming a virtual private network (VPN) on top of the physical network of the infected computer. This P2P capability allows the attackers to maintain deep access to critical assets within compromised organizations and mask core infrastructure belonging to the group. Traffic between nodes can be configured to match expected protocols based on where the nodes are placed on a network, adding a further degree of stealth to communications.

