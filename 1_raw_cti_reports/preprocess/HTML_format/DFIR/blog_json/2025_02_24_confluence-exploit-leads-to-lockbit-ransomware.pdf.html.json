[
    {
        "level": 0,
        "content": "Confluence Exploit Leads to LockBit Ransomware"
    },
    {
        "level": 2,
        "content": "Key Takeaways"
    },
    {
        "level": 3,
        "content": "The intrusion began with the exploitation of CVE-2023-22527 on an exposed Windows Confluence server, ultimately leading to the deployment of LockBit ransomware across the environment. \nThe threat actor leveraged various tools, including Mimikatz, Metasploit, and AnyDesk. \nThe threat actor leveraged RDP for lateral movement, deploying LockBit ransomware through multiple methods, including copying files over SMB shares for remote execution and automated distribution via PDQ Deploy. \nSensitive data was exfiltrated using Rclone, transferring files toMEGA.iocloud storage. \nThe intrusion had a rapid Time to Ransom (TTR) of around just two hours."
    },
    {
        "level": 2,
        "content": "The DFIR Report Services"
    },
    {
        "level": 3,
        "content": "Explorethis casein-depth with our hands-on DFIR Labs!"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Private Threat Briefs: 20+ private DFIR reports annually. \nThreat Feed: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc. \nAll Intel: Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel. \nPrivate Sigma Ruleset: Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&CK with test examples. \nDFIR Labs: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds."
    },
    {
        "level": 3,
        "content": "Case Summary \nAnalysts \nInitial Access \nExecution \nPersistence \nPrivilege Escalation \nDefense Evasion \nCredential Access \nDiscovery \nLateral Movement \nCollection \nCommand and Control \nExfiltration \nImpact \nTimeline \nDiamond Model \nIndicators \nDetections \nMITRE ATT&CK"
    },
    {
        "level": 2,
        "content": "Case Summary"
    },
    {
        "level": 3,
        "content": "The intrusion started with the exploitation of CVE-2023-22527, a critical remote code execution vulnerability in Confluence, against a Windows server. The first indication of threat actor activity was the execution of system discovery commands, including net user and whoami."
    },
    {
        "level": 3,
        "content": "Shortly after, the threat actor attempted to download AnyDesk via curl, but the attempt initially failed. They then pivoted to using mshta to retrieve a remote HTA file containing a Metasploit stager. After establishing command and control with the Metasploit server, they leveraged it to successfully download and install AnyDesk. Once installed, AnyDesk was configured with a preset password, providing the threat actor with persistent remote access."
    },
    {
        "level": 3,
        "content": "Within ten minutes, the threat actor began process enumeration using tasklist, identifying several processes of interest, which they then terminated. We assess that these processes belonged to a prior threat actor, and by killing them, the attacker ensured exclusive control over the server. Notably, they terminated PowerShell, inadvertently killing their own Metasploit process. This forced them to rerun the exploit to drop a new Metasploit stager and reestablish command and control. After regaining access, they created a new local account and added it to the Administrators group."
    },
    {
        "level": 3,
        "content": "They accessed the beachhead host via rdp, using a newly created local account and then executed Mimikatz. Next, they leveraged SoftPerfect’s NetScan to enumerate remote hosts across the network. Using this information, they targeted a backup server, moving laterally via RDP using the default Administrator account."
    },
    {
        "level": 3,
        "content": "On the backup server, the threat actor executed a PowerShell script, Veeam-Get-Creds-New.ps1, to extract Veeam credentials. They then pivoted to a file share server via RDP. Once on the file server, they deployed Rclone to exfiltrate data toMEGA.io. Following the exfiltration, they cleared all Windows event logs on the file server."
    },
    {
        "level": 3,
        "content": "The threat actors then pivoted to a domain controller via RDP using domain administrator credentials. Once on the domain controller, they enumerated domain administrator group memberships. Meanwhile, they returned to the backup server to review its configuration."
    },
    {
        "level": 3,
        "content": "Shortly after, the threat actor launched LockBit ransomware across the environment. They began by manually executing the ransomware on a backup server and a file share server over their active RDP sessions. To ensure widespread encryption, they then shifted to the beachhead host, where they leveraged PDQ Deploy, a legitimate enterprise deployment tool, to automate ransomware distribution across the rest of the network."
    },
    {
        "level": 3,
        "content": "Using PDQ Deploy, the threat actors distributed the ransomware binary and a batch script to remote hosts over SMB. They then remotely executed the script via PDQ, triggering ransomware deployment across multiple systems. Next, they pivoted to an Exchange server."
    },
    {
        "level": 3,
        "content": "On the Exchange server, the threat actor stopped key services using net stop and taskkill. They then deployed a ransomware binary alongside a new batch script, which, when executed, initiated ransomware encryption. This script was designed to mount remote systems’ C$ shares, effectively enabling a secondary encryption wave—a failsafe mechanism in case PDQ Deploy had missed any targets."
    },
    {
        "level": 3,
        "content": "The Time to Ransomware (TTR) was just over 2 hours (02:06:14), making it an extremely rapid intrusion."
    },
    {
        "level": 3,
        "content": "If you would like to get an email when we publish a new report, please subscribehere."
    },
    {
        "level": 2,
        "content": "Analysts"
    },
    {
        "level": 3,
        "content": "Analysis and reporting completed byAngelo Violetti,@malforsec,teddy_ROxPin"
    },
    {
        "level": 2,
        "content": "Initial Access"
    },
    {
        "level": 3,
        "content": "In early February 2024, we identified a security breach originating from an exposed Windows server. The server was compromised through a Confluence remote code execution (RCE) vulnerability that was disclosed on January 16, 2024."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Confluence RCE Exploitation"
    },
    {
        "level": 3,
        "content": "The threat actor initially gained access by exploiting a server-side template injection vulnerability (CVE-2023-22527, CVSS 10.0) in an exposed Atlassian Confluence server. This vulnerability allows an unauthenticated threat actor to execute arbitrary commands on the target server by injecting OGNL expressions. The exploitation started from the IP address 92[.]51.2.22 as shown by the following Suricata alert."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The first commands executed by the threat actor were net user and whoami. These were used to enumerate the user accounts on the compromised Windows server and to gather information about the currently affected user. Moreover, the exploitation was likely made through a Python script based on the user-agent used."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The vulnerability arises from improper handling of user-supplied input within certain template files in Confluence. Specifically, files like confluence/template/xhtml/pagelist.vm accept parameters that are passed to potentially dangerous functions without sufficient sanitization. For instance, the $stack.findValue function can be manipulated to inject malicious Object-Graph Navigation Language (OGNL) expressions, leading to arbitrary code execution. Threat actors can exploit this vulnerability by sending crafted HTTP POST requests to specific endpoints, such as /template/aui/text-inline.vm, with malicious payloads in the parameters. Additional details about the vulnerability can be found in those reports:Trend MicroandSplunk."
    },
    {
        "level": 2,
        "content": "Execution"
    },
    {
        "level": 3,
        "content": "After running initial discovery commands the threat actor attempted to download an AnyDesk installer from their server using the exploit."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The execution of curl failed to download the AnyDesk installer though. This did not stop the threat actor who later successfully downloaded an AnyDesk installer by other means."
    },
    {
        "level": 3,
        "content": "Approximately ten minutes after gaining initial access, the threat actor leveraged the native Windows mshta.exe utility to download and execute a Metasploit stager."
    },
    {
        "level": 3,
        "content": "As outlined in thelolbasproject, this technique enables the threat actor to drop a payload into the INetCache directory and execute it directly from there, leveraging trusted system utilities to evade detection."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The HTA file executes an encoded PowerShell command."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The contents of the HTA file:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "This encoded command spawns another PowerShell process with an obfuscated command line."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "To deobfuscate the command line, it’s necessary to:"
    },
    {
        "level": 3,
        "content": "Remove the + symbol, which concatenates strings. \nReplace {0}, {1} and {2} respectively with =, 6 and P. \nBase64 decode the resulting string. \nGzip decompress the base64 decoded string."
    },
    {
        "level": 3,
        "content": "The result is the following PS script, which performs the following actions:"
    },
    {
        "level": 3,
        "content": "Gets the pointers to specific Windows API functions:VirtualAlloc(), VirtualProtect(), CreateThread() and WaitForSingleObject(). \nAllocates a new region of memory via VirtualAlloc() with PAGE_EXECUTE_READWRITE (0x40) permissions. \nCopies a base64 decoded Metasploit shellcode into the newly allocated region of memory. \nChanges the protection of the new memory region into PAGE_EXECUTE (0x10). \nCreates a new thread pointing to the start of the new memory region to execute the Metasploit shellcode. \nWaits for the end of the shellcode execution."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The Metasploit shellcode can be emulated throughspeakeasyto identify the command and control server."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Persistence"
    },
    {
        "level": 3,
        "content": "As part of the AnyDesk installation on the beachhead, a service was installed to ensure the instance became available again after a restart. The following PowerShell command was executed to download AnyDesk:"
    },
    {
        "level": 3,
        "content": "The Windows System event 7045 shows service creations. The details show that AnyDeskMSI.exe will be started, and the start type is set to auto, so it will run after a restart of the server."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The threat actor used both valid accounts and created a new account on the beachhead host. The user “backup” was created, given a password, and added to the local “Administrator” group. Sysmon event code 1 shows the commands ran to perform the activity:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Windows Security events 4720 “A user account was created” and 4732 “A member was added to security enabled local group” show the creation of the user and then adding the user to the Administrators group. As the username does not show in the 4732 event. Make sure to compare the unique Security Identifier(SID):"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Privilege Escalation"
    },
    {
        "level": 3,
        "content": "Confluence RCE provided SYSTEM access to the beachhead. This was utilized to create a local administrator user named ‘backup’. With the ‘backup’ user, the threat actor was able to RDP to the beachhead with a proxy connection via their Metasploit payload and execute mimikatz. The mimikatz execution resulted in the disclosure of an easily crackable hash for the ‘Administrator’ account on the beachhead. Unfortunately, this password was re-used across the hosts in the environment. Utilizing the ‘Administrator’ account on a File Server, the threat actor was able to locate cleartext credentials for other privileged accounts account (see ‘Credential Access‘)."
    },
    {
        "level": 2,
        "content": "Defense Evasion"
    },
    {
        "level": 3,
        "content": "Through their RDP session on the beachhead, the threat actor typed ‘virus’ in the start menu search to navigate to the ‘Virus & threat protection’ settings to ensure Windows Defender was completely turned off."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "After exfiltrating data off the file server via Rclone, the Windows event logs were cleared via PowerShell:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The wevtutil switches used:"
    },
    {
        "level": 3,
        "content": "el | enum-logs List log names"
    },
    {
        "level": 3,
        "content": "cl | clear-log Clear a log"
    },
    {
        "level": 3,
        "content": "The threat actor also deleted the files they brought into the environment:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Credential Access"
    },
    {
        "level": 3,
        "content": "Mimikatz was executed on the beachhead host just 20 minutes after initial access was performed. This was visible in the memory on the host as Anydesk wrote the file to disk."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Sysmon event code 1 showed the execution of Mimikatz:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Sysmon event code 10 showed that Mimikatz accessed the LSASS process, and we can also see subsequent GrantedAccess for Mimikatz 0x1010 , which translates to: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010) ."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Sysmon event code 11 shows that the Mimikatz process creates a file called passwords.txt:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Finally, the threat actor reviewed the captured passwords by opening the newly generated password file in Notepad, as documented in Sysmon event code 1:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The threat actor also ran the script Veeam-Get-Creds-New.ps1 on the backup server:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Powershell scripts are logged under event code 4104 ifpowershell script block logging is enabled:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The script looks to be from thesadshade/veam-credsGitHub repository, and the script tries to get credentials from the Veeam credential manager."
    },
    {
        "level": 3,
        "content": "The threat actor also discovered a txt file on a file share server that contained IT-related cleartext passwords. Included were the credentials for a Domain Admin account. Through their RDP session, they proceeded with opening the the txt file using Notepad. Illustrated below via the process execution evidence:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Discovery"
    },
    {
        "level": 3,
        "content": "The following commands were executed via the Confluence RCE:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "From the Meterpreter session, tasklist was used to enumerate the running processes. This threat actor identified C2 processes that were established by a different actor and used ‘taskkill’ to end them."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "During this task, we noticed a threat actor blunder: the ‘taskkill’ execution on ‘powershell.exe’ killed their own Meterpreter session. Consequently, they re-exploited Confluence to establish yet another Meterpreter session. Then, further discovery commands were executed on the host:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "NetScan was then utilized to enumerate the local network:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "When NetScan is executed with the ‘Check for write access’ option enabled, a ‘delete.me’ file is created then deleted on discovered shares. We can observe this in Event ID 5145:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "After moving to a Domain Controller, ‘query user’ was once again executed. Then the Domain Admins group was enumerated, after a typo:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Lateral Movement"
    },
    {
        "level": 3,
        "content": "Throughout the intrusion, RDP was used for lateral movement. The ‘Remote Desktop Connection’ app (mstsc.exe) was used on the Confluence beachhead to interactively logon to targeted hosts in the environment. The Event ID 4624 logon activity:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Lateral movement with RDP was done to different hosts in swift succession. Starting under one hour after the initial compromise of the beachhead host. All RDP was performed from the beachhead."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Collection"
    },
    {
        "level": 3,
        "content": "The threat actor used Rclone to exfiltrate everything in a file share, see ‘Exfiltration‘ for more details. However, there were a few groups of files that were copied to C:\\temp on the beachhead and then deleted about 30 seconds later."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Command and Control"
    },
    {
        "level": 3,
        "content": "Command and control (C2) connections were established via Metasploit from the breached Confluence server to the IP address 92.51.2[.]22 which is hosted in the provider called Flyservers S.A., reported in otherblogsfor being used by LockBit affiliates."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The connections were made to the port 4321."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "When downloading the Meterpreter HTA stager, the threat actor downloaded it by using a user-agent associated with Internet Explorer."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "A second C2 server 92.51.2[.]27 was employed to connect to AnyDesk."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Through Fofa, it was possible to identify the hostname, WIN-EKIHV2OQQP8, associated with the server in the period related to the incident."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "This hostname was observed in the login activity on the beachhead host for this intrusion."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The hostname can be traced through the certificate on the RDP service (port 3389), valid since the end of October 2023."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "By searching for this hostname infofa.info, it was possible to identify multiple IP addresses that were associated with malicious activities in VirusTotal in the past, some examples in the following image."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The same hunt on Censys allowed us to identify six IP addresses which were potentially associated with the ShadowSyndicate ransomware group based on a tweet made by@JRehbergCSK."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Some of the identified IP addresses like 194.165.16[.]60 and 45.227.252[.]227 were also mentioned in aGroup-IB Reportabout ShadowSyndicate."
    },
    {
        "level": 3,
        "content": "The AnyDesk connection was utilized to drop tools to enumerate the infrastructure, access credentials and exfiltrate and encrypt data."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Exfiltration"
    },
    {
        "level": 3,
        "content": "Just one hour and eleven minutes after initial access the threat actor started exfiltration activity. This was done from a file share server, performed with Rclone and exfiltrated to mega (Mega.nz).We have previously reported on the usage of rclone several times."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "We were able to retrieve the Rclone configuration file used:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "As shown above the configuration file is encrypted and password protected. Fortunately the threat actor had bad opsec and reused a password so we were able to decrypt the file using the “rclone config show” command:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "From Zeek network logs we see data being exfiltrated:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Suricata was also alerting on the activity:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "From the network traffic we see HTTP posts done with rclone:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": ""
    },
    {
        "level": 2,
        "content": "Impact"
    },
    {
        "level": 3,
        "content": "After around two hours into the intrusion, the threat actor transferred PDQ Deploy and the LockBit Black executable, under the C:\\Temp folder on the beachhead host. The same files were then also created on the domain controller.PDQ Deployis a software tool designed for automating patch management and deploying applications. In this case, it was leveraged to facilitate the deployment of the LockBit ransomware."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Before the threat actor used PDQ they first ran the LockBit binary manually over RDP sessions on the back server and file server."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "The next deployment process began with PDQ Deploy being executed from the beachhead system. Organizations can utilize the PDQ Deploy to remotely and efficiently create multi-step deployments for end users, supporting various formats such as .exe, .msi, .bat, .ps1, and .vbs. PDQ Deploy allows administrators to execute scripts and commands (e.g., PowerShell, VBScript, and batch files) on remote computers and groups integrated with Spiceworks, Active Directory, or PDQ Inventory. The tool also provides deployment reports to monitor and track successful deployments."
    },
    {
        "level": 3,
        "content": "PDQ Deploy operates through two Windows services:"
    },
    {
        "level": 3,
        "content": "PDQDeployService.exeis the background service that manages all schedules and deployments on the console. \nPDQDeployRunner-n(e.g., PDQDeployRunner-1) is the target service executed on remote hosts to perform the deployments."
    },
    {
        "level": 3,
        "content": "During deployment, the target service and installation files for the deployment package are copied to a directory on the target computer’s default share, enabling the execution of deployment tasks."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "To facilitate the ransomware deployment with PDQ the threat actor created a file called asd.bat to launch the LockBit executable."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "asd.bat content:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "We were able collect the PDQ .db files from C:\\ProgramData\\Admin Arsenal\\PDQ Deploy\\ on the beachhead to see the deployment data created by the threat actor."
    },
    {
        "level": 3,
        "content": "Threat actor logged in via their ‘backup’ user:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Domain Admin User/Credentials used to deploy:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Files included in PDQ library:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Several runs of the deployment package by the threat actor:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Several ways to attempt to execute the ransomware including calling the file, command arguments, and finally the batch file:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Once the threat actor started the deployment we observed both PDQ service runners and the package files (ransomware and batch file) being deployed over SMB."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "This batch file was then executed on hosts across the environment via the PDQ runner."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "After completing the deployment using PDQ, the threat actor connected to an Exchange server using RDP. They issued a few commands to stop running processes associated with Exchange and SQL on the server:"
    },
    {
        "level": 3,
        "content": "They then dropped a batch file, test.bat, which contained a list of the systems found earlier during the intrusion, as well as a ransomware execution command. This appears to have been a backup to try and hit systems that may have been missed during the PDQ deployment."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Below is an extract of the test.bat contents:"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "After the ransomware attack was completed, the affected files were renamed with the .rhddiicoE extension, and a ransom note titled rhddiicoE.README.txt was left on the compromised hosts."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Additionally, the desktop background image was modified as part of the ransomware execution."
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Timeline"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Diamond Model"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 2,
        "content": "Indicators"
    },
    {
        "level": 3,
        "content": "Atomic"
    },
    {
        "level": 3,
        "content": "Computed"
    },
    {
        "level": 3,
        "content": "Behavioral"
    },
    {
        "level": 2,
        "content": "Detections"
    },
    {
        "level": 3,
        "content": "Network"
    },
    {
        "level": 3,
        "content": "Sigma"
    },
    {
        "level": 3,
        "content": "Search rules ondetection.fyiorsigmasearchengine.com"
    },
    {
        "level": 3,
        "content": "DFIR Public Rules Repo:"
    },
    {
        "level": 3,
        "content": "DFIR Private Rules:"
    },
    {
        "level": 3,
        "content": "Sigma Repo:"
    },
    {
        "level": 3,
        "content": "Yara"
    },
    {
        "level": 2,
        "content": "MITRE ATT&CK"
    },
    {
        "level": 3,
        "content": ""
    },
    {
        "level": 3,
        "content": "Internal case #TB27244 #PR34716"
    }
]